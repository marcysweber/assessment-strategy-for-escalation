---
title: "Untitled"
author: "C.J. Coates"
date: "9/20/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r functions}
ep<-function(x,y){
  sum(x[,3])/(sum(x[,3])+sum(y[,3]))
}

inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Victories=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  victory.interaction.matrix<-(matrix(vdf$Victories,nrow=10,ncol=10,byrow=F))
  victory.interaction.matrix<-data.frame(victory.interaction.matrix)
  
  victory.interaction.matrix<-t(victory.interaction.matrix)
  victory.interaction.matrix<-matrix(victory.interaction.matrix,nrow=10,ncol=10)
  colnames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  victory.interaction.matrix
}

int.to.dom=function(x){ 
  ((x>t(x)) & (x+t(x)>0))+0
}

# From Shizuka and McDonald, 2012
tr.tri<-function(x){

  m=int.to.dom(as.matrix(x))
  
  g=network(m,directed=TRUE)
  
  # We calculate P.t and t.tri for this empirical network.
  
  tri=triad.census(g) #The full triad census as an 16-element vector 
  
  w=as.vector(c(0,0,0,0,0,0,0,0,1,0,0,1,1,0.5,0.75,0.75)) # The weighting vector for transitivity 
  
  N.triangle=sum(tri*as.vector(c(0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1))) #Count and sum the number of triangles
  
  Pt=sum(tri*w)/N.triangle 
  
  t.tri=4*(Pt-0.75) 
  
  Pt 
  
  t.tri
  
  ## We now conduct 1,000 simulations of random networks with the same number of mutual, asymmetric and null dyads as the empirical dominance matrix. We calculate Pt from each of these simulated networks (r.P.t). I use a while() loop because randomizations of some sparse matrices will produce networks with no triangles. For simplicity, we just throw these out. 
  
  dyads=dyad.census(g) 
  
  r.p.t=vector(length=1000)
  
  j=1
  
  while(j<1001){
  
  r=rguman(1,nv=nrow(m),mut=dyads[1],asym=dyads[2],null=dyads[3])
  
  r.triad=triad.census(r)
  
  r.p.t[j]=r.triad[9]/(r.triad[10]+r.triad[9])
  
  if (is.na(r.p.t[j])) next else j=j+1
  
  }
  
  p=length(r.p.t[r.p.t>=Pt])/1000
  
  p
  
  t.tri
}

#adds new line to axis tick labels in ggplot
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
```


```{r knowledge mutual, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/km_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/km_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/km_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.km<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r knowledge self, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/ks_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/ks_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/ks_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ks<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r knowledge opponent, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/ko_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/ko_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/ko_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ko<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r history mutual, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/hm_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/hm_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/hm_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hm<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r history self, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/hs_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/hs_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/hs_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hs<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r history opponent, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/ho_contest_p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/ho_contest_p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),h.prime=c(h1[3,2],h2[3,2],h3[3,2],h4[3,2],h5[3,2],h6[3,2],h7[3,2],h8[3,2],h9[3,2],h10[3,2]),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10))

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/ho_contest_p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ho<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
```

```{r summary statistic plots, warning=FALSE}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)

#create overall dataframe of summary statistics
overall.ss<-data.frame(km.ss)
overall.ss<-rbind(overall.ss,ks.ss)
overall.ss<-rbind(overall.ss,ko.ss)
overall.ss<-rbind(overall.ss,hm.ss)
overall.ss<-rbind(overall.ss,hs.ss)
overall.ss<-rbind(overall.ss,ho.ss)

overall.ss<-cbind(overall.ss,variable=c(rep("rhp",30),rep("history",30)))
overall.ss<-cbind(overall.ss,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2))


rhp.ss<-overall.ss[overall.ss$variable=="rhp",]
history.ss<-overall.ss[overall.ss$variable=="history",]

overall.ss$combo<-paste(overall.ss$strategy,overall.ss$variable)

overall.ss %>%
  ggplot( aes(x=combo, y=triangle.transitivity,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity") +
    theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    scale_x_discrete(breaks=unique(overall.ss$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

overall.ss %>%
  ggplot( aes(x=combo, y=dci,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("DCI") +
    xlab("")+
    ylab("DCI") +
    theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    scale_x_discrete(breaks=unique(overall.ss$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

overall.ss %>%
  ggplot( aes(x=combo, y=escalation,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Escalation Proportion") +
    xlab("")+
    ylab("Proportional Escalation") +
    theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    scale_x_discrete(breaks=unique(overall.ss$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

overall.ss %>%
  ggplot( aes(x=combo, y=abs(steepness),color= variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Steepness") +
    xlab("")+
    ylab("Steepness") +
    theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    scale_x_discrete(breaks=unique(overall.ss$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

max(abs(overall.ss$steepness))

mut.ss<-overall.ss[overall.ss$combo=="self rhp",]


mean(mut.ss$steepness)
#from Klass and Cords (2014), it looks like a high DCI is the norm in female group relationships (varying from 0.74-1.00)
#All strategies reached high DCIs between 0.8 and 1.00
```

```{r energy efficiency}
#create overall dataframe of energy data
overall.e<-data.frame(energy.km.df)
overall.e<-rbind(overall.e,energy.ks.df)
overall.e<-rbind(overall.e,energy.ko.df)
overall.e<-rbind(overall.e,energy.hm.df)
overall.e<-rbind(overall.e,energy.hs.df)
overall.e<-rbind(overall.e,energy.ho.df)

#create overall dataframe of David's Scores
overall.d<-data.frame(david.km.df)
overall.d<-rbind(overall.d,david.ks.df)
overall.d<-rbind(overall.d,david.ko.df)
overall.d<-rbind(overall.d,david.hm.df)
overall.d<-rbind(overall.d,david.hs.df)
overall.d<-rbind(overall.d,david.ho.df)


e.d.lm<-lm(overall.e$energy_over_time~overall.d$normDS)
plot(overall.e$energy_over_time~overall.d$normDS, xlab="Normalized David's Scores", ylab="Energy / Time", pch=16, col="#cc5500")
abline(e.d.lm, col="blue")
summary(e.d.lm) #currently 0 degrees of freedom for residuals - do not know why
```

```{r individual regression plots}
km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
plot((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Mutual RHP")
abline(km.lm)
km.lm.s<-summary(km.lm)$coefficients
km.slope<-km.lm.s[2,1]

hm.lm<-lm(energy.hm.df$energy_over_time~as.numeric(david.hm.df$normDS))
plot(energy.hm.df$energy_over_time~as.numeric(david.hm.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Mutual History")
abline(hm.lm)
hm.lm.s<-summary(hm.lm)$coefficients
hm.slope<-hm.lm.s[2,1]

ko.lm<-lm(energy.ko.df$energy_over_time~as.numeric(david.ko.df$normDS))
plot(energy.ko.df$energy_over_time~as.numeric(david.ko.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Opponent RHP")
abline(ko.lm)
ko.lm.s<-summary(ko.lm)$coefficients
ko.slope<-ko.lm.s[2,1]

ho.lm<-lm(energy.ho.df$energy_over_time~as.numeric(david.ho.df$normDS))
plot(energy.ho.df$energy_over_time~as.numeric(david.ho.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Opponent History")
abline(ho.lm)
ho.lm.s<-summary(ho.lm)$coefficients
ho.slope<-ho.lm.s[2,1]

ks.lm<-lm(energy.ks.df$energy_over_time~as.numeric(david.ks.df$normDS))
plot(energy.ks.df$energy_over_time~as.numeric(david.ks.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Self RHP")
abline(ks.lm)
ks.lm.s<-summary(ks.lm)$coefficients
ks.slope<-ks.lm.s[2,1]

hs.lm<-lm(energy.hs.df$energy_over_time~as.numeric(david.hs.df$normDS))
plot(energy.hs.df$energy_over_time~as.numeric(david.hs.df$normDS), xlab="Normalized David Scores",ylab="Energy Over Time", main="Self History")
abline(hs.lm)
hs.lm.s<-summary(hs.lm)$coefficients
hs.slope<-hs.lm.s[2,1]

slopes<-data.frame(km.slope,hm.slope,ko.slope,ho.slope,ks.slope,hs.slope)
slopes

#Clear trends present in the plotted data showing the higher normalized David scores was correlated with more energy gain over time in the clumped distribution

#HM and HO have outliers, may need to be rerun
```


```{r average interactions}
avg.int.hm
avg.int.ho
avg.int.hs
avg.int.km
avg.int.ko
avg.int.ks

clumped.int.avg<-(sum(
    avg.int.hm, 
    avg.int.ho, 
    avg.int.hs, 
    avg.int.km, 
    avg.int.ko,
    avg.int.ks))/6

uniform.int.avg # before new stop condition: ~197
                # after new stop condition: ~3893
clumped.int.avg # before new stop condition: ~3895
                # after new stop condition: ~3918
```

```{r summary table}
{km.tt<-mean(km.ss$triangle.transitivity)
km.dci<-mean(km.ss$dci)
km.escalation<-mean(km.ss$escalation)
km.steep<-mean(km.ss$steepness)
km.st<-data.frame(Knowledge.Mutual=c(km.tt,km.dci,km.escalation,km.steep))}

{ks.tt<-mean(ks.ss$triangle.transitivity)
ks.dci<-mean(ks.ss$dci)
ks.escalation<-mean(ks.ss$escalation)
ks.steep<-mean(ks.ss$steepness)
ks.st<-data.frame(Knowledge.Self=c(ks.tt,ks.dci,ks.escalation,ks.steep))}

{ko.tt<-mean(ko.ss$triangle.transitivity)
ko.dci<-mean(ko.ss$dci)
ko.escalation<-mean(ko.ss$escalation)
ko.steep<-mean(ko.ss$steepness)
ko.st<-data.frame(Knowledge.Opponent=c(ko.tt,ko.dci,ko.escalation,ko.steep))}

{hm.tt<-mean(hm.ss$triangle.transitivity)
hm.dci<-mean(hm.ss$dci)
hm.escalation<-mean(hm.ss$escalation)
hm.steep<-mean(hm.ss$steepness)
hm.st<-data.frame(History.Mutual=c(hm.tt,hm.dci,hm.escalation,hm.steep))}

{hs.tt<-mean(hs.ss$triangle.transitivity)
hs.dci<-mean(hs.ss$dci)
hs.escalation<-mean(hs.ss$escalation)
hs.steep<-mean(hs.ss$steepness)
hs.st<-data.frame(History.Self=c(hs.tt,hs.dci,hs.escalation,hs.steep))}

{ho.tt<-mean(ho.ss$triangle.transitivity)
ho.dci<-mean(ho.ss$dci)
ho.escalation<-mean(ho.ss$escalation)
ho.steep<-mean(ho.ss$steepness)
ho.st<-data.frame(History.Opponent=c(ho.tt,ho.dci,ho.escalation,ho.steep))}

overall.cp.st<-data.frame(kno.mut=km.st,hist.mut=hm.st,kno.self=ks.st,hist.self=hs.st,kno.opp=ko.st,hist.opp=ho.st)
row.names(overall.st)<-c("Triangle TransitivityT","Directional Consitancy Index","Escalation","Steepness")

overall.cp.st
```

#plots in the plot tab to the right, can save as images from there
#rhp plots
rhp.ss %>%
  ggplot( aes(x=strategy, y=triangle.transitivity,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="#CC5500")+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity")


rhp.ss %>%
  ggplot( aes(x=strategy, y=escalation,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="#CC5500")+
    ggtitle("Escalation") +
    xlab("")+
    ylab("Escalation")


rhp.ss %>%
  ggplot( aes(x=strategy, y=dci, color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="#CC5500")+
    ggtitle("DCI") +
    xlab("") +
    ylab("DCI")

#history plots
history.ss %>%
  ggplot( aes(x=strategy, y=triangle.transitivity,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="blue")+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity")


history.ss %>%
  ggplot( aes(x=strategy, y=escalation,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="blue")+
    ggtitle("Escalation") +
    xlab("")+
    ylab("Escalation")


history.ss %>%
  ggplot( aes(x=strategy, y=dci, color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2,color="blue")+
    ggtitle("DCI") +
    xlab("") +
    ylab("DCI")
    
overall.ss$combo<-paste(overall.ss$strategy,overall.ss$variable)

overall.ss %>%
  ggplot( aes(x=combo, y=triangle.transitivity,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity")

overall.ss %>%
  ggplot( aes(x=combo, y=dci,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Directional Consistency Index (DCI)") +
    xlab("")+
    ylab("DCI")

overall.ss %>%
  ggplot( aes(x=combo, y=escalation,color=variable)) +
    geom_boxplot(color="black") +
    geom_point(size=2)+
    ggtitle("Escalation Proportion") +
    xlab("")+
    ylab("Proportion of Escalation")