---
title: "Untitled"
author: "C.J. Coates"
date: "12/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r clumped prob message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.km.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)
#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
km.lm.s<-summary(km.lm)$coefficients
km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))


#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ks.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))


#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ko.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))


#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hm.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))


#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hs.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))


#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ho.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

km.lm.pc<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.pc<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.pc<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.pc<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.pc<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.pc<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r clumped prob data frame}
#energy data frame
total.energy.pc<-data.frame(energy.km.df)
total.energy.pc<-rbind(total.energy.pc,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.pc<-data.frame(david.km.df)
total.david.pc<-rbind(total.david.pc,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.pc<-cbind(total.energy.pc,normDS=total.david.pc$normDS)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.pc<-mean(km.ss$triangle.transitivity)
km.dci.pc<-mean(km.ss$dci)
km.esc.pc<-mean(km.ss$escalation)
km.steep.pc<-mean(km.ss$steepness)
km.slope.pc<-mean(km.ss$slope)
km.mean.pc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc,dci=km.dci.pc,esc=km.esc.pc,steepness=km.steep.pc,slope=km.slope.pc,dist="clumped",calc="probabilistic")

#knowledge self
ks.tt.pc<-mean(ks.ss$triangle.transitivity)
ks.dci.pc<-mean(ks.ss$dci)
ks.esc.pc<-mean(ks.ss$escalation)
ks.steep.pc<-mean(ks.ss$steepness)
ks.slope.pc<-mean(ks.ss$slope)
ks.mean.pc<-data.frame(scenario="Knowledge self",tt=ks.tt.pc,dci=ks.dci.pc,esc=ks.esc.pc,steepness=ks.steep.pc,slope=ks.slope.pc,dist="clumped",calc="probabilistic")

#knowledge opponent
ko.tt.pc<-mean(ko.ss$triangle.transitivity)
ko.dci.pc<-mean(ko.ss$dci)
ko.esc.pc<-mean(ko.ss$escalation)
ko.steep.pc<-mean(ko.ss$steepness)
ko.slope.pc<-mean(ko.ss$slope)
ko.mean.pc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc,dci=ko.dci.pc,esc=ko.esc.pc,steepness=ko.steep.pc,slope=ko.slope.pc,dist="clumped",calc="probabilistic")

#history mutual
hm.tt.pc<-mean(hm.ss$triangle.transitivity)
hm.dci.pc<-mean(hm.ss$dci)
hm.esc.pc<-mean(hm.ss$escalation)
hm.steep.pc<-mean(hm.ss$steepness)
hm.slope.pc<-mean(hm.ss$slope)
hm.mean.pc<-data.frame(scenario="History Mutual",tt=hm.tt.pc,dci=hm.dci.pc,esc=hm.esc.pc,steepness=hm.steep.pc,slope=hm.slope.pc,dist="clumped",calc="probabilistic")

#history self
hs.tt.pc<-mean(hs.ss$triangle.transitivity)
hs.dci.pc<-mean(hs.ss$dci)
hs.esc.pc<-mean(hs.ss$escalation)
hs.steep.pc<-mean(hs.ss$steepness)
hs.slope.pc<-mean(hs.ss$slope)
hs.mean.pc<-data.frame(scenario="History self",tt=hs.tt.pc,dci=hs.dci.pc,esc=hs.esc.pc,steepness=hs.steep.pc,slope=hs.slope.pc,dist="clumped",calc="probabilistic")

#history opponent
ho.tt.pc<-mean(ho.ss$triangle.transitivity)
ho.dci.pc<-mean(ho.ss$dci)
ho.esc.pc<-mean(ho.ss$escalation)
ho.steep.pc<-mean(ho.ss$steepness)
ho.slope.pc<-mean(ho.ss$slope)
ho.mean.pc<-data.frame(scenario="History opponent",tt=ho.tt.pc,dci=ho.dci.pc,esc=ho.esc.pc,steepness=ho.steep.pc,slope=ho.slope.pc,dist="clumped",calc="probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc,ks.mean.pc,ko.mean.pc,hm.mean.pc,hs.mean.pc,ho.mean.pc)

#create overall dataframe of summary statistics
overall.clump.prob<-data.frame(km.ss)
overall.clump.prob<-rbind(overall.clump.prob,ks.ss)
overall.clump.prob<-rbind(overall.clump.prob,ko.ss)
overall.clump.prob<-rbind(overall.clump.prob,hm.ss)
overall.clump.prob<-rbind(overall.clump.prob,hs.ss)
overall.clump.prob<-rbind(overall.clump.prob,ho.ss)

overall.clump.prob<-cbind(overall.clump.prob,variable=c(rep("rhp",30),rep("history",30)))
overall.clump.prob<-cbind(overall.clump.prob,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ss<-overall.clump.prob[overall.clump.prob$variable=="rhp",]
history.ss<-overall.clump.prob[overall.clump.prob$variable=="history",]

overall.clump.prob$combo<-paste(overall.clump.prob$strategy,overall.clump.prob$variable,overall.clump.prob$distribution)
```
```{r uniform prob, message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.km.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))


#knowledge self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ks.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))


#knowledge opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ko.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))


#history mutual uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hm.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))


#history self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.hs.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))


#history opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/nov 15 contest comp/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories, a1$Victories)
int2<-sum(mut2$Victories, a2$Victories)
int3<-sum(mut3$Victories, a3$Victories)
int4<-sum(mut4$Victories, a4$Victories)
int5<-sum(mut5$Victories, a5$Victories)
int6<-sum(mut6$Victories, a6$Victories)
int7<-sum(mut7$Victories, a7$Victories)
int8<-sum(mut8$Victories, a8$Victories)
int9<-sum(mut9$Victories, a9$Victories)
int10<-sum(mut10$Victories, a10$Victories)

avg.int.ho.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

km.lm.pu<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.pu<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.pu<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.pu<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.pu<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.pu<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r uniform prob data frame}
#energy data frame
total.energy.pu<-data.frame(energy.km.df)
total.energy.pu<-rbind(total.energy.pu,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.pu<-data.frame(david.km.df)
total.david.pu<-rbind(total.david.pu,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.pu<-cbind(total.energy.pu,normDS=total.david.pu$normDS)

#knowledge mutual
km.tt.pu<-mean(km.ss$triangle.transitivity)
km.dci.pu<-mean(km.ss$dci)
km.esc.pu<-mean(km.ss$escalation)
km.steep.pu<-mean(km.ss$steepness)
km.slope.pu<-mean(km.ss$slope)
km.mean.pu<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu,dci=km.dci.pu,esc=km.esc.pu,steepness=km.steep.pu,slope=km.slope.pu,dist="uniform",calc="probabilistic")

#knowledge self
ks.tt.pu<-mean(ks.ss$triangle.transitivity)
ks.dci.pu<-mean(ks.ss$dci)
ks.esc.pu<-mean(ks.ss$escalation)
ks.steep.pu<-mean(ks.ss$steepness)
ks.slope.pu<-mean(ks.ss$slope)
ks.mean.pu<-data.frame(scenario="Knowledge self",tt=ks.tt.pu,dci=ks.dci.pu,esc=ks.esc.pu,steepness=ks.steep.pu,slope=ks.slope.pu,dist="uniform",calc="probabilistic")

#knowledge opponent
ko.tt.pu<-mean(ko.ss$triangle.transitivity)
ko.dci.pu<-mean(ko.ss$dci)
ko.esc.pu<-mean(ko.ss$escalation)
ko.steep.pu<-mean(ko.ss$steepness)
ko.slope.pu<-mean(ko.ss$slope)
ko.mean.pu<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu,dci=ko.dci.pu,esc=ko.esc.pu,steepness=ko.steep.pu,slope=ko.slope.pu,dist="uniform",calc="probabilistic")

#history mutual
hm.tt.pu<-mean(hm.ss$triangle.transitivity)
hm.dci.pu<-mean(hm.ss$dci)
hm.esc.pu<-mean(hm.ss$escalation)
hm.steep.pu<-mean(hm.ss$steepness)
hm.slope.pu<-mean(hm.ss$slope)
hm.mean.pu<-data.frame(scenario="History Mutual",tt=hm.tt.pu,dci=hm.dci.pu,esc=hm.esc.pu,steepness=hm.steep.pu,slope=hm.slope.pu,dist="uniform",calc="probabilistic")

#history self
hs.tt.pu<-mean(hs.ss$triangle.transitivity)
hs.dci.pu<-mean(hs.ss$dci)
hs.esc.pu<-mean(hs.ss$escalation)
hs.steep.pu<-mean(hs.ss$steepness)
hs.slope.pu<-mean(hs.ss$slope)
hs.mean.pu<-data.frame(scenario="History self",tt=hs.tt.pu,dci=hs.dci.pu,esc=hs.esc.pu,steepness=hs.steep.pu,slope=hs.slope.pu,dist="uniform",calc="probabilistic")

#history opponent
ho.tt.pu<-mean(ho.ss$triangle.transitivity)
ho.dci.pu<-mean(ho.ss$dci)
ho.esc.pu<-mean(ho.ss$escalation)
ho.steep.pu<-mean(ho.ss$steepness)
ho.slope.pu<-mean(ho.ss$slope)
ho.mean.pu<-data.frame(scenario="History opponent",tt=ho.tt.pu,dci=ho.dci.pu,esc=ho.esc.pu,steepness=ho.steep.pu,slope=ho.slope.pu,dist="uniform",calc="probabilistic")

#total average dataframe
pu.ave<-rbind(km.mean.pu,ks.mean.pu,ko.mean.pu,hm.mean.pu,hs.mean.pu,ho.mean.pu)

#create overall dataframe of summary statistics
overall.unif.prob<-data.frame(km.ss)
overall.unif.prob<-rbind(overall.unif.prob,ks.ss)
overall.unif.prob<-rbind(overall.unif.prob,ko.ss)
overall.unif.prob<-rbind(overall.unif.prob,hm.ss)
overall.unif.prob<-rbind(overall.unif.prob,hs.ss)
overall.unif.prob<-rbind(overall.unif.prob,ho.ss)

overall.unif.prob<-cbind(overall.unif.prob,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.prob<-cbind(overall.unif.prob,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("prob",60))


rhp.ss<-overall.unif.prob[overall.unif.prob$variable=="rhp",]
history.ss<-overall.unif.prob[overall.unif.prob$variable=="history",]


overall.unif.prob$combo<-paste(overall.unif.prob$strategy,overall.unif.prob$variable,overall.unif.prob$distribution)
```
```{r full overall prob data frame}
overall.ss.prob=rbind(overall.clump.prob,overall.unif.prob)
```
```{r deterministic + probabilistic data frame}
#total.data.frame<-rbind(overall.ss.deter,overall.ss.prob)

#total.ave<-rbind(dc.ave,du.ave,pc.ave,pu.ave)
#total.ave<-data.frame(total.ave,numeric_scenario=rep(1:6,4))
```
```{r summary statistic plots}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

#deterministic plots
p1 <- overall.ss.deter %>%
  ggplot( aes(x=combo, y=triangle.transitivity,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
    #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))
p2 <- overall.ss.deter %>%
  ggplot( aes(x=combo, y=dci,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("DCI") +
    xlab("")+
    ylab("DCI") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))
p3 <- overall.ss.deter %>%
  ggplot( aes(x=combo, y=abs(steepness),color= distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Steepness") +
    xlab("")+
    ylab("Steepness") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

p4 <- overall.ss.deter %>%
  ggplot( aes(x=combo, y=escalation,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Escalation Proportion") +
    xlab("")+
    ylab("Proportional Escalation") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

#from Klass and Cords (2014), it looks like a high DCI is the norm in female group relationships (varying from 0.74-1.00)
#All strategies reached high DCIs between 0.8 and 1.00


#probabilistic plots
p5 <- overall.ss.prob %>%
  ggplot( aes(x=combo, y=triangle.transitivity,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
    #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))
p6 <- overall.ss.prob %>%
  ggplot( aes(x=combo, y=dci,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("DCI") +
    xlab("")+
    ylab("DCI") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))
p7 <- overall.ss.prob %>%
  ggplot( aes(x=combo, y=abs(steepness),color= distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Steepness") +
    xlab("")+
    ylab("Steepness") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

p8 <- overall.ss.prob %>%
  ggplot( aes(x=combo, y=escalation,color=distribution)) +
    geom_boxplot(color="black") +
    geom_point(aes(shape=distribution),size=2)+
    ggtitle("Escalation Proportion") +
    xlab("")+
    ylab("Proportional Escalation") +
    #theme(axis.text=element_text(size=9.5), axis.title=element_text(size=20)) +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
  #scale_x_discrete(breaks=unique(overall.clump.deter$combo), labels = addline_format(c('Mutual History', 'Mutual RHP', 'Opponent History', 'Opponent RHP', 'Self History', 'Self RHP')))

p1;p2;p3;p4;p5;p6;p7;p8
```
```{r averages plots}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

#total.ave.d<-total.ave[total.ave$calc == "deterministic",]
#total.ave.p<-total.ave[total.ave$calc == "probabilistic",]

#deterministic averages
p9<-total.ave.d %>%
  ggplot( aes(x=scenario, y=tt,color=dist)) +
    geom_point(size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p10<-total.ave.d %>%
  ggplot( aes(x=scenario, y=dci,color=dist)) +
    geom_point(size=2)+
    ggtitle("Directional Consistency Index (DCI)") +
    xlab("")+
    ylab("DCI") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p11<-total.ave.d %>%
  ggplot( aes(x=scenario, y=esc,color=dist)) +
    geom_point(size=2)+
    ggtitle("Proportion of Attack (POA)") +
    xlab("")+
    ylab("POA") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p12<-total.ave.d %>%
  ggplot( aes(x=scenario, y=abs(steepness),color=dist)) +
    geom_point(size=2)+
    ggtitle("Steepness") +
    xlab("")+
    ylab("Steepness") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))

#probabilistic averages
p13<-total.ave.p %>%
  ggplot( aes(x=scenario, y=tt,color=dist)) +
    geom_point(size=2)+
    ggtitle("Triangle Transitivity") +
    xlab("")+
    ylab("Triangle Transitivity") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p14<-total.ave.p %>%
  ggplot( aes(x=scenario, y=dci,color=dist)) +
    geom_point(size=2)+
    ggtitle("Directional Consistency Index (DCI)") +
    xlab("")+
    ylab("DCI") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p15<-total.ave.p %>%
  ggplot( aes(x=scenario, y=esc,color=dist)) +
    geom_point(size=2)+
    ggtitle("Proportion of Attack (POA)") +
    xlab("")+
    ylab("POA") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
p16<-total.ave.p %>%
  ggplot( aes(x=scenario, y=abs(steepness),color=dist)) +
    geom_point(size=2)+
    ggtitle("Steepness") +
    xlab("")+
    ylab("Steepness") +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
    scale_color_manual(values = c("blue","#CC5500"))
#split graphs by functional and uniform, have separate boxplots/points for deterministic and probabilistic
```
```{r line plots}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

par(mfrow=c(1,2))
plot(total.energy.dc$energy_over_time~total.energy.dc$normDS,pch=16,col="blue",xlab="",ylab="",main="Deterministic",ylim=c(0.4,1.0),xlim=c(1,8)); points(total.energy.du$energy_over_time~total.energy.du$normDS,pch=17,col="#CC5500"); abline(km.lm.dc, lwd=2);abline(ks.lm.dc, lwd=2);abline(ko.lm.dc, lwd=2);abline(hm.lm.dc, lwd=2);abline(hs.lm.dc, lwd=2);abline(ho.lm.dc, lwd=2);abline(km.lm.du, col="black", lty=4, lwd=2);abline(ks.lm.du, col="black", lty=4, lwd=2);abline(ko.lm.du, col="black", lty=4, lwd=2);abline(hm.lm.du, col="black", lty=4, lwd=2);abline(hs.lm.du, col="black", lty=4, lwd=2);abline(ho.lm.du, col="black", lty=4, lwd=2)
title(xlab="Normalized DS",ylab="Energy/Time", line=2.3)
legend("topleft", legend=c("Clumped", "Uniform"),lty=1:4,cex=0.8, box.lty=0,bg=NULL); legend("topleft",legend=c("",""),col=c("Blue","#CC5500"),pch=16:17,bg=NULL,box.lty=0)

plot(total.energy.pc$energy_over_time~total.energy.pc$normDS,pch=16,col="blue",xlab="",ylab="",main="Probabilistic",ylim=c(0.4,1.0),xlim=c(1,8)); points(total.energy.pu$energy_over_time~total.energy.pu$normDS,col="#CC5500",pch=17);abline(km.lm.pc, lwd=2);abline(ks.lm.pc, lwd=2);abline(ko.lm.pc, lwd=2);abline(hm.lm.pc, lwd=2);abline(hs.lm.pc, lwd=2);abline(ho.lm.pc, lwd=2);abline(km.lm.pu, col="black", lty=4, lwd=2);abline(ks.lm.pu, col="black", lty=4, lwd=2);abline(ko.lm.pu, col="black", lty=4, lwd=2);abline(hm.lm.pu, col="black", lty=4, lwd=2);abline(hs.lm.pu, col="black", lty=4, lwd=2);abline(ho.lm.pu, col="black", lty=4, lwd=2)
title(xlab="Normalized DS",ylab="Energy/Time", line=2.3)
#make the circles blue - keep this consistent throughout the figures
```
```{r individual regression plots}
km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
km.lm.s<-summary(km.lm)$coefficients
km.slope<-km.lm.s[2,1]

hm.lm<-lm(energy.hm.df$energy_over_time~as.numeric(david.hm.df$normDS))
hm.lm.s<-summary(hm.lm)$coefficients
hm.slope<-hm.lm.s[2,1]

ko.lm<-lm(energy.ko.df$energy_over_time~as.numeric(david.ko.df$normDS))
ko.lm.s<-summary(ko.lm)$coefficients
ko.slope<-ko.lm.s[2,1]

ho.lm<-lm(energy.ho.df$energy_over_time~as.numeric(david.ho.df$normDS))
ho.lm.s<-summary(ho.lm)$coefficients
ho.slope<-ho.lm.s[2,1]

ks.lm<-lm(energy.ks.df$energy_over_time~as.numeric(david.ks.df$normDS))
ks.lm.s<-summary(ks.lm)$coefficients
ks.slope<-ks.lm.s[2,1]

hs.lm<-lm(energy.hs.df$energy_over_time~as.numeric(david.hs.df$normDS))
hs.lm.s<-summary(hs.lm)$coefficients
hs.slope<-hs.lm.s[2,1]

#Clear trends present in the plotted data showing the higher normalized David scores was correlated with more energy gain over time in the clumped distribution
```

#Supplemental information
  #Figure 2b (supplemntal information)
fig.2b<-multiplot(p9,p10, cols=2)


  #Figure 3b (supplemntal information)
fig.1b<-multiplot(p1, p2, p3,p5,p6,p7, cols=2)

  #Figure 4b (supplemntal information)
par(mfrow=c(1,2))
plot(total.energy.dc$energy_over_time~total.energy.dc$normDS,pch=16,col="blue",xlab="",ylab="",main="Deterministic",ylim=c(0.4,1.0),xlim=c(1,8)); points(total.energy.du$energy_over_time~total.energy.du$normDS,pch=17,col="#CC5500"); abline(km.lm.dc, lwd=2);abline(ks.lm.dc, lwd=2);abline(ko.lm.dc, lwd=2);abline(hm.lm.dc, lwd=2);abline(hs.lm.dc, lwd=2);abline(ho.lm.dc, lwd=2);abline(km.lm.du, col="black", lty=4, lwd=2);abline(ks.lm.du, col="black", lty=4, lwd=2);abline(ko.lm.du, col="black", lty=4, lwd=2);abline(hm.lm.du, col="black", lty=4, lwd=2);abline(hs.lm.du, col="black", lty=4, lwd=2);abline(ho.lm.du, col="black", lty=4, lwd=2)
title(xlab="Normalized DS",ylab="Energy/Time", line=2.3)
legend("topleft", legend=c("Clumped", "Uniform"),lty=1:4,cex=0.8, box.lty=0,bg=NULL); legend("topleft",legend=c("",""),col=c("Blue","#CC5500"),pch=16:17,bg=NULL,box.lty=0)

plot(total.energy.pc$energy_over_time~total.energy.pc$normDS,pch=16,col="blue",xlab="",ylab="",main="Probabilistic",ylim=c(0.4,1.0),xlim=c(1,8)); points(total.energy.pu$energy_over_time~total.energy.pu$normDS,col="#CC5500",pch=17);abline(km.lm.pc, lwd=2);abline(ks.lm.pc, lwd=2);abline(ko.lm.pc, lwd=2);abline(hm.lm.pc, lwd=2);abline(hs.lm.pc, lwd=2);abline(ho.lm.pc, lwd=2);abline(km.lm.pu, col="black", lty=4, lwd=2);abline(ks.lm.pu, col="black", lty=4, lwd=2);abline(ko.lm.pu, col="black", lty=4, lwd=2);abline(hm.lm.pu, col="black", lty=4, lwd=2);abline(hs.lm.pu, col="black", lty=4, lwd=2);abline(ho.lm.pu, col="black", lty=4, lwd=2)
title(xlab="Normalized DS",ylab="Energy/Time", line=2.3)


  #Averages figure
p9<-total.ave.d %>%
  ggplot( aes(x=scenario, y=tt,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("Deterministic") +
    xlab("")+
    ylab("Triangle Transitivity") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank(),legend.position="none")+
    scale_color_manual(values = c("blue","#CC5500"))
p10<-total.ave.d %>%
  ggplot( aes(x=scenario, y=dci,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("DCI") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank(),legend.position="none")+
    scale_color_manual(values = c("blue","#CC5500"))
p11<-total.ave.d %>%
  ggplot( aes(x=scenario, y=esc,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("POA") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank(),legend.position="none")+
    scale_color_manual(values = c("blue","#CC5500"))
p12<-total.ave.d %>%
  ggplot( aes(x=scenario, y=abs(steepness),color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("Steepness") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank(),legend.position="none")+
    scale_color_manual(values = c("blue","#CC5500"))
    
p13<-total.ave.p %>%
  ggplot( aes(x=scenario, y=tt,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("Probabilistic") +
    xlab("")+
    ylab("Triangle Transitivity") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank())+
    scale_color_manual(values = c("blue","#CC5500"))
p14<-total.ave.p %>%
  ggplot( aes(x=scenario, y=dci,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("DCI") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank())+
    scale_color_manual(values = c("blue","#CC5500"))
p15<-total.ave.p %>%
  ggplot( aes(x=scenario, y=esc,color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("POA") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank())+
    scale_color_manual(values = c("blue","#CC5500"))
p16<-total.ave.p %>%
  ggplot( aes(x=scenario, y=abs(steepness),color=dist)) +
    geom_point(aes(shape=dist),size=2)+
    ggtitle("") +
    xlab("")+
    ylab("Steepness") +
    theme(axis.title.x = element_blank(),axis.text.x=element_blank())+
    scale_color_manual(values = c("blue","#CC5500"))
    
fig.3<-multiplot(p9, p10, p11,p12,p13, cols=1)
fig.3b<-multiplot(p9, p10, p11,p12,p13,p14,p15,p16, cols=2)


