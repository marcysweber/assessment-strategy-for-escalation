---
title: "Contest_dist_matrix"
author: "C.J. Coates"
date: "9/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r functions}
ep<-function(x,y){
  sum(x[,3])/(sum(x[,3])+sum(y[,3]))
}

inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Victories=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  victory.interaction.matrix<-(matrix(vdf$Victories,nrow=10,ncol=10,byrow=F))
  victory.interaction.matrix<-data.frame(victory.interaction.matrix)
  
  victory.interaction.matrix<-t(victory.interaction.matrix)
  victory.interaction.matrix<-matrix(victory.interaction.matrix,nrow=10,ncol=10)
  colnames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  victory.interaction.matrix
}

int.to.dom=function(x){ 
  ((x>t(x)) & (x+t(x)>0))+0
}

# From Shizuka and McDonald, 2012
tr.tri<-function(x){

  m=int.to.dom(as.matrix(x))
  
  g=network(m,directed=TRUE)
  
  # We calculate P.t and t.tri for this empirical network.
  
  tri=triad.census(g) #The full triad census as an 16-element vector 
  
  w=as.vector(c(0,0,0,0,0,0,0,0,1,0,0,1,1,0.5,0.75,0.75)) # The weighting vector for transitivity 
  
  N.triangle=sum(tri*as.vector(c(0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1))) #Count and sum the number of triangles
  
  Pt=sum(tri*w)/N.triangle 
  
  t.tri=4*(Pt-0.75) 
  
  Pt 
  
  t.tri
  
  ## We now conduct 1,000 simulations of random networks with the same number of mutual, asymmetric and null dyads as the empirical dominance matrix. We calculate Pt from each of these simulated networks (r.P.t). I use a while() loop because randomizations of some sparse matrices will produce networks with no triangles. For simplicity, we just throw these out. 
  
  dyads=dyad.census(g) 
  
  r.p.t=vector(length=1000)
  
  j=1
  
  while(j<1001){
  
  r=rguman(1,nv=nrow(m),mut=dyads[1],asym=dyads[2],null=dyads[3])
  
  r.triad=triad.census(r)
  
  r.p.t[j]=r.triad[9]/(r.triad[10]+r.triad[9])
  
  if (is.na(r.p.t[j])) next else j=j+1
  
  }
  
  p=length(r.p.t[r.p.t>=Pt])/1000
  
  p
  
  t.tri
}

#adds new line to axis tick labels in ggplot
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}

ggplotRegression <- function (fit) {

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
                     "Intercept =",signif(fit$coef[[1]],5 ),
                     " Slope =",signif(fit$coef[[2]], 5),
                     " P =",signif(summary(fit)$coef[2,4], 5)))
}
```


```{r clumped deter message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.km.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/km_dc_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ks_dc_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ko.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ko_dc_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hm_dc_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/hs_dc_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.dc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ho.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_clumped/ho_dc_mat10.csv")

km.lm.dc<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.dc<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.dc<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.dc<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.dc<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.dc<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r clumped deter data frame}
#energy data frame
total.energy.dc<-data.frame(energy.km.df)
total.energy.dc<-rbind(total.energy.dc,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.dc<-data.frame(david.km.df)
total.david.dc<-rbind(total.david.dc,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.dc<-cbind(total.energy.dc,normDS=total.david.dc$normDS)

#knowledge mutual
km.tt.dc<-mean(km.ss$triangle.transitivity)
km.dci.dc<-mean(km.ss$dci)
km.esc.dc<-mean(km.ss$escalation)
km.steep.dc<-mean(km.ss$steepness)
km.slope.dc<-mean(km.ss$slope)
km.mean.dc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc,dci=km.dci.dc,esc=km.esc.dc,steepness=km.steep.dc,slope=km.slope.dc,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc<-mean(ks.ss$triangle.transitivity)
ks.dci.dc<-mean(ks.ss$dci)
ks.esc.dc<-mean(ks.ss$escalation)
ks.steep.dc<-mean(ks.ss$steepness)
ks.slope.dc<-mean(ks.ss$slope)
ks.mean.dc<-data.frame(scenario="Knowledge self",tt=ks.tt.dc,dci=ks.dci.dc,esc=ks.esc.dc,steepness=ks.steep.dc,slope=ks.slope.dc,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc<-mean(ko.ss$triangle.transitivity)
ko.dci.dc<-mean(ko.ss$dci)
ko.esc.dc<-mean(ko.ss$escalation)
ko.steep.dc<-mean(ko.ss$steepness)
ko.slope.dc<-mean(ko.ss$slope)
ko.mean.dc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc,dci=ko.dci.dc,esc=ko.esc.dc,steepness=ko.steep.dc,slope=ko.slope.dc,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc<-mean(hm.ss$triangle.transitivity)
hm.dci.dc<-mean(hm.ss$dci)
hm.esc.dc<-mean(hm.ss$escalation)
hm.steep.dc<-mean(hm.ss$steepness)
hm.slope.dc<-mean(hm.ss$slope)
hm.mean.dc<-data.frame(scenario="History Mutual",tt=hm.tt.dc,dci=hm.dci.dc,esc=hm.esc.dc,steepness=hm.steep.dc,slope=hm.slope.dc,dist="clumped",calc="deterministic")

#history self
hs.tt.dc<-mean(hs.ss$triangle.transitivity)
hs.dci.dc<-mean(hs.ss$dci)
hs.esc.dc<-mean(hs.ss$escalation)
hs.steep.dc<-mean(hs.ss$steepness)
hs.slope.dc<-mean(hs.ss$slope)
hs.mean.dc<-data.frame(scenario="History self",tt=hs.tt.dc,dci=hs.dci.dc,esc=hs.esc.dc,steepness=hs.steep.dc,slope=hs.slope.dc,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc<-mean(ho.ss$triangle.transitivity)
ho.dci.dc<-mean(ho.ss$dci)
ho.esc.dc<-mean(ho.ss$escalation)
ho.steep.dc<-mean(ho.ss$steepness)
ho.slope.dc<-mean(ho.ss$slope)
ho.mean.dc<-data.frame(scenario="History opponent",tt=ho.tt.dc,dci=ho.dci.dc,esc=ho.esc.dc,steepness=ho.steep.dc,slope=ho.slope.dc,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc,ks.mean.dc,ko.mean.dc,hm.mean.dc,hs.mean.dc,ho.mean.dc)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.dc<-mean(km.ss$triangle.transitivity)
km.dci.dc<-mean(km.ss$dci)
km.esc.dc<-mean(km.ss$escalation)
km.steep.dc<-mean(km.ss$steepness)
km.slope.dc<-mean(km.ss$slope)
km.mean.dc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc,dci=km.dci.dc,esc=km.esc.dc,steepness=km.steep.dc,slope=km.slope.dc,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc<-mean(ks.ss$triangle.transitivity)
ks.dci.dc<-mean(ks.ss$dci)
ks.esc.dc<-mean(ks.ss$escalation)
ks.steep.dc<-mean(ks.ss$steepness)
ks.slope.dc<-mean(ks.ss$slope)
ks.mean.dc<-data.frame(scenario="Knowledge self",tt=ks.tt.dc,dci=ks.dci.dc,esc=ks.esc.dc,steepness=ks.steep.dc,slope=ks.slope.dc,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc<-mean(ko.ss$triangle.transitivity)
ko.dci.dc<-mean(ko.ss$dci)
ko.esc.dc<-mean(ko.ss$escalation)
ko.steep.dc<-mean(ko.ss$steepness)
ko.slope.dc<-mean(ko.ss$slope)
ko.mean.dc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc,dci=ko.dci.dc,esc=ko.esc.dc,steepness=ko.steep.dc,slope=ko.slope.dc,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc<-mean(hm.ss$triangle.transitivity)
hm.dci.dc<-mean(hm.ss$dci)
hm.esc.dc<-mean(hm.ss$escalation)
hm.steep.dc<-mean(hm.ss$steepness)
hm.slope.dc<-mean(hm.ss$slope)
hm.mean.dc<-data.frame(scenario="History Mutual",tt=hm.tt.dc,dci=hm.dci.dc,esc=hm.esc.dc,steepness=hm.steep.dc,slope=hm.slope.dc,dist="clumped",calc="deterministic")

#history self
hs.tt.dc<-mean(hs.ss$triangle.transitivity)
hs.dci.dc<-mean(hs.ss$dci)
hs.esc.dc<-mean(hs.ss$escalation)
hs.steep.dc<-mean(hs.ss$steepness)
hs.slope.dc<-mean(hs.ss$slope)
hs.mean.dc<-data.frame(scenario="History self",tt=hs.tt.dc,dci=hs.dci.dc,esc=hs.esc.dc,steepness=hs.steep.dc,slope=hs.slope.dc,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc<-mean(ho.ss$triangle.transitivity)
ho.dci.dc<-mean(ho.ss$dci)
ho.esc.dc<-mean(ho.ss$escalation)
ho.steep.dc<-mean(ho.ss$steepness)
ho.slope.dc<-mean(ho.ss$slope)
ho.mean.dc<-data.frame(scenario="History opponent",tt=ho.tt.dc,dci=ho.dci.dc,esc=ho.esc.dc,steepness=ho.steep.dc,slope=ho.slope.dc,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc,ks.mean.dc,ko.mean.dc,hm.mean.dc,hs.mean.dc,ho.mean.dc)

#create overall dataframe of summary statistics
overall.clump.deter<-data.frame(km.ss)
overall.clump.deter<-rbind(overall.clump.deter,ks.ss)
overall.clump.deter<-rbind(overall.clump.deter,ko.ss)
overall.clump.deter<-rbind(overall.clump.deter,hm.ss)
overall.clump.deter<-rbind(overall.clump.deter,hs.ss)
overall.clump.deter<-rbind(overall.clump.deter,ho.ss)

overall.clump.deter<-cbind(overall.clump.deter,variable=c(rep("rhp",30),rep("history",30)))
overall.clump.deter<-cbind(overall.clump.deter,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("deter",60))


rhp.ss<-overall.clump.deter[overall.clump.deter$variable=="rhp",]
history.ss<-overall.clump.deter[overall.clump.deter$variable=="history",]

overall.clump.deter$combo<-paste(overall.clump.deter$strategy,overall.clump.deter$variable,overall.clump.deter$distribution)
overall.clump.deter$combo2<-paste(overall.clump.deter$strategy,overall.clump.deter$variable)
```

```{r avoid clumped deter message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.km.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/km_dc_avoid_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ks_dc_avoid_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ko.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ko_dc_avoid_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hm_dc_avoid_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)


mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/hs_dc_avoid_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.dc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ho.dc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_clumped/ho_dc_avoid_mat10.csv")
```
```{r avoid clumped deter data frame}
#knowledge mutual
km.tt.dc.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.dc.avoidi.dc.avoid<-mean(km.ss.avoid$dci)
km.esc.dc.avoid<-mean(km.ss.avoid$escalation)
km.steep.dc.avoid<-mean(km.ss.avoid$steepness)
km.slope.dc.avoid<-mean(km.ss.avoid$slope)
km.mean.dc.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.avoid,dci=km.dc.avoidi.dc.avoid,esc=km.esc.dc.avoid,steepness=km.steep.dc.avoid,slope=km.slope.dc.avoid,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.dc.avoidi.dc.avoid<-mean(ks.ss.avoid$dci)
ks.esc.dc.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.dc.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.dc.avoid<-mean(ks.ss.avoid$slope)
ks.mean.dc.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.dc.avoid,dci=ks.dc.avoidi.dc.avoid,esc=ks.esc.dc.avoid,steepness=ks.steep.dc.avoid,slope=ks.slope.dc.avoid,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.dc.avoidi.dc.avoid<-mean(ko.ss.avoid$dci)
ko.esc.dc.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.dc.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.dc.avoid<-mean(ko.ss.avoid$slope)
ko.mean.dc.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc.avoid,dci=ko.dc.avoidi.dc.avoid,esc=ko.esc.dc.avoid,steepness=ko.steep.dc.avoid,slope=ko.slope.dc.avoid,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.dc.avoidi.dc.avoid<-mean(hm.ss.avoid$dci)
hm.esc.dc.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.dc.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.dc.avoid<-mean(hm.ss.avoid$slope)
hm.mean.dc.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.dc.avoid,dci=hm.dc.avoidi.dc.avoid,esc=hm.esc.dc.avoid,steepness=hm.steep.dc.avoid,slope=hm.slope.dc.avoid,dist="clumped",calc="deterministic")

#history self
hs.tt.dc.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.dc.avoidi.dc.avoid<-mean(hs.ss.avoid$dci)
hs.esc.dc.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.dc.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.dc.avoid<-mean(hs.ss.avoid$slope)
hs.mean.dc.avoid<-data.frame(scenario="History self",tt=hs.tt.dc.avoid,dci=hs.dc.avoidi.dc.avoid,esc=hs.esc.dc.avoid,steepness=hs.steep.dc.avoid,slope=hs.slope.dc.avoid,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.dc.avoidi.dc.avoid<-mean(ho.ss.avoid$dci)
ho.esc.dc.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.dc.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.dc.avoid<-mean(ho.ss.avoid$slope)
ho.mean.dc.avoid<-data.frame(scenario="History opponent",tt=ho.tt.dc.avoid,dci=ho.dc.avoidi.dc.avoid,esc=ho.esc.dc.avoid,steepness=ho.steep.dc.avoid,slope=ho.slope.dc.avoid,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc.avoid,ks.mean.dc.avoid,ko.mean.dc.avoid,hm.mean.dc.avoid,hs.mean.dc.avoid,ho.mean.dc.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.dc.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.dc.avoidi.dc.avoid<-mean(km.ss.avoid$dci)
km.esc.dc.avoid<-mean(km.ss.avoid$escalation)
km.steep.dc.avoid<-mean(km.ss.avoid$steepness)
km.slope.dc.avoid<-mean(km.ss.avoid$slope)
km.mean.dc.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.avoid,dci=km.dc.avoidi.dc.avoid,esc=km.esc.dc.avoid,steepness=km.steep.dc.avoid,slope=km.slope.dc.avoid,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.dc.avoidi.dc.avoid<-mean(ks.ss.avoid$dci)
ks.esc.dc.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.dc.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.dc.avoid<-mean(ks.ss.avoid$slope)
ks.mean.dc.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.dc.avoid,dci=ks.dc.avoidi.dc.avoid,esc=ks.esc.dc.avoid,steepness=ks.steep.dc.avoid,slope=ks.slope.dc.avoid,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.dc.avoidi.dc.avoid<-mean(ko.ss.avoid$dci)
ko.esc.dc.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.dc.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.dc.avoid<-mean(ko.ss.avoid$slope)
ko.mean.dc.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc.avoid,dci=ko.dc.avoidi.dc.avoid,esc=ko.esc.dc.avoid,steepness=ko.steep.dc.avoid,slope=ko.slope.dc.avoid,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.dc.avoidi.dc.avoid<-mean(hm.ss.avoid$dci)
hm.esc.dc.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.dc.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.dc.avoid<-mean(hm.ss.avoid$slope)
hm.mean.dc.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.dc.avoid,dci=hm.dc.avoidi.dc.avoid,esc=hm.esc.dc.avoid,steepness=hm.steep.dc.avoid,slope=hm.slope.dc.avoid,dist="clumped",calc="deterministic")

#history self
hs.tt.dc.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.dc.avoidi.dc.avoid<-mean(hs.ss.avoid$dci)
hs.esc.dc.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.dc.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.dc.avoid<-mean(hs.ss.avoid$slope)
hs.mean.dc.avoid<-data.frame(scenario="History self",tt=hs.tt.dc.avoid,dci=hs.dc.avoidi.dc.avoid,esc=hs.esc.dc.avoid,steepness=hs.steep.dc.avoid,slope=hs.slope.dc.avoid,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.dc.avoidi.dc.avoid<-mean(ho.ss.avoid$dci)
ho.esc.dc.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.dc.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.dc.avoid<-mean(ho.ss.avoid$slope)
ho.mean.dc.avoid<-data.frame(scenario="History opponent",tt=ho.tt.dc.avoid,dci=ho.dc.avoidi.dc.avoid,esc=ho.esc.dc.avoid,steepness=ho.steep.dc.avoid,slope=ho.slope.dc.avoid,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc.avoid,ks.mean.dc.avoid,ko.mean.dc.avoid,hm.mean.dc.avoid,hs.mean.dc.avoid,ho.mean.dc.avoid)

#create overall dataframe of summary statistics
overall.deter.clumped.avoid<-data.frame(km.ss.avoid)
overall.deter.clumped.avoid<-rbind(overall.deter.clumped.avoid,ks.ss.avoid)
overall.deter.clumped.avoid<-rbind(overall.deter.clumped.avoid,ko.ss.avoid)
overall.deter.clumped.avoid<-rbind(overall.deter.clumped.avoid,hm.ss.avoid)
overall.deter.clumped.avoid<-rbind(overall.deter.clumped.avoid,hs.ss.avoid)
overall.deter.clumped.avoid<-rbind(overall.deter.clumped.avoid,ho.ss.avoid)

overall.deter.clumped.avoid<-cbind(overall.deter.clumped.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.deter.clumped.avoid<-cbind(overall.deter.clumped.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("deter",60))


rhp.ss.avoid<-overall.deter.clumped.avoid[overall.deter.clumped.avoid$variable=="rhp",]
history.ss.avoid<-overall.deter.clumped.avoid[overall.deter.clumped.avoid$variable=="history",]

overall.deter.clumped.avoid$combo<-paste(overall.deter.clumped.avoid$strategy,overall.deter.clumped.avoid$variable,overall.deter.clumped.avoid$distribution)
overall.deter.clumped.avoid$combo2<-paste(overall.deter.clumped.avoid$strategy,overall.deter.clumped.avoid$variable)
```

```{r attacks clumped deter message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.km.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/km_dc_attacks_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ks.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ks_dc_attacks_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.ko.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ko_dc_attacks_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.hm.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hm_dc_attacks_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)


mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.hs.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/hs_dc_attacks_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.dc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.ho.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_clumped/ho_dc_attacks_mat10.csv")
```
```{r attacks clumped deter data frame}
#knowledge mutual
km.tt.dc.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.dc.attacksi.dc.attacks<-mean(km.ss.attacks$dci)
km.esc.dc.attacks<-mean(km.ss.attacks$escalation)
km.steep.dc.attacks<-mean(km.ss.attacks$steepness)
km.slope.dc.attacks<-mean(km.ss.attacks$slope)
km.mean.dc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.attacks,dci=km.dc.attacksi.dc.attacks,esc=km.esc.dc.attacks,steepness=km.steep.dc.attacks,slope=km.slope.dc.attacks,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.dc.attacksi.dc.attacks<-mean(ks.ss.attacks$dci)
ks.esc.dc.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.dc.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.dc.attacks<-mean(ks.ss.attacks$slope)
ks.mean.dc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.dc.attacks,dci=ks.dc.attacksi.dc.attacks,esc=ks.esc.dc.attacks,steepness=ks.steep.dc.attacks,slope=ks.slope.dc.attacks,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.dc.attacksi.dc.attacks<-mean(ko.ss.attacks$dci)
ko.esc.dc.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.dc.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.dc.attacks<-mean(ko.ss.attacks$slope)
ko.mean.dc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc.attacks,dci=ko.dc.attacksi.dc.attacks,esc=ko.esc.dc.attacks,steepness=ko.steep.dc.attacks,slope=ko.slope.dc.attacks,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.dc.attacksi.dc.attacks<-mean(hm.ss.attacks$dci)
hm.esc.dc.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.dc.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.dc.attacks<-mean(hm.ss.attacks$slope)
hm.mean.dc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.dc.attacks,dci=hm.dc.attacksi.dc.attacks,esc=hm.esc.dc.attacks,steepness=hm.steep.dc.attacks,slope=hm.slope.dc.attacks,dist="clumped",calc="deterministic")

#history self
hs.tt.dc.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.dc.attacksi.dc.attacks<-mean(hs.ss.attacks$dci)
hs.esc.dc.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.dc.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.dc.attacks<-mean(hs.ss.attacks$slope)
hs.mean.dc.attacks<-data.frame(scenario="History self",tt=hs.tt.dc.attacks,dci=hs.dc.attacksi.dc.attacks,esc=hs.esc.dc.attacks,steepness=hs.steep.dc.attacks,slope=hs.slope.dc.attacks,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.dc.attacksi.dc.attacks<-mean(ho.ss.attacks$dci)
ho.esc.dc.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.dc.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.dc.attacks<-mean(ho.ss.attacks$slope)
ho.mean.dc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.dc.attacks,dci=ho.dc.attacksi.dc.attacks,esc=ho.esc.dc.attacks,steepness=ho.steep.dc.attacks,slope=ho.slope.dc.attacks,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc.attacks,ks.mean.dc.attacks,ko.mean.dc.attacks,hm.mean.dc.attacks,hs.mean.dc.attacks,ho.mean.dc.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.dc.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.dc.attacksi.dc.attacks<-mean(km.ss.attacks$dci)
km.esc.dc.attacks<-mean(km.ss.attacks$escalation)
km.steep.dc.attacks<-mean(km.ss.attacks$steepness)
km.slope.dc.attacks<-mean(km.ss.attacks$slope)
km.mean.dc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.attacks,dci=km.dc.attacksi.dc.attacks,esc=km.esc.dc.attacks,steepness=km.steep.dc.attacks,slope=km.slope.dc.attacks,dist="clumped",calc="deterministic")

#knowledge self
ks.tt.dc.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.dc.attacksi.dc.attacks<-mean(ks.ss.attacks$dci)
ks.esc.dc.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.dc.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.dc.attacks<-mean(ks.ss.attacks$slope)
ks.mean.dc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.dc.attacks,dci=ks.dc.attacksi.dc.attacks,esc=ks.esc.dc.attacks,steepness=ks.steep.dc.attacks,slope=ks.slope.dc.attacks,dist="clumped",calc="deterministic")

#knowledge opponent
ko.tt.dc.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.dc.attacksi.dc.attacks<-mean(ko.ss.attacks$dci)
ko.esc.dc.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.dc.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.dc.attacks<-mean(ko.ss.attacks$slope)
ko.mean.dc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.dc.attacks,dci=ko.dc.attacksi.dc.attacks,esc=ko.esc.dc.attacks,steepness=ko.steep.dc.attacks,slope=ko.slope.dc.attacks,dist="clumped",calc="deterministic")

#history mutual
hm.tt.dc.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.dc.attacksi.dc.attacks<-mean(hm.ss.attacks$dci)
hm.esc.dc.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.dc.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.dc.attacks<-mean(hm.ss.attacks$slope)
hm.mean.dc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.dc.attacks,dci=hm.dc.attacksi.dc.attacks,esc=hm.esc.dc.attacks,steepness=hm.steep.dc.attacks,slope=hm.slope.dc.attacks,dist="clumped",calc="deterministic")

#history self
hs.tt.dc.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.dc.attacksi.dc.attacks<-mean(hs.ss.attacks$dci)
hs.esc.dc.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.dc.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.dc.attacks<-mean(hs.ss.attacks$slope)
hs.mean.dc.attacks<-data.frame(scenario="History self",tt=hs.tt.dc.attacks,dci=hs.dc.attacksi.dc.attacks,esc=hs.esc.dc.attacks,steepness=hs.steep.dc.attacks,slope=hs.slope.dc.attacks,dist="clumped",calc="deterministic")

#history opponent
ho.tt.dc.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.dc.attacksi.dc.attacks<-mean(ho.ss.attacks$dci)
ho.esc.dc.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.dc.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.dc.attacks<-mean(ho.ss.attacks$slope)
ho.mean.dc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.dc.attacks,dci=ho.dc.attacksi.dc.attacks,esc=ho.esc.dc.attacks,steepness=ho.steep.dc.attacks,slope=ho.slope.dc.attacks,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.dc.attacks,ks.mean.dc.attacks,ko.mean.dc.attacks,hm.mean.dc.attacks,hs.mean.dc.attacks,ho.mean.dc.attacks)

#create overall dataframe of summary statistics
overall.deter.clumped.attacks<-data.frame(km.ss.attacks)
overall.deter.clumped.attacks<-rbind(overall.deter.clumped.attacks,ks.ss.attacks)
overall.deter.clumped.attacks<-rbind(overall.deter.clumped.attacks,ko.ss.attacks)
overall.deter.clumped.attacks<-rbind(overall.deter.clumped.attacks,hm.ss.attacks)
overall.deter.clumped.attacks<-rbind(overall.deter.clumped.attacks,hs.ss.attacks)
overall.deter.clumped.attacks<-rbind(overall.deter.clumped.attacks,ho.ss.attacks)

overall.deter.clumped.attacks<-cbind(overall.deter.clumped.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.deter.clumped.attacks<-cbind(overall.deter.clumped.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("deter",60))


rhp.ss.attacks<-overall.deter.clumped.attacks[overall.deter.clumped.attacks$variable=="rhp",]
history.ss.attacks<-overall.deter.clumped.attacks[overall.deter.clumped.attacks$variable=="history",]

overall.deter.clumped.attacks$combo<-paste(overall.deter.clumped.attacks$strategy,overall.deter.clumped.attacks$variable,overall.deter.clumped.attacks$distribution)
overall.deter.clumped.attacks$combo2<-paste(overall.deter.clumped.attacks$strategy,overall.deter.clumped.attacks$variable)
```

```{r uniform deter message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/km_du_mat1.csv")
#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.km.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/km_du_mat10.csv")
#knowledge self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ks_du_mat10.csv")
#knowledge opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.ko.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ko_du_mat10.csv")
#history mutual uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hm_du_mat10.csv")
#history self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/hs_du_mat10.csv")
#history opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.du<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.ho.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Deterministic_uniform/ho_du_mat10.csv")


km.lm.du<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.du<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.du<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.du<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.du<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.du<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r uniform deter data frame}
#energy data frame
total.energy.du<-data.frame(energy.km.df)
total.energy.du<-rbind(total.energy.du,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.du<-data.frame(david.km.df)
total.david.du<-rbind(total.david.du,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.du<-cbind(total.energy.du,normDS=total.david.du$normDS)

#knowledge mutual
km.tt.du<-mean(km.ss$triangle.transitivity)
km.dci.du<-mean(km.ss$dci)
km.esc.du<-mean(km.ss$escalation)
km.steep.du<-mean(km.ss$steepness)
km.slope.du<-mean(km.ss$slope)
km.mean.du<-data.frame(scenario="Knowledge Mutual",tt=km.tt.du,dci=km.dci.du,esc=km.esc.du,steepness=km.steep.du,slope=km.slope.du,dist="uniform",calc="deterministic")

#knowledge self
ks.tt.du<-mean(ks.ss$triangle.transitivity)
ks.dci.du<-mean(ks.ss$dci)
ks.esc.du<-mean(ks.ss$escalation)
ks.steep.du<-mean(ks.ss$steepness)
ks.slope.du<-mean(ks.ss$slope)
ks.mean.du<-data.frame(scenario="Knowledge self",tt=ks.tt.du,dci=ks.dci.du,esc=ks.esc.du,steepness=ks.steep.du,slope=ks.slope.du,dist="uniform",calc="deterministic")

#knowledge opponent
ko.tt.du<-mean(ko.ss$triangle.transitivity)
ko.dci.du<-mean(ko.ss$dci)
ko.esc.du<-mean(ko.ss$escalation)
ko.steep.du<-mean(ko.ss$steepness)
ko.slope.du<-mean(ko.ss$slope)
ko.mean.du<-data.frame(scenario="Knowledge opponent",tt=ko.tt.du,dci=ko.dci.du,esc=ko.esc.du,steepness=ko.steep.du,slope=ko.slope.du,dist="uniform",calc="deterministic")

#history mutual
hm.tt.du<-mean(hm.ss$triangle.transitivity)
hm.dci.du<-mean(hm.ss$dci)
hm.esc.du<-mean(hm.ss$escalation)
hm.steep.du<-mean(hm.ss$steepness)
hm.slope.du<-mean(hm.ss$slope)
hm.mean.du<-data.frame(scenario="History Mutual",tt=hm.tt.du,dci=hm.dci.du,esc=hm.esc.du,steepness=hm.steep.du,slope=hm.slope.du,dist="uniform",calc="deterministic")

#history self
hs.tt.du<-mean(hs.ss$triangle.transitivity)
hs.dci.du<-mean(hs.ss$dci)
hs.esc.du<-mean(hs.ss$escalation)
hs.steep.du<-mean(hs.ss$steepness)
hs.slope.du<-mean(hs.ss$slope)
hs.mean.du<-data.frame(scenario="History self",tt=hs.tt.du,dci=hs.dci.du,esc=hs.esc.du,steepness=hs.steep.du,slope=hs.slope.du,dist="uniform",calc="deterministic")

#history opponent
ho.tt.du<-mean(ho.ss$triangle.transitivity)
ho.dci.du<-mean(ho.ss$dci)
ho.esc.du<-mean(ho.ss$escalation)
ho.steep.du<-mean(ho.ss$steepness)
ho.slope.du<-mean(ho.ss$slope)
ho.mean.du<-data.frame(scenario="History opponent",tt=ho.tt.du,dci=ho.dci.du,esc=ho.esc.du,steepness=ho.steep.du,slope=ho.slope.du,dist="uniform",calc="deterministic")

#total average dataframe
du.ave<-rbind(km.mean.du,ks.mean.du,ko.mean.du,hm.mean.du,hs.mean.du,ho.mean.du)


#create overall dataframe of summary statistics
overall.unif.deter<-data.frame(km.ss)
overall.unif.deter<-rbind(overall.unif.deter,ks.ss)
overall.unif.deter<-rbind(overall.unif.deter,ko.ss)
overall.unif.deter<-rbind(overall.unif.deter,hm.ss)
overall.unif.deter<-rbind(overall.unif.deter,hs.ss)
overall.unif.deter<-rbind(overall.unif.deter,ho.ss)

overall.unif.deter<-cbind(overall.unif.deter,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.deter<-cbind(overall.unif.deter,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("deter",60))


rhp.ss<-overall.unif.deter[overall.unif.deter$variable=="rhp",]
history.ss<-overall.unif.deter[overall.unif.deter$variable=="history",]


overall.unif.deter$combo<-paste(overall.unif.deter$strategy,overall.unif.deter$variable,overall.unif.deter$distribution)
overall.unif.deter$combo2<-paste(overall.clump.deter$strategy,overall.clump.deter$variable)
```

```{r avoid uniform deter message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.km.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/km_du_avoid_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ks.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ks_du_avoid_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ko.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ko_du_avoid_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.hm.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hm_du_avoid_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)


mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.hs.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/hs_du_avoid_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.du.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ho.dc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Deterministic_uniform/ho_du_avoid_mat10.csv")
```
```{r avoid uniform deter data frame}
#knowledge mutual
km.tt.du.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.dci.du.avoid<-mean(km.ss.avoid$dci)
km.esc.du.avoid<-mean(km.ss.avoid$escalation)
km.steep.du.avoid<-mean(km.ss.avoid$steepness)
km.slope.du.avoid<-mean(km.ss.avoid$slope)
km.mean.du.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.du.avoid,dci=km.dci.du.avoid,esc=km.esc.du.avoid,steepness=km.steep.du.avoid,slope=km.slope.du.avoid,dist="uniform",calc="deterministic")

#knowledge self
ks.tt.du.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.dci.du.avoid<-mean(ks.ss.avoid$dci)
ks.esc.du.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.du.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.du.avoid<-mean(ks.ss.avoid$slope)
ks.mean.du.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.du.avoid,dci=ks.dci.du.avoid,esc=ks.esc.du.avoid,steepness=ks.steep.du.avoid,slope=ks.slope.du.avoid,dist="uniform",calc="deterministic")

#knowledge opponent
ko.tt.du.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.dci.du.avoid<-mean(ko.ss.avoid$dci)
ko.esc.du.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.du.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.du.avoid<-mean(ko.ss.avoid$slope)
ko.mean.du.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.du.avoid,dci=ko.dci.du.avoid,esc=ko.esc.du.avoid,steepness=ko.steep.du.avoid,slope=ko.slope.du.avoid,dist="uniform",calc="deterministic")

#history mutual
hm.tt.du.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.dci.du.avoid<-mean(hm.ss.avoid$dci)
hm.esc.du.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.du.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.du.avoid<-mean(hm.ss.avoid$slope)
hm.mean.du.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.du.avoid,dci=hm.dci.du.avoid,esc=hm.esc.du.avoid,steepness=hm.steep.du.avoid,slope=hm.slope.du.avoid,dist="uniform",calc="deterministic")

#history self
hs.tt.du.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.dci.du.avoid<-mean(hs.ss.avoid$dci)
hs.esc.du.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.du.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.du.avoid<-mean(hs.ss.avoid$slope)
hs.mean.du.avoid<-data.frame(scenario="History self",tt=hs.tt.du.avoid,dci=hs.dci.du.avoid,esc=hs.esc.du.avoid,steepness=hs.steep.du.avoid,slope=hs.slope.du.avoid,dist="uniform",calc="deterministic")

#history opponent
ho.tt.du.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.dci.du.avoid<-mean(ho.ss.avoid$dci)
ho.esc.du.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.du.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.du.avoid<-mean(ho.ss.avoid$slope)
ho.mean.du.avoid<-data.frame(scenario="History opponent",tt=ho.tt.du.avoid,dci=ho.dci.du.avoid,esc=ho.esc.du.avoid,steepness=ho.steep.du.avoid,slope=ho.slope.du.avoid,dist="uniform",calc="deterministic")

#total average dataframe
du.ave<-rbind(km.mean.du.avoid,ks.mean.du.avoid,ko.mean.du.avoid,hm.mean.du.avoid,hs.mean.du.avoid,ho.mean.du.avoid)


#create overall dataframe of summary statistics
overall.deter.uniform.avoid<-data.frame(km.ss.avoid)
overall.deter.uniform.avoid<-rbind(overall.deter.uniform.avoid,ks.ss.avoid)
overall.deter.uniform.avoid<-rbind(overall.deter.uniform.avoid,ko.ss.avoid)
overall.deter.uniform.avoid<-rbind(overall.deter.uniform.avoid,hm.ss.avoid)
overall.deter.uniform.avoid<-rbind(overall.deter.uniform.avoid,hs.ss.avoid)
overall.deter.uniform.avoid<-rbind(overall.deter.uniform.avoid,ho.ss.avoid)

overall.deter.uniform.avoid<-cbind(overall.deter.uniform.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.deter.uniform.avoid<-cbind(overall.deter.uniform.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("deter",60))


rhp.ss.avoid<-overall.deter.uniform.avoid[overall.deter.uniform.avoid$variable=="rhp",]
history.ss.avoid<-overall.deter.uniform.avoid[overall.deter.uniform.avoid$variable=="history",]


overall.deter.uniform.avoid$combo<-paste(overall.deter.uniform.avoid$strategy,overall.deter.uniform.avoid$variable,overall.deter.uniform.avoid$distribution)
overall.deter.uniform.avoid$combo2<-paste(overall.deter.uniform.avoid$strategy,overall.deter.uniform.avoid$variable)
```

```{r attacks uniform deter message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.km.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/km_du_attacks_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ks.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ks_du_attacks_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ko.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ko_du_attacks_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.hm.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hm_du_attacks_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)


mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.hs.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/hs_du_attacks_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.du.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ho.du<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Deterministic_uniform/ho_du_attacks_mat10.csv")
```
```{r attacks uniform deter data frame}
#knowledge mutual
km.tt.du.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.dci.du.attacks<-mean(km.ss.attacks$dci)
km.esc.du.attacks<-mean(km.ss.attacks$escalation)
km.steep.du.attacks<-mean(km.ss.attacks$steepness)
km.slope.du.attacks<-mean(km.ss.attacks$slope)
km.mean.du.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.du.attacks,dci=km.dci.du.attacks,esc=km.esc.du.attacks,steepness=km.steep.du.attacks,slope=km.slope.du.attacks,dist="uniform",calc="deterministic")

#knowledge self
ks.tt.du.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.dci.du.attacks<-mean(ks.ss.attacks$dci)
ks.esc.du.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.du.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.du.attacks<-mean(ks.ss.attacks$slope)
ks.mean.du.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.du.attacks,dci=ks.dci.du.attacks,esc=ks.esc.du.attacks,steepness=ks.steep.du.attacks,slope=ks.slope.du.attacks,dist="uniform",calc="deterministic")

#knowledge opponent
ko.tt.du.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.dci.du.attacks<-mean(ko.ss.attacks$dci)
ko.esc.du.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.du.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.du.attacks<-mean(ko.ss.attacks$slope)
ko.mean.du.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.du.attacks,dci=ko.dci.du.attacks,esc=ko.esc.du.attacks,steepness=ko.steep.du.attacks,slope=ko.slope.du.attacks,dist="uniform",calc="deterministic")

#history mutual
hm.tt.du.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.dci.du.attacks<-mean(hm.ss.attacks$dci)
hm.esc.du.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.du.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.du.attacks<-mean(hm.ss.attacks$slope)
hm.mean.du.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.du.attacks,dci=hm.dci.du.attacks,esc=hm.esc.du.attacks,steepness=hm.steep.du.attacks,slope=hm.slope.du.attacks,dist="uniform",calc="deterministic")

#history self
hs.tt.du.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.dci.du.attacks<-mean(hs.ss.attacks$dci)
hs.esc.du.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.du.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.du.attacks<-mean(hs.ss.attacks$slope)
hs.mean.du.attacks<-data.frame(scenario="History self",tt=hs.tt.du.attacks,dci=hs.dci.du.attacks,esc=hs.esc.du.attacks,steepness=hs.steep.du.attacks,slope=hs.slope.du.attacks,dist="uniform",calc="deterministic")

#history opponent
ho.tt.du.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.dci.du.attacks<-mean(ho.ss.attacks$dci)
ho.esc.du.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.du.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.du.attacks<-mean(ho.ss.attacks$slope)
ho.mean.du.attacks<-data.frame(scenario="History opponent",tt=ho.tt.du.attacks,dci=ho.dci.du.attacks,esc=ho.esc.du.attacks,steepness=ho.steep.du.attacks,slope=ho.slope.du.attacks,dist="uniform",calc="deterministic")

#total average dataframe
du.ave<-rbind(km.mean.du.attacks,ks.mean.du.attacks,ko.mean.du.attacks,hm.mean.du.attacks,hs.mean.du.attacks,ho.mean.du.attacks)


#create overall dataframe of summary statistics
overall.deter.uniform.attacks<-data.frame(km.ss.attacks)
overall.deter.uniform.attacks<-rbind(overall.deter.uniform.attacks,ks.ss.attacks)
overall.deter.uniform.attacks<-rbind(overall.deter.uniform.attacks,ko.ss.attacks)
overall.deter.uniform.attacks<-rbind(overall.deter.uniform.attacks,hm.ss.attacks)
overall.deter.uniform.attacks<-rbind(overall.deter.uniform.attacks,hs.ss.attacks)
overall.deter.uniform.attacks<-rbind(overall.deter.uniform.attacks,ho.ss.attacks)

overall.deter.uniform.attacks<-cbind(overall.deter.uniform.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.deter.uniform.attacks<-cbind(overall.deter.uniform.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("deter",60))


rhp.ss.attacks<-overall.deter.uniform.attacks[overall.deter.uniform.attacks$variable=="rhp",]
history.ss.attacks<-overall.deter.uniform.attacks[overall.deter.uniform.attacks$variable=="history",]


overall.deter.uniform.attacks$combo<-paste(overall.deter.uniform.attacks$strategy,overall.deter.uniform.attacks$variable,overall.deter.uniform.attacks$distribution)
overall.deter.uniform.attacks$combo2<-paste(overall.deter.uniform.attacks$strategy,overall.deter.uniform.attacks$variable)
```

```{r full overall deter data frame}
overall.ss.deter=rbind(overall.clump.deter,overall.unif.deter)

overall.deter.data<-overall.ss.deter[,1:8]

total.energy.dc<-cbind(total.energy.dc, distribution=(rep("clumped",600)))
total.energy.du<-cbind(total.energy.du, distribution=(rep("uniform",600)))
overall.energy<-rbind(total.energy.dc, total.energy.du)

write.csv(overall.deter.data,"~/Desktop/deterministic_data_frame.csv",row.names=F)
```
```{r full overall deter avoid data frame}
overall.ss.deter.clumped.avoid=rbind(overall.deter.clumped.avoid,overall.deter.uniform.avoid)

overall.deter.clumped.avoid.data<-overall.ss.deter.clumped.avoid[,1:8]

write.csv(overall.deter.clumped.avoid.data,"~/Desktop/avoid_deterministic_data_frame.csv",row.names=F)
```
```{r full overall deter attacks data frame}
overall.ss.deter.clumped.attacks=rbind(overall.deter.clumped.attacks,overall.deter.uniform.attacks)

overall.deter.clumped.attacks.data<-overall.ss.deter.clumped.attacks[,1:8]

write.csv(overall.deter.clumped.attacks.data,"~/Desktop/attacks_deterministic_data_frame.csv",row.names=F)
```
```{r full overall deter avoid data frame}
overall.ss.deter.uniform.avoid=rbind(overall.deter.clumped.avoid,overall.deter.uniform.avoid)

overall.deter.uniform.avoid.data<-overall.ss.deter.uniform.avoid[,1:8]

write.csv(overall.deter.uniform.avoid.data,"~/Desktop/avoid_deterministic_data_frame.csv",row.names=F)
```
```{r full overall deter attacks data frame}
overall.ss.deter.uniform.attacks=rbind(overall.deter.clumped.attacks,overall.deter.uniform.attacks)

overall.deter.uniform.attacks.data<-overall.ss.deter.uniform.attacks[,1:8]

write.csv(overall.deter.uniform.attacks.data,"~/Desktop/attacks_deterministic_data_frame.csv",row.names=F)
```

```{r deterministic clumped summary table}
km.st<-overall.ss.deter[overall.ss.deter$combo=="mutual rhp clumped",]
  km.tt<-mean(km.st$triangle.transitivity)
  km.dci<-mean(km.st$dci)
  km.poa<-mean(km.st$escalation)
  km.steep<-abs(mean(km.st$steepness))
  km.ov<-data.frame(Knowledge.Mutual = c(km.poa,km.dci,km.tt,km.steep,avg.int.km.dc,avg.av.km.dc))
  
ks.st<-overall.ss.deter[overall.ss.deter$combo=="self rhp clumped",]
  ks.tt<-mean(ks.st$triangle.transitivity)
  ks.dci<-mean(ks.st$dci)
  ks.poa<-mean(ks.st$escalation)
  ks.steep<-abs(mean(ks.st$steepness))
  ks.ov<-data.frame(Knowledge.Self = c(ks.poa,ks.dci,ks.tt,ks.steep,avg.int.ks.dc,avg.av.ks.dc))

  
ko.st<-overall.ss.deter[overall.ss.deter$combo=="opponent rhp clumped",]
  ko.tt<-mean(ko.st$triangle.transitivity)
  ko.dci<-mean(ko.st$dci)
  ko.poa<-mean(ko.st$escalation)
  ko.steep<-abs(mean(ko.st$steepness))
  ko.ov<-data.frame(Knowledge.Opponent = c(ko.poa,ko.dci,ko.tt,ko.steep,avg.int.ko.dc,avg.av.ko.dc))


hm.st<-overall.ss.deter[overall.ss.deter$combo=="mutual history clumped",]
  hm.tt<-mean(hm.st$triangle.transitivity)
  hm.dci<-mean(hm.st$dci)
  hm.poa<-mean(hm.st$escalation)
  hm.steep<-abs(mean(hm.st$steepness))
  hm.ov<-data.frame(History.Mutual = c(hm.poa,hm.dci,hm.tt,hm.steep,avg.int.hm.dc,avg.av.hm.dc))


hs.st<-overall.ss.deter[overall.ss.deter$combo=="self history clumped",]
  hs.tt<-mean(hs.st$triangle.transitivity)
  hs.dci<-mean(hs.st$dci)
  hs.poa<-mean(hs.st$escalation)
  hs.steep<-abs(mean(hs.st$steepness))
  hs.ov<-data.frame(History.Self = c(hs.poa,hs.dci,hs.tt,hs.steep,avg.int.hs.dc,avg.av.hs.dc))


ho.st<-overall.ss.deter[overall.ss.deter$combo=="opponent history clumped",]
  ho.tt<-mean(ho.st$triangle.transitivity)
  ho.dci<-mean(ho.st$dci)
  ho.poa<-mean(ho.st$escalation)
  ho.steep<-abs(mean(ho.st$steepness))
  ho.ov<-data.frame(History.Opponent = c(ho.poa,ho.dci,ho.tt,ho.steep,avg.int.ho.dc,avg.av.ho.dc))

overall.c.st<-data.frame(kno.mut=km.ov,hist.mut=hm.ov,kno.self=ks.ov,hist.self=hs.ov,kno.opp=ko.ov,hist.opp=ho.ov)
row.names(overall.c.st)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st

write.csv(overall.c.st,"~/Desktop/overall_summary_table_dc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r deterministic uniform summary table}
km.st.u<-overall.ss.deter[overall.ss.deter$combo=="mutual rhp uniform",]
  km.tt.u<-mean(km.st.u$triangle.transitivity)
  km.dci.u<-mean(km.st.u$dci)
  km.poa.u<-mean(km.st.u$escalation)
  km.steep.u<-abs(mean(km.st.u$steepness))
  km.ov.u<-data.frame(Knowledge.Mutual = c(km.poa.u,km.dci.u,km.tt.u,km.steep.u,avg.int.km.du,avg.av.km.du))
  
ks.st.u<-overall.ss.deter[overall.ss.deter$combo=="self rhp uniform",]
  ks.tt.u<-mean(ks.st.u$triangle.transitivity)
  ks.dci.u<-mean(ks.st.u$dci)
  ks.poa.u<-mean(ks.st.u$escalation)
  ks.steep.u<-abs(mean(ks.st.u$steepness))
  ks.ov.u<-data.frame(Knowledge.Self = c(ks.poa.u,ks.dci.u,ks.tt.u,ks.steep.u,avg.int.ks.du,avg.av.ks.du))

  
ko.st.u<-overall.ss.deter[overall.ss.deter$combo=="opponent rhp uniform",]
  ko.tt.u<-mean(ko.st.u$triangle.transitivity)
  ko.dci.u<-mean(ko.st.u$dci)
  ko.poa.u<-mean(ko.st.u$escalation)
  ko.steep.u<-abs(mean(ko.st.u$steepness))
  ko.ov.u<-data.frame(Knowledge.Opponent = c(ko.poa.u,ko.dci.u,ko.tt.u,ko.steep.u,avg.int.ko.du,avg.av.ko.du))


hm.st.u<-overall.ss.deter[overall.ss.deter$combo=="mutual history uniform",]
  hm.tt.u<-mean(hm.st.u$triangle.transitivity)
  hm.dci.u<-mean(hm.st.u$dci)
  hm.poa.u<-mean(hm.st.u$escalation)
  hm.steep.u<-abs(mean(hm.st.u$steepness))
  hm.ov.u<-data.frame(History.Mutual = c(hm.poa.u,hm.dci.u,hm.tt.u,hm.steep.u,avg.int.hm.du,avg.av.hm.du))


hs.st.u<-overall.ss.deter[overall.ss.deter$combo=="self history uniform",]
  hs.tt.u<-mean(hs.st.u$triangle.transitivity)
  hs.dci.u<-mean(hs.st.u$dci)
  hs.poa.u<-mean(hs.st.u$escalation)
  hs.steep.u<-abs(mean(hs.st.u$steepness))
  hs.ov.u<-data.frame(History.Self = c(hs.poa.u,hs.dci.u,hs.tt.u,hs.steep.u,avg.int.hs.du,avg.av.hs.du))


ho.st.u<-overall.ss.deter[overall.ss.deter$combo=="opponent history uniform",]
  ho.tt.u<-mean(ho.st.u$triangle.transitivity)
  ho.dci.u<-mean(ho.st.u$dci)
  ho.poa.u<-mean(ho.st.u$escalation)
  ho.steep.u<-abs(mean(ho.st.u$steepness))
  ho.ov.u<-data.frame(History.Opponent = c(ho.poa.u,ho.dci.u,ho.tt.u,ho.steep.u,avg.int.ho.du,avg.av.ho.du))

overall.c.st.u<-data.frame(kno.mut=km.ov.u,hist.mut=hm.ov.u,kno.self=ks.ov.u,hist.self=hs.ov.u,kno.opp=ko.ov.u,hist.opp=ho.ov.u)
row.names(overall.c.st.u)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st.u

write.csv(overall.c.st.u,"~/Desktop/overall_summary_table_du.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r deterministic clumped avoid summary table}
km.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="mutual rhp clumped",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.dci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.st.avoid$escalation)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.dci.avoid,km.tt.avoid,km..steep.avoid,avg.int.km.dc.avoid,avg.av.km.dc.avoid))
  
ks.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="self rhp clumped",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.dci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.st.avoid$escalation)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.dci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.ks.dc.avoid,avg.av.ks.dc.avoid))

  
ko.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="opponent rhp clumped",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.dci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.st.avoid$escalation)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.dci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.ko.dc.avoid,avg.av.ko.dc.avoid))


hm.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="mutual history clumped",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.dci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.st.avoid$escalation)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.dci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.hm.dc.avoid,avg.av.km.dc.avoid))


hs.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="self history clumped",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.dci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.st.avoid$escalation)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.dci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.hs.dc.avoid,avg.av.hs.dc.avoid))


ho.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="opponent history clumped",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.dci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.st.avoid$escalation)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.dci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.ho.dc.avoid,avg.av.ho.dc.avoid))

overall.c.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.c.st.avoid)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st.avoid

write.csv(overall.c.st.avoid,"~/Desktop/overall_clump_avoid_summary_table_dc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter.avoid,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r deterministic clumped attacks summary table}
km.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="mutual rhp clumped",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.dci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.st.attacks$escalation)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.dci.attacks,km.tt.attacks,km..steep.attacks,avg.int.attacks.km.dc,avg.av.km.dc.attacks))
  
ks.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="self rhp clumped",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.dci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.st.attacks$escalation)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.dci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.attacks.ks.dc,avg.av.ks.dc.attacks))

  
ko.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="opponent rhp clumped",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.dci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.st.attacks$escalation)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.dci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.attacks.ko.dc,avg.av.ko.dc.attacks))


hm.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="mutual history clumped",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.dci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.st.attacks$escalation)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.dci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.attacks.hm.dc,avg.av.hm.dc.attacks))


hs.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="self history clumped",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.dci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.st.attacks$escalation)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.dci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.attacks.hs.dc,avg.av.hs.dc.attacks))


ho.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="opponent history clumped",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.dci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.st.attacks$escalation)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.dci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.attacks.ho.dc,avg.av.ho.dc.attacks))

overall.c.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.c.st.attacks)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks","Average Avoids")

overall.c.st.attacks

write.csv(overall.c.st.attacks,"~/Desktop/overall_clump_attacks_summary_table_dc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter.attacks,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r deterministic uniform avoid summary table}
km.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="mutual rhp uniform",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.dci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.st.avoid$escalation)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.dci.avoid,km.tt.avoid,km..steep.avoid,avg.int.avoid.km.dc,avg.av.km.du.avoid))
  
ks.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="self rhp uniform",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.dci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.st.avoid$escalation)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.dci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.avoid.ks.dc,avg.av.ks.du.avoid))

  
ko.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="opponent rhp uniform",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.dci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.st.avoid$escalation)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.dci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.avoid.ko.dc,avg.av.ko.du.avoid))


hm.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="mutual history uniform",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.dci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.st.avoid$escalation)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.dci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.avoid.hm.dc,avg.av.hm.du.avoid))


hs.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="self history uniform",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.dci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.st.avoid$escalation)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.dci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.avoid.hs.dc,avg.av.hs.du.avoid))


ho.st.avoid<-overall.ss.deter.avoid[overall.ss.deter.avoid$combo=="opponent history uniform",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.dci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.st.avoid$escalation)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.dci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.avoid.ho.dc,avg.av.ho.du.avoid))

overall.u.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.u.st.avoid)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.u.st.avoid

write.csv(overall.u.st.avoid,"~/Desktop/overall_uniform_avoid_summary_table_dc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter.avoid,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r deterministic uniform attacks summary table}
km.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="mutual rhp uniform",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.dci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.st.attacks$escalation)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.dci.attacks,km.tt.attacks,km..steep.attacks,avg.int.attacks.km.dc,avg.av.km.du.attacks))
  
ks.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="self rhp uniform",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.dci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.st.attacks$escalation)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.dci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.attacks.ks.dc,avg.av.ks.du.attacks))

  
ko.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="opponent rhp uniform",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.dci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.st.attacks$escalation)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.dci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.attacks.ko.dc,avg.av.ko.du.attacks))


hm.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="mutual history uniform",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.dci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.st.attacks$escalation)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.dci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.attacks.hm.dc,avg.av.hm.du.attacks))


hs.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="self history uniform",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.dci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.st.attacks$escalation)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.dci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.attacks.hs.dc,avg.av.hs.du.attacks))


ho.st.attacks<-overall.ss.deter.attacks[overall.ss.deter.attacks$combo=="opponent history uniform",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.dci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.st.attacks$escalation)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.dci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.attacks.ho.dc,avg.av.ho.du.attacks))

overall.u.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.u.st.attacks)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.u.st.attacks

write.csv(overall.u.st.attacks,"~/Desktop/overall_uniform_attacks_summary_table_dc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.deter.attacks,"~/Desktop/overall_deterministic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
````{r energy averages dataframe}
#total.energy.dc
library(zoo)
library(dplyr)
n <- 100

sums.energy.dc<-rollapply(total.energy.dc$energy_over_time, n, mean, by = n)

#total.energy.du
sums.energy.du<-rollapply(total.energy.du$energy_over_time, n, mean, by = n)

energy.averages<-data.frame(Heterogenous=sums.energy.dc,Homogenous=sums.energy.du)
energy.averages<-cbind(energy.averages,Scenario=c("Mutual Knowledge","Self Knowledge","Opponent Knowledge","Mutual History","Self History","Opponent History"))

order<-c("Self Knowledge","Self History","Opponent Knowledge","Opponent History","Mutual Knowledge","Mutual History")
energy.averages.final<-energy.averages %>%
                          slice(match(order, Scenario))

write.csv(energy.averages.final,"~/Desktop/energy.averages.csv")
```

```{r new attack proportions}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
attack.prop<-read.csv("contest_dev_2 decdetonly.csv")

attack.prop.2<-attack.prop[c(1:10),]
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(12:21),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(23:32),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(34:43),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(45:54),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(56:65),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(68:77),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(79:88),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(90:99),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(101:110),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(112:121),])
attack.prop.2<-rbind(attack.prop.2,attack.prop[c(123:132),])
attack.prop.2<-cbind(attack.prop.2,combo2=c(rep("mutual history",10),rep("opponent history",10),rep("self history",10),rep("mutual rhp",10),rep("opponent rhp",10),rep("self rhp",10)))
```

#Figure 2
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p9<-attack.prop.2 %>%
  ggplot( aes(x=combo2, y=prop.attacks.all.interactions,color=resource.dist)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=resource.dist),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Proportion of Attack") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=0.05, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(0.1,0.65))
jpeg("contest.comp_figure_2.jpeg", 336, 336)
p9
dev.off()

p9
  #p10<-overall.ss.prob %>%
  #  ggplot( aes(x=combo, y=escalation,color=distribution)) +
  #    geom_boxplot(color="black", outlier.shape=NA) +
  #    geom_point(aes(shape=distribution),size=2)+
  #    xlab("")+
  #    ylab("Proportional Escalation") +
  #    theme(axis.text.x = element_blank(),axis.text.x=element_text(size=10),axis.text.y=element_text(size=10),panel.border=element_rect(colour="black", size=3, fill=NA))+
  #    scale_color_manual(values = c("blue","#CC5500"))
    

#Figure 3
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p1 <- overall.ss.deter %>%
  ggplot( aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05, 1.05))
jpeg("contest.comp_figure_3a.jpeg", 336, 336)
p1
dev.off()

p2 <- overall.ss.deter %>%
  ggplot( aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_3b.jpeg", 336, 336)
p2
dev.off()
    
p3 <- overall.ss.deter %>%
  ggplot( aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_3c.jpeg", 336, 336)
p3
dev.off()

p2
p1
p3

 #p5 <- overall.ss.prob %>%
 # ggplot( aes(x=combo, y=triangle.transitivity,color=distribution)) +
  #  geom_boxplot(color="black", outlier.shape=NA) +
   # geom_point(aes(shape=distribution),size=3)+
    #scale_shape_manual(values=c(1, 17))+
  #  xlab("")+
   # ylab("Triangle Transitivity") +
  #  theme_bw() +
  #  theme(legend.position="none",axis.text=element_blank(),axis.line = element_line(colour = "black"),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=10),axis.text.y=element_text(size=10))+   #  scale_color_manual(values = c("blue","#CC5500")) 
 #p6 <- overall.ss.prob %>%
 #  ggplot( aes(x=combo, y=dci,color=distribution)) +
 #    geom_boxplot(color="black", outlier.shape=NA) +
 #    geom_point(aes(shape=distribution),size=3)+
 #    scale_shape_manual(values=c(1, 17))+
 #    xlab("")+
 #    ylab("DCI") +
 #    theme_bw() +
 #    theme(legend.position="none",axis.text=element_blank(),axis.line = element_line(colour = "black"),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=10),axis.text.y=element_text(size=10))+   #  scale_color_manual(values = c("blue","#CC5500"))
 #p7 <- overall.ss.prob %>%
  #  ggplot( aes(x=combo, y=abs(steepness),color= distribution)) +
 #    geom_boxplot(aes(shape=distribution),color="black", outlier.shape=NA) +
 #    geom_point(aes(shape=distribution),size=3)+
 #    scale_shape_manual(values=c(1, 17))+
 #    xlab("")+
 #    ylab("Steepness") +
 #    theme_bw() +
 #    theme(legend.position="none",axis.text=element_blank(),axis.line = element_line(colour = "black"),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=10),axis.text.y=element_text(size=10))+  #  scale_color_manual(values = c("blue","#CC5500"))

#Figure 4

setwd("~/Desktop")
jpeg("contest.comp_figure_4.jpeg", 672, 336)
par(cex.axis=1, cex.lab=1.3, mar=c(2.65,2.75,0.4,0.4),family="sans")
p12<-plot(total.energy.dc$energy_over_time~total.energy.dc$normDS,pch=1,cex=1.4,xaxt="n",yaxt="n",col="blue",xlab="",ylab="",main="",ylim=c(0.4,0.8),xlim=c(0.85,8.25),las=1); points(total.energy.du$energy_over_time~total.energy.du$normDS,pch=2,cex=1.4,col="#CC5500"); abline(km.lm.dc, lwd=3);abline(ks.lm.dc, lwd=3);abline(ko.lm.dc, lwd=3);abline(hm.lm.dc, lwd=3);abline(hs.lm.dc, lwd=3);abline(ho.lm.dc, lwd=3);abline(km.lm.du, col="black", lty=4, lwd=3);abline(ks.lm.du, col="black", lty=4, lwd=3);abline(ko.lm.du, col="black", lty=4, lwd=3);abline(hm.lm.du, col="black", lty=4, lwd=3);abline(hs.lm.du, col="black", lty=4, lwd=3);abline(ho.lm.du, col="black", lty=4, lwd=3);title(xlab="Normalized David's Scores",line=1.25);title(ylab="Energy per unit Time", line=1.5); axis(1, at = c(0, 1, 2, 3, 4, 5, 6, 7, 8), label=rep("",9), tck=-0.015, line=0);axis(2, at = c(0.4,0.5,0.6,0.7,0.8), label=rep("",5),tck=-0.015);axis(1, at = 1:10, line = -0.8, lwd = 0, cex.axis = 1);axis(2, at = c(0.4,0.5,0.6,0.7,0.8), line = -0.7, lwd = 0, cex.axis = 1, las=1);box(col="black",lwd=3)
dev.off()

p12



#Figure 13 (avoid)
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p13<-attack.prop.2 %>%
  ggplot( aes(x=combo2, y=rate.avoids,color=resource.dist)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=resource.dist),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Rate of Avoids") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.16, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.1,0.65))
jpeg("contest.comp_figure_13.jpeg", 336, 336)
p13
dev.off()

p13
    

#Figure 14 (avoid)
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p14 <- overall.ss.deter.avoid %>%
  ggplot( aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.63, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.5, 1.05))
jpeg("contest.comp_figure_14a.jpeg", 369.6, 336)
p14
dev.off()

p19 <- overall.ss.deter.avoid %>%
  ggplot( aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_14b.jpeg", 369.6, 336)
p19
dev.off()
    
p20 <- overall.ss.deter.avoid %>%
  ggplot( aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_14c.jpeg", 369.6, 336)
p20
dev.off()

p14
p19
p20

#Figure 17 (attacks)
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p17<-attack.prop.2 %>%
  ggplot( aes(x=combo2, y=rate.attacks,color=resource.dist)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=resource.dist),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Rate of Attacks") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.16, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.1,0.65))
jpeg("contest.comp_figure_17.jpeg", 336, 336)
p17
dev.off()

p17
    

#Figure 18 (attacks)
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p18 <- overall.ss.deter.attacks %>%
  ggplot( aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.63, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.5, 1.05))
jpeg("contest.comp_figure_18a.jpeg", 369.6, 336)
p18
dev.off()

p19 <- overall.ss.deter.attacks %>%
  ggplot( aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_18b.jpeg", 369.6, 336)
p19
dev.off()
    
p20 <- overall.ss.deter.attacks %>%
  ggplot( aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_figure_18c.jpeg", 369.6, 336)
p20
dev.off()

p18
p19
p20


