---
title: "Contest-Interaction ABM Data Analysis - Sigmoid Function Data"
author: "C.J. O'Connor-Coates"
date: "2023-06-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


#-------------------------------------------------------------------------------------------------------------------------

# All data was generated in NetLogo Agent-Based Models (ABM) and imported into this program for analysis. These data and analyses are used in the publication "Steep hierarchies without skew? Modeling how ecology and decision-making shape despotism of relationships" by Marcy S. Ekanayake-Weber, Christopher J. O'Connor-Coates, and Andreas Koenig.

# The NetLogo model was created by Marcy S. Ekanayake-Weber and Christopher J. O'Connor-Coates. The following R-code was written by Christopher J. O'Connor-Coates. The code for the Triangle Transitivity Function was written by Shizuka & McDonald (2012). For questions regarding the R-code email Christopher J. O'Connor-Coates at christopher.oconnor-coates@stonybrook.edu.

#-------------------------------------------------------------------------------------------------------------------------

#-------------------------------------------------------------------------------------------------------------------------

# DEFINITIONS:
# 1. Knowledge (k): Individuals know of either their own or their opponent's Resource Holding Potential (RHP)
# 2. History (h): Individuals know of either their own or their opponent's fighting history, including how often theiy won or lost conflicts
# 3. Mutual (m): Individuals have knowledge of both their own and their opponent's RHP or History
# 4. Self (s): Individuals have knowledge of only their own RHP or History
# 5. Opponent (o): Individuals have knowledge of only their opponent's RHP or History
# 6. Deterministic (d): Scenarios in which fight outcomes were determined by the strength of an individual's RHP. Individuals with higher RHP values always won escalated conflicts.
# 7. Probabilistic (p): Scenarios in which fight outcomes were determined by a probability calculated in the NetLogo program. Individuals with higher RHP values are more likely to win escalated conflicts, but there is also a (smaller) chance that the individual with lower RHP could win the conflict.
# 8. Initiator Wins (iw; i): Scenarios in which the escalated conflict is always won by the individual which initiated the conflict.
# 9. Sigmoid Function (sf): Scenarios in which fights were escalated through a cost-benefit analysis that was modeled as a sigmoid function.
# 10. Clumped Distribution (cd; c): Resources were arranged in the landscape such that they only appeared in clumps; can also be called a heterogenous distribution
# 11. Uniform Distribution (ud; u): Resources were arranged in the landscape such that they were evenly distributed across the area; can also be called a homogenous distribution
# 12. Avoid: An individual avoided an escalation/conflict
# 13. Victory: An individual won an escalation/conflict
# 14. Foraging Efficiency: An Individual's Energy Intake Over Time

#ABBREVIATIONS:
# 1. inter.mat: Interaction Matrices
# 2. ep: Proportion of Escalation
# 3. t.tri: Triangle Transitivity
# 4. dci: Directional Conistency Index
# 5. Steep: steepness

#-------------------------------------------------------------------------------------------------------------------------


#-------------------------------------------------------------------------------------------------------------------------

# TO USE CODE SET YOUR WORKING DIRECTORY FILEPATHS (WHERE INDICATED) TO WHERE YOU HAVE SAVED THE DATA FILES.
# INDICATED FILEPATHS LOOK LIKE: setwd("~/SET/YOUR/WORKING/DIRECTORY/...")

#-------------------------------------------------------------------------------------------------------------------------


## Functions
```{r Functions}
# Functions used to generate the interaction matrices and TTri

# Function to calculate Proportion of Escalation:
ep<-function(x,y){
  sum(x[,3])/(sum(x[,3])+sum(y[,3]))
}


# Function to calculate Interaction Matrices:
inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Victories=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  victory.interaction.matrix<-(matrix(vdf$Victories,nrow=10,ncol=10,byrow=F))
  victory.interaction.matrix<-data.frame(victory.interaction.matrix)
  
  victory.interaction.matrix<-t(victory.interaction.matrix)
  victory.interaction.matrix<-matrix(victory.interaction.matrix,nrow=10,ncol=10)
  colnames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  victory.interaction.matrix
}

# Function to calculate Avoids Interaction Matrices:
avoid.inter.mat<-function(x){
vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Avoids=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  avoid.interaction.matrix<-(matrix(vdf$Avoids,nrow=10,ncol=10,byrow=F))
  avoid.interaction.matrix<-data.frame(avoid.interaction.matrix)
  
  avoid.interaction.matrix<-t(avoid.interaction.matrix)
  avoid.interaction.matrix<-matrix(avoid.interaction.matrix,nrow=10,ncol=10)
  colnames(avoid.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(avoid.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  avoid.interaction.matrix
}


int.to.dom=function(x){ 
  ((x>t(x)) & (x+t(x)>0))+0
}


# Function to calculate Triangle Transitivity (Shizuka & McDonald, 2012):
tr.tri<-function(x){

  m=int.to.dom(as.matrix(x))
  
  g=network(m,directed=TRUE)
  
  # We calculate P.t and t.tri for this empirical network.
  
  tri=triad.census(g) #The full triad census as an 16-element vector 
  
  w=as.vector(c(0,0,0,0,0,0,0,0,1,0,0,1,1,0.5,0.75,0.75)) # The weighting vector for transitivity 
  
  N.triangle=sum(tri*as.vector(c(0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1))) #Count and sum the number of triangles
  
  Pt=sum(tri*w)/N.triangle 
  
  t.tri=4*(Pt-0.75) 
  
  Pt 
  
  t.tri
  
  ## We now conduct 1,000 simulations of random networks with the same number of mutual, asymmetric and null dyads as the empirical dominance matrix. We calculate Pt from each of these simulated networks (r.P.t). I use a while() loop because randomizations of some sparse matrices will produce networks with no triangles. For simplicity, we just throw these out. 
  
  dyads=dyad.census(g) 
  
  r.p.t=vector(length=1000)
  
  j=1
  
  while(j<1001){
  
  r=rguman(1,nv=nrow(m),mut=dyads[1],asym=dyads[2],null=dyads[3])
  
  r.triad=triad.census(r)
  
  r.p.t[j]=r.triad[9]/(r.triad[10]+r.triad[9])
  
  if (is.na(r.p.t[j])) next else j=j+1
  
  }
  
  p=length(r.p.t[r.p.t>=Pt])/1000
  
  p
  
  t.tri
}


#adds new line to axis tick labels in ggplot
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}

ggplotRegression <- function (fit) {

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
                     "Intercept =",signif(fit$coef[[1]],5 ),
                     " Slope =",signif(fit$coef[[2]], 5),
                     " P =",signif(summary(fit)$coef[2,4], 5)))
}
```

## Clumped Deterministic Data
```{r Clumped Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid.cd.sf.km<-sapply(files, read.csv) # Knowledge Mutual Clumped Distribution Avoidance Data

# Separate out the avoidance data into the individual trials:
a1.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[1]],X2=avoid.cd.sf.km[[2]],Avoids=avoid.cd.sf.km[[3]]) #Trial 1 Avoid Data
a2.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[4]],X2=avoid.cd.sf.km[[5]],Avoids=avoid.cd.sf.km[[6]]) #Trial 2 Avoid Data
a3.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[7]],X2=avoid.cd.sf.km[[8]],Avoids=avoid.cd.sf.km[[9]]) #Trial 3 Avoid Data
a4.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[10]],X2=avoid.cd.sf.km[[11]],Avoids=avoid.cd.sf.km[[12]]) #Trial 4 Avoid Data
a5.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[13]],X2=avoid.cd.sf.km[[14]],Avoids=avoid.cd.sf.km[[15]]) #Trial 5 Avoid Data
a6.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[16]],X2=avoid.cd.sf.km[[17]],Avoids=avoid.cd.sf.km[[18]]) #Trial 6 Avoid Data
a7.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[19]],X2=avoid.cd.sf.km[[20]],Avoids=avoid.cd.sf.km[[21]]) #Trial 7 Avoid Data
a8.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[22]],X2=avoid.cd.sf.km[[23]],Avoids=avoid.cd.sf.km[[24]]) #Trial 8 Avoid Data
a9.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[25]],X2=avoid.cd.sf.km[[26]],Avoids=avoid.cd.sf.km[[27]]) #Trial 9 Avoid Data
a10.cd.sf.km<-data.frame(X1=avoid.cd.sf.km[[28]],X2=avoid.cd.sf.km[[29]],Avoids=avoid.cd.sf.km[[30]]) #Trial 10 Avoid Data


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/conflict")

files<-list.files(pattern="*.csv")
conflict.km.cd.sf<-sapply(files, read.csv) # Knowledge Mutual Clumped Distribution Conflict Data

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[1]],X2=conflict.km.cd.sf[[2]],Victories=conflict.km.cd.sf[[3]])  # Knowledge Mutual Clumped Distribution Trial 1 Data
mat1.cd.sf.km<-inter.mat(mut1.cd.sf.km) # Knowledge Mutual Clumped Distribution Trial 1 Interaction Matrix
tri1.cd.sf.km<-tr.tri(mat1.cd.sf.km) # Knowledge Mutual Clumped Distribution Trial 1 Triangle Transitivity
dci1.cd.sf.km<-DCindex(mat1.cd.sf.km) # Knowledge Mutual Clumped Distribution Trial 1 DCI
mat1.cd.sf.km[is.na(mat1.cd.sf.km)] = 0 # Knowledge Mutual Clumped Distribution Trial 1 Interaction Matrix - NA Values = 0
h1.cd.sf.km<-h.index(mat1.cd.sf.km) # Knowledge Mutual Clumped Distribution Trial 1 H-Index

ep1.cd.sf.km<-ep(mut1.cd.sf.km,a1.cd.sf.km) # Knowledge Mutual Clumped Distribution Trial 1 Proportion of Escalation
david1.cd.sf.km<-DS(mat1.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cd.sf.km<-cbind(ordrank.1.cd.sf.km,ds=david1.cd.sf.km$normDS)
lm1.cd.sf.km<-summary(lm(ordrank.1.cd.sf.km$ds~ordrank.1.cd.sf.km$ord.rank))
s1.cd.sf.km<-lm1.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[4]],X2=conflict.km.cd.sf[[5]],Victories=conflict.km.cd.sf[[6]])
mat2.cd.sf.km<-inter.mat(mut2.cd.sf.km)
tri2.cd.sf.km<-tr.tri(mat2.cd.sf.km)
dci2.cd.sf.km<-DCindex(mat2.cd.sf.km)
mat2.cd.sf.km[is.na(mat2.cd.sf.km)] = 0
h2.cd.sf.km<-h.index(mat2.cd.sf.km)

ep2.cd.sf.km<-ep(mut2.cd.sf.km,a2.cd.sf.km)
david2.cd.sf.km<-DS(mat2.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cd.sf.km<-cbind(ordrank.2.cd.sf.km,ds=david2.cd.sf.km$normDS)
lm2.cd.sf.km<-summary(lm(ordrank.2.cd.sf.km$ds~ordrank.2.cd.sf.km$ord.rank))
s2.cd.sf.km<-lm2.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[7]],X2=conflict.km.cd.sf[[8]],Victories=conflict.km.cd.sf[[9]])
mat3.cd.sf.km<-inter.mat(mut3.cd.sf.km)
tri3.cd.sf.km<-tr.tri(mat3.cd.sf.km)
dci3.cd.sf.km<-DCindex(mat3.cd.sf.km)
mat3.cd.sf.km[is.na(mat3.cd.sf.km)] = 0
h3.cd.sf.km<-h.index(mat3.cd.sf.km)

ep3.cd.sf.km<-ep(mut3.cd.sf.km,a3.cd.sf.km)
david3.cd.sf.km<-DS(mat3.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cd.sf.km<-cbind(ordrank.3.cd.sf.km,ds=david3.cd.sf.km$normDS)
lm3.cd.sf.km<-summary(lm(ordrank.3.cd.sf.km$ds~ordrank.3.cd.sf.km$ord.rank))
s3.cd.sf.km<-lm3.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[10]],X2=conflict.km.cd.sf[[11]],Victories=conflict.km.cd.sf[[12]])
mat4.cd.sf.km<-inter.mat(mut4.cd.sf.km)
tri4.cd.sf.km<-tr.tri(mat4.cd.sf.km)
dci4.cd.sf.km<-DCindex(mat4.cd.sf.km)
mat4.cd.sf.km[is.na(mat4.cd.sf.km)] = 0
h4.cd.sf.km<-h.index(mat4.cd.sf.km)

ep4.cd.sf.km<-ep(mut4.cd.sf.km,a4.cd.sf.km)
david4.cd.sf.km<-DS(mat4.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cd.sf.km<-cbind(ordrank.4.cd.sf.km,ds=david4.cd.sf.km$normDS)
lm4.cd.sf.km<-summary(lm(ordrank.4.cd.sf.km$ds~ordrank.4.cd.sf.km$ord.rank))
s4.cd.sf.km<-lm4.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[13]],X2=conflict.km.cd.sf[[14]],Victories=conflict.km.cd.sf[[15]])
mat5.cd.sf.km<-inter.mat(mut5.cd.sf.km)
tri5.cd.sf.km<-tr.tri(mat5.cd.sf.km)
dci5.cd.sf.km<-DCindex(mat5.cd.sf.km)
mat5.cd.sf.km[is.na(mat5.cd.sf.km)] = 0
h5.cd.sf.km<-h.index(mat5.cd.sf.km)

ep5.cd.sf.km<-ep(mut5.cd.sf.km,a5.cd.sf.km)
david5.cd.sf.km<-DS(mat5.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cd.sf.km<-cbind(ordrank.5.cd.sf.km,ds=david5.cd.sf.km$normDS)
lm5.cd.sf.km<-summary(lm(ordrank.5.cd.sf.km$ds~ordrank.5.cd.sf.km$ord.rank))
s5.cd.sf.km<-lm5.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[16]],X2=conflict.km.cd.sf[[17]],Victories=conflict.km.cd.sf[[18]])
mat6.cd.sf.km<-inter.mat(mut6.cd.sf.km)
tri6.cd.sf.km<-tr.tri(mat6.cd.sf.km)
dci6.cd.sf.km<-DCindex(mat6.cd.sf.km)
mat6.cd.sf.km[is.na(mat6.cd.sf.km)] = 0
h6.cd.sf.km<-h.index(mat6.cd.sf.km)

ep6.cd.sf.km<-ep(mut6.cd.sf.km,a6.cd.sf.km)
david6.cd.sf.km<-DS(mat6.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cd.sf.km<-cbind(ordrank.6.cd.sf.km,ds=david6.cd.sf.km$normDS)
lm6.cd.sf.km<-summary(lm(ordrank.6.cd.sf.km$ds~ordrank.6.cd.sf.km$ord.rank))
s6.cd.sf.km<-lm6.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[19]],X2=conflict.km.cd.sf[[20]],Victories=conflict.km.cd.sf[[21]])
mat7.cd.sf.km<-inter.mat(mut7.cd.sf.km)
tri7.cd.sf.km<-tr.tri(mat7.cd.sf.km)
dci7.cd.sf.km<-DCindex(mat7.cd.sf.km)
mat7.cd.sf.km[is.na(mat7.cd.sf.km)] = 0
h7.cd.sf.km<-h.index(mat7.cd.sf.km)

ep7.cd.sf.km<-ep(mut7.cd.sf.km,a7.cd.sf.km)
david7.cd.sf.km<-DS(mat7.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cd.sf.km<-cbind(ordrank.7.cd.sf.km,ds=david7.cd.sf.km$normDS)
lm7.cd.sf.km<-summary(lm(ordrank.7.cd.sf.km$ds~ordrank.7.cd.sf.km$ord.rank))
s7.cd.sf.km<-lm7.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[22]],X2=conflict.km.cd.sf[[23]],Victories=conflict.km.cd.sf[[24]])
mat8.cd.sf.km<-inter.mat(mut8.cd.sf.km)
tri8.cd.sf.km<-tr.tri(mat8.cd.sf.km)
dci8.cd.sf.km<-DCindex(mat8.cd.sf.km)
mat8.cd.sf.km[is.na(mat8.cd.sf.km)] = 0
h8.cd.sf.km<-h.index(mat8.cd.sf.km)

ep8.cd.sf.km<-ep(mut8.cd.sf.km,a8.cd.sf.km)
david8.cd.sf.km<-DS(mat8.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cd.sf.km<-cbind(ordrank.8.cd.sf.km,ds=david8.cd.sf.km$normDS)
lm8.cd.sf.km<-summary(lm(ordrank.8.cd.sf.km$ds~ordrank.8.cd.sf.km$ord.rank))
s8.cd.sf.km<-lm8.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[25]],X2=conflict.km.cd.sf[[26]],Victories=conflict.km.cd.sf[[27]])
mat9.cd.sf.km<-inter.mat(mut9.cd.sf.km)
tri9.cd.sf.km<-tr.tri(mat9.cd.sf.km)
dci9.cd.sf.km<-DCindex(mat9.cd.sf.km)
mat9.cd.sf.km[is.na(mat9.cd.sf.km)] = 0
h9.cd.sf.km<-h.index(mat9.cd.sf.km)

ep9.cd.sf.km<-ep(mut9.cd.sf.km,a9.cd.sf.km)
david9.cd.sf.km<-DS(mat9.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cd.sf.km<-cbind(ordrank.9.cd.sf.km,ds=david9.cd.sf.km$normDS)
lm9.cd.sf.km<-summary(lm(ordrank.9.cd.sf.km$ds~ordrank.9.cd.sf.km$ord.rank))
s9.cd.sf.km<-lm9.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cd.sf.km<-data.frame(X1=conflict.km.cd.sf[[28]],X2=conflict.km.cd.sf[[29]],Victories=conflict.km.cd.sf[[30]])
mat10.cd.sf.km<-inter.mat(mut10.cd.sf.km)
tri10.cd.sf.km<-tr.tri(mat10.cd.sf.km)
dci10.cd.sf.km<-DCindex(mat10.cd.sf.km)
mat10.cd.sf.km[is.na(mat10.cd.sf.km)] = 0
h10.cd.sf.km<-h.index(mat10.cd.sf.km)

ep10.cd.sf.km<-ep(mut10.cd.sf.km,a10.cd.sf.km)
david10.cd.sf.km<-DS(mat10.cd.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.cd.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cd.sf.km<-cbind(ordrank.10.cd.sf.km,ds=david10.cd.sf.km$normDS)
lm10.cd.sf.km<-summary(lm(ordrank.10.cd.sf.km$ds~ordrank.10.cd.sf.km$ord.rank))
s10.cd.sf.km<-lm10.cd.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cd.sf.km<-sum(mut1.cd.sf.km$Victories)
int2.cd.sf.km<-sum(mut2.cd.sf.km$Victories)
int3.cd.sf.km<-sum(mut3.cd.sf.km$Victories)
int4.cd.sf.km<-sum(mut4.cd.sf.km$Victories)
int5.cd.sf.km<-sum(mut5.cd.sf.km$Victories)
int6.cd.sf.km<-sum(mut6.cd.sf.km$Victories)
int7.cd.sf.km<-sum(mut7.cd.sf.km$Victories)
int8.cd.sf.km<-sum(mut8.cd.sf.km$Victories)
int9.cd.sf.km<-sum(mut9.cd.sf.km$Victories)
int10.cd.sf.km<-sum(mut10.cd.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.cd.sf.km<-sum(a1.cd.sf.km$Avoids)
av2.cd.sf.km<-sum(a2.cd.sf.km$Avoids)
av3.cd.sf.km<-sum(a3.cd.sf.km$Avoids)
av4.cd.sf.km<-sum(a4.cd.sf.km$Avoids)
av5.cd.sf.km<-sum(a5.cd.sf.km$Avoids)
av6.cd.sf.km<-sum(a6.cd.sf.km$Avoids)
av7.cd.sf.km<-sum(a7.cd.sf.km$Avoids)
av8.cd.sf.km<-sum(a8.cd.sf.km$Avoids)
av9.cd.sf.km<-sum(a9.cd.sf.km$Avoids)
av10.cd.sf.km<-sum(a10.cd.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.dc.sf<-(sum(av1.cd.sf.km, av2.cd.sf.km, av3.cd.sf.km, av4.cd.sf.km, av5.cd.sf.km, av6.cd.sf.km, av7.cd.sf.km, av8.cd.sf.km, av9.cd.sf.km, av10.cd.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.dc.sf<-(sum(int1.cd.sf.km, int2.cd.sf.km, int3.cd.sf.km, int4.cd.sf.km, int5.cd.sf.km, int6.cd.sf.km, int7.cd.sf.km, int8.cd.sf.km, int9.cd.sf.km, int10.cd.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cd.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cd.sf.km<-e1.cd.sf.km[order(e1.cd.sf.km$ID),]
e1.cd.sf.km<-as.matrix(t(e1.1.cd.sf.km))

e2.cd.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cd.sf.km<-e2.cd.sf.km[order(e2.cd.sf.km$ID),]
e2.cd.sf.km<-as.matrix(t(e2.1.cd.sf.km))

e3.cd.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cd.sf.km<-e3.cd.sf.km[order(e3.cd.sf.km$ID),]
e3.cd.sf.km<-as.matrix(t(e3.1.cd.sf.km))

e4.cd.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cd.sf.km<-e4.cd.sf.km[order(e4.cd.sf.km$ID),]
e4.cd.sf.km<-as.matrix(t(e4.1.cd.sf.km))

e5.cd.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cd.sf.km<-e5.cd.sf.km[order(e5.cd.sf.km$ID),]
e5.cd.sf.km<-as.matrix(t(e5.1.cd.sf.km))

e6.cd.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cd.sf.km<-e6.cd.sf.km[order(e6.cd.sf.km$ID),]
e6.cd.sf.km<-as.matrix(t(e6.1.cd.sf.km))

e7.cd.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cd.sf.km<-e7.cd.sf.km[order(e7.cd.sf.km$ID),]
e7.cd.sf.km<-as.matrix(t(e7.1.cd.sf.km))

e8.cd.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cd.sf.km<-e8.cd.sf.km[order(e8.cd.sf.km$ID),]
e8.cd.sf.km<-as.matrix(t(e8.1.cd.sf.km))

e9.cd.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cd.sf.km<-e9.cd.sf.km[order(e9.cd.sf.km$ID),]
e9.cd.sf.km<-as.matrix(t(e9.1.cd.sf.km))

e10.cd.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cd.sf.km<-e10.cd.sf.km[order(e10.cd.sf.km$ID),]
e10.cd.sf.km<-as.matrix(t(e10.1.cd.sf.km))

energy.km.cd.sf.km<-as.data.frame(matrix(c(e1.cd.sf.km,e2.cd.sf.km,e3.cd.sf.km,e4.cd.sf.km,e5.cd.sf.km,e6.cd.sf.km,e7.cd.sf.km,e8.cd.sf.km,e9.cd.sf.km,e10.cd.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.cd.sf.km<-data.frame(ID=energy.km.cd.sf.km$V1,energy_over_distance=energy.km.cd.sf.km$V2,energy_over_time=energy.km.cd.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cd.sf.km<-david1.cd.sf.km[order(david1.cd.sf.km$ID),]
david1.cd.sf.km<-as.matrix(t(david1.1.cd.sf.km))

david2.1.cd.sf.km<-david2.cd.sf.km[order(david2.cd.sf.km$ID),]
david2.cd.sf.km<-as.matrix(t(david2.1.cd.sf.km))

david3.1.cd.sf.km<-david3.cd.sf.km[order(david3.cd.sf.km$ID),]
david3.cd.sf.km<-as.matrix(t(david3.1.cd.sf.km))

david4.1.cd.sf.km<-david4.cd.sf.km[order(david4.cd.sf.km$ID),]
david4.cd.sf.km<-as.matrix(t(david4.1.cd.sf.km))

david5.1.cd.sf.km<-david5.cd.sf.km[order(david5.cd.sf.km$ID),]
david5.cd.sf.km<-as.matrix(t(david5.1.cd.sf.km))

david6.1.cd.sf.km<-david6.cd.sf.km[order(david6.cd.sf.km$ID),]
david6.cd.sf.km<-as.matrix(t(david6.1.cd.sf.km))

david7.1.cd.sf.km<-david7.cd.sf.km[order(david7.cd.sf.km$ID),]
david7.cd.sf.km<-as.matrix(t(david7.1.cd.sf.km))

david8.1.cd.sf.km<-david8.cd.sf.km[order(david8.cd.sf.km$ID),]
david8.cd.sf.km<-as.matrix(t(david8.1.cd.sf.km))

david9.1.cd.sf.km<-david9.cd.sf.km[order(david9.cd.sf.km$ID),]
david9.cd.sf.km<-as.matrix(t(david9.1.cd.sf.km))

david10.1.cd.sf.km<-david10.cd.sf.km[order(david10.cd.sf.km$ID),]
david10.cd.sf.km<-as.matrix(t(david10.1.cd.sf.km))

david.km.cd.sf.km<-as.data.frame(matrix(c(david1.cd.sf.km,david2.cd.sf.km,david3.cd.sf.km,david4.cd.sf.km,david5.cd.sf.km,david6.cd.sf.km,david7.cd.sf.km,david8.cd.sf.km,david9.cd.sf.km,david10.cd.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.cd.sf.km<-data.frame(ID=david.km.cd.sf.km$V1,DS=david.km.cd.sf.km$V2,normDS=david.km.cd.sf.km$V3)


# Calculate linear models and slopes for each individual run. Linear models calculate the relationship between rank (David's Score) and Energy Efficiency:
lm.km.1.cd.sf.km<-lm(e1.1.cd.sf.km$energy_over_time~as.numeric(david1.1.cd.sf.km$normDS))
km.lm.1.s.cd.sf.km<-summary(lm.km.1.cd.sf.km)$coefficients
km.1.slope.cd.sf.km<-km.lm.1.s.cd.sf.km[2,1]
lm.km.2.cd.sf.km<-lm(e2.1.cd.sf.km$energy_over_time~as.numeric(david2.1.cd.sf.km$normDS))
km.lm.2.s.cd.sf.km<-summary(lm.km.2.cd.sf.km)$coefficients
km.2.slope.cd.sf.km<-km.lm.2.s.cd.sf.km[2,1]
lm.km.3.cd.sf.km<-lm(e3.1.cd.sf.km$energy_over_time~as.numeric(david3.1.cd.sf.km$normDS))
km.lm.3.s.cd.sf.km<-summary(lm.km.3.cd.sf.km)$coefficients
km.3.slope.cd.sf.km<-km.lm.3.s.cd.sf.km[2,1]
lm.km.4.cd.sf.km<-lm(e4.1.cd.sf.km$energy_over_time~as.numeric(david4.1.cd.sf.km$normDS))
km.lm.4.s.cd.sf.km<-summary(lm.km.4.cd.sf.km)$coefficients
km.4.slope.cd.sf.km<-km.lm.4.s.cd.sf.km[2,1]
lm.km.5.cd.sf.km<-lm(e5.1.cd.sf.km$energy_over_time~as.numeric(david5.1.cd.sf.km$normDS))
km.lm.5.s.cd.sf.km<-summary(lm.km.5.cd.sf.km)$coefficients
km.5.slope.cd.sf.km<-km.lm.5.s.cd.sf.km[2,1]
lm.km.6.cd.sf.km<-lm(e6.1.cd.sf.km$energy_over_time~as.numeric(david6.1.cd.sf.km$normDS))
km.lm.6.s.cd.sf.km<-summary(lm.km.6.cd.sf.km)$coefficients
km.6.slope.cd.sf.km<-km.lm.6.s.cd.sf.km[2,1]
lm.km.7.cd.sf.km<-lm(e7.1.cd.sf.km$energy_over_time~as.numeric(david7.1.cd.sf.km$normDS))
km.lm.7.s.cd.sf.km<-summary(lm.km.7.cd.sf.km)$coefficients
km.7.slope.cd.sf.km<-km.lm.7.s.cd.sf.km[2,1]
lm.km.8.cd.sf.km<-lm(e8.1.cd.sf.km$energy_over_time~as.numeric(david8.1.cd.sf.km$normDS))
km.lm.8.s.cd.sf.km<-summary(lm.km.8.cd.sf.km)$coefficients
km.8.slope.cd.sf.km<-km.lm.8.s.cd.sf.km[2,1]
lm.km.9.cd.sf.km<-lm(e9.1.cd.sf.km$energy_over_time~as.numeric(david9.1.cd.sf.km$normDS))
km.lm.9.s.cd.sf.km<-summary(lm.km.9.cd.sf.km)$coefficients
km.9.slope.cd.sf.km<-km.lm.9.s.cd.sf.km[2,1]
lm.km.10.cd.sf.km<-lm(e10.1.cd.sf.km$energy_over_time~as.numeric(david10.1.cd.sf.km$normDS))
km.lm.10.s.cd.sf.km<-summary(lm.km.10.cd.sf.km)$coefficients
km.10.slope.cd.sf.km<-km.lm.10.s.cd.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.cd.sf.ss<-data.frame(triangle.transitivity=c(tri1.cd.sf.km,tri2.cd.sf.km,tri3.cd.sf.km,tri4.cd.sf.km,tri5.cd.sf.km,tri6.cd.sf.km,tri7.cd.sf.km,tri8.cd.sf.km,tri9.cd.sf.km,tri10.cd.sf.km),escalation=c(ep1.cd.sf.km,ep2.cd.sf.km,ep3.cd.sf.km,ep4.cd.sf.km,ep5.cd.sf.km,ep6.cd.sf.km,ep7.cd.sf.km,ep8.cd.sf.km,ep9.cd.sf.km,ep10.cd.sf.km),dci=c(dci1.cd.sf.km,dci2.cd.sf.km,dci3.cd.sf.km,dci4.cd.sf.km,dci5.cd.sf.km,dci6.cd.sf.km,dci7.cd.sf.km,dci8.cd.sf.km,dci9.cd.sf.km,dci10.cd.sf.km),steepness=c(s1.cd.sf.km,s2.cd.sf.km,s3.cd.sf.km,s4.cd.sf.km,s5.cd.sf.km,s6.cd.sf.km,s7.cd.sf.km,s8.cd.sf.km,s9.cd.sf.km,s10.cd.sf.km),slope=c(km.1.slope.cd.sf.km,km.2.slope.cd.sf.km,km.3.slope.cd.sf.km,km.4.slope.cd.sf.km,km.5.slope.cd.sf.km,km.6.slope.cd.sf.km,km.7.slope.cd.sf.km,km.8.slope.cd.sf.km,km.9.slope.cd.sf.km,km.10.slope.cd.sf.km))



#-------------------------------------------------------------------------------------------------------------------------
#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid.cd.sf.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[1]],X2=avoid.cd.sf.hm[[2]],Avoids=avoid.cd.sf.hm[[3]])
a2.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[4]],X2=avoid.cd.sf.hm[[5]],Avoids=avoid.cd.sf.hm[[6]])
a3.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[7]],X2=avoid.cd.sf.hm[[8]],Avoids=avoid.cd.sf.hm[[9]])
a4.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[10]],X2=avoid.cd.sf.hm[[11]],Avoids=avoid.cd.sf.hm[[12]])
a5.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[13]],X2=avoid.cd.sf.hm[[14]],Avoids=avoid.cd.sf.hm[[15]])
a6.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[16]],X2=avoid.cd.sf.hm[[17]],Avoids=avoid.cd.sf.hm[[18]])
a7.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[19]],X2=avoid.cd.sf.hm[[20]],Avoids=avoid.cd.sf.hm[[21]])
a8.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[22]],X2=avoid.cd.sf.hm[[23]],Avoids=avoid.cd.sf.hm[[24]])
a9.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[25]],X2=avoid.cd.sf.hm[[26]],Avoids=avoid.cd.sf.hm[[27]])
a10.cd.sf.hm<-data.frame(X1=avoid.cd.sf.hm[[28]],X2=avoid.cd.sf.hm[[29]],Avoids=avoid.cd.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.cd.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[1]],X2=conflict.hm.cd.sf[[2]],Victories=conflict.hm.cd.sf[[3]])
mat1.cd.sf.hm<-inter.mat(mut1.cd.sf.hm)
tri1.cd.sf.hm<-tr.tri(mat1.cd.sf.hm)
dci1.cd.sf.hm<-DCindex(mat1.cd.sf.hm)
mat1.cd.sf.hm[is.na(mat1.cd.sf.hm)] = 0
h1.cd.sf.hm<-h.index(mat1.cd.sf.hm)

ep1.cd.sf.hm<-ep(mut1.cd.sf.hm,a1.cd.sf.hm)
david1.cd.sf.hm<-DS(mat1.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cd.sf.hm<-cbind(ordrank.1.cd.sf.hm,ds=david1.cd.sf.hm$normDS)
lm1.cd.sf.hm<-summary(lm(ordrank.1.cd.sf.hm$ds~ordrank.1.cd.sf.hm$ord.rank))
s1.cd.sf.hm<-lm1.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[4]],X2=conflict.hm.cd.sf[[5]],Victories=conflict.hm.cd.sf[[6]])
mat2.cd.sf.hm<-inter.mat(mut2.cd.sf.hm)
tri2.cd.sf.hm<-tr.tri(mat2.cd.sf.hm)
dci2.cd.sf.hm<-DCindex(mat2.cd.sf.hm)
mat2.cd.sf.hm[is.na(mat2.cd.sf.hm)] = 0
h2.cd.sf.hm<-h.index(mat2.cd.sf.hm)

ep2.cd.sf.hm<-ep(mut2.cd.sf.hm,a2.cd.sf.hm)
david2.cd.sf.hm<-DS(mat2.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cd.sf.hm<-cbind(ordrank.2.cd.sf.hm,ds=david2.cd.sf.hm$normDS)
lm2.cd.sf.hm<-summary(lm(ordrank.2.cd.sf.hm$ds~ordrank.2.cd.sf.hm$ord.rank))
s2.cd.sf.hm<-lm2.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[7]],X2=conflict.hm.cd.sf[[8]],Victories=conflict.hm.cd.sf[[9]])
mat3.cd.sf.hm<-inter.mat(mut3.cd.sf.hm)
tri3.cd.sf.hm<-tr.tri(mat3.cd.sf.hm)
dci3.cd.sf.hm<-DCindex(mat3.cd.sf.hm)
mat3.cd.sf.hm[is.na(mat3.cd.sf.hm)] = 0
h3.cd.sf.hm<-h.index(mat3.cd.sf.hm)

ep3.cd.sf.hm<-ep(mut3.cd.sf.hm,a3.cd.sf.hm)
david3.cd.sf.hm<-DS(mat3.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cd.sf.hm<-cbind(ordrank.3.cd.sf.hm,ds=david3.cd.sf.hm$normDS)
lm3.cd.sf.hm<-summary(lm(ordrank.3.cd.sf.hm$ds~ordrank.3.cd.sf.hm$ord.rank))
s3.cd.sf.hm<-lm3.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[10]],X2=conflict.hm.cd.sf[[11]],Victories=conflict.hm.cd.sf[[12]])
mat4.cd.sf.hm<-inter.mat(mut4.cd.sf.hm)
tri4.cd.sf.hm<-tr.tri(mat4.cd.sf.hm)
dci4.cd.sf.hm<-DCindex(mat4.cd.sf.hm)
mat4.cd.sf.hm[is.na(mat4.cd.sf.hm)] = 0
h4.cd.sf.hm<-h.index(mat4.cd.sf.hm)

ep4.cd.sf.hm<-ep(mut4.cd.sf.hm,a4.cd.sf.hm)
david4.cd.sf.hm<-DS(mat4.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cd.sf.hm<-cbind(ordrank.4.cd.sf.hm,ds=david4.cd.sf.hm$normDS)
lm4.cd.sf.hm<-summary(lm(ordrank.4.cd.sf.hm$ds~ordrank.4.cd.sf.hm$ord.rank))
s4.cd.sf.hm<-lm4.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[13]],X2=conflict.hm.cd.sf[[14]],Victories=conflict.hm.cd.sf[[15]])
mat5.cd.sf.hm<-inter.mat(mut5.cd.sf.hm)
tri5.cd.sf.hm<-tr.tri(mat5.cd.sf.hm)
dci5.cd.sf.hm<-DCindex(mat5.cd.sf.hm)
mat5.cd.sf.hm[is.na(mat5.cd.sf.hm)] = 0
h5.cd.sf.hm<-h.index(mat5.cd.sf.hm)

ep5.cd.sf.hm<-ep(mut5.cd.sf.hm,a5.cd.sf.hm)
david5.cd.sf.hm<-DS(mat5.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cd.sf.hm<-cbind(ordrank.5.cd.sf.hm,ds=david5.cd.sf.hm$normDS)
lm5.cd.sf.hm<-summary(lm(ordrank.5.cd.sf.hm$ds~ordrank.5.cd.sf.hm$ord.rank))
s5.cd.sf.hm<-lm5.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[16]],X2=conflict.hm.cd.sf[[17]],Victories=conflict.hm.cd.sf[[18]])
mat6.cd.sf.hm<-inter.mat(mut6.cd.sf.hm)
tri6.cd.sf.hm<-tr.tri(mat6.cd.sf.hm)
dci6.cd.sf.hm<-DCindex(mat6.cd.sf.hm)
mat6.cd.sf.hm[is.na(mat6.cd.sf.hm)] = 0
h6.cd.sf.hm<-h.index(mat6.cd.sf.hm)

ep6.cd.sf.hm<-ep(mut6.cd.sf.hm,a6.cd.sf.hm)
david6.cd.sf.hm<-DS(mat6.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cd.sf.hm<-cbind(ordrank.6.cd.sf.hm,ds=david6.cd.sf.hm$normDS)
lm6.cd.sf.hm<-summary(lm(ordrank.6.cd.sf.hm$ds~ordrank.6.cd.sf.hm$ord.rank))
s6.cd.sf.hm<-lm6.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[19]],X2=conflict.hm.cd.sf[[20]],Victories=conflict.hm.cd.sf[[21]])
mat7.cd.sf.hm<-inter.mat(mut7.cd.sf.hm)
tri7.cd.sf.hm<-tr.tri(mat7.cd.sf.hm)
dci7.cd.sf.hm<-DCindex(mat7.cd.sf.hm)
mat7.cd.sf.hm[is.na(mat7.cd.sf.hm)] = 0
h7.cd.sf.hm<-h.index(mat7.cd.sf.hm)

ep7.cd.sf.hm<-ep(mut7.cd.sf.hm,a7.cd.sf.hm)
david7.cd.sf.hm<-DS(mat7.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cd.sf.hm<-cbind(ordrank.7.cd.sf.hm,ds=david7.cd.sf.hm$normDS)
lm7.cd.sf.hm<-summary(lm(ordrank.7.cd.sf.hm$ds~ordrank.7.cd.sf.hm$ord.rank))
s7.cd.sf.hm<-lm7.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[22]],X2=conflict.hm.cd.sf[[23]],Victories=conflict.hm.cd.sf[[24]])
mat8.cd.sf.hm<-inter.mat(mut8.cd.sf.hm)
tri8.cd.sf.hm<-tr.tri(mat8.cd.sf.hm)
dci8.cd.sf.hm<-DCindex(mat8.cd.sf.hm)
mat8.cd.sf.hm[is.na(mat8.cd.sf.hm)] = 0
h8.cd.sf.hm<-h.index(mat8.cd.sf.hm)

ep8.cd.sf.hm<-ep(mut8.cd.sf.hm,a8.cd.sf.hm)
david8.cd.sf.hm<-DS(mat8.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cd.sf.hm<-cbind(ordrank.8.cd.sf.hm,ds=david8.cd.sf.hm$normDS)
lm8.cd.sf.hm<-summary(lm(ordrank.8.cd.sf.hm$ds~ordrank.8.cd.sf.hm$ord.rank))
s8.cd.sf.hm<-lm8.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[25]],X2=conflict.hm.cd.sf[[26]],Victories=conflict.hm.cd.sf[[27]])
mat9.cd.sf.hm<-inter.mat(mut9.cd.sf.hm)
tri9.cd.sf.hm<-tr.tri(mat9.cd.sf.hm)
dci9.cd.sf.hm<-DCindex(mat9.cd.sf.hm)
mat9.cd.sf.hm[is.na(mat9.cd.sf.hm)] = 0
h9.cd.sf.hm<-h.index(mat9.cd.sf.hm)

ep9.cd.sf.hm<-ep(mut9.cd.sf.hm,a9.cd.sf.hm)
david9.cd.sf.hm<-DS(mat9.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cd.sf.hm<-cbind(ordrank.9.cd.sf.hm,ds=david9.cd.sf.hm$normDS)
lm9.cd.sf.hm<-summary(lm(ordrank.9.cd.sf.hm$ds~ordrank.9.cd.sf.hm$ord.rank))
s9.cd.sf.hm<-lm9.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cd.sf.hm<-data.frame(X1=conflict.hm.cd.sf[[28]],X2=conflict.hm.cd.sf[[29]],Victories=conflict.hm.cd.sf[[30]])
mat10.cd.sf.hm<-inter.mat(mut10.cd.sf.hm)
tri10.cd.sf.hm<-tr.tri(mat10.cd.sf.hm)
dci10.cd.sf.hm<-DCindex(mat10.cd.sf.hm)
mat10.cd.sf.hm[is.na(mat10.cd.sf.hm)] = 0
h10.cd.sf.hm<-h.index(mat10.cd.sf.hm)

ep10.cd.sf.hm<-ep(mut10.cd.sf.hm,a10.cd.sf.hm)
david10.cd.sf.hm<-DS(mat10.cd.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.cd.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cd.sf.hm<-cbind(ordrank.10.cd.sf.hm,ds=david10.cd.sf.hm$normDS)
lm10.cd.sf.hm<-summary(lm(ordrank.10.cd.sf.hm$ds~ordrank.10.cd.sf.hm$ord.rank))
s10.cd.sf.hm<-lm10.cd.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cd.sf.hm<-sum(mut1.cd.sf.hm$Victories)
int2.cd.sf.hm<-sum(mut2.cd.sf.hm$Victories)
int3.cd.sf.hm<-sum(mut3.cd.sf.hm$Victories)
int4.cd.sf.hm<-sum(mut4.cd.sf.hm$Victories)
int5.cd.sf.hm<-sum(mut5.cd.sf.hm$Victories)
int6.cd.sf.hm<-sum(mut6.cd.sf.hm$Victories)
int7.cd.sf.hm<-sum(mut7.cd.sf.hm$Victories)
int8.cd.sf.hm<-sum(mut8.cd.sf.hm$Victories)
int9.cd.sf.hm<-sum(mut9.cd.sf.hm$Victories)
int10.cd.sf.hm<-sum(mut10.cd.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.cd.sf.hm<-sum(a1.cd.sf.hm$Avoids)
av2.cd.sf.hm<-sum(a2.cd.sf.hm$Avoids)
av3.cd.sf.hm<-sum(a3.cd.sf.hm$Avoids)
av4.cd.sf.hm<-sum(a4.cd.sf.hm$Avoids)
av5.cd.sf.hm<-sum(a5.cd.sf.hm$Avoids)
av6.cd.sf.hm<-sum(a6.cd.sf.hm$Avoids)
av7.cd.sf.hm<-sum(a7.cd.sf.hm$Avoids)
av8.cd.sf.hm<-sum(a8.cd.sf.hm$Avoids)
av9.cd.sf.hm<-sum(a9.cd.sf.hm$Avoids)
av10.cd.sf.hm<-sum(a10.cd.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.dc.sf<-(sum(av1.cd.sf.hm, av2.cd.sf.hm, av3.cd.sf.hm, av4.cd.sf.hm, av5.cd.sf.hm, av6.cd.sf.hm, av7.cd.sf.hm, av8.cd.sf.hm, av9.cd.sf.hm, av10.cd.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.dc.sf<-(sum(int1.cd.sf.hm, int2.cd.sf.hm, int3.cd.sf.hm, int4.cd.sf.hm, int5.cd.sf.hm, int6.cd.sf.hm, int7.cd.sf.hm, int8.cd.sf.hm, int9.cd.sf.hm, int10.cd.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cd.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cd.sf.hm<-e1.cd.sf.hm[order(e1.cd.sf.hm$ID),]
e1.cd.sf.hm<-as.matrix(t(e1.1.cd.sf.hm))

e2.cd.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cd.sf.hm<-e2.cd.sf.hm[order(e2.cd.sf.hm$ID),]
e2.cd.sf.hm<-as.matrix(t(e2.1.cd.sf.hm))

e3.cd.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cd.sf.hm<-e3.cd.sf.hm[order(e3.cd.sf.hm$ID),]
e3.cd.sf.hm<-as.matrix(t(e3.1.cd.sf.hm))

e4.cd.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cd.sf.hm<-e4.cd.sf.hm[order(e4.cd.sf.hm$ID),]
e4.cd.sf.hm<-as.matrix(t(e4.1.cd.sf.hm))

e5.cd.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cd.sf.hm<-e5.cd.sf.hm[order(e5.cd.sf.hm$ID),]
e5.cd.sf.hm<-as.matrix(t(e5.1.cd.sf.hm))

e6.cd.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cd.sf.hm<-e6.cd.sf.hm[order(e6.cd.sf.hm$ID),]
e6.cd.sf.hm<-as.matrix(t(e6.1.cd.sf.hm))

e7.cd.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cd.sf.hm<-e7.cd.sf.hm[order(e7.cd.sf.hm$ID),]
e7.cd.sf.hm<-as.matrix(t(e7.1.cd.sf.hm))

e8.cd.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cd.sf.hm<-e8.cd.sf.hm[order(e8.cd.sf.hm$ID),]
e8.cd.sf.hm<-as.matrix(t(e8.1.cd.sf.hm))

e9.cd.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cd.sf.hm<-e9.cd.sf.hm[order(e9.cd.sf.hm$ID),]
e9.cd.sf.hm<-as.matrix(t(e9.1.cd.sf.hm))

e10.cd.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cd.sf.hm<-e10.cd.sf.hm[order(e10.cd.sf.hm$ID),]
e10.cd.sf.hm<-as.matrix(t(e10.1.cd.sf.hm))

energy.hm.cd.sf.hm<-as.data.frame(matrix(c(e1.cd.sf.hm,e2.cd.sf.hm,e3.cd.sf.hm,e4.cd.sf.hm,e5.cd.sf.hm,e6.cd.sf.hm,e7.cd.sf.hm,e8.cd.sf.hm,e9.cd.sf.hm,e10.cd.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.cd.sf.hm<-data.frame(ID=energy.hm.cd.sf.hm$V1,energy_over_distance=energy.hm.cd.sf.hm$V2,energy_over_time=energy.hm.cd.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cd.sf.hm<-david1.cd.sf.hm[order(david1.cd.sf.hm$ID),]
david1.cd.sf.hm<-as.matrix(t(david1.1.cd.sf.hm))

david2.1.cd.sf.hm<-david2.cd.sf.hm[order(david2.cd.sf.hm$ID),]
david2.cd.sf.hm<-as.matrix(t(david2.1.cd.sf.hm))

david3.1.cd.sf.hm<-david3.cd.sf.hm[order(david3.cd.sf.hm$ID),]
david3.cd.sf.hm<-as.matrix(t(david3.1.cd.sf.hm))

david4.1.cd.sf.hm<-david4.cd.sf.hm[order(david4.cd.sf.hm$ID),]
david4.cd.sf.hm<-as.matrix(t(david4.1.cd.sf.hm))

david5.1.cd.sf.hm<-david5.cd.sf.hm[order(david5.cd.sf.hm$ID),]
david5.cd.sf.hm<-as.matrix(t(david5.1.cd.sf.hm))

david6.1.cd.sf.hm<-david6.cd.sf.hm[order(david6.cd.sf.hm$ID),]
david6.cd.sf.hm<-as.matrix(t(david6.1.cd.sf.hm))

david7.1.cd.sf.hm<-david7.cd.sf.hm[order(david7.cd.sf.hm$ID),]
david7.cd.sf.hm<-as.matrix(t(david7.1.cd.sf.hm))

david8.1.cd.sf.hm<-david8.cd.sf.hm[order(david8.cd.sf.hm$ID),]
david8.cd.sf.hm<-as.matrix(t(david8.1.cd.sf.hm))

david9.1.cd.sf.hm<-david9.cd.sf.hm[order(david9.cd.sf.hm$ID),]
david9.cd.sf.hm<-as.matrix(t(david9.1.cd.sf.hm))

david10.1.cd.sf.hm<-david10.cd.sf.hm[order(david10.cd.sf.hm$ID),]
david10.cd.sf.hm<-as.matrix(t(david10.1.cd.sf.hm))

david.hm.cd.sf.hm<-as.data.frame(matrix(c(david1.cd.sf.hm,david2.cd.sf.hm,david3.cd.sf.hm,david4.cd.sf.hm,david5.cd.sf.hm,david6.cd.sf.hm,david7.cd.sf.hm,david8.cd.sf.hm,david9.cd.sf.hm,david10.cd.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.cd.sf.hm<-data.frame(ID=david.hm.cd.sf.hm$V1,DS=david.hm.cd.sf.hm$V2,normDS=david.hm.cd.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.cd.sf.hm<-lm(e1.1.cd.sf.hm$energy_over_time~as.numeric(david1.1.cd.sf.hm$normDS))
hm.lm.1.s.cd.sf.hm<-summary(lm.hm.1.cd.sf.hm)$coefficients
hm.1.slope.cd.sf.hm<-hm.lm.1.s.cd.sf.hm[2,1]
lm.hm.2.cd.sf.hm<-lm(e2.1.cd.sf.hm$energy_over_time~as.numeric(david2.1.cd.sf.hm$normDS))
hm.lm.2.s.cd.sf.hm<-summary(lm.hm.2.cd.sf.hm)$coefficients
hm.2.slope.cd.sf.hm<-hm.lm.2.s.cd.sf.hm[2,1]
lm.hm.3.cd.sf.hm<-lm(e3.1.cd.sf.hm$energy_over_time~as.numeric(david3.1.cd.sf.hm$normDS))
hm.lm.3.s.cd.sf.hm<-summary(lm.hm.3.cd.sf.hm)$coefficients
hm.3.slope.cd.sf.hm<-hm.lm.3.s.cd.sf.hm[2,1]
lm.hm.4.cd.sf.hm<-lm(e4.1.cd.sf.hm$energy_over_time~as.numeric(david4.1.cd.sf.hm$normDS))
hm.lm.4.s.cd.sf.hm<-summary(lm.hm.4.cd.sf.hm)$coefficients
hm.4.slope.cd.sf.hm<-hm.lm.4.s.cd.sf.hm[2,1]
lm.hm.5.cd.sf.hm<-lm(e5.1.cd.sf.hm$energy_over_time~as.numeric(david5.1.cd.sf.hm$normDS))
hm.lm.5.s.cd.sf.hm<-summary(lm.hm.5.cd.sf.hm)$coefficients
hm.5.slope.cd.sf.hm<-hm.lm.5.s.cd.sf.hm[2,1]
lm.hm.6.cd.sf.hm<-lm(e6.1.cd.sf.hm$energy_over_time~as.numeric(david6.1.cd.sf.hm$normDS))
hm.lm.6.s.cd.sf.hm<-summary(lm.hm.6.cd.sf.hm)$coefficients
hm.6.slope.cd.sf.hm<-hm.lm.6.s.cd.sf.hm[2,1]
lm.hm.7.cd.sf.hm<-lm(e7.1.cd.sf.hm$energy_over_time~as.numeric(david7.1.cd.sf.hm$normDS))
hm.lm.7.s.cd.sf.hm<-summary(lm.hm.7.cd.sf.hm)$coefficients
hm.7.slope.cd.sf.hm<-hm.lm.7.s.cd.sf.hm[2,1]
lm.hm.8.cd.sf.hm<-lm(e8.1.cd.sf.hm$energy_over_time~as.numeric(david8.1.cd.sf.hm$normDS))
hm.lm.8.s.cd.sf.hm<-summary(lm.hm.8.cd.sf.hm)$coefficients
hm.8.slope.cd.sf.hm<-hm.lm.8.s.cd.sf.hm[2,1]
lm.hm.9.cd.sf.hm<-lm(e9.1.cd.sf.hm$energy_over_time~as.numeric(david9.1.cd.sf.hm$normDS))
hm.lm.9.s.cd.sf.hm<-summary(lm.hm.9.cd.sf.hm)$coefficients
hm.9.slope.cd.sf.hm<-hm.lm.9.s.cd.sf.hm[2,1]
lm.hm.10.cd.sf.hm<-lm(e10.1.cd.sf.hm$energy_over_time~as.numeric(david10.1.cd.sf.hm$normDS))
hm.lm.10.s.cd.sf.hm<-summary(lm.hm.10.cd.sf.hm)$coefficients
hm.10.slope.cd.sf.hm<-hm.lm.10.s.cd.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.cd.sf.ss<-data.frame(triangle.transitivity=c(tri1.cd.sf.hm,tri2.cd.sf.hm,tri3.cd.sf.hm,tri4.cd.sf.hm,tri5.cd.sf.hm,tri6.cd.sf.hm,tri7.cd.sf.hm,tri8.cd.sf.hm,tri9.cd.sf.hm,tri10.cd.sf.hm),escalation=c(ep1.cd.sf.hm,ep2.cd.sf.hm,ep3.cd.sf.hm,ep4.cd.sf.hm,ep5.cd.sf.hm,ep6.cd.sf.hm,ep7.cd.sf.hm,ep8.cd.sf.hm,ep9.cd.sf.hm,ep10.cd.sf.hm),dci=c(dci1.cd.sf.hm,dci2.cd.sf.hm,dci3.cd.sf.hm,dci4.cd.sf.hm,dci5.cd.sf.hm,dci6.cd.sf.hm,dci7.cd.sf.hm,dci8.cd.sf.hm,dci9.cd.sf.hm,dci10.cd.sf.hm),steepness=c(s1.cd.sf.hm,s2.cd.sf.hm,s3.cd.sf.hm,s4.cd.sf.hm,s5.cd.sf.hm,s6.cd.sf.hm,s7.cd.sf.hm,s8.cd.sf.hm,s9.cd.sf.hm,s10.cd.sf.hm),slope=c(hm.1.slope.cd.sf.hm,hm.2.slope.cd.sf.hm,hm.3.slope.cd.sf.hm,hm.4.slope.cd.sf.hm,hm.5.slope.cd.sf.hm,hm.6.slope.cd.sf.hm,hm.7.slope.cd.sf.hm,hm.8.slope.cd.sf.hm,hm.9.slope.cd.sf.hm,hm.10.slope.cd.sf.hm))



#Overall linear models of each scenario 
km.lm.dc.sf<-lm((energy.km.df.cd.sf.km$energy_over_time)~as.numeric(david.km.df.cd.sf.km$normDS)) #knowledge mutual linear model
hm.lm.dc.sf<-lm((energy.hm.df.cd.sf.hm$energy_over_time)~as.numeric(david.hm.df.cd.sf.hm$normDS)) #history mutual linear model
```
```{r Clumped Deterministic Data Frame}
# Generate energy data frame:
total.energy.dc.sf<-data.frame(energy.km.df.cd.sf.km)
total.energy.dc.sf<-rbind(total.energy.dc.sf,energy.hm.df.cd.sf.hm)

total.david.dc.sf<-data.frame(david.km.df.cd.sf.km)
total.david.dc.sf<-rbind(total.david.dc.sf,david.hm.df.cd.sf.hm)

total.energy.dc.sf<-cbind(total.energy.dc.sf,normDS=total.david.dc.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.dc.sf<-mean(km.cd.sf.ss$triangle.transitivity)
  km.dc.sfi.dc.sf<-mean(km.cd.sf.ss$dci)
  km.esc.dc.sf<-mean(km.cd.sf.ss$escalation)
  km.steep.dc.sf<-mean(km.cd.sf.ss$steepness)
  km.slope.dc.sf<-mean(km.cd.sf.ss$slope)
  km.mean.dc.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.dc.sf,dci=km.dc.sfi.dc.sf,esc=km.esc.dc.sf,steepness=km.steep.dc.sf,slope=km.slope.dc.sf,dist="clumped",calc="deterministic")

  # history mutual
  hm.tt.dc.sf<-mean(hm.cd.sf.ss$triangle.transitivity)
  hm.dc.sfi.dc.sf<-mean(hm.cd.sf.ss$dci)
  hm.esc.dc.sf<-mean(hm.cd.sf.ss$escalation)
  hm.steep.dc.sf<-mean(hm.cd.sf.ss$steepness)
  hm.slope.dc.sf<-mean(hm.cd.sf.ss$slope)
  hm.mean.dc.sf<-data.frame(scenario="History Mutual",tt=hm.tt.dc.sf,dci=hm.dc.sfi.dc.sf,esc=hm.esc.dc.sf,steepness=hm.steep.dc.sf,slope=hm.slope.dc.sf,dist="clumped",calc="deterministic")

# Data frame of all averages
dc.ave<-rbind(km.mean.dc.sf,hm.mean.dc.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.dc.sf<-mean(km.cd.sf.ss$triangle.transitivity)
  km.dc.sfi.dc.sf<-mean(km.cd.sf.ss$dci)
  km.esc.dc.sf<-mean(km.cd.sf.ss$escalation)
  km.steep.dc.sf<-mean(km.cd.sf.ss$steepness)
  km.slope.dc.sf<-mean(km.cd.sf.ss$slope)
  km.mean.dc.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.sf,dci=km.dc.sfi.dc.sf,esc=km.esc.dc.sf,steepness=km.steep.dc.sf,slope=km.slope.dc.sf,dist="clumped",calc="deterministic")
  
  #history mutual
  hm.tt.dc.sf<-mean(hm.cd.sf.ss$triangle.transitivity)
  hm.dc.sfi.dc.sf<-mean(hm.cd.sf.ss$dci)
  hm.esc.dc.sf<-mean(hm.cd.sf.ss$escalation)
  hm.steep.dc.sf<-mean(hm.cd.sf.ss$steepness)
  hm.slope.dc.sf<-mean(hm.cd.sf.ss$slope)
  hm.mean.dc.sf<-data.frame(scenario="History Mutual",tt=hm.tt.dc.sf,dci=hm.dc.sfi.dc.sf,esc=hm.esc.dc.sf,steepness=hm.steep.dc.sf,slope=hm.slope.dc.sf,dist="clumped",calc="deterministic")
  
# Generate data frame for all averages:
dc.ave<-rbind(km.mean.dc.sf,hm.mean.dc.sf)

# Create overall dataframe of summary statistics:
overall.clump.sf.deter.sf<-data.frame(km.cd.sf.ss)
overall.clump.sf.deter.sf<-rbind(overall.clump.sf.deter.sf,hm.cd.sf.ss)

overall.clump.sf.deter.sf<-cbind(overall.clump.sf.deter.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.clump.sf.deter.sf<-cbind(overall.clump.sf.deter.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("deter",20))


rhp.cd.sf.ss<-overall.clump.sf.deter.sf[overall.clump.sf.deter.sf$variable=="rhp",]
history.cd.sf.ss<-overall.clump.sf.deter.sf[overall.clump.sf.deter.sf$variable=="history",]

overall.clump.sf.deter.sf$combo<-paste(overall.clump.sf.deter.sf$strategy,overall.clump.sf.deter.sf$variable,overall.clump.sf.deter.sf$distribution)
overall.clump.sf.deter.sf$combo2<-paste(overall.clump.sf.deter.sf$strategy,overall.clump.sf.deter.sf$variable) #final dataframe for deterministic clumped data
```

## Avoids Clumped Deterministic Data
```{r Avoids Clumped Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid.cd.sf.km<-sapply(files, read.csv)

# Generate avoid.cd.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.acd.km<-data.frame(X1=avoid.cd.sf.km[[1]],X2=avoid.cd.sf.km[[2]],Avoids=avoid.cd.sf.km[[3]])
mat1.acd.km<-avoid.inter.mat(mut1.acd.km)
tri1.acd.km<-tr.tri(mat1.acd.km)
dci1.acd.km<-DCindex(mat1.acd.km)
mat1.acd.km[is.na(mat1.acd.km)] = 0
h1.acd.km<-h.index(mat1.acd.km)

ep1.acd.km<-ep(mut1.acd.km,a1.cd.sf.km)
david1.acd.km<-DS(mat1.acd.km) #David's Scores - for steepness use normDS output
ordrank.1.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acd.km<-cbind(ordrank.1.acd.km,ds=david1.acd.km$normDS)
lm1.acd.km<-summary(lm(ordrank.1.acd.km$ds~ordrank.1.acd.km$ord.rank))
s1.acd.km<-lm1.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acd.km<-data.frame(X1=avoid.cd.sf.km[[4]],X2=avoid.cd.sf.km[[5]],Avoids=avoid.cd.sf.km[[6]])
mat2.acd.km<-avoid.inter.mat(mut2.acd.km)
tri2.acd.km<-tr.tri(mat2.acd.km)
dci2.acd.km<-DCindex(mat2.acd.km)
mat2.acd.km[is.na(mat2.acd.km)] = 0
h2.acd.km<-h.index(mat2.acd.km)

ep2.acd.km<-ep(mut2.acd.km,a2.cd.sf.km)
david2.acd.km<-DS(mat2.acd.km) #David's Scores - for steepness use normDS output
ordrank.2.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acd.km<-cbind(ordrank.2.acd.km,ds=david2.acd.km$normDS)
lm2.acd.km<-summary(lm(ordrank.2.acd.km$ds~ordrank.2.acd.km$ord.rank))
s2.acd.km<-lm2.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acd.km<-data.frame(X1=avoid.cd.sf.km[[7]],X2=avoid.cd.sf.km[[8]],Avoids=avoid.cd.sf.km[[9]])
mat3.acd.km<-avoid.inter.mat(mut3.acd.km)
tri3.acd.km<-tr.tri(mat3.acd.km)
dci3.acd.km<-DCindex(mat3.acd.km)
mat3.acd.km[is.na(mat3.acd.km)] = 0
h3.acd.km<-h.index(mat3.acd.km)

ep3.acd.km<-ep(mut3.acd.km,a3.cd.sf.km)
david3.acd.km<-DS(mat3.acd.km) #David's Scores - for steepness use normDS output
ordrank.3.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acd.km<-cbind(ordrank.3.acd.km,ds=david3.acd.km$normDS)
lm3.acd.km<-summary(lm(ordrank.3.acd.km$ds~ordrank.3.acd.km$ord.rank))
s3.acd.km<-lm3.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acd.km<-data.frame(X1=avoid.cd.sf.km[[10]],X2=avoid.cd.sf.km[[11]],Avoids=avoid.cd.sf.km[[12]])
mat4.acd.km<-avoid.inter.mat(mut4.acd.km)
tri4.acd.km<-tr.tri(mat4.acd.km)
dci4.acd.km<-DCindex(mat4.acd.km)
mat4.acd.km[is.na(mat4.acd.km)] = 0
h4.acd.km<-h.index(mat4.acd.km)

ep4.acd.km<-ep(mut4.acd.km,a4.cd.sf.km)
david4.acd.km<-DS(mat4.acd.km) #David's Scores - for steepness use normDS output
ordrank.4.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acd.km<-cbind(ordrank.4.acd.km,ds=david4.acd.km$normDS)
lm4.acd.km<-summary(lm(ordrank.4.acd.km$ds~ordrank.4.acd.km$ord.rank))
s4.acd.km<-lm4.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acd.km<-data.frame(X1=avoid.cd.sf.km[[13]],X2=avoid.cd.sf.km[[14]],Avoids=avoid.cd.sf.km[[15]])
mat5.acd.km<-avoid.inter.mat(mut5.acd.km)
tri5.acd.km<-tr.tri(mat5.acd.km)
dci5.acd.km<-DCindex(mat5.acd.km)
mat5.acd.km[is.na(mat5.acd.km)] = 0
h5.acd.km<-h.index(mat5.acd.km)

ep5.acd.km<-ep(mut5.acd.km,a5.cd.sf.km)
david5.acd.km<-DS(mat5.acd.km) #David's Scores - for steepness use normDS output
ordrank.5.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acd.km<-cbind(ordrank.5.acd.km,ds=david5.acd.km$normDS)
lm5.acd.km<-summary(lm(ordrank.5.acd.km$ds~ordrank.5.acd.km$ord.rank))
s5.acd.km<-lm5.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acd.km<-data.frame(X1=avoid.cd.sf.km[[16]],X2=avoid.cd.sf.km[[17]],Avoids=avoid.cd.sf.km[[18]])
mat6.acd.km<-avoid.inter.mat(mut6.acd.km)
tri6.acd.km<-tr.tri(mat6.acd.km)
dci6.acd.km<-DCindex(mat6.acd.km)
mat6.acd.km[is.na(mat6.acd.km)] = 0
h6.acd.km<-h.index(mat6.acd.km)

ep6.acd.km<-ep(mut6.acd.km,a6.cd.sf.km)
david6.acd.km<-DS(mat6.acd.km) #David's Scores - for steepness use normDS output
ordrank.6.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acd.km<-cbind(ordrank.6.acd.km,ds=david6.acd.km$normDS)
lm6.acd.km<-summary(lm(ordrank.6.acd.km$ds~ordrank.6.acd.km$ord.rank))
s6.acd.km<-lm6.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acd.km<-data.frame(X1=avoid.cd.sf.km[[19]],X2=avoid.cd.sf.km[[20]],Avoids=avoid.cd.sf.km[[21]])
mat7.acd.km<-avoid.inter.mat(mut7.acd.km)
tri7.acd.km<-tr.tri(mat7.acd.km)
dci7.acd.km<-DCindex(mat7.acd.km)
mat7.acd.km[is.na(mat7.acd.km)] = 0
h7.acd.km<-h.index(mat7.acd.km)

ep7.acd.km<-ep(mut7.acd.km,a7.cd.sf.km)
david7.acd.km<-DS(mat7.acd.km) #David's Scores - for steepness use normDS output
ordrank.7.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acd.km<-cbind(ordrank.7.acd.km,ds=david7.acd.km$normDS)
lm7.acd.km<-summary(lm(ordrank.7.acd.km$ds~ordrank.7.acd.km$ord.rank))
s7.acd.km<-lm7.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acd.km<-data.frame(X1=avoid.cd.sf.km[[22]],X2=avoid.cd.sf.km[[23]],Avoids=avoid.cd.sf.km[[24]])
mat8.acd.km<-avoid.inter.mat(mut8.acd.km)
tri8.acd.km<-tr.tri(mat8.acd.km)
dci8.acd.km<-DCindex(mat8.acd.km)
mat8.acd.km[is.na(mat8.acd.km)] = 0
h8.acd.km<-h.index(mat8.acd.km)

ep8.acd.km<-ep(mut8.acd.km,a8.cd.sf.km)
david8.acd.km<-DS(mat8.acd.km) #David's Scores - for steepness use normDS output
ordrank.8.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acd.km<-cbind(ordrank.8.acd.km,ds=david8.acd.km$normDS)
lm8.acd.km<-summary(lm(ordrank.8.acd.km$ds~ordrank.8.acd.km$ord.rank))
s8.acd.km<-lm8.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acd.km<-data.frame(X1=avoid.cd.sf.km[[25]],X2=avoid.cd.sf.km[[26]],Avoids=avoid.cd.sf.km[[27]])
mat9.acd.km<-avoid.inter.mat(mut9.acd.km)
tri9.acd.km<-tr.tri(mat9.acd.km)
dci9.acd.km<-DCindex(mat9.acd.km)
mat9.acd.km[is.na(mat9.acd.km)] = 0
h9.acd.km<-h.index(mat9.acd.km)

ep9.acd.km<-ep(mut9.acd.km,a9.cd.sf.km)
david9.acd.km<-DS(mat9.acd.km) #David's Scores - for steepness use normDS output
ordrank.9.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acd.km<-cbind(ordrank.9.acd.km,ds=david9.acd.km$normDS)
lm9.acd.km<-summary(lm(ordrank.9.acd.km$ds~ordrank.9.acd.km$ord.rank))
s9.acd.km<-lm9.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acd.km<-data.frame(X1=avoid.cd.sf.km[[28]],X2=avoid.cd.sf.km[[29]],Avoids=avoid.cd.sf.km[[30]])
mat10.acd.km<-avoid.inter.mat(mut10.acd.km)
tri10.acd.km<-tr.tri(mat10.acd.km)
dci10.acd.km<-DCindex(mat10.acd.km)
mat10.acd.km[is.na(mat10.acd.km)] = 0
h10.acd.km<-h.index(mat10.acd.km)

ep10.acd.km<-ep(mut10.acd.km,a10.cd.sf.km)
david10.acd.km<-DS(mat10.acd.km) #David's Scores - for steepness use normDS output
ordrank.10.acd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acd.km<-cbind(ordrank.10.acd.km,ds=david10.acd.km$normDS)
lm10.acd.km<-summary(lm(ordrank.10.acd.km$ds~ordrank.10.acd.km$ord.rank))
s10.acd.km<-lm10.acd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acd.km<-sum(mut1.acd.km$Victories)
int2.acd.km<-sum(mut2.acd.km$Victories)
int3.acd.km<-sum(mut3.acd.km$Victories)
int4.acd.km<-sum(mut4.acd.km$Victories)
int5.acd.km<-sum(mut5.acd.km$Victories)
int6.acd.km<-sum(mut6.acd.km$Victories)
int7.acd.km<-sum(mut7.acd.km$Victories)
int8.acd.km<-sum(mut8.acd.km$Victories)
int9.acd.km<-sum(mut9.acd.km$Victories)
int10.acd.km<-sum(mut10.acd.km$Victories)

  # Summarize the avoidances in each trial:
av1.acd.km<-sum(a1.cd.sf.km$Avoids)
av2.acd.km<-sum(a2.cd.sf.km$Avoids)
av3.acd.km<-sum(a3.cd.sf.km$Avoids)
av4.acd.km<-sum(a4.cd.sf.km$Avoids)
av5.acd.km<-sum(a5.cd.sf.km$Avoids)
av6.acd.km<-sum(a6.cd.sf.km$Avoids)
av7.acd.km<-sum(a7.cd.sf.km$Avoids)
av8.acd.km<-sum(a8.cd.sf.km$Avoids)
av9.acd.km<-sum(a9.cd.sf.km$Avoids)
av10.acd.km<-sum(a10.cd.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.acd<-(sum(av1.acd.km, av2.acd.km, av3.acd.km, av4.acd.km, av5.acd.km, av6.acd.km, av7.acd.km, av8.acd.km, av9.acd.km, av10.acd.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.acd<-(sum(int1.acd.km, int2.acd.km, int3.acd.km, int4.acd.km, int5.acd.km, int6.acd.km, int7.acd.km, int8.acd.km, int9.acd.km, int10.acd.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acd.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acd.km<-e1.acd.km[order(e1.acd.km$ID),]
e1.acd.km<-as.matrix(t(e1.1.acd.km))

e2.acd.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acd.km<-e2.acd.km[order(e2.acd.km$ID),]
e2.acd.km<-as.matrix(t(e2.1.acd.km))

e3.acd.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acd.km<-e3.acd.km[order(e3.acd.km$ID),]
e3.acd.km<-as.matrix(t(e3.1.acd.km))

e4.acd.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acd.km<-e4.acd.km[order(e4.acd.km$ID),]
e4.acd.km<-as.matrix(t(e4.1.acd.km))

e5.acd.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acd.km<-e5.acd.km[order(e5.acd.km$ID),]
e5.acd.km<-as.matrix(t(e5.1.acd.km))

e6.acd.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acd.km<-e6.acd.km[order(e6.acd.km$ID),]
e6.acd.km<-as.matrix(t(e6.1.acd.km))

e7.acd.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acd.km<-e7.acd.km[order(e7.acd.km$ID),]
e7.acd.km<-as.matrix(t(e7.1.acd.km))

e8.acd.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acd.km<-e8.acd.km[order(e8.acd.km$ID),]
e8.acd.km<-as.matrix(t(e8.1.acd.km))

e9.acd.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acd.km<-e9.acd.km[order(e9.acd.km$ID),]
e9.acd.km<-as.matrix(t(e9.1.acd.km))

e10.acd.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acd.km<-e10.acd.km[order(e10.acd.km$ID),]
e10.acd.km<-as.matrix(t(e10.1.acd.km))

energy.km.acd.km<-as.data.frame(matrix(c(e1.acd.km,e2.acd.km,e3.acd.km,e4.acd.km,e5.acd.km,e6.acd.km,e7.acd.km,e8.acd.km,e9.acd.km,e10.acd.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.acd.km<-data.frame(ID=energy.km.acd.km$V1,energy_over_distance=energy.km.acd.km$V2,energy_over_time=energy.km.acd.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acd.km<-david1.acd.km[order(david1.acd.km$ID),]
david1.acd.km<-as.matrix(t(david1.1.acd.km))

david2.1.acd.km<-david2.acd.km[order(david2.acd.km$ID),]
david2.acd.km<-as.matrix(t(david2.1.acd.km))

david3.1.acd.km<-david3.acd.km[order(david3.acd.km$ID),]
david3.acd.km<-as.matrix(t(david3.1.acd.km))

david4.1.acd.km<-david4.acd.km[order(david4.acd.km$ID),]
david4.acd.km<-as.matrix(t(david4.1.acd.km))

david5.1.acd.km<-david5.acd.km[order(david5.acd.km$ID),]
david5.acd.km<-as.matrix(t(david5.1.acd.km))

david6.1.acd.km<-david6.acd.km[order(david6.acd.km$ID),]
david6.acd.km<-as.matrix(t(david6.1.acd.km))

david7.1.acd.km<-david7.acd.km[order(david7.acd.km$ID),]
david7.acd.km<-as.matrix(t(david7.1.acd.km))

david8.1.acd.km<-david8.acd.km[order(david8.acd.km$ID),]
david8.acd.km<-as.matrix(t(david8.1.acd.km))

david9.1.acd.km<-david9.acd.km[order(david9.acd.km$ID),]
david9.acd.km<-as.matrix(t(david9.1.acd.km))

david10.1.acd.km<-david10.acd.km[order(david10.acd.km$ID),]
david10.acd.km<-as.matrix(t(david10.1.acd.km))

david.km.acd.km<-as.data.frame(matrix(c(david1.acd.km,david2.acd.km,david3.acd.km,david4.acd.km,david5.acd.km,david6.acd.km,david7.acd.km,david8.acd.km,david9.acd.km,david10.acd.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.acd.km<-data.frame(ID=david.km.acd.km$V1,DS=david.km.acd.km$V2,normDS=david.km.acd.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.acd.km<-lm(e1.1.acd.km$energy_over_time~as.numeric(david1.1.acd.km$normDS))
km.lm.1.s.acd.km<-summary(lm.km.1.acd.km)$coefficients
km.1.slope.acd.km<-km.lm.1.s.acd.km[2,1]
lm.km.2.acd.km<-lm(e2.1.acd.km$energy_over_time~as.numeric(david2.1.acd.km$normDS))
km.lm.2.s.acd.km<-summary(lm.km.2.acd.km)$coefficients
km.2.slope.acd.km<-km.lm.2.s.acd.km[2,1]
lm.km.3.acd.km<-lm(e3.1.acd.km$energy_over_time~as.numeric(david3.1.acd.km$normDS))
km.lm.3.s.acd.km<-summary(lm.km.3.acd.km)$coefficients
km.3.slope.acd.km<-km.lm.3.s.acd.km[2,1]
lm.km.4.acd.km<-lm(e4.1.acd.km$energy_over_time~as.numeric(david4.1.acd.km$normDS))
km.lm.4.s.acd.km<-summary(lm.km.4.acd.km)$coefficients
km.4.slope.acd.km<-km.lm.4.s.acd.km[2,1]
lm.km.5.acd.km<-lm(e5.1.acd.km$energy_over_time~as.numeric(david5.1.acd.km$normDS))
km.lm.5.s.acd.km<-summary(lm.km.5.acd.km)$coefficients
km.5.slope.acd.km<-km.lm.5.s.acd.km[2,1]
lm.km.6.acd.km<-lm(e6.1.acd.km$energy_over_time~as.numeric(david6.1.acd.km$normDS))
km.lm.6.s.acd.km<-summary(lm.km.6.acd.km)$coefficients
km.6.slope.acd.km<-km.lm.6.s.acd.km[2,1]
lm.km.7.acd.km<-lm(e7.1.acd.km$energy_over_time~as.numeric(david7.1.acd.km$normDS))
km.lm.7.s.acd.km<-summary(lm.km.7.acd.km)$coefficients
km.7.slope.acd.km<-km.lm.7.s.acd.km[2,1]
lm.km.8.acd.km<-lm(e8.1.acd.km$energy_over_time~as.numeric(david8.1.acd.km$normDS))
km.lm.8.s.acd.km<-summary(lm.km.8.acd.km)$coefficients
km.8.slope.acd.km<-km.lm.8.s.acd.km[2,1]
lm.km.9.acd.km<-lm(e9.1.acd.km$energy_over_time~as.numeric(david9.1.acd.km$normDS))
km.lm.9.s.acd.km<-summary(lm.km.9.acd.km)$coefficients
km.9.slope.acd.km<-km.lm.9.s.acd.km[2,1]
lm.km.10.acd.km<-lm(e10.1.acd.km$energy_over_time~as.numeric(david10.1.acd.km$normDS))
km.lm.10.s.acd.km<-summary(lm.km.10.acd.km)$coefficients
km.10.slope.acd.km<-km.lm.10.s.acd.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.acd.ss.avoid.cd.sf.km<-data.frame(triangle.transitivity=c(tri1.acd.km,tri2.acd.km,tri3.acd.km,tri4.acd.km,tri5.acd.km,tri6.acd.km,tri7.acd.km,tri8.acd.km,tri9.acd.km,tri10.acd.km),escalation=c(ep1.acd.km,ep2.acd.km,ep3.acd.km,ep4.acd.km,ep5.acd.km,ep6.acd.km,ep7.acd.km,ep8.acd.km,ep9.acd.km,ep10.acd.km),dci=c(dci1.acd.km,dci2.acd.km,dci3.acd.km,dci4.acd.km,dci5.acd.km,dci6.acd.km,dci7.acd.km,dci8.acd.km,dci9.acd.km,dci10.acd.km),steepness=c(s1.acd.km,s2.acd.km,s3.acd.km,s4.acd.km,s5.acd.km,s6.acd.km,s7.acd.km,s8.acd.km,s9.acd.km,s10.acd.km),slope=c(km.1.slope.acd.km,km.2.slope.acd.km,km.3.slope.acd.km,km.4.slope.acd.km,km.5.slope.acd.km,km.6.slope.acd.km,km.7.slope.acd.km,km.8.slope.acd.km,km.9.slope.acd.km,km.10.slope.acd.km))



#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/avoid")

files<-list.files(pattern="*.csv")
avoid.cd.sf.hm<-sapply(files, read.csv)

# Generate avoid.cd.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[1]],X2=avoid.cd.sf.hm[[2]],Avoids=avoid.cd.sf.hm[[3]])
mat1.acd.hm<-avoid.inter.mat(mut1.acd.hm)
tri1.acd.hm<-tr.tri(mat1.acd.hm)
dci1.acd.hm<-DCindex(mat1.acd.hm)
mat1.acd.hm[is.na(mat1.acd.hm)] = 0
h1.acd.hm<-h.index(mat1.acd.hm)

ep1.acd.hm<-ep(mut1.acd.hm,a1.cd.sf.hm)
david1.acd.hm<-DS(mat1.acd.hm) #David's Scores - for steepness use normDS output
ordrank.1.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acd.hm<-cbind(ordrank.1.acd.hm,ds=david1.acd.hm$normDS)
lm1.acd.hm<-summary(lm(ordrank.1.acd.hm$ds~ordrank.1.acd.hm$ord.rank))
s1.acd.hm<-lm1.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[4]],X2=avoid.cd.sf.hm[[5]],Avoids=avoid.cd.sf.hm[[6]])
mat2.acd.hm<-avoid.inter.mat(mut2.acd.hm)
tri2.acd.hm<-tr.tri(mat2.acd.hm)
dci2.acd.hm<-DCindex(mat2.acd.hm)
mat2.acd.hm[is.na(mat2.acd.hm)] = 0
h2.acd.hm<-h.index(mat2.acd.hm)

ep2.acd.hm<-ep(mut2.acd.hm,a2.cd.sf.hm)
david2.acd.hm<-DS(mat2.acd.hm) #David's Scores - for steepness use normDS output
ordrank.2.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acd.hm<-cbind(ordrank.2.acd.hm,ds=david2.acd.hm$normDS)
lm2.acd.hm<-summary(lm(ordrank.2.acd.hm$ds~ordrank.2.acd.hm$ord.rank))
s2.acd.hm<-lm2.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[7]],X2=avoid.cd.sf.hm[[8]],Avoids=avoid.cd.sf.hm[[9]])
mat3.acd.hm<-avoid.inter.mat(mut3.acd.hm)
tri3.acd.hm<-tr.tri(mat3.acd.hm)
dci3.acd.hm<-DCindex(mat3.acd.hm)
mat3.acd.hm[is.na(mat3.acd.hm)] = 0
h3.acd.hm<-h.index(mat3.acd.hm)

ep3.acd.hm<-ep(mut3.acd.hm,a3.cd.sf.hm)
david3.acd.hm<-DS(mat3.acd.hm) #David's Scores - for steepness use normDS output
ordrank.3.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acd.hm<-cbind(ordrank.3.acd.hm,ds=david3.acd.hm$normDS)
lm3.acd.hm<-summary(lm(ordrank.3.acd.hm$ds~ordrank.3.acd.hm$ord.rank))
s3.acd.hm<-lm3.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[10]],X2=avoid.cd.sf.hm[[11]],Avoids=avoid.cd.sf.hm[[12]])
mat4.acd.hm<-avoid.inter.mat(mut4.acd.hm)
tri4.acd.hm<-tr.tri(mat4.acd.hm)
dci4.acd.hm<-DCindex(mat4.acd.hm)
mat4.acd.hm[is.na(mat4.acd.hm)] = 0
h4.acd.hm<-h.index(mat4.acd.hm)

ep4.acd.hm<-ep(mut4.acd.hm,a4.cd.sf.hm)
david4.acd.hm<-DS(mat4.acd.hm) #David's Scores - for steepness use normDS output
ordrank.4.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acd.hm<-cbind(ordrank.4.acd.hm,ds=david4.acd.hm$normDS)
lm4.acd.hm<-summary(lm(ordrank.4.acd.hm$ds~ordrank.4.acd.hm$ord.rank))
s4.acd.hm<-lm4.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[13]],X2=avoid.cd.sf.hm[[14]],Avoids=avoid.cd.sf.hm[[15]])
mat5.acd.hm<-avoid.inter.mat(mut5.acd.hm)
tri5.acd.hm<-tr.tri(mat5.acd.hm)
dci5.acd.hm<-DCindex(mat5.acd.hm)
mat5.acd.hm[is.na(mat5.acd.hm)] = 0
h5.acd.hm<-h.index(mat5.acd.hm)

ep5.acd.hm<-ep(mut5.acd.hm,a5.cd.sf.hm)
david5.acd.hm<-DS(mat5.acd.hm) #David's Scores - for steepness use normDS output
ordrank.5.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acd.hm<-cbind(ordrank.5.acd.hm,ds=david5.acd.hm$normDS)
lm5.acd.hm<-summary(lm(ordrank.5.acd.hm$ds~ordrank.5.acd.hm$ord.rank))
s5.acd.hm<-lm5.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[16]],X2=avoid.cd.sf.hm[[17]],Avoids=avoid.cd.sf.hm[[18]])
mat6.acd.hm<-avoid.inter.mat(mut6.acd.hm)
tri6.acd.hm<-tr.tri(mat6.acd.hm)
dci6.acd.hm<-DCindex(mat6.acd.hm)
mat6.acd.hm[is.na(mat6.acd.hm)] = 0
h6.acd.hm<-h.index(mat6.acd.hm)

ep6.acd.hm<-ep(mut6.acd.hm,a6.cd.sf.hm)
david6.acd.hm<-DS(mat6.acd.hm) #David's Scores - for steepness use normDS output
ordrank.6.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acd.hm<-cbind(ordrank.6.acd.hm,ds=david6.acd.hm$normDS)
lm6.acd.hm<-summary(lm(ordrank.6.acd.hm$ds~ordrank.6.acd.hm$ord.rank))
s6.acd.hm<-lm6.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[19]],X2=avoid.cd.sf.hm[[20]],Avoids=avoid.cd.sf.hm[[21]])
mat7.acd.hm<-avoid.inter.mat(mut7.acd.hm)
tri7.acd.hm<-tr.tri(mat7.acd.hm)
dci7.acd.hm<-DCindex(mat7.acd.hm)
mat7.acd.hm[is.na(mat7.acd.hm)] = 0
h7.acd.hm<-h.index(mat7.acd.hm)

ep7.acd.hm<-ep(mut7.acd.hm,a7.cd.sf.hm)
david7.acd.hm<-DS(mat7.acd.hm) #David's Scores - for steepness use normDS output
ordrank.7.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acd.hm<-cbind(ordrank.7.acd.hm,ds=david7.acd.hm$normDS)
lm7.acd.hm<-summary(lm(ordrank.7.acd.hm$ds~ordrank.7.acd.hm$ord.rank))
s7.acd.hm<-lm7.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[22]],X2=avoid.cd.sf.hm[[23]],Avoids=avoid.cd.sf.hm[[24]])
mat8.acd.hm<-avoid.inter.mat(mut8.acd.hm)
tri8.acd.hm<-tr.tri(mat8.acd.hm)
dci8.acd.hm<-DCindex(mat8.acd.hm)
mat8.acd.hm[is.na(mat8.acd.hm)] = 0
h8.acd.hm<-h.index(mat8.acd.hm)

ep8.acd.hm<-ep(mut8.acd.hm,a8.cd.sf.hm)
david8.acd.hm<-DS(mat8.acd.hm) #David's Scores - for steepness use normDS output
ordrank.8.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acd.hm<-cbind(ordrank.8.acd.hm,ds=david8.acd.hm$normDS)
lm8.acd.hm<-summary(lm(ordrank.8.acd.hm$ds~ordrank.8.acd.hm$ord.rank))
s8.acd.hm<-lm8.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[25]],X2=avoid.cd.sf.hm[[26]],Avoids=avoid.cd.sf.hm[[27]])
mat9.acd.hm<-avoid.inter.mat(mut9.acd.hm)
tri9.acd.hm<-tr.tri(mat9.acd.hm)
dci9.acd.hm<-DCindex(mat9.acd.hm)
mat9.acd.hm[is.na(mat9.acd.hm)] = 0
h9.acd.hm<-h.index(mat9.acd.hm)

ep9.acd.hm<-ep(mut9.acd.hm,a9.cd.sf.hm)
david9.acd.hm<-DS(mat9.acd.hm) #David's Scores - for steepness use normDS output
ordrank.9.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acd.hm<-cbind(ordrank.9.acd.hm,ds=david9.acd.hm$normDS)
lm9.acd.hm<-summary(lm(ordrank.9.acd.hm$ds~ordrank.9.acd.hm$ord.rank))
s9.acd.hm<-lm9.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acd.hm<-data.frame(X1=avoid.cd.sf.hm[[28]],X2=avoid.cd.sf.hm[[29]],Avoids=avoid.cd.sf.hm[[30]])
mat10.acd.hm<-avoid.inter.mat(mut10.acd.hm)
tri10.acd.hm<-tr.tri(mat10.acd.hm)
dci10.acd.hm<-DCindex(mat10.acd.hm)
mat10.acd.hm[is.na(mat10.acd.hm)] = 0
h10.acd.hm<-h.index(mat10.acd.hm)

ep10.acd.hm<-ep(mut10.acd.hm,a10.cd.sf.hm)
david10.acd.hm<-DS(mat10.acd.hm) #David's Scores - for steepness use normDS output
ordrank.10.acd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acd.hm<-cbind(ordrank.10.acd.hm,ds=david10.acd.hm$normDS)
lm10.acd.hm<-summary(lm(ordrank.10.acd.hm$ds~ordrank.10.acd.hm$ord.rank))
s10.acd.hm<-lm10.acd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acd.hm<-sum(mut1.acd.hm$Victories)
int2.acd.hm<-sum(mut2.acd.hm$Victories)
int3.acd.hm<-sum(mut3.acd.hm$Victories)
int4.acd.hm<-sum(mut4.acd.hm$Victories)
int5.acd.hm<-sum(mut5.acd.hm$Victories)
int6.acd.hm<-sum(mut6.acd.hm$Victories)
int7.acd.hm<-sum(mut7.acd.hm$Victories)
int8.acd.hm<-sum(mut8.acd.hm$Victories)
int9.acd.hm<-sum(mut9.acd.hm$Victories)
int10.acd.hm<-sum(mut10.acd.hm$Victories)

  # Summarize the avoidances in each trial:
av1.acd.hm<-sum(a1.cd.sf.hm$Avoids)
av2.acd.hm<-sum(a2.cd.sf.hm$Avoids)
av3.acd.hm<-sum(a3.cd.sf.hm$Avoids)
av4.acd.hm<-sum(a4.cd.sf.hm$Avoids)
av5.acd.hm<-sum(a5.cd.sf.hm$Avoids)
av6.acd.hm<-sum(a6.cd.sf.hm$Avoids)
av7.acd.hm<-sum(a7.cd.sf.hm$Avoids)
av8.acd.hm<-sum(a8.cd.sf.hm$Avoids)
av9.acd.hm<-sum(a9.cd.sf.hm$Avoids)
av10.acd.hm<-sum(a10.cd.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.acd<-(sum(av1.acd.hm, av2.acd.hm, av3.acd.hm, av4.acd.hm, av5.acd.hm, av6.acd.hm, av7.acd.hm, av8.acd.hm, av9.acd.hm, av10.acd.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.acd<-(sum(int1.acd.hm, int2.acd.hm, int3.acd.hm, int4.acd.hm, int5.acd.hm, int6.acd.hm, int7.acd.hm, int8.acd.hm, int9.acd.hm, int10.acd.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acd.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acd.hm<-e1.acd.hm[order(e1.acd.hm$ID),]
e1.acd.hm<-as.matrix(t(e1.1.acd.hm))

e2.acd.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acd.hm<-e2.acd.hm[order(e2.acd.hm$ID),]
e2.acd.hm<-as.matrix(t(e2.1.acd.hm))

e3.acd.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acd.hm<-e3.acd.hm[order(e3.acd.hm$ID),]
e3.acd.hm<-as.matrix(t(e3.1.acd.hm))

e4.acd.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acd.hm<-e4.acd.hm[order(e4.acd.hm$ID),]
e4.acd.hm<-as.matrix(t(e4.1.acd.hm))

e5.acd.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acd.hm<-e5.acd.hm[order(e5.acd.hm$ID),]
e5.acd.hm<-as.matrix(t(e5.1.acd.hm))

e6.acd.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acd.hm<-e6.acd.hm[order(e6.acd.hm$ID),]
e6.acd.hm<-as.matrix(t(e6.1.acd.hm))

e7.acd.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acd.hm<-e7.acd.hm[order(e7.acd.hm$ID),]
e7.acd.hm<-as.matrix(t(e7.1.acd.hm))

e8.acd.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acd.hm<-e8.acd.hm[order(e8.acd.hm$ID),]
e8.acd.hm<-as.matrix(t(e8.1.acd.hm))

e9.acd.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acd.hm<-e9.acd.hm[order(e9.acd.hm$ID),]
e9.acd.hm<-as.matrix(t(e9.1.acd.hm))

e10.acd.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acd.hm<-e10.acd.hm[order(e10.acd.hm$ID),]
e10.acd.hm<-as.matrix(t(e10.1.acd.hm))

energy.hm.acd.hm<-as.data.frame(matrix(c(e1.acd.hm,e2.acd.hm,e3.acd.hm,e4.acd.hm,e5.acd.hm,e6.acd.hm,e7.acd.hm,e8.acd.hm,e9.acd.hm,e10.acd.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.acd.hm<-data.frame(ID=energy.hm.acd.hm$V1,energy_over_distance=energy.hm.acd.hm$V2,energy_over_time=energy.hm.acd.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acd.hm<-david1.acd.hm[order(david1.acd.hm$ID),]
david1.acd.hm<-as.matrix(t(david1.1.acd.hm))

david2.1.acd.hm<-david2.acd.hm[order(david2.acd.hm$ID),]
david2.acd.hm<-as.matrix(t(david2.1.acd.hm))

david3.1.acd.hm<-david3.acd.hm[order(david3.acd.hm$ID),]
david3.acd.hm<-as.matrix(t(david3.1.acd.hm))

david4.1.acd.hm<-david4.acd.hm[order(david4.acd.hm$ID),]
david4.acd.hm<-as.matrix(t(david4.1.acd.hm))

david5.1.acd.hm<-david5.acd.hm[order(david5.acd.hm$ID),]
david5.acd.hm<-as.matrix(t(david5.1.acd.hm))

david6.1.acd.hm<-david6.acd.hm[order(david6.acd.hm$ID),]
david6.acd.hm<-as.matrix(t(david6.1.acd.hm))

david7.1.acd.hm<-david7.acd.hm[order(david7.acd.hm$ID),]
david7.acd.hm<-as.matrix(t(david7.1.acd.hm))

david8.1.acd.hm<-david8.acd.hm[order(david8.acd.hm$ID),]
david8.acd.hm<-as.matrix(t(david8.1.acd.hm))

david9.1.acd.hm<-david9.acd.hm[order(david9.acd.hm$ID),]
david9.acd.hm<-as.matrix(t(david9.1.acd.hm))

david10.1.acd.hm<-david10.acd.hm[order(david10.acd.hm$ID),]
david10.acd.hm<-as.matrix(t(david10.1.acd.hm))

david.hm.acd.hm<-as.data.frame(matrix(c(david1.acd.hm,david2.acd.hm,david3.acd.hm,david4.acd.hm,david5.acd.hm,david6.acd.hm,david7.acd.hm,david8.acd.hm,david9.acd.hm,david10.acd.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.acd.hm<-data.frame(ID=david.hm.acd.hm$V1,DS=david.hm.acd.hm$V2,normDS=david.hm.acd.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.acd.hm<-lm(e1.1.acd.hm$energy_over_time~as.numeric(david1.1.acd.hm$normDS))
hm.lm.1.s.acd.hm<-summary(lm.hm.1.acd.hm)$coefficients
hm.1.slope.acd.hm<-hm.lm.1.s.acd.hm[2,1]
lm.hm.2.acd.hm<-lm(e2.1.acd.hm$energy_over_time~as.numeric(david2.1.acd.hm$normDS))
hm.lm.2.s.acd.hm<-summary(lm.hm.2.acd.hm)$coefficients
hm.2.slope.acd.hm<-hm.lm.2.s.acd.hm[2,1]
lm.hm.3.acd.hm<-lm(e3.1.acd.hm$energy_over_time~as.numeric(david3.1.acd.hm$normDS))
hm.lm.3.s.acd.hm<-summary(lm.hm.3.acd.hm)$coefficients
hm.3.slope.acd.hm<-hm.lm.3.s.acd.hm[2,1]
lm.hm.4.acd.hm<-lm(e4.1.acd.hm$energy_over_time~as.numeric(david4.1.acd.hm$normDS))
hm.lm.4.s.acd.hm<-summary(lm.hm.4.acd.hm)$coefficients
hm.4.slope.acd.hm<-hm.lm.4.s.acd.hm[2,1]
lm.hm.5.acd.hm<-lm(e5.1.acd.hm$energy_over_time~as.numeric(david5.1.acd.hm$normDS))
hm.lm.5.s.acd.hm<-summary(lm.hm.5.acd.hm)$coefficients
hm.5.slope.acd.hm<-hm.lm.5.s.acd.hm[2,1]
lm.hm.6.acd.hm<-lm(e6.1.acd.hm$energy_over_time~as.numeric(david6.1.acd.hm$normDS))
hm.lm.6.s.acd.hm<-summary(lm.hm.6.acd.hm)$coefficients
hm.6.slope.acd.hm<-hm.lm.6.s.acd.hm[2,1]
lm.hm.7.acd.hm<-lm(e7.1.acd.hm$energy_over_time~as.numeric(david7.1.acd.hm$normDS))
hm.lm.7.s.acd.hm<-summary(lm.hm.7.acd.hm)$coefficients
hm.7.slope.acd.hm<-hm.lm.7.s.acd.hm[2,1]
lm.hm.8.acd.hm<-lm(e8.1.acd.hm$energy_over_time~as.numeric(david8.1.acd.hm$normDS))
hm.lm.8.s.acd.hm<-summary(lm.hm.8.acd.hm)$coefficients
hm.8.slope.acd.hm<-hm.lm.8.s.acd.hm[2,1]
lm.hm.9.acd.hm<-lm(e9.1.acd.hm$energy_over_time~as.numeric(david9.1.acd.hm$normDS))
hm.lm.9.s.acd.hm<-summary(lm.hm.9.acd.hm)$coefficients
hm.9.slope.acd.hm<-hm.lm.9.s.acd.hm[2,1]
lm.hm.10.acd.hm<-lm(e10.1.acd.hm$energy_over_time~as.numeric(david10.1.acd.hm$normDS))
hm.lm.10.s.acd.hm<-summary(lm.hm.10.acd.hm)$coefficients
hm.10.slope.acd.hm<-hm.lm.10.s.acd.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.acd.ss.avoid.cd.sf.hm<-data.frame(triangle.transitivity=c(tri1.acd.hm,tri2.acd.hm,tri3.acd.hm,tri4.acd.hm,tri5.acd.hm,tri6.acd.hm,tri7.acd.hm,tri8.acd.hm,tri9.acd.hm,tri10.acd.hm),escalation=c(ep1.acd.hm,ep2.acd.hm,ep3.acd.hm,ep4.acd.hm,ep5.acd.hm,ep6.acd.hm,ep7.acd.hm,ep8.acd.hm,ep9.acd.hm,ep10.acd.hm),dci=c(dci1.acd.hm,dci2.acd.hm,dci3.acd.hm,dci4.acd.hm,dci5.acd.hm,dci6.acd.hm,dci7.acd.hm,dci8.acd.hm,dci9.acd.hm,dci10.acd.hm),steepness=c(s1.acd.hm,s2.acd.hm,s3.acd.hm,s4.acd.hm,s5.acd.hm,s6.acd.hm,s7.acd.hm,s8.acd.hm,s9.acd.hm,s10.acd.hm),slope=c(hm.1.slope.acd.hm,hm.2.slope.acd.hm,hm.3.slope.acd.hm,hm.4.slope.acd.hm,hm.5.slope.acd.hm,hm.6.slope.acd.hm,hm.7.slope.acd.hm,hm.8.slope.acd.hm,hm.9.slope.acd.hm,hm.10.slope.acd.hm))


```
```{r Avoids Clumped Deterministic Data Frame}
#knowledge mutual
km.tt.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$triangle.transitivity)
km.acdi.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$dci)
km.esc.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$escalation)
km.steep.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$steepness)
km.slope.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$slope)
km.mean.acd.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acd.avoid,dci=km.acdi.acd.avoid,esc=km.esc.acd.avoid,steepness=km.steep.acd.avoid,slope=km.slope.acd.avoid,dist="clumped",calc="deterministic")


#history mutual
hm.tt.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$triangle.transitivity)
hm.acdi.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$dci)
hm.esc.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$escalation)
hm.steep.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$steepness)
hm.slope.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$slope)
hm.mean.acd.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acd.avoid,dci=hm.acdi.acd.avoid,esc=hm.esc.acd.avoid,steepness=hm.steep.acd.avoid,slope=hm.slope.acd.avoid,dist="clumped",calc="deterministic")


#total average dataframe
#dc.ave<-rbind(km.mean.acd.avoid,ks.mean.acd.avoid,ko.mean.acd.avoid,hm.mean.acd.avoid,hs.mean.acd.avoid,ho.mean.acd.avoid)

dc.ave<-rbind(km.mean.acd.avoid,hm.mean.acd.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$triangle.transitivity)
km.acdi.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$dci)
km.esc.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$escalation)
km.steep.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$steepness)
km.slope.acd.avoid<-mean(km.acd.ss.avoid.cd.sf.km$slope)
km.mean.acd.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acd.avoid,dci=km.acdi.acd.avoid,esc=km.esc.acd.avoid,steepness=km.steep.acd.avoid,slope=km.slope.acd.avoid,dist="clumped",calc="deterministic")


#history mutual
hm.tt.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$triangle.transitivity)
hm.acdi.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$dci)
hm.esc.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$escalation)
hm.steep.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$steepness)
hm.slope.acd.avoid<-mean(hm.acd.ss.avoid.cd.sf.hm$slope)
hm.mean.acd.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acd.avoid,dci=hm.acdi.acd.avoid,esc=hm.esc.acd.avoid,steepness=hm.steep.acd.avoid,slope=hm.slope.acd.avoid,dist="clumped",calc="deterministic")


#total average dataframe
#dc.ave<-rbind(km.mean.acd.avoid,ks.mean.acd.avoid,ko.mean.acd.avoid,hm.mean.acd.avoid,hs.mean.acd.avoid,ho.mean.acd.avoid)

dc.ave<-rbind(km.mean.acd.avoid,hm.mean.acd.avoid)

#create overall dataframe of summary statistics
overall.deter.sf.clump.sf.avoid<-data.frame(km.acd.ss.avoid.cd.sf.km)
overall.deter.sf.clump.sf.avoid<-rbind(overall.deter.sf.clump.sf.avoid,hm.acd.ss.avoid.cd.sf.hm)

overall.deter.sf.clump.sf.avoid<-cbind(overall.deter.sf.clump.sf.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.deter.sf.clump.sf.avoid<-cbind(overall.deter.sf.clump.sf.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("deter",20))


rhp.ss.avoid<-overall.deter.sf.clump.sf.avoid[overall.deter.sf.clump.sf.avoid$variable=="rhp",]
history.ss.avoid<-overall.deter.sf.clump.sf.avoid[overall.deter.sf.clump.sf.avoid$variable=="history",]

overall.deter.sf.clump.sf.avoid$combo<-paste(overall.deter.sf.clump.sf.avoid$strategy,overall.deter.sf.clump.sf.avoid$variable,overall.deter.sf.clump.sf.avoid$distribution)
overall.deter.sf.clump.sf.avoid$combo2<-paste(overall.deter.sf.clump.sf.avoid$strategy,overall.deter.sf.clump.sf.avoid$variable)
```

## Attacks Clumped Deterministic Data
```{r Attacks Clumped Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks.atcd.km<-sapply(files, read.csv)

# Generate attacks.atcd.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcd.km<-data.frame(X1=attacks.atcd.km[[1]],X2=attacks.atcd.km[[2]],Victories=attacks.atcd.km[[3]])
mat1.atcd.km<-inter.mat(mut1.atcd.km)
tri1.atcd.km<-tr.tri(mat1.atcd.km)
dci1.atcd.km<-DCindex(mat1.atcd.km)
mat1.atcd.km[is.na(mat1.atcd.km)] = 0
h1.atcd.km<-h.index(mat1.atcd.km)

ep1.atcd.km<-ep(mut1.atcd.km,a1.cd.sf.km)
david1.atcd.km<-DS(mat1.atcd.km) #David's Scores - for steepness use normDS output
ordrank.1.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcd.km<-cbind(ordrank.1.atcd.km,ds=david1.atcd.km$normDS)
lm1.atcd.km<-summary(lm(ordrank.1.atcd.km$ds~ordrank.1.atcd.km$ord.rank))
s1.atcd.km<-lm1.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcd.km<-data.frame(X1=attacks.atcd.km[[4]],X2=attacks.atcd.km[[5]],Victories=attacks.atcd.km[[6]])
mat2.atcd.km<-inter.mat(mut2.atcd.km)
tri2.atcd.km<-tr.tri(mat2.atcd.km)
dci2.atcd.km<-DCindex(mat2.atcd.km)
mat2.atcd.km[is.na(mat2.atcd.km)] = 0
h2.atcd.km<-h.index(mat2.atcd.km)

ep2.atcd.km<-ep(mut2.atcd.km,a2.cd.sf.km)
david2.atcd.km<-DS(mat2.atcd.km) #David's Scores - for steepness use normDS output
ordrank.2.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcd.km<-cbind(ordrank.2.atcd.km,ds=david2.atcd.km$normDS)
lm2.atcd.km<-summary(lm(ordrank.2.atcd.km$ds~ordrank.2.atcd.km$ord.rank))
s2.atcd.km<-lm2.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcd.km<-data.frame(X1=attacks.atcd.km[[7]],X2=attacks.atcd.km[[8]],Victories=attacks.atcd.km[[9]])
mat3.atcd.km<-inter.mat(mut3.atcd.km)
tri3.atcd.km<-tr.tri(mat3.atcd.km)
dci3.atcd.km<-DCindex(mat3.atcd.km)
mat3.atcd.km[is.na(mat3.atcd.km)] = 0
h3.atcd.km<-h.index(mat3.atcd.km)

ep3.atcd.km<-ep(mut3.atcd.km,a3.cd.sf.km)
david3.atcd.km<-DS(mat3.atcd.km) #David's Scores - for steepness use normDS output
ordrank.3.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcd.km<-cbind(ordrank.3.atcd.km,ds=david3.atcd.km$normDS)
lm3.atcd.km<-summary(lm(ordrank.3.atcd.km$ds~ordrank.3.atcd.km$ord.rank))
s3.atcd.km<-lm3.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcd.km<-data.frame(X1=attacks.atcd.km[[10]],X2=attacks.atcd.km[[11]],Victories=attacks.atcd.km[[12]])
mat4.atcd.km<-inter.mat(mut4.atcd.km)
tri4.atcd.km<-tr.tri(mat4.atcd.km)
dci4.atcd.km<-DCindex(mat4.atcd.km)
mat4.atcd.km[is.na(mat4.atcd.km)] = 0
h4.atcd.km<-h.index(mat4.atcd.km)

ep4.atcd.km<-ep(mut4.atcd.km,a4.cd.sf.km)
david4.atcd.km<-DS(mat4.atcd.km) #David's Scores - for steepness use normDS output
ordrank.4.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcd.km<-cbind(ordrank.4.atcd.km,ds=david4.atcd.km$normDS)
lm4.atcd.km<-summary(lm(ordrank.4.atcd.km$ds~ordrank.4.atcd.km$ord.rank))
s4.atcd.km<-lm4.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcd.km<-data.frame(X1=attacks.atcd.km[[13]],X2=attacks.atcd.km[[14]],Victories=attacks.atcd.km[[15]])
mat5.atcd.km<-inter.mat(mut5.atcd.km)
tri5.atcd.km<-tr.tri(mat5.atcd.km)
dci5.atcd.km<-DCindex(mat5.atcd.km)
mat5.atcd.km[is.na(mat5.atcd.km)] = 0
h5.atcd.km<-h.index(mat5.atcd.km)

ep5.atcd.km<-ep(mut5.atcd.km,a5.cd.sf.km)
david5.atcd.km<-DS(mat5.atcd.km) #David's Scores - for steepness use normDS output
ordrank.5.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcd.km<-cbind(ordrank.5.atcd.km,ds=david5.atcd.km$normDS)
lm5.atcd.km<-summary(lm(ordrank.5.atcd.km$ds~ordrank.5.atcd.km$ord.rank))
s5.atcd.km<-lm5.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcd.km<-data.frame(X1=attacks.atcd.km[[16]],X2=attacks.atcd.km[[17]],Victories=attacks.atcd.km[[18]])
mat6.atcd.km<-inter.mat(mut6.atcd.km)
tri6.atcd.km<-tr.tri(mat6.atcd.km)
dci6.atcd.km<-DCindex(mat6.atcd.km)
mat6.atcd.km[is.na(mat6.atcd.km)] = 0
h6.atcd.km<-h.index(mat6.atcd.km)

ep6.atcd.km<-ep(mut6.atcd.km,a6.cd.sf.km)
david6.atcd.km<-DS(mat6.atcd.km) #David's Scores - for steepness use normDS output
ordrank.6.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcd.km<-cbind(ordrank.6.atcd.km,ds=david6.atcd.km$normDS)
lm6.atcd.km<-summary(lm(ordrank.6.atcd.km$ds~ordrank.6.atcd.km$ord.rank))
s6.atcd.km<-lm6.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcd.km<-data.frame(X1=attacks.atcd.km[[19]],X2=attacks.atcd.km[[20]],Victories=attacks.atcd.km[[21]])
mat7.atcd.km<-inter.mat(mut7.atcd.km)
tri7.atcd.km<-tr.tri(mat7.atcd.km)
dci7.atcd.km<-DCindex(mat7.atcd.km)
mat7.atcd.km[is.na(mat7.atcd.km)] = 0
h7.atcd.km<-h.index(mat7.atcd.km)

ep7.atcd.km<-ep(mut7.atcd.km,a7.cd.sf.km)
david7.atcd.km<-DS(mat7.atcd.km) #David's Scores - for steepness use normDS output
ordrank.7.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcd.km<-cbind(ordrank.7.atcd.km,ds=david7.atcd.km$normDS)
lm7.atcd.km<-summary(lm(ordrank.7.atcd.km$ds~ordrank.7.atcd.km$ord.rank))
s7.atcd.km<-lm7.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcd.km<-data.frame(X1=attacks.atcd.km[[22]],X2=attacks.atcd.km[[23]],Victories=attacks.atcd.km[[24]])
mat8.atcd.km<-inter.mat(mut8.atcd.km)
tri8.atcd.km<-tr.tri(mat8.atcd.km)
dci8.atcd.km<-DCindex(mat8.atcd.km)
mat8.atcd.km[is.na(mat8.atcd.km)] = 0
h8.atcd.km<-h.index(mat8.atcd.km)

ep8.atcd.km<-ep(mut8.atcd.km,a8.cd.sf.km)
david8.atcd.km<-DS(mat8.atcd.km) #David's Scores - for steepness use normDS output
ordrank.8.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcd.km<-cbind(ordrank.8.atcd.km,ds=david8.atcd.km$normDS)
lm8.atcd.km<-summary(lm(ordrank.8.atcd.km$ds~ordrank.8.atcd.km$ord.rank))
s8.atcd.km<-lm8.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcd.km<-data.frame(X1=attacks.atcd.km[[25]],X2=attacks.atcd.km[[26]],Victories=attacks.atcd.km[[27]])
mat9.atcd.km<-inter.mat(mut9.atcd.km)
tri9.atcd.km<-tr.tri(mat9.atcd.km)
dci9.atcd.km<-DCindex(mat9.atcd.km)
mat9.atcd.km[is.na(mat9.atcd.km)] = 0
h9.atcd.km<-h.index(mat9.atcd.km)

ep9.atcd.km<-ep(mut9.atcd.km,a9.cd.sf.km)
david9.atcd.km<-DS(mat9.atcd.km) #David's Scores - for steepness use normDS output
ordrank.9.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcd.km<-cbind(ordrank.9.atcd.km,ds=david9.atcd.km$normDS)
lm9.atcd.km<-summary(lm(ordrank.9.atcd.km$ds~ordrank.9.atcd.km$ord.rank))
s9.atcd.km<-lm9.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcd.km<-data.frame(X1=attacks.atcd.km[[28]],X2=attacks.atcd.km[[29]],Victories=attacks.atcd.km[[30]])
mat10.atcd.km<-inter.mat(mut10.atcd.km)
tri10.atcd.km<-tr.tri(mat10.atcd.km)
dci10.atcd.km<-DCindex(mat10.atcd.km)
mat10.atcd.km[is.na(mat10.atcd.km)] = 0
h10.atcd.km<-h.index(mat10.atcd.km)

ep10.atcd.km<-ep(mut10.atcd.km,a10.cd.sf.km)
david10.atcd.km<-DS(mat10.atcd.km) #David's Scores - for steepness use normDS output
ordrank.10.atcd.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcd.km<-cbind(ordrank.10.atcd.km,ds=david10.atcd.km$normDS)
lm10.atcd.km<-summary(lm(ordrank.10.atcd.km$ds~ordrank.10.atcd.km$ord.rank))
s10.atcd.km<-lm10.atcd.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcd.km<-sum(mut1.atcd.km$Victories)
int2.atcd.km<-sum(mut2.atcd.km$Victories)
int3.atcd.km<-sum(mut3.atcd.km$Victories)
int4.atcd.km<-sum(mut4.atcd.km$Victories)
int5.atcd.km<-sum(mut5.atcd.km$Victories)
int6.atcd.km<-sum(mut6.atcd.km$Victories)
int7.atcd.km<-sum(mut7.atcd.km$Victories)
int8.atcd.km<-sum(mut8.atcd.km$Victories)
int9.atcd.km<-sum(mut9.atcd.km$Victories)
int10.atcd.km<-sum(mut10.atcd.km$Victories)

  # Summarize the avoidances in each trial:
av1.cd.sf.km<-sum(a1.cd.sf.km$Avoids)
av2.cd.sf.km<-sum(a2.cd.sf.km$Avoids)
av3.cd.sf.km<-sum(a3.cd.sf.km$Avoids)
av4.cd.sf.km<-sum(a4.cd.sf.km$Avoids)
av5.cd.sf.km<-sum(a5.cd.sf.km$Avoids)
av6.cd.sf.km<-sum(a6.cd.sf.km$Avoids)
av7.cd.sf.km<-sum(a7.cd.sf.km$Avoids)
av8.cd.sf.km<-sum(a8.cd.sf.km$Avoids)
av9.cd.sf.km<-sum(a9.cd.sf.km$Avoids)
av10.cd.sf.km<-sum(a10.cd.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.dc.sf<-(sum(av1.cd.sf.km, av2.cd.sf.km, av3.cd.sf.km, av4.cd.sf.km, av5.cd.sf.km, av6.cd.sf.km, av7.cd.sf.km, av8.cd.sf.km, av9.cd.sf.km, av10.cd.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.dc.sf<-(sum(int1.atcd.km, int2.atcd.km, int3.atcd.km, int4.atcd.km, int5.atcd.km, int6.atcd.km, int7.atcd.km, int8.atcd.km, int9.atcd.km, int10.atcd.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcd.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcd.km<-e1.atcd.km[order(e1.atcd.km$ID),]
e1.atcd.km<-as.matrix(t(e1.1.atcd.km))

e2.atcd.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcd.km<-e2.atcd.km[order(e2.atcd.km$ID),]
e2.atcd.km<-as.matrix(t(e2.1.atcd.km))

e3.atcd.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcd.km<-e3.atcd.km[order(e3.atcd.km$ID),]
e3.atcd.km<-as.matrix(t(e3.1.atcd.km))

e4.atcd.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcd.km<-e4.atcd.km[order(e4.atcd.km$ID),]
e4.atcd.km<-as.matrix(t(e4.1.atcd.km))

e5.atcd.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcd.km<-e5.atcd.km[order(e5.atcd.km$ID),]
e5.atcd.km<-as.matrix(t(e5.1.atcd.km))

e6.atcd.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcd.km<-e6.atcd.km[order(e6.atcd.km$ID),]
e6.atcd.km<-as.matrix(t(e6.1.atcd.km))

e7.atcd.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcd.km<-e7.atcd.km[order(e7.atcd.km$ID),]
e7.atcd.km<-as.matrix(t(e7.1.atcd.km))

e8.atcd.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcd.km<-e8.atcd.km[order(e8.atcd.km$ID),]
e8.atcd.km<-as.matrix(t(e8.1.atcd.km))

e9.atcd.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcd.km<-e9.atcd.km[order(e9.atcd.km$ID),]
e9.atcd.km<-as.matrix(t(e9.1.atcd.km))

e10.atcd.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcd.km<-e10.atcd.km[order(e10.atcd.km$ID),]
e10.atcd.km<-as.matrix(t(e10.1.atcd.km))

energy.km.atcd.km<-as.data.frame(matrix(c(e1.atcd.km,e2.atcd.km,e3.atcd.km,e4.atcd.km,e5.atcd.km,e6.atcd.km,e7.atcd.km,e8.atcd.km,e9.atcd.km,e10.atcd.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atcd.km<-data.frame(ID=energy.km.atcd.km$V1,energy_over_distance=energy.km.atcd.km$V2,energy_over_time=energy.km.atcd.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcd.km<-david1.atcd.km[order(david1.atcd.km$ID),]
david1.atcd.km<-as.matrix(t(david1.1.atcd.km))

david2.1.atcd.km<-david2.atcd.km[order(david2.atcd.km$ID),]
david2.atcd.km<-as.matrix(t(david2.1.atcd.km))

david3.1.atcd.km<-david3.atcd.km[order(david3.atcd.km$ID),]
david3.atcd.km<-as.matrix(t(david3.1.atcd.km))

david4.1.atcd.km<-david4.atcd.km[order(david4.atcd.km$ID),]
david4.atcd.km<-as.matrix(t(david4.1.atcd.km))

david5.1.atcd.km<-david5.atcd.km[order(david5.atcd.km$ID),]
david5.atcd.km<-as.matrix(t(david5.1.atcd.km))

david6.1.atcd.km<-david6.atcd.km[order(david6.atcd.km$ID),]
david6.atcd.km<-as.matrix(t(david6.1.atcd.km))

david7.1.atcd.km<-david7.atcd.km[order(david7.atcd.km$ID),]
david7.atcd.km<-as.matrix(t(david7.1.atcd.km))

david8.1.atcd.km<-david8.atcd.km[order(david8.atcd.km$ID),]
david8.atcd.km<-as.matrix(t(david8.1.atcd.km))

david9.1.atcd.km<-david9.atcd.km[order(david9.atcd.km$ID),]
david9.atcd.km<-as.matrix(t(david9.1.atcd.km))

david10.1.atcd.km<-david10.atcd.km[order(david10.atcd.km$ID),]
david10.atcd.km<-as.matrix(t(david10.1.atcd.km))

david.km.atcd.km<-as.data.frame(matrix(c(david1.atcd.km,david2.atcd.km,david3.atcd.km,david4.atcd.km,david5.atcd.km,david6.atcd.km,david7.atcd.km,david8.atcd.km,david9.atcd.km,david10.atcd.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atcd.km<-data.frame(ID=david.km.atcd.km$V1,DS=david.km.atcd.km$V2,normDS=david.km.atcd.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atcd.km<-lm(e1.1.atcd.km$energy_over_time~as.numeric(david1.1.atcd.km$normDS))
km.lm.1.s.atcd.km<-summary(lm.km.1.atcd.km)$coefficients
km.1.slope.atcd.km<-km.lm.1.s.atcd.km[2,1]
lm.km.2.atcd.km<-lm(e2.1.atcd.km$energy_over_time~as.numeric(david2.1.atcd.km$normDS))
km.lm.2.s.atcd.km<-summary(lm.km.2.atcd.km)$coefficients
km.2.slope.atcd.km<-km.lm.2.s.atcd.km[2,1]
lm.km.3.atcd.km<-lm(e3.1.atcd.km$energy_over_time~as.numeric(david3.1.atcd.km$normDS))
km.lm.3.s.atcd.km<-summary(lm.km.3.atcd.km)$coefficients
km.3.slope.atcd.km<-km.lm.3.s.atcd.km[2,1]
lm.km.4.atcd.km<-lm(e4.1.atcd.km$energy_over_time~as.numeric(david4.1.atcd.km$normDS))
km.lm.4.s.atcd.km<-summary(lm.km.4.atcd.km)$coefficients
km.4.slope.atcd.km<-km.lm.4.s.atcd.km[2,1]
lm.km.5.atcd.km<-lm(e5.1.atcd.km$energy_over_time~as.numeric(david5.1.atcd.km$normDS))
km.lm.5.s.atcd.km<-summary(lm.km.5.atcd.km)$coefficients
km.5.slope.atcd.km<-km.lm.5.s.atcd.km[2,1]
lm.km.6.atcd.km<-lm(e6.1.atcd.km$energy_over_time~as.numeric(david6.1.atcd.km$normDS))
km.lm.6.s.atcd.km<-summary(lm.km.6.atcd.km)$coefficients
km.6.slope.atcd.km<-km.lm.6.s.atcd.km[2,1]
lm.km.7.atcd.km<-lm(e7.1.atcd.km$energy_over_time~as.numeric(david7.1.atcd.km$normDS))
km.lm.7.s.atcd.km<-summary(lm.km.7.atcd.km)$coefficients
km.7.slope.atcd.km<-km.lm.7.s.atcd.km[2,1]
lm.km.8.atcd.km<-lm(e8.1.atcd.km$energy_over_time~as.numeric(david8.1.atcd.km$normDS))
km.lm.8.s.atcd.km<-summary(lm.km.8.atcd.km)$coefficients
km.8.slope.atcd.km<-km.lm.8.s.atcd.km[2,1]
lm.km.9.atcd.km<-lm(e9.1.atcd.km$energy_over_time~as.numeric(david9.1.atcd.km$normDS))
km.lm.9.s.atcd.km<-summary(lm.km.9.atcd.km)$coefficients
km.9.slope.atcd.km<-km.lm.9.s.atcd.km[2,1]
lm.km.10.atcd.km<-lm(e10.1.atcd.km$energy_over_time~as.numeric(david10.1.atcd.km$normDS))
km.lm.10.s.atcd.km<-summary(lm.km.10.atcd.km)$coefficients
km.10.slope.atcd.km<-km.lm.10.s.atcd.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atcd.ss.attacks.atcd.km<-data.frame(triangle.transitivity=c(tri1.atcd.km,tri2.atcd.km,tri3.atcd.km,tri4.atcd.km,tri5.atcd.km,tri6.atcd.km,tri7.atcd.km,tri8.atcd.km,tri9.atcd.km,tri10.atcd.km),escalation=c(ep1.atcd.km,ep2.atcd.km,ep3.atcd.km,ep4.atcd.km,ep5.atcd.km,ep6.atcd.km,ep7.atcd.km,ep8.atcd.km,ep9.atcd.km,ep10.atcd.km),dci=c(dci1.atcd.km,dci2.atcd.km,dci3.atcd.km,dci4.atcd.km,dci5.atcd.km,dci6.atcd.km,dci7.atcd.km,dci8.atcd.km,dci9.atcd.km,dci10.atcd.km),steepness=c(s1.atcd.km,s2.atcd.km,s3.atcd.km,s4.atcd.km,s5.atcd.km,s6.atcd.km,s7.atcd.km,s8.atcd.km,s9.atcd.km,s10.atcd.km),slope=c(km.1.slope.atcd.km,km.2.slope.atcd.km,km.3.slope.atcd.km,km.4.slope.atcd.km,km.5.slope.atcd.km,km.6.slope.atcd.km,km.7.slope.atcd.km,km.8.slope.atcd.km,km.9.slope.atcd.km,km.10.slope.atcd.km))



#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/attacks")

files<-list.files(pattern="*.csv")
attacks.atcd.hm<-sapply(files, read.csv)

# Generate attacks.atcd.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcd.hm<-data.frame(X1=attacks.atcd.hm[[1]],X2=attacks.atcd.hm[[2]],Victories=attacks.atcd.hm[[3]])
mat1.atcd.hm<-inter.mat(mut1.atcd.hm)
tri1.atcd.hm<-tr.tri(mat1.atcd.hm)
dci1.atcd.hm<-DCindex(mat1.atcd.hm)
mat1.atcd.hm[is.na(mat1.atcd.hm)] = 0
h1.atcd.hm<-h.index(mat1.atcd.hm)

ep1.atcd.hm<-ep(mut1.atcd.hm,a1.cd.sf.hm)
david1.atcd.hm<-DS(mat1.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.1.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcd.hm<-cbind(ordrank.1.atcd.hm,ds=david1.atcd.hm$normDS)
lm1.atcd.hm<-summary(lm(ordrank.1.atcd.hm$ds~ordrank.1.atcd.hm$ord.rank))
s1.atcd.hm<-lm1.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcd.hm<-data.frame(X1=attacks.atcd.hm[[4]],X2=attacks.atcd.hm[[5]],Victories=attacks.atcd.hm[[6]])
mat2.atcd.hm<-inter.mat(mut2.atcd.hm)
tri2.atcd.hm<-tr.tri(mat2.atcd.hm)
dci2.atcd.hm<-DCindex(mat2.atcd.hm)
mat2.atcd.hm[is.na(mat2.atcd.hm)] = 0
h2.atcd.hm<-h.index(mat2.atcd.hm)

ep2.atcd.hm<-ep(mut2.atcd.hm,a2.cd.sf.hm)
david2.atcd.hm<-DS(mat2.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.2.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcd.hm<-cbind(ordrank.2.atcd.hm,ds=david2.atcd.hm$normDS)
lm2.atcd.hm<-summary(lm(ordrank.2.atcd.hm$ds~ordrank.2.atcd.hm$ord.rank))
s2.atcd.hm<-lm2.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcd.hm<-data.frame(X1=attacks.atcd.hm[[7]],X2=attacks.atcd.hm[[8]],Victories=attacks.atcd.hm[[9]])
mat3.atcd.hm<-inter.mat(mut3.atcd.hm)
tri3.atcd.hm<-tr.tri(mat3.atcd.hm)
dci3.atcd.hm<-DCindex(mat3.atcd.hm)
mat3.atcd.hm[is.na(mat3.atcd.hm)] = 0
h3.atcd.hm<-h.index(mat3.atcd.hm)

ep3.atcd.hm<-ep(mut3.atcd.hm,a3.cd.sf.hm)
david3.atcd.hm<-DS(mat3.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.3.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcd.hm<-cbind(ordrank.3.atcd.hm,ds=david3.atcd.hm$normDS)
lm3.atcd.hm<-summary(lm(ordrank.3.atcd.hm$ds~ordrank.3.atcd.hm$ord.rank))
s3.atcd.hm<-lm3.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcd.hm<-data.frame(X1=attacks.atcd.hm[[10]],X2=attacks.atcd.hm[[11]],Victories=attacks.atcd.hm[[12]])
mat4.atcd.hm<-inter.mat(mut4.atcd.hm)
tri4.atcd.hm<-tr.tri(mat4.atcd.hm)
dci4.atcd.hm<-DCindex(mat4.atcd.hm)
mat4.atcd.hm[is.na(mat4.atcd.hm)] = 0
h4.atcd.hm<-h.index(mat4.atcd.hm)

ep4.atcd.hm<-ep(mut4.atcd.hm,a4.cd.sf.hm)
david4.atcd.hm<-DS(mat4.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.4.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcd.hm<-cbind(ordrank.4.atcd.hm,ds=david4.atcd.hm$normDS)
lm4.atcd.hm<-summary(lm(ordrank.4.atcd.hm$ds~ordrank.4.atcd.hm$ord.rank))
s4.atcd.hm<-lm4.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcd.hm<-data.frame(X1=attacks.atcd.hm[[13]],X2=attacks.atcd.hm[[14]],Victories=attacks.atcd.hm[[15]])
mat5.atcd.hm<-inter.mat(mut5.atcd.hm)
tri5.atcd.hm<-tr.tri(mat5.atcd.hm)
dci5.atcd.hm<-DCindex(mat5.atcd.hm)
mat5.atcd.hm[is.na(mat5.atcd.hm)] = 0
h5.atcd.hm<-h.index(mat5.atcd.hm)

ep5.atcd.hm<-ep(mut5.atcd.hm,a5.cd.sf.hm)
david5.atcd.hm<-DS(mat5.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.5.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcd.hm<-cbind(ordrank.5.atcd.hm,ds=david5.atcd.hm$normDS)
lm5.atcd.hm<-summary(lm(ordrank.5.atcd.hm$ds~ordrank.5.atcd.hm$ord.rank))
s5.atcd.hm<-lm5.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcd.hm<-data.frame(X1=attacks.atcd.hm[[16]],X2=attacks.atcd.hm[[17]],Victories=attacks.atcd.hm[[18]])
mat6.atcd.hm<-inter.mat(mut6.atcd.hm)
tri6.atcd.hm<-tr.tri(mat6.atcd.hm)
dci6.atcd.hm<-DCindex(mat6.atcd.hm)
mat6.atcd.hm[is.na(mat6.atcd.hm)] = 0
h6.atcd.hm<-h.index(mat6.atcd.hm)

ep6.atcd.hm<-ep(mut6.atcd.hm,a6.cd.sf.hm)
david6.atcd.hm<-DS(mat6.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.6.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcd.hm<-cbind(ordrank.6.atcd.hm,ds=david6.atcd.hm$normDS)
lm6.atcd.hm<-summary(lm(ordrank.6.atcd.hm$ds~ordrank.6.atcd.hm$ord.rank))
s6.atcd.hm<-lm6.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcd.hm<-data.frame(X1=attacks.atcd.hm[[19]],X2=attacks.atcd.hm[[20]],Victories=attacks.atcd.hm[[21]])
mat7.atcd.hm<-inter.mat(mut7.atcd.hm)
tri7.atcd.hm<-tr.tri(mat7.atcd.hm)
dci7.atcd.hm<-DCindex(mat7.atcd.hm)
mat7.atcd.hm[is.na(mat7.atcd.hm)] = 0
h7.atcd.hm<-h.index(mat7.atcd.hm)

ep7.atcd.hm<-ep(mut7.atcd.hm,a7.cd.sf.hm)
david7.atcd.hm<-DS(mat7.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.7.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcd.hm<-cbind(ordrank.7.atcd.hm,ds=david7.atcd.hm$normDS)
lm7.atcd.hm<-summary(lm(ordrank.7.atcd.hm$ds~ordrank.7.atcd.hm$ord.rank))
s7.atcd.hm<-lm7.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcd.hm<-data.frame(X1=attacks.atcd.hm[[22]],X2=attacks.atcd.hm[[23]],Victories=attacks.atcd.hm[[24]])
mat8.atcd.hm<-inter.mat(mut8.atcd.hm)
tri8.atcd.hm<-tr.tri(mat8.atcd.hm)
dci8.atcd.hm<-DCindex(mat8.atcd.hm)
mat8.atcd.hm[is.na(mat8.atcd.hm)] = 0
h8.atcd.hm<-h.index(mat8.atcd.hm)

ep8.atcd.hm<-ep(mut8.atcd.hm,a8.cd.sf.hm)
david8.atcd.hm<-DS(mat8.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.8.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcd.hm<-cbind(ordrank.8.atcd.hm,ds=david8.atcd.hm$normDS)
lm8.atcd.hm<-summary(lm(ordrank.8.atcd.hm$ds~ordrank.8.atcd.hm$ord.rank))
s8.atcd.hm<-lm8.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcd.hm<-data.frame(X1=attacks.atcd.hm[[25]],X2=attacks.atcd.hm[[26]],Victories=attacks.atcd.hm[[27]])
mat9.atcd.hm<-inter.mat(mut9.atcd.hm)
tri9.atcd.hm<-tr.tri(mat9.atcd.hm)
dci9.atcd.hm<-DCindex(mat9.atcd.hm)
mat9.atcd.hm[is.na(mat9.atcd.hm)] = 0
h9.atcd.hm<-h.index(mat9.atcd.hm)

ep9.atcd.hm<-ep(mut9.atcd.hm,a9.cd.sf.hm)
david9.atcd.hm<-DS(mat9.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.9.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcd.hm<-cbind(ordrank.9.atcd.hm,ds=david9.atcd.hm$normDS)
lm9.atcd.hm<-summary(lm(ordrank.9.atcd.hm$ds~ordrank.9.atcd.hm$ord.rank))
s9.atcd.hm<-lm9.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcd.hm<-data.frame(X1=attacks.atcd.hm[[28]],X2=attacks.atcd.hm[[29]],Victories=attacks.atcd.hm[[30]])
mat10.atcd.hm<-inter.mat(mut10.atcd.hm)
tri10.atcd.hm<-tr.tri(mat10.atcd.hm)
dci10.atcd.hm<-DCindex(mat10.atcd.hm)
mat10.atcd.hm[is.na(mat10.atcd.hm)] = 0
h10.atcd.hm<-h.index(mat10.atcd.hm)

ep10.atcd.hm<-ep(mut10.atcd.hm,a10.cd.sf.hm)
david10.atcd.hm<-DS(mat10.atcd.hm) #David's Scores - for steepness use normDS output
ordrank.10.atcd.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcd.hm<-cbind(ordrank.10.atcd.hm,ds=david10.atcd.hm$normDS)
lm10.atcd.hm<-summary(lm(ordrank.10.atcd.hm$ds~ordrank.10.atcd.hm$ord.rank))
s10.atcd.hm<-lm10.atcd.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcd.hm<-sum(mut1.atcd.hm$Victories)
int2.atcd.hm<-sum(mut2.atcd.hm$Victories)
int3.atcd.hm<-sum(mut3.atcd.hm$Victories)
int4.atcd.hm<-sum(mut4.atcd.hm$Victories)
int5.atcd.hm<-sum(mut5.atcd.hm$Victories)
int6.atcd.hm<-sum(mut6.atcd.hm$Victories)
int7.atcd.hm<-sum(mut7.atcd.hm$Victories)
int8.atcd.hm<-sum(mut8.atcd.hm$Victories)
int9.atcd.hm<-sum(mut9.atcd.hm$Victories)
int10.atcd.hm<-sum(mut10.atcd.hm$Victories)

  # Summarize the avoidances in each trial:
av1.cd.sf.hm<-sum(a1.cd.sf.hm$Avoids)
av2.cd.sf.hm<-sum(a2.cd.sf.hm$Avoids)
av3.cd.sf.hm<-sum(a3.cd.sf.hm$Avoids)
av4.cd.sf.hm<-sum(a4.cd.sf.hm$Avoids)
av5.cd.sf.hm<-sum(a5.cd.sf.hm$Avoids)
av6.cd.sf.hm<-sum(a6.cd.sf.hm$Avoids)
av7.cd.sf.hm<-sum(a7.cd.sf.hm$Avoids)
av8.cd.sf.hm<-sum(a8.cd.sf.hm$Avoids)
av9.cd.sf.hm<-sum(a9.cd.sf.hm$Avoids)
av10.cd.sf.hm<-sum(a10.cd.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.dc.sf<-(sum(av1.cd.sf.hm, av2.cd.sf.hm, av3.cd.sf.hm, av4.cd.sf.hm, av5.cd.sf.hm, av6.cd.sf.hm, av7.cd.sf.hm, av8.cd.sf.hm, av9.cd.sf.hm, av10.cd.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.dc.sf<-(sum(int1.atcd.hm, int2.atcd.hm, int3.atcd.hm, int4.atcd.hm, int5.atcd.hm, int6.atcd.hm, int7.atcd.hm, int8.atcd.hm, int9.atcd.hm, int10.atcd.hm))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcd.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcd.hm<-e1.atcd.hm[order(e1.atcd.hm$ID),]
e1.atcd.hm<-as.matrix(t(e1.1.atcd.hm))

e2.atcd.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcd.hm<-e2.atcd.hm[order(e2.atcd.hm$ID),]
e2.atcd.hm<-as.matrix(t(e2.1.atcd.hm))

e3.atcd.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcd.hm<-e3.atcd.hm[order(e3.atcd.hm$ID),]
e3.atcd.hm<-as.matrix(t(e3.1.atcd.hm))

e4.atcd.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcd.hm<-e4.atcd.hm[order(e4.atcd.hm$ID),]
e4.atcd.hm<-as.matrix(t(e4.1.atcd.hm))

e5.atcd.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcd.hm<-e5.atcd.hm[order(e5.atcd.hm$ID),]
e5.atcd.hm<-as.matrix(t(e5.1.atcd.hm))

e6.atcd.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcd.hm<-e6.atcd.hm[order(e6.atcd.hm$ID),]
e6.atcd.hm<-as.matrix(t(e6.1.atcd.hm))

e7.atcd.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcd.hm<-e7.atcd.hm[order(e7.atcd.hm$ID),]
e7.atcd.hm<-as.matrix(t(e7.1.atcd.hm))

e8.atcd.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcd.hm<-e8.atcd.hm[order(e8.atcd.hm$ID),]
e8.atcd.hm<-as.matrix(t(e8.1.atcd.hm))

e9.atcd.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcd.hm<-e9.atcd.hm[order(e9.atcd.hm$ID),]
e9.atcd.hm<-as.matrix(t(e9.1.atcd.hm))

e10.atcd.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcd.hm<-e10.atcd.hm[order(e10.atcd.hm$ID),]
e10.atcd.hm<-as.matrix(t(e10.1.atcd.hm))

energy.hm.atcd.hm<-as.data.frame(matrix(c(e1.atcd.hm,e2.atcd.hm,e3.atcd.hm,e4.atcd.hm,e5.atcd.hm,e6.atcd.hm,e7.atcd.hm,e8.atcd.hm,e9.atcd.hm,e10.atcd.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atcd.hm<-data.frame(ID=energy.hm.atcd.hm$V1,energy_over_distance=energy.hm.atcd.hm$V2,energy_over_time=energy.hm.atcd.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcd.hm<-david1.atcd.hm[order(david1.atcd.hm$ID),]
david1.atcd.hm<-as.matrix(t(david1.1.atcd.hm))

david2.1.atcd.hm<-david2.atcd.hm[order(david2.atcd.hm$ID),]
david2.atcd.hm<-as.matrix(t(david2.1.atcd.hm))

david3.1.atcd.hm<-david3.atcd.hm[order(david3.atcd.hm$ID),]
david3.atcd.hm<-as.matrix(t(david3.1.atcd.hm))

david4.1.atcd.hm<-david4.atcd.hm[order(david4.atcd.hm$ID),]
david4.atcd.hm<-as.matrix(t(david4.1.atcd.hm))

david5.1.atcd.hm<-david5.atcd.hm[order(david5.atcd.hm$ID),]
david5.atcd.hm<-as.matrix(t(david5.1.atcd.hm))

david6.1.atcd.hm<-david6.atcd.hm[order(david6.atcd.hm$ID),]
david6.atcd.hm<-as.matrix(t(david6.1.atcd.hm))

david7.1.atcd.hm<-david7.atcd.hm[order(david7.atcd.hm$ID),]
david7.atcd.hm<-as.matrix(t(david7.1.atcd.hm))

david8.1.atcd.hm<-david8.atcd.hm[order(david8.atcd.hm$ID),]
david8.atcd.hm<-as.matrix(t(david8.1.atcd.hm))

david9.1.atcd.hm<-david9.atcd.hm[order(david9.atcd.hm$ID),]
david9.atcd.hm<-as.matrix(t(david9.1.atcd.hm))

david10.1.atcd.hm<-david10.atcd.hm[order(david10.atcd.hm$ID),]
david10.atcd.hm<-as.matrix(t(david10.1.atcd.hm))

david.hm.atcd.hm<-as.data.frame(matrix(c(david1.atcd.hm,david2.atcd.hm,david3.atcd.hm,david4.atcd.hm,david5.atcd.hm,david6.atcd.hm,david7.atcd.hm,david8.atcd.hm,david9.atcd.hm,david10.atcd.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atcd.hm<-data.frame(ID=david.hm.atcd.hm$V1,DS=david.hm.atcd.hm$V2,normDS=david.hm.atcd.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atcd.hm<-lm(e1.1.atcd.hm$energy_over_time~as.numeric(david1.1.atcd.hm$normDS))
hm.lm.1.s.atcd.hm<-summary(lm.hm.1.atcd.hm)$coefficients
hm.1.slope.atcd.hm<-hm.lm.1.s.atcd.hm[2,1]
lm.hm.2.atcd.hm<-lm(e2.1.atcd.hm$energy_over_time~as.numeric(david2.1.atcd.hm$normDS))
hm.lm.2.s.atcd.hm<-summary(lm.hm.2.atcd.hm)$coefficients
hm.2.slope.atcd.hm<-hm.lm.2.s.atcd.hm[2,1]
lm.hm.3.atcd.hm<-lm(e3.1.atcd.hm$energy_over_time~as.numeric(david3.1.atcd.hm$normDS))
hm.lm.3.s.atcd.hm<-summary(lm.hm.3.atcd.hm)$coefficients
hm.3.slope.atcd.hm<-hm.lm.3.s.atcd.hm[2,1]
lm.hm.4.atcd.hm<-lm(e4.1.atcd.hm$energy_over_time~as.numeric(david4.1.atcd.hm$normDS))
hm.lm.4.s.atcd.hm<-summary(lm.hm.4.atcd.hm)$coefficients
hm.4.slope.atcd.hm<-hm.lm.4.s.atcd.hm[2,1]
lm.hm.5.atcd.hm<-lm(e5.1.atcd.hm$energy_over_time~as.numeric(david5.1.atcd.hm$normDS))
hm.lm.5.s.atcd.hm<-summary(lm.hm.5.atcd.hm)$coefficients
hm.5.slope.atcd.hm<-hm.lm.5.s.atcd.hm[2,1]
lm.hm.6.atcd.hm<-lm(e6.1.atcd.hm$energy_over_time~as.numeric(david6.1.atcd.hm$normDS))
hm.lm.6.s.atcd.hm<-summary(lm.hm.6.atcd.hm)$coefficients
hm.6.slope.atcd.hm<-hm.lm.6.s.atcd.hm[2,1]
lm.hm.7.atcd.hm<-lm(e7.1.atcd.hm$energy_over_time~as.numeric(david7.1.atcd.hm$normDS))
hm.lm.7.s.atcd.hm<-summary(lm.hm.7.atcd.hm)$coefficients
hm.7.slope.atcd.hm<-hm.lm.7.s.atcd.hm[2,1]
lm.hm.8.atcd.hm<-lm(e8.1.atcd.hm$energy_over_time~as.numeric(david8.1.atcd.hm$normDS))
hm.lm.8.s.atcd.hm<-summary(lm.hm.8.atcd.hm)$coefficients
hm.8.slope.atcd.hm<-hm.lm.8.s.atcd.hm[2,1]
lm.hm.9.atcd.hm<-lm(e9.1.atcd.hm$energy_over_time~as.numeric(david9.1.atcd.hm$normDS))
hm.lm.9.s.atcd.hm<-summary(lm.hm.9.atcd.hm)$coefficients
hm.9.slope.atcd.hm<-hm.lm.9.s.atcd.hm[2,1]
lm.hm.10.atcd.hm<-lm(e10.1.atcd.hm$energy_over_time~as.numeric(david10.1.atcd.hm$normDS))
hm.lm.10.s.atcd.hm<-summary(lm.hm.10.atcd.hm)$coefficients
hm.10.slope.atcd.hm<-hm.lm.10.s.atcd.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atcd.ss.attacks.atcd.hm<-data.frame(triangle.transitivity=c(tri1.atcd.hm,tri2.atcd.hm,tri3.atcd.hm,tri4.atcd.hm,tri5.atcd.hm,tri6.atcd.hm,tri7.atcd.hm,tri8.atcd.hm,tri9.atcd.hm,tri10.atcd.hm),escalation=c(ep1.atcd.hm,ep2.atcd.hm,ep3.atcd.hm,ep4.atcd.hm,ep5.atcd.hm,ep6.atcd.hm,ep7.atcd.hm,ep8.atcd.hm,ep9.atcd.hm,ep10.atcd.hm),dci=c(dci1.atcd.hm,dci2.atcd.hm,dci3.atcd.hm,dci4.atcd.hm,dci5.atcd.hm,dci6.atcd.hm,dci7.atcd.hm,dci8.atcd.hm,dci9.atcd.hm,dci10.atcd.hm),steepness=c(s1.atcd.hm,s2.atcd.hm,s3.atcd.hm,s4.atcd.hm,s5.atcd.hm,s6.atcd.hm,s7.atcd.hm,s8.atcd.hm,s9.atcd.hm,s10.atcd.hm),slope=c(hm.1.slope.atcd.hm,hm.2.slope.atcd.hm,hm.3.slope.atcd.hm,hm.4.slope.atcd.hm,hm.5.slope.atcd.hm,hm.6.slope.atcd.hm,hm.7.slope.atcd.hm,hm.8.slope.atcd.hm,hm.9.slope.atcd.hm,hm.10.slope.atcd.hm))


```
```{r Attacks Clumped Deterministic Data Frame}
#knowledge mutual
km.tt.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$triangle.transitivity)
km.dc.sfi.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$dci)
km.esc.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$escalation)
km.steep.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$steepness)
km.slope.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$slope)
km.mean.dc.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.sf.attacks,dci=km.dc.sfi.dc.sf.attacks,esc=km.esc.dc.sf.attacks,steepness=km.steep.dc.sf.attacks,slope=km.slope.dc.sf.attacks,dist="clumped",calc="deterministic")


#history mutual
hm.tt.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$triangle.transitivity)
hm.dc.sfi.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$dci)
hm.esc.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$escalation)
hm.steep.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$steepness)
hm.slope.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$slope)
hm.mean.dc.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.dc.sf.attacks,dci=hm.dc.sfi.dc.sf.attacks,esc=hm.esc.dc.sf.attacks,steepness=hm.steep.dc.sf.attacks,slope=hm.slope.dc.sf.attacks,dist="clumped",calc="deterministic")


#total average dataframe
#dc.ave<-rbind(km.mean.dc.sf.attacks,ks.mean.dc.sf.attacks,ko.mean.dc.sf.attacks,hm.mean.dc.sf.attacks,hs.mean.dc.sf.attacks,ho.mean.dc.sf.attacks)

dc.ave<-rbind(km.mean.dc.sf.attacks,hm.mean.dc.sf.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$triangle.transitivity)
km.dc.sfi.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$dci)
km.esc.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$escalation)
km.steep.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$steepness)
km.slope.dc.sf.attacks<-mean(km.atcd.ss.attacks.atcd.km$slope)
km.mean.dc.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.dc.sf.attacks,dci=km.dc.sfi.dc.sf.attacks,esc=km.esc.dc.sf.attacks,steepness=km.steep.dc.sf.attacks,slope=km.slope.dc.sf.attacks,dist="clumped",calc="deterministic")


#history mutual
hm.tt.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$triangle.transitivity)
hm.dc.sfi.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$dci)
hm.esc.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$escalation)
hm.steep.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$steepness)
hm.slope.dc.sf.attacks<-mean(hm.atcd.ss.attacks.atcd.hm$slope)
hm.mean.dc.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.dc.sf.attacks,dci=hm.dc.sfi.dc.sf.attacks,esc=hm.esc.dc.sf.attacks,steepness=hm.steep.dc.sf.attacks,slope=hm.slope.dc.sf.attacks,dist="clumped",calc="deterministic")


#total average dataframe
#dc.ave<-rbind(km.mean.dc.sf.attacks,ks.mean.dc.sf.attacks,ko.mean.dc.sf.attacks,hm.mean.dc.sf.attacks,hs.mean.dc.sf.attacks,ho.mean.dc.sf.attacks)
dc.ave<-rbind(km.mean.dc.sf.attacks,hm.mean.dc.sf.attacks)

#create overall dataframe of summary statistics
overall.deter.sf.clump.sf.attacks<-data.frame(km.atcd.ss.attacks.atcd.km)
overall.deter.sf.clump.sf.attacks<-rbind(overall.deter.sf.clump.sf.attacks,hm.atcd.ss.attacks.atcd.hm)

overall.deter.sf.clump.sf.attacks<-cbind(overall.deter.sf.clump.sf.attacks,variable=c(rep("rhp",10),rep("history",10)))
overall.deter.sf.clump.sf.attacks<-cbind(overall.deter.sf.clump.sf.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("deter",20))


rhp.ss.attacks<-overall.deter.sf.clump.sf.attacks[overall.deter.sf.clump.sf.attacks$variable=="rhp",]
history.ss.attacks<-overall.deter.sf.clump.sf.attacks[overall.deter.sf.clump.sf.attacks$variable=="history",]

overall.deter.sf.clump.sf.attacks$combo<-paste(overall.deter.sf.clump.sf.attacks$strategy,overall.deter.sf.clump.sf.attacks$variable,overall.deter.sf.clump.sf.attacks$distribution)
overall.deter.sf.clump.sf.attacks$combo2<-paste(overall.deter.sf.clump.sf.attacks$strategy,overall.deter.sf.clump.sf.attacks$variable)
```

## Uniform Deterministic Data
```{r Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid.ud.sf.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[1]],X2=avoid.ud.sf.km[[2]],Avoids=avoid.ud.sf.km[[3]])
a2.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[4]],X2=avoid.ud.sf.km[[5]],Avoids=avoid.ud.sf.km[[6]])
a3.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[7]],X2=avoid.ud.sf.km[[8]],Avoids=avoid.ud.sf.km[[9]])
a4.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[10]],X2=avoid.ud.sf.km[[11]],Avoids=avoid.ud.sf.km[[12]])
a5.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[13]],X2=avoid.ud.sf.km[[14]],Avoids=avoid.ud.sf.km[[15]])
a6.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[16]],X2=avoid.ud.sf.km[[17]],Avoids=avoid.ud.sf.km[[18]])
a7.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[19]],X2=avoid.ud.sf.km[[20]],Avoids=avoid.ud.sf.km[[21]])
a8.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[22]],X2=avoid.ud.sf.km[[23]],Avoids=avoid.ud.sf.km[[24]])
a9.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[25]],X2=avoid.ud.sf.km[[26]],Avoids=avoid.ud.sf.km[[27]])
a10.ud.sf.km<-data.frame(X1=avoid.ud.sf.km[[28]],X2=avoid.ud.sf.km[[29]],Avoids=avoid.ud.sf.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.d/conflict")

files<-list.files(pattern="*.csv")
conflict.km.ud.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[1]],X2=conflict.km.ud.sf[[2]],Victories=conflict.km.ud.sf[[3]])
mat1.ud.sf.km<-inter.mat(mut1.ud.sf.km)
tri1.ud.sf.km<-tr.tri(mat1.ud.sf.km)
dci1.ud.sf.km<-DCindex(mat1.ud.sf.km)
mat1.ud.sf.km[is.na(mat1.ud.sf.km)] = 0
h1.ud.sf.km<-h.index(mat1.ud.sf.km)

ep1.ud.sf.km<-ep(mut1.ud.sf.km,a1.ud.sf.km)
david1.ud.sf.km<-DS(mat1.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ud.sf.km<-cbind(ordrank.1.ud.sf.km,ds=david1.ud.sf.km$normDS)
lm1.ud.sf.km<-summary(lm(ordrank.1.ud.sf.km$ds~ordrank.1.ud.sf.km$ord.rank))
s1.ud.sf.km<-lm1.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[4]],X2=conflict.km.ud.sf[[5]],Victories=conflict.km.ud.sf[[6]])
mat2.ud.sf.km<-inter.mat(mut2.ud.sf.km)
tri2.ud.sf.km<-tr.tri(mat2.ud.sf.km)
dci2.ud.sf.km<-DCindex(mat2.ud.sf.km)
mat2.ud.sf.km[is.na(mat2.ud.sf.km)] = 0
h2.ud.sf.km<-h.index(mat2.ud.sf.km)

ep2.ud.sf.km<-ep(mut2.ud.sf.km,a2.ud.sf.km)
david2.ud.sf.km<-DS(mat2.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ud.sf.km<-cbind(ordrank.2.ud.sf.km,ds=david2.ud.sf.km$normDS)
lm2.ud.sf.km<-summary(lm(ordrank.2.ud.sf.km$ds~ordrank.2.ud.sf.km$ord.rank))
s2.ud.sf.km<-lm2.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[7]],X2=conflict.km.ud.sf[[8]],Victories=conflict.km.ud.sf[[9]])
mat3.ud.sf.km<-inter.mat(mut3.ud.sf.km)
tri3.ud.sf.km<-tr.tri(mat3.ud.sf.km)
dci3.ud.sf.km<-DCindex(mat3.ud.sf.km)
mat3.ud.sf.km[is.na(mat3.ud.sf.km)] = 0
h3.ud.sf.km<-h.index(mat3.ud.sf.km)

ep3.ud.sf.km<-ep(mut3.ud.sf.km,a3.ud.sf.km)
david3.ud.sf.km<-DS(mat3.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ud.sf.km<-cbind(ordrank.3.ud.sf.km,ds=david3.ud.sf.km$normDS)
lm3.ud.sf.km<-summary(lm(ordrank.3.ud.sf.km$ds~ordrank.3.ud.sf.km$ord.rank))
s3.ud.sf.km<-lm3.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[10]],X2=conflict.km.ud.sf[[11]],Victories=conflict.km.ud.sf[[12]])
mat4.ud.sf.km<-inter.mat(mut4.ud.sf.km)
tri4.ud.sf.km<-tr.tri(mat4.ud.sf.km)
dci4.ud.sf.km<-DCindex(mat4.ud.sf.km)
mat4.ud.sf.km[is.na(mat4.ud.sf.km)] = 0
h4.ud.sf.km<-h.index(mat4.ud.sf.km)

ep4.ud.sf.km<-ep(mut4.ud.sf.km,a4.ud.sf.km)
david4.ud.sf.km<-DS(mat4.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ud.sf.km<-cbind(ordrank.4.ud.sf.km,ds=david4.ud.sf.km$normDS)
lm4.ud.sf.km<-summary(lm(ordrank.4.ud.sf.km$ds~ordrank.4.ud.sf.km$ord.rank))
s4.ud.sf.km<-lm4.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[13]],X2=conflict.km.ud.sf[[14]],Victories=conflict.km.ud.sf[[15]])
mat5.ud.sf.km<-inter.mat(mut5.ud.sf.km)
tri5.ud.sf.km<-tr.tri(mat5.ud.sf.km)
dci5.ud.sf.km<-DCindex(mat5.ud.sf.km)
mat5.ud.sf.km[is.na(mat5.ud.sf.km)] = 0
h5.ud.sf.km<-h.index(mat5.ud.sf.km)

ep5.ud.sf.km<-ep(mut5.ud.sf.km,a5.ud.sf.km)
david5.ud.sf.km<-DS(mat5.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ud.sf.km<-cbind(ordrank.5.ud.sf.km,ds=david5.ud.sf.km$normDS)
lm5.ud.sf.km<-summary(lm(ordrank.5.ud.sf.km$ds~ordrank.5.ud.sf.km$ord.rank))
s5.ud.sf.km<-lm5.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[16]],X2=conflict.km.ud.sf[[17]],Victories=conflict.km.ud.sf[[18]])
mat6.ud.sf.km<-inter.mat(mut6.ud.sf.km)
tri6.ud.sf.km<-tr.tri(mat6.ud.sf.km)
dci6.ud.sf.km<-DCindex(mat6.ud.sf.km)
mat6.ud.sf.km[is.na(mat6.ud.sf.km)] = 0
h6.ud.sf.km<-h.index(mat6.ud.sf.km)

ep6.ud.sf.km<-ep(mut6.ud.sf.km,a6.ud.sf.km)
david6.ud.sf.km<-DS(mat6.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ud.sf.km<-cbind(ordrank.6.ud.sf.km,ds=david6.ud.sf.km$normDS)
lm6.ud.sf.km<-summary(lm(ordrank.6.ud.sf.km$ds~ordrank.6.ud.sf.km$ord.rank))
s6.ud.sf.km<-lm6.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[19]],X2=conflict.km.ud.sf[[20]],Victories=conflict.km.ud.sf[[21]])
mat7.ud.sf.km<-inter.mat(mut7.ud.sf.km)
tri7.ud.sf.km<-tr.tri(mat7.ud.sf.km)
dci7.ud.sf.km<-DCindex(mat7.ud.sf.km)
mat7.ud.sf.km[is.na(mat7.ud.sf.km)] = 0
h7.ud.sf.km<-h.index(mat7.ud.sf.km)

ep7.ud.sf.km<-ep(mut7.ud.sf.km,a7.ud.sf.km)
david7.ud.sf.km<-DS(mat7.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ud.sf.km<-cbind(ordrank.7.ud.sf.km,ds=david7.ud.sf.km$normDS)
lm7.ud.sf.km<-summary(lm(ordrank.7.ud.sf.km$ds~ordrank.7.ud.sf.km$ord.rank))
s7.ud.sf.km<-lm7.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[22]],X2=conflict.km.ud.sf[[23]],Victories=conflict.km.ud.sf[[24]])
mat8.ud.sf.km<-inter.mat(mut8.ud.sf.km)
tri8.ud.sf.km<-tr.tri(mat8.ud.sf.km)
dci8.ud.sf.km<-DCindex(mat8.ud.sf.km)
mat8.ud.sf.km[is.na(mat8.ud.sf.km)] = 0
h8.ud.sf.km<-h.index(mat8.ud.sf.km)

ep8.ud.sf.km<-ep(mut8.ud.sf.km,a8.ud.sf.km)
david8.ud.sf.km<-DS(mat8.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ud.sf.km<-cbind(ordrank.8.ud.sf.km,ds=david8.ud.sf.km$normDS)
lm8.ud.sf.km<-summary(lm(ordrank.8.ud.sf.km$ds~ordrank.8.ud.sf.km$ord.rank))
s8.ud.sf.km<-lm8.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[25]],X2=conflict.km.ud.sf[[26]],Victories=conflict.km.ud.sf[[27]])
mat9.ud.sf.km<-inter.mat(mut9.ud.sf.km)
tri9.ud.sf.km<-tr.tri(mat9.ud.sf.km)
dci9.ud.sf.km<-DCindex(mat9.ud.sf.km)
mat9.ud.sf.km[is.na(mat9.ud.sf.km)] = 0
h9.ud.sf.km<-h.index(mat9.ud.sf.km)

ep9.ud.sf.km<-ep(mut9.ud.sf.km,a9.ud.sf.km)
david9.ud.sf.km<-DS(mat9.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ud.sf.km<-cbind(ordrank.9.ud.sf.km,ds=david9.ud.sf.km$normDS)
lm9.ud.sf.km<-summary(lm(ordrank.9.ud.sf.km$ds~ordrank.9.ud.sf.km$ord.rank))
s9.ud.sf.km<-lm9.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ud.sf.km<-data.frame(X1=conflict.km.ud.sf[[28]],X2=conflict.km.ud.sf[[29]],Victories=conflict.km.ud.sf[[30]])
mat10.ud.sf.km<-inter.mat(mut10.ud.sf.km)
tri10.ud.sf.km<-tr.tri(mat10.ud.sf.km)
dci10.ud.sf.km<-DCindex(mat10.ud.sf.km)
mat10.ud.sf.km[is.na(mat10.ud.sf.km)] = 0
h10.ud.sf.km<-h.index(mat10.ud.sf.km)

ep10.ud.sf.km<-ep(mut10.ud.sf.km,a10.ud.sf.km)
david10.ud.sf.km<-DS(mat10.ud.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.ud.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ud.sf.km<-cbind(ordrank.10.ud.sf.km,ds=david10.ud.sf.km$normDS)
lm10.ud.sf.km<-summary(lm(ordrank.10.ud.sf.km$ds~ordrank.10.ud.sf.km$ord.rank))
s10.ud.sf.km<-lm10.ud.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ud.sf.km<-sum(mut1.ud.sf.km$Victories)
int2.ud.sf.km<-sum(mut2.ud.sf.km$Victories)
int3.ud.sf.km<-sum(mut3.ud.sf.km$Victories)
int4.ud.sf.km<-sum(mut4.ud.sf.km$Victories)
int5.ud.sf.km<-sum(mut5.ud.sf.km$Victories)
int6.ud.sf.km<-sum(mut6.ud.sf.km$Victories)
int7.ud.sf.km<-sum(mut7.ud.sf.km$Victories)
int8.ud.sf.km<-sum(mut8.ud.sf.km$Victories)
int9.ud.sf.km<-sum(mut9.ud.sf.km$Victories)
int10.ud.sf.km<-sum(mut10.ud.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.ud.sf.km<-sum(a1.ud.sf.km$Avoids)
av2.ud.sf.km<-sum(a2.ud.sf.km$Avoids)
av3.ud.sf.km<-sum(a3.ud.sf.km$Avoids)
av4.ud.sf.km<-sum(a4.ud.sf.km$Avoids)
av5.ud.sf.km<-sum(a5.ud.sf.km$Avoids)
av6.ud.sf.km<-sum(a6.ud.sf.km$Avoids)
av7.ud.sf.km<-sum(a7.ud.sf.km$Avoids)
av8.ud.sf.km<-sum(a8.ud.sf.km$Avoids)
av9.ud.sf.km<-sum(a9.ud.sf.km$Avoids)
av10.ud.sf.km<-sum(a10.ud.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.du.sf<-(sum(av1.ud.sf.km, av2.ud.sf.km, av3.ud.sf.km, av4.ud.sf.km, av5.ud.sf.km, av6.ud.sf.km, av7.ud.sf.km, av8.ud.sf.km, av9.ud.sf.km, av10.ud.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.du.sf<-(sum(int1.ud.sf.km, int2.ud.sf.km, int3.ud.sf.km, int4.ud.sf.km, int5.ud.sf.km, int6.ud.sf.km, int7.ud.sf.km, int8.ud.sf.km, int9.ud.sf.km, int10.ud.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ud.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ud.sf.km<-e1.ud.sf.km[order(e1.ud.sf.km$ID),]
e1.ud.sf.km<-as.matrix(t(e1.1.ud.sf.km))

e2.ud.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ud.sf.km<-e2.ud.sf.km[order(e2.ud.sf.km$ID),]
e2.ud.sf.km<-as.matrix(t(e2.1.ud.sf.km))

e3.ud.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ud.sf.km<-e3.ud.sf.km[order(e3.ud.sf.km$ID),]
e3.ud.sf.km<-as.matrix(t(e3.1.ud.sf.km))

e4.ud.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ud.sf.km<-e4.ud.sf.km[order(e4.ud.sf.km$ID),]
e4.ud.sf.km<-as.matrix(t(e4.1.ud.sf.km))

e5.ud.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ud.sf.km<-e5.ud.sf.km[order(e5.ud.sf.km$ID),]
e5.ud.sf.km<-as.matrix(t(e5.1.ud.sf.km))

e6.ud.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ud.sf.km<-e6.ud.sf.km[order(e6.ud.sf.km$ID),]
e6.ud.sf.km<-as.matrix(t(e6.1.ud.sf.km))

e7.ud.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ud.sf.km<-e7.ud.sf.km[order(e7.ud.sf.km$ID),]
e7.ud.sf.km<-as.matrix(t(e7.1.ud.sf.km))

e8.ud.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ud.sf.km<-e8.ud.sf.km[order(e8.ud.sf.km$ID),]
e8.ud.sf.km<-as.matrix(t(e8.1.ud.sf.km))

e9.ud.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ud.sf.km<-e9.ud.sf.km[order(e9.ud.sf.km$ID),]
e9.ud.sf.km<-as.matrix(t(e9.1.ud.sf.km))

e10.ud.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ud.sf.km<-e10.ud.sf.km[order(e10.ud.sf.km$ID),]
e10.ud.sf.km<-as.matrix(t(e10.1.ud.sf.km))

energy.km.ud.sf.km<-as.data.frame(matrix(c(e1.ud.sf.km,e2.ud.sf.km,e3.ud.sf.km,e4.ud.sf.km,e5.ud.sf.km,e6.ud.sf.km,e7.ud.sf.km,e8.ud.sf.km,e9.ud.sf.km,e10.ud.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.ud.sf.km<-data.frame(ID=energy.km.ud.sf.km$V1,energy_over_distance=energy.km.ud.sf.km$V2,energy_over_time=energy.km.ud.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ud.sf.km<-david1.ud.sf.km[order(david1.ud.sf.km$ID),]
david1.ud.sf.km<-as.matrix(t(david1.1.ud.sf.km))

david2.1.ud.sf.km<-david2.ud.sf.km[order(david2.ud.sf.km$ID),]
david2.ud.sf.km<-as.matrix(t(david2.1.ud.sf.km))

david3.1.ud.sf.km<-david3.ud.sf.km[order(david3.ud.sf.km$ID),]
david3.ud.sf.km<-as.matrix(t(david3.1.ud.sf.km))

david4.1.ud.sf.km<-david4.ud.sf.km[order(david4.ud.sf.km$ID),]
david4.ud.sf.km<-as.matrix(t(david4.1.ud.sf.km))

david5.1.ud.sf.km<-david5.ud.sf.km[order(david5.ud.sf.km$ID),]
david5.ud.sf.km<-as.matrix(t(david5.1.ud.sf.km))

david6.1.ud.sf.km<-david6.ud.sf.km[order(david6.ud.sf.km$ID),]
david6.ud.sf.km<-as.matrix(t(david6.1.ud.sf.km))

david7.1.ud.sf.km<-david7.ud.sf.km[order(david7.ud.sf.km$ID),]
david7.ud.sf.km<-as.matrix(t(david7.1.ud.sf.km))

david8.1.ud.sf.km<-david8.ud.sf.km[order(david8.ud.sf.km$ID),]
david8.ud.sf.km<-as.matrix(t(david8.1.ud.sf.km))

david9.1.ud.sf.km<-david9.ud.sf.km[order(david9.ud.sf.km$ID),]
david9.ud.sf.km<-as.matrix(t(david9.1.ud.sf.km))

david10.1.ud.sf.km<-david10.ud.sf.km[order(david10.ud.sf.km$ID),]
david10.ud.sf.km<-as.matrix(t(david10.1.ud.sf.km))

david.km.ud.sf.km<-as.data.frame(matrix(c(david1.ud.sf.km,david2.ud.sf.km,david3.ud.sf.km,david4.ud.sf.km,david5.ud.sf.km,david6.ud.sf.km,david7.ud.sf.km,david8.ud.sf.km,david9.ud.sf.km,david10.ud.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.ud.sf.km<-data.frame(ID=david.km.ud.sf.km$V1,DS=david.km.ud.sf.km$V2,normDS=david.km.ud.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.ud.sf.km<-lm(e1.1.ud.sf.km$energy_over_time~as.numeric(david1.1.ud.sf.km$normDS))
km.lm.1.s.ud.sf.km<-summary(lm.km.1.ud.sf.km)$coefficients
km.1.slope.ud.sf.km<-km.lm.1.s.ud.sf.km[2,1]
lm.km.2.ud.sf.km<-lm(e2.1.ud.sf.km$energy_over_time~as.numeric(david2.1.ud.sf.km$normDS))
km.lm.2.s.ud.sf.km<-summary(lm.km.2.ud.sf.km)$coefficients
km.2.slope.ud.sf.km<-km.lm.2.s.ud.sf.km[2,1]
lm.km.3.ud.sf.km<-lm(e3.1.ud.sf.km$energy_over_time~as.numeric(david3.1.ud.sf.km$normDS))
km.lm.3.s.ud.sf.km<-summary(lm.km.3.ud.sf.km)$coefficients
km.3.slope.ud.sf.km<-km.lm.3.s.ud.sf.km[2,1]
lm.km.4.ud.sf.km<-lm(e4.1.ud.sf.km$energy_over_time~as.numeric(david4.1.ud.sf.km$normDS))
km.lm.4.s.ud.sf.km<-summary(lm.km.4.ud.sf.km)$coefficients
km.4.slope.ud.sf.km<-km.lm.4.s.ud.sf.km[2,1]
lm.km.5.ud.sf.km<-lm(e5.1.ud.sf.km$energy_over_time~as.numeric(david5.1.ud.sf.km$normDS))
km.lm.5.s.ud.sf.km<-summary(lm.km.5.ud.sf.km)$coefficients
km.5.slope.ud.sf.km<-km.lm.5.s.ud.sf.km[2,1]
lm.km.6.ud.sf.km<-lm(e6.1.ud.sf.km$energy_over_time~as.numeric(david6.1.ud.sf.km$normDS))
km.lm.6.s.ud.sf.km<-summary(lm.km.6.ud.sf.km)$coefficients
km.6.slope.ud.sf.km<-km.lm.6.s.ud.sf.km[2,1]
lm.km.7.ud.sf.km<-lm(e7.1.ud.sf.km$energy_over_time~as.numeric(david7.1.ud.sf.km$normDS))
km.lm.7.s.ud.sf.km<-summary(lm.km.7.ud.sf.km)$coefficients
km.7.slope.ud.sf.km<-km.lm.7.s.ud.sf.km[2,1]
lm.km.8.ud.sf.km<-lm(e8.1.ud.sf.km$energy_over_time~as.numeric(david8.1.ud.sf.km$normDS))
km.lm.8.s.ud.sf.km<-summary(lm.km.8.ud.sf.km)$coefficients
km.8.slope.ud.sf.km<-km.lm.8.s.ud.sf.km[2,1]
lm.km.9.ud.sf.km<-lm(e9.1.ud.sf.km$energy_over_time~as.numeric(david9.1.ud.sf.km$normDS))
km.lm.9.s.ud.sf.km<-summary(lm.km.9.ud.sf.km)$coefficients
km.9.slope.ud.sf.km<-km.lm.9.s.ud.sf.km[2,1]
lm.km.10.ud.sf.km<-lm(e10.1.ud.sf.km$energy_over_time~as.numeric(david10.1.ud.sf.km$normDS))
km.lm.10.s.ud.sf.km<-summary(lm.km.10.ud.sf.km)$coefficients
km.10.slope.ud.sf.km<-km.lm.10.s.ud.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.ud.sf.ss<-data.frame(triangle.transitivity=c(tri1.ud.sf.km,tri2.ud.sf.km,tri3.ud.sf.km,tri4.ud.sf.km,tri5.ud.sf.km,tri6.ud.sf.km,tri7.ud.sf.km,tri8.ud.sf.km,tri9.ud.sf.km,tri10.ud.sf.km),escalation=c(ep1.ud.sf.km,ep2.ud.sf.km,ep3.ud.sf.km,ep4.ud.sf.km,ep5.ud.sf.km,ep6.ud.sf.km,ep7.ud.sf.km,ep8.ud.sf.km,ep9.ud.sf.km,ep10.ud.sf.km),dci=c(dci1.ud.sf.km,dci2.ud.sf.km,dci3.ud.sf.km,dci4.ud.sf.km,dci5.ud.sf.km,dci6.ud.sf.km,dci7.ud.sf.km,dci8.ud.sf.km,dci9.ud.sf.km,dci10.ud.sf.km),steepness=c(s1.ud.sf.km,s2.ud.sf.km,s3.ud.sf.km,s4.ud.sf.km,s5.ud.sf.km,s6.ud.sf.km,s7.ud.sf.km,s8.ud.sf.km,s9.ud.sf.km,s10.ud.sf.km),slope=c(km.1.slope.ud.sf.km,km.2.slope.ud.sf.km,km.3.slope.ud.sf.km,km.4.slope.ud.sf.km,km.5.slope.ud.sf.km,km.6.slope.ud.sf.km,km.7.slope.ud.sf.km,km.8.slope.ud.sf.km,km.9.slope.ud.sf.km,km.10.slope.ud.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.d/avoid")

files<-list.files(pattern="*.csv")
avoid.ud.sf.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[1]],X2=avoid.ud.sf.hm[[2]],Avoids=avoid.ud.sf.hm[[3]])
a2.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[4]],X2=avoid.ud.sf.hm[[5]],Avoids=avoid.ud.sf.hm[[6]])
a3.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[7]],X2=avoid.ud.sf.hm[[8]],Avoids=avoid.ud.sf.hm[[9]])
a4.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[10]],X2=avoid.ud.sf.hm[[11]],Avoids=avoid.ud.sf.hm[[12]])
a5.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[13]],X2=avoid.ud.sf.hm[[14]],Avoids=avoid.ud.sf.hm[[15]])
a6.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[16]],X2=avoid.ud.sf.hm[[17]],Avoids=avoid.ud.sf.hm[[18]])
a7.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[19]],X2=avoid.ud.sf.hm[[20]],Avoids=avoid.ud.sf.hm[[21]])
a8.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[22]],X2=avoid.ud.sf.hm[[23]],Avoids=avoid.ud.sf.hm[[24]])
a9.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[25]],X2=avoid.ud.sf.hm[[26]],Avoids=avoid.ud.sf.hm[[27]])
a10.ud.sf.hm<-data.frame(X1=avoid.ud.sf.hm[[28]],X2=avoid.ud.sf.hm[[29]],Avoids=avoid.ud.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.d/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.ud.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[1]],X2=conflict.hm.ud.sf[[2]],Victories=conflict.hm.ud.sf[[3]])
mat1.ud.sf.hm<-inter.mat(mut1.ud.sf.hm)
tri1.ud.sf.hm<-tr.tri(mat1.ud.sf.hm)
dci1.ud.sf.hm<-DCindex(mat1.ud.sf.hm)
mat1.ud.sf.hm[is.na(mat1.ud.sf.hm)] = 0
h1.ud.sf.hm<-h.index(mat1.ud.sf.hm)

ep1.ud.sf.hm<-ep(mut1.ud.sf.hm,a1.ud.sf.hm)
david1.ud.sf.hm<-DS(mat1.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ud.sf.hm<-cbind(ordrank.1.ud.sf.hm,ds=david1.ud.sf.hm$normDS)
lm1.ud.sf.hm<-summary(lm(ordrank.1.ud.sf.hm$ds~ordrank.1.ud.sf.hm$ord.rank))
s1.ud.sf.hm<-lm1.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[4]],X2=conflict.hm.ud.sf[[5]],Victories=conflict.hm.ud.sf[[6]])
mat2.ud.sf.hm<-inter.mat(mut2.ud.sf.hm)
tri2.ud.sf.hm<-tr.tri(mat2.ud.sf.hm)
dci2.ud.sf.hm<-DCindex(mat2.ud.sf.hm)
mat2.ud.sf.hm[is.na(mat2.ud.sf.hm)] = 0
h2.ud.sf.hm<-h.index(mat2.ud.sf.hm)

ep2.ud.sf.hm<-ep(mut2.ud.sf.hm,a2.ud.sf.hm)
david2.ud.sf.hm<-DS(mat2.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ud.sf.hm<-cbind(ordrank.2.ud.sf.hm,ds=david2.ud.sf.hm$normDS)
lm2.ud.sf.hm<-summary(lm(ordrank.2.ud.sf.hm$ds~ordrank.2.ud.sf.hm$ord.rank))
s2.ud.sf.hm<-lm2.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[7]],X2=conflict.hm.ud.sf[[8]],Victories=conflict.hm.ud.sf[[9]])
mat3.ud.sf.hm<-inter.mat(mut3.ud.sf.hm)
tri3.ud.sf.hm<-tr.tri(mat3.ud.sf.hm)
dci3.ud.sf.hm<-DCindex(mat3.ud.sf.hm)
mat3.ud.sf.hm[is.na(mat3.ud.sf.hm)] = 0
h3.ud.sf.hm<-h.index(mat3.ud.sf.hm)

ep3.ud.sf.hm<-ep(mut3.ud.sf.hm,a3.ud.sf.hm)
david3.ud.sf.hm<-DS(mat3.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ud.sf.hm<-cbind(ordrank.3.ud.sf.hm,ds=david3.ud.sf.hm$normDS)
lm3.ud.sf.hm<-summary(lm(ordrank.3.ud.sf.hm$ds~ordrank.3.ud.sf.hm$ord.rank))
s3.ud.sf.hm<-lm3.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[10]],X2=conflict.hm.ud.sf[[11]],Victories=conflict.hm.ud.sf[[12]])
mat4.ud.sf.hm<-inter.mat(mut4.ud.sf.hm)
tri4.ud.sf.hm<-tr.tri(mat4.ud.sf.hm)
dci4.ud.sf.hm<-DCindex(mat4.ud.sf.hm)
mat4.ud.sf.hm[is.na(mat4.ud.sf.hm)] = 0
h4.ud.sf.hm<-h.index(mat4.ud.sf.hm)

ep4.ud.sf.hm<-ep(mut4.ud.sf.hm,a4.ud.sf.hm)
david4.ud.sf.hm<-DS(mat4.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ud.sf.hm<-cbind(ordrank.4.ud.sf.hm,ds=david4.ud.sf.hm$normDS)
lm4.ud.sf.hm<-summary(lm(ordrank.4.ud.sf.hm$ds~ordrank.4.ud.sf.hm$ord.rank))
s4.ud.sf.hm<-lm4.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[13]],X2=conflict.hm.ud.sf[[14]],Victories=conflict.hm.ud.sf[[15]])
mat5.ud.sf.hm<-inter.mat(mut5.ud.sf.hm)
tri5.ud.sf.hm<-tr.tri(mat5.ud.sf.hm)
dci5.ud.sf.hm<-DCindex(mat5.ud.sf.hm)
mat5.ud.sf.hm[is.na(mat5.ud.sf.hm)] = 0
h5.ud.sf.hm<-h.index(mat5.ud.sf.hm)

ep5.ud.sf.hm<-ep(mut5.ud.sf.hm,a5.ud.sf.hm)
david5.ud.sf.hm<-DS(mat5.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ud.sf.hm<-cbind(ordrank.5.ud.sf.hm,ds=david5.ud.sf.hm$normDS)
lm5.ud.sf.hm<-summary(lm(ordrank.5.ud.sf.hm$ds~ordrank.5.ud.sf.hm$ord.rank))
s5.ud.sf.hm<-lm5.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[16]],X2=conflict.hm.ud.sf[[17]],Victories=conflict.hm.ud.sf[[18]])
mat6.ud.sf.hm<-inter.mat(mut6.ud.sf.hm)
tri6.ud.sf.hm<-tr.tri(mat6.ud.sf.hm)
dci6.ud.sf.hm<-DCindex(mat6.ud.sf.hm)
mat6.ud.sf.hm[is.na(mat6.ud.sf.hm)] = 0
h6.ud.sf.hm<-h.index(mat6.ud.sf.hm)

ep6.ud.sf.hm<-ep(mut6.ud.sf.hm,a6.ud.sf.hm)
david6.ud.sf.hm<-DS(mat6.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ud.sf.hm<-cbind(ordrank.6.ud.sf.hm,ds=david6.ud.sf.hm$normDS)
lm6.ud.sf.hm<-summary(lm(ordrank.6.ud.sf.hm$ds~ordrank.6.ud.sf.hm$ord.rank))
s6.ud.sf.hm<-lm6.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[19]],X2=conflict.hm.ud.sf[[20]],Victories=conflict.hm.ud.sf[[21]])
mat7.ud.sf.hm<-inter.mat(mut7.ud.sf.hm)
tri7.ud.sf.hm<-tr.tri(mat7.ud.sf.hm)
dci7.ud.sf.hm<-DCindex(mat7.ud.sf.hm)
mat7.ud.sf.hm[is.na(mat7.ud.sf.hm)] = 0
h7.ud.sf.hm<-h.index(mat7.ud.sf.hm)

ep7.ud.sf.hm<-ep(mut7.ud.sf.hm,a7.ud.sf.hm)
david7.ud.sf.hm<-DS(mat7.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ud.sf.hm<-cbind(ordrank.7.ud.sf.hm,ds=david7.ud.sf.hm$normDS)
lm7.ud.sf.hm<-summary(lm(ordrank.7.ud.sf.hm$ds~ordrank.7.ud.sf.hm$ord.rank))
s7.ud.sf.hm<-lm7.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[22]],X2=conflict.hm.ud.sf[[23]],Victories=conflict.hm.ud.sf[[24]])
mat8.ud.sf.hm<-inter.mat(mut8.ud.sf.hm)
tri8.ud.sf.hm<-tr.tri(mat8.ud.sf.hm)
dci8.ud.sf.hm<-DCindex(mat8.ud.sf.hm)
mat8.ud.sf.hm[is.na(mat8.ud.sf.hm)] = 0
h8.ud.sf.hm<-h.index(mat8.ud.sf.hm)

ep8.ud.sf.hm<-ep(mut8.ud.sf.hm,a8.ud.sf.hm)
david8.ud.sf.hm<-DS(mat8.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ud.sf.hm<-cbind(ordrank.8.ud.sf.hm,ds=david8.ud.sf.hm$normDS)
lm8.ud.sf.hm<-summary(lm(ordrank.8.ud.sf.hm$ds~ordrank.8.ud.sf.hm$ord.rank))
s8.ud.sf.hm<-lm8.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[25]],X2=conflict.hm.ud.sf[[26]],Victories=conflict.hm.ud.sf[[27]])
mat9.ud.sf.hm<-inter.mat(mut9.ud.sf.hm)
tri9.ud.sf.hm<-tr.tri(mat9.ud.sf.hm)
dci9.ud.sf.hm<-DCindex(mat9.ud.sf.hm)
mat9.ud.sf.hm[is.na(mat9.ud.sf.hm)] = 0
h9.ud.sf.hm<-h.index(mat9.ud.sf.hm)

ep9.ud.sf.hm<-ep(mut9.ud.sf.hm,a9.ud.sf.hm)
david9.ud.sf.hm<-DS(mat9.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ud.sf.hm<-cbind(ordrank.9.ud.sf.hm,ds=david9.ud.sf.hm$normDS)
lm9.ud.sf.hm<-summary(lm(ordrank.9.ud.sf.hm$ds~ordrank.9.ud.sf.hm$ord.rank))
s9.ud.sf.hm<-lm9.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ud.sf.hm<-data.frame(X1=conflict.hm.ud.sf[[28]],X2=conflict.hm.ud.sf[[29]],Victories=conflict.hm.ud.sf[[30]])
mat10.ud.sf.hm<-inter.mat(mut10.ud.sf.hm)
tri10.ud.sf.hm<-tr.tri(mat10.ud.sf.hm)
dci10.ud.sf.hm<-DCindex(mat10.ud.sf.hm)
mat10.ud.sf.hm[is.na(mat10.ud.sf.hm)] = 0
h10.ud.sf.hm<-h.index(mat10.ud.sf.hm)

ep10.ud.sf.hm<-ep(mut10.ud.sf.hm,a10.ud.sf.hm)
david10.ud.sf.hm<-DS(mat10.ud.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.ud.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ud.sf.hm<-cbind(ordrank.10.ud.sf.hm,ds=david10.ud.sf.hm$normDS)
lm10.ud.sf.hm<-summary(lm(ordrank.10.ud.sf.hm$ds~ordrank.10.ud.sf.hm$ord.rank))
s10.ud.sf.hm<-lm10.ud.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ud.sf.hm<-sum(mut1.ud.sf.hm$Victories)
int2.ud.sf.hm<-sum(mut2.ud.sf.hm$Victories)
int3.ud.sf.hm<-sum(mut3.ud.sf.hm$Victories)
int4.ud.sf.hm<-sum(mut4.ud.sf.hm$Victories)
int5.ud.sf.hm<-sum(mut5.ud.sf.hm$Victories)
int6.ud.sf.hm<-sum(mut6.ud.sf.hm$Victories)
int7.ud.sf.hm<-sum(mut7.ud.sf.hm$Victories)
int8.ud.sf.hm<-sum(mut8.ud.sf.hm$Victories)
int9.ud.sf.hm<-sum(mut9.ud.sf.hm$Victories)
int10.ud.sf.hm<-sum(mut10.ud.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.ud.sf.hm<-sum(a1.ud.sf.hm$Avoids)
av2.ud.sf.hm<-sum(a2.ud.sf.hm$Avoids)
av3.ud.sf.hm<-sum(a3.ud.sf.hm$Avoids)
av4.ud.sf.hm<-sum(a4.ud.sf.hm$Avoids)
av5.ud.sf.hm<-sum(a5.ud.sf.hm$Avoids)
av6.ud.sf.hm<-sum(a6.ud.sf.hm$Avoids)
av7.ud.sf.hm<-sum(a7.ud.sf.hm$Avoids)
av8.ud.sf.hm<-sum(a8.ud.sf.hm$Avoids)
av9.ud.sf.hm<-sum(a9.ud.sf.hm$Avoids)
av10.ud.sf.hm<-sum(a10.ud.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.du.sf<-(sum(av1.ud.sf.hm, av2.ud.sf.hm, av3.ud.sf.hm, av4.ud.sf.hm, av5.ud.sf.hm, av6.ud.sf.hm, av7.ud.sf.hm, av8.ud.sf.hm, av9.ud.sf.hm, av10.ud.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.du.sf<-(sum(int1.ud.sf.hm, int2.ud.sf.hm, int3.ud.sf.hm, int4.ud.sf.hm, int5.ud.sf.hm, int6.ud.sf.hm, int7.ud.sf.hm, int8.ud.sf.hm, int9.ud.sf.hm, int10.ud.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ud.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ud.sf.hm<-e1.ud.sf.hm[order(e1.ud.sf.hm$ID),]
e1.ud.sf.hm<-as.matrix(t(e1.1.ud.sf.hm))

e2.ud.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ud.sf.hm<-e2.ud.sf.hm[order(e2.ud.sf.hm$ID),]
e2.ud.sf.hm<-as.matrix(t(e2.1.ud.sf.hm))

e3.ud.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ud.sf.hm<-e3.ud.sf.hm[order(e3.ud.sf.hm$ID),]
e3.ud.sf.hm<-as.matrix(t(e3.1.ud.sf.hm))

e4.ud.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ud.sf.hm<-e4.ud.sf.hm[order(e4.ud.sf.hm$ID),]
e4.ud.sf.hm<-as.matrix(t(e4.1.ud.sf.hm))

e5.ud.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ud.sf.hm<-e5.ud.sf.hm[order(e5.ud.sf.hm$ID),]
e5.ud.sf.hm<-as.matrix(t(e5.1.ud.sf.hm))

e6.ud.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ud.sf.hm<-e6.ud.sf.hm[order(e6.ud.sf.hm$ID),]
e6.ud.sf.hm<-as.matrix(t(e6.1.ud.sf.hm))

e7.ud.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ud.sf.hm<-e7.ud.sf.hm[order(e7.ud.sf.hm$ID),]
e7.ud.sf.hm<-as.matrix(t(e7.1.ud.sf.hm))

e8.ud.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ud.sf.hm<-e8.ud.sf.hm[order(e8.ud.sf.hm$ID),]
e8.ud.sf.hm<-as.matrix(t(e8.1.ud.sf.hm))

e9.ud.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ud.sf.hm<-e9.ud.sf.hm[order(e9.ud.sf.hm$ID),]
e9.ud.sf.hm<-as.matrix(t(e9.1.ud.sf.hm))

e10.ud.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ud.sf.hm<-e10.ud.sf.hm[order(e10.ud.sf.hm$ID),]
e10.ud.sf.hm<-as.matrix(t(e10.1.ud.sf.hm))

energy.hm.ud.sf.hm<-as.data.frame(matrix(c(e1.ud.sf.hm,e2.ud.sf.hm,e3.ud.sf.hm,e4.ud.sf.hm,e5.ud.sf.hm,e6.ud.sf.hm,e7.ud.sf.hm,e8.ud.sf.hm,e9.ud.sf.hm,e10.ud.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.ud.sf.hm<-data.frame(ID=energy.hm.ud.sf.hm$V1,energy_over_distance=energy.hm.ud.sf.hm$V2,energy_over_time=energy.hm.ud.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ud.sf.hm<-david1.ud.sf.hm[order(david1.ud.sf.hm$ID),]
david1.ud.sf.hm<-as.matrix(t(david1.1.ud.sf.hm))

david2.1.ud.sf.hm<-david2.ud.sf.hm[order(david2.ud.sf.hm$ID),]
david2.ud.sf.hm<-as.matrix(t(david2.1.ud.sf.hm))

david3.1.ud.sf.hm<-david3.ud.sf.hm[order(david3.ud.sf.hm$ID),]
david3.ud.sf.hm<-as.matrix(t(david3.1.ud.sf.hm))

david4.1.ud.sf.hm<-david4.ud.sf.hm[order(david4.ud.sf.hm$ID),]
david4.ud.sf.hm<-as.matrix(t(david4.1.ud.sf.hm))

david5.1.ud.sf.hm<-david5.ud.sf.hm[order(david5.ud.sf.hm$ID),]
david5.ud.sf.hm<-as.matrix(t(david5.1.ud.sf.hm))

david6.1.ud.sf.hm<-david6.ud.sf.hm[order(david6.ud.sf.hm$ID),]
david6.ud.sf.hm<-as.matrix(t(david6.1.ud.sf.hm))

david7.1.ud.sf.hm<-david7.ud.sf.hm[order(david7.ud.sf.hm$ID),]
david7.ud.sf.hm<-as.matrix(t(david7.1.ud.sf.hm))

david8.1.ud.sf.hm<-david8.ud.sf.hm[order(david8.ud.sf.hm$ID),]
david8.ud.sf.hm<-as.matrix(t(david8.1.ud.sf.hm))

david9.1.ud.sf.hm<-david9.ud.sf.hm[order(david9.ud.sf.hm$ID),]
david9.ud.sf.hm<-as.matrix(t(david9.1.ud.sf.hm))

david10.1.ud.sf.hm<-david10.ud.sf.hm[order(david10.ud.sf.hm$ID),]
david10.ud.sf.hm<-as.matrix(t(david10.1.ud.sf.hm))

david.hm.ud.sf.hm<-as.data.frame(matrix(c(david1.ud.sf.hm,david2.ud.sf.hm,david3.ud.sf.hm,david4.ud.sf.hm,david5.ud.sf.hm,david6.ud.sf.hm,david7.ud.sf.hm,david8.ud.sf.hm,david9.ud.sf.hm,david10.ud.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.ud.sf.hm<-data.frame(ID=david.hm.ud.sf.hm$V1,DS=david.hm.ud.sf.hm$V2,normDS=david.hm.ud.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.ud.sf.hm<-lm(e1.1.ud.sf.hm$energy_over_time~as.numeric(david1.1.ud.sf.hm$normDS))
hm.lm.1.s.ud.sf.hm<-summary(lm.hm.1.ud.sf.hm)$coefficients
hm.1.slope.ud.sf.hm<-hm.lm.1.s.ud.sf.hm[2,1]
lm.hm.2.ud.sf.hm<-lm(e2.1.ud.sf.hm$energy_over_time~as.numeric(david2.1.ud.sf.hm$normDS))
hm.lm.2.s.ud.sf.hm<-summary(lm.hm.2.ud.sf.hm)$coefficients
hm.2.slope.ud.sf.hm<-hm.lm.2.s.ud.sf.hm[2,1]
lm.hm.3.ud.sf.hm<-lm(e3.1.ud.sf.hm$energy_over_time~as.numeric(david3.1.ud.sf.hm$normDS))
hm.lm.3.s.ud.sf.hm<-summary(lm.hm.3.ud.sf.hm)$coefficients
hm.3.slope.ud.sf.hm<-hm.lm.3.s.ud.sf.hm[2,1]
lm.hm.4.ud.sf.hm<-lm(e4.1.ud.sf.hm$energy_over_time~as.numeric(david4.1.ud.sf.hm$normDS))
hm.lm.4.s.ud.sf.hm<-summary(lm.hm.4.ud.sf.hm)$coefficients
hm.4.slope.ud.sf.hm<-hm.lm.4.s.ud.sf.hm[2,1]
lm.hm.5.ud.sf.hm<-lm(e5.1.ud.sf.hm$energy_over_time~as.numeric(david5.1.ud.sf.hm$normDS))
hm.lm.5.s.ud.sf.hm<-summary(lm.hm.5.ud.sf.hm)$coefficients
hm.5.slope.ud.sf.hm<-hm.lm.5.s.ud.sf.hm[2,1]
lm.hm.6.ud.sf.hm<-lm(e6.1.ud.sf.hm$energy_over_time~as.numeric(david6.1.ud.sf.hm$normDS))
hm.lm.6.s.ud.sf.hm<-summary(lm.hm.6.ud.sf.hm)$coefficients
hm.6.slope.ud.sf.hm<-hm.lm.6.s.ud.sf.hm[2,1]
lm.hm.7.ud.sf.hm<-lm(e7.1.ud.sf.hm$energy_over_time~as.numeric(david7.1.ud.sf.hm$normDS))
hm.lm.7.s.ud.sf.hm<-summary(lm.hm.7.ud.sf.hm)$coefficients
hm.7.slope.ud.sf.hm<-hm.lm.7.s.ud.sf.hm[2,1]
lm.hm.8.ud.sf.hm<-lm(e8.1.ud.sf.hm$energy_over_time~as.numeric(david8.1.ud.sf.hm$normDS))
hm.lm.8.s.ud.sf.hm<-summary(lm.hm.8.ud.sf.hm)$coefficients
hm.8.slope.ud.sf.hm<-hm.lm.8.s.ud.sf.hm[2,1]
lm.hm.9.ud.sf.hm<-lm(e9.1.ud.sf.hm$energy_over_time~as.numeric(david9.1.ud.sf.hm$normDS))
hm.lm.9.s.ud.sf.hm<-summary(lm.hm.9.ud.sf.hm)$coefficients
hm.9.slope.ud.sf.hm<-hm.lm.9.s.ud.sf.hm[2,1]
lm.hm.10.ud.sf.hm<-lm(e10.1.ud.sf.hm$energy_over_time~as.numeric(david10.1.ud.sf.hm$normDS))
hm.lm.10.s.ud.sf.hm<-summary(lm.hm.10.ud.sf.hm)$coefficients
hm.10.slope.ud.sf.hm<-hm.lm.10.s.ud.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.ud.sf.ss<-data.frame(triangle.transitivity=c(tri1.ud.sf.hm,tri2.ud.sf.hm,tri3.ud.sf.hm,tri4.ud.sf.hm,tri5.ud.sf.hm,tri6.ud.sf.hm,tri7.ud.sf.hm,tri8.ud.sf.hm,tri9.ud.sf.hm,tri10.ud.sf.hm),escalation=c(ep1.ud.sf.hm,ep2.ud.sf.hm,ep3.ud.sf.hm,ep4.ud.sf.hm,ep5.ud.sf.hm,ep6.ud.sf.hm,ep7.ud.sf.hm,ep8.ud.sf.hm,ep9.ud.sf.hm,ep10.ud.sf.hm),dci=c(dci1.ud.sf.hm,dci2.ud.sf.hm,dci3.ud.sf.hm,dci4.ud.sf.hm,dci5.ud.sf.hm,dci6.ud.sf.hm,dci7.ud.sf.hm,dci8.ud.sf.hm,dci9.ud.sf.hm,dci10.ud.sf.hm),steepness=c(s1.ud.sf.hm,s2.ud.sf.hm,s3.ud.sf.hm,s4.ud.sf.hm,s5.ud.sf.hm,s6.ud.sf.hm,s7.ud.sf.hm,s8.ud.sf.hm,s9.ud.sf.hm,s10.ud.sf.hm),slope=c(hm.1.slope.ud.sf.hm,hm.2.slope.ud.sf.hm,hm.3.slope.ud.sf.hm,hm.4.slope.ud.sf.hm,hm.5.slope.ud.sf.hm,hm.6.slope.ud.sf.hm,hm.7.slope.ud.sf.hm,hm.8.slope.ud.sf.hm,hm.9.slope.ud.sf.hm,hm.10.slope.ud.sf.hm))


```
```{r Uniform Deterministic Data Frame}
# Generate energy data frame:
total.energy.du.sf<-data.frame(energy.km.df.ud.sf.km)
total.energy.du.sf<-rbind(total.energy.du.sf,energy.hm.df.ud.sf.hm)

total.david.du.sf<-data.frame(david.km.df.ud.sf.km)
total.david.du.sf<-rbind(total.david.du.sf,david.hm.df.ud.sf.hm)

total.energy.du.sf<-cbind(total.energy.du.sf,normDS=total.david.du.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.du.sf<-mean(km.ud.sf.ss$triangle.transitivity)
  km.du.sfi.du.sf<-mean(km.ud.sf.ss$dci)
  km.esc.du.sf<-mean(km.ud.sf.ss$escalation)
  km.steep.du.sf<-mean(km.ud.sf.ss$steepness)
  km.slope.du.sf<-mean(km.ud.sf.ss$slope)
  km.mean.du.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.du.sf,dci=km.du.sfi.du.sf,esc=km.esc.du.sf,steepness=km.steep.du.sf,slope=km.slope.du.sf,dist="Uniform",calc="deterministic")


  # history mutual
  hm.tt.du.sf<-mean(hm.ud.sf.ss$triangle.transitivity)
  hm.du.sfi.du.sf<-mean(hm.ud.sf.ss$dci)
  hm.esc.du.sf<-mean(hm.ud.sf.ss$escalation)
  hm.steep.du.sf<-mean(hm.ud.sf.ss$steepness)
  hm.slope.du.sf<-mean(hm.ud.sf.ss$slope)
  hm.mean.du.sf<-data.frame(scenario="History Mutual",tt=hm.tt.du.sf,dci=hm.du.sfi.du.sf,esc=hm.esc.du.sf,steepness=hm.steep.du.sf,slope=hm.slope.du.sf,dist="Uniform",calc="deterministic")



# Data frame of all averages
dc.ave<-rbind(km.mean.du.sf,hm.mean.du.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.du.sf<-mean(km.ud.sf.ss$triangle.transitivity)
  km.du.sfi.du.sf<-mean(km.ud.sf.ss$dci)
  km.esc.du.sf<-mean(km.ud.sf.ss$escalation)
  km.steep.du.sf<-mean(km.ud.sf.ss$steepness)
  km.slope.du.sf<-mean(km.ud.sf.ss$slope)
  km.mean.du.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.du.sf,dci=km.du.sfi.du.sf,esc=km.esc.du.sf,steepness=km.steep.du.sf,slope=km.slope.du.sf,dist="Uniform",calc="deterministic")
  
  #history mutual
  hm.tt.du.sf<-mean(hm.ud.sf.ss$triangle.transitivity)
  hm.du.sfi.du.sf<-mean(hm.ud.sf.ss$dci)
  hm.esc.du.sf<-mean(hm.ud.sf.ss$escalation)
  hm.steep.du.sf<-mean(hm.ud.sf.ss$steepness)
  hm.slope.du.sf<-mean(hm.ud.sf.ss$slope)
  hm.mean.du.sf<-data.frame(scenario="History Mutual",tt=hm.tt.du.sf,dci=hm.du.sfi.du.sf,esc=hm.esc.du.sf,steepness=hm.steep.du.sf,slope=hm.slope.du.sf,dist="Uniform",calc="deterministic")
  
# Generate data frame for all averages:
dc.ave<-rbind(km.mean.du.sf,hm.mean.du.sf)

# Create overall dataframe of summary statistics:
overall.unif.sf.deter.sf<-data.frame(km.ud.sf.ss)
overall.unif.sf.deter.sf<-rbind(overall.unif.sf.deter.sf,hm.ud.sf.ss)

overall.unif.sf.deter.sf<-cbind(overall.unif.sf.deter.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.unif.sf.deter.sf<-cbind(overall.unif.sf.deter.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("deter",20))


rhp.ud.sf.ss<-overall.unif.sf.deter.sf[overall.unif.sf.deter.sf$variable=="rhp",]
history.ud.sf.ss<-overall.unif.sf.deter.sf[overall.unif.sf.deter.sf$variable=="history",]

overall.unif.sf.deter.sf$combo<-paste(overall.unif.sf.deter.sf$strategy,overall.unif.sf.deter.sf$variable,overall.unif.sf.deter.sf$distribution)
overall.unif.sf.deter.sf$combo2<-paste(overall.unif.sf.deter.sf$strategy,overall.unif.sf.deter.sf$variable) #final dataframe for deterministic Uniform data
```

## Avoids Uniform Deterministic Data
```{r Avoids Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ud.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aud.km<-data.frame(X1=avoid.ud.sf.km[[1]],X2=avoid.ud.sf.km[[2]],Avoids=avoid.ud.sf.km[[3]])
mat1.aud.km<-avoid.inter.mat(mut1.aud.km)
tri1.aud.km<-tr.tri(mat1.aud.km)
dci1.aud.km<-DCindex(mat1.aud.km)
mat1.aud.km[is.na(mat1.aud.km)] = 0
h1.aud.km<-h.index(mat1.aud.km)

ep1.aud.km<-ep(mut1.aud.km,a1.ud.sf.km)
david1.aud.km<-DS(mat1.aud.km) #David's Scores - for steepness use normDS output
ordrank.1.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aud.km<-cbind(ordrank.1.aud.km,ds=david1.aud.km$normDS)
lm1.aud.km<-summary(lm(ordrank.1.aud.km$ds~ordrank.1.aud.km$ord.rank))
s1.aud.km<-lm1.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aud.km<-data.frame(X1=avoid.ud.sf.km[[4]],X2=avoid.ud.sf.km[[5]],Avoids=avoid.ud.sf.km[[6]])
mat2.aud.km<-avoid.inter.mat(mut2.aud.km)
tri2.aud.km<-tr.tri(mat2.aud.km)
dci2.aud.km<-DCindex(mat2.aud.km)
mat2.aud.km[is.na(mat2.aud.km)] = 0
h2.aud.km<-h.index(mat2.aud.km)

ep2.aud.km<-ep(mut2.aud.km,a2.ud.sf.km)
david2.aud.km<-DS(mat2.aud.km) #David's Scores - for steepness use normDS output
ordrank.2.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aud.km<-cbind(ordrank.2.aud.km,ds=david2.aud.km$normDS)
lm2.aud.km<-summary(lm(ordrank.2.aud.km$ds~ordrank.2.aud.km$ord.rank))
s2.aud.km<-lm2.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aud.km<-data.frame(X1=avoid.ud.sf.km[[7]],X2=avoid.ud.sf.km[[8]],Avoids=avoid.ud.sf.km[[9]])
mat3.aud.km<-avoid.inter.mat(mut3.aud.km)
tri3.aud.km<-tr.tri(mat3.aud.km)
dci3.aud.km<-DCindex(mat3.aud.km)
mat3.aud.km[is.na(mat3.aud.km)] = 0
h3.aud.km<-h.index(mat3.aud.km)

ep3.aud.km<-ep(mut3.aud.km,a3.ud.sf.km)
david3.aud.km<-DS(mat3.aud.km) #David's Scores - for steepness use normDS output
ordrank.3.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aud.km<-cbind(ordrank.3.aud.km,ds=david3.aud.km$normDS)
lm3.aud.km<-summary(lm(ordrank.3.aud.km$ds~ordrank.3.aud.km$ord.rank))
s3.aud.km<-lm3.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aud.km<-data.frame(X1=avoid.ud.sf.km[[10]],X2=avoid.ud.sf.km[[11]],Avoids=avoid.ud.sf.km[[12]])
mat4.aud.km<-avoid.inter.mat(mut4.aud.km)
tri4.aud.km<-tr.tri(mat4.aud.km)
dci4.aud.km<-DCindex(mat4.aud.km)
mat4.aud.km[is.na(mat4.aud.km)] = 0
h4.aud.km<-h.index(mat4.aud.km)

ep4.aud.km<-ep(mut4.aud.km,a4.ud.sf.km)
david4.aud.km<-DS(mat4.aud.km) #David's Scores - for steepness use normDS output
ordrank.4.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aud.km<-cbind(ordrank.4.aud.km,ds=david4.aud.km$normDS)
lm4.aud.km<-summary(lm(ordrank.4.aud.km$ds~ordrank.4.aud.km$ord.rank))
s4.aud.km<-lm4.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aud.km<-data.frame(X1=avoid.ud.sf.km[[13]],X2=avoid.ud.sf.km[[14]],Avoids=avoid.ud.sf.km[[15]])
mat5.aud.km<-avoid.inter.mat(mut5.aud.km)
tri5.aud.km<-tr.tri(mat5.aud.km)
dci5.aud.km<-DCindex(mat5.aud.km)
mat5.aud.km[is.na(mat5.aud.km)] = 0
h5.aud.km<-h.index(mat5.aud.km)

ep5.aud.km<-ep(mut5.aud.km,a5.ud.sf.km)
david5.aud.km<-DS(mat5.aud.km) #David's Scores - for steepness use normDS output
ordrank.5.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aud.km<-cbind(ordrank.5.aud.km,ds=david5.aud.km$normDS)
lm5.aud.km<-summary(lm(ordrank.5.aud.km$ds~ordrank.5.aud.km$ord.rank))
s5.aud.km<-lm5.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aud.km<-data.frame(X1=avoid.ud.sf.km[[16]],X2=avoid.ud.sf.km[[17]],Avoids=avoid.ud.sf.km[[18]])
mat6.aud.km<-avoid.inter.mat(mut6.aud.km)
tri6.aud.km<-tr.tri(mat6.aud.km)
dci6.aud.km<-DCindex(mat6.aud.km)
mat6.aud.km[is.na(mat6.aud.km)] = 0
h6.aud.km<-h.index(mat6.aud.km)

ep6.aud.km<-ep(mut6.aud.km,a6.ud.sf.km)
david6.aud.km<-DS(mat6.aud.km) #David's Scores - for steepness use normDS output
ordrank.6.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aud.km<-cbind(ordrank.6.aud.km,ds=david6.aud.km$normDS)
lm6.aud.km<-summary(lm(ordrank.6.aud.km$ds~ordrank.6.aud.km$ord.rank))
s6.aud.km<-lm6.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aud.km<-data.frame(X1=avoid.ud.sf.km[[19]],X2=avoid.ud.sf.km[[20]],Avoids=avoid.ud.sf.km[[21]])
mat7.aud.km<-avoid.inter.mat(mut7.aud.km)
tri7.aud.km<-tr.tri(mat7.aud.km)
dci7.aud.km<-DCindex(mat7.aud.km)
mat7.aud.km[is.na(mat7.aud.km)] = 0
h7.aud.km<-h.index(mat7.aud.km)

ep7.aud.km<-ep(mut7.aud.km,a7.ud.sf.km)
david7.aud.km<-DS(mat7.aud.km) #David's Scores - for steepness use normDS output
ordrank.7.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aud.km<-cbind(ordrank.7.aud.km,ds=david7.aud.km$normDS)
lm7.aud.km<-summary(lm(ordrank.7.aud.km$ds~ordrank.7.aud.km$ord.rank))
s7.aud.km<-lm7.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aud.km<-data.frame(X1=avoid.ud.sf.km[[22]],X2=avoid.ud.sf.km[[23]],Avoids=avoid.ud.sf.km[[24]])
mat8.aud.km<-avoid.inter.mat(mut8.aud.km)
tri8.aud.km<-tr.tri(mat8.aud.km)
dci8.aud.km<-DCindex(mat8.aud.km)
mat8.aud.km[is.na(mat8.aud.km)] = 0
h8.aud.km<-h.index(mat8.aud.km)

ep8.aud.km<-ep(mut8.aud.km,a8.ud.sf.km)
david8.aud.km<-DS(mat8.aud.km) #David's Scores - for steepness use normDS output
ordrank.8.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aud.km<-cbind(ordrank.8.aud.km,ds=david8.aud.km$normDS)
lm8.aud.km<-summary(lm(ordrank.8.aud.km$ds~ordrank.8.aud.km$ord.rank))
s8.aud.km<-lm8.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aud.km<-data.frame(X1=avoid.ud.sf.km[[25]],X2=avoid.ud.sf.km[[26]],Avoids=avoid.ud.sf.km[[27]])
mat9.aud.km<-avoid.inter.mat(mut9.aud.km)
tri9.aud.km<-tr.tri(mat9.aud.km)
dci9.aud.km<-DCindex(mat9.aud.km)
mat9.aud.km[is.na(mat9.aud.km)] = 0
h9.aud.km<-h.index(mat9.aud.km)

ep9.aud.km<-ep(mut9.aud.km,a9.ud.sf.km)
david9.aud.km<-DS(mat9.aud.km) #David's Scores - for steepness use normDS output
ordrank.9.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aud.km<-cbind(ordrank.9.aud.km,ds=david9.aud.km$normDS)
lm9.aud.km<-summary(lm(ordrank.9.aud.km$ds~ordrank.9.aud.km$ord.rank))
s9.aud.km<-lm9.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aud.km<-data.frame(X1=avoid.ud.sf.km[[28]],X2=avoid.ud.sf.km[[29]],Avoids=avoid.ud.sf.km[[30]])
mat10.aud.km<-avoid.inter.mat(mut10.aud.km)
tri10.aud.km<-tr.tri(mat10.aud.km)
dci10.aud.km<-DCindex(mat10.aud.km)
mat10.aud.km[is.na(mat10.aud.km)] = 0
h10.aud.km<-h.index(mat10.aud.km)

ep10.aud.km<-ep(mut10.aud.km,a10.ud.sf.km)
david10.aud.km<-DS(mat10.aud.km) #David's Scores - for steepness use normDS output
ordrank.10.aud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aud.km<-cbind(ordrank.10.aud.km,ds=david10.aud.km$normDS)
lm10.aud.km<-summary(lm(ordrank.10.aud.km$ds~ordrank.10.aud.km$ord.rank))
s10.aud.km<-lm10.aud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aud.km<-sum(mut1.aud.km$Victories)
int2.aud.km<-sum(mut2.aud.km$Victories)
int3.aud.km<-sum(mut3.aud.km$Victories)
int4.aud.km<-sum(mut4.aud.km$Victories)
int5.aud.km<-sum(mut5.aud.km$Victories)
int6.aud.km<-sum(mut6.aud.km$Victories)
int7.aud.km<-sum(mut7.aud.km$Victories)
int8.aud.km<-sum(mut8.aud.km$Victories)
int9.aud.km<-sum(mut9.aud.km$Victories)
int10.aud.km<-sum(mut10.aud.km$Victories)

  # Summarize the avoidances in each trial:
av1.aud.km<-sum(a1.ud.sf.km$Avoids)
av2.aud.km<-sum(a2.ud.sf.km$Avoids)
av3.aud.km<-sum(a3.ud.sf.km$Avoids)
av4.aud.km<-sum(a4.ud.sf.km$Avoids)
av5.aud.km<-sum(a5.ud.sf.km$Avoids)
av6.aud.km<-sum(a6.ud.sf.km$Avoids)
av7.aud.km<-sum(a7.ud.sf.km$Avoids)
av8.aud.km<-sum(a8.ud.sf.km$Avoids)
av9.aud.km<-sum(a9.ud.sf.km$Avoids)
av10.aud.km<-sum(a10.ud.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.adu<-(sum(av1.aud.km, av2.aud.km, av3.aud.km, av4.aud.km, av5.aud.km, av6.aud.km, av7.aud.km, av8.aud.km, av9.aud.km, av10.aud.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.adu<-(sum(int1.aud.km, int2.aud.km, int3.aud.km, int4.aud.km, int5.aud.km, int6.aud.km, int7.aud.km, int8.aud.km, int9.aud.km, int10.aud.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aud.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aud.km<-e1.aud.km[order(e1.aud.km$ID),]
e1.aud.km<-as.matrix(t(e1.1.aud.km))

e2.aud.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aud.km<-e2.aud.km[order(e2.aud.km$ID),]
e2.aud.km<-as.matrix(t(e2.1.aud.km))

e3.aud.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aud.km<-e3.aud.km[order(e3.aud.km$ID),]
e3.aud.km<-as.matrix(t(e3.1.aud.km))

e4.aud.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aud.km<-e4.aud.km[order(e4.aud.km$ID),]
e4.aud.km<-as.matrix(t(e4.1.aud.km))

e5.aud.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aud.km<-e5.aud.km[order(e5.aud.km$ID),]
e5.aud.km<-as.matrix(t(e5.1.aud.km))

e6.aud.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aud.km<-e6.aud.km[order(e6.aud.km$ID),]
e6.aud.km<-as.matrix(t(e6.1.aud.km))

e7.aud.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aud.km<-e7.aud.km[order(e7.aud.km$ID),]
e7.aud.km<-as.matrix(t(e7.1.aud.km))

e8.aud.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aud.km<-e8.aud.km[order(e8.aud.km$ID),]
e8.aud.km<-as.matrix(t(e8.1.aud.km))

e9.aud.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aud.km<-e9.aud.km[order(e9.aud.km$ID),]
e9.aud.km<-as.matrix(t(e9.1.aud.km))

e10.aud.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aud.km<-e10.aud.km[order(e10.aud.km$ID),]
e10.aud.km<-as.matrix(t(e10.1.aud.km))

energy.km.aud.km<-as.data.frame(matrix(c(e1.aud.km,e2.aud.km,e3.aud.km,e4.aud.km,e5.aud.km,e6.aud.km,e7.aud.km,e8.aud.km,e9.aud.km,e10.aud.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aud.km<-data.frame(ID=energy.km.aud.km$V1,energy_over_distance=energy.km.aud.km$V2,energy_over_time=energy.km.aud.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aud.km<-david1.aud.km[order(david1.aud.km$ID),]
david1.aud.km<-as.matrix(t(david1.1.aud.km))

david2.1.aud.km<-david2.aud.km[order(david2.aud.km$ID),]
david2.aud.km<-as.matrix(t(david2.1.aud.km))

david3.1.aud.km<-david3.aud.km[order(david3.aud.km$ID),]
david3.aud.km<-as.matrix(t(david3.1.aud.km))

david4.1.aud.km<-david4.aud.km[order(david4.aud.km$ID),]
david4.aud.km<-as.matrix(t(david4.1.aud.km))

david5.1.aud.km<-david5.aud.km[order(david5.aud.km$ID),]
david5.aud.km<-as.matrix(t(david5.1.aud.km))

david6.1.aud.km<-david6.aud.km[order(david6.aud.km$ID),]
david6.aud.km<-as.matrix(t(david6.1.aud.km))

david7.1.aud.km<-david7.aud.km[order(david7.aud.km$ID),]
david7.aud.km<-as.matrix(t(david7.1.aud.km))

david8.1.aud.km<-david8.aud.km[order(david8.aud.km$ID),]
david8.aud.km<-as.matrix(t(david8.1.aud.km))

david9.1.aud.km<-david9.aud.km[order(david9.aud.km$ID),]
david9.aud.km<-as.matrix(t(david9.1.aud.km))

david10.1.aud.km<-david10.aud.km[order(david10.aud.km$ID),]
david10.aud.km<-as.matrix(t(david10.1.aud.km))

david.km.aud.km<-as.data.frame(matrix(c(david1.aud.km,david2.aud.km,david3.aud.km,david4.aud.km,david5.aud.km,david6.aud.km,david7.aud.km,david8.aud.km,david9.aud.km,david10.aud.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aud.km<-data.frame(ID=david.km.aud.km$V1,DS=david.km.aud.km$V2,normDS=david.km.aud.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aud.km<-lm(e1.1.aud.km$energy_over_time~as.numeric(david1.1.aud.km$normDS))
km.lm.1.s.aud.km<-summary(lm.km.1.aud.km)$coefficients
km.1.slope.aud.km<-km.lm.1.s.aud.km[2,1]
lm.km.2.aud.km<-lm(e2.1.aud.km$energy_over_time~as.numeric(david2.1.aud.km$normDS))
km.lm.2.s.aud.km<-summary(lm.km.2.aud.km)$coefficients
km.2.slope.aud.km<-km.lm.2.s.aud.km[2,1]
lm.km.3.aud.km<-lm(e3.1.aud.km$energy_over_time~as.numeric(david3.1.aud.km$normDS))
km.lm.3.s.aud.km<-summary(lm.km.3.aud.km)$coefficients
km.3.slope.aud.km<-km.lm.3.s.aud.km[2,1]
lm.km.4.aud.km<-lm(e4.1.aud.km$energy_over_time~as.numeric(david4.1.aud.km$normDS))
km.lm.4.s.aud.km<-summary(lm.km.4.aud.km)$coefficients
km.4.slope.aud.km<-km.lm.4.s.aud.km[2,1]
lm.km.5.aud.km<-lm(e5.1.aud.km$energy_over_time~as.numeric(david5.1.aud.km$normDS))
km.lm.5.s.aud.km<-summary(lm.km.5.aud.km)$coefficients
km.5.slope.aud.km<-km.lm.5.s.aud.km[2,1]
lm.km.6.aud.km<-lm(e6.1.aud.km$energy_over_time~as.numeric(david6.1.aud.km$normDS))
km.lm.6.s.aud.km<-summary(lm.km.6.aud.km)$coefficients
km.6.slope.aud.km<-km.lm.6.s.aud.km[2,1]
lm.km.7.aud.km<-lm(e7.1.aud.km$energy_over_time~as.numeric(david7.1.aud.km$normDS))
km.lm.7.s.aud.km<-summary(lm.km.7.aud.km)$coefficients
km.7.slope.aud.km<-km.lm.7.s.aud.km[2,1]
lm.km.8.aud.km<-lm(e8.1.aud.km$energy_over_time~as.numeric(david8.1.aud.km$normDS))
km.lm.8.s.aud.km<-summary(lm.km.8.aud.km)$coefficients
km.8.slope.aud.km<-km.lm.8.s.aud.km[2,1]
lm.km.9.aud.km<-lm(e9.1.aud.km$energy_over_time~as.numeric(david9.1.aud.km$normDS))
km.lm.9.s.aud.km<-summary(lm.km.9.aud.km)$coefficients
km.9.slope.aud.km<-km.lm.9.s.aud.km[2,1]
lm.km.10.aud.km<-lm(e10.1.aud.km$energy_over_time~as.numeric(david10.1.aud.km$normDS))
km.lm.10.s.aud.km<-summary(lm.km.10.aud.km)$coefficients
km.10.slope.aud.km<-km.lm.10.s.aud.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aud.ss.avoid.ud.sf.km<-data.frame(triangle.transitivity=c(tri1.aud.km,tri2.aud.km,tri3.aud.km,tri4.aud.km,tri5.aud.km,tri6.aud.km,tri7.aud.km,tri8.aud.km,tri9.aud.km,tri10.aud.km),escalation=c(ep1.aud.km,ep2.aud.km,ep3.aud.km,ep4.aud.km,ep5.aud.km,ep6.aud.km,ep7.aud.km,ep8.aud.km,ep9.aud.km,ep10.aud.km),dci=c(dci1.aud.km,dci2.aud.km,dci3.aud.km,dci4.aud.km,dci5.aud.km,dci6.aud.km,dci7.aud.km,dci8.aud.km,dci9.aud.km,dci10.aud.km),steepness=c(s1.aud.km,s2.aud.km,s3.aud.km,s4.aud.km,s5.aud.km,s6.aud.km,s7.aud.km,s8.aud.km,s9.aud.km,s10.aud.km),slope=c(km.1.slope.aud.km,km.2.slope.aud.km,km.3.slope.aud.km,km.4.slope.aud.km,km.5.slope.aud.km,km.6.slope.aud.km,km.7.slope.aud.km,km.8.slope.aud.km,km.9.slope.aud.km,km.10.slope.aud.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ud.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[1]],X2=avoid.ud.sf.hm[[2]],Avoids=avoid.ud.sf.hm[[3]])
mat1.aud.hm<-avoid.inter.mat(mut1.aud.hm)
tri1.aud.hm<-tr.tri(mat1.aud.hm)
dci1.aud.hm<-DCindex(mat1.aud.hm)
mat1.aud.hm[is.na(mat1.aud.hm)] = 0
h1.aud.hm<-h.index(mat1.aud.hm)

ep1.aud.hm<-ep(mut1.aud.hm,a1.ud.sf.hm)
david1.aud.hm<-DS(mat1.aud.hm) #David's Scores - for steepness use normDS output
ordrank.1.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aud.hm<-cbind(ordrank.1.aud.hm,ds=david1.aud.hm$normDS)
lm1.aud.hm<-summary(lm(ordrank.1.aud.hm$ds~ordrank.1.aud.hm$ord.rank))
s1.aud.hm<-lm1.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[4]],X2=avoid.ud.sf.hm[[5]],Avoids=avoid.ud.sf.hm[[6]])
mat2.aud.hm<-avoid.inter.mat(mut2.aud.hm)
tri2.aud.hm<-tr.tri(mat2.aud.hm)
dci2.aud.hm<-DCindex(mat2.aud.hm)
mat2.aud.hm[is.na(mat2.aud.hm)] = 0
h2.aud.hm<-h.index(mat2.aud.hm)

ep2.aud.hm<-ep(mut2.aud.hm,a2.ud.sf.hm)
david2.aud.hm<-DS(mat2.aud.hm) #David's Scores - for steepness use normDS output
ordrank.2.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aud.hm<-cbind(ordrank.2.aud.hm,ds=david2.aud.hm$normDS)
lm2.aud.hm<-summary(lm(ordrank.2.aud.hm$ds~ordrank.2.aud.hm$ord.rank))
s2.aud.hm<-lm2.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[7]],X2=avoid.ud.sf.hm[[8]],Avoids=avoid.ud.sf.hm[[9]])
mat3.aud.hm<-avoid.inter.mat(mut3.aud.hm)
tri3.aud.hm<-tr.tri(mat3.aud.hm)
dci3.aud.hm<-DCindex(mat3.aud.hm)
mat3.aud.hm[is.na(mat3.aud.hm)] = 0
h3.aud.hm<-h.index(mat3.aud.hm)

ep3.aud.hm<-ep(mut3.aud.hm,a3.ud.sf.hm)
david3.aud.hm<-DS(mat3.aud.hm) #David's Scores - for steepness use normDS output
ordrank.3.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aud.hm<-cbind(ordrank.3.aud.hm,ds=david3.aud.hm$normDS)
lm3.aud.hm<-summary(lm(ordrank.3.aud.hm$ds~ordrank.3.aud.hm$ord.rank))
s3.aud.hm<-lm3.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[10]],X2=avoid.ud.sf.hm[[11]],Avoids=avoid.ud.sf.hm[[12]])
mat4.aud.hm<-avoid.inter.mat(mut4.aud.hm)
tri4.aud.hm<-tr.tri(mat4.aud.hm)
dci4.aud.hm<-DCindex(mat4.aud.hm)
mat4.aud.hm[is.na(mat4.aud.hm)] = 0
h4.aud.hm<-h.index(mat4.aud.hm)

ep4.aud.hm<-ep(mut4.aud.hm,a4.ud.sf.hm)
david4.aud.hm<-DS(mat4.aud.hm) #David's Scores - for steepness use normDS output
ordrank.4.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aud.hm<-cbind(ordrank.4.aud.hm,ds=david4.aud.hm$normDS)
lm4.aud.hm<-summary(lm(ordrank.4.aud.hm$ds~ordrank.4.aud.hm$ord.rank))
s4.aud.hm<-lm4.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[13]],X2=avoid.ud.sf.hm[[14]],Avoids=avoid.ud.sf.hm[[15]])
mat5.aud.hm<-avoid.inter.mat(mut5.aud.hm)
tri5.aud.hm<-tr.tri(mat5.aud.hm)
dci5.aud.hm<-DCindex(mat5.aud.hm)
mat5.aud.hm[is.na(mat5.aud.hm)] = 0
h5.aud.hm<-h.index(mat5.aud.hm)

ep5.aud.hm<-ep(mut5.aud.hm,a5.ud.sf.hm)
david5.aud.hm<-DS(mat5.aud.hm) #David's Scores - for steepness use normDS output
ordrank.5.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aud.hm<-cbind(ordrank.5.aud.hm,ds=david5.aud.hm$normDS)
lm5.aud.hm<-summary(lm(ordrank.5.aud.hm$ds~ordrank.5.aud.hm$ord.rank))
s5.aud.hm<-lm5.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[16]],X2=avoid.ud.sf.hm[[17]],Avoids=avoid.ud.sf.hm[[18]])
mat6.aud.hm<-avoid.inter.mat(mut6.aud.hm)
tri6.aud.hm<-tr.tri(mat6.aud.hm)
dci6.aud.hm<-DCindex(mat6.aud.hm)
mat6.aud.hm[is.na(mat6.aud.hm)] = 0
h6.aud.hm<-h.index(mat6.aud.hm)

ep6.aud.hm<-ep(mut6.aud.hm,a6.ud.sf.hm)
david6.aud.hm<-DS(mat6.aud.hm) #David's Scores - for steepness use normDS output
ordrank.6.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aud.hm<-cbind(ordrank.6.aud.hm,ds=david6.aud.hm$normDS)
lm6.aud.hm<-summary(lm(ordrank.6.aud.hm$ds~ordrank.6.aud.hm$ord.rank))
s6.aud.hm<-lm6.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[19]],X2=avoid.ud.sf.hm[[20]],Avoids=avoid.ud.sf.hm[[21]])
mat7.aud.hm<-avoid.inter.mat(mut7.aud.hm)
tri7.aud.hm<-tr.tri(mat7.aud.hm)
dci7.aud.hm<-DCindex(mat7.aud.hm)
mat7.aud.hm[is.na(mat7.aud.hm)] = 0
h7.aud.hm<-h.index(mat7.aud.hm)

ep7.aud.hm<-ep(mut7.aud.hm,a7.ud.sf.hm)
david7.aud.hm<-DS(mat7.aud.hm) #David's Scores - for steepness use normDS output
ordrank.7.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aud.hm<-cbind(ordrank.7.aud.hm,ds=david7.aud.hm$normDS)
lm7.aud.hm<-summary(lm(ordrank.7.aud.hm$ds~ordrank.7.aud.hm$ord.rank))
s7.aud.hm<-lm7.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[22]],X2=avoid.ud.sf.hm[[23]],Avoids=avoid.ud.sf.hm[[24]])
mat8.aud.hm<-avoid.inter.mat(mut8.aud.hm)
tri8.aud.hm<-tr.tri(mat8.aud.hm)
dci8.aud.hm<-DCindex(mat8.aud.hm)
mat8.aud.hm[is.na(mat8.aud.hm)] = 0
h8.aud.hm<-h.index(mat8.aud.hm)

ep8.aud.hm<-ep(mut8.aud.hm,a8.ud.sf.hm)
david8.aud.hm<-DS(mat8.aud.hm) #David's Scores - for steepness use normDS output
ordrank.8.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aud.hm<-cbind(ordrank.8.aud.hm,ds=david8.aud.hm$normDS)
lm8.aud.hm<-summary(lm(ordrank.8.aud.hm$ds~ordrank.8.aud.hm$ord.rank))
s8.aud.hm<-lm8.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[25]],X2=avoid.ud.sf.hm[[26]],Avoids=avoid.ud.sf.hm[[27]])
mat9.aud.hm<-avoid.inter.mat(mut9.aud.hm)
tri9.aud.hm<-tr.tri(mat9.aud.hm)
dci9.aud.hm<-DCindex(mat9.aud.hm)
mat9.aud.hm[is.na(mat9.aud.hm)] = 0
h9.aud.hm<-h.index(mat9.aud.hm)

ep9.aud.hm<-ep(mut9.aud.hm,a9.ud.sf.hm)
david9.aud.hm<-DS(mat9.aud.hm) #David's Scores - for steepness use normDS output
ordrank.9.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aud.hm<-cbind(ordrank.9.aud.hm,ds=david9.aud.hm$normDS)
lm9.aud.hm<-summary(lm(ordrank.9.aud.hm$ds~ordrank.9.aud.hm$ord.rank))
s9.aud.hm<-lm9.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aud.hm<-data.frame(X1=avoid.ud.sf.hm[[28]],X2=avoid.ud.sf.hm[[29]],Avoids=avoid.ud.sf.hm[[30]])
mat10.aud.hm<-avoid.inter.mat(mut10.aud.hm)
tri10.aud.hm<-tr.tri(mat10.aud.hm)
dci10.aud.hm<-DCindex(mat10.aud.hm)
mat10.aud.hm[is.na(mat10.aud.hm)] = 0
h10.aud.hm<-h.index(mat10.aud.hm)

ep10.aud.hm<-ep(mut10.aud.hm,a10.ud.sf.hm)
david10.aud.hm<-DS(mat10.aud.hm) #David's Scores - for steepness use normDS output
ordrank.10.aud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aud.hm<-cbind(ordrank.10.aud.hm,ds=david10.aud.hm$normDS)
lm10.aud.hm<-summary(lm(ordrank.10.aud.hm$ds~ordrank.10.aud.hm$ord.rank))
s10.aud.hm<-lm10.aud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aud.hm<-sum(mut1.aud.hm$Victories)
int2.aud.hm<-sum(mut2.aud.hm$Victories)
int3.aud.hm<-sum(mut3.aud.hm$Victories)
int4.aud.hm<-sum(mut4.aud.hm$Victories)
int5.aud.hm<-sum(mut5.aud.hm$Victories)
int6.aud.hm<-sum(mut6.aud.hm$Victories)
int7.aud.hm<-sum(mut7.aud.hm$Victories)
int8.aud.hm<-sum(mut8.aud.hm$Victories)
int9.aud.hm<-sum(mut9.aud.hm$Victories)
int10.aud.hm<-sum(mut10.aud.hm$Victories)

  # Summarize the avoidances in each trial:
av1.aud.hm<-sum(a1.ud.sf.hm$Avoids)
av2.aud.hm<-sum(a2.ud.sf.hm$Avoids)
av3.aud.hm<-sum(a3.ud.sf.hm$Avoids)
av4.aud.hm<-sum(a4.ud.sf.hm$Avoids)
av5.aud.hm<-sum(a5.ud.sf.hm$Avoids)
av6.aud.hm<-sum(a6.ud.sf.hm$Avoids)
av7.aud.hm<-sum(a7.ud.sf.hm$Avoids)
av8.aud.hm<-sum(a8.ud.sf.hm$Avoids)
av9.aud.hm<-sum(a9.ud.sf.hm$Avoids)
av10.aud.hm<-sum(a10.ud.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.adu<-(sum(av1.aud.hm, av2.aud.hm, av3.aud.hm, av4.aud.hm, av5.aud.hm, av6.aud.hm, av7.aud.hm, av8.aud.hm, av9.aud.hm, av10.aud.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.adu<-(sum(int1.aud.hm, int2.aud.hm, int3.aud.hm, int4.aud.hm, int5.aud.hm, int6.aud.hm, int7.aud.hm, int8.aud.hm, int9.aud.hm, int10.aud.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aud.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aud.hm<-e1.aud.hm[order(e1.aud.hm$ID),]
e1.aud.hm<-as.matrix(t(e1.1.aud.hm))

e2.aud.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aud.hm<-e2.aud.hm[order(e2.aud.hm$ID),]
e2.aud.hm<-as.matrix(t(e2.1.aud.hm))

e3.aud.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aud.hm<-e3.aud.hm[order(e3.aud.hm$ID),]
e3.aud.hm<-as.matrix(t(e3.1.aud.hm))

e4.aud.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aud.hm<-e4.aud.hm[order(e4.aud.hm$ID),]
e4.aud.hm<-as.matrix(t(e4.1.aud.hm))

e5.aud.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aud.hm<-e5.aud.hm[order(e5.aud.hm$ID),]
e5.aud.hm<-as.matrix(t(e5.1.aud.hm))

e6.aud.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aud.hm<-e6.aud.hm[order(e6.aud.hm$ID),]
e6.aud.hm<-as.matrix(t(e6.1.aud.hm))

e7.aud.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aud.hm<-e7.aud.hm[order(e7.aud.hm$ID),]
e7.aud.hm<-as.matrix(t(e7.1.aud.hm))

e8.aud.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aud.hm<-e8.aud.hm[order(e8.aud.hm$ID),]
e8.aud.hm<-as.matrix(t(e8.1.aud.hm))

e9.aud.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aud.hm<-e9.aud.hm[order(e9.aud.hm$ID),]
e9.aud.hm<-as.matrix(t(e9.1.aud.hm))

e10.aud.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aud.hm<-e10.aud.hm[order(e10.aud.hm$ID),]
e10.aud.hm<-as.matrix(t(e10.1.aud.hm))

energy.hm.aud.hm<-as.data.frame(matrix(c(e1.aud.hm,e2.aud.hm,e3.aud.hm,e4.aud.hm,e5.aud.hm,e6.aud.hm,e7.aud.hm,e8.aud.hm,e9.aud.hm,e10.aud.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aud.hm<-data.frame(ID=energy.hm.aud.hm$V1,energy_over_distance=energy.hm.aud.hm$V2,energy_over_time=energy.hm.aud.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aud.hm<-david1.aud.hm[order(david1.aud.hm$ID),]
david1.aud.hm<-as.matrix(t(david1.1.aud.hm))

david2.1.aud.hm<-david2.aud.hm[order(david2.aud.hm$ID),]
david2.aud.hm<-as.matrix(t(david2.1.aud.hm))

david3.1.aud.hm<-david3.aud.hm[order(david3.aud.hm$ID),]
david3.aud.hm<-as.matrix(t(david3.1.aud.hm))

david4.1.aud.hm<-david4.aud.hm[order(david4.aud.hm$ID),]
david4.aud.hm<-as.matrix(t(david4.1.aud.hm))

david5.1.aud.hm<-david5.aud.hm[order(david5.aud.hm$ID),]
david5.aud.hm<-as.matrix(t(david5.1.aud.hm))

david6.1.aud.hm<-david6.aud.hm[order(david6.aud.hm$ID),]
david6.aud.hm<-as.matrix(t(david6.1.aud.hm))

david7.1.aud.hm<-david7.aud.hm[order(david7.aud.hm$ID),]
david7.aud.hm<-as.matrix(t(david7.1.aud.hm))

david8.1.aud.hm<-david8.aud.hm[order(david8.aud.hm$ID),]
david8.aud.hm<-as.matrix(t(david8.1.aud.hm))

david9.1.aud.hm<-david9.aud.hm[order(david9.aud.hm$ID),]
david9.aud.hm<-as.matrix(t(david9.1.aud.hm))

david10.1.aud.hm<-david10.aud.hm[order(david10.aud.hm$ID),]
david10.aud.hm<-as.matrix(t(david10.1.aud.hm))

david.hm.aud.hm<-as.data.frame(matrix(c(david1.aud.hm,david2.aud.hm,david3.aud.hm,david4.aud.hm,david5.aud.hm,david6.aud.hm,david7.aud.hm,david8.aud.hm,david9.aud.hm,david10.aud.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aud.hm<-data.frame(ID=david.hm.aud.hm$V1,DS=david.hm.aud.hm$V2,normDS=david.hm.aud.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aud.hm<-lm(e1.1.aud.hm$energy_over_time~as.numeric(david1.1.aud.hm$normDS))
hm.lm.1.s.aud.hm<-summary(lm.hm.1.aud.hm)$coefficients
hm.1.slope.aud.hm<-hm.lm.1.s.aud.hm[2,1]
lm.hm.2.aud.hm<-lm(e2.1.aud.hm$energy_over_time~as.numeric(david2.1.aud.hm$normDS))
hm.lm.2.s.aud.hm<-summary(lm.hm.2.aud.hm)$coefficients
hm.2.slope.aud.hm<-hm.lm.2.s.aud.hm[2,1]
lm.hm.3.aud.hm<-lm(e3.1.aud.hm$energy_over_time~as.numeric(david3.1.aud.hm$normDS))
hm.lm.3.s.aud.hm<-summary(lm.hm.3.aud.hm)$coefficients
hm.3.slope.aud.hm<-hm.lm.3.s.aud.hm[2,1]
lm.hm.4.aud.hm<-lm(e4.1.aud.hm$energy_over_time~as.numeric(david4.1.aud.hm$normDS))
hm.lm.4.s.aud.hm<-summary(lm.hm.4.aud.hm)$coefficients
hm.4.slope.aud.hm<-hm.lm.4.s.aud.hm[2,1]
lm.hm.5.aud.hm<-lm(e5.1.aud.hm$energy_over_time~as.numeric(david5.1.aud.hm$normDS))
hm.lm.5.s.aud.hm<-summary(lm.hm.5.aud.hm)$coefficients
hm.5.slope.aud.hm<-hm.lm.5.s.aud.hm[2,1]
lm.hm.6.aud.hm<-lm(e6.1.aud.hm$energy_over_time~as.numeric(david6.1.aud.hm$normDS))
hm.lm.6.s.aud.hm<-summary(lm.hm.6.aud.hm)$coefficients
hm.6.slope.aud.hm<-hm.lm.6.s.aud.hm[2,1]
lm.hm.7.aud.hm<-lm(e7.1.aud.hm$energy_over_time~as.numeric(david7.1.aud.hm$normDS))
hm.lm.7.s.aud.hm<-summary(lm.hm.7.aud.hm)$coefficients
hm.7.slope.aud.hm<-hm.lm.7.s.aud.hm[2,1]
lm.hm.8.aud.hm<-lm(e8.1.aud.hm$energy_over_time~as.numeric(david8.1.aud.hm$normDS))
hm.lm.8.s.aud.hm<-summary(lm.hm.8.aud.hm)$coefficients
hm.8.slope.aud.hm<-hm.lm.8.s.aud.hm[2,1]
lm.hm.9.aud.hm<-lm(e9.1.aud.hm$energy_over_time~as.numeric(david9.1.aud.hm$normDS))
hm.lm.9.s.aud.hm<-summary(lm.hm.9.aud.hm)$coefficients
hm.9.slope.aud.hm<-hm.lm.9.s.aud.hm[2,1]
lm.hm.10.aud.hm<-lm(e10.1.aud.hm$energy_over_time~as.numeric(david10.1.aud.hm$normDS))
hm.lm.10.s.aud.hm<-summary(lm.hm.10.aud.hm)$coefficients
hm.10.slope.aud.hm<-hm.lm.10.s.aud.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aud.ss.avoid.ud.sf.hm<-data.frame(triangle.transitivity=c(tri1.aud.hm,tri2.aud.hm,tri3.aud.hm,tri4.aud.hm,tri5.aud.hm,tri6.aud.hm,tri7.aud.hm,tri8.aud.hm,tri9.aud.hm,tri10.aud.hm),escalation=c(ep1.aud.hm,ep2.aud.hm,ep3.aud.hm,ep4.aud.hm,ep5.aud.hm,ep6.aud.hm,ep7.aud.hm,ep8.aud.hm,ep9.aud.hm,ep10.aud.hm),dci=c(dci1.aud.hm,dci2.aud.hm,dci3.aud.hm,dci4.aud.hm,dci5.aud.hm,dci6.aud.hm,dci7.aud.hm,dci8.aud.hm,dci9.aud.hm,dci10.aud.hm),steepness=c(s1.aud.hm,s2.aud.hm,s3.aud.hm,s4.aud.hm,s5.aud.hm,s6.aud.hm,s7.aud.hm,s8.aud.hm,s9.aud.hm,s10.aud.hm),slope=c(hm.1.slope.aud.hm,hm.2.slope.aud.hm,hm.3.slope.aud.hm,hm.4.slope.aud.hm,hm.5.slope.aud.hm,hm.6.slope.aud.hm,hm.7.slope.aud.hm,hm.8.slope.aud.hm,hm.9.slope.aud.hm,hm.10.slope.aud.hm))


```
```{r Avoids Uniform Deterministic Data Frame}
#knowledge mutual
km.tt.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$dci)
km.esc.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$escalation)
km.steep.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$steepness)
km.slope.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$dci)
hm.esc.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,hm.mean.adu.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$dci)
km.esc.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$escalation)
km.steep.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$steepness)
km.slope.adu.avoid<-mean(km.aud.ss.avoid.ud.sf.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$dci)
hm.esc.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aud.ss.avoid.ud.sf.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,hm.mean.adu.avoid)

#create overall dataframe of summary statistics
overall.deter.sf.unif.sf.avoid<-data.frame(km.aud.ss.avoid.ud.sf.km)
overall.deter.sf.unif.sf.avoid<-rbind(overall.deter.sf.unif.sf.avoid,hm.aud.ss.avoid.ud.sf.hm)

overall.deter.sf.unif.sf.avoid<-cbind(overall.deter.sf.unif.sf.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.deter.sf.unif.sf.avoid<-cbind(overall.deter.sf.unif.sf.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("deter",20))


rhp.ss.avoid<-overall.deter.sf.unif.sf.avoid[overall.deter.sf.unif.sf.avoid$variable=="rhp",]
history.ss.avoid<-overall.deter.sf.unif.sf.avoid[overall.deter.sf.unif.sf.avoid$variable=="history",]

overall.deter.sf.unif.sf.avoid$combo<-paste(overall.deter.sf.unif.sf.avoid$strategy,overall.deter.sf.unif.sf.avoid$variable,overall.deter.sf.unif.sf.avoid$distribution)
overall.deter.sf.unif.sf.avoid$combo2<-paste(overall.deter.sf.unif.sf.avoid$strategy,overall.deter.sf.unif.sf.avoid$variable)
```

## Attacks Uniform Deterministic Data
```{r Attacks Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks.atud.km<-sapply(files, read.csv)

# Generate attacks.atud.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atud.km<-data.frame(X1=attacks.atud.km[[1]],X2=attacks.atud.km[[2]],Victories=attacks.atud.km[[3]])
mat1.atud.km<-inter.mat(mut1.atud.km)
tri1.atud.km<-tr.tri(mat1.atud.km)
dci1.atud.km<-DCindex(mat1.atud.km)
mat1.atud.km[is.na(mat1.atud.km)] = 0
h1.atud.km<-h.index(mat1.atud.km)

ep1.atud.km<-ep(mut1.atud.km,a1.ud.sf.km)
david1.atud.km<-DS(mat1.atud.km) #David's Scores - for steepness use normDS output
ordrank.1.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atud.km<-cbind(ordrank.1.atud.km,ds=david1.atud.km$normDS)
lm1.atud.km<-summary(lm(ordrank.1.atud.km$ds~ordrank.1.atud.km$ord.rank))
s1.atud.km<-lm1.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atud.km<-data.frame(X1=attacks.atud.km[[4]],X2=attacks.atud.km[[5]],Victories=attacks.atud.km[[6]])
mat2.atud.km<-inter.mat(mut2.atud.km)
tri2.atud.km<-tr.tri(mat2.atud.km)
dci2.atud.km<-DCindex(mat2.atud.km)
mat2.atud.km[is.na(mat2.atud.km)] = 0
h2.atud.km<-h.index(mat2.atud.km)

ep2.atud.km<-ep(mut2.atud.km,a2.ud.sf.km)
david2.atud.km<-DS(mat2.atud.km) #David's Scores - for steepness use normDS output
ordrank.2.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atud.km<-cbind(ordrank.2.atud.km,ds=david2.atud.km$normDS)
lm2.atud.km<-summary(lm(ordrank.2.atud.km$ds~ordrank.2.atud.km$ord.rank))
s2.atud.km<-lm2.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atud.km<-data.frame(X1=attacks.atud.km[[7]],X2=attacks.atud.km[[8]],Victories=attacks.atud.km[[9]])
mat3.atud.km<-inter.mat(mut3.atud.km)
tri3.atud.km<-tr.tri(mat3.atud.km)
dci3.atud.km<-DCindex(mat3.atud.km)
mat3.atud.km[is.na(mat3.atud.km)] = 0
h3.atud.km<-h.index(mat3.atud.km)

ep3.atud.km<-ep(mut3.atud.km,a3.ud.sf.km)
david3.atud.km<-DS(mat3.atud.km) #David's Scores - for steepness use normDS output
ordrank.3.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atud.km<-cbind(ordrank.3.atud.km,ds=david3.atud.km$normDS)
lm3.atud.km<-summary(lm(ordrank.3.atud.km$ds~ordrank.3.atud.km$ord.rank))
s3.atud.km<-lm3.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atud.km<-data.frame(X1=attacks.atud.km[[10]],X2=attacks.atud.km[[11]],Victories=attacks.atud.km[[12]])
mat4.atud.km<-inter.mat(mut4.atud.km)
tri4.atud.km<-tr.tri(mat4.atud.km)
dci4.atud.km<-DCindex(mat4.atud.km)
mat4.atud.km[is.na(mat4.atud.km)] = 0
h4.atud.km<-h.index(mat4.atud.km)

ep4.atud.km<-ep(mut4.atud.km,a4.ud.sf.km)
david4.atud.km<-DS(mat4.atud.km) #David's Scores - for steepness use normDS output
ordrank.4.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atud.km<-cbind(ordrank.4.atud.km,ds=david4.atud.km$normDS)
lm4.atud.km<-summary(lm(ordrank.4.atud.km$ds~ordrank.4.atud.km$ord.rank))
s4.atud.km<-lm4.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atud.km<-data.frame(X1=attacks.atud.km[[13]],X2=attacks.atud.km[[14]],Victories=attacks.atud.km[[15]])
mat5.atud.km<-inter.mat(mut5.atud.km)
tri5.atud.km<-tr.tri(mat5.atud.km)
dci5.atud.km<-DCindex(mat5.atud.km)
mat5.atud.km[is.na(mat5.atud.km)] = 0
h5.atud.km<-h.index(mat5.atud.km)

ep5.atud.km<-ep(mut5.atud.km,a5.ud.sf.km)
david5.atud.km<-DS(mat5.atud.km) #David's Scores - for steepness use normDS output
ordrank.5.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atud.km<-cbind(ordrank.5.atud.km,ds=david5.atud.km$normDS)
lm5.atud.km<-summary(lm(ordrank.5.atud.km$ds~ordrank.5.atud.km$ord.rank))
s5.atud.km<-lm5.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atud.km<-data.frame(X1=attacks.atud.km[[16]],X2=attacks.atud.km[[17]],Victories=attacks.atud.km[[18]])
mat6.atud.km<-inter.mat(mut6.atud.km)
tri6.atud.km<-tr.tri(mat6.atud.km)
dci6.atud.km<-DCindex(mat6.atud.km)
mat6.atud.km[is.na(mat6.atud.km)] = 0
h6.atud.km<-h.index(mat6.atud.km)

ep6.atud.km<-ep(mut6.atud.km,a6.ud.sf.km)
david6.atud.km<-DS(mat6.atud.km) #David's Scores - for steepness use normDS output
ordrank.6.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atud.km<-cbind(ordrank.6.atud.km,ds=david6.atud.km$normDS)
lm6.atud.km<-summary(lm(ordrank.6.atud.km$ds~ordrank.6.atud.km$ord.rank))
s6.atud.km<-lm6.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atud.km<-data.frame(X1=attacks.atud.km[[19]],X2=attacks.atud.km[[20]],Victories=attacks.atud.km[[21]])
mat7.atud.km<-inter.mat(mut7.atud.km)
tri7.atud.km<-tr.tri(mat7.atud.km)
dci7.atud.km<-DCindex(mat7.atud.km)
mat7.atud.km[is.na(mat7.atud.km)] = 0
h7.atud.km<-h.index(mat7.atud.km)

ep7.atud.km<-ep(mut7.atud.km,a7.ud.sf.km)
david7.atud.km<-DS(mat7.atud.km) #David's Scores - for steepness use normDS output
ordrank.7.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atud.km<-cbind(ordrank.7.atud.km,ds=david7.atud.km$normDS)
lm7.atud.km<-summary(lm(ordrank.7.atud.km$ds~ordrank.7.atud.km$ord.rank))
s7.atud.km<-lm7.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atud.km<-data.frame(X1=attacks.atud.km[[22]],X2=attacks.atud.km[[23]],Victories=attacks.atud.km[[24]])
mat8.atud.km<-inter.mat(mut8.atud.km)
tri8.atud.km<-tr.tri(mat8.atud.km)
dci8.atud.km<-DCindex(mat8.atud.km)
mat8.atud.km[is.na(mat8.atud.km)] = 0
h8.atud.km<-h.index(mat8.atud.km)

ep8.atud.km<-ep(mut8.atud.km,a8.ud.sf.km)
david8.atud.km<-DS(mat8.atud.km) #David's Scores - for steepness use normDS output
ordrank.8.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atud.km<-cbind(ordrank.8.atud.km,ds=david8.atud.km$normDS)
lm8.atud.km<-summary(lm(ordrank.8.atud.km$ds~ordrank.8.atud.km$ord.rank))
s8.atud.km<-lm8.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atud.km<-data.frame(X1=attacks.atud.km[[25]],X2=attacks.atud.km[[26]],Victories=attacks.atud.km[[27]])
mat9.atud.km<-inter.mat(mut9.atud.km)
tri9.atud.km<-tr.tri(mat9.atud.km)
dci9.atud.km<-DCindex(mat9.atud.km)
mat9.atud.km[is.na(mat9.atud.km)] = 0
h9.atud.km<-h.index(mat9.atud.km)

ep9.atud.km<-ep(mut9.atud.km,a9.ud.sf.km)
david9.atud.km<-DS(mat9.atud.km) #David's Scores - for steepness use normDS output
ordrank.9.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atud.km<-cbind(ordrank.9.atud.km,ds=david9.atud.km$normDS)
lm9.atud.km<-summary(lm(ordrank.9.atud.km$ds~ordrank.9.atud.km$ord.rank))
s9.atud.km<-lm9.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atud.km<-data.frame(X1=attacks.atud.km[[28]],X2=attacks.atud.km[[29]],Victories=attacks.atud.km[[30]])
mat10.atud.km<-inter.mat(mut10.atud.km)
tri10.atud.km<-tr.tri(mat10.atud.km)
dci10.atud.km<-DCindex(mat10.atud.km)
mat10.atud.km[is.na(mat10.atud.km)] = 0
h10.atud.km<-h.index(mat10.atud.km)

ep10.atud.km<-ep(mut10.atud.km,a10.ud.sf.km)
david10.atud.km<-DS(mat10.atud.km) #David's Scores - for steepness use normDS output
ordrank.10.atud.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atud.km<-cbind(ordrank.10.atud.km,ds=david10.atud.km$normDS)
lm10.atud.km<-summary(lm(ordrank.10.atud.km$ds~ordrank.10.atud.km$ord.rank))
s10.atud.km<-lm10.atud.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atud.km<-sum(mut1.atud.km$Victories)
int2.atud.km<-sum(mut2.atud.km$Victories)
int3.atud.km<-sum(mut3.atud.km$Victories)
int4.atud.km<-sum(mut4.atud.km$Victories)
int5.atud.km<-sum(mut5.atud.km$Victories)
int6.atud.km<-sum(mut6.atud.km$Victories)
int7.atud.km<-sum(mut7.atud.km$Victories)
int8.atud.km<-sum(mut8.atud.km$Victories)
int9.atud.km<-sum(mut9.atud.km$Victories)
int10.atud.km<-sum(mut10.atud.km$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atud.km<-sum(a1.ud.sf.km$Victories)
av2.atud.km<-sum(a2.ud.sf.km$Victories)
av3.atud.km<-sum(a3.ud.sf.km$Victories)
av4.atud.km<-sum(a4.ud.sf.km$Victories)
av5.atud.km<-sum(a5.ud.sf.km$Victories)
av6.atud.km<-sum(a6.ud.sf.km$Victories)
av7.atud.km<-sum(a7.ud.sf.km$Victories)
av8.atud.km<-sum(a8.ud.sf.km$Victories)
av9.atud.km<-sum(a9.ud.sf.km$Victories)
av10.atud.km<-sum(a10.ud.sf.km$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.km.atdu<-(sum(av1.atud.km, av2.atud.km, av3.atud.km, av4.atud.km, av5.atud.km, av6.atud.km, av7.atud.km, av8.atud.km, av9.atud.km, av10.atud.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.atdu<-(sum(int1.atud.km, int2.atud.km, int3.atud.km, int4.atud.km, int5.atud.km, int6.atud.km, int7.atud.km, int8.atud.km, int9.atud.km, int10.atud.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atud.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atud.km<-e1.atud.km[order(e1.atud.km$ID),]
e1.atud.km<-as.matrix(t(e1.1.atud.km))

e2.atud.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atud.km<-e2.atud.km[order(e2.atud.km$ID),]
e2.atud.km<-as.matrix(t(e2.1.atud.km))

e3.atud.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atud.km<-e3.atud.km[order(e3.atud.km$ID),]
e3.atud.km<-as.matrix(t(e3.1.atud.km))

e4.atud.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atud.km<-e4.atud.km[order(e4.atud.km$ID),]
e4.atud.km<-as.matrix(t(e4.1.atud.km))

e5.atud.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atud.km<-e5.atud.km[order(e5.atud.km$ID),]
e5.atud.km<-as.matrix(t(e5.1.atud.km))

e6.atud.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atud.km<-e6.atud.km[order(e6.atud.km$ID),]
e6.atud.km<-as.matrix(t(e6.1.atud.km))

e7.atud.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atud.km<-e7.atud.km[order(e7.atud.km$ID),]
e7.atud.km<-as.matrix(t(e7.1.atud.km))

e8.atud.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atud.km<-e8.atud.km[order(e8.atud.km$ID),]
e8.atud.km<-as.matrix(t(e8.1.atud.km))

e9.atud.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atud.km<-e9.atud.km[order(e9.atud.km$ID),]
e9.atud.km<-as.matrix(t(e9.1.atud.km))

e10.atud.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atud.km<-e10.atud.km[order(e10.atud.km$ID),]
e10.atud.km<-as.matrix(t(e10.1.atud.km))

energy.km.atud.km<-as.data.frame(matrix(c(e1.atud.km,e2.atud.km,e3.atud.km,e4.atud.km,e5.atud.km,e6.atud.km,e7.atud.km,e8.atud.km,e9.atud.km,e10.atud.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atud.km<-data.frame(ID=energy.km.atud.km$V1,energy_over_distance=energy.km.atud.km$V2,energy_over_time=energy.km.atud.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atud.km<-david1.atud.km[order(david1.atud.km$ID),]
david1.atud.km<-as.matrix(t(david1.1.atud.km))

david2.1.atud.km<-david2.atud.km[order(david2.atud.km$ID),]
david2.atud.km<-as.matrix(t(david2.1.atud.km))

david3.1.atud.km<-david3.atud.km[order(david3.atud.km$ID),]
david3.atud.km<-as.matrix(t(david3.1.atud.km))

david4.1.atud.km<-david4.atud.km[order(david4.atud.km$ID),]
david4.atud.km<-as.matrix(t(david4.1.atud.km))

david5.1.atud.km<-david5.atud.km[order(david5.atud.km$ID),]
david5.atud.km<-as.matrix(t(david5.1.atud.km))

david6.1.atud.km<-david6.atud.km[order(david6.atud.km$ID),]
david6.atud.km<-as.matrix(t(david6.1.atud.km))

david7.1.atud.km<-david7.atud.km[order(david7.atud.km$ID),]
david7.atud.km<-as.matrix(t(david7.1.atud.km))

david8.1.atud.km<-david8.atud.km[order(david8.atud.km$ID),]
david8.atud.km<-as.matrix(t(david8.1.atud.km))

david9.1.atud.km<-david9.atud.km[order(david9.atud.km$ID),]
david9.atud.km<-as.matrix(t(david9.1.atud.km))

david10.1.atud.km<-david10.atud.km[order(david10.atud.km$ID),]
david10.atud.km<-as.matrix(t(david10.1.atud.km))

david.km.atud.km<-as.data.frame(matrix(c(david1.atud.km,david2.atud.km,david3.atud.km,david4.atud.km,david5.atud.km,david6.atud.km,david7.atud.km,david8.atud.km,david9.atud.km,david10.atud.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atud.km<-data.frame(ID=david.km.atud.km$V1,DS=david.km.atud.km$V2,normDS=david.km.atud.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atud.km<-lm(e1.1.atud.km$energy_over_time~as.numeric(david1.1.atud.km$normDS))
km.lm.1.s.atud.km<-summary(lm.km.1.atud.km)$coefficients
km.1.slope.atud.km<-km.lm.1.s.atud.km[2,1]
lm.km.2.atud.km<-lm(e2.1.atud.km$energy_over_time~as.numeric(david2.1.atud.km$normDS))
km.lm.2.s.atud.km<-summary(lm.km.2.atud.km)$coefficients
km.2.slope.atud.km<-km.lm.2.s.atud.km[2,1]
lm.km.3.atud.km<-lm(e3.1.atud.km$energy_over_time~as.numeric(david3.1.atud.km$normDS))
km.lm.3.s.atud.km<-summary(lm.km.3.atud.km)$coefficients
km.3.slope.atud.km<-km.lm.3.s.atud.km[2,1]
lm.km.4.atud.km<-lm(e4.1.atud.km$energy_over_time~as.numeric(david4.1.atud.km$normDS))
km.lm.4.s.atud.km<-summary(lm.km.4.atud.km)$coefficients
km.4.slope.atud.km<-km.lm.4.s.atud.km[2,1]
lm.km.5.atud.km<-lm(e5.1.atud.km$energy_over_time~as.numeric(david5.1.atud.km$normDS))
km.lm.5.s.atud.km<-summary(lm.km.5.atud.km)$coefficients
km.5.slope.atud.km<-km.lm.5.s.atud.km[2,1]
lm.km.6.atud.km<-lm(e6.1.atud.km$energy_over_time~as.numeric(david6.1.atud.km$normDS))
km.lm.6.s.atud.km<-summary(lm.km.6.atud.km)$coefficients
km.6.slope.atud.km<-km.lm.6.s.atud.km[2,1]
lm.km.7.atud.km<-lm(e7.1.atud.km$energy_over_time~as.numeric(david7.1.atud.km$normDS))
km.lm.7.s.atud.km<-summary(lm.km.7.atud.km)$coefficients
km.7.slope.atud.km<-km.lm.7.s.atud.km[2,1]
lm.km.8.atud.km<-lm(e8.1.atud.km$energy_over_time~as.numeric(david8.1.atud.km$normDS))
km.lm.8.s.atud.km<-summary(lm.km.8.atud.km)$coefficients
km.8.slope.atud.km<-km.lm.8.s.atud.km[2,1]
lm.km.9.atud.km<-lm(e9.1.atud.km$energy_over_time~as.numeric(david9.1.atud.km$normDS))
km.lm.9.s.atud.km<-summary(lm.km.9.atud.km)$coefficients
km.9.slope.atud.km<-km.lm.9.s.atud.km[2,1]
lm.km.10.atud.km<-lm(e10.1.atud.km$energy_over_time~as.numeric(david10.1.atud.km$normDS))
km.lm.10.s.atud.km<-summary(lm.km.10.atud.km)$coefficients
km.10.slope.atud.km<-km.lm.10.s.atud.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atud.ss.attacks.atud.km<-data.frame(triangle.transitivity=c(tri1.atud.km,tri2.atud.km,tri3.atud.km,tri4.atud.km,tri5.atud.km,tri6.atud.km,tri7.atud.km,tri8.atud.km,tri9.atud.km,tri10.atud.km),escalation=c(ep1.atud.km,ep2.atud.km,ep3.atud.km,ep4.atud.km,ep5.atud.km,ep6.atud.km,ep7.atud.km,ep8.atud.km,ep9.atud.km,ep10.atud.km),dci=c(dci1.atud.km,dci2.atud.km,dci3.atud.km,dci4.atud.km,dci5.atud.km,dci6.atud.km,dci7.atud.km,dci8.atud.km,dci9.atud.km,dci10.atud.km),steepness=c(s1.atud.km,s2.atud.km,s3.atud.km,s4.atud.km,s5.atud.km,s6.atud.km,s7.atud.km,s8.atud.km,s9.atud.km,s10.atud.km),slope=c(km.1.slope.atud.km,km.2.slope.atud.km,km.3.slope.atud.km,km.4.slope.atud.km,km.5.slope.atud.km,km.6.slope.atud.km,km.7.slope.atud.km,km.8.slope.atud.km,km.9.slope.atud.km,km.10.slope.atud.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.d/attacks")

files<-list.files(pattern="*.csv")
attacks.atud.hm<-sapply(files, read.csv)

# Generate attacks.atud.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atud.hm<-data.frame(X1=attacks.atud.hm[[1]],X2=attacks.atud.hm[[2]],Victories=attacks.atud.hm[[3]])
mat1.atud.hm<-inter.mat(mut1.atud.hm)
tri1.atud.hm<-tr.tri(mat1.atud.hm)
dci1.atud.hm<-DCindex(mat1.atud.hm)
mat1.atud.hm[is.na(mat1.atud.hm)] = 0
h1.atud.hm<-h.index(mat1.atud.hm)

ep1.atud.hm<-ep(mut1.atud.hm,a1.ud.sf.hm)
david1.atud.hm<-DS(mat1.atud.hm) #David's Scores - for steepness use normDS output
ordrank.1.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atud.hm<-cbind(ordrank.1.atud.hm,ds=david1.atud.hm$normDS)
lm1.atud.hm<-summary(lm(ordrank.1.atud.hm$ds~ordrank.1.atud.hm$ord.rank))
s1.atud.hm<-lm1.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atud.hm<-data.frame(X1=attacks.atud.hm[[4]],X2=attacks.atud.hm[[5]],Victories=attacks.atud.hm[[6]])
mat2.atud.hm<-inter.mat(mut2.atud.hm)
tri2.atud.hm<-tr.tri(mat2.atud.hm)
dci2.atud.hm<-DCindex(mat2.atud.hm)
mat2.atud.hm[is.na(mat2.atud.hm)] = 0
h2.atud.hm<-h.index(mat2.atud.hm)

ep2.atud.hm<-ep(mut2.atud.hm,a2.ud.sf.hm)
david2.atud.hm<-DS(mat2.atud.hm) #David's Scores - for steepness use normDS output
ordrank.2.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atud.hm<-cbind(ordrank.2.atud.hm,ds=david2.atud.hm$normDS)
lm2.atud.hm<-summary(lm(ordrank.2.atud.hm$ds~ordrank.2.atud.hm$ord.rank))
s2.atud.hm<-lm2.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atud.hm<-data.frame(X1=attacks.atud.hm[[7]],X2=attacks.atud.hm[[8]],Victories=attacks.atud.hm[[9]])
mat3.atud.hm<-inter.mat(mut3.atud.hm)
tri3.atud.hm<-tr.tri(mat3.atud.hm)
dci3.atud.hm<-DCindex(mat3.atud.hm)
mat3.atud.hm[is.na(mat3.atud.hm)] = 0
h3.atud.hm<-h.index(mat3.atud.hm)

ep3.atud.hm<-ep(mut3.atud.hm,a3.ud.sf.hm)
david3.atud.hm<-DS(mat3.atud.hm) #David's Scores - for steepness use normDS output
ordrank.3.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atud.hm<-cbind(ordrank.3.atud.hm,ds=david3.atud.hm$normDS)
lm3.atud.hm<-summary(lm(ordrank.3.atud.hm$ds~ordrank.3.atud.hm$ord.rank))
s3.atud.hm<-lm3.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atud.hm<-data.frame(X1=attacks.atud.hm[[10]],X2=attacks.atud.hm[[11]],Victories=attacks.atud.hm[[12]])
mat4.atud.hm<-inter.mat(mut4.atud.hm)
tri4.atud.hm<-tr.tri(mat4.atud.hm)
dci4.atud.hm<-DCindex(mat4.atud.hm)
mat4.atud.hm[is.na(mat4.atud.hm)] = 0
h4.atud.hm<-h.index(mat4.atud.hm)

ep4.atud.hm<-ep(mut4.atud.hm,a4.ud.sf.hm)
david4.atud.hm<-DS(mat4.atud.hm) #David's Scores - for steepness use normDS output
ordrank.4.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atud.hm<-cbind(ordrank.4.atud.hm,ds=david4.atud.hm$normDS)
lm4.atud.hm<-summary(lm(ordrank.4.atud.hm$ds~ordrank.4.atud.hm$ord.rank))
s4.atud.hm<-lm4.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atud.hm<-data.frame(X1=attacks.atud.hm[[13]],X2=attacks.atud.hm[[14]],Victories=attacks.atud.hm[[15]])
mat5.atud.hm<-inter.mat(mut5.atud.hm)
tri5.atud.hm<-tr.tri(mat5.atud.hm)
dci5.atud.hm<-DCindex(mat5.atud.hm)
mat5.atud.hm[is.na(mat5.atud.hm)] = 0
h5.atud.hm<-h.index(mat5.atud.hm)

ep5.atud.hm<-ep(mut5.atud.hm,a5.ud.sf.hm)
david5.atud.hm<-DS(mat5.atud.hm) #David's Scores - for steepness use normDS output
ordrank.5.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atud.hm<-cbind(ordrank.5.atud.hm,ds=david5.atud.hm$normDS)
lm5.atud.hm<-summary(lm(ordrank.5.atud.hm$ds~ordrank.5.atud.hm$ord.rank))
s5.atud.hm<-lm5.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atud.hm<-data.frame(X1=attacks.atud.hm[[16]],X2=attacks.atud.hm[[17]],Victories=attacks.atud.hm[[18]])
mat6.atud.hm<-inter.mat(mut6.atud.hm)
tri6.atud.hm<-tr.tri(mat6.atud.hm)
dci6.atud.hm<-DCindex(mat6.atud.hm)
mat6.atud.hm[is.na(mat6.atud.hm)] = 0
h6.atud.hm<-h.index(mat6.atud.hm)

ep6.atud.hm<-ep(mut6.atud.hm,a6.ud.sf.hm)
david6.atud.hm<-DS(mat6.atud.hm) #David's Scores - for steepness use normDS output
ordrank.6.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atud.hm<-cbind(ordrank.6.atud.hm,ds=david6.atud.hm$normDS)
lm6.atud.hm<-summary(lm(ordrank.6.atud.hm$ds~ordrank.6.atud.hm$ord.rank))
s6.atud.hm<-lm6.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atud.hm<-data.frame(X1=attacks.atud.hm[[19]],X2=attacks.atud.hm[[20]],Victories=attacks.atud.hm[[21]])
mat7.atud.hm<-inter.mat(mut7.atud.hm)
tri7.atud.hm<-tr.tri(mat7.atud.hm)
dci7.atud.hm<-DCindex(mat7.atud.hm)
mat7.atud.hm[is.na(mat7.atud.hm)] = 0
h7.atud.hm<-h.index(mat7.atud.hm)

ep7.atud.hm<-ep(mut7.atud.hm,a7.ud.sf.hm)
david7.atud.hm<-DS(mat7.atud.hm) #David's Scores - for steepness use normDS output
ordrank.7.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atud.hm<-cbind(ordrank.7.atud.hm,ds=david7.atud.hm$normDS)
lm7.atud.hm<-summary(lm(ordrank.7.atud.hm$ds~ordrank.7.atud.hm$ord.rank))
s7.atud.hm<-lm7.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atud.hm<-data.frame(X1=attacks.atud.hm[[22]],X2=attacks.atud.hm[[23]],Victories=attacks.atud.hm[[24]])
mat8.atud.hm<-inter.mat(mut8.atud.hm)
tri8.atud.hm<-tr.tri(mat8.atud.hm)
dci8.atud.hm<-DCindex(mat8.atud.hm)
mat8.atud.hm[is.na(mat8.atud.hm)] = 0
h8.atud.hm<-h.index(mat8.atud.hm)

ep8.atud.hm<-ep(mut8.atud.hm,a8.ud.sf.hm)
david8.atud.hm<-DS(mat8.atud.hm) #David's Scores - for steepness use normDS output
ordrank.8.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atud.hm<-cbind(ordrank.8.atud.hm,ds=david8.atud.hm$normDS)
lm8.atud.hm<-summary(lm(ordrank.8.atud.hm$ds~ordrank.8.atud.hm$ord.rank))
s8.atud.hm<-lm8.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atud.hm<-data.frame(X1=attacks.atud.hm[[25]],X2=attacks.atud.hm[[26]],Victories=attacks.atud.hm[[27]])
mat9.atud.hm<-inter.mat(mut9.atud.hm)
tri9.atud.hm<-tr.tri(mat9.atud.hm)
dci9.atud.hm<-DCindex(mat9.atud.hm)
mat9.atud.hm[is.na(mat9.atud.hm)] = 0
h9.atud.hm<-h.index(mat9.atud.hm)

ep9.atud.hm<-ep(mut9.atud.hm,a9.ud.sf.hm)
david9.atud.hm<-DS(mat9.atud.hm) #David's Scores - for steepness use normDS output
ordrank.9.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atud.hm<-cbind(ordrank.9.atud.hm,ds=david9.atud.hm$normDS)
lm9.atud.hm<-summary(lm(ordrank.9.atud.hm$ds~ordrank.9.atud.hm$ord.rank))
s9.atud.hm<-lm9.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atud.hm<-data.frame(X1=attacks.atud.hm[[28]],X2=attacks.atud.hm[[29]],Victories=attacks.atud.hm[[30]])
mat10.atud.hm<-inter.mat(mut10.atud.hm)
tri10.atud.hm<-tr.tri(mat10.atud.hm)
dci10.atud.hm<-DCindex(mat10.atud.hm)
mat10.atud.hm[is.na(mat10.atud.hm)] = 0
h10.atud.hm<-h.index(mat10.atud.hm)

ep10.atud.hm<-ep(mut10.atud.hm,a10.ud.sf.hm)
david10.atud.hm<-DS(mat10.atud.hm) #David's Scores - for steepness use normDS output
ordrank.10.atud.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atud.hm<-cbind(ordrank.10.atud.hm,ds=david10.atud.hm$normDS)
lm10.atud.hm<-summary(lm(ordrank.10.atud.hm$ds~ordrank.10.atud.hm$ord.rank))
s10.atud.hm<-lm10.atud.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atud.hm<-sum(mut1.atud.hm$Victories)
int2.atud.hm<-sum(mut2.atud.hm$Victories)
int3.atud.hm<-sum(mut3.atud.hm$Victories)
int4.atud.hm<-sum(mut4.atud.hm$Victories)
int5.atud.hm<-sum(mut5.atud.hm$Victories)
int6.atud.hm<-sum(mut6.atud.hm$Victories)
int7.atud.hm<-sum(mut7.atud.hm$Victories)
int8.atud.hm<-sum(mut8.atud.hm$Victories)
int9.atud.hm<-sum(mut9.atud.hm$Victories)
int10.atud.hm<-sum(mut10.atud.hm$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atud.hm<-sum(a1.ud.sf.hm$Victories)
av2.atud.hm<-sum(a2.ud.sf.hm$Victories)
av3.atud.hm<-sum(a3.ud.sf.hm$Victories)
av4.atud.hm<-sum(a4.ud.sf.hm$Victories)
av5.atud.hm<-sum(a5.ud.sf.hm$Victories)
av6.atud.hm<-sum(a6.ud.sf.hm$Victories)
av7.atud.hm<-sum(a7.ud.sf.hm$Victories)
av8.atud.hm<-sum(a8.ud.sf.hm$Victories)
av9.atud.hm<-sum(a9.ud.sf.hm$Victories)
av10.atud.hm<-sum(a10.ud.sf.hm$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.hm.atdu<-(sum(av1.atud.hm, av2.atud.hm, av3.atud.hm, av4.atud.hm, av5.atud.hm, av6.atud.hm, av7.atud.hm, av8.atud.hm, av9.atud.hm, av10.atud.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.atdu<-(sum(int1.atud.hm, int2.atud.hm, int3.atud.hm, int4.atud.hm, int5.atud.hm, int6.atud.hm, int7.atud.hm, int8.atud.hm, int9.atud.hm, int10.atud.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.d/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atud.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atud.hm<-e1.atud.hm[order(e1.atud.hm$ID),]
e1.atud.hm<-as.matrix(t(e1.1.atud.hm))

e2.atud.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atud.hm<-e2.atud.hm[order(e2.atud.hm$ID),]
e2.atud.hm<-as.matrix(t(e2.1.atud.hm))

e3.atud.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atud.hm<-e3.atud.hm[order(e3.atud.hm$ID),]
e3.atud.hm<-as.matrix(t(e3.1.atud.hm))

e4.atud.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atud.hm<-e4.atud.hm[order(e4.atud.hm$ID),]
e4.atud.hm<-as.matrix(t(e4.1.atud.hm))

e5.atud.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atud.hm<-e5.atud.hm[order(e5.atud.hm$ID),]
e5.atud.hm<-as.matrix(t(e5.1.atud.hm))

e6.atud.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atud.hm<-e6.atud.hm[order(e6.atud.hm$ID),]
e6.atud.hm<-as.matrix(t(e6.1.atud.hm))

e7.atud.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atud.hm<-e7.atud.hm[order(e7.atud.hm$ID),]
e7.atud.hm<-as.matrix(t(e7.1.atud.hm))

e8.atud.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atud.hm<-e8.atud.hm[order(e8.atud.hm$ID),]
e8.atud.hm<-as.matrix(t(e8.1.atud.hm))

e9.atud.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atud.hm<-e9.atud.hm[order(e9.atud.hm$ID),]
e9.atud.hm<-as.matrix(t(e9.1.atud.hm))

e10.atud.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atud.hm<-e10.atud.hm[order(e10.atud.hm$ID),]
e10.atud.hm<-as.matrix(t(e10.1.atud.hm))

energy.hm.atud.hm<-as.data.frame(matrix(c(e1.atud.hm,e2.atud.hm,e3.atud.hm,e4.atud.hm,e5.atud.hm,e6.atud.hm,e7.atud.hm,e8.atud.hm,e9.atud.hm,e10.atud.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atud.hm<-data.frame(ID=energy.hm.atud.hm$V1,energy_over_distance=energy.hm.atud.hm$V2,energy_over_time=energy.hm.atud.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atud.hm<-david1.atud.hm[order(david1.atud.hm$ID),]
david1.atud.hm<-as.matrix(t(david1.1.atud.hm))

david2.1.atud.hm<-david2.atud.hm[order(david2.atud.hm$ID),]
david2.atud.hm<-as.matrix(t(david2.1.atud.hm))

david3.1.atud.hm<-david3.atud.hm[order(david3.atud.hm$ID),]
david3.atud.hm<-as.matrix(t(david3.1.atud.hm))

david4.1.atud.hm<-david4.atud.hm[order(david4.atud.hm$ID),]
david4.atud.hm<-as.matrix(t(david4.1.atud.hm))

david5.1.atud.hm<-david5.atud.hm[order(david5.atud.hm$ID),]
david5.atud.hm<-as.matrix(t(david5.1.atud.hm))

david6.1.atud.hm<-david6.atud.hm[order(david6.atud.hm$ID),]
david6.atud.hm<-as.matrix(t(david6.1.atud.hm))

david7.1.atud.hm<-david7.atud.hm[order(david7.atud.hm$ID),]
david7.atud.hm<-as.matrix(t(david7.1.atud.hm))

david8.1.atud.hm<-david8.atud.hm[order(david8.atud.hm$ID),]
david8.atud.hm<-as.matrix(t(david8.1.atud.hm))

david9.1.atud.hm<-david9.atud.hm[order(david9.atud.hm$ID),]
david9.atud.hm<-as.matrix(t(david9.1.atud.hm))

david10.1.atud.hm<-david10.atud.hm[order(david10.atud.hm$ID),]
david10.atud.hm<-as.matrix(t(david10.1.atud.hm))

david.hm.atud.hm<-as.data.frame(matrix(c(david1.atud.hm,david2.atud.hm,david3.atud.hm,david4.atud.hm,david5.atud.hm,david6.atud.hm,david7.atud.hm,david8.atud.hm,david9.atud.hm,david10.atud.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atud.hm<-data.frame(ID=david.hm.atud.hm$V1,DS=david.hm.atud.hm$V2,normDS=david.hm.atud.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atud.hm<-lm(e1.1.atud.hm$energy_over_time~as.numeric(david1.1.atud.hm$normDS))
hm.lm.1.s.atud.hm<-summary(lm.hm.1.atud.hm)$coefficients
hm.1.slope.atud.hm<-hm.lm.1.s.atud.hm[2,1]
lm.hm.2.atud.hm<-lm(e2.1.atud.hm$energy_over_time~as.numeric(david2.1.atud.hm$normDS))
hm.lm.2.s.atud.hm<-summary(lm.hm.2.atud.hm)$coefficients
hm.2.slope.atud.hm<-hm.lm.2.s.atud.hm[2,1]
lm.hm.3.atud.hm<-lm(e3.1.atud.hm$energy_over_time~as.numeric(david3.1.atud.hm$normDS))
hm.lm.3.s.atud.hm<-summary(lm.hm.3.atud.hm)$coefficients
hm.3.slope.atud.hm<-hm.lm.3.s.atud.hm[2,1]
lm.hm.4.atud.hm<-lm(e4.1.atud.hm$energy_over_time~as.numeric(david4.1.atud.hm$normDS))
hm.lm.4.s.atud.hm<-summary(lm.hm.4.atud.hm)$coefficients
hm.4.slope.atud.hm<-hm.lm.4.s.atud.hm[2,1]
lm.hm.5.atud.hm<-lm(e5.1.atud.hm$energy_over_time~as.numeric(david5.1.atud.hm$normDS))
hm.lm.5.s.atud.hm<-summary(lm.hm.5.atud.hm)$coefficients
hm.5.slope.atud.hm<-hm.lm.5.s.atud.hm[2,1]
lm.hm.6.atud.hm<-lm(e6.1.atud.hm$energy_over_time~as.numeric(david6.1.atud.hm$normDS))
hm.lm.6.s.atud.hm<-summary(lm.hm.6.atud.hm)$coefficients
hm.6.slope.atud.hm<-hm.lm.6.s.atud.hm[2,1]
lm.hm.7.atud.hm<-lm(e7.1.atud.hm$energy_over_time~as.numeric(david7.1.atud.hm$normDS))
hm.lm.7.s.atud.hm<-summary(lm.hm.7.atud.hm)$coefficients
hm.7.slope.atud.hm<-hm.lm.7.s.atud.hm[2,1]
lm.hm.8.atud.hm<-lm(e8.1.atud.hm$energy_over_time~as.numeric(david8.1.atud.hm$normDS))
hm.lm.8.s.atud.hm<-summary(lm.hm.8.atud.hm)$coefficients
hm.8.slope.atud.hm<-hm.lm.8.s.atud.hm[2,1]
lm.hm.9.atud.hm<-lm(e9.1.atud.hm$energy_over_time~as.numeric(david9.1.atud.hm$normDS))
hm.lm.9.s.atud.hm<-summary(lm.hm.9.atud.hm)$coefficients
hm.9.slope.atud.hm<-hm.lm.9.s.atud.hm[2,1]
lm.hm.10.atud.hm<-lm(e10.1.atud.hm$energy_over_time~as.numeric(david10.1.atud.hm$normDS))
hm.lm.10.s.atud.hm<-summary(lm.hm.10.atud.hm)$coefficients
hm.10.slope.atud.hm<-hm.lm.10.s.atud.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atud.ss.attacks.atud.hm<-data.frame(triangle.transitivity=c(tri1.atud.hm,tri2.atud.hm,tri3.atud.hm,tri4.atud.hm,tri5.atud.hm,tri6.atud.hm,tri7.atud.hm,tri8.atud.hm,tri9.atud.hm,tri10.atud.hm),escalation=c(ep1.atud.hm,ep2.atud.hm,ep3.atud.hm,ep4.atud.hm,ep5.atud.hm,ep6.atud.hm,ep7.atud.hm,ep8.atud.hm,ep9.atud.hm,ep10.atud.hm),dci=c(dci1.atud.hm,dci2.atud.hm,dci3.atud.hm,dci4.atud.hm,dci5.atud.hm,dci6.atud.hm,dci7.atud.hm,dci8.atud.hm,dci9.atud.hm,dci10.atud.hm),steepness=c(s1.atud.hm,s2.atud.hm,s3.atud.hm,s4.atud.hm,s5.atud.hm,s6.atud.hm,s7.atud.hm,s8.atud.hm,s9.atud.hm,s10.atud.hm),slope=c(hm.1.slope.atud.hm,hm.2.slope.atud.hm,hm.3.slope.atud.hm,hm.4.slope.atud.hm,hm.5.slope.atud.hm,hm.6.slope.atud.hm,hm.7.slope.atud.hm,hm.8.slope.atud.hm,hm.9.slope.atud.hm,hm.10.slope.atud.hm))


```
```{r attacks Uniform Deterministic Data Frame}
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$dci)
km.esc.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$escalation)
km.steep.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$steepness)
km.slope.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,hm.mean.atdu.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$dci)
km.esc.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$escalation)
km.steep.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$steepness)
km.slope.atdu.attacks<-mean(km.atud.ss.attacks.atud.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atud.ss.attacks.atud.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,hm.mean.atdu.attacks)

#create overall dataframe of summary statistics
overall.deter.sf.unif.sf.attacks<-data.frame(km.atud.ss.attacks.atud.km)
overall.deter.sf.unif.sf.attacks<-rbind(overall.deter.sf.unif.sf.attacks,hm.atud.ss.attacks.atud.hm)

overall.deter.sf.unif.sf.attacks<-cbind(overall.deter.sf.unif.sf.attacks,variable=c(rep("rhp",10),rep("history",10)))
overall.deter.sf.unif.sf.attacks<-cbind(overall.deter.sf.unif.sf.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("deter",20))


rhp.ss.attacks<-overall.deter.sf.unif.sf.attacks[overall.deter.sf.unif.sf.attacks$variable=="rhp",]
history.ss.attacks<-overall.deter.sf.unif.sf.attacks[overall.deter.sf.unif.sf.attacks$variable=="history",]

overall.deter.sf.unif.sf.attacks$combo<-paste(overall.deter.sf.unif.sf.attacks$strategy,overall.deter.sf.unif.sf.attacks$variable,overall.deter.sf.unif.sf.attacks$distribution)
overall.deter.sf.unif.sf.attacks$combo2<-paste(overall.deter.sf.unif.sf.attacks$strategy,overall.deter.sf.unif.sf.attacks$variable)
```

## Attack Proportions Data
```{r Attack Proportions}
# The original attack proportion (escalation) data needed to be collected and uploaded from NetLogo. The below code organizes and analyses these data.

library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

# Read in the attack proportion data:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid")
attack.prop.sf<-read.csv("dominance_despotism_energy sigmoid experiment-table.csv", skip=6)

attack.prop.sf.2<-attack.prop.sf[attack.prop.sf$winning=="deterministic",]
attack.prop.sf.2<-cbind(attack.prop.sf.2, run.number=as.numeric(attack.prop.sf.2$X.run.number.))

attack.prop.sf.2<-attack.prop.sf.2[order(attack.prop.sf.2$X.run.number),]


attack.prop.sf.2<-cbind(attack.prop.sf.2, rate.avoids=((as.numeric(attack.prop.sf.2$sum..avoid.counter..of.fightsavoided)/as.numeric(attack.prop.sf.2$ticks))), rate.attacks=((as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories)/as.numeric(attack.prop.sf.2$ticks))))

attack.prop.sf.2<-cbind(attack.prop.sf.2, proportion.attacking=((as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories))/(as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories)+as.numeric(attack.prop.sf.2$sum..avoid.counter..of.fightsavoided))))


# Label each set of 10 trials by the Who variable (mutual, opponent, self) and the What variable (History, RHP):
attack.prop.sf.2<-cbind(attack.prop.sf.2,combo2=c(rep("mutual history",10),rep("mutual rhp",10)))
```



## Clumped Initiator Wins Data
```{r Clumped Initiator Wins Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.sf.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[1]],X2=avoid.ci.sf.km[[2]],Avoids=avoid.ci.sf.km[[3]])
a2.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[4]],X2=avoid.ci.sf.km[[5]],Avoids=avoid.ci.sf.km[[6]])
a3.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[7]],X2=avoid.ci.sf.km[[8]],Avoids=avoid.ci.sf.km[[9]])
a4.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[10]],X2=avoid.ci.sf.km[[11]],Avoids=avoid.ci.sf.km[[12]])
a5.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[13]],X2=avoid.ci.sf.km[[14]],Avoids=avoid.ci.sf.km[[15]])
a6.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[16]],X2=avoid.ci.sf.km[[17]],Avoids=avoid.ci.sf.km[[18]])
a7.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[19]],X2=avoid.ci.sf.km[[20]],Avoids=avoid.ci.sf.km[[21]])
a8.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[22]],X2=avoid.ci.sf.km[[23]],Avoids=avoid.ci.sf.km[[24]])
a9.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[25]],X2=avoid.ci.sf.km[[26]],Avoids=avoid.ci.sf.km[[27]])
a10.ci.sf.km<-data.frame(X1=avoid.ci.sf.km[[28]],X2=avoid.ci.sf.km[[29]],Avoids=avoid.ci.sf.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.km.ci.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[1]],X2=conflict.km.ci.sf[[2]],Victories=conflict.km.ci.sf[[3]])
mat1.ci.sf.km<-inter.mat(mut1.ci.sf.km)
tri1.ci.sf.km<-tr.tri(mat1.ci.sf.km)
dci1.ci.sf.km<-DCindex(mat1.ci.sf.km)
mat1.ci.sf.km[is.na(mat1.ci.sf.km)] = 0
h1.ci.sf.km<-h.index(mat1.ci.sf.km)

ep1.ci.sf.km<-ep(mut1.ci.sf.km,a1.ci.sf.km)
david1.ci.sf.km<-DS(mat1.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.sf.km<-cbind(ordrank.1.ci.sf.km,ds=david1.ci.sf.km$normDS)
lm1.ci.sf.km<-summary(lm(ordrank.1.ci.sf.km$ds~ordrank.1.ci.sf.km$ord.rank))
s1.ci.sf.km<-lm1.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[4]],X2=conflict.km.ci.sf[[5]],Victories=conflict.km.ci.sf[[6]])
mat2.ci.sf.km<-inter.mat(mut2.ci.sf.km)
tri2.ci.sf.km<-tr.tri(mat2.ci.sf.km)
dci2.ci.sf.km<-DCindex(mat2.ci.sf.km)
mat2.ci.sf.km[is.na(mat2.ci.sf.km)] = 0
h2.ci.sf.km<-h.index(mat2.ci.sf.km)

ep2.ci.sf.km<-ep(mut2.ci.sf.km,a2.ci.sf.km)
david2.ci.sf.km<-DS(mat2.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.sf.km<-cbind(ordrank.2.ci.sf.km,ds=david2.ci.sf.km$normDS)
lm2.ci.sf.km<-summary(lm(ordrank.2.ci.sf.km$ds~ordrank.2.ci.sf.km$ord.rank))
s2.ci.sf.km<-lm2.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[7]],X2=conflict.km.ci.sf[[8]],Victories=conflict.km.ci.sf[[9]])
mat3.ci.sf.km<-inter.mat(mut3.ci.sf.km)
tri3.ci.sf.km<-tr.tri(mat3.ci.sf.km)
dci3.ci.sf.km<-DCindex(mat3.ci.sf.km)
mat3.ci.sf.km[is.na(mat3.ci.sf.km)] = 0
h3.ci.sf.km<-h.index(mat3.ci.sf.km)

ep3.ci.sf.km<-ep(mut3.ci.sf.km,a3.ci.sf.km)
david3.ci.sf.km<-DS(mat3.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.sf.km<-cbind(ordrank.3.ci.sf.km,ds=david3.ci.sf.km$normDS)
lm3.ci.sf.km<-summary(lm(ordrank.3.ci.sf.km$ds~ordrank.3.ci.sf.km$ord.rank))
s3.ci.sf.km<-lm3.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[10]],X2=conflict.km.ci.sf[[11]],Victories=conflict.km.ci.sf[[12]])
mat4.ci.sf.km<-inter.mat(mut4.ci.sf.km)
tri4.ci.sf.km<-tr.tri(mat4.ci.sf.km)
dci4.ci.sf.km<-DCindex(mat4.ci.sf.km)
mat4.ci.sf.km[is.na(mat4.ci.sf.km)] = 0
h4.ci.sf.km<-h.index(mat4.ci.sf.km)

ep4.ci.sf.km<-ep(mut4.ci.sf.km,a4.ci.sf.km)
david4.ci.sf.km<-DS(mat4.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.sf.km<-cbind(ordrank.4.ci.sf.km,ds=david4.ci.sf.km$normDS)
lm4.ci.sf.km<-summary(lm(ordrank.4.ci.sf.km$ds~ordrank.4.ci.sf.km$ord.rank))
s4.ci.sf.km<-lm4.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[13]],X2=conflict.km.ci.sf[[14]],Victories=conflict.km.ci.sf[[15]])
mat5.ci.sf.km<-inter.mat(mut5.ci.sf.km)
tri5.ci.sf.km<-tr.tri(mat5.ci.sf.km)
dci5.ci.sf.km<-DCindex(mat5.ci.sf.km)
mat5.ci.sf.km[is.na(mat5.ci.sf.km)] = 0
h5.ci.sf.km<-h.index(mat5.ci.sf.km)

ep5.ci.sf.km<-ep(mut5.ci.sf.km,a5.ci.sf.km)
david5.ci.sf.km<-DS(mat5.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.sf.km<-cbind(ordrank.5.ci.sf.km,ds=david5.ci.sf.km$normDS)
lm5.ci.sf.km<-summary(lm(ordrank.5.ci.sf.km$ds~ordrank.5.ci.sf.km$ord.rank))
s5.ci.sf.km<-lm5.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[16]],X2=conflict.km.ci.sf[[17]],Victories=conflict.km.ci.sf[[18]])
mat6.ci.sf.km<-inter.mat(mut6.ci.sf.km)
tri6.ci.sf.km<-tr.tri(mat6.ci.sf.km)
dci6.ci.sf.km<-DCindex(mat6.ci.sf.km)
mat6.ci.sf.km[is.na(mat6.ci.sf.km)] = 0
h6.ci.sf.km<-h.index(mat6.ci.sf.km)

ep6.ci.sf.km<-ep(mut6.ci.sf.km,a6.ci.sf.km)
david6.ci.sf.km<-DS(mat6.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.sf.km<-cbind(ordrank.6.ci.sf.km,ds=david6.ci.sf.km$normDS)
lm6.ci.sf.km<-summary(lm(ordrank.6.ci.sf.km$ds~ordrank.6.ci.sf.km$ord.rank))
s6.ci.sf.km<-lm6.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[19]],X2=conflict.km.ci.sf[[20]],Victories=conflict.km.ci.sf[[21]])
mat7.ci.sf.km<-inter.mat(mut7.ci.sf.km)
tri7.ci.sf.km<-tr.tri(mat7.ci.sf.km)
dci7.ci.sf.km<-DCindex(mat7.ci.sf.km)
mat7.ci.sf.km[is.na(mat7.ci.sf.km)] = 0
h7.ci.sf.km<-h.index(mat7.ci.sf.km)

ep7.ci.sf.km<-ep(mut7.ci.sf.km,a7.ci.sf.km)
david7.ci.sf.km<-DS(mat7.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.sf.km<-cbind(ordrank.7.ci.sf.km,ds=david7.ci.sf.km$normDS)
lm7.ci.sf.km<-summary(lm(ordrank.7.ci.sf.km$ds~ordrank.7.ci.sf.km$ord.rank))
s7.ci.sf.km<-lm7.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[22]],X2=conflict.km.ci.sf[[23]],Victories=conflict.km.ci.sf[[24]])
mat8.ci.sf.km<-inter.mat(mut8.ci.sf.km)
tri8.ci.sf.km<-tr.tri(mat8.ci.sf.km)
dci8.ci.sf.km<-DCindex(mat8.ci.sf.km)
mat8.ci.sf.km[is.na(mat8.ci.sf.km)] = 0
h8.ci.sf.km<-h.index(mat8.ci.sf.km)

ep8.ci.sf.km<-ep(mut8.ci.sf.km,a8.ci.sf.km)
david8.ci.sf.km<-DS(mat8.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.sf.km<-cbind(ordrank.8.ci.sf.km,ds=david8.ci.sf.km$normDS)
lm8.ci.sf.km<-summary(lm(ordrank.8.ci.sf.km$ds~ordrank.8.ci.sf.km$ord.rank))
s8.ci.sf.km<-lm8.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[25]],X2=conflict.km.ci.sf[[26]],Victories=conflict.km.ci.sf[[27]])
mat9.ci.sf.km<-inter.mat(mut9.ci.sf.km)
tri9.ci.sf.km<-tr.tri(mat9.ci.sf.km)
dci9.ci.sf.km<-DCindex(mat9.ci.sf.km)
mat9.ci.sf.km[is.na(mat9.ci.sf.km)] = 0
h9.ci.sf.km<-h.index(mat9.ci.sf.km)

ep9.ci.sf.km<-ep(mut9.ci.sf.km,a9.ci.sf.km)
david9.ci.sf.km<-DS(mat9.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.sf.km<-cbind(ordrank.9.ci.sf.km,ds=david9.ci.sf.km$normDS)
lm9.ci.sf.km<-summary(lm(ordrank.9.ci.sf.km$ds~ordrank.9.ci.sf.km$ord.rank))
s9.ci.sf.km<-lm9.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.sf.km<-data.frame(X1=conflict.km.ci.sf[[28]],X2=conflict.km.ci.sf[[29]],Victories=conflict.km.ci.sf[[30]])
mat10.ci.sf.km<-inter.mat(mut10.ci.sf.km)
tri10.ci.sf.km<-tr.tri(mat10.ci.sf.km)
dci10.ci.sf.km<-DCindex(mat10.ci.sf.km)
mat10.ci.sf.km[is.na(mat10.ci.sf.km)] = 0
h10.ci.sf.km<-h.index(mat10.ci.sf.km)

ep10.ci.sf.km<-ep(mut10.ci.sf.km,a10.ci.sf.km)
david10.ci.sf.km<-DS(mat10.ci.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.ci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.sf.km<-cbind(ordrank.10.ci.sf.km,ds=david10.ci.sf.km$normDS)
lm10.ci.sf.km<-summary(lm(ordrank.10.ci.sf.km$ds~ordrank.10.ci.sf.km$ord.rank))
s10.ci.sf.km<-lm10.ci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.sf.km<-sum(mut1.ci.sf.km$Victories)
int2.ci.sf.km<-sum(mut2.ci.sf.km$Victories)
int3.ci.sf.km<-sum(mut3.ci.sf.km$Victories)
int4.ci.sf.km<-sum(mut4.ci.sf.km$Victories)
int5.ci.sf.km<-sum(mut5.ci.sf.km$Victories)
int6.ci.sf.km<-sum(mut6.ci.sf.km$Victories)
int7.ci.sf.km<-sum(mut7.ci.sf.km$Victories)
int8.ci.sf.km<-sum(mut8.ci.sf.km$Victories)
int9.ci.sf.km<-sum(mut9.ci.sf.km$Victories)
int10.ci.sf.km<-sum(mut10.ci.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.ci.sf.km<-sum(a1.ci.sf.km$Avoids)
av2.ci.sf.km<-sum(a2.ci.sf.km$Avoids)
av3.ci.sf.km<-sum(a3.ci.sf.km$Avoids)
av4.ci.sf.km<-sum(a4.ci.sf.km$Avoids)
av5.ci.sf.km<-sum(a5.ci.sf.km$Avoids)
av6.ci.sf.km<-sum(a6.ci.sf.km$Avoids)
av7.ci.sf.km<-sum(a7.ci.sf.km$Avoids)
av8.ci.sf.km<-sum(a8.ci.sf.km$Avoids)
av9.ci.sf.km<-sum(a9.ci.sf.km$Avoids)
av10.ci.sf.km<-sum(a10.ci.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.ci.sf<-(sum(av1.ci.sf.km, av2.ci.sf.km, av3.ci.sf.km, av4.ci.sf.km, av5.ci.sf.km, av6.ci.sf.km, av7.ci.sf.km, av8.ci.sf.km, av9.ci.sf.km, av10.ci.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.ci.sf<-(sum(int1.ci.sf.km, int2.ci.sf.km, int3.ci.sf.km, int4.ci.sf.km, int5.ci.sf.km, int6.ci.sf.km, int7.ci.sf.km, int8.ci.sf.km, int9.ci.sf.km, int10.ci.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.sf.km<-e1.ci.sf.km[order(e1.ci.sf.km$ID),]
e1.ci.sf.km<-as.matrix(t(e1.1.ci.sf.km))

e2.ci.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.sf.km<-e2.ci.sf.km[order(e2.ci.sf.km$ID),]
e2.ci.sf.km<-as.matrix(t(e2.1.ci.sf.km))

e3.ci.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.sf.km<-e3.ci.sf.km[order(e3.ci.sf.km$ID),]
e3.ci.sf.km<-as.matrix(t(e3.1.ci.sf.km))

e4.ci.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.sf.km<-e4.ci.sf.km[order(e4.ci.sf.km$ID),]
e4.ci.sf.km<-as.matrix(t(e4.1.ci.sf.km))

e5.ci.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.sf.km<-e5.ci.sf.km[order(e5.ci.sf.km$ID),]
e5.ci.sf.km<-as.matrix(t(e5.1.ci.sf.km))

e6.ci.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.sf.km<-e6.ci.sf.km[order(e6.ci.sf.km$ID),]
e6.ci.sf.km<-as.matrix(t(e6.1.ci.sf.km))

e7.ci.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.sf.km<-e7.ci.sf.km[order(e7.ci.sf.km$ID),]
e7.ci.sf.km<-as.matrix(t(e7.1.ci.sf.km))

e8.ci.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.sf.km<-e8.ci.sf.km[order(e8.ci.sf.km$ID),]
e8.ci.sf.km<-as.matrix(t(e8.1.ci.sf.km))

e9.ci.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.sf.km<-e9.ci.sf.km[order(e9.ci.sf.km$ID),]
e9.ci.sf.km<-as.matrix(t(e9.1.ci.sf.km))

e10.ci.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.sf.km<-e10.ci.sf.km[order(e10.ci.sf.km$ID),]
e10.ci.sf.km<-as.matrix(t(e10.1.ci.sf.km))

energy.km.ci.sf.km<-as.data.frame(matrix(c(e1.ci.sf.km,e2.ci.sf.km,e3.ci.sf.km,e4.ci.sf.km,e5.ci.sf.km,e6.ci.sf.km,e7.ci.sf.km,e8.ci.sf.km,e9.ci.sf.km,e10.ci.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.ci.sf.km<-data.frame(ID=energy.km.ci.sf.km$V1,energy_over_distance=energy.km.ci.sf.km$V2,energy_over_time=energy.km.ci.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.sf.km<-david1.ci.sf.km[order(david1.ci.sf.km$ID),]
david1.ci.sf.km<-as.matrix(t(david1.1.ci.sf.km))

david2.1.ci.sf.km<-david2.ci.sf.km[order(david2.ci.sf.km$ID),]
david2.ci.sf.km<-as.matrix(t(david2.1.ci.sf.km))

david3.1.ci.sf.km<-david3.ci.sf.km[order(david3.ci.sf.km$ID),]
david3.ci.sf.km<-as.matrix(t(david3.1.ci.sf.km))

david4.1.ci.sf.km<-david4.ci.sf.km[order(david4.ci.sf.km$ID),]
david4.ci.sf.km<-as.matrix(t(david4.1.ci.sf.km))

david5.1.ci.sf.km<-david5.ci.sf.km[order(david5.ci.sf.km$ID),]
david5.ci.sf.km<-as.matrix(t(david5.1.ci.sf.km))

david6.1.ci.sf.km<-david6.ci.sf.km[order(david6.ci.sf.km$ID),]
david6.ci.sf.km<-as.matrix(t(david6.1.ci.sf.km))

david7.1.ci.sf.km<-david7.ci.sf.km[order(david7.ci.sf.km$ID),]
david7.ci.sf.km<-as.matrix(t(david7.1.ci.sf.km))

david8.1.ci.sf.km<-david8.ci.sf.km[order(david8.ci.sf.km$ID),]
david8.ci.sf.km<-as.matrix(t(david8.1.ci.sf.km))

david9.1.ci.sf.km<-david9.ci.sf.km[order(david9.ci.sf.km$ID),]
david9.ci.sf.km<-as.matrix(t(david9.1.ci.sf.km))

david10.1.ci.sf.km<-david10.ci.sf.km[order(david10.ci.sf.km$ID),]
david10.ci.sf.km<-as.matrix(t(david10.1.ci.sf.km))

david.km.ci.sf.km<-as.data.frame(matrix(c(david1.ci.sf.km,david2.ci.sf.km,david3.ci.sf.km,david4.ci.sf.km,david5.ci.sf.km,david6.ci.sf.km,david7.ci.sf.km,david8.ci.sf.km,david9.ci.sf.km,david10.ci.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.ci.sf.km<-data.frame(ID=david.km.ci.sf.km$V1,DS=david.km.ci.sf.km$V2,normDS=david.km.ci.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.ci.sf.km<-lm(e1.1.ci.sf.km$energy_over_time~as.numeric(david1.1.ci.sf.km$normDS))
km.lm.1.s.ci.sf.km<-summary(lm.km.1.ci.sf.km)$coefficients
km.1.slope.ci.sf.km<-km.lm.1.s.ci.sf.km[2,1]
lm.km.2.ci.sf.km<-lm(e2.1.ci.sf.km$energy_over_time~as.numeric(david2.1.ci.sf.km$normDS))
km.lm.2.s.ci.sf.km<-summary(lm.km.2.ci.sf.km)$coefficients
km.2.slope.ci.sf.km<-km.lm.2.s.ci.sf.km[2,1]
lm.km.3.ci.sf.km<-lm(e3.1.ci.sf.km$energy_over_time~as.numeric(david3.1.ci.sf.km$normDS))
km.lm.3.s.ci.sf.km<-summary(lm.km.3.ci.sf.km)$coefficients
km.3.slope.ci.sf.km<-km.lm.3.s.ci.sf.km[2,1]
lm.km.4.ci.sf.km<-lm(e4.1.ci.sf.km$energy_over_time~as.numeric(david4.1.ci.sf.km$normDS))
km.lm.4.s.ci.sf.km<-summary(lm.km.4.ci.sf.km)$coefficients
km.4.slope.ci.sf.km<-km.lm.4.s.ci.sf.km[2,1]
lm.km.5.ci.sf.km<-lm(e5.1.ci.sf.km$energy_over_time~as.numeric(david5.1.ci.sf.km$normDS))
km.lm.5.s.ci.sf.km<-summary(lm.km.5.ci.sf.km)$coefficients
km.5.slope.ci.sf.km<-km.lm.5.s.ci.sf.km[2,1]
lm.km.6.ci.sf.km<-lm(e6.1.ci.sf.km$energy_over_time~as.numeric(david6.1.ci.sf.km$normDS))
km.lm.6.s.ci.sf.km<-summary(lm.km.6.ci.sf.km)$coefficients
km.6.slope.ci.sf.km<-km.lm.6.s.ci.sf.km[2,1]
lm.km.7.ci.sf.km<-lm(e7.1.ci.sf.km$energy_over_time~as.numeric(david7.1.ci.sf.km$normDS))
km.lm.7.s.ci.sf.km<-summary(lm.km.7.ci.sf.km)$coefficients
km.7.slope.ci.sf.km<-km.lm.7.s.ci.sf.km[2,1]
lm.km.8.ci.sf.km<-lm(e8.1.ci.sf.km$energy_over_time~as.numeric(david8.1.ci.sf.km$normDS))
km.lm.8.s.ci.sf.km<-summary(lm.km.8.ci.sf.km)$coefficients
km.8.slope.ci.sf.km<-km.lm.8.s.ci.sf.km[2,1]
lm.km.9.ci.sf.km<-lm(e9.1.ci.sf.km$energy_over_time~as.numeric(david9.1.ci.sf.km$normDS))
km.lm.9.s.ci.sf.km<-summary(lm.km.9.ci.sf.km)$coefficients
km.9.slope.ci.sf.km<-km.lm.9.s.ci.sf.km[2,1]
lm.km.10.ci.sf.km<-lm(e10.1.ci.sf.km$energy_over_time~as.numeric(david10.1.ci.sf.km$normDS))
km.lm.10.s.ci.sf.km<-summary(lm.km.10.ci.sf.km)$coefficients
km.10.slope.ci.sf.km<-km.lm.10.s.ci.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.ci.sf.ss<-data.frame(triangle.transitivity=c(tri1.ci.sf.km,tri2.ci.sf.km,tri3.ci.sf.km,tri4.ci.sf.km,tri5.ci.sf.km,tri6.ci.sf.km,tri7.ci.sf.km,tri8.ci.sf.km,tri9.ci.sf.km,tri10.ci.sf.km),escalation=c(ep1.ci.sf.km,ep2.ci.sf.km,ep3.ci.sf.km,ep4.ci.sf.km,ep5.ci.sf.km,ep6.ci.sf.km,ep7.ci.sf.km,ep8.ci.sf.km,ep9.ci.sf.km,ep10.ci.sf.km),dci=c(dci1.ci.sf.km,dci2.ci.sf.km,dci3.ci.sf.km,dci4.ci.sf.km,dci5.ci.sf.km,dci6.ci.sf.km,dci7.ci.sf.km,dci8.ci.sf.km,dci9.ci.sf.km,dci10.ci.sf.km),steepness=c(s1.ci.sf.km,s2.ci.sf.km,s3.ci.sf.km,s4.ci.sf.km,s5.ci.sf.km,s6.ci.sf.km,s7.ci.sf.km,s8.ci.sf.km,s9.ci.sf.km,s10.ci.sf.km),slope=c(km.1.slope.ci.sf.km,km.2.slope.ci.sf.km,km.3.slope.ci.sf.km,km.4.slope.ci.sf.km,km.5.slope.ci.sf.km,km.6.slope.ci.sf.km,km.7.slope.ci.sf.km,km.8.slope.ci.sf.km,km.9.slope.ci.sf.km,km.10.slope.ci.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.sf.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[1]],X2=avoid.ci.sf.hm[[2]],Avoids=avoid.ci.sf.hm[[3]])
a2.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[4]],X2=avoid.ci.sf.hm[[5]],Avoids=avoid.ci.sf.hm[[6]])
a3.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[7]],X2=avoid.ci.sf.hm[[8]],Avoids=avoid.ci.sf.hm[[9]])
a4.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[10]],X2=avoid.ci.sf.hm[[11]],Avoids=avoid.ci.sf.hm[[12]])
a5.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[13]],X2=avoid.ci.sf.hm[[14]],Avoids=avoid.ci.sf.hm[[15]])
a6.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[16]],X2=avoid.ci.sf.hm[[17]],Avoids=avoid.ci.sf.hm[[18]])
a7.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[19]],X2=avoid.ci.sf.hm[[20]],Avoids=avoid.ci.sf.hm[[21]])
a8.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[22]],X2=avoid.ci.sf.hm[[23]],Avoids=avoid.ci.sf.hm[[24]])
a9.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[25]],X2=avoid.ci.sf.hm[[26]],Avoids=avoid.ci.sf.hm[[27]])
a10.ci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[28]],X2=avoid.ci.sf.hm[[29]],Avoids=avoid.ci.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.ci.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[1]],X2=conflict.hm.ci.sf[[2]],Victories=conflict.hm.ci.sf[[3]])
mat1.ci.sf.hm<-inter.mat(mut1.ci.sf.hm)
tri1.ci.sf.hm<-tr.tri(mat1.ci.sf.hm)
dci1.ci.sf.hm<-DCindex(mat1.ci.sf.hm)
mat1.ci.sf.hm[is.na(mat1.ci.sf.hm)] = 0
h1.ci.sf.hm<-h.index(mat1.ci.sf.hm)

ep1.ci.sf.hm<-ep(mut1.ci.sf.hm,a1.ci.sf.hm)
david1.ci.sf.hm<-DS(mat1.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.sf.hm<-cbind(ordrank.1.ci.sf.hm,ds=david1.ci.sf.hm$normDS)
lm1.ci.sf.hm<-summary(lm(ordrank.1.ci.sf.hm$ds~ordrank.1.ci.sf.hm$ord.rank))
s1.ci.sf.hm<-lm1.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[4]],X2=conflict.hm.ci.sf[[5]],Victories=conflict.hm.ci.sf[[6]])
mat2.ci.sf.hm<-inter.mat(mut2.ci.sf.hm)
tri2.ci.sf.hm<-tr.tri(mat2.ci.sf.hm)
dci2.ci.sf.hm<-DCindex(mat2.ci.sf.hm)
mat2.ci.sf.hm[is.na(mat2.ci.sf.hm)] = 0
h2.ci.sf.hm<-h.index(mat2.ci.sf.hm)

ep2.ci.sf.hm<-ep(mut2.ci.sf.hm,a2.ci.sf.hm)
david2.ci.sf.hm<-DS(mat2.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.sf.hm<-cbind(ordrank.2.ci.sf.hm,ds=david2.ci.sf.hm$normDS)
lm2.ci.sf.hm<-summary(lm(ordrank.2.ci.sf.hm$ds~ordrank.2.ci.sf.hm$ord.rank))
s2.ci.sf.hm<-lm2.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[7]],X2=conflict.hm.ci.sf[[8]],Victories=conflict.hm.ci.sf[[9]])
mat3.ci.sf.hm<-inter.mat(mut3.ci.sf.hm)
tri3.ci.sf.hm<-tr.tri(mat3.ci.sf.hm)
dci3.ci.sf.hm<-DCindex(mat3.ci.sf.hm)
mat3.ci.sf.hm[is.na(mat3.ci.sf.hm)] = 0
h3.ci.sf.hm<-h.index(mat3.ci.sf.hm)

ep3.ci.sf.hm<-ep(mut3.ci.sf.hm,a3.ci.sf.hm)
david3.ci.sf.hm<-DS(mat3.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.sf.hm<-cbind(ordrank.3.ci.sf.hm,ds=david3.ci.sf.hm$normDS)
lm3.ci.sf.hm<-summary(lm(ordrank.3.ci.sf.hm$ds~ordrank.3.ci.sf.hm$ord.rank))
s3.ci.sf.hm<-lm3.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[10]],X2=conflict.hm.ci.sf[[11]],Victories=conflict.hm.ci.sf[[12]])
mat4.ci.sf.hm<-inter.mat(mut4.ci.sf.hm)
tri4.ci.sf.hm<-tr.tri(mat4.ci.sf.hm)
dci4.ci.sf.hm<-DCindex(mat4.ci.sf.hm)
mat4.ci.sf.hm[is.na(mat4.ci.sf.hm)] = 0
h4.ci.sf.hm<-h.index(mat4.ci.sf.hm)

ep4.ci.sf.hm<-ep(mut4.ci.sf.hm,a4.ci.sf.hm)
david4.ci.sf.hm<-DS(mat4.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.sf.hm<-cbind(ordrank.4.ci.sf.hm,ds=david4.ci.sf.hm$normDS)
lm4.ci.sf.hm<-summary(lm(ordrank.4.ci.sf.hm$ds~ordrank.4.ci.sf.hm$ord.rank))
s4.ci.sf.hm<-lm4.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[13]],X2=conflict.hm.ci.sf[[14]],Victories=conflict.hm.ci.sf[[15]])
mat5.ci.sf.hm<-inter.mat(mut5.ci.sf.hm)
tri5.ci.sf.hm<-tr.tri(mat5.ci.sf.hm)
dci5.ci.sf.hm<-DCindex(mat5.ci.sf.hm)
mat5.ci.sf.hm[is.na(mat5.ci.sf.hm)] = 0
h5.ci.sf.hm<-h.index(mat5.ci.sf.hm)

ep5.ci.sf.hm<-ep(mut5.ci.sf.hm,a5.ci.sf.hm)
david5.ci.sf.hm<-DS(mat5.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.sf.hm<-cbind(ordrank.5.ci.sf.hm,ds=david5.ci.sf.hm$normDS)
lm5.ci.sf.hm<-summary(lm(ordrank.5.ci.sf.hm$ds~ordrank.5.ci.sf.hm$ord.rank))
s5.ci.sf.hm<-lm5.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[16]],X2=conflict.hm.ci.sf[[17]],Victories=conflict.hm.ci.sf[[18]])
mat6.ci.sf.hm<-inter.mat(mut6.ci.sf.hm)
tri6.ci.sf.hm<-tr.tri(mat6.ci.sf.hm)
dci6.ci.sf.hm<-DCindex(mat6.ci.sf.hm)
mat6.ci.sf.hm[is.na(mat6.ci.sf.hm)] = 0
h6.ci.sf.hm<-h.index(mat6.ci.sf.hm)

ep6.ci.sf.hm<-ep(mut6.ci.sf.hm,a6.ci.sf.hm)
david6.ci.sf.hm<-DS(mat6.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.sf.hm<-cbind(ordrank.6.ci.sf.hm,ds=david6.ci.sf.hm$normDS)
lm6.ci.sf.hm<-summary(lm(ordrank.6.ci.sf.hm$ds~ordrank.6.ci.sf.hm$ord.rank))
s6.ci.sf.hm<-lm6.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[19]],X2=conflict.hm.ci.sf[[20]],Victories=conflict.hm.ci.sf[[21]])
mat7.ci.sf.hm<-inter.mat(mut7.ci.sf.hm)
tri7.ci.sf.hm<-tr.tri(mat7.ci.sf.hm)
dci7.ci.sf.hm<-DCindex(mat7.ci.sf.hm)
mat7.ci.sf.hm[is.na(mat7.ci.sf.hm)] = 0
h7.ci.sf.hm<-h.index(mat7.ci.sf.hm)

ep7.ci.sf.hm<-ep(mut7.ci.sf.hm,a7.ci.sf.hm)
david7.ci.sf.hm<-DS(mat7.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.sf.hm<-cbind(ordrank.7.ci.sf.hm,ds=david7.ci.sf.hm$normDS)
lm7.ci.sf.hm<-summary(lm(ordrank.7.ci.sf.hm$ds~ordrank.7.ci.sf.hm$ord.rank))
s7.ci.sf.hm<-lm7.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[22]],X2=conflict.hm.ci.sf[[23]],Victories=conflict.hm.ci.sf[[24]])
mat8.ci.sf.hm<-inter.mat(mut8.ci.sf.hm)
tri8.ci.sf.hm<-tr.tri(mat8.ci.sf.hm)
dci8.ci.sf.hm<-DCindex(mat8.ci.sf.hm)
mat8.ci.sf.hm[is.na(mat8.ci.sf.hm)] = 0
h8.ci.sf.hm<-h.index(mat8.ci.sf.hm)

ep8.ci.sf.hm<-ep(mut8.ci.sf.hm,a8.ci.sf.hm)
david8.ci.sf.hm<-DS(mat8.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.sf.hm<-cbind(ordrank.8.ci.sf.hm,ds=david8.ci.sf.hm$normDS)
lm8.ci.sf.hm<-summary(lm(ordrank.8.ci.sf.hm$ds~ordrank.8.ci.sf.hm$ord.rank))
s8.ci.sf.hm<-lm8.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[25]],X2=conflict.hm.ci.sf[[26]],Victories=conflict.hm.ci.sf[[27]])
mat9.ci.sf.hm<-inter.mat(mut9.ci.sf.hm)
tri9.ci.sf.hm<-tr.tri(mat9.ci.sf.hm)
dci9.ci.sf.hm<-DCindex(mat9.ci.sf.hm)
mat9.ci.sf.hm[is.na(mat9.ci.sf.hm)] = 0
h9.ci.sf.hm<-h.index(mat9.ci.sf.hm)

ep9.ci.sf.hm<-ep(mut9.ci.sf.hm,a9.ci.sf.hm)
david9.ci.sf.hm<-DS(mat9.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.sf.hm<-cbind(ordrank.9.ci.sf.hm,ds=david9.ci.sf.hm$normDS)
lm9.ci.sf.hm<-summary(lm(ordrank.9.ci.sf.hm$ds~ordrank.9.ci.sf.hm$ord.rank))
s9.ci.sf.hm<-lm9.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.sf.hm<-data.frame(X1=conflict.hm.ci.sf[[28]],X2=conflict.hm.ci.sf[[29]],Victories=conflict.hm.ci.sf[[30]])
mat10.ci.sf.hm<-inter.mat(mut10.ci.sf.hm)
tri10.ci.sf.hm<-tr.tri(mat10.ci.sf.hm)
dci10.ci.sf.hm<-DCindex(mat10.ci.sf.hm)
mat10.ci.sf.hm[is.na(mat10.ci.sf.hm)] = 0
h10.ci.sf.hm<-h.index(mat10.ci.sf.hm)

ep10.ci.sf.hm<-ep(mut10.ci.sf.hm,a10.ci.sf.hm)
david10.ci.sf.hm<-DS(mat10.ci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.ci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.sf.hm<-cbind(ordrank.10.ci.sf.hm,ds=david10.ci.sf.hm$normDS)
lm10.ci.sf.hm<-summary(lm(ordrank.10.ci.sf.hm$ds~ordrank.10.ci.sf.hm$ord.rank))
s10.ci.sf.hm<-lm10.ci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.sf.hm<-sum(mut1.ci.sf.hm$Victories)
int2.ci.sf.hm<-sum(mut2.ci.sf.hm$Victories)
int3.ci.sf.hm<-sum(mut3.ci.sf.hm$Victories)
int4.ci.sf.hm<-sum(mut4.ci.sf.hm$Victories)
int5.ci.sf.hm<-sum(mut5.ci.sf.hm$Victories)
int6.ci.sf.hm<-sum(mut6.ci.sf.hm$Victories)
int7.ci.sf.hm<-sum(mut7.ci.sf.hm$Victories)
int8.ci.sf.hm<-sum(mut8.ci.sf.hm$Victories)
int9.ci.sf.hm<-sum(mut9.ci.sf.hm$Victories)
int10.ci.sf.hm<-sum(mut10.ci.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.ci.sf.hm<-sum(a1.ci.sf.hm$Avoids)
av2.ci.sf.hm<-sum(a2.ci.sf.hm$Avoids)
av3.ci.sf.hm<-sum(a3.ci.sf.hm$Avoids)
av4.ci.sf.hm<-sum(a4.ci.sf.hm$Avoids)
av5.ci.sf.hm<-sum(a5.ci.sf.hm$Avoids)
av6.ci.sf.hm<-sum(a6.ci.sf.hm$Avoids)
av7.ci.sf.hm<-sum(a7.ci.sf.hm$Avoids)
av8.ci.sf.hm<-sum(a8.ci.sf.hm$Avoids)
av9.ci.sf.hm<-sum(a9.ci.sf.hm$Avoids)
av10.ci.sf.hm<-sum(a10.ci.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.ci.sf<-(sum(av1.ci.sf.hm, av2.ci.sf.hm, av3.ci.sf.hm, av4.ci.sf.hm, av5.ci.sf.hm, av6.ci.sf.hm, av7.ci.sf.hm, av8.ci.sf.hm, av9.ci.sf.hm, av10.ci.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.ci.sf<-(sum(int1.ci.sf.hm, int2.ci.sf.hm, int3.ci.sf.hm, int4.ci.sf.hm, int5.ci.sf.hm, int6.ci.sf.hm, int7.ci.sf.hm, int8.ci.sf.hm, int9.ci.sf.hm, int10.ci.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.sf.hm<-e1.ci.sf.hm[order(e1.ci.sf.hm$ID),]
e1.ci.sf.hm<-as.matrix(t(e1.1.ci.sf.hm))

e2.ci.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.sf.hm<-e2.ci.sf.hm[order(e2.ci.sf.hm$ID),]
e2.ci.sf.hm<-as.matrix(t(e2.1.ci.sf.hm))

e3.ci.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.sf.hm<-e3.ci.sf.hm[order(e3.ci.sf.hm$ID),]
e3.ci.sf.hm<-as.matrix(t(e3.1.ci.sf.hm))

e4.ci.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.sf.hm<-e4.ci.sf.hm[order(e4.ci.sf.hm$ID),]
e4.ci.sf.hm<-as.matrix(t(e4.1.ci.sf.hm))

e5.ci.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.sf.hm<-e5.ci.sf.hm[order(e5.ci.sf.hm$ID),]
e5.ci.sf.hm<-as.matrix(t(e5.1.ci.sf.hm))

e6.ci.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.sf.hm<-e6.ci.sf.hm[order(e6.ci.sf.hm$ID),]
e6.ci.sf.hm<-as.matrix(t(e6.1.ci.sf.hm))

e7.ci.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.sf.hm<-e7.ci.sf.hm[order(e7.ci.sf.hm$ID),]
e7.ci.sf.hm<-as.matrix(t(e7.1.ci.sf.hm))

e8.ci.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.sf.hm<-e8.ci.sf.hm[order(e8.ci.sf.hm$ID),]
e8.ci.sf.hm<-as.matrix(t(e8.1.ci.sf.hm))

e9.ci.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.sf.hm<-e9.ci.sf.hm[order(e9.ci.sf.hm$ID),]
e9.ci.sf.hm<-as.matrix(t(e9.1.ci.sf.hm))

e10.ci.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.sf.hm<-e10.ci.sf.hm[order(e10.ci.sf.hm$ID),]
e10.ci.sf.hm<-as.matrix(t(e10.1.ci.sf.hm))

energy.hm.ci.sf.hm<-as.data.frame(matrix(c(e1.ci.sf.hm,e2.ci.sf.hm,e3.ci.sf.hm,e4.ci.sf.hm,e5.ci.sf.hm,e6.ci.sf.hm,e7.ci.sf.hm,e8.ci.sf.hm,e9.ci.sf.hm,e10.ci.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.ci.sf.hm<-data.frame(ID=energy.hm.ci.sf.hm$V1,energy_over_distance=energy.hm.ci.sf.hm$V2,energy_over_time=energy.hm.ci.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.sf.hm<-david1.ci.sf.hm[order(david1.ci.sf.hm$ID),]
david1.ci.sf.hm<-as.matrix(t(david1.1.ci.sf.hm))

david2.1.ci.sf.hm<-david2.ci.sf.hm[order(david2.ci.sf.hm$ID),]
david2.ci.sf.hm<-as.matrix(t(david2.1.ci.sf.hm))

david3.1.ci.sf.hm<-david3.ci.sf.hm[order(david3.ci.sf.hm$ID),]
david3.ci.sf.hm<-as.matrix(t(david3.1.ci.sf.hm))

david4.1.ci.sf.hm<-david4.ci.sf.hm[order(david4.ci.sf.hm$ID),]
david4.ci.sf.hm<-as.matrix(t(david4.1.ci.sf.hm))

david5.1.ci.sf.hm<-david5.ci.sf.hm[order(david5.ci.sf.hm$ID),]
david5.ci.sf.hm<-as.matrix(t(david5.1.ci.sf.hm))

david6.1.ci.sf.hm<-david6.ci.sf.hm[order(david6.ci.sf.hm$ID),]
david6.ci.sf.hm<-as.matrix(t(david6.1.ci.sf.hm))

david7.1.ci.sf.hm<-david7.ci.sf.hm[order(david7.ci.sf.hm$ID),]
david7.ci.sf.hm<-as.matrix(t(david7.1.ci.sf.hm))

david8.1.ci.sf.hm<-david8.ci.sf.hm[order(david8.ci.sf.hm$ID),]
david8.ci.sf.hm<-as.matrix(t(david8.1.ci.sf.hm))

david9.1.ci.sf.hm<-david9.ci.sf.hm[order(david9.ci.sf.hm$ID),]
david9.ci.sf.hm<-as.matrix(t(david9.1.ci.sf.hm))

david10.1.ci.sf.hm<-david10.ci.sf.hm[order(david10.ci.sf.hm$ID),]
david10.ci.sf.hm<-as.matrix(t(david10.1.ci.sf.hm))

david.hm.ci.sf.hm<-as.data.frame(matrix(c(david1.ci.sf.hm,david2.ci.sf.hm,david3.ci.sf.hm,david4.ci.sf.hm,david5.ci.sf.hm,david6.ci.sf.hm,david7.ci.sf.hm,david8.ci.sf.hm,david9.ci.sf.hm,david10.ci.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.ci.sf.hm<-data.frame(ID=david.hm.ci.sf.hm$V1,DS=david.hm.ci.sf.hm$V2,normDS=david.hm.ci.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.ci.sf.hm<-lm(e1.1.ci.sf.hm$energy_over_time~as.numeric(david1.1.ci.sf.hm$normDS))
hm.lm.1.s.ci.sf.hm<-summary(lm.hm.1.ci.sf.hm)$coefficients
hm.1.slope.ci.sf.hm<-hm.lm.1.s.ci.sf.hm[2,1]
lm.hm.2.ci.sf.hm<-lm(e2.1.ci.sf.hm$energy_over_time~as.numeric(david2.1.ci.sf.hm$normDS))
hm.lm.2.s.ci.sf.hm<-summary(lm.hm.2.ci.sf.hm)$coefficients
hm.2.slope.ci.sf.hm<-hm.lm.2.s.ci.sf.hm[2,1]
lm.hm.3.ci.sf.hm<-lm(e3.1.ci.sf.hm$energy_over_time~as.numeric(david3.1.ci.sf.hm$normDS))
hm.lm.3.s.ci.sf.hm<-summary(lm.hm.3.ci.sf.hm)$coefficients
hm.3.slope.ci.sf.hm<-hm.lm.3.s.ci.sf.hm[2,1]
lm.hm.4.ci.sf.hm<-lm(e4.1.ci.sf.hm$energy_over_time~as.numeric(david4.1.ci.sf.hm$normDS))
hm.lm.4.s.ci.sf.hm<-summary(lm.hm.4.ci.sf.hm)$coefficients
hm.4.slope.ci.sf.hm<-hm.lm.4.s.ci.sf.hm[2,1]
lm.hm.5.ci.sf.hm<-lm(e5.1.ci.sf.hm$energy_over_time~as.numeric(david5.1.ci.sf.hm$normDS))
hm.lm.5.s.ci.sf.hm<-summary(lm.hm.5.ci.sf.hm)$coefficients
hm.5.slope.ci.sf.hm<-hm.lm.5.s.ci.sf.hm[2,1]
lm.hm.6.ci.sf.hm<-lm(e6.1.ci.sf.hm$energy_over_time~as.numeric(david6.1.ci.sf.hm$normDS))
hm.lm.6.s.ci.sf.hm<-summary(lm.hm.6.ci.sf.hm)$coefficients
hm.6.slope.ci.sf.hm<-hm.lm.6.s.ci.sf.hm[2,1]
lm.hm.7.ci.sf.hm<-lm(e7.1.ci.sf.hm$energy_over_time~as.numeric(david7.1.ci.sf.hm$normDS))
hm.lm.7.s.ci.sf.hm<-summary(lm.hm.7.ci.sf.hm)$coefficients
hm.7.slope.ci.sf.hm<-hm.lm.7.s.ci.sf.hm[2,1]
lm.hm.8.ci.sf.hm<-lm(e8.1.ci.sf.hm$energy_over_time~as.numeric(david8.1.ci.sf.hm$normDS))
hm.lm.8.s.ci.sf.hm<-summary(lm.hm.8.ci.sf.hm)$coefficients
hm.8.slope.ci.sf.hm<-hm.lm.8.s.ci.sf.hm[2,1]
lm.hm.9.ci.sf.hm<-lm(e9.1.ci.sf.hm$energy_over_time~as.numeric(david9.1.ci.sf.hm$normDS))
hm.lm.9.s.ci.sf.hm<-summary(lm.hm.9.ci.sf.hm)$coefficients
hm.9.slope.ci.sf.hm<-hm.lm.9.s.ci.sf.hm[2,1]
lm.hm.10.ci.sf.hm<-lm(e10.1.ci.sf.hm$energy_over_time~as.numeric(david10.1.ci.sf.hm$normDS))
hm.lm.10.s.ci.sf.hm<-summary(lm.hm.10.ci.sf.hm)$coefficients
hm.10.slope.ci.sf.hm<-hm.lm.10.s.ci.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.ci.sf.ss<-data.frame(triangle.transitivity=c(tri1.ci.sf.hm,tri2.ci.sf.hm,tri3.ci.sf.hm,tri4.ci.sf.hm,tri5.ci.sf.hm,tri6.ci.sf.hm,tri7.ci.sf.hm,tri8.ci.sf.hm,tri9.ci.sf.hm,tri10.ci.sf.hm),escalation=c(ep1.ci.sf.hm,ep2.ci.sf.hm,ep3.ci.sf.hm,ep4.ci.sf.hm,ep5.ci.sf.hm,ep6.ci.sf.hm,ep7.ci.sf.hm,ep8.ci.sf.hm,ep9.ci.sf.hm,ep10.ci.sf.hm),dci=c(dci1.ci.sf.hm,dci2.ci.sf.hm,dci3.ci.sf.hm,dci4.ci.sf.hm,dci5.ci.sf.hm,dci6.ci.sf.hm,dci7.ci.sf.hm,dci8.ci.sf.hm,dci9.ci.sf.hm,dci10.ci.sf.hm),steepness=c(s1.ci.sf.hm,s2.ci.sf.hm,s3.ci.sf.hm,s4.ci.sf.hm,s5.ci.sf.hm,s6.ci.sf.hm,s7.ci.sf.hm,s8.ci.sf.hm,s9.ci.sf.hm,s10.ci.sf.hm),slope=c(hm.1.slope.ci.sf.hm,hm.2.slope.ci.sf.hm,hm.3.slope.ci.sf.hm,hm.4.slope.ci.sf.hm,hm.5.slope.ci.sf.hm,hm.6.slope.ci.sf.hm,hm.7.slope.ci.sf.hm,hm.8.slope.ci.sf.hm,hm.9.slope.ci.sf.hm,hm.10.slope.ci.sf.hm))
```
```{r Clumped Initiator Wins Deterministic Data Frame}
# Generate energy data frame:
total.energy.ci.sf<-data.frame(energy.km.df.ci.sf.km)
total.energy.ci.sf<-rbind(total.energy.ci.sf,energy.hm.df.ci.sf.hm)

total.david.ci.sf<-data.frame(david.km.df.ci.sf.km)
total.david.ci.sf<-rbind(total.david.ci.sf,david.hm.df.ci.sf.hm)

total.energy.ci.sf<-cbind(total.energy.ci.sf,normDS=total.david.ci.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.ci.sf<-mean(km.ci.sf.ss$triangle.transitivity)
  km.ci.sfi.ci.sf<-mean(km.ci.sf.ss$dci)
  km.esc.ci.sf<-mean(km.ci.sf.ss$escalation)
  km.steep.ci.sf<-mean(km.ci.sf.ss$steepness)
  km.slope.ci.sf<-mean(km.ci.sf.ss$slope)
  km.mean.ci.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.ci.sf,dci=km.ci.sfi.ci.sf,esc=km.esc.ci.sf,steepness=km.steep.ci.sf,slope=km.slope.ci.sf,dist="clumped",calc="deterministic")

  # history mutual
  hm.tt.ci.sf<-mean(hm.ci.sf.ss$triangle.transitivity)
  hm.ci.sfi.ci.sf<-mean(hm.ci.sf.ss$dci)
  hm.esc.ci.sf<-mean(hm.ci.sf.ss$escalation)
  hm.steep.ci.sf<-mean(hm.ci.sf.ss$steepness)
  hm.slope.ci.sf<-mean(hm.ci.sf.ss$slope)
  hm.mean.ci.sf<-data.frame(scenario="History Mutual",tt=hm.tt.ci.sf,dci=hm.ci.sfi.ci.sf,esc=hm.esc.ci.sf,steepness=hm.steep.ci.sf,slope=hm.slope.ci.sf,dist="clumped",calc="deterministic")

# Data frame of all averages
dc.ave<-rbind(km.mean.ci.sf,hm.mean.ci.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.ci.sf<-mean(km.ci.sf.ss$triangle.transitivity)
  km.ci.sfi.ci.sf<-mean(km.ci.sf.ss$dci)
  km.esc.ci.sf<-mean(km.ci.sf.ss$escalation)
  km.steep.ci.sf<-mean(km.ci.sf.ss$steepness)
  km.slope.ci.sf<-mean(km.ci.sf.ss$slope)
  km.mean.ci.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ci.sf,dci=km.ci.sfi.ci.sf,esc=km.esc.ci.sf,steepness=km.steep.ci.sf,slope=km.slope.ci.sf,dist="clumped",calc="deterministic")
  
  #history mutual
  hm.tt.ci.sf<-mean(hm.ci.sf.ss$triangle.transitivity)
  hm.ci.sfi.ci.sf<-mean(hm.ci.sf.ss$dci)
  hm.esc.ci.sf<-mean(hm.ci.sf.ss$escalation)
  hm.steep.ci.sf<-mean(hm.ci.sf.ss$steepness)
  hm.slope.ci.sf<-mean(hm.ci.sf.ss$slope)
  hm.mean.ci.sf<-data.frame(scenario="History Mutual",tt=hm.tt.ci.sf,dci=hm.ci.sfi.ci.sf,esc=hm.esc.ci.sf,steepness=hm.steep.ci.sf,slope=hm.slope.ci.sf,dist="clumped",calc="deterministic")
  
# Generate data frame for all averages:
sf.initiator.ave<-rbind(km.mean.ci.sf,hm.mean.ci.sf)

# Create overall dataframe of summary statistics:
overall.clump.sf.initiator.sf<-data.frame(km.ci.sf.ss)
overall.clump.sf.initiator.sf<-rbind(overall.clump.sf.initiator.sf,hm.ci.sf.ss)

overall.clump.sf.initiator.sf<-cbind(overall.clump.sf.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.clump.sf.initiator.sf<-cbind(overall.clump.sf.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("initiator",20))


rhp.ci.sf.ss<-overall.clump.sf.initiator.sf[overall.clump.sf.initiator.sf$variable=="rhp",]
history.ci.sf.ss<-overall.clump.sf.initiator.sf[overall.clump.sf.initiator.sf$variable=="history",]

overall.clump.sf.initiator.sf$combo<-paste(overall.clump.sf.initiator.sf$strategy,overall.clump.sf.initiator.sf$variable,overall.clump.sf.initiator.sf$distribution)
overall.clump.sf.initiator.sf$combo2<-paste(overall.clump.sf.initiator.sf$strategy,overall.clump.sf.initiator.sf$variable) #final dataframe for deterministic clumped data
```

## Avoids Clumped Initiator Wins Data
```{r Avoids Clumped Initiator Wins Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.sf.km<-sapply(files, read.csv)

# Generate avoid.ci.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[1]],X2=avoid.ci.sf.km[[2]],Avoids=avoid.ci.sf.km[[3]])
mat1.aci.sf.km<-avoid.inter.mat(mut1.aci.sf.km)
tri1.aci.sf.km<-tr.tri(mat1.aci.sf.km)
dci1.aci.sf.km<-DCindex(mat1.aci.sf.km)
mat1.aci.sf.km[is.na(mat1.aci.sf.km)] = 0
h1.aci.sf.km<-h.index(mat1.aci.sf.km)

ep1.aci.sf.km<-ep(mut1.aci.sf.km,a1.ci.sf.km)
david1.aci.sf.km<-DS(mat1.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.sf.km<-cbind(ordrank.1.aci.sf.km,ds=david1.aci.sf.km$normDS)
lm1.aci.sf.km<-summary(lm(ordrank.1.aci.sf.km$ds~ordrank.1.aci.sf.km$ord.rank))
s1.aci.sf.km<-lm1.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[4]],X2=avoid.ci.sf.km[[5]],Avoids=avoid.ci.sf.km[[6]])
mat2.aci.sf.km<-avoid.inter.mat(mut2.aci.sf.km)
tri2.aci.sf.km<-tr.tri(mat2.aci.sf.km)
dci2.aci.sf.km<-DCindex(mat2.aci.sf.km)
mat2.aci.sf.km[is.na(mat2.aci.sf.km)] = 0
h2.aci.sf.km<-h.index(mat2.aci.sf.km)

ep2.aci.sf.km<-ep(mut2.aci.sf.km,a2.ci.sf.km)
david2.aci.sf.km<-DS(mat2.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.sf.km<-cbind(ordrank.2.aci.sf.km,ds=david2.aci.sf.km$normDS)
lm2.aci.sf.km<-summary(lm(ordrank.2.aci.sf.km$ds~ordrank.2.aci.sf.km$ord.rank))
s2.aci.sf.km<-lm2.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[7]],X2=avoid.ci.sf.km[[8]],Avoids=avoid.ci.sf.km[[9]])
mat3.aci.sf.km<-avoid.inter.mat(mut3.aci.sf.km)
tri3.aci.sf.km<-tr.tri(mat3.aci.sf.km)
dci3.aci.sf.km<-DCindex(mat3.aci.sf.km)
mat3.aci.sf.km[is.na(mat3.aci.sf.km)] = 0
h3.aci.sf.km<-h.index(mat3.aci.sf.km)

ep3.aci.sf.km<-ep(mut3.aci.sf.km,a3.ci.sf.km)
david3.aci.sf.km<-DS(mat3.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.sf.km<-cbind(ordrank.3.aci.sf.km,ds=david3.aci.sf.km$normDS)
lm3.aci.sf.km<-summary(lm(ordrank.3.aci.sf.km$ds~ordrank.3.aci.sf.km$ord.rank))
s3.aci.sf.km<-lm3.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[10]],X2=avoid.ci.sf.km[[11]],Avoids=avoid.ci.sf.km[[12]])
mat4.aci.sf.km<-avoid.inter.mat(mut4.aci.sf.km)
tri4.aci.sf.km<-tr.tri(mat4.aci.sf.km)
dci4.aci.sf.km<-DCindex(mat4.aci.sf.km)
mat4.aci.sf.km[is.na(mat4.aci.sf.km)] = 0
h4.aci.sf.km<-h.index(mat4.aci.sf.km)

ep4.aci.sf.km<-ep(mut4.aci.sf.km,a4.ci.sf.km)
david4.aci.sf.km<-DS(mat4.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.sf.km<-cbind(ordrank.4.aci.sf.km,ds=david4.aci.sf.km$normDS)
lm4.aci.sf.km<-summary(lm(ordrank.4.aci.sf.km$ds~ordrank.4.aci.sf.km$ord.rank))
s4.aci.sf.km<-lm4.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[13]],X2=avoid.ci.sf.km[[14]],Avoids=avoid.ci.sf.km[[15]])
mat5.aci.sf.km<-avoid.inter.mat(mut5.aci.sf.km)
tri5.aci.sf.km<-tr.tri(mat5.aci.sf.km)
dci5.aci.sf.km<-DCindex(mat5.aci.sf.km)
mat5.aci.sf.km[is.na(mat5.aci.sf.km)] = 0
h5.aci.sf.km<-h.index(mat5.aci.sf.km)

ep5.aci.sf.km<-ep(mut5.aci.sf.km,a5.ci.sf.km)
david5.aci.sf.km<-DS(mat5.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.sf.km<-cbind(ordrank.5.aci.sf.km,ds=david5.aci.sf.km$normDS)
lm5.aci.sf.km<-summary(lm(ordrank.5.aci.sf.km$ds~ordrank.5.aci.sf.km$ord.rank))
s5.aci.sf.km<-lm5.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[16]],X2=avoid.ci.sf.km[[17]],Avoids=avoid.ci.sf.km[[18]])
mat6.aci.sf.km<-avoid.inter.mat(mut6.aci.sf.km)
tri6.aci.sf.km<-tr.tri(mat6.aci.sf.km)
dci6.aci.sf.km<-DCindex(mat6.aci.sf.km)
mat6.aci.sf.km[is.na(mat6.aci.sf.km)] = 0
h6.aci.sf.km<-h.index(mat6.aci.sf.km)

ep6.aci.sf.km<-ep(mut6.aci.sf.km,a6.ci.sf.km)
david6.aci.sf.km<-DS(mat6.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.sf.km<-cbind(ordrank.6.aci.sf.km,ds=david6.aci.sf.km$normDS)
lm6.aci.sf.km<-summary(lm(ordrank.6.aci.sf.km$ds~ordrank.6.aci.sf.km$ord.rank))
s6.aci.sf.km<-lm6.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[19]],X2=avoid.ci.sf.km[[20]],Avoids=avoid.ci.sf.km[[21]])
mat7.aci.sf.km<-avoid.inter.mat(mut7.aci.sf.km)
tri7.aci.sf.km<-tr.tri(mat7.aci.sf.km)
dci7.aci.sf.km<-DCindex(mat7.aci.sf.km)
mat7.aci.sf.km[is.na(mat7.aci.sf.km)] = 0
h7.aci.sf.km<-h.index(mat7.aci.sf.km)

ep7.aci.sf.km<-ep(mut7.aci.sf.km,a7.ci.sf.km)
david7.aci.sf.km<-DS(mat7.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.sf.km<-cbind(ordrank.7.aci.sf.km,ds=david7.aci.sf.km$normDS)
lm7.aci.sf.km<-summary(lm(ordrank.7.aci.sf.km$ds~ordrank.7.aci.sf.km$ord.rank))
s7.aci.sf.km<-lm7.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[22]],X2=avoid.ci.sf.km[[23]],Avoids=avoid.ci.sf.km[[24]])
mat8.aci.sf.km<-avoid.inter.mat(mut8.aci.sf.km)
tri8.aci.sf.km<-tr.tri(mat8.aci.sf.km)
dci8.aci.sf.km<-DCindex(mat8.aci.sf.km)
mat8.aci.sf.km[is.na(mat8.aci.sf.km)] = 0
h8.aci.sf.km<-h.index(mat8.aci.sf.km)

ep8.aci.sf.km<-ep(mut8.aci.sf.km,a8.ci.sf.km)
david8.aci.sf.km<-DS(mat8.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.sf.km<-cbind(ordrank.8.aci.sf.km,ds=david8.aci.sf.km$normDS)
lm8.aci.sf.km<-summary(lm(ordrank.8.aci.sf.km$ds~ordrank.8.aci.sf.km$ord.rank))
s8.aci.sf.km<-lm8.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[25]],X2=avoid.ci.sf.km[[26]],Avoids=avoid.ci.sf.km[[27]])
mat9.aci.sf.km<-avoid.inter.mat(mut9.aci.sf.km)
tri9.aci.sf.km<-tr.tri(mat9.aci.sf.km)
dci9.aci.sf.km<-DCindex(mat9.aci.sf.km)
mat9.aci.sf.km[is.na(mat9.aci.sf.km)] = 0
h9.aci.sf.km<-h.index(mat9.aci.sf.km)

ep9.aci.sf.km<-ep(mut9.aci.sf.km,a9.ci.sf.km)
david9.aci.sf.km<-DS(mat9.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.sf.km<-cbind(ordrank.9.aci.sf.km,ds=david9.aci.sf.km$normDS)
lm9.aci.sf.km<-summary(lm(ordrank.9.aci.sf.km$ds~ordrank.9.aci.sf.km$ord.rank))
s9.aci.sf.km<-lm9.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.sf.km<-data.frame(X1=avoid.ci.sf.km[[28]],X2=avoid.ci.sf.km[[29]],Avoids=avoid.ci.sf.km[[30]])
mat10.aci.sf.km<-avoid.inter.mat(mut10.aci.sf.km)
tri10.aci.sf.km<-tr.tri(mat10.aci.sf.km)
dci10.aci.sf.km<-DCindex(mat10.aci.sf.km)
mat10.aci.sf.km[is.na(mat10.aci.sf.km)] = 0
h10.aci.sf.km<-h.index(mat10.aci.sf.km)

ep10.aci.sf.km<-ep(mut10.aci.sf.km,a10.ci.sf.km)
david10.aci.sf.km<-DS(mat10.aci.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.aci.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.sf.km<-cbind(ordrank.10.aci.sf.km,ds=david10.aci.sf.km$normDS)
lm10.aci.sf.km<-summary(lm(ordrank.10.aci.sf.km$ds~ordrank.10.aci.sf.km$ord.rank))
s10.aci.sf.km<-lm10.aci.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.sf.km<-sum(mut1.aci.sf.km$Victories)
int2.aci.sf.km<-sum(mut2.aci.sf.km$Victories)
int3.aci.sf.km<-sum(mut3.aci.sf.km$Victories)
int4.aci.sf.km<-sum(mut4.aci.sf.km$Victories)
int5.aci.sf.km<-sum(mut5.aci.sf.km$Victories)
int6.aci.sf.km<-sum(mut6.aci.sf.km$Victories)
int7.aci.sf.km<-sum(mut7.aci.sf.km$Victories)
int8.aci.sf.km<-sum(mut8.aci.sf.km$Victories)
int9.aci.sf.km<-sum(mut9.aci.sf.km$Victories)
int10.aci.sf.km<-sum(mut10.aci.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.aci.sf.km<-sum(a1.ci.sf.km$Avoids)
av2.aci.sf.km<-sum(a2.ci.sf.km$Avoids)
av3.aci.sf.km<-sum(a3.ci.sf.km$Avoids)
av4.aci.sf.km<-sum(a4.ci.sf.km$Avoids)
av5.aci.sf.km<-sum(a5.ci.sf.km$Avoids)
av6.aci.sf.km<-sum(a6.ci.sf.km$Avoids)
av7.aci.sf.km<-sum(a7.ci.sf.km$Avoids)
av8.aci.sf.km<-sum(a8.ci.sf.km$Avoids)
av9.aci.sf.km<-sum(a9.ci.sf.km$Avoids)
av10.aci.sf.km<-sum(a10.ci.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.aci.sf<-(sum(av1.aci.sf.km, av2.aci.sf.km, av3.aci.sf.km, av4.aci.sf.km, av5.aci.sf.km, av6.aci.sf.km, av7.aci.sf.km, av8.aci.sf.km, av9.aci.sf.km, av10.aci.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.aci.sf<-(sum(int1.aci.sf.km, int2.aci.sf.km, int3.aci.sf.km, int4.aci.sf.km, int5.aci.sf.km, int6.aci.sf.km, int7.aci.sf.km, int8.aci.sf.km, int9.aci.sf.km, int10.aci.sf.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.sf.km<-e1.aci.sf.km[order(e1.aci.sf.km$ID),]
e1.aci.sf.km<-as.matrix(t(e1.1.aci.sf.km))

e2.aci.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.sf.km<-e2.aci.sf.km[order(e2.aci.sf.km$ID),]
e2.aci.sf.km<-as.matrix(t(e2.1.aci.sf.km))

e3.aci.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.sf.km<-e3.aci.sf.km[order(e3.aci.sf.km$ID),]
e3.aci.sf.km<-as.matrix(t(e3.1.aci.sf.km))

e4.aci.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.sf.km<-e4.aci.sf.km[order(e4.aci.sf.km$ID),]
e4.aci.sf.km<-as.matrix(t(e4.1.aci.sf.km))

e5.aci.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.sf.km<-e5.aci.sf.km[order(e5.aci.sf.km$ID),]
e5.aci.sf.km<-as.matrix(t(e5.1.aci.sf.km))

e6.aci.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.sf.km<-e6.aci.sf.km[order(e6.aci.sf.km$ID),]
e6.aci.sf.km<-as.matrix(t(e6.1.aci.sf.km))

e7.aci.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.sf.km<-e7.aci.sf.km[order(e7.aci.sf.km$ID),]
e7.aci.sf.km<-as.matrix(t(e7.1.aci.sf.km))

e8.aci.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.sf.km<-e8.aci.sf.km[order(e8.aci.sf.km$ID),]
e8.aci.sf.km<-as.matrix(t(e8.1.aci.sf.km))

e9.aci.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.sf.km<-e9.aci.sf.km[order(e9.aci.sf.km$ID),]
e9.aci.sf.km<-as.matrix(t(e9.1.aci.sf.km))

e10.aci.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.sf.km<-e10.aci.sf.km[order(e10.aci.sf.km$ID),]
e10.aci.sf.km<-as.matrix(t(e10.1.aci.sf.km))

energy.km.aci.sf.km<-as.data.frame(matrix(c(e1.aci.sf.km,e2.aci.sf.km,e3.aci.sf.km,e4.aci.sf.km,e5.aci.sf.km,e6.aci.sf.km,e7.aci.sf.km,e8.aci.sf.km,e9.aci.sf.km,e10.aci.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aci.sf.km<-data.frame(ID=energy.km.aci.sf.km$V1,energy_over_distance=energy.km.aci.sf.km$V2,energy_over_time=energy.km.aci.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.sf.km<-david1.aci.sf.km[order(david1.aci.sf.km$ID),]
david1.aci.sf.km<-as.matrix(t(david1.1.aci.sf.km))

david2.1.aci.sf.km<-david2.aci.sf.km[order(david2.aci.sf.km$ID),]
david2.aci.sf.km<-as.matrix(t(david2.1.aci.sf.km))

david3.1.aci.sf.km<-david3.aci.sf.km[order(david3.aci.sf.km$ID),]
david3.aci.sf.km<-as.matrix(t(david3.1.aci.sf.km))

david4.1.aci.sf.km<-david4.aci.sf.km[order(david4.aci.sf.km$ID),]
david4.aci.sf.km<-as.matrix(t(david4.1.aci.sf.km))

david5.1.aci.sf.km<-david5.aci.sf.km[order(david5.aci.sf.km$ID),]
david5.aci.sf.km<-as.matrix(t(david5.1.aci.sf.km))

david6.1.aci.sf.km<-david6.aci.sf.km[order(david6.aci.sf.km$ID),]
david6.aci.sf.km<-as.matrix(t(david6.1.aci.sf.km))

david7.1.aci.sf.km<-david7.aci.sf.km[order(david7.aci.sf.km$ID),]
david7.aci.sf.km<-as.matrix(t(david7.1.aci.sf.km))

david8.1.aci.sf.km<-david8.aci.sf.km[order(david8.aci.sf.km$ID),]
david8.aci.sf.km<-as.matrix(t(david8.1.aci.sf.km))

david9.1.aci.sf.km<-david9.aci.sf.km[order(david9.aci.sf.km$ID),]
david9.aci.sf.km<-as.matrix(t(david9.1.aci.sf.km))

david10.1.aci.sf.km<-david10.aci.sf.km[order(david10.aci.sf.km$ID),]
david10.aci.sf.km<-as.matrix(t(david10.1.aci.sf.km))

david.km.aci.sf.km<-as.data.frame(matrix(c(david1.aci.sf.km,david2.aci.sf.km,david3.aci.sf.km,david4.aci.sf.km,david5.aci.sf.km,david6.aci.sf.km,david7.aci.sf.km,david8.aci.sf.km,david9.aci.sf.km,david10.aci.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aci.sf.km<-data.frame(ID=david.km.aci.sf.km$V1,DS=david.km.aci.sf.km$V2,normDS=david.km.aci.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aci.sf.km<-lm(e1.1.aci.sf.km$energy_over_time~as.numeric(david1.1.aci.sf.km$normDS))
km.lm.1.s.aci.sf.km<-summary(lm.km.1.aci.sf.km)$coefficients
km.1.slope.aci.sf.km<-km.lm.1.s.aci.sf.km[2,1]
lm.km.2.aci.sf.km<-lm(e2.1.aci.sf.km$energy_over_time~as.numeric(david2.1.aci.sf.km$normDS))
km.lm.2.s.aci.sf.km<-summary(lm.km.2.aci.sf.km)$coefficients
km.2.slope.aci.sf.km<-km.lm.2.s.aci.sf.km[2,1]
lm.km.3.aci.sf.km<-lm(e3.1.aci.sf.km$energy_over_time~as.numeric(david3.1.aci.sf.km$normDS))
km.lm.3.s.aci.sf.km<-summary(lm.km.3.aci.sf.km)$coefficients
km.3.slope.aci.sf.km<-km.lm.3.s.aci.sf.km[2,1]
lm.km.4.aci.sf.km<-lm(e4.1.aci.sf.km$energy_over_time~as.numeric(david4.1.aci.sf.km$normDS))
km.lm.4.s.aci.sf.km<-summary(lm.km.4.aci.sf.km)$coefficients
km.4.slope.aci.sf.km<-km.lm.4.s.aci.sf.km[2,1]
lm.km.5.aci.sf.km<-lm(e5.1.aci.sf.km$energy_over_time~as.numeric(david5.1.aci.sf.km$normDS))
km.lm.5.s.aci.sf.km<-summary(lm.km.5.aci.sf.km)$coefficients
km.5.slope.aci.sf.km<-km.lm.5.s.aci.sf.km[2,1]
lm.km.6.aci.sf.km<-lm(e6.1.aci.sf.km$energy_over_time~as.numeric(david6.1.aci.sf.km$normDS))
km.lm.6.s.aci.sf.km<-summary(lm.km.6.aci.sf.km)$coefficients
km.6.slope.aci.sf.km<-km.lm.6.s.aci.sf.km[2,1]
lm.km.7.aci.sf.km<-lm(e7.1.aci.sf.km$energy_over_time~as.numeric(david7.1.aci.sf.km$normDS))
km.lm.7.s.aci.sf.km<-summary(lm.km.7.aci.sf.km)$coefficients
km.7.slope.aci.sf.km<-km.lm.7.s.aci.sf.km[2,1]
lm.km.8.aci.sf.km<-lm(e8.1.aci.sf.km$energy_over_time~as.numeric(david8.1.aci.sf.km$normDS))
km.lm.8.s.aci.sf.km<-summary(lm.km.8.aci.sf.km)$coefficients
km.8.slope.aci.sf.km<-km.lm.8.s.aci.sf.km[2,1]
lm.km.9.aci.sf.km<-lm(e9.1.aci.sf.km$energy_over_time~as.numeric(david9.1.aci.sf.km$normDS))
km.lm.9.s.aci.sf.km<-summary(lm.km.9.aci.sf.km)$coefficients
km.9.slope.aci.sf.km<-km.lm.9.s.aci.sf.km[2,1]
lm.km.10.aci.sf.km<-lm(e10.1.aci.sf.km$energy_over_time~as.numeric(david10.1.aci.sf.km$normDS))
km.lm.10.s.aci.sf.km<-summary(lm.km.10.aci.sf.km)$coefficients
km.10.slope.aci.sf.km<-km.lm.10.s.aci.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aci.sf.ss.avoid.ci.sf.km<-data.frame(triangle.transitivity=c(tri1.aci.sf.km,tri2.aci.sf.km,tri3.aci.sf.km,tri4.aci.sf.km,tri5.aci.sf.km,tri6.aci.sf.km,tri7.aci.sf.km,tri8.aci.sf.km,tri9.aci.sf.km,tri10.aci.sf.km),escalation=c(ep1.aci.sf.km,ep2.aci.sf.km,ep3.aci.sf.km,ep4.aci.sf.km,ep5.aci.sf.km,ep6.aci.sf.km,ep7.aci.sf.km,ep8.aci.sf.km,ep9.aci.sf.km,ep10.aci.sf.km),dci=c(dci1.aci.sf.km,dci2.aci.sf.km,dci3.aci.sf.km,dci4.aci.sf.km,dci5.aci.sf.km,dci6.aci.sf.km,dci7.aci.sf.km,dci8.aci.sf.km,dci9.aci.sf.km,dci10.aci.sf.km),steepness=c(s1.aci.sf.km,s2.aci.sf.km,s3.aci.sf.km,s4.aci.sf.km,s5.aci.sf.km,s6.aci.sf.km,s7.aci.sf.km,s8.aci.sf.km,s9.aci.sf.km,s10.aci.sf.km),slope=c(km.1.slope.aci.sf.km,km.2.slope.aci.sf.km,km.3.slope.aci.sf.km,km.4.slope.aci.sf.km,km.5.slope.aci.sf.km,km.6.slope.aci.sf.km,km.7.slope.aci.sf.km,km.8.slope.aci.sf.km,km.9.slope.aci.sf.km,km.10.slope.aci.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.sf.hm<-sapply(files, read.csv)

# Generate avoid.ci.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[1]],X2=avoid.ci.sf.hm[[2]],Avoids=avoid.ci.sf.hm[[3]])
mat1.aci.sf.hm<-avoid.inter.mat(mut1.aci.sf.hm)
tri1.aci.sf.hm<-tr.tri(mat1.aci.sf.hm)
dci1.aci.sf.hm<-DCindex(mat1.aci.sf.hm)
mat1.aci.sf.hm[is.na(mat1.aci.sf.hm)] = 0
h1.aci.sf.hm<-h.index(mat1.aci.sf.hm)

ep1.aci.sf.hm<-ep(mut1.aci.sf.hm,a1.ci.sf.hm)
david1.aci.sf.hm<-DS(mat1.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.sf.hm<-cbind(ordrank.1.aci.sf.hm,ds=david1.aci.sf.hm$normDS)
lm1.aci.sf.hm<-summary(lm(ordrank.1.aci.sf.hm$ds~ordrank.1.aci.sf.hm$ord.rank))
s1.aci.sf.hm<-lm1.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[4]],X2=avoid.ci.sf.hm[[5]],Avoids=avoid.ci.sf.hm[[6]])
mat2.aci.sf.hm<-avoid.inter.mat(mut2.aci.sf.hm)
tri2.aci.sf.hm<-tr.tri(mat2.aci.sf.hm)
dci2.aci.sf.hm<-DCindex(mat2.aci.sf.hm)
mat2.aci.sf.hm[is.na(mat2.aci.sf.hm)] = 0
h2.aci.sf.hm<-h.index(mat2.aci.sf.hm)

ep2.aci.sf.hm<-ep(mut2.aci.sf.hm,a2.ci.sf.hm)
david2.aci.sf.hm<-DS(mat2.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.sf.hm<-cbind(ordrank.2.aci.sf.hm,ds=david2.aci.sf.hm$normDS)
lm2.aci.sf.hm<-summary(lm(ordrank.2.aci.sf.hm$ds~ordrank.2.aci.sf.hm$ord.rank))
s2.aci.sf.hm<-lm2.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[7]],X2=avoid.ci.sf.hm[[8]],Avoids=avoid.ci.sf.hm[[9]])
mat3.aci.sf.hm<-avoid.inter.mat(mut3.aci.sf.hm)
tri3.aci.sf.hm<-tr.tri(mat3.aci.sf.hm)
dci3.aci.sf.hm<-DCindex(mat3.aci.sf.hm)
mat3.aci.sf.hm[is.na(mat3.aci.sf.hm)] = 0
h3.aci.sf.hm<-h.index(mat3.aci.sf.hm)

ep3.aci.sf.hm<-ep(mut3.aci.sf.hm,a3.ci.sf.hm)
david3.aci.sf.hm<-DS(mat3.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.sf.hm<-cbind(ordrank.3.aci.sf.hm,ds=david3.aci.sf.hm$normDS)
lm3.aci.sf.hm<-summary(lm(ordrank.3.aci.sf.hm$ds~ordrank.3.aci.sf.hm$ord.rank))
s3.aci.sf.hm<-lm3.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[10]],X2=avoid.ci.sf.hm[[11]],Avoids=avoid.ci.sf.hm[[12]])
mat4.aci.sf.hm<-avoid.inter.mat(mut4.aci.sf.hm)
tri4.aci.sf.hm<-tr.tri(mat4.aci.sf.hm)
dci4.aci.sf.hm<-DCindex(mat4.aci.sf.hm)
mat4.aci.sf.hm[is.na(mat4.aci.sf.hm)] = 0
h4.aci.sf.hm<-h.index(mat4.aci.sf.hm)

ep4.aci.sf.hm<-ep(mut4.aci.sf.hm,a4.ci.sf.hm)
david4.aci.sf.hm<-DS(mat4.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.sf.hm<-cbind(ordrank.4.aci.sf.hm,ds=david4.aci.sf.hm$normDS)
lm4.aci.sf.hm<-summary(lm(ordrank.4.aci.sf.hm$ds~ordrank.4.aci.sf.hm$ord.rank))
s4.aci.sf.hm<-lm4.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[13]],X2=avoid.ci.sf.hm[[14]],Avoids=avoid.ci.sf.hm[[15]])
mat5.aci.sf.hm<-avoid.inter.mat(mut5.aci.sf.hm)
tri5.aci.sf.hm<-tr.tri(mat5.aci.sf.hm)
dci5.aci.sf.hm<-DCindex(mat5.aci.sf.hm)
mat5.aci.sf.hm[is.na(mat5.aci.sf.hm)] = 0
h5.aci.sf.hm<-h.index(mat5.aci.sf.hm)

ep5.aci.sf.hm<-ep(mut5.aci.sf.hm,a5.ci.sf.hm)
david5.aci.sf.hm<-DS(mat5.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.sf.hm<-cbind(ordrank.5.aci.sf.hm,ds=david5.aci.sf.hm$normDS)
lm5.aci.sf.hm<-summary(lm(ordrank.5.aci.sf.hm$ds~ordrank.5.aci.sf.hm$ord.rank))
s5.aci.sf.hm<-lm5.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[16]],X2=avoid.ci.sf.hm[[17]],Avoids=avoid.ci.sf.hm[[18]])
mat6.aci.sf.hm<-avoid.inter.mat(mut6.aci.sf.hm)
tri6.aci.sf.hm<-tr.tri(mat6.aci.sf.hm)
dci6.aci.sf.hm<-DCindex(mat6.aci.sf.hm)
mat6.aci.sf.hm[is.na(mat6.aci.sf.hm)] = 0
h6.aci.sf.hm<-h.index(mat6.aci.sf.hm)

ep6.aci.sf.hm<-ep(mut6.aci.sf.hm,a6.ci.sf.hm)
david6.aci.sf.hm<-DS(mat6.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.sf.hm<-cbind(ordrank.6.aci.sf.hm,ds=david6.aci.sf.hm$normDS)
lm6.aci.sf.hm<-summary(lm(ordrank.6.aci.sf.hm$ds~ordrank.6.aci.sf.hm$ord.rank))
s6.aci.sf.hm<-lm6.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[19]],X2=avoid.ci.sf.hm[[20]],Avoids=avoid.ci.sf.hm[[21]])
mat7.aci.sf.hm<-avoid.inter.mat(mut7.aci.sf.hm)
tri7.aci.sf.hm<-tr.tri(mat7.aci.sf.hm)
dci7.aci.sf.hm<-DCindex(mat7.aci.sf.hm)
mat7.aci.sf.hm[is.na(mat7.aci.sf.hm)] = 0
h7.aci.sf.hm<-h.index(mat7.aci.sf.hm)

ep7.aci.sf.hm<-ep(mut7.aci.sf.hm,a7.ci.sf.hm)
david7.aci.sf.hm<-DS(mat7.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.sf.hm<-cbind(ordrank.7.aci.sf.hm,ds=david7.aci.sf.hm$normDS)
lm7.aci.sf.hm<-summary(lm(ordrank.7.aci.sf.hm$ds~ordrank.7.aci.sf.hm$ord.rank))
s7.aci.sf.hm<-lm7.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[22]],X2=avoid.ci.sf.hm[[23]],Avoids=avoid.ci.sf.hm[[24]])
mat8.aci.sf.hm<-avoid.inter.mat(mut8.aci.sf.hm)
tri8.aci.sf.hm<-tr.tri(mat8.aci.sf.hm)
dci8.aci.sf.hm<-DCindex(mat8.aci.sf.hm)
mat8.aci.sf.hm[is.na(mat8.aci.sf.hm)] = 0
h8.aci.sf.hm<-h.index(mat8.aci.sf.hm)

ep8.aci.sf.hm<-ep(mut8.aci.sf.hm,a8.ci.sf.hm)
david8.aci.sf.hm<-DS(mat8.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.sf.hm<-cbind(ordrank.8.aci.sf.hm,ds=david8.aci.sf.hm$normDS)
lm8.aci.sf.hm<-summary(lm(ordrank.8.aci.sf.hm$ds~ordrank.8.aci.sf.hm$ord.rank))
s8.aci.sf.hm<-lm8.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[25]],X2=avoid.ci.sf.hm[[26]],Avoids=avoid.ci.sf.hm[[27]])
mat9.aci.sf.hm<-avoid.inter.mat(mut9.aci.sf.hm)
tri9.aci.sf.hm<-tr.tri(mat9.aci.sf.hm)
dci9.aci.sf.hm<-DCindex(mat9.aci.sf.hm)
mat9.aci.sf.hm[is.na(mat9.aci.sf.hm)] = 0
h9.aci.sf.hm<-h.index(mat9.aci.sf.hm)

ep9.aci.sf.hm<-ep(mut9.aci.sf.hm,a9.ci.sf.hm)
david9.aci.sf.hm<-DS(mat9.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.sf.hm<-cbind(ordrank.9.aci.sf.hm,ds=david9.aci.sf.hm$normDS)
lm9.aci.sf.hm<-summary(lm(ordrank.9.aci.sf.hm$ds~ordrank.9.aci.sf.hm$ord.rank))
s9.aci.sf.hm<-lm9.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.sf.hm<-data.frame(X1=avoid.ci.sf.hm[[28]],X2=avoid.ci.sf.hm[[29]],Avoids=avoid.ci.sf.hm[[30]])
mat10.aci.sf.hm<-avoid.inter.mat(mut10.aci.sf.hm)
tri10.aci.sf.hm<-tr.tri(mat10.aci.sf.hm)
dci10.aci.sf.hm<-DCindex(mat10.aci.sf.hm)
mat10.aci.sf.hm[is.na(mat10.aci.sf.hm)] = 0
h10.aci.sf.hm<-h.index(mat10.aci.sf.hm)

ep10.aci.sf.hm<-ep(mut10.aci.sf.hm,a10.ci.sf.hm)
david10.aci.sf.hm<-DS(mat10.aci.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.aci.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.sf.hm<-cbind(ordrank.10.aci.sf.hm,ds=david10.aci.sf.hm$normDS)
lm10.aci.sf.hm<-summary(lm(ordrank.10.aci.sf.hm$ds~ordrank.10.aci.sf.hm$ord.rank))
s10.aci.sf.hm<-lm10.aci.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.sf.hm<-sum(mut1.aci.sf.hm$Victories)
int2.aci.sf.hm<-sum(mut2.aci.sf.hm$Victories)
int3.aci.sf.hm<-sum(mut3.aci.sf.hm$Victories)
int4.aci.sf.hm<-sum(mut4.aci.sf.hm$Victories)
int5.aci.sf.hm<-sum(mut5.aci.sf.hm$Victories)
int6.aci.sf.hm<-sum(mut6.aci.sf.hm$Victories)
int7.aci.sf.hm<-sum(mut7.aci.sf.hm$Victories)
int8.aci.sf.hm<-sum(mut8.aci.sf.hm$Victories)
int9.aci.sf.hm<-sum(mut9.aci.sf.hm$Victories)
int10.aci.sf.hm<-sum(mut10.aci.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.aci.sf.hm<-sum(a1.ci.sf.hm$Avoids)
av2.aci.sf.hm<-sum(a2.ci.sf.hm$Avoids)
av3.aci.sf.hm<-sum(a3.ci.sf.hm$Avoids)
av4.aci.sf.hm<-sum(a4.ci.sf.hm$Avoids)
av5.aci.sf.hm<-sum(a5.ci.sf.hm$Avoids)
av6.aci.sf.hm<-sum(a6.ci.sf.hm$Avoids)
av7.aci.sf.hm<-sum(a7.ci.sf.hm$Avoids)
av8.aci.sf.hm<-sum(a8.ci.sf.hm$Avoids)
av9.aci.sf.hm<-sum(a9.ci.sf.hm$Avoids)
av10.aci.sf.hm<-sum(a10.ci.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.aci.sf<-(sum(av1.aci.sf.hm, av2.aci.sf.hm, av3.aci.sf.hm, av4.aci.sf.hm, av5.aci.sf.hm, av6.aci.sf.hm, av7.aci.sf.hm, av8.aci.sf.hm, av9.aci.sf.hm, av10.aci.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.aci.sf<-(sum(int1.aci.sf.hm, int2.aci.sf.hm, int3.aci.sf.hm, int4.aci.sf.hm, int5.aci.sf.hm, int6.aci.sf.hm, int7.aci.sf.hm, int8.aci.sf.hm, int9.aci.sf.hm, int10.aci.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.sf.hm<-e1.aci.sf.hm[order(e1.aci.sf.hm$ID),]
e1.aci.sf.hm<-as.matrix(t(e1.1.aci.sf.hm))

e2.aci.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.sf.hm<-e2.aci.sf.hm[order(e2.aci.sf.hm$ID),]
e2.aci.sf.hm<-as.matrix(t(e2.1.aci.sf.hm))

e3.aci.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.sf.hm<-e3.aci.sf.hm[order(e3.aci.sf.hm$ID),]
e3.aci.sf.hm<-as.matrix(t(e3.1.aci.sf.hm))

e4.aci.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.sf.hm<-e4.aci.sf.hm[order(e4.aci.sf.hm$ID),]
e4.aci.sf.hm<-as.matrix(t(e4.1.aci.sf.hm))

e5.aci.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.sf.hm<-e5.aci.sf.hm[order(e5.aci.sf.hm$ID),]
e5.aci.sf.hm<-as.matrix(t(e5.1.aci.sf.hm))

e6.aci.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.sf.hm<-e6.aci.sf.hm[order(e6.aci.sf.hm$ID),]
e6.aci.sf.hm<-as.matrix(t(e6.1.aci.sf.hm))

e7.aci.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.sf.hm<-e7.aci.sf.hm[order(e7.aci.sf.hm$ID),]
e7.aci.sf.hm<-as.matrix(t(e7.1.aci.sf.hm))

e8.aci.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.sf.hm<-e8.aci.sf.hm[order(e8.aci.sf.hm$ID),]
e8.aci.sf.hm<-as.matrix(t(e8.1.aci.sf.hm))

e9.aci.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.sf.hm<-e9.aci.sf.hm[order(e9.aci.sf.hm$ID),]
e9.aci.sf.hm<-as.matrix(t(e9.1.aci.sf.hm))

e10.aci.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.sf.hm<-e10.aci.sf.hm[order(e10.aci.sf.hm$ID),]
e10.aci.sf.hm<-as.matrix(t(e10.1.aci.sf.hm))

energy.hm.aci.sf.hm<-as.data.frame(matrix(c(e1.aci.sf.hm,e2.aci.sf.hm,e3.aci.sf.hm,e4.aci.sf.hm,e5.aci.sf.hm,e6.aci.sf.hm,e7.aci.sf.hm,e8.aci.sf.hm,e9.aci.sf.hm,e10.aci.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aci.sf.hm<-data.frame(ID=energy.hm.aci.sf.hm$V1,energy_over_distance=energy.hm.aci.sf.hm$V2,energy_over_time=energy.hm.aci.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.sf.hm<-david1.aci.sf.hm[order(david1.aci.sf.hm$ID),]
david1.aci.sf.hm<-as.matrix(t(david1.1.aci.sf.hm))

david2.1.aci.sf.hm<-david2.aci.sf.hm[order(david2.aci.sf.hm$ID),]
david2.aci.sf.hm<-as.matrix(t(david2.1.aci.sf.hm))

david3.1.aci.sf.hm<-david3.aci.sf.hm[order(david3.aci.sf.hm$ID),]
david3.aci.sf.hm<-as.matrix(t(david3.1.aci.sf.hm))

david4.1.aci.sf.hm<-david4.aci.sf.hm[order(david4.aci.sf.hm$ID),]
david4.aci.sf.hm<-as.matrix(t(david4.1.aci.sf.hm))

david5.1.aci.sf.hm<-david5.aci.sf.hm[order(david5.aci.sf.hm$ID),]
david5.aci.sf.hm<-as.matrix(t(david5.1.aci.sf.hm))

david6.1.aci.sf.hm<-david6.aci.sf.hm[order(david6.aci.sf.hm$ID),]
david6.aci.sf.hm<-as.matrix(t(david6.1.aci.sf.hm))

david7.1.aci.sf.hm<-david7.aci.sf.hm[order(david7.aci.sf.hm$ID),]
david7.aci.sf.hm<-as.matrix(t(david7.1.aci.sf.hm))

david8.1.aci.sf.hm<-david8.aci.sf.hm[order(david8.aci.sf.hm$ID),]
david8.aci.sf.hm<-as.matrix(t(david8.1.aci.sf.hm))

david9.1.aci.sf.hm<-david9.aci.sf.hm[order(david9.aci.sf.hm$ID),]
david9.aci.sf.hm<-as.matrix(t(david9.1.aci.sf.hm))

david10.1.aci.sf.hm<-david10.aci.sf.hm[order(david10.aci.sf.hm$ID),]
david10.aci.sf.hm<-as.matrix(t(david10.1.aci.sf.hm))

david.hm.aci.sf.hm<-as.data.frame(matrix(c(david1.aci.sf.hm,david2.aci.sf.hm,david3.aci.sf.hm,david4.aci.sf.hm,david5.aci.sf.hm,david6.aci.sf.hm,david7.aci.sf.hm,david8.aci.sf.hm,david9.aci.sf.hm,david10.aci.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aci.sf.hm<-data.frame(ID=david.hm.aci.sf.hm$V1,DS=david.hm.aci.sf.hm$V2,normDS=david.hm.aci.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aci.sf.hm<-lm(e1.1.aci.sf.hm$energy_over_time~as.numeric(david1.1.aci.sf.hm$normDS))
hm.lm.1.s.aci.sf.hm<-summary(lm.hm.1.aci.sf.hm)$coefficients
hm.1.slope.aci.sf.hm<-hm.lm.1.s.aci.sf.hm[2,1]
lm.hm.2.aci.sf.hm<-lm(e2.1.aci.sf.hm$energy_over_time~as.numeric(david2.1.aci.sf.hm$normDS))
hm.lm.2.s.aci.sf.hm<-summary(lm.hm.2.aci.sf.hm)$coefficients
hm.2.slope.aci.sf.hm<-hm.lm.2.s.aci.sf.hm[2,1]
lm.hm.3.aci.sf.hm<-lm(e3.1.aci.sf.hm$energy_over_time~as.numeric(david3.1.aci.sf.hm$normDS))
hm.lm.3.s.aci.sf.hm<-summary(lm.hm.3.aci.sf.hm)$coefficients
hm.3.slope.aci.sf.hm<-hm.lm.3.s.aci.sf.hm[2,1]
lm.hm.4.aci.sf.hm<-lm(e4.1.aci.sf.hm$energy_over_time~as.numeric(david4.1.aci.sf.hm$normDS))
hm.lm.4.s.aci.sf.hm<-summary(lm.hm.4.aci.sf.hm)$coefficients
hm.4.slope.aci.sf.hm<-hm.lm.4.s.aci.sf.hm[2,1]
lm.hm.5.aci.sf.hm<-lm(e5.1.aci.sf.hm$energy_over_time~as.numeric(david5.1.aci.sf.hm$normDS))
hm.lm.5.s.aci.sf.hm<-summary(lm.hm.5.aci.sf.hm)$coefficients
hm.5.slope.aci.sf.hm<-hm.lm.5.s.aci.sf.hm[2,1]
lm.hm.6.aci.sf.hm<-lm(e6.1.aci.sf.hm$energy_over_time~as.numeric(david6.1.aci.sf.hm$normDS))
hm.lm.6.s.aci.sf.hm<-summary(lm.hm.6.aci.sf.hm)$coefficients
hm.6.slope.aci.sf.hm<-hm.lm.6.s.aci.sf.hm[2,1]
lm.hm.7.aci.sf.hm<-lm(e7.1.aci.sf.hm$energy_over_time~as.numeric(david7.1.aci.sf.hm$normDS))
hm.lm.7.s.aci.sf.hm<-summary(lm.hm.7.aci.sf.hm)$coefficients
hm.7.slope.aci.sf.hm<-hm.lm.7.s.aci.sf.hm[2,1]
lm.hm.8.aci.sf.hm<-lm(e8.1.aci.sf.hm$energy_over_time~as.numeric(david8.1.aci.sf.hm$normDS))
hm.lm.8.s.aci.sf.hm<-summary(lm.hm.8.aci.sf.hm)$coefficients
hm.8.slope.aci.sf.hm<-hm.lm.8.s.aci.sf.hm[2,1]
lm.hm.9.aci.sf.hm<-lm(e9.1.aci.sf.hm$energy_over_time~as.numeric(david9.1.aci.sf.hm$normDS))
hm.lm.9.s.aci.sf.hm<-summary(lm.hm.9.aci.sf.hm)$coefficients
hm.9.slope.aci.sf.hm<-hm.lm.9.s.aci.sf.hm[2,1]
lm.hm.10.aci.sf.hm<-lm(e10.1.aci.sf.hm$energy_over_time~as.numeric(david10.1.aci.sf.hm$normDS))
hm.lm.10.s.aci.sf.hm<-summary(lm.hm.10.aci.sf.hm)$coefficients
hm.10.slope.aci.sf.hm<-hm.lm.10.s.aci.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aci.sf.ss.avoid.ci.sf.hm<-data.frame(triangle.transitivity=c(tri1.aci.sf.hm,tri2.aci.sf.hm,tri3.aci.sf.hm,tri4.aci.sf.hm,tri5.aci.sf.hm,tri6.aci.sf.hm,tri7.aci.sf.hm,tri8.aci.sf.hm,tri9.aci.sf.hm,tri10.aci.sf.hm),escalation=c(ep1.aci.sf.hm,ep2.aci.sf.hm,ep3.aci.sf.hm,ep4.aci.sf.hm,ep5.aci.sf.hm,ep6.aci.sf.hm,ep7.aci.sf.hm,ep8.aci.sf.hm,ep9.aci.sf.hm,ep10.aci.sf.hm),dci=c(dci1.aci.sf.hm,dci2.aci.sf.hm,dci3.aci.sf.hm,dci4.aci.sf.hm,dci5.aci.sf.hm,dci6.aci.sf.hm,dci7.aci.sf.hm,dci8.aci.sf.hm,dci9.aci.sf.hm,dci10.aci.sf.hm),steepness=c(s1.aci.sf.hm,s2.aci.sf.hm,s3.aci.sf.hm,s4.aci.sf.hm,s5.aci.sf.hm,s6.aci.sf.hm,s7.aci.sf.hm,s8.aci.sf.hm,s9.aci.sf.hm,s10.aci.sf.hm),slope=c(hm.1.slope.aci.sf.hm,hm.2.slope.aci.sf.hm,hm.3.slope.aci.sf.hm,hm.4.slope.aci.sf.hm,hm.5.slope.aci.sf.hm,hm.6.slope.aci.sf.hm,hm.7.slope.aci.sf.hm,hm.8.slope.aci.sf.hm,hm.9.slope.aci.sf.hm,hm.10.slope.aci.sf.hm))


```
```{r Avoids Clumped Initiator Wins Deterministic Data Frame}
#knowledge mutual
km.tt.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$triangle.transitivity)
km.aci.sfi.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$dci)
km.esc.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$escalation)
km.steep.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$steepness)
km.slope.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$slope)
km.mean.aci.sf.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aci.sf.avoid,dci=km.aci.sfi.aci.sf.avoid,esc=km.esc.aci.sf.avoid,steepness=km.steep.aci.sf.avoid,slope=km.slope.aci.sf.avoid,dist="clumped",calc="deterministic")

#history mutual
hm.tt.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$triangle.transitivity)
hm.aci.sfi.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$dci)
hm.esc.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$escalation)
hm.steep.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$steepness)
hm.slope.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$slope)
hm.mean.aci.sf.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aci.sf.avoid,dci=hm.aci.sfi.aci.sf.avoid,esc=hm.esc.aci.sf.avoid,steepness=hm.steep.aci.sf.avoid,slope=hm.slope.aci.sf.avoid,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.aci.sf.avoid,hm.mean.aci.sf.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$triangle.transitivity)
km.aci.sfi.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$dci)
km.esc.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$escalation)
km.steep.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$steepness)
km.slope.aci.sf.avoid<-mean(km.aci.sf.ss.avoid.ci.sf.km$slope)
km.mean.aci.sf.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aci.sf.avoid,dci=km.aci.sfi.aci.sf.avoid,esc=km.esc.aci.sf.avoid,steepness=km.steep.aci.sf.avoid,slope=km.slope.aci.sf.avoid,dist="clumped",calc="deterministic")

#history mutual
hm.tt.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$triangle.transitivity)
hm.aci.sfi.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$dci)
hm.esc.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$escalation)
hm.steep.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$steepness)
hm.slope.aci.sf.avoid<-mean(hm.aci.sf.ss.avoid.ci.sf.hm$slope)
hm.mean.aci.sf.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aci.sf.avoid,dci=hm.aci.sfi.aci.sf.avoid,esc=hm.esc.aci.sf.avoid,steepness=hm.steep.aci.sf.avoid,slope=hm.slope.aci.sf.avoid,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.aci.sf.avoid,hm.mean.aci.sf.avoid)

#create overall dataframe of summary statistics
overall.clump.sf.avoid.initiator.sf<-data.frame(km.aci.sf.ss.avoid.ci.sf.km)
overall.clump.sf.avoid.initiator.sf<-rbind(overall.clump.sf.avoid.initiator.sf,hm.aci.sf.ss.avoid.ci.sf.hm)

overall.clump.sf.avoid.initiator.sf<-cbind(overall.clump.sf.avoid.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.clump.sf.avoid.initiator.sf<-cbind(overall.clump.sf.avoid.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("initiator",20))


rhp.ss.avoid.ci.sf<-overall.clump.sf.avoid.initiator.sf[overall.clump.sf.avoid.initiator.sf$variable=="rhp",]
history.ss.avoid.ci.sf<-overall.clump.sf.avoid.initiator.sf[overall.clump.sf.avoid.initiator.sf$variable=="history",]

overall.clump.sf.avoid.initiator.sf$combo<-paste(overall.clump.sf.avoid.initiator.sf$strategy,overall.clump.sf.avoid.initiator.sf$variable,overall.clump.sf.avoid.initiator.sf$distribution)
overall.clump.sf.avoid.initiator.sf$combo2<-paste(overall.clump.sf.avoid.initiator.sf$strategy,overall.clump.sf.avoid.initiator.sf$variable)
```

## Attacks Clumped Initiator Wins Data
```{r Attacks Clumped Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.km<-sapply(files, read.csv)

# Generate attacks.atci.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.km<-data.frame(X1=attacks.atci.km[[1]],X2=attacks.atci.km[[2]],Victories=attacks.atci.km[[3]])
mat1.atci.km<-inter.mat(mut1.atci.km)
tri1.atci.km<-tr.tri(mat1.atci.km)
dci1.atci.km<-DCindex(mat1.atci.km)
mat1.atci.km[is.na(mat1.atci.km)] = 0
h1.atci.km<-h.index(mat1.atci.km)

ep1.atci.km<-ep(mut1.atci.km,a1.ci.sf.km)
david1.atci.km<-DS(mat1.atci.km) #David's Scores - for steepness use normDS output
ordrank.1.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.km<-cbind(ordrank.1.atci.km,ds=david1.atci.km$normDS)
lm1.atci.km<-summary(lm(ordrank.1.atci.km$ds~ordrank.1.atci.km$ord.rank))
s1.atci.km<-lm1.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.km<-data.frame(X1=attacks.atci.km[[4]],X2=attacks.atci.km[[5]],Victories=attacks.atci.km[[6]])
mat2.atci.km<-inter.mat(mut2.atci.km)
tri2.atci.km<-tr.tri(mat2.atci.km)
dci2.atci.km<-DCindex(mat2.atci.km)
mat2.atci.km[is.na(mat2.atci.km)] = 0
h2.atci.km<-h.index(mat2.atci.km)

ep2.atci.km<-ep(mut2.atci.km,a2.ci.sf.km)
david2.atci.km<-DS(mat2.atci.km) #David's Scores - for steepness use normDS output
ordrank.2.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.km<-cbind(ordrank.2.atci.km,ds=david2.atci.km$normDS)
lm2.atci.km<-summary(lm(ordrank.2.atci.km$ds~ordrank.2.atci.km$ord.rank))
s2.atci.km<-lm2.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.km<-data.frame(X1=attacks.atci.km[[7]],X2=attacks.atci.km[[8]],Victories=attacks.atci.km[[9]])
mat3.atci.km<-inter.mat(mut3.atci.km)
tri3.atci.km<-tr.tri(mat3.atci.km)
dci3.atci.km<-DCindex(mat3.atci.km)
mat3.atci.km[is.na(mat3.atci.km)] = 0
h3.atci.km<-h.index(mat3.atci.km)

ep3.atci.km<-ep(mut3.atci.km,a3.ci.sf.km)
david3.atci.km<-DS(mat3.atci.km) #David's Scores - for steepness use normDS output
ordrank.3.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.km<-cbind(ordrank.3.atci.km,ds=david3.atci.km$normDS)
lm3.atci.km<-summary(lm(ordrank.3.atci.km$ds~ordrank.3.atci.km$ord.rank))
s3.atci.km<-lm3.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.km<-data.frame(X1=attacks.atci.km[[10]],X2=attacks.atci.km[[11]],Victories=attacks.atci.km[[12]])
mat4.atci.km<-inter.mat(mut4.atci.km)
tri4.atci.km<-tr.tri(mat4.atci.km)
dci4.atci.km<-DCindex(mat4.atci.km)
mat4.atci.km[is.na(mat4.atci.km)] = 0
h4.atci.km<-h.index(mat4.atci.km)

ep4.atci.km<-ep(mut4.atci.km,a4.ci.sf.km)
david4.atci.km<-DS(mat4.atci.km) #David's Scores - for steepness use normDS output
ordrank.4.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.km<-cbind(ordrank.4.atci.km,ds=david4.atci.km$normDS)
lm4.atci.km<-summary(lm(ordrank.4.atci.km$ds~ordrank.4.atci.km$ord.rank))
s4.atci.km<-lm4.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.km<-data.frame(X1=attacks.atci.km[[13]],X2=attacks.atci.km[[14]],Victories=attacks.atci.km[[15]])
mat5.atci.km<-inter.mat(mut5.atci.km)
tri5.atci.km<-tr.tri(mat5.atci.km)
dci5.atci.km<-DCindex(mat5.atci.km)
mat5.atci.km[is.na(mat5.atci.km)] = 0
h5.atci.km<-h.index(mat5.atci.km)

ep5.atci.km<-ep(mut5.atci.km,a5.ci.sf.km)
david5.atci.km<-DS(mat5.atci.km) #David's Scores - for steepness use normDS output
ordrank.5.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.km<-cbind(ordrank.5.atci.km,ds=david5.atci.km$normDS)
lm5.atci.km<-summary(lm(ordrank.5.atci.km$ds~ordrank.5.atci.km$ord.rank))
s5.atci.km<-lm5.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.km<-data.frame(X1=attacks.atci.km[[16]],X2=attacks.atci.km[[17]],Victories=attacks.atci.km[[18]])
mat6.atci.km<-inter.mat(mut6.atci.km)
tri6.atci.km<-tr.tri(mat6.atci.km)
dci6.atci.km<-DCindex(mat6.atci.km)
mat6.atci.km[is.na(mat6.atci.km)] = 0
h6.atci.km<-h.index(mat6.atci.km)

ep6.atci.km<-ep(mut6.atci.km,a6.ci.sf.km)
david6.atci.km<-DS(mat6.atci.km) #David's Scores - for steepness use normDS output
ordrank.6.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.km<-cbind(ordrank.6.atci.km,ds=david6.atci.km$normDS)
lm6.atci.km<-summary(lm(ordrank.6.atci.km$ds~ordrank.6.atci.km$ord.rank))
s6.atci.km<-lm6.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.km<-data.frame(X1=attacks.atci.km[[19]],X2=attacks.atci.km[[20]],Victories=attacks.atci.km[[21]])
mat7.atci.km<-inter.mat(mut7.atci.km)
tri7.atci.km<-tr.tri(mat7.atci.km)
dci7.atci.km<-DCindex(mat7.atci.km)
mat7.atci.km[is.na(mat7.atci.km)] = 0
h7.atci.km<-h.index(mat7.atci.km)

ep7.atci.km<-ep(mut7.atci.km,a7.ci.sf.km)
david7.atci.km<-DS(mat7.atci.km) #David's Scores - for steepness use normDS output
ordrank.7.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.km<-cbind(ordrank.7.atci.km,ds=david7.atci.km$normDS)
lm7.atci.km<-summary(lm(ordrank.7.atci.km$ds~ordrank.7.atci.km$ord.rank))
s7.atci.km<-lm7.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.km<-data.frame(X1=attacks.atci.km[[22]],X2=attacks.atci.km[[23]],Victories=attacks.atci.km[[24]])
mat8.atci.km<-inter.mat(mut8.atci.km)
tri8.atci.km<-tr.tri(mat8.atci.km)
dci8.atci.km<-DCindex(mat8.atci.km)
mat8.atci.km[is.na(mat8.atci.km)] = 0
h8.atci.km<-h.index(mat8.atci.km)

ep8.atci.km<-ep(mut8.atci.km,a8.ci.sf.km)
david8.atci.km<-DS(mat8.atci.km) #David's Scores - for steepness use normDS output
ordrank.8.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.km<-cbind(ordrank.8.atci.km,ds=david8.atci.km$normDS)
lm8.atci.km<-summary(lm(ordrank.8.atci.km$ds~ordrank.8.atci.km$ord.rank))
s8.atci.km<-lm8.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.km<-data.frame(X1=attacks.atci.km[[25]],X2=attacks.atci.km[[26]],Victories=attacks.atci.km[[27]])
mat9.atci.km<-inter.mat(mut9.atci.km)
tri9.atci.km<-tr.tri(mat9.atci.km)
dci9.atci.km<-DCindex(mat9.atci.km)
mat9.atci.km[is.na(mat9.atci.km)] = 0
h9.atci.km<-h.index(mat9.atci.km)

ep9.atci.km<-ep(mut9.atci.km,a9.ci.sf.km)
david9.atci.km<-DS(mat9.atci.km) #David's Scores - for steepness use normDS output
ordrank.9.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.km<-cbind(ordrank.9.atci.km,ds=david9.atci.km$normDS)
lm9.atci.km<-summary(lm(ordrank.9.atci.km$ds~ordrank.9.atci.km$ord.rank))
s9.atci.km<-lm9.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.km<-data.frame(X1=attacks.atci.km[[28]],X2=attacks.atci.km[[29]],Victories=attacks.atci.km[[30]])
mat10.atci.km<-inter.mat(mut10.atci.km)
tri10.atci.km<-tr.tri(mat10.atci.km)
dci10.atci.km<-DCindex(mat10.atci.km)
mat10.atci.km[is.na(mat10.atci.km)] = 0
h10.atci.km<-h.index(mat10.atci.km)

ep10.atci.km<-ep(mut10.atci.km,a10.ci.sf.km)
david10.atci.km<-DS(mat10.atci.km) #David's Scores - for steepness use normDS output
ordrank.10.atci.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.km<-cbind(ordrank.10.atci.km,ds=david10.atci.km$normDS)
lm10.atci.km<-summary(lm(ordrank.10.atci.km$ds~ordrank.10.atci.km$ord.rank))
s10.atci.km<-lm10.atci.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.km<-sum(mut1.atci.km$Victories)
int2.atci.km<-sum(mut2.atci.km$Victories)
int3.atci.km<-sum(mut3.atci.km$Victories)
int4.atci.km<-sum(mut4.atci.km$Victories)
int5.atci.km<-sum(mut5.atci.km$Victories)
int6.atci.km<-sum(mut6.atci.km$Victories)
int7.atci.km<-sum(mut7.atci.km$Victories)
int8.atci.km<-sum(mut8.atci.km$Victories)
int9.atci.km<-sum(mut9.atci.km$Victories)
int10.atci.km<-sum(mut10.atci.km$Victories)

  # Summarize the avoidances in each trial:
av1.ci.sf.km<-sum(a1.ci.sf.km$Avoids)
av2.ci.sf.km<-sum(a2.ci.sf.km$Avoids)
av3.ci.sf.km<-sum(a3.ci.sf.km$Avoids)
av4.ci.sf.km<-sum(a4.ci.sf.km$Avoids)
av5.ci.sf.km<-sum(a5.ci.sf.km$Avoids)
av6.ci.sf.km<-sum(a6.ci.sf.km$Avoids)
av7.ci.sf.km<-sum(a7.ci.sf.km$Avoids)
av8.ci.sf.km<-sum(a8.ci.sf.km$Avoids)
av9.ci.sf.km<-sum(a9.ci.sf.km$Avoids)
av10.ci.sf.km<-sum(a10.ci.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.ci.sf<-(sum(av1.ci.sf.km, av2.ci.sf.km, av3.ci.sf.km, av4.ci.sf.km, av5.ci.sf.km, av6.ci.sf.km, av7.ci.sf.km, av8.ci.sf.km, av9.ci.sf.km, av10.ci.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.ci.sf<-(sum(int1.atci.km, int2.atci.km, int3.atci.km, int4.atci.km, int5.atci.km, int6.atci.km, int7.atci.km, int8.atci.km, int9.atci.km, int10.atci.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.km<-e1.atci.km[order(e1.atci.km$ID),]
e1.atci.km<-as.matrix(t(e1.1.atci.km))

e2.atci.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.km<-e2.atci.km[order(e2.atci.km$ID),]
e2.atci.km<-as.matrix(t(e2.1.atci.km))

e3.atci.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.km<-e3.atci.km[order(e3.atci.km$ID),]
e3.atci.km<-as.matrix(t(e3.1.atci.km))

e4.atci.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.km<-e4.atci.km[order(e4.atci.km$ID),]
e4.atci.km<-as.matrix(t(e4.1.atci.km))

e5.atci.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.km<-e5.atci.km[order(e5.atci.km$ID),]
e5.atci.km<-as.matrix(t(e5.1.atci.km))

e6.atci.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.km<-e6.atci.km[order(e6.atci.km$ID),]
e6.atci.km<-as.matrix(t(e6.1.atci.km))

e7.atci.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.km<-e7.atci.km[order(e7.atci.km$ID),]
e7.atci.km<-as.matrix(t(e7.1.atci.km))

e8.atci.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.km<-e8.atci.km[order(e8.atci.km$ID),]
e8.atci.km<-as.matrix(t(e8.1.atci.km))

e9.atci.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.km<-e9.atci.km[order(e9.atci.km$ID),]
e9.atci.km<-as.matrix(t(e9.1.atci.km))

e10.atci.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.km<-e10.atci.km[order(e10.atci.km$ID),]
e10.atci.km<-as.matrix(t(e10.1.atci.km))

energy.km.atci.km<-as.data.frame(matrix(c(e1.atci.km,e2.atci.km,e3.atci.km,e4.atci.km,e5.atci.km,e6.atci.km,e7.atci.km,e8.atci.km,e9.atci.km,e10.atci.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atci.km<-data.frame(ID=energy.km.atci.km$V1,energy_over_distance=energy.km.atci.km$V2,energy_over_time=energy.km.atci.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.km<-david1.atci.km[order(david1.atci.km$ID),]
david1.atci.km<-as.matrix(t(david1.1.atci.km))

david2.1.atci.km<-david2.atci.km[order(david2.atci.km$ID),]
david2.atci.km<-as.matrix(t(david2.1.atci.km))

david3.1.atci.km<-david3.atci.km[order(david3.atci.km$ID),]
david3.atci.km<-as.matrix(t(david3.1.atci.km))

david4.1.atci.km<-david4.atci.km[order(david4.atci.km$ID),]
david4.atci.km<-as.matrix(t(david4.1.atci.km))

david5.1.atci.km<-david5.atci.km[order(david5.atci.km$ID),]
david5.atci.km<-as.matrix(t(david5.1.atci.km))

david6.1.atci.km<-david6.atci.km[order(david6.atci.km$ID),]
david6.atci.km<-as.matrix(t(david6.1.atci.km))

david7.1.atci.km<-david7.atci.km[order(david7.atci.km$ID),]
david7.atci.km<-as.matrix(t(david7.1.atci.km))

david8.1.atci.km<-david8.atci.km[order(david8.atci.km$ID),]
david8.atci.km<-as.matrix(t(david8.1.atci.km))

david9.1.atci.km<-david9.atci.km[order(david9.atci.km$ID),]
david9.atci.km<-as.matrix(t(david9.1.atci.km))

david10.1.atci.km<-david10.atci.km[order(david10.atci.km$ID),]
david10.atci.km<-as.matrix(t(david10.1.atci.km))

david.km.atci.km<-as.data.frame(matrix(c(david1.atci.km,david2.atci.km,david3.atci.km,david4.atci.km,david5.atci.km,david6.atci.km,david7.atci.km,david8.atci.km,david9.atci.km,david10.atci.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atci.km<-data.frame(ID=david.km.atci.km$V1,DS=david.km.atci.km$V2,normDS=david.km.atci.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atci.km<-lm(e1.1.atci.km$energy_over_time~as.numeric(david1.1.atci.km$normDS))
km.lm.1.s.atci.km<-summary(lm.km.1.atci.km)$coefficients
km.1.slope.atci.km<-km.lm.1.s.atci.km[2,1]
lm.km.2.atci.km<-lm(e2.1.atci.km$energy_over_time~as.numeric(david2.1.atci.km$normDS))
km.lm.2.s.atci.km<-summary(lm.km.2.atci.km)$coefficients
km.2.slope.atci.km<-km.lm.2.s.atci.km[2,1]
lm.km.3.atci.km<-lm(e3.1.atci.km$energy_over_time~as.numeric(david3.1.atci.km$normDS))
km.lm.3.s.atci.km<-summary(lm.km.3.atci.km)$coefficients
km.3.slope.atci.km<-km.lm.3.s.atci.km[2,1]
lm.km.4.atci.km<-lm(e4.1.atci.km$energy_over_time~as.numeric(david4.1.atci.km$normDS))
km.lm.4.s.atci.km<-summary(lm.km.4.atci.km)$coefficients
km.4.slope.atci.km<-km.lm.4.s.atci.km[2,1]
lm.km.5.atci.km<-lm(e5.1.atci.km$energy_over_time~as.numeric(david5.1.atci.km$normDS))
km.lm.5.s.atci.km<-summary(lm.km.5.atci.km)$coefficients
km.5.slope.atci.km<-km.lm.5.s.atci.km[2,1]
lm.km.6.atci.km<-lm(e6.1.atci.km$energy_over_time~as.numeric(david6.1.atci.km$normDS))
km.lm.6.s.atci.km<-summary(lm.km.6.atci.km)$coefficients
km.6.slope.atci.km<-km.lm.6.s.atci.km[2,1]
lm.km.7.atci.km<-lm(e7.1.atci.km$energy_over_time~as.numeric(david7.1.atci.km$normDS))
km.lm.7.s.atci.km<-summary(lm.km.7.atci.km)$coefficients
km.7.slope.atci.km<-km.lm.7.s.atci.km[2,1]
lm.km.8.atci.km<-lm(e8.1.atci.km$energy_over_time~as.numeric(david8.1.atci.km$normDS))
km.lm.8.s.atci.km<-summary(lm.km.8.atci.km)$coefficients
km.8.slope.atci.km<-km.lm.8.s.atci.km[2,1]
lm.km.9.atci.km<-lm(e9.1.atci.km$energy_over_time~as.numeric(david9.1.atci.km$normDS))
km.lm.9.s.atci.km<-summary(lm.km.9.atci.km)$coefficients
km.9.slope.atci.km<-km.lm.9.s.atci.km[2,1]
lm.km.10.atci.km<-lm(e10.1.atci.km$energy_over_time~as.numeric(david10.1.atci.km$normDS))
km.lm.10.s.atci.km<-summary(lm.km.10.atci.km)$coefficients
km.10.slope.atci.km<-km.lm.10.s.atci.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atci.ss.attacks.atci.km<-data.frame(triangle.transitivity=c(tri1.atci.km,tri2.atci.km,tri3.atci.km,tri4.atci.km,tri5.atci.km,tri6.atci.km,tri7.atci.km,tri8.atci.km,tri9.atci.km,tri10.atci.km),escalation=c(ep1.atci.km,ep2.atci.km,ep3.atci.km,ep4.atci.km,ep5.atci.km,ep6.atci.km,ep7.atci.km,ep8.atci.km,ep9.atci.km,ep10.atci.km),dci=c(dci1.atci.km,dci2.atci.km,dci3.atci.km,dci4.atci.km,dci5.atci.km,dci6.atci.km,dci7.atci.km,dci8.atci.km,dci9.atci.km,dci10.atci.km),steepness=c(s1.atci.km,s2.atci.km,s3.atci.km,s4.atci.km,s5.atci.km,s6.atci.km,s7.atci.km,s8.atci.km,s9.atci.km,s10.atci.km),slope=c(km.1.slope.atci.km,km.2.slope.atci.km,km.3.slope.atci.km,km.4.slope.atci.km,km.5.slope.atci.km,km.6.slope.atci.km,km.7.slope.atci.km,km.8.slope.atci.km,km.9.slope.atci.km,km.10.slope.atci.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.hm<-sapply(files, read.csv)

# Generate attacks.atci.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.hm<-data.frame(X1=attacks.atci.hm[[1]],X2=attacks.atci.hm[[2]],Victories=attacks.atci.hm[[3]])
mat1.atci.hm<-inter.mat(mut1.atci.hm)
tri1.atci.hm<-tr.tri(mat1.atci.hm)
dci1.atci.hm<-DCindex(mat1.atci.hm)
mat1.atci.hm[is.na(mat1.atci.hm)] = 0
h1.atci.hm<-h.index(mat1.atci.hm)

ep1.atci.hm<-ep(mut1.atci.hm,a1.ci.sf.hm)
david1.atci.hm<-DS(mat1.atci.hm) #David's Scores - for steepness use normDS output
ordrank.1.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.hm<-cbind(ordrank.1.atci.hm,ds=david1.atci.hm$normDS)
lm1.atci.hm<-summary(lm(ordrank.1.atci.hm$ds~ordrank.1.atci.hm$ord.rank))
s1.atci.hm<-lm1.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.hm<-data.frame(X1=attacks.atci.hm[[4]],X2=attacks.atci.hm[[5]],Victories=attacks.atci.hm[[6]])
mat2.atci.hm<-inter.mat(mut2.atci.hm)
tri2.atci.hm<-tr.tri(mat2.atci.hm)
dci2.atci.hm<-DCindex(mat2.atci.hm)
mat2.atci.hm[is.na(mat2.atci.hm)] = 0
h2.atci.hm<-h.index(mat2.atci.hm)

ep2.atci.hm<-ep(mut2.atci.hm,a2.ci.sf.hm)
david2.atci.hm<-DS(mat2.atci.hm) #David's Scores - for steepness use normDS output
ordrank.2.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.hm<-cbind(ordrank.2.atci.hm,ds=david2.atci.hm$normDS)
lm2.atci.hm<-summary(lm(ordrank.2.atci.hm$ds~ordrank.2.atci.hm$ord.rank))
s2.atci.hm<-lm2.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.hm<-data.frame(X1=attacks.atci.hm[[7]],X2=attacks.atci.hm[[8]],Victories=attacks.atci.hm[[9]])
mat3.atci.hm<-inter.mat(mut3.atci.hm)
tri3.atci.hm<-tr.tri(mat3.atci.hm)
dci3.atci.hm<-DCindex(mat3.atci.hm)
mat3.atci.hm[is.na(mat3.atci.hm)] = 0
h3.atci.hm<-h.index(mat3.atci.hm)

ep3.atci.hm<-ep(mut3.atci.hm,a3.ci.sf.hm)
david3.atci.hm<-DS(mat3.atci.hm) #David's Scores - for steepness use normDS output
ordrank.3.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.hm<-cbind(ordrank.3.atci.hm,ds=david3.atci.hm$normDS)
lm3.atci.hm<-summary(lm(ordrank.3.atci.hm$ds~ordrank.3.atci.hm$ord.rank))
s3.atci.hm<-lm3.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.hm<-data.frame(X1=attacks.atci.hm[[10]],X2=attacks.atci.hm[[11]],Victories=attacks.atci.hm[[12]])
mat4.atci.hm<-inter.mat(mut4.atci.hm)
tri4.atci.hm<-tr.tri(mat4.atci.hm)
dci4.atci.hm<-DCindex(mat4.atci.hm)
mat4.atci.hm[is.na(mat4.atci.hm)] = 0
h4.atci.hm<-h.index(mat4.atci.hm)

ep4.atci.hm<-ep(mut4.atci.hm,a4.ci.sf.hm)
david4.atci.hm<-DS(mat4.atci.hm) #David's Scores - for steepness use normDS output
ordrank.4.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.hm<-cbind(ordrank.4.atci.hm,ds=david4.atci.hm$normDS)
lm4.atci.hm<-summary(lm(ordrank.4.atci.hm$ds~ordrank.4.atci.hm$ord.rank))
s4.atci.hm<-lm4.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.hm<-data.frame(X1=attacks.atci.hm[[13]],X2=attacks.atci.hm[[14]],Victories=attacks.atci.hm[[15]])
mat5.atci.hm<-inter.mat(mut5.atci.hm)
tri5.atci.hm<-tr.tri(mat5.atci.hm)
dci5.atci.hm<-DCindex(mat5.atci.hm)
mat5.atci.hm[is.na(mat5.atci.hm)] = 0
h5.atci.hm<-h.index(mat5.atci.hm)

ep5.atci.hm<-ep(mut5.atci.hm,a5.ci.sf.hm)
david5.atci.hm<-DS(mat5.atci.hm) #David's Scores - for steepness use normDS output
ordrank.5.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.hm<-cbind(ordrank.5.atci.hm,ds=david5.atci.hm$normDS)
lm5.atci.hm<-summary(lm(ordrank.5.atci.hm$ds~ordrank.5.atci.hm$ord.rank))
s5.atci.hm<-lm5.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.hm<-data.frame(X1=attacks.atci.hm[[16]],X2=attacks.atci.hm[[17]],Victories=attacks.atci.hm[[18]])
mat6.atci.hm<-inter.mat(mut6.atci.hm)
tri6.atci.hm<-tr.tri(mat6.atci.hm)
dci6.atci.hm<-DCindex(mat6.atci.hm)
mat6.atci.hm[is.na(mat6.atci.hm)] = 0
h6.atci.hm<-h.index(mat6.atci.hm)

ep6.atci.hm<-ep(mut6.atci.hm,a6.ci.sf.hm)
david6.atci.hm<-DS(mat6.atci.hm) #David's Scores - for steepness use normDS output
ordrank.6.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.hm<-cbind(ordrank.6.atci.hm,ds=david6.atci.hm$normDS)
lm6.atci.hm<-summary(lm(ordrank.6.atci.hm$ds~ordrank.6.atci.hm$ord.rank))
s6.atci.hm<-lm6.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.hm<-data.frame(X1=attacks.atci.hm[[19]],X2=attacks.atci.hm[[20]],Victories=attacks.atci.hm[[21]])
mat7.atci.hm<-inter.mat(mut7.atci.hm)
tri7.atci.hm<-tr.tri(mat7.atci.hm)
dci7.atci.hm<-DCindex(mat7.atci.hm)
mat7.atci.hm[is.na(mat7.atci.hm)] = 0
h7.atci.hm<-h.index(mat7.atci.hm)

ep7.atci.hm<-ep(mut7.atci.hm,a7.ci.sf.hm)
david7.atci.hm<-DS(mat7.atci.hm) #David's Scores - for steepness use normDS output
ordrank.7.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.hm<-cbind(ordrank.7.atci.hm,ds=david7.atci.hm$normDS)
lm7.atci.hm<-summary(lm(ordrank.7.atci.hm$ds~ordrank.7.atci.hm$ord.rank))
s7.atci.hm<-lm7.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.hm<-data.frame(X1=attacks.atci.hm[[22]],X2=attacks.atci.hm[[23]],Victories=attacks.atci.hm[[24]])
mat8.atci.hm<-inter.mat(mut8.atci.hm)
tri8.atci.hm<-tr.tri(mat8.atci.hm)
dci8.atci.hm<-DCindex(mat8.atci.hm)
mat8.atci.hm[is.na(mat8.atci.hm)] = 0
h8.atci.hm<-h.index(mat8.atci.hm)

ep8.atci.hm<-ep(mut8.atci.hm,a8.ci.sf.hm)
david8.atci.hm<-DS(mat8.atci.hm) #David's Scores - for steepness use normDS output
ordrank.8.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.hm<-cbind(ordrank.8.atci.hm,ds=david8.atci.hm$normDS)
lm8.atci.hm<-summary(lm(ordrank.8.atci.hm$ds~ordrank.8.atci.hm$ord.rank))
s8.atci.hm<-lm8.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.hm<-data.frame(X1=attacks.atci.hm[[25]],X2=attacks.atci.hm[[26]],Victories=attacks.atci.hm[[27]])
mat9.atci.hm<-inter.mat(mut9.atci.hm)
tri9.atci.hm<-tr.tri(mat9.atci.hm)
dci9.atci.hm<-DCindex(mat9.atci.hm)
mat9.atci.hm[is.na(mat9.atci.hm)] = 0
h9.atci.hm<-h.index(mat9.atci.hm)

ep9.atci.hm<-ep(mut9.atci.hm,a9.ci.sf.hm)
david9.atci.hm<-DS(mat9.atci.hm) #David's Scores - for steepness use normDS output
ordrank.9.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.hm<-cbind(ordrank.9.atci.hm,ds=david9.atci.hm$normDS)
lm9.atci.hm<-summary(lm(ordrank.9.atci.hm$ds~ordrank.9.atci.hm$ord.rank))
s9.atci.hm<-lm9.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.hm<-data.frame(X1=attacks.atci.hm[[28]],X2=attacks.atci.hm[[29]],Victories=attacks.atci.hm[[30]])
mat10.atci.hm<-inter.mat(mut10.atci.hm)
tri10.atci.hm<-tr.tri(mat10.atci.hm)
dci10.atci.hm<-DCindex(mat10.atci.hm)
mat10.atci.hm[is.na(mat10.atci.hm)] = 0
h10.atci.hm<-h.index(mat10.atci.hm)

ep10.atci.hm<-ep(mut10.atci.hm,a10.ci.sf.hm)
david10.atci.hm<-DS(mat10.atci.hm) #David's Scores - for steepness use normDS output
ordrank.10.atci.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.hm<-cbind(ordrank.10.atci.hm,ds=david10.atci.hm$normDS)
lm10.atci.hm<-summary(lm(ordrank.10.atci.hm$ds~ordrank.10.atci.hm$ord.rank))
s10.atci.hm<-lm10.atci.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.hm<-sum(mut1.atci.hm$Victories)
int2.atci.hm<-sum(mut2.atci.hm$Victories)
int3.atci.hm<-sum(mut3.atci.hm$Victories)
int4.atci.hm<-sum(mut4.atci.hm$Victories)
int5.atci.hm<-sum(mut5.atci.hm$Victories)
int6.atci.hm<-sum(mut6.atci.hm$Victories)
int7.atci.hm<-sum(mut7.atci.hm$Victories)
int8.atci.hm<-sum(mut8.atci.hm$Victories)
int9.atci.hm<-sum(mut9.atci.hm$Victories)
int10.atci.hm<-sum(mut10.atci.hm$Victories)

  # Summarize the avoidances in each trial:
av1.ci.sf.hm<-sum(a1.ci.sf.hm$Avoids)
av2.ci.sf.hm<-sum(a2.ci.sf.hm$Avoids)
av3.ci.sf.hm<-sum(a3.ci.sf.hm$Avoids)
av4.ci.sf.hm<-sum(a4.ci.sf.hm$Avoids)
av5.ci.sf.hm<-sum(a5.ci.sf.hm$Avoids)
av6.ci.sf.hm<-sum(a6.ci.sf.hm$Avoids)
av7.ci.sf.hm<-sum(a7.ci.sf.hm$Avoids)
av8.ci.sf.hm<-sum(a8.ci.sf.hm$Avoids)
av9.ci.sf.hm<-sum(a9.ci.sf.hm$Avoids)
av10.ci.sf.hm<-sum(a10.ci.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.ci.sf<-(sum(av1.ci.sf.hm, av2.ci.sf.hm, av3.ci.sf.hm, av4.ci.sf.hm, av5.ci.sf.hm, av6.ci.sf.hm, av7.ci.sf.hm, av8.ci.sf.hm, av9.ci.sf.hm, av10.ci.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.ci.sf<-(sum(int1.atci.hm, int2.atci.hm, int3.atci.hm, int4.atci.hm, int5.atci.hm, int6.atci.hm, int7.atci.hm, int8.atci.hm, int9.atci.hm, int10.atci.hm))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.hm<-e1.atci.hm[order(e1.atci.hm$ID),]
e1.atci.hm<-as.matrix(t(e1.1.atci.hm))

e2.atci.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.hm<-e2.atci.hm[order(e2.atci.hm$ID),]
e2.atci.hm<-as.matrix(t(e2.1.atci.hm))

e3.atci.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.hm<-e3.atci.hm[order(e3.atci.hm$ID),]
e3.atci.hm<-as.matrix(t(e3.1.atci.hm))

e4.atci.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.hm<-e4.atci.hm[order(e4.atci.hm$ID),]
e4.atci.hm<-as.matrix(t(e4.1.atci.hm))

e5.atci.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.hm<-e5.atci.hm[order(e5.atci.hm$ID),]
e5.atci.hm<-as.matrix(t(e5.1.atci.hm))

e6.atci.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.hm<-e6.atci.hm[order(e6.atci.hm$ID),]
e6.atci.hm<-as.matrix(t(e6.1.atci.hm))

e7.atci.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.hm<-e7.atci.hm[order(e7.atci.hm$ID),]
e7.atci.hm<-as.matrix(t(e7.1.atci.hm))

e8.atci.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.hm<-e8.atci.hm[order(e8.atci.hm$ID),]
e8.atci.hm<-as.matrix(t(e8.1.atci.hm))

e9.atci.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.hm<-e9.atci.hm[order(e9.atci.hm$ID),]
e9.atci.hm<-as.matrix(t(e9.1.atci.hm))

e10.atci.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.hm<-e10.atci.hm[order(e10.atci.hm$ID),]
e10.atci.hm<-as.matrix(t(e10.1.atci.hm))

energy.hm.atci.hm<-as.data.frame(matrix(c(e1.atci.hm,e2.atci.hm,e3.atci.hm,e4.atci.hm,e5.atci.hm,e6.atci.hm,e7.atci.hm,e8.atci.hm,e9.atci.hm,e10.atci.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atci.hm<-data.frame(ID=energy.hm.atci.hm$V1,energy_over_distance=energy.hm.atci.hm$V2,energy_over_time=energy.hm.atci.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.hm<-david1.atci.hm[order(david1.atci.hm$ID),]
david1.atci.hm<-as.matrix(t(david1.1.atci.hm))

david2.1.atci.hm<-david2.atci.hm[order(david2.atci.hm$ID),]
david2.atci.hm<-as.matrix(t(david2.1.atci.hm))

david3.1.atci.hm<-david3.atci.hm[order(david3.atci.hm$ID),]
david3.atci.hm<-as.matrix(t(david3.1.atci.hm))

david4.1.atci.hm<-david4.atci.hm[order(david4.atci.hm$ID),]
david4.atci.hm<-as.matrix(t(david4.1.atci.hm))

david5.1.atci.hm<-david5.atci.hm[order(david5.atci.hm$ID),]
david5.atci.hm<-as.matrix(t(david5.1.atci.hm))

david6.1.atci.hm<-david6.atci.hm[order(david6.atci.hm$ID),]
david6.atci.hm<-as.matrix(t(david6.1.atci.hm))

david7.1.atci.hm<-david7.atci.hm[order(david7.atci.hm$ID),]
david7.atci.hm<-as.matrix(t(david7.1.atci.hm))

david8.1.atci.hm<-david8.atci.hm[order(david8.atci.hm$ID),]
david8.atci.hm<-as.matrix(t(david8.1.atci.hm))

david9.1.atci.hm<-david9.atci.hm[order(david9.atci.hm$ID),]
david9.atci.hm<-as.matrix(t(david9.1.atci.hm))

david10.1.atci.hm<-david10.atci.hm[order(david10.atci.hm$ID),]
david10.atci.hm<-as.matrix(t(david10.1.atci.hm))

david.hm.atci.hm<-as.data.frame(matrix(c(david1.atci.hm,david2.atci.hm,david3.atci.hm,david4.atci.hm,david5.atci.hm,david6.atci.hm,david7.atci.hm,david8.atci.hm,david9.atci.hm,david10.atci.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atci.hm<-data.frame(ID=david.hm.atci.hm$V1,DS=david.hm.atci.hm$V2,normDS=david.hm.atci.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atci.hm<-lm(e1.1.atci.hm$energy_over_time~as.numeric(david1.1.atci.hm$normDS))
hm.lm.1.s.atci.hm<-summary(lm.hm.1.atci.hm)$coefficients
hm.1.slope.atci.hm<-hm.lm.1.s.atci.hm[2,1]
lm.hm.2.atci.hm<-lm(e2.1.atci.hm$energy_over_time~as.numeric(david2.1.atci.hm$normDS))
hm.lm.2.s.atci.hm<-summary(lm.hm.2.atci.hm)$coefficients
hm.2.slope.atci.hm<-hm.lm.2.s.atci.hm[2,1]
lm.hm.3.atci.hm<-lm(e3.1.atci.hm$energy_over_time~as.numeric(david3.1.atci.hm$normDS))
hm.lm.3.s.atci.hm<-summary(lm.hm.3.atci.hm)$coefficients
hm.3.slope.atci.hm<-hm.lm.3.s.atci.hm[2,1]
lm.hm.4.atci.hm<-lm(e4.1.atci.hm$energy_over_time~as.numeric(david4.1.atci.hm$normDS))
hm.lm.4.s.atci.hm<-summary(lm.hm.4.atci.hm)$coefficients
hm.4.slope.atci.hm<-hm.lm.4.s.atci.hm[2,1]
lm.hm.5.atci.hm<-lm(e5.1.atci.hm$energy_over_time~as.numeric(david5.1.atci.hm$normDS))
hm.lm.5.s.atci.hm<-summary(lm.hm.5.atci.hm)$coefficients
hm.5.slope.atci.hm<-hm.lm.5.s.atci.hm[2,1]
lm.hm.6.atci.hm<-lm(e6.1.atci.hm$energy_over_time~as.numeric(david6.1.atci.hm$normDS))
hm.lm.6.s.atci.hm<-summary(lm.hm.6.atci.hm)$coefficients
hm.6.slope.atci.hm<-hm.lm.6.s.atci.hm[2,1]
lm.hm.7.atci.hm<-lm(e7.1.atci.hm$energy_over_time~as.numeric(david7.1.atci.hm$normDS))
hm.lm.7.s.atci.hm<-summary(lm.hm.7.atci.hm)$coefficients
hm.7.slope.atci.hm<-hm.lm.7.s.atci.hm[2,1]
lm.hm.8.atci.hm<-lm(e8.1.atci.hm$energy_over_time~as.numeric(david8.1.atci.hm$normDS))
hm.lm.8.s.atci.hm<-summary(lm.hm.8.atci.hm)$coefficients
hm.8.slope.atci.hm<-hm.lm.8.s.atci.hm[2,1]
lm.hm.9.atci.hm<-lm(e9.1.atci.hm$energy_over_time~as.numeric(david9.1.atci.hm$normDS))
hm.lm.9.s.atci.hm<-summary(lm.hm.9.atci.hm)$coefficients
hm.9.slope.atci.hm<-hm.lm.9.s.atci.hm[2,1]
lm.hm.10.atci.hm<-lm(e10.1.atci.hm$energy_over_time~as.numeric(david10.1.atci.hm$normDS))
hm.lm.10.s.atci.hm<-summary(lm.hm.10.atci.hm)$coefficients
hm.10.slope.atci.hm<-hm.lm.10.s.atci.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atci.ss.attacks.atci.hm<-data.frame(triangle.transitivity=c(tri1.atci.hm,tri2.atci.hm,tri3.atci.hm,tri4.atci.hm,tri5.atci.hm,tri6.atci.hm,tri7.atci.hm,tri8.atci.hm,tri9.atci.hm,tri10.atci.hm),escalation=c(ep1.atci.hm,ep2.atci.hm,ep3.atci.hm,ep4.atci.hm,ep5.atci.hm,ep6.atci.hm,ep7.atci.hm,ep8.atci.hm,ep9.atci.hm,ep10.atci.hm),dci=c(dci1.atci.hm,dci2.atci.hm,dci3.atci.hm,dci4.atci.hm,dci5.atci.hm,dci6.atci.hm,dci7.atci.hm,dci8.atci.hm,dci9.atci.hm,dci10.atci.hm),steepness=c(s1.atci.hm,s2.atci.hm,s3.atci.hm,s4.atci.hm,s5.atci.hm,s6.atci.hm,s7.atci.hm,s8.atci.hm,s9.atci.hm,s10.atci.hm),slope=c(hm.1.slope.atci.hm,hm.2.slope.atci.hm,hm.3.slope.atci.hm,hm.4.slope.atci.hm,hm.5.slope.atci.hm,hm.6.slope.atci.hm,hm.7.slope.atci.hm,hm.8.slope.atci.hm,hm.9.slope.atci.hm,hm.10.slope.atci.hm))


```
```{r Attacks Clumped Deterministic Data Frame}
#knowledge mutual
km.tt.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$triangle.transitivity)
km.ci.sfi.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$dci)
km.esc.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$escalation)
km.steep.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$steepness)
km.slope.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$slope)
km.mean.ci.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ci.sf.attacks,dci=km.ci.sfi.ci.sf.attacks,esc=km.esc.ci.sf.attacks,steepness=km.steep.ci.sf.attacks,slope=km.slope.ci.sf.attacks,dist="clumped",calc="deterministic")

#history mutual
hm.tt.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$triangle.transitivity)
hm.ci.sfi.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$dci)
hm.esc.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$escalation)
hm.steep.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$steepness)
hm.slope.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$slope)
hm.mean.ci.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.ci.sf.attacks,dci=hm.ci.sfi.ci.sf.attacks,esc=hm.esc.ci.sf.attacks,steepness=hm.steep.ci.sf.attacks,slope=hm.slope.ci.sf.attacks,dist="clumped",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.ci.sf.attacks,hm.mean.ci.sf.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$triangle.transitivity)
km.ci.sfi.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$dci)
km.esc.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$escalation)
km.steep.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$steepness)
km.slope.ci.sf.attacks<-mean(km.atci.ss.attacks.atci.km$slope)
km.mean.ci.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ci.sf.attacks,dci=km.ci.sfi.ci.sf.attacks,esc=km.esc.ci.sf.attacks,steepness=km.steep.ci.sf.attacks,slope=km.slope.ci.sf.attacks,dist="clumped",calc="deterministic")

#history mutual
hm.tt.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$triangle.transitivity)
hm.ci.sfi.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$dci)
hm.esc.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$escalation)
hm.steep.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$steepness)
hm.slope.ci.sf.attacks<-mean(hm.atci.ss.attacks.atci.hm$slope)
hm.mean.ci.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.ci.sf.attacks,dci=hm.ci.sfi.ci.sf.attacks,esc=hm.esc.ci.sf.attacks,steepness=hm.steep.ci.sf.attacks,slope=hm.slope.ci.sf.attacks,dist="clumped",calc="deterministic")

#total average dataframe
ci.sf.attacks.ave<-rbind(km.mean.ci.sf.attacks,hm.mean.ci.sf.attacks)

#create overall dataframe of summary statistics
overall.clump.sf.attacks.initiator.sf<-data.frame(km.atci.ss.attacks.atci.km)
overall.clump.sf.attacks.initiator.sf<-rbind(overall.clump.sf.attacks.initiator.sf,hm.atci.ss.attacks.atci.hm)

overall.clump.sf.attacks.initiator.sf<-cbind(overall.clump.sf.attacks.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.clump.sf.attacks.initiator.sf<-cbind(overall.clump.sf.attacks.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("initiator",20))


rhp.ss.attacks.ci.sf<-overall.clump.sf.attacks.initiator.sf[overall.clump.sf.attacks.initiator.sf$variable=="rhp",]
history.ss.attacks.ci.sf<-overall.clump.sf.attacks.initiator.sf[overall.clump.sf.attacks.initiator.sf$variable=="history",]

overall.clump.sf.attacks.initiator.sf$combo<-paste(overall.clump.sf.attacks.initiator.sf$strategy,overall.clump.sf.attacks.initiator.sf$variable,overall.clump.sf.attacks.initiator.sf$distribution)
overall.clump.sf.attacks.initiator.sf$combo2<-paste(overall.clump.sf.attacks.initiator.sf$strategy,overall.clump.sf.attacks.initiator.sf$variable)
```

## Uniform Initiator Wins Data
```{r Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.sf.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[1]],X2=avoid.ui.sf.km[[2]],Avoids=avoid.ui.sf.km[[3]])
a2.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[4]],X2=avoid.ui.sf.km[[5]],Avoids=avoid.ui.sf.km[[6]])
a3.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[7]],X2=avoid.ui.sf.km[[8]],Avoids=avoid.ui.sf.km[[9]])
a4.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[10]],X2=avoid.ui.sf.km[[11]],Avoids=avoid.ui.sf.km[[12]])
a5.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[13]],X2=avoid.ui.sf.km[[14]],Avoids=avoid.ui.sf.km[[15]])
a6.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[16]],X2=avoid.ui.sf.km[[17]],Avoids=avoid.ui.sf.km[[18]])
a7.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[19]],X2=avoid.ui.sf.km[[20]],Avoids=avoid.ui.sf.km[[21]])
a8.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[22]],X2=avoid.ui.sf.km[[23]],Avoids=avoid.ui.sf.km[[24]])
a9.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[25]],X2=avoid.ui.sf.km[[26]],Avoids=avoid.ui.sf.km[[27]])
a10.ui.sf.km<-data.frame(X1=avoid.ui.sf.km[[28]],X2=avoid.ui.sf.km[[29]],Avoids=avoid.ui.sf.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.km.ui.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[1]],X2=conflict.km.ui.sf[[2]],Victories=conflict.km.ui.sf[[3]])
mat1.ui.sf.km<-inter.mat(mut1.ui.sf.km)
tri1.ui.sf.km<-tr.tri(mat1.ui.sf.km)
dci1.ui.sf.km<-DCindex(mat1.ui.sf.km)
mat1.ui.sf.km[is.na(mat1.ui.sf.km)] = 0
h1.ui.sf.km<-h.index(mat1.ui.sf.km)

ep1.ui.sf.km<-ep(mut1.ui.sf.km,a1.ui.sf.km)
david1.ui.sf.km<-DS(mat1.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.sf.km<-cbind(ordrank.1.ui.sf.km,ds=david1.ui.sf.km$normDS)
lm1.ui.sf.km<-summary(lm(ordrank.1.ui.sf.km$ds~ordrank.1.ui.sf.km$ord.rank))
s1.ui.sf.km<-lm1.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[4]],X2=conflict.km.ui.sf[[5]],Victories=conflict.km.ui.sf[[6]])
mat2.ui.sf.km<-inter.mat(mut2.ui.sf.km)
tri2.ui.sf.km<-tr.tri(mat2.ui.sf.km)
dci2.ui.sf.km<-DCindex(mat2.ui.sf.km)
mat2.ui.sf.km[is.na(mat2.ui.sf.km)] = 0
h2.ui.sf.km<-h.index(mat2.ui.sf.km)

ep2.ui.sf.km<-ep(mut2.ui.sf.km,a2.ui.sf.km)
david2.ui.sf.km<-DS(mat2.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.sf.km<-cbind(ordrank.2.ui.sf.km,ds=david2.ui.sf.km$normDS)
lm2.ui.sf.km<-summary(lm(ordrank.2.ui.sf.km$ds~ordrank.2.ui.sf.km$ord.rank))
s2.ui.sf.km<-lm2.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[7]],X2=conflict.km.ui.sf[[8]],Victories=conflict.km.ui.sf[[9]])
mat3.ui.sf.km<-inter.mat(mut3.ui.sf.km)
tri3.ui.sf.km<-tr.tri(mat3.ui.sf.km)
dci3.ui.sf.km<-DCindex(mat3.ui.sf.km)
mat3.ui.sf.km[is.na(mat3.ui.sf.km)] = 0
h3.ui.sf.km<-h.index(mat3.ui.sf.km)

ep3.ui.sf.km<-ep(mut3.ui.sf.km,a3.ui.sf.km)
david3.ui.sf.km<-DS(mat3.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.sf.km<-cbind(ordrank.3.ui.sf.km,ds=david3.ui.sf.km$normDS)
lm3.ui.sf.km<-summary(lm(ordrank.3.ui.sf.km$ds~ordrank.3.ui.sf.km$ord.rank))
s3.ui.sf.km<-lm3.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[10]],X2=conflict.km.ui.sf[[11]],Victories=conflict.km.ui.sf[[12]])
mat4.ui.sf.km<-inter.mat(mut4.ui.sf.km)
tri4.ui.sf.km<-tr.tri(mat4.ui.sf.km)
dci4.ui.sf.km<-DCindex(mat4.ui.sf.km)
mat4.ui.sf.km[is.na(mat4.ui.sf.km)] = 0
h4.ui.sf.km<-h.index(mat4.ui.sf.km)

ep4.ui.sf.km<-ep(mut4.ui.sf.km,a4.ui.sf.km)
david4.ui.sf.km<-DS(mat4.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.sf.km<-cbind(ordrank.4.ui.sf.km,ds=david4.ui.sf.km$normDS)
lm4.ui.sf.km<-summary(lm(ordrank.4.ui.sf.km$ds~ordrank.4.ui.sf.km$ord.rank))
s4.ui.sf.km<-lm4.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[13]],X2=conflict.km.ui.sf[[14]],Victories=conflict.km.ui.sf[[15]])
mat5.ui.sf.km<-inter.mat(mut5.ui.sf.km)
tri5.ui.sf.km<-tr.tri(mat5.ui.sf.km)
dci5.ui.sf.km<-DCindex(mat5.ui.sf.km)
mat5.ui.sf.km[is.na(mat5.ui.sf.km)] = 0
h5.ui.sf.km<-h.index(mat5.ui.sf.km)

ep5.ui.sf.km<-ep(mut5.ui.sf.km,a5.ui.sf.km)
david5.ui.sf.km<-DS(mat5.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.sf.km<-cbind(ordrank.5.ui.sf.km,ds=david5.ui.sf.km$normDS)
lm5.ui.sf.km<-summary(lm(ordrank.5.ui.sf.km$ds~ordrank.5.ui.sf.km$ord.rank))
s5.ui.sf.km<-lm5.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[16]],X2=conflict.km.ui.sf[[17]],Victories=conflict.km.ui.sf[[18]])
mat6.ui.sf.km<-inter.mat(mut6.ui.sf.km)
tri6.ui.sf.km<-tr.tri(mat6.ui.sf.km)
dci6.ui.sf.km<-DCindex(mat6.ui.sf.km)
mat6.ui.sf.km[is.na(mat6.ui.sf.km)] = 0
h6.ui.sf.km<-h.index(mat6.ui.sf.km)

ep6.ui.sf.km<-ep(mut6.ui.sf.km,a6.ui.sf.km)
david6.ui.sf.km<-DS(mat6.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.sf.km<-cbind(ordrank.6.ui.sf.km,ds=david6.ui.sf.km$normDS)
lm6.ui.sf.km<-summary(lm(ordrank.6.ui.sf.km$ds~ordrank.6.ui.sf.km$ord.rank))
s6.ui.sf.km<-lm6.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[19]],X2=conflict.km.ui.sf[[20]],Victories=conflict.km.ui.sf[[21]])
mat7.ui.sf.km<-inter.mat(mut7.ui.sf.km)
tri7.ui.sf.km<-tr.tri(mat7.ui.sf.km)
dci7.ui.sf.km<-DCindex(mat7.ui.sf.km)
mat7.ui.sf.km[is.na(mat7.ui.sf.km)] = 0
h7.ui.sf.km<-h.index(mat7.ui.sf.km)

ep7.ui.sf.km<-ep(mut7.ui.sf.km,a7.ui.sf.km)
david7.ui.sf.km<-DS(mat7.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.sf.km<-cbind(ordrank.7.ui.sf.km,ds=david7.ui.sf.km$normDS)
lm7.ui.sf.km<-summary(lm(ordrank.7.ui.sf.km$ds~ordrank.7.ui.sf.km$ord.rank))
s7.ui.sf.km<-lm7.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[22]],X2=conflict.km.ui.sf[[23]],Victories=conflict.km.ui.sf[[24]])
mat8.ui.sf.km<-inter.mat(mut8.ui.sf.km)
tri8.ui.sf.km<-tr.tri(mat8.ui.sf.km)
dci8.ui.sf.km<-DCindex(mat8.ui.sf.km)
mat8.ui.sf.km[is.na(mat8.ui.sf.km)] = 0
h8.ui.sf.km<-h.index(mat8.ui.sf.km)

ep8.ui.sf.km<-ep(mut8.ui.sf.km,a8.ui.sf.km)
david8.ui.sf.km<-DS(mat8.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.sf.km<-cbind(ordrank.8.ui.sf.km,ds=david8.ui.sf.km$normDS)
lm8.ui.sf.km<-summary(lm(ordrank.8.ui.sf.km$ds~ordrank.8.ui.sf.km$ord.rank))
s8.ui.sf.km<-lm8.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[25]],X2=conflict.km.ui.sf[[26]],Victories=conflict.km.ui.sf[[27]])
mat9.ui.sf.km<-inter.mat(mut9.ui.sf.km)
tri9.ui.sf.km<-tr.tri(mat9.ui.sf.km)
dci9.ui.sf.km<-DCindex(mat9.ui.sf.km)
mat9.ui.sf.km[is.na(mat9.ui.sf.km)] = 0
h9.ui.sf.km<-h.index(mat9.ui.sf.km)

ep9.ui.sf.km<-ep(mut9.ui.sf.km,a9.ui.sf.km)
david9.ui.sf.km<-DS(mat9.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.sf.km<-cbind(ordrank.9.ui.sf.km,ds=david9.ui.sf.km$normDS)
lm9.ui.sf.km<-summary(lm(ordrank.9.ui.sf.km$ds~ordrank.9.ui.sf.km$ord.rank))
s9.ui.sf.km<-lm9.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.sf.km<-data.frame(X1=conflict.km.ui.sf[[28]],X2=conflict.km.ui.sf[[29]],Victories=conflict.km.ui.sf[[30]])
mat10.ui.sf.km<-inter.mat(mut10.ui.sf.km)
tri10.ui.sf.km<-tr.tri(mat10.ui.sf.km)
dci10.ui.sf.km<-DCindex(mat10.ui.sf.km)
mat10.ui.sf.km[is.na(mat10.ui.sf.km)] = 0
h10.ui.sf.km<-h.index(mat10.ui.sf.km)

ep10.ui.sf.km<-ep(mut10.ui.sf.km,a10.ui.sf.km)
david10.ui.sf.km<-DS(mat10.ui.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.ui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.sf.km<-cbind(ordrank.10.ui.sf.km,ds=david10.ui.sf.km$normDS)
lm10.ui.sf.km<-summary(lm(ordrank.10.ui.sf.km$ds~ordrank.10.ui.sf.km$ord.rank))
s10.ui.sf.km<-lm10.ui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.sf.km<-sum(mut1.ui.sf.km$Victories)
int2.ui.sf.km<-sum(mut2.ui.sf.km$Victories)
int3.ui.sf.km<-sum(mut3.ui.sf.km$Victories)
int4.ui.sf.km<-sum(mut4.ui.sf.km$Victories)
int5.ui.sf.km<-sum(mut5.ui.sf.km$Victories)
int6.ui.sf.km<-sum(mut6.ui.sf.km$Victories)
int7.ui.sf.km<-sum(mut7.ui.sf.km$Victories)
int8.ui.sf.km<-sum(mut8.ui.sf.km$Victories)
int9.ui.sf.km<-sum(mut9.ui.sf.km$Victories)
int10.ui.sf.km<-sum(mut10.ui.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.ui.sf.km<-sum(a1.ui.sf.km$Avoids)
av2.ui.sf.km<-sum(a2.ui.sf.km$Avoids)
av3.ui.sf.km<-sum(a3.ui.sf.km$Avoids)
av4.ui.sf.km<-sum(a4.ui.sf.km$Avoids)
av5.ui.sf.km<-sum(a5.ui.sf.km$Avoids)
av6.ui.sf.km<-sum(a6.ui.sf.km$Avoids)
av7.ui.sf.km<-sum(a7.ui.sf.km$Avoids)
av8.ui.sf.km<-sum(a8.ui.sf.km$Avoids)
av9.ui.sf.km<-sum(a9.ui.sf.km$Avoids)
av10.ui.sf.km<-sum(a10.ui.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.iu.sf<-(sum(av1.ui.sf.km, av2.ui.sf.km, av3.ui.sf.km, av4.ui.sf.km, av5.ui.sf.km, av6.ui.sf.km, av7.ui.sf.km, av8.ui.sf.km, av9.ui.sf.km, av10.ui.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.iu.sf<-(sum(int1.ui.sf.km, int2.ui.sf.km, int3.ui.sf.km, int4.ui.sf.km, int5.ui.sf.km, int6.ui.sf.km, int7.ui.sf.km, int8.ui.sf.km, int9.ui.sf.km, int10.ui.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.sf.km<-e1.ui.sf.km[order(e1.ui.sf.km$ID),]
e1.ui.sf.km<-as.matrix(t(e1.1.ui.sf.km))

e2.ui.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.sf.km<-e2.ui.sf.km[order(e2.ui.sf.km$ID),]
e2.ui.sf.km<-as.matrix(t(e2.1.ui.sf.km))

e3.ui.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.sf.km<-e3.ui.sf.km[order(e3.ui.sf.km$ID),]
e3.ui.sf.km<-as.matrix(t(e3.1.ui.sf.km))

e4.ui.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.sf.km<-e4.ui.sf.km[order(e4.ui.sf.km$ID),]
e4.ui.sf.km<-as.matrix(t(e4.1.ui.sf.km))

e5.ui.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.sf.km<-e5.ui.sf.km[order(e5.ui.sf.km$ID),]
e5.ui.sf.km<-as.matrix(t(e5.1.ui.sf.km))

e6.ui.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.sf.km<-e6.ui.sf.km[order(e6.ui.sf.km$ID),]
e6.ui.sf.km<-as.matrix(t(e6.1.ui.sf.km))

e7.ui.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.sf.km<-e7.ui.sf.km[order(e7.ui.sf.km$ID),]
e7.ui.sf.km<-as.matrix(t(e7.1.ui.sf.km))

e8.ui.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.sf.km<-e8.ui.sf.km[order(e8.ui.sf.km$ID),]
e8.ui.sf.km<-as.matrix(t(e8.1.ui.sf.km))

e9.ui.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.sf.km<-e9.ui.sf.km[order(e9.ui.sf.km$ID),]
e9.ui.sf.km<-as.matrix(t(e9.1.ui.sf.km))

e10.ui.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.sf.km<-e10.ui.sf.km[order(e10.ui.sf.km$ID),]
e10.ui.sf.km<-as.matrix(t(e10.1.ui.sf.km))

energy.km.ui.sf.km<-as.data.frame(matrix(c(e1.ui.sf.km,e2.ui.sf.km,e3.ui.sf.km,e4.ui.sf.km,e5.ui.sf.km,e6.ui.sf.km,e7.ui.sf.km,e8.ui.sf.km,e9.ui.sf.km,e10.ui.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.ui.sf.km<-data.frame(ID=energy.km.ui.sf.km$V1,energy_over_distance=energy.km.ui.sf.km$V2,energy_over_time=energy.km.ui.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.sf.km<-david1.ui.sf.km[order(david1.ui.sf.km$ID),]
david1.ui.sf.km<-as.matrix(t(david1.1.ui.sf.km))

david2.1.ui.sf.km<-david2.ui.sf.km[order(david2.ui.sf.km$ID),]
david2.ui.sf.km<-as.matrix(t(david2.1.ui.sf.km))

david3.1.ui.sf.km<-david3.ui.sf.km[order(david3.ui.sf.km$ID),]
david3.ui.sf.km<-as.matrix(t(david3.1.ui.sf.km))

david4.1.ui.sf.km<-david4.ui.sf.km[order(david4.ui.sf.km$ID),]
david4.ui.sf.km<-as.matrix(t(david4.1.ui.sf.km))

david5.1.ui.sf.km<-david5.ui.sf.km[order(david5.ui.sf.km$ID),]
david5.ui.sf.km<-as.matrix(t(david5.1.ui.sf.km))

david6.1.ui.sf.km<-david6.ui.sf.km[order(david6.ui.sf.km$ID),]
david6.ui.sf.km<-as.matrix(t(david6.1.ui.sf.km))

david7.1.ui.sf.km<-david7.ui.sf.km[order(david7.ui.sf.km$ID),]
david7.ui.sf.km<-as.matrix(t(david7.1.ui.sf.km))

david8.1.ui.sf.km<-david8.ui.sf.km[order(david8.ui.sf.km$ID),]
david8.ui.sf.km<-as.matrix(t(david8.1.ui.sf.km))

david9.1.ui.sf.km<-david9.ui.sf.km[order(david9.ui.sf.km$ID),]
david9.ui.sf.km<-as.matrix(t(david9.1.ui.sf.km))

david10.1.ui.sf.km<-david10.ui.sf.km[order(david10.ui.sf.km$ID),]
david10.ui.sf.km<-as.matrix(t(david10.1.ui.sf.km))

david.km.ui.sf.km<-as.data.frame(matrix(c(david1.ui.sf.km,david2.ui.sf.km,david3.ui.sf.km,david4.ui.sf.km,david5.ui.sf.km,david6.ui.sf.km,david7.ui.sf.km,david8.ui.sf.km,david9.ui.sf.km,david10.ui.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.ui.sf.km<-data.frame(ID=david.km.ui.sf.km$V1,DS=david.km.ui.sf.km$V2,normDS=david.km.ui.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.ui.sf.km<-lm(e1.1.ui.sf.km$energy_over_time~as.numeric(david1.1.ui.sf.km$normDS))
km.lm.1.s.ui.sf.km<-summary(lm.km.1.ui.sf.km)$coefficients
km.1.slope.ui.sf.km<-km.lm.1.s.ui.sf.km[2,1]
lm.km.2.ui.sf.km<-lm(e2.1.ui.sf.km$energy_over_time~as.numeric(david2.1.ui.sf.km$normDS))
km.lm.2.s.ui.sf.km<-summary(lm.km.2.ui.sf.km)$coefficients
km.2.slope.ui.sf.km<-km.lm.2.s.ui.sf.km[2,1]
lm.km.3.ui.sf.km<-lm(e3.1.ui.sf.km$energy_over_time~as.numeric(david3.1.ui.sf.km$normDS))
km.lm.3.s.ui.sf.km<-summary(lm.km.3.ui.sf.km)$coefficients
km.3.slope.ui.sf.km<-km.lm.3.s.ui.sf.km[2,1]
lm.km.4.ui.sf.km<-lm(e4.1.ui.sf.km$energy_over_time~as.numeric(david4.1.ui.sf.km$normDS))
km.lm.4.s.ui.sf.km<-summary(lm.km.4.ui.sf.km)$coefficients
km.4.slope.ui.sf.km<-km.lm.4.s.ui.sf.km[2,1]
lm.km.5.ui.sf.km<-lm(e5.1.ui.sf.km$energy_over_time~as.numeric(david5.1.ui.sf.km$normDS))
km.lm.5.s.ui.sf.km<-summary(lm.km.5.ui.sf.km)$coefficients
km.5.slope.ui.sf.km<-km.lm.5.s.ui.sf.km[2,1]
lm.km.6.ui.sf.km<-lm(e6.1.ui.sf.km$energy_over_time~as.numeric(david6.1.ui.sf.km$normDS))
km.lm.6.s.ui.sf.km<-summary(lm.km.6.ui.sf.km)$coefficients
km.6.slope.ui.sf.km<-km.lm.6.s.ui.sf.km[2,1]
lm.km.7.ui.sf.km<-lm(e7.1.ui.sf.km$energy_over_time~as.numeric(david7.1.ui.sf.km$normDS))
km.lm.7.s.ui.sf.km<-summary(lm.km.7.ui.sf.km)$coefficients
km.7.slope.ui.sf.km<-km.lm.7.s.ui.sf.km[2,1]
lm.km.8.ui.sf.km<-lm(e8.1.ui.sf.km$energy_over_time~as.numeric(david8.1.ui.sf.km$normDS))
km.lm.8.s.ui.sf.km<-summary(lm.km.8.ui.sf.km)$coefficients
km.8.slope.ui.sf.km<-km.lm.8.s.ui.sf.km[2,1]
lm.km.9.ui.sf.km<-lm(e9.1.ui.sf.km$energy_over_time~as.numeric(david9.1.ui.sf.km$normDS))
km.lm.9.s.ui.sf.km<-summary(lm.km.9.ui.sf.km)$coefficients
km.9.slope.ui.sf.km<-km.lm.9.s.ui.sf.km[2,1]
lm.km.10.ui.sf.km<-lm(e10.1.ui.sf.km$energy_over_time~as.numeric(david10.1.ui.sf.km$normDS))
km.lm.10.s.ui.sf.km<-summary(lm.km.10.ui.sf.km)$coefficients
km.10.slope.ui.sf.km<-km.lm.10.s.ui.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.ui.sf.ss<-data.frame(triangle.transitivity=c(tri1.ui.sf.km,tri2.ui.sf.km,tri3.ui.sf.km,tri4.ui.sf.km,tri5.ui.sf.km,tri6.ui.sf.km,tri7.ui.sf.km,tri8.ui.sf.km,tri9.ui.sf.km,tri10.ui.sf.km),escalation=c(ep1.ui.sf.km,ep2.ui.sf.km,ep3.ui.sf.km,ep4.ui.sf.km,ep5.ui.sf.km,ep6.ui.sf.km,ep7.ui.sf.km,ep8.ui.sf.km,ep9.ui.sf.km,ep10.ui.sf.km),dci=c(dci1.ui.sf.km,dci2.ui.sf.km,dci3.ui.sf.km,dci4.ui.sf.km,dci5.ui.sf.km,dci6.ui.sf.km,dci7.ui.sf.km,dci8.ui.sf.km,dci9.ui.sf.km,dci10.ui.sf.km),steepness=c(s1.ui.sf.km,s2.ui.sf.km,s3.ui.sf.km,s4.ui.sf.km,s5.ui.sf.km,s6.ui.sf.km,s7.ui.sf.km,s8.ui.sf.km,s9.ui.sf.km,s10.ui.sf.km),slope=c(km.1.slope.ui.sf.km,km.2.slope.ui.sf.km,km.3.slope.ui.sf.km,km.4.slope.ui.sf.km,km.5.slope.ui.sf.km,km.6.slope.ui.sf.km,km.7.slope.ui.sf.km,km.8.slope.ui.sf.km,km.9.slope.ui.sf.km,km.10.slope.ui.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.sf.hm<-sapply(files, read.csv)



# Separate out the avoidance data into the individual trials:
a1.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[1]]),X2=as.numeric(avoid.ui.sf.hm[[2]]),Victories=as.numeric(avoid.ui.sf.hm[[3]]))
a2.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[4]]),X2=as.numeric(avoid.ui.sf.hm[[5]]),Victories=as.numeric(avoid.ui.sf.hm[[6]]))
a3.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[7]]),X2=as.numeric(avoid.ui.sf.hm[[8]]),Victories=as.numeric(avoid.ui.sf.hm[[9]]))
a4.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[10]]),X2=as.numeric(avoid.ui.sf.hm[[11]]),Victories=as.numeric(avoid.ui.sf.hm[[12]]))
a5.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[13]]),X2=as.numeric(avoid.ui.sf.hm[[14]]),Victories=as.numeric(avoid.ui.sf.hm[[15]]))
a6.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[16]]),X2=as.numeric(avoid.ui.sf.hm[[17]]),Victories=as.numeric(avoid.ui.sf.hm[[18]]))
a7.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[19]]),X2=as.numeric(avoid.ui.sf.hm[[20]]),Victories=as.numeric(avoid.ui.sf.hm[[21]]))
a8.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[22]]),X2=as.numeric(avoid.ui.sf.hm[[23]]),Victories=as.numeric(avoid.ui.sf.hm[[24]]))
a9.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[25]]),X2=as.numeric(avoid.ui.sf.hm[[26]]),Victories=as.numeric(avoid.ui.sf.hm[[27]]))
a10.ui.sf.hm<-data.frame(X1=as.numeric(avoid.ui.sf.hm[[28]]),X2=as.numeric(avoid.ui.sf.hm[[29]]),Victories=as.numeric(avoid.ui.sf.hm[[30]]))


#a2.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[4]],X2=avoid.ui.sf.hm[[5]],Avoids=avoid.ui.sf.hm[[6]])
#a3.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[7]],X2=avoid.ui.sf.hm[[8]],Avoids=avoid.ui.sf.hm[[9]])
#a4.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[10]],X2=avoid.ui.sf.hm[[11]],Avoids=avoid.ui.sf.hm[[12]])
#a5.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[13]],X2=avoid.ui.sf.hm[[14]],Avoids=avoid.ui.sf.hm[[15]])
#a6.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[16]],X2=avoid.ui.sf.hm[[17]],Avoids=avoid.ui.sf.hm[[18]])
#a7.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[19]],X2=avoid.ui.sf.hm[[20]],Avoids=avoid.ui.sf.hm[[21]])
#a8.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[22]],X2=avoid.ui.sf.hm[[23]],Avoids=avoid.ui.sf.hm[[24]])
#a9.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[25]],X2=avoid.ui.sf.hm[[26]],Avoids=avoid.ui.sf.hm[[27]])
#a10.ui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[28]],X2=avoid.ui.sf.hm[[29]],Avoids=avoid.ui.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.ui.sf<-sapply(files, read.csv)


# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[1]],X2=conflict.hm.ui.sf[[2]],Victories=conflict.hm.ui.sf[[3]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut1.ui.sf.hm<-mut1.ui.sf.hm[c(1:90),]
mut1.ui.sf.hm<-transform(mut1.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat1.ui.sf.hm<-inter.mat(mut1.ui.sf.hm)
tri1.ui.sf.hm<-tr.tri(mat1.ui.sf.hm)
dci1.ui.sf.hm<-DCindex(mat1.ui.sf.hm)
mat1.ui.sf.hm[is.na(mat1.ui.sf.hm)] = 0
h1.ui.sf.hm<-h.index(mat1.ui.sf.hm)

ep1.ui.sf.hm<-ep(mut1.ui.sf.hm,a1.ui.sf.hm)
david1.ui.sf.hm<-DS(mat1.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.sf.hm<-cbind(ordrank.1.ui.sf.hm,ds=david1.ui.sf.hm$normDS)
lm1.ui.sf.hm<-summary(lm(ordrank.1.ui.sf.hm$ds~ordrank.1.ui.sf.hm$ord.rank))
s1.ui.sf.hm<-lm1.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[4]],X2=conflict.hm.ui.sf[[5]],Victories=conflict.hm.ui.sf[[6]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut2.ui.sf.hm<-mut2.ui.sf.hm[c(1:90),]
mut2.ui.sf.hm<-transform(mut2.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat2.ui.sf.hm<-inter.mat(mut2.ui.sf.hm)
tri2.ui.sf.hm<-tr.tri(mat2.ui.sf.hm)
dci2.ui.sf.hm<-DCindex(mat2.ui.sf.hm)
mat2.ui.sf.hm[is.na(mat2.ui.sf.hm)] = 0
h2.ui.sf.hm<-h.index(mat2.ui.sf.hm)

ep2.ui.sf.hm<-ep(mut2.ui.sf.hm,a2.ui.sf.hm)
david2.ui.sf.hm<-DS(mat2.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.sf.hm<-cbind(ordrank.2.ui.sf.hm,ds=david2.ui.sf.hm$normDS)
lm2.ui.sf.hm<-summary(lm(ordrank.2.ui.sf.hm$ds~ordrank.2.ui.sf.hm$ord.rank))
s2.ui.sf.hm<-lm2.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[7]],X2=conflict.hm.ui.sf[[8]],Victories=conflict.hm.ui.sf[[9]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut3.ui.sf.hm<-mut3.ui.sf.hm[c(1:90),]
mut3.ui.sf.hm<-transform(mut3.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat3.ui.sf.hm<-inter.mat(mut3.ui.sf.hm)
tri3.ui.sf.hm<-tr.tri(mat3.ui.sf.hm)
dci3.ui.sf.hm<-DCindex(mat3.ui.sf.hm)
mat3.ui.sf.hm[is.na(mat3.ui.sf.hm)] = 0
h3.ui.sf.hm<-h.index(mat3.ui.sf.hm)

ep3.ui.sf.hm<-ep(mut3.ui.sf.hm,a3.ui.sf.hm)
david3.ui.sf.hm<-DS(mat3.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.sf.hm<-cbind(ordrank.3.ui.sf.hm,ds=david3.ui.sf.hm$normDS)
lm3.ui.sf.hm<-summary(lm(ordrank.3.ui.sf.hm$ds~ordrank.3.ui.sf.hm$ord.rank))
s3.ui.sf.hm<-lm3.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[10]],X2=conflict.hm.ui.sf[[11]],Victories=conflict.hm.ui.sf[[12]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut4.ui.sf.hm<-mut4.ui.sf.hm[c(1:90),]
mut4.ui.sf.hm<-transform(mut4.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat4.ui.sf.hm<-inter.mat(mut4.ui.sf.hm)
tri4.ui.sf.hm<-tr.tri(mat4.ui.sf.hm)
dci4.ui.sf.hm<-DCindex(mat4.ui.sf.hm)
mat4.ui.sf.hm[is.na(mat4.ui.sf.hm)] = 0
h4.ui.sf.hm<-h.index(mat4.ui.sf.hm)

ep4.ui.sf.hm<-ep(mut4.ui.sf.hm,a4.ui.sf.hm)
david4.ui.sf.hm<-DS(mat4.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.sf.hm<-cbind(ordrank.4.ui.sf.hm,ds=david4.ui.sf.hm$normDS)
lm4.ui.sf.hm<-summary(lm(ordrank.4.ui.sf.hm$ds~ordrank.4.ui.sf.hm$ord.rank))
s4.ui.sf.hm<-lm4.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[13]],X2=conflict.hm.ui.sf[[14]],Victories=conflict.hm.ui.sf[[15]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut5.ui.sf.hm<-mut5.ui.sf.hm[c(1:90),]
mut5.ui.sf.hm<-transform(mut5.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat5.ui.sf.hm<-inter.mat(mut5.ui.sf.hm)
tri5.ui.sf.hm<-tr.tri(mat5.ui.sf.hm)
dci5.ui.sf.hm<-DCindex(mat5.ui.sf.hm)
mat5.ui.sf.hm[is.na(mat5.ui.sf.hm)] = 0
h5.ui.sf.hm<-h.index(mat5.ui.sf.hm)

ep5.ui.sf.hm<-ep(mut5.ui.sf.hm,a5.ui.sf.hm)
david5.ui.sf.hm<-DS(mat5.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.sf.hm<-cbind(ordrank.5.ui.sf.hm,ds=david5.ui.sf.hm$normDS)
lm5.ui.sf.hm<-summary(lm(ordrank.5.ui.sf.hm$ds~ordrank.5.ui.sf.hm$ord.rank))
s5.ui.sf.hm<-lm5.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[16]],X2=conflict.hm.ui.sf[[17]],Victories=conflict.hm.ui.sf[[18]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut6.ui.sf.hm<-mut6.ui.sf.hm[c(1:90),]
mut6.ui.sf.hm<-transform(mut6.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat6.ui.sf.hm<-inter.mat(mut6.ui.sf.hm)
tri6.ui.sf.hm<-tr.tri(mat6.ui.sf.hm)
dci6.ui.sf.hm<-DCindex(mat6.ui.sf.hm)
mat6.ui.sf.hm[is.na(mat6.ui.sf.hm)] = 0
h6.ui.sf.hm<-h.index(mat6.ui.sf.hm)

ep6.ui.sf.hm<-ep(mut6.ui.sf.hm,a6.ui.sf.hm)
david6.ui.sf.hm<-DS(mat6.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.sf.hm<-cbind(ordrank.6.ui.sf.hm,ds=david6.ui.sf.hm$normDS)
lm6.ui.sf.hm<-summary(lm(ordrank.6.ui.sf.hm$ds~ordrank.6.ui.sf.hm$ord.rank))
s6.ui.sf.hm<-lm6.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[19]],X2=conflict.hm.ui.sf[[20]],Victories=conflict.hm.ui.sf[[21]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut7.ui.sf.hm<-mut7.ui.sf.hm[c(1:90),]
mut7.ui.sf.hm<-transform(mut7.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat7.ui.sf.hm<-inter.mat(mut7.ui.sf.hm)
tri7.ui.sf.hm<-tr.tri(mat7.ui.sf.hm)
dci7.ui.sf.hm<-DCindex(mat7.ui.sf.hm)
mat7.ui.sf.hm[is.na(mat7.ui.sf.hm)] = 0
h7.ui.sf.hm<-h.index(mat7.ui.sf.hm)

ep7.ui.sf.hm<-ep(mut7.ui.sf.hm,a7.ui.sf.hm)
david7.ui.sf.hm<-DS(mat7.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.sf.hm<-cbind(ordrank.7.ui.sf.hm,ds=david7.ui.sf.hm$normDS)
lm7.ui.sf.hm<-summary(lm(ordrank.7.ui.sf.hm$ds~ordrank.7.ui.sf.hm$ord.rank))
s7.ui.sf.hm<-lm7.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[22]],X2=conflict.hm.ui.sf[[23]],Victories=conflict.hm.ui.sf[[24]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut8.ui.sf.hm<-mut8.ui.sf.hm[c(1:90),]
mut8.ui.sf.hm<-transform(mut8.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat8.ui.sf.hm<-inter.mat(mut8.ui.sf.hm)
tri8.ui.sf.hm<-tr.tri(mat8.ui.sf.hm)
dci8.ui.sf.hm<-DCindex(mat8.ui.sf.hm)
mat8.ui.sf.hm[is.na(mat8.ui.sf.hm)] = 0
h8.ui.sf.hm<-h.index(mat8.ui.sf.hm)

ep8.ui.sf.hm<-ep(mut8.ui.sf.hm,a8.ui.sf.hm)
david8.ui.sf.hm<-DS(mat8.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.sf.hm<-cbind(ordrank.8.ui.sf.hm,ds=david8.ui.sf.hm$normDS)
lm8.ui.sf.hm<-summary(lm(ordrank.8.ui.sf.hm$ds~ordrank.8.ui.sf.hm$ord.rank))
s8.ui.sf.hm<-lm8.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[25]],X2=conflict.hm.ui.sf[[26]],Victories=conflict.hm.ui.sf[[27]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut9.ui.sf.hm<-mut9.ui.sf.hm[c(1:90),]
mut9.ui.sf.hm<-transform(mut9.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat9.ui.sf.hm<-inter.mat(mut9.ui.sf.hm)
tri9.ui.sf.hm<-tr.tri(mat9.ui.sf.hm)
dci9.ui.sf.hm<-DCindex(mat9.ui.sf.hm)
mat9.ui.sf.hm[is.na(mat9.ui.sf.hm)] = 0
h9.ui.sf.hm<-h.index(mat9.ui.sf.hm)

ep9.ui.sf.hm<-ep(mut9.ui.sf.hm,a9.ui.sf.hm)
david9.ui.sf.hm<-DS(mat9.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.sf.hm<-cbind(ordrank.9.ui.sf.hm,ds=david9.ui.sf.hm$normDS)
lm9.ui.sf.hm<-summary(lm(ordrank.9.ui.sf.hm$ds~ordrank.9.ui.sf.hm$ord.rank))
s9.ui.sf.hm<-lm9.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.sf.hm<-data.frame(X1=conflict.hm.ui.sf[[28]],X2=conflict.hm.ui.sf[[29]],Victories=conflict.hm.ui.sf[[30]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut10.ui.sf.hm<-mut10.ui.sf.hm[c(1:90),]
mut10.ui.sf.hm<-transform(mut10.ui.sf.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat10.ui.sf.hm<-inter.mat(mut10.ui.sf.hm)
tri10.ui.sf.hm<-tr.tri(mat10.ui.sf.hm)
dci10.ui.sf.hm<-DCindex(mat10.ui.sf.hm)
mat10.ui.sf.hm[is.na(mat10.ui.sf.hm)] = 0
h10.ui.sf.hm<-h.index(mat10.ui.sf.hm)

ep10.ui.sf.hm<-ep(mut10.ui.sf.hm,a10.ui.sf.hm)
david10.ui.sf.hm<-DS(mat10.ui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.ui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.sf.hm<-cbind(ordrank.10.ui.sf.hm,ds=david10.ui.sf.hm$normDS)
lm10.ui.sf.hm<-summary(lm(ordrank.10.ui.sf.hm$ds~ordrank.10.ui.sf.hm$ord.rank))
s10.ui.sf.hm<-lm10.ui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.sf.hm<-sum(mut1.ui.sf.hm$Victories)
int2.ui.sf.hm<-sum(mut2.ui.sf.hm$Victories)
int3.ui.sf.hm<-sum(mut3.ui.sf.hm$Victories)
int4.ui.sf.hm<-sum(mut4.ui.sf.hm$Victories)
int5.ui.sf.hm<-sum(mut5.ui.sf.hm$Victories)
int6.ui.sf.hm<-sum(mut6.ui.sf.hm$Victories)
int7.ui.sf.hm<-sum(mut7.ui.sf.hm$Victories)
int8.ui.sf.hm<-sum(mut8.ui.sf.hm$Victories)
int9.ui.sf.hm<-sum(mut9.ui.sf.hm$Victories)
int10.ui.sf.hm<-sum(mut10.ui.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.ui.sf.hm<-sum(a1.ui.sf.hm$Avoids)
av2.ui.sf.hm<-sum(a2.ui.sf.hm$Avoids)
av3.ui.sf.hm<-sum(a3.ui.sf.hm$Avoids)
av4.ui.sf.hm<-sum(a4.ui.sf.hm$Avoids)
av5.ui.sf.hm<-sum(a5.ui.sf.hm$Avoids)
av6.ui.sf.hm<-sum(a6.ui.sf.hm$Avoids)
av7.ui.sf.hm<-sum(a7.ui.sf.hm$Avoids)
av8.ui.sf.hm<-sum(a8.ui.sf.hm$Avoids)
av9.ui.sf.hm<-sum(a9.ui.sf.hm$Avoids)
av10.ui.sf.hm<-sum(a10.ui.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.iu.sf<-(sum(av1.ui.sf.hm, av2.ui.sf.hm, av3.ui.sf.hm, av4.ui.sf.hm, av5.ui.sf.hm, av6.ui.sf.hm, av7.ui.sf.hm, av8.ui.sf.hm, av9.ui.sf.hm, av10.ui.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.iu.sf<-(sum(int1.ui.sf.hm, int2.ui.sf.hm, int3.ui.sf.hm, int4.ui.sf.hm, int5.ui.sf.hm, int6.ui.sf.hm, int7.ui.sf.hm, int8.ui.sf.hm, int9.ui.sf.hm, int10.ui.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e1.ui.sf.hm<-e1.ui.sf.hm[c(1:10),]
e1.1.ui.sf.hm<-e1.ui.sf.hm[order(e1.ui.sf.hm$ID),]
e1.ui.sf.hm<-as.matrix(t(e1.1.ui.sf.hm))

e2.ui.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e2.ui.sf.hm<-e2.ui.sf.hm[c(1:10),]
e2.1.ui.sf.hm<-e2.ui.sf.hm[order(e2.ui.sf.hm$ID),]
e2.ui.sf.hm<-as.matrix(t(e2.1.ui.sf.hm))

e3.ui.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e3.ui.sf.hm<-e3.ui.sf.hm[c(1:10),]
e3.1.ui.sf.hm<-e3.ui.sf.hm[order(e3.ui.sf.hm$ID),]
e3.ui.sf.hm<-as.matrix(t(e3.1.ui.sf.hm))

e4.ui.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e4.ui.sf.hm<-e4.ui.sf.hm[c(1:10),]
e4.1.ui.sf.hm<-e4.ui.sf.hm[order(e4.ui.sf.hm$ID),]
e4.ui.sf.hm<-as.matrix(t(e4.1.ui.sf.hm))

e5.ui.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e5.ui.sf.hm<-e5.ui.sf.hm[c(1:10),]
e5.1.ui.sf.hm<-e5.ui.sf.hm[order(e5.ui.sf.hm$ID),]
e5.ui.sf.hm<-as.matrix(t(e5.1.ui.sf.hm))

e6.ui.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e6.ui.sf.hm<-e6.ui.sf.hm[c(1:10),]
e6.1.ui.sf.hm<-e6.ui.sf.hm[order(e6.ui.sf.hm$ID),]
e6.ui.sf.hm<-as.matrix(t(e6.1.ui.sf.hm))

e7.ui.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e7.ui.sf.hm<-e7.ui.sf.hm[c(1:10),]
e7.1.ui.sf.hm<-e7.ui.sf.hm[order(e7.ui.sf.hm$ID),]
e7.ui.sf.hm<-as.matrix(t(e7.1.ui.sf.hm))

e8.ui.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e8.ui.sf.hm<-e8.ui.sf.hm[c(1:10),]
e8.1.ui.sf.hm<-e8.ui.sf.hm[order(e8.ui.sf.hm$ID),]
e8.ui.sf.hm<-as.matrix(t(e8.1.ui.sf.hm))

e9.ui.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e9.ui.sf.hm<-e9.ui.sf.hm[c(1:10),]
e9.1.ui.sf.hm<-e9.ui.sf.hm[order(e9.ui.sf.hm$ID),]
e9.ui.sf.hm<-as.matrix(t(e9.1.ui.sf.hm))

e10.ui.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e10.ui.sf.hm<-e10.ui.sf.hm[c(1:10),]
e10.1.ui.sf.hm<-e10.ui.sf.hm[order(e10.ui.sf.hm$ID),]
e10.ui.sf.hm<-as.matrix(t(e10.1.ui.sf.hm))

energy.hm.ui.sf.hm<-as.data.frame(matrix(c(e1.ui.sf.hm,e2.ui.sf.hm,e3.ui.sf.hm,e4.ui.sf.hm,e5.ui.sf.hm,e6.ui.sf.hm,e7.ui.sf.hm,e8.ui.sf.hm,e9.ui.sf.hm,e10.ui.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.ui.sf.hm<-data.frame(ID=energy.hm.ui.sf.hm$V1,energy_over_distance=energy.hm.ui.sf.hm$V2,energy_over_time=energy.hm.ui.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.sf.hm<-david1.ui.sf.hm[order(david1.ui.sf.hm$ID),]
david1.ui.sf.hm<-as.matrix(t(david1.1.ui.sf.hm))

david2.1.ui.sf.hm<-david2.ui.sf.hm[order(david2.ui.sf.hm$ID),]
david2.ui.sf.hm<-as.matrix(t(david2.1.ui.sf.hm))

david3.1.ui.sf.hm<-david3.ui.sf.hm[order(david3.ui.sf.hm$ID),]
david3.ui.sf.hm<-as.matrix(t(david3.1.ui.sf.hm))

david4.1.ui.sf.hm<-david4.ui.sf.hm[order(david4.ui.sf.hm$ID),]
david4.ui.sf.hm<-as.matrix(t(david4.1.ui.sf.hm))

david5.1.ui.sf.hm<-david5.ui.sf.hm[order(david5.ui.sf.hm$ID),]
david5.ui.sf.hm<-as.matrix(t(david5.1.ui.sf.hm))

david6.1.ui.sf.hm<-david6.ui.sf.hm[order(david6.ui.sf.hm$ID),]
david6.ui.sf.hm<-as.matrix(t(david6.1.ui.sf.hm))

david7.1.ui.sf.hm<-david7.ui.sf.hm[order(david7.ui.sf.hm$ID),]
david7.ui.sf.hm<-as.matrix(t(david7.1.ui.sf.hm))

david8.1.ui.sf.hm<-david8.ui.sf.hm[order(david8.ui.sf.hm$ID),]
david8.ui.sf.hm<-as.matrix(t(david8.1.ui.sf.hm))

david9.1.ui.sf.hm<-david9.ui.sf.hm[order(david9.ui.sf.hm$ID),]
david9.ui.sf.hm<-as.matrix(t(david9.1.ui.sf.hm))

david10.1.ui.sf.hm<-david10.ui.sf.hm[order(david10.ui.sf.hm$ID),]
david10.ui.sf.hm<-as.matrix(t(david10.1.ui.sf.hm))

david.hm.ui.sf.hm<-as.data.frame(matrix(c(david1.ui.sf.hm,david2.ui.sf.hm,david3.ui.sf.hm,david4.ui.sf.hm,david5.ui.sf.hm,david6.ui.sf.hm,david7.ui.sf.hm,david8.ui.sf.hm,david9.ui.sf.hm,david10.ui.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.ui.sf.hm<-data.frame(ID=david.hm.ui.sf.hm$V1,DS=david.hm.ui.sf.hm$V2,normDS=david.hm.ui.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.ui.sf.hm<-lm(e1.1.ui.sf.hm$energy_over_time~as.numeric(david1.1.ui.sf.hm$normDS))
hm.lm.1.s.ui.sf.hm<-summary(lm.hm.1.ui.sf.hm)$coefficients
hm.1.slope.ui.sf.hm<-hm.lm.1.s.ui.sf.hm[2,1]
lm.hm.2.ui.sf.hm<-lm(e2.1.ui.sf.hm$energy_over_time~as.numeric(david2.1.ui.sf.hm$normDS))
hm.lm.2.s.ui.sf.hm<-summary(lm.hm.2.ui.sf.hm)$coefficients
hm.2.slope.ui.sf.hm<-hm.lm.2.s.ui.sf.hm[2,1]
lm.hm.3.ui.sf.hm<-lm(e3.1.ui.sf.hm$energy_over_time~as.numeric(david3.1.ui.sf.hm$normDS))
hm.lm.3.s.ui.sf.hm<-summary(lm.hm.3.ui.sf.hm)$coefficients
hm.3.slope.ui.sf.hm<-hm.lm.3.s.ui.sf.hm[2,1]
lm.hm.4.ui.sf.hm<-lm(e4.1.ui.sf.hm$energy_over_time~as.numeric(david4.1.ui.sf.hm$normDS))
hm.lm.4.s.ui.sf.hm<-summary(lm.hm.4.ui.sf.hm)$coefficients
hm.4.slope.ui.sf.hm<-hm.lm.4.s.ui.sf.hm[2,1]
lm.hm.5.ui.sf.hm<-lm(e5.1.ui.sf.hm$energy_over_time~as.numeric(david5.1.ui.sf.hm$normDS))
hm.lm.5.s.ui.sf.hm<-summary(lm.hm.5.ui.sf.hm)$coefficients
hm.5.slope.ui.sf.hm<-hm.lm.5.s.ui.sf.hm[2,1]
lm.hm.6.ui.sf.hm<-lm(e6.1.ui.sf.hm$energy_over_time~as.numeric(david6.1.ui.sf.hm$normDS))
hm.lm.6.s.ui.sf.hm<-summary(lm.hm.6.ui.sf.hm)$coefficients
hm.6.slope.ui.sf.hm<-hm.lm.6.s.ui.sf.hm[2,1]
lm.hm.7.ui.sf.hm<-lm(e7.1.ui.sf.hm$energy_over_time~as.numeric(david7.1.ui.sf.hm$normDS))
hm.lm.7.s.ui.sf.hm<-summary(lm.hm.7.ui.sf.hm)$coefficients
hm.7.slope.ui.sf.hm<-hm.lm.7.s.ui.sf.hm[2,1]
lm.hm.8.ui.sf.hm<-lm(e8.1.ui.sf.hm$energy_over_time~as.numeric(david8.1.ui.sf.hm$normDS))
hm.lm.8.s.ui.sf.hm<-summary(lm.hm.8.ui.sf.hm)$coefficients
hm.8.slope.ui.sf.hm<-hm.lm.8.s.ui.sf.hm[2,1]
lm.hm.9.ui.sf.hm<-lm(e9.1.ui.sf.hm$energy_over_time~as.numeric(david9.1.ui.sf.hm$normDS))
hm.lm.9.s.ui.sf.hm<-summary(lm.hm.9.ui.sf.hm)$coefficients
hm.9.slope.ui.sf.hm<-hm.lm.9.s.ui.sf.hm[2,1]
lm.hm.10.ui.sf.hm<-lm(e10.1.ui.sf.hm$energy_over_time~as.numeric(david10.1.ui.sf.hm$normDS))
hm.lm.10.s.ui.sf.hm<-summary(lm.hm.10.ui.sf.hm)$coefficients
hm.10.slope.ui.sf.hm<-hm.lm.10.s.ui.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.ui.sf.ss<-data.frame(triangle.transitivity=c(tri1.ui.sf.hm,tri2.ui.sf.hm,tri3.ui.sf.hm,tri4.ui.sf.hm,tri5.ui.sf.hm,tri6.ui.sf.hm,tri7.ui.sf.hm,tri8.ui.sf.hm,tri9.ui.sf.hm,tri10.ui.sf.hm),escalation=c(ep1.ui.sf.hm,ep2.ui.sf.hm,ep3.ui.sf.hm,ep4.ui.sf.hm,ep5.ui.sf.hm,ep6.ui.sf.hm,ep7.ui.sf.hm,ep8.ui.sf.hm,ep9.ui.sf.hm,ep10.ui.sf.hm),dci=c(dci1.ui.sf.hm,dci2.ui.sf.hm,dci3.ui.sf.hm,dci4.ui.sf.hm,dci5.ui.sf.hm,dci6.ui.sf.hm,dci7.ui.sf.hm,dci8.ui.sf.hm,dci9.ui.sf.hm,dci10.ui.sf.hm),steepness=c(s1.ui.sf.hm,s2.ui.sf.hm,s3.ui.sf.hm,s4.ui.sf.hm,s5.ui.sf.hm,s6.ui.sf.hm,s7.ui.sf.hm,s8.ui.sf.hm,s9.ui.sf.hm,s10.ui.sf.hm),slope=c(hm.1.slope.ui.sf.hm,hm.2.slope.ui.sf.hm,hm.3.slope.ui.sf.hm,hm.4.slope.ui.sf.hm,hm.5.slope.ui.sf.hm,hm.6.slope.ui.sf.hm,hm.7.slope.ui.sf.hm,hm.8.slope.ui.sf.hm,hm.9.slope.ui.sf.hm,hm.10.slope.ui.sf.hm))


```
```{r Uniform Deterministic Data Frame}
# Generate energy data frame:
total.energy.iu.sf<-data.frame(energy.km.df.ui.sf.km)
total.energy.iu.sf<-rbind(total.energy.iu.sf,energy.hm.df.ui.sf.hm)

total.david.iu.sf<-data.frame(david.km.df.ui.sf.km)
total.david.iu.sf<-rbind(total.david.iu.sf,david.hm.df.ui.sf.hm)

total.energy.iu.sf<-cbind(total.energy.iu.sf,normDS=total.david.iu.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.iu.sf<-mean(km.ui.sf.ss$triangle.transitivity)
  km.iu.sfi.iu.sf<-mean(km.ui.sf.ss$dci)
  km.esc.iu.sf<-mean(km.ui.sf.ss$escalation)
  km.steep.iu.sf<-mean(km.ui.sf.ss$steepness)
  km.slope.iu.sf<-mean(km.ui.sf.ss$slope)
  km.mean.iu.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.iu.sf,dci=km.iu.sfi.iu.sf,esc=km.esc.iu.sf,steepness=km.steep.iu.sf,slope=km.slope.iu.sf,dist="Uniform",calc="deterministic")

  # history mutual
  hm.tt.iu.sf<-mean(hm.ui.sf.ss$triangle.transitivity)
  hm.iu.sfi.iu.sf<-mean(hm.ui.sf.ss$dci)
  hm.esc.iu.sf<-mean(hm.ui.sf.ss$escalation)
  hm.steep.iu.sf<-mean(hm.ui.sf.ss$steepness)
  hm.slope.iu.sf<-mean(hm.ui.sf.ss$slope)
  hm.mean.iu.sf<-data.frame(scenario="History Mutual",tt=hm.tt.iu.sf,dci=hm.iu.sfi.iu.sf,esc=hm.esc.iu.sf,steepness=hm.steep.iu.sf,slope=hm.slope.iu.sf,dist="Uniform",calc="deterministic")

# Data frame of all averages
dc.ave<-rbind(km.mean.iu.sf,hm.mean.iu.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.iu.sf<-mean(km.ui.sf.ss$triangle.transitivity)
  km.iu.sfi.iu.sf<-mean(km.ui.sf.ss$dci)
  km.esc.iu.sf<-mean(km.ui.sf.ss$escalation)
  km.steep.iu.sf<-mean(km.ui.sf.ss$steepness)
  km.slope.iu.sf<-mean(km.ui.sf.ss$slope)
  km.mean.iu.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.iu.sf,dci=km.iu.sfi.iu.sf,esc=km.esc.iu.sf,steepness=km.steep.iu.sf,slope=km.slope.iu.sf,dist="Uniform",calc="deterministic")
  
  #history mutual
  hm.tt.iu.sf<-mean(hm.ui.sf.ss$triangle.transitivity)
  hm.iu.sfi.iu.sf<-mean(hm.ui.sf.ss$dci)
  hm.esc.iu.sf<-mean(hm.ui.sf.ss$escalation)
  hm.steep.iu.sf<-mean(hm.ui.sf.ss$steepness)
  hm.slope.iu.sf<-mean(hm.ui.sf.ss$slope)
  hm.mean.iu.sf<-data.frame(scenario="History Mutual",tt=hm.tt.iu.sf,dci=hm.iu.sfi.iu.sf,esc=hm.esc.iu.sf,steepness=hm.steep.iu.sf,slope=hm.slope.iu.sf,dist="Uniform",calc="deterministic")
  
# Generate data frame for all averages:
dc.ave<-rbind(km.mean.iu.sf,hm.mean.iu.sf)

# Create overall dataframe of summary statistics:
overall.unif.sf.initiator.sf<-data.frame(km.ui.sf.ss)
overall.unif.sf.initiator.sf<-rbind(overall.unif.sf.initiator.sf,hm.ui.sf.ss)

overall.unif.sf.initiator.sf<-cbind(overall.unif.sf.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.unif.sf.initiator.sf<-cbind(overall.unif.sf.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("initiator",20))


rhp.ui.sf.ss<-overall.unif.sf.initiator.sf[overall.unif.sf.initiator.sf$variable=="rhp",]
history.ui.sf.ss<-overall.unif.sf.initiator.sf[overall.unif.sf.initiator.sf$variable=="history",]

overall.unif.sf.initiator.sf$combo<-paste(overall.unif.sf.initiator.sf$strategy,overall.unif.sf.initiator.sf$variable,overall.unif.sf.initiator.sf$distribution)
overall.unif.sf.initiator.sf$combo2<-paste(overall.unif.sf.initiator.sf$strategy,overall.unif.sf.initiator.sf$variable) #final dataframe for deterministic Uniform data
```

## Avoids Uniform Initiator Wins Data
```{r Avoids Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[1]],X2=avoid.ui.sf.km[[2]],Avoids=avoid.ui.sf.km[[3]])
mat1.aui.sf.km<-avoid.inter.mat(mut1.aui.sf.km)
tri1.aui.sf.km<-tr.tri(mat1.aui.sf.km)
dci1.aui.sf.km<-DCindex(mat1.aui.sf.km)
mat1.aui.sf.km[is.na(mat1.aui.sf.km)] = 0
h1.aui.sf.km<-h.index(mat1.aui.sf.km)

ep1.aui.sf.km<-ep(mut1.aui.sf.km,a1.ui.sf.km)
david1.aui.sf.km<-DS(mat1.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.sf.km<-cbind(ordrank.1.aui.sf.km,ds=david1.aui.sf.km$normDS)
lm1.aui.sf.km<-summary(lm(ordrank.1.aui.sf.km$ds~ordrank.1.aui.sf.km$ord.rank))
s1.aui.sf.km<-lm1.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[4]],X2=avoid.ui.sf.km[[5]],Avoids=avoid.ui.sf.km[[6]])
mat2.aui.sf.km<-avoid.inter.mat(mut2.aui.sf.km)
tri2.aui.sf.km<-tr.tri(mat2.aui.sf.km)
dci2.aui.sf.km<-DCindex(mat2.aui.sf.km)
mat2.aui.sf.km[is.na(mat2.aui.sf.km)] = 0
h2.aui.sf.km<-h.index(mat2.aui.sf.km)

ep2.aui.sf.km<-ep(mut2.aui.sf.km,a2.ui.sf.km)
david2.aui.sf.km<-DS(mat2.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.sf.km<-cbind(ordrank.2.aui.sf.km,ds=david2.aui.sf.km$normDS)
lm2.aui.sf.km<-summary(lm(ordrank.2.aui.sf.km$ds~ordrank.2.aui.sf.km$ord.rank))
s2.aui.sf.km<-lm2.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[7]],X2=avoid.ui.sf.km[[8]],Avoids=avoid.ui.sf.km[[9]])
mat3.aui.sf.km<-avoid.inter.mat(mut3.aui.sf.km)
tri3.aui.sf.km<-tr.tri(mat3.aui.sf.km)
dci3.aui.sf.km<-DCindex(mat3.aui.sf.km)
mat3.aui.sf.km[is.na(mat3.aui.sf.km)] = 0
h3.aui.sf.km<-h.index(mat3.aui.sf.km)

ep3.aui.sf.km<-ep(mut3.aui.sf.km,a3.ui.sf.km)
david3.aui.sf.km<-DS(mat3.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.sf.km<-cbind(ordrank.3.aui.sf.km,ds=david3.aui.sf.km$normDS)
lm3.aui.sf.km<-summary(lm(ordrank.3.aui.sf.km$ds~ordrank.3.aui.sf.km$ord.rank))
s3.aui.sf.km<-lm3.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[10]],X2=avoid.ui.sf.km[[11]],Avoids=avoid.ui.sf.km[[12]])
mat4.aui.sf.km<-avoid.inter.mat(mut4.aui.sf.km)
tri4.aui.sf.km<-tr.tri(mat4.aui.sf.km)
dci4.aui.sf.km<-DCindex(mat4.aui.sf.km)
mat4.aui.sf.km[is.na(mat4.aui.sf.km)] = 0
h4.aui.sf.km<-h.index(mat4.aui.sf.km)

ep4.aui.sf.km<-ep(mut4.aui.sf.km,a4.ui.sf.km)
david4.aui.sf.km<-DS(mat4.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.sf.km<-cbind(ordrank.4.aui.sf.km,ds=david4.aui.sf.km$normDS)
lm4.aui.sf.km<-summary(lm(ordrank.4.aui.sf.km$ds~ordrank.4.aui.sf.km$ord.rank))
s4.aui.sf.km<-lm4.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[13]],X2=avoid.ui.sf.km[[14]],Avoids=avoid.ui.sf.km[[15]])
mat5.aui.sf.km<-avoid.inter.mat(mut5.aui.sf.km)
tri5.aui.sf.km<-tr.tri(mat5.aui.sf.km)
dci5.aui.sf.km<-DCindex(mat5.aui.sf.km)
mat5.aui.sf.km[is.na(mat5.aui.sf.km)] = 0
h5.aui.sf.km<-h.index(mat5.aui.sf.km)

ep5.aui.sf.km<-ep(mut5.aui.sf.km,a5.ui.sf.km)
david5.aui.sf.km<-DS(mat5.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.sf.km<-cbind(ordrank.5.aui.sf.km,ds=david5.aui.sf.km$normDS)
lm5.aui.sf.km<-summary(lm(ordrank.5.aui.sf.km$ds~ordrank.5.aui.sf.km$ord.rank))
s5.aui.sf.km<-lm5.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[16]],X2=avoid.ui.sf.km[[17]],Avoids=avoid.ui.sf.km[[18]])
mat6.aui.sf.km<-avoid.inter.mat(mut6.aui.sf.km)
tri6.aui.sf.km<-tr.tri(mat6.aui.sf.km)
dci6.aui.sf.km<-DCindex(mat6.aui.sf.km)
mat6.aui.sf.km[is.na(mat6.aui.sf.km)] = 0
h6.aui.sf.km<-h.index(mat6.aui.sf.km)

ep6.aui.sf.km<-ep(mut6.aui.sf.km,a6.ui.sf.km)
david6.aui.sf.km<-DS(mat6.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.sf.km<-cbind(ordrank.6.aui.sf.km,ds=david6.aui.sf.km$normDS)
lm6.aui.sf.km<-summary(lm(ordrank.6.aui.sf.km$ds~ordrank.6.aui.sf.km$ord.rank))
s6.aui.sf.km<-lm6.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[19]],X2=avoid.ui.sf.km[[20]],Avoids=avoid.ui.sf.km[[21]])
mat7.aui.sf.km<-avoid.inter.mat(mut7.aui.sf.km)
tri7.aui.sf.km<-tr.tri(mat7.aui.sf.km)
dci7.aui.sf.km<-DCindex(mat7.aui.sf.km)
mat7.aui.sf.km[is.na(mat7.aui.sf.km)] = 0
h7.aui.sf.km<-h.index(mat7.aui.sf.km)

ep7.aui.sf.km<-ep(mut7.aui.sf.km,a7.ui.sf.km)
david7.aui.sf.km<-DS(mat7.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.sf.km<-cbind(ordrank.7.aui.sf.km,ds=david7.aui.sf.km$normDS)
lm7.aui.sf.km<-summary(lm(ordrank.7.aui.sf.km$ds~ordrank.7.aui.sf.km$ord.rank))
s7.aui.sf.km<-lm7.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[22]],X2=avoid.ui.sf.km[[23]],Avoids=avoid.ui.sf.km[[24]])
mat8.aui.sf.km<-avoid.inter.mat(mut8.aui.sf.km)
tri8.aui.sf.km<-tr.tri(mat8.aui.sf.km)
dci8.aui.sf.km<-DCindex(mat8.aui.sf.km)
mat8.aui.sf.km[is.na(mat8.aui.sf.km)] = 0
h8.aui.sf.km<-h.index(mat8.aui.sf.km)

ep8.aui.sf.km<-ep(mut8.aui.sf.km,a8.ui.sf.km)
david8.aui.sf.km<-DS(mat8.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.sf.km<-cbind(ordrank.8.aui.sf.km,ds=david8.aui.sf.km$normDS)
lm8.aui.sf.km<-summary(lm(ordrank.8.aui.sf.km$ds~ordrank.8.aui.sf.km$ord.rank))
s8.aui.sf.km<-lm8.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[25]],X2=avoid.ui.sf.km[[26]],Avoids=avoid.ui.sf.km[[27]])
mat9.aui.sf.km<-avoid.inter.mat(mut9.aui.sf.km)
tri9.aui.sf.km<-tr.tri(mat9.aui.sf.km)
dci9.aui.sf.km<-DCindex(mat9.aui.sf.km)
mat9.aui.sf.km[is.na(mat9.aui.sf.km)] = 0
h9.aui.sf.km<-h.index(mat9.aui.sf.km)

ep9.aui.sf.km<-ep(mut9.aui.sf.km,a9.ui.sf.km)
david9.aui.sf.km<-DS(mat9.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.sf.km<-cbind(ordrank.9.aui.sf.km,ds=david9.aui.sf.km$normDS)
lm9.aui.sf.km<-summary(lm(ordrank.9.aui.sf.km$ds~ordrank.9.aui.sf.km$ord.rank))
s9.aui.sf.km<-lm9.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.sf.km<-data.frame(X1=avoid.ui.sf.km[[28]],X2=avoid.ui.sf.km[[29]],Avoids=avoid.ui.sf.km[[30]])
mat10.aui.sf.km<-avoid.inter.mat(mut10.aui.sf.km)
tri10.aui.sf.km<-tr.tri(mat10.aui.sf.km)
dci10.aui.sf.km<-DCindex(mat10.aui.sf.km)
mat10.aui.sf.km[is.na(mat10.aui.sf.km)] = 0
h10.aui.sf.km<-h.index(mat10.aui.sf.km)

ep10.aui.sf.km<-ep(mut10.aui.sf.km,a10.ui.sf.km)
david10.aui.sf.km<-DS(mat10.aui.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.aui.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.sf.km<-cbind(ordrank.10.aui.sf.km,ds=david10.aui.sf.km$normDS)
lm10.aui.sf.km<-summary(lm(ordrank.10.aui.sf.km$ds~ordrank.10.aui.sf.km$ord.rank))
s10.aui.sf.km<-lm10.aui.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.sf.km<-sum(mut1.aui.sf.km$Victories)
int2.aui.sf.km<-sum(mut2.aui.sf.km$Victories)
int3.aui.sf.km<-sum(mut3.aui.sf.km$Victories)
int4.aui.sf.km<-sum(mut4.aui.sf.km$Victories)
int5.aui.sf.km<-sum(mut5.aui.sf.km$Victories)
int6.aui.sf.km<-sum(mut6.aui.sf.km$Victories)
int7.aui.sf.km<-sum(mut7.aui.sf.km$Victories)
int8.aui.sf.km<-sum(mut8.aui.sf.km$Victories)
int9.aui.sf.km<-sum(mut9.aui.sf.km$Victories)
int10.aui.sf.km<-sum(mut10.aui.sf.km$Victories)

  # Summarize the avoidances in each trial:
av1.aui.sf.km<-sum(a1.ui.sf.km$Avoids)
av2.aui.sf.km<-sum(a2.ui.sf.km$Avoids)
av3.aui.sf.km<-sum(a3.ui.sf.km$Avoids)
av4.aui.sf.km<-sum(a4.ui.sf.km$Avoids)
av5.aui.sf.km<-sum(a5.ui.sf.km$Avoids)
av6.aui.sf.km<-sum(a6.ui.sf.km$Avoids)
av7.aui.sf.km<-sum(a7.ui.sf.km$Avoids)
av8.aui.sf.km<-sum(a8.ui.sf.km$Avoids)
av9.aui.sf.km<-sum(a9.ui.sf.km$Avoids)
av10.aui.sf.km<-sum(a10.ui.sf.km$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.km.aiu.sf<-(sum(av1.aui.sf.km, av2.aui.sf.km, av3.aui.sf.km, av4.aui.sf.km, av5.aui.sf.km, av6.aui.sf.km, av7.aui.sf.km, av8.aui.sf.km, av9.aui.sf.km, av10.aui.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.aiu.sf<-(sum(int1.aui.sf.km, int2.aui.sf.km, int3.aui.sf.km, int4.aui.sf.km, int5.aui.sf.km, int6.aui.sf.km, int7.aui.sf.km, int8.aui.sf.km, int9.aui.sf.km, int10.aui.sf.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.sf.km<-e1.aui.sf.km[order(e1.aui.sf.km$ID),]
e1.aui.sf.km<-as.matrix(t(e1.1.aui.sf.km))

e2.aui.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.sf.km<-e2.aui.sf.km[order(e2.aui.sf.km$ID),]
e2.aui.sf.km<-as.matrix(t(e2.1.aui.sf.km))

e3.aui.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.sf.km<-e3.aui.sf.km[order(e3.aui.sf.km$ID),]
e3.aui.sf.km<-as.matrix(t(e3.1.aui.sf.km))

e4.aui.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.sf.km<-e4.aui.sf.km[order(e4.aui.sf.km$ID),]
e4.aui.sf.km<-as.matrix(t(e4.1.aui.sf.km))

e5.aui.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.sf.km<-e5.aui.sf.km[order(e5.aui.sf.km$ID),]
e5.aui.sf.km<-as.matrix(t(e5.1.aui.sf.km))

e6.aui.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.sf.km<-e6.aui.sf.km[order(e6.aui.sf.km$ID),]
e6.aui.sf.km<-as.matrix(t(e6.1.aui.sf.km))

e7.aui.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.sf.km<-e7.aui.sf.km[order(e7.aui.sf.km$ID),]
e7.aui.sf.km<-as.matrix(t(e7.1.aui.sf.km))

e8.aui.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.sf.km<-e8.aui.sf.km[order(e8.aui.sf.km$ID),]
e8.aui.sf.km<-as.matrix(t(e8.1.aui.sf.km))

e9.aui.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.sf.km<-e9.aui.sf.km[order(e9.aui.sf.km$ID),]
e9.aui.sf.km<-as.matrix(t(e9.1.aui.sf.km))

e10.aui.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.sf.km<-e10.aui.sf.km[order(e10.aui.sf.km$ID),]
e10.aui.sf.km<-as.matrix(t(e10.1.aui.sf.km))

energy.km.aui.sf.km<-as.data.frame(matrix(c(e1.aui.sf.km,e2.aui.sf.km,e3.aui.sf.km,e4.aui.sf.km,e5.aui.sf.km,e6.aui.sf.km,e7.aui.sf.km,e8.aui.sf.km,e9.aui.sf.km,e10.aui.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aui.sf.km<-data.frame(ID=energy.km.aui.sf.km$V1,energy_over_distance=energy.km.aui.sf.km$V2,energy_over_time=energy.km.aui.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.sf.km<-david1.aui.sf.km[order(david1.aui.sf.km$ID),]
david1.aui.sf.km<-as.matrix(t(david1.1.aui.sf.km))

david2.1.aui.sf.km<-david2.aui.sf.km[order(david2.aui.sf.km$ID),]
david2.aui.sf.km<-as.matrix(t(david2.1.aui.sf.km))

david3.1.aui.sf.km<-david3.aui.sf.km[order(david3.aui.sf.km$ID),]
david3.aui.sf.km<-as.matrix(t(david3.1.aui.sf.km))

david4.1.aui.sf.km<-david4.aui.sf.km[order(david4.aui.sf.km$ID),]
david4.aui.sf.km<-as.matrix(t(david4.1.aui.sf.km))

david5.1.aui.sf.km<-david5.aui.sf.km[order(david5.aui.sf.km$ID),]
david5.aui.sf.km<-as.matrix(t(david5.1.aui.sf.km))

david6.1.aui.sf.km<-david6.aui.sf.km[order(david6.aui.sf.km$ID),]
david6.aui.sf.km<-as.matrix(t(david6.1.aui.sf.km))

david7.1.aui.sf.km<-david7.aui.sf.km[order(david7.aui.sf.km$ID),]
david7.aui.sf.km<-as.matrix(t(david7.1.aui.sf.km))

david8.1.aui.sf.km<-david8.aui.sf.km[order(david8.aui.sf.km$ID),]
david8.aui.sf.km<-as.matrix(t(david8.1.aui.sf.km))

david9.1.aui.sf.km<-david9.aui.sf.km[order(david9.aui.sf.km$ID),]
david9.aui.sf.km<-as.matrix(t(david9.1.aui.sf.km))

david10.1.aui.sf.km<-david10.aui.sf.km[order(david10.aui.sf.km$ID),]
david10.aui.sf.km<-as.matrix(t(david10.1.aui.sf.km))

david.km.aui.sf.km<-as.data.frame(matrix(c(david1.aui.sf.km,david2.aui.sf.km,david3.aui.sf.km,david4.aui.sf.km,david5.aui.sf.km,david6.aui.sf.km,david7.aui.sf.km,david8.aui.sf.km,david9.aui.sf.km,david10.aui.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aui.sf.km<-data.frame(ID=david.km.aui.sf.km$V1,DS=david.km.aui.sf.km$V2,normDS=david.km.aui.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aui.sf.km<-lm(e1.1.aui.sf.km$energy_over_time~as.numeric(david1.1.aui.sf.km$normDS))
km.lm.1.s.aui.sf.km<-summary(lm.km.1.aui.sf.km)$coefficients
km.1.slope.aui.sf.km<-km.lm.1.s.aui.sf.km[2,1]
lm.km.2.aui.sf.km<-lm(e2.1.aui.sf.km$energy_over_time~as.numeric(david2.1.aui.sf.km$normDS))
km.lm.2.s.aui.sf.km<-summary(lm.km.2.aui.sf.km)$coefficients
km.2.slope.aui.sf.km<-km.lm.2.s.aui.sf.km[2,1]
lm.km.3.aui.sf.km<-lm(e3.1.aui.sf.km$energy_over_time~as.numeric(david3.1.aui.sf.km$normDS))
km.lm.3.s.aui.sf.km<-summary(lm.km.3.aui.sf.km)$coefficients
km.3.slope.aui.sf.km<-km.lm.3.s.aui.sf.km[2,1]
lm.km.4.aui.sf.km<-lm(e4.1.aui.sf.km$energy_over_time~as.numeric(david4.1.aui.sf.km$normDS))
km.lm.4.s.aui.sf.km<-summary(lm.km.4.aui.sf.km)$coefficients
km.4.slope.aui.sf.km<-km.lm.4.s.aui.sf.km[2,1]
lm.km.5.aui.sf.km<-lm(e5.1.aui.sf.km$energy_over_time~as.numeric(david5.1.aui.sf.km$normDS))
km.lm.5.s.aui.sf.km<-summary(lm.km.5.aui.sf.km)$coefficients
km.5.slope.aui.sf.km<-km.lm.5.s.aui.sf.km[2,1]
lm.km.6.aui.sf.km<-lm(e6.1.aui.sf.km$energy_over_time~as.numeric(david6.1.aui.sf.km$normDS))
km.lm.6.s.aui.sf.km<-summary(lm.km.6.aui.sf.km)$coefficients
km.6.slope.aui.sf.km<-km.lm.6.s.aui.sf.km[2,1]
lm.km.7.aui.sf.km<-lm(e7.1.aui.sf.km$energy_over_time~as.numeric(david7.1.aui.sf.km$normDS))
km.lm.7.s.aui.sf.km<-summary(lm.km.7.aui.sf.km)$coefficients
km.7.slope.aui.sf.km<-km.lm.7.s.aui.sf.km[2,1]
lm.km.8.aui.sf.km<-lm(e8.1.aui.sf.km$energy_over_time~as.numeric(david8.1.aui.sf.km$normDS))
km.lm.8.s.aui.sf.km<-summary(lm.km.8.aui.sf.km)$coefficients
km.8.slope.aui.sf.km<-km.lm.8.s.aui.sf.km[2,1]
lm.km.9.aui.sf.km<-lm(e9.1.aui.sf.km$energy_over_time~as.numeric(david9.1.aui.sf.km$normDS))
km.lm.9.s.aui.sf.km<-summary(lm.km.9.aui.sf.km)$coefficients
km.9.slope.aui.sf.km<-km.lm.9.s.aui.sf.km[2,1]
lm.km.10.aui.sf.km<-lm(e10.1.aui.sf.km$energy_over_time~as.numeric(david10.1.aui.sf.km$normDS))
km.lm.10.s.aui.sf.km<-summary(lm.km.10.aui.sf.km)$coefficients
km.10.slope.aui.sf.km<-km.lm.10.s.aui.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aui.sf.ss.avoid.ui.sf.km<-data.frame(triangle.transitivity=c(tri1.aui.sf.km,tri2.aui.sf.km,tri3.aui.sf.km,tri4.aui.sf.km,tri5.aui.sf.km,tri6.aui.sf.km,tri7.aui.sf.km,tri8.aui.sf.km,tri9.aui.sf.km,tri10.aui.sf.km),escalation=c(ep1.aui.sf.km,ep2.aui.sf.km,ep3.aui.sf.km,ep4.aui.sf.km,ep5.aui.sf.km,ep6.aui.sf.km,ep7.aui.sf.km,ep8.aui.sf.km,ep9.aui.sf.km,ep10.aui.sf.km),dci=c(dci1.aui.sf.km,dci2.aui.sf.km,dci3.aui.sf.km,dci4.aui.sf.km,dci5.aui.sf.km,dci6.aui.sf.km,dci7.aui.sf.km,dci8.aui.sf.km,dci9.aui.sf.km,dci10.aui.sf.km),steepness=c(s1.aui.sf.km,s2.aui.sf.km,s3.aui.sf.km,s4.aui.sf.km,s5.aui.sf.km,s6.aui.sf.km,s7.aui.sf.km,s8.aui.sf.km,s9.aui.sf.km,s10.aui.sf.km),slope=c(km.1.slope.aui.sf.km,km.2.slope.aui.sf.km,km.3.slope.aui.sf.km,km.4.slope.aui.sf.km,km.5.slope.aui.sf.km,km.6.slope.aui.sf.km,km.7.slope.aui.sf.km,km.8.slope.aui.sf.km,km.9.slope.aui.sf.km,km.10.slope.aui.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[1]],X2=avoid.ui.sf.hm[[2]],Avoids=avoid.ui.sf.hm[[3]])

mut1.aui.sf.hm<-mut1.aui.sf.hm[c(1:90),]
mut1.aui.sf.hm<-transform(mut1.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat1.aui.sf.hm<-avoid.inter.mat(mut1.aui.sf.hm)
tri1.aui.sf.hm<-tr.tri(mat1.aui.sf.hm)
dci1.aui.sf.hm<-DCindex(mat1.aui.sf.hm)
mat1.aui.sf.hm[is.na(mat1.aui.sf.hm)] = 0
h1.aui.sf.hm<-h.index(mat1.aui.sf.hm)

ep1.aui.sf.hm<-ep(mut1.aui.sf.hm,a1.ui.sf.hm)
david1.aui.sf.hm<-DS(mat1.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.sf.hm<-cbind(ordrank.1.aui.sf.hm,ds=david1.aui.sf.hm$normDS)
lm1.aui.sf.hm<-summary(lm(ordrank.1.aui.sf.hm$ds~ordrank.1.aui.sf.hm$ord.rank))
s1.aui.sf.hm<-lm1.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[4]],X2=avoid.ui.sf.hm[[5]],Avoids=avoid.ui.sf.hm[[6]])

mut2.aui.sf.hm<-mut2.aui.sf.hm[c(1:90),]
mut2.aui.sf.hm<-transform(mut2.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat2.aui.sf.hm<-avoid.inter.mat(mut2.aui.sf.hm)
tri2.aui.sf.hm<-tr.tri(mat2.aui.sf.hm)
dci2.aui.sf.hm<-DCindex(mat2.aui.sf.hm)
mat2.aui.sf.hm[is.na(mat2.aui.sf.hm)] = 0
h2.aui.sf.hm<-h.index(mat2.aui.sf.hm)

ep2.aui.sf.hm<-ep(mut2.aui.sf.hm,a2.ui.sf.hm)
david2.aui.sf.hm<-DS(mat2.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.sf.hm<-cbind(ordrank.2.aui.sf.hm,ds=david2.aui.sf.hm$normDS)
lm2.aui.sf.hm<-summary(lm(ordrank.2.aui.sf.hm$ds~ordrank.2.aui.sf.hm$ord.rank))
s2.aui.sf.hm<-lm2.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[7]],X2=avoid.ui.sf.hm[[8]],Avoids=avoid.ui.sf.hm[[9]])

mut3.aui.sf.hm<-mut3.aui.sf.hm[c(1:90),]
mut3.aui.sf.hm<-transform(mut3.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat3.aui.sf.hm<-avoid.inter.mat(mut3.aui.sf.hm)
tri3.aui.sf.hm<-tr.tri(mat3.aui.sf.hm)
dci3.aui.sf.hm<-DCindex(mat3.aui.sf.hm)
mat3.aui.sf.hm[is.na(mat3.aui.sf.hm)] = 0
h3.aui.sf.hm<-h.index(mat3.aui.sf.hm)

ep3.aui.sf.hm<-ep(mut3.aui.sf.hm,a3.ui.sf.hm)
david3.aui.sf.hm<-DS(mat3.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.sf.hm<-cbind(ordrank.3.aui.sf.hm,ds=david3.aui.sf.hm$normDS)
lm3.aui.sf.hm<-summary(lm(ordrank.3.aui.sf.hm$ds~ordrank.3.aui.sf.hm$ord.rank))
s3.aui.sf.hm<-lm3.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[10]],X2=avoid.ui.sf.hm[[11]],Avoids=avoid.ui.sf.hm[[12]])

mut4.aui.sf.hm<-mut4.aui.sf.hm[c(1:90),]
mut4.aui.sf.hm<-transform(mut4.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat4.aui.sf.hm<-avoid.inter.mat(mut4.aui.sf.hm)
tri4.aui.sf.hm<-tr.tri(mat4.aui.sf.hm)
dci4.aui.sf.hm<-DCindex(mat4.aui.sf.hm)
mat4.aui.sf.hm[is.na(mat4.aui.sf.hm)] = 0
h4.aui.sf.hm<-h.index(mat4.aui.sf.hm)

ep4.aui.sf.hm<-ep(mut4.aui.sf.hm,a4.ui.sf.hm)
david4.aui.sf.hm<-DS(mat4.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.sf.hm<-cbind(ordrank.4.aui.sf.hm,ds=david4.aui.sf.hm$normDS)
lm4.aui.sf.hm<-summary(lm(ordrank.4.aui.sf.hm$ds~ordrank.4.aui.sf.hm$ord.rank))
s4.aui.sf.hm<-lm4.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[13]],X2=avoid.ui.sf.hm[[14]],Avoids=avoid.ui.sf.hm[[15]])

mut5.aui.sf.hm<-mut5.aui.sf.hm[c(1:90),]
mut5.aui.sf.hm<-transform(mut5.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat5.aui.sf.hm<-avoid.inter.mat(mut5.aui.sf.hm)
tri5.aui.sf.hm<-tr.tri(mat5.aui.sf.hm)
dci5.aui.sf.hm<-DCindex(mat5.aui.sf.hm)
mat5.aui.sf.hm[is.na(mat5.aui.sf.hm)] = 0
h5.aui.sf.hm<-h.index(mat5.aui.sf.hm)

ep5.aui.sf.hm<-ep(mut5.aui.sf.hm,a5.ui.sf.hm)
david5.aui.sf.hm<-DS(mat5.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.sf.hm<-cbind(ordrank.5.aui.sf.hm,ds=david5.aui.sf.hm$normDS)
lm5.aui.sf.hm<-summary(lm(ordrank.5.aui.sf.hm$ds~ordrank.5.aui.sf.hm$ord.rank))
s5.aui.sf.hm<-lm5.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[16]],X2=avoid.ui.sf.hm[[17]],Avoids=avoid.ui.sf.hm[[18]])

mut6.aui.sf.hm<-mut6.aui.sf.hm[c(1:90),]
mut6.aui.sf.hm<-transform(mut6.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat6.aui.sf.hm<-avoid.inter.mat(mut6.aui.sf.hm)
tri6.aui.sf.hm<-tr.tri(mat6.aui.sf.hm)
dci6.aui.sf.hm<-DCindex(mat6.aui.sf.hm)
mat6.aui.sf.hm[is.na(mat6.aui.sf.hm)] = 0
h6.aui.sf.hm<-h.index(mat6.aui.sf.hm)

ep6.aui.sf.hm<-ep(mut6.aui.sf.hm,a6.ui.sf.hm)
david6.aui.sf.hm<-DS(mat6.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.sf.hm<-cbind(ordrank.6.aui.sf.hm,ds=david6.aui.sf.hm$normDS)
lm6.aui.sf.hm<-summary(lm(ordrank.6.aui.sf.hm$ds~ordrank.6.aui.sf.hm$ord.rank))
s6.aui.sf.hm<-lm6.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[19]],X2=avoid.ui.sf.hm[[20]],Avoids=avoid.ui.sf.hm[[21]])

mut7.aui.sf.hm<-mut7.aui.sf.hm[c(1:90),]
mut7.aui.sf.hm<-transform(mut7.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat7.aui.sf.hm<-avoid.inter.mat(mut7.aui.sf.hm)
tri7.aui.sf.hm<-tr.tri(mat7.aui.sf.hm)
dci7.aui.sf.hm<-DCindex(mat7.aui.sf.hm)
mat7.aui.sf.hm[is.na(mat7.aui.sf.hm)] = 0
h7.aui.sf.hm<-h.index(mat7.aui.sf.hm)

ep7.aui.sf.hm<-ep(mut7.aui.sf.hm,a7.ui.sf.hm)
david7.aui.sf.hm<-DS(mat7.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.sf.hm<-cbind(ordrank.7.aui.sf.hm,ds=david7.aui.sf.hm$normDS)
lm7.aui.sf.hm<-summary(lm(ordrank.7.aui.sf.hm$ds~ordrank.7.aui.sf.hm$ord.rank))
s7.aui.sf.hm<-lm7.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[22]],X2=avoid.ui.sf.hm[[23]],Avoids=avoid.ui.sf.hm[[24]])

mut8.aui.sf.hm<-mut8.aui.sf.hm[c(1:90),]
mut8.aui.sf.hm<-transform(mut8.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat8.aui.sf.hm<-avoid.inter.mat(mut8.aui.sf.hm)
tri8.aui.sf.hm<-tr.tri(mat8.aui.sf.hm)
dci8.aui.sf.hm<-DCindex(mat8.aui.sf.hm)
mat8.aui.sf.hm[is.na(mat8.aui.sf.hm)] = 0
h8.aui.sf.hm<-h.index(mat8.aui.sf.hm)

ep8.aui.sf.hm<-ep(mut8.aui.sf.hm,a8.ui.sf.hm)
david8.aui.sf.hm<-DS(mat8.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.sf.hm<-cbind(ordrank.8.aui.sf.hm,ds=david8.aui.sf.hm$normDS)
lm8.aui.sf.hm<-summary(lm(ordrank.8.aui.sf.hm$ds~ordrank.8.aui.sf.hm$ord.rank))
s8.aui.sf.hm<-lm8.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[25]],X2=avoid.ui.sf.hm[[26]],Avoids=avoid.ui.sf.hm[[27]])

mut9.aui.sf.hm<-mut9.aui.sf.hm[c(1:90),]
mut9.aui.sf.hm<-transform(mut9.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat9.aui.sf.hm<-avoid.inter.mat(mut9.aui.sf.hm)
tri9.aui.sf.hm<-tr.tri(mat9.aui.sf.hm)
dci9.aui.sf.hm<-DCindex(mat9.aui.sf.hm)
mat9.aui.sf.hm[is.na(mat9.aui.sf.hm)] = 0
h9.aui.sf.hm<-h.index(mat9.aui.sf.hm)

ep9.aui.sf.hm<-ep(mut9.aui.sf.hm,a9.ui.sf.hm)
david9.aui.sf.hm<-DS(mat9.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.sf.hm<-cbind(ordrank.9.aui.sf.hm,ds=david9.aui.sf.hm$normDS)
lm9.aui.sf.hm<-summary(lm(ordrank.9.aui.sf.hm$ds~ordrank.9.aui.sf.hm$ord.rank))
s9.aui.sf.hm<-lm9.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.sf.hm<-data.frame(X1=avoid.ui.sf.hm[[28]],X2=avoid.ui.sf.hm[[29]],Avoids=avoid.ui.sf.hm[[30]])

mut10.aui.sf.hm<-mut10.aui.sf.hm[c(1:90),]
mut10.aui.sf.hm<-transform(mut10.aui.sf.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat10.aui.sf.hm<-avoid.inter.mat(mut10.aui.sf.hm)
tri10.aui.sf.hm<-tr.tri(mat10.aui.sf.hm)
dci10.aui.sf.hm<-DCindex(mat10.aui.sf.hm)
mat10.aui.sf.hm[is.na(mat10.aui.sf.hm)] = 0
h10.aui.sf.hm<-h.index(mat10.aui.sf.hm)

ep10.aui.sf.hm<-ep(mut10.aui.sf.hm,a10.ui.sf.hm)
david10.aui.sf.hm<-DS(mat10.aui.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.aui.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.sf.hm<-cbind(ordrank.10.aui.sf.hm,ds=david10.aui.sf.hm$normDS)
lm10.aui.sf.hm<-summary(lm(ordrank.10.aui.sf.hm$ds~ordrank.10.aui.sf.hm$ord.rank))
s10.aui.sf.hm<-lm10.aui.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.sf.hm<-sum(mut1.aui.sf.hm$Victories)
int2.aui.sf.hm<-sum(mut2.aui.sf.hm$Victories)
int3.aui.sf.hm<-sum(mut3.aui.sf.hm$Victories)
int4.aui.sf.hm<-sum(mut4.aui.sf.hm$Victories)
int5.aui.sf.hm<-sum(mut5.aui.sf.hm$Victories)
int6.aui.sf.hm<-sum(mut6.aui.sf.hm$Victories)
int7.aui.sf.hm<-sum(mut7.aui.sf.hm$Victories)
int8.aui.sf.hm<-sum(mut8.aui.sf.hm$Victories)
int9.aui.sf.hm<-sum(mut9.aui.sf.hm$Victories)
int10.aui.sf.hm<-sum(mut10.aui.sf.hm$Victories)

  # Summarize the avoidances in each trial:
av1.aui.sf.hm<-sum(a1.ui.sf.hm$Avoids)
av2.aui.sf.hm<-sum(a2.ui.sf.hm$Avoids)
av3.aui.sf.hm<-sum(a3.ui.sf.hm$Avoids)
av4.aui.sf.hm<-sum(a4.ui.sf.hm$Avoids)
av5.aui.sf.hm<-sum(a5.ui.sf.hm$Avoids)
av6.aui.sf.hm<-sum(a6.ui.sf.hm$Avoids)
av7.aui.sf.hm<-sum(a7.ui.sf.hm$Avoids)
av8.aui.sf.hm<-sum(a8.ui.sf.hm$Avoids)
av9.aui.sf.hm<-sum(a9.ui.sf.hm$Avoids)
av10.aui.sf.hm<-sum(a10.ui.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.aiu.sf<-(sum(av1.aui.sf.hm, av2.aui.sf.hm, av3.aui.sf.hm, av4.aui.sf.hm, av5.aui.sf.hm, av6.aui.sf.hm, av7.aui.sf.hm, av8.aui.sf.hm, av9.aui.sf.hm, av10.aui.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.aiu.sf<-(sum(int1.aui.sf.hm, int2.aui.sf.hm, int3.aui.sf.hm, int4.aui.sf.hm, int5.aui.sf.hm, int6.aui.sf.hm, int7.aui.sf.hm, int8.aui.sf.hm, int9.aui.sf.hm, int10.aui.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.aui.sf.hm<-e1.aui.sf.hm[c(1:10),]
e1.aui.sf.hm<-transform(e1.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e1.1.aui.sf.hm<-e1.aui.sf.hm[order(e1.aui.sf.hm$ID),]
e1.aui.sf.hm<-as.matrix(t(e1.1.aui.sf.hm))

e2.aui.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.aui.sf.hm<-e2.aui.sf.hm[c(1:10),]
e2.aui.sf.hm<-transform(e2.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e2.1.aui.sf.hm<-e2.aui.sf.hm[order(e2.aui.sf.hm$ID),]
e2.aui.sf.hm<-as.matrix(t(e2.1.aui.sf.hm))

e3.aui.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.aui.sf.hm<-e3.aui.sf.hm[c(1:10),]
e3.aui.sf.hm<-transform(e3.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e3.1.aui.sf.hm<-e3.aui.sf.hm[order(e3.aui.sf.hm$ID),]
e3.aui.sf.hm<-as.matrix(t(e3.1.aui.sf.hm))

e4.aui.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.aui.sf.hm<-e4.aui.sf.hm[c(1:10),]
e4.aui.sf.hm<-transform(e4.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e4.1.aui.sf.hm<-e4.aui.sf.hm[order(e4.aui.sf.hm$ID),]
e4.aui.sf.hm<-as.matrix(t(e4.1.aui.sf.hm))

e5.aui.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.aui.sf.hm<-e5.aui.sf.hm[c(1:10),]
e5.aui.sf.hm<-transform(e5.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e5.1.aui.sf.hm<-e5.aui.sf.hm[order(e5.aui.sf.hm$ID),]
e5.aui.sf.hm<-as.matrix(t(e5.1.aui.sf.hm))

e6.aui.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.aui.sf.hm<-e6.aui.sf.hm[c(1:10),]
e6.aui.sf.hm<-transform(e6.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e6.1.aui.sf.hm<-e6.aui.sf.hm[order(e6.aui.sf.hm$ID),]
e6.aui.sf.hm<-as.matrix(t(e6.1.aui.sf.hm))

e7.aui.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.aui.sf.hm<-e7.aui.sf.hm[c(1:10),]
e7.aui.sf.hm<-transform(e7.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e7.1.aui.sf.hm<-e7.aui.sf.hm[order(e7.aui.sf.hm$ID),]
e7.aui.sf.hm<-as.matrix(t(e7.1.aui.sf.hm))

e8.aui.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.aui.sf.hm<-e8.aui.sf.hm[c(1:10),]
e8.aui.sf.hm<-transform(e8.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e8.1.aui.sf.hm<-e8.aui.sf.hm[order(e8.aui.sf.hm$ID),]
e8.aui.sf.hm<-as.matrix(t(e8.1.aui.sf.hm))

e9.aui.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.aui.sf.hm<-e9.aui.sf.hm[c(1:10),]
e9.aui.sf.hm<-transform(e9.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e9.1.aui.sf.hm<-e9.aui.sf.hm[order(e9.aui.sf.hm$ID),]
e9.aui.sf.hm<-as.matrix(t(e9.1.aui.sf.hm))

e10.aui.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.aui.sf.hm<-e10.aui.sf.hm[c(1:10),]
e10.aui.sf.hm<-transform(e10.aui.sf.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e10.1.aui.sf.hm<-e10.aui.sf.hm[order(e10.aui.sf.hm$ID),]
e10.aui.sf.hm<-as.matrix(t(e10.1.aui.sf.hm))

energy.hm.aui.sf.hm<-as.data.frame(matrix(c(e1.aui.sf.hm,e2.aui.sf.hm,e3.aui.sf.hm,e4.aui.sf.hm,e5.aui.sf.hm,e6.aui.sf.hm,e7.aui.sf.hm,e8.aui.sf.hm,e9.aui.sf.hm,e10.aui.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aui.sf.hm<-data.frame(ID=energy.hm.aui.sf.hm$V1,energy_over_distance=energy.hm.aui.sf.hm$V2,energy_over_time=energy.hm.aui.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.sf.hm<-david1.aui.sf.hm[order(david1.aui.sf.hm$ID),]
david1.aui.sf.hm<-as.matrix(t(david1.1.aui.sf.hm))

david2.1.aui.sf.hm<-david2.aui.sf.hm[order(david2.aui.sf.hm$ID),]
david2.aui.sf.hm<-as.matrix(t(david2.1.aui.sf.hm))

david3.1.aui.sf.hm<-david3.aui.sf.hm[order(david3.aui.sf.hm$ID),]
david3.aui.sf.hm<-as.matrix(t(david3.1.aui.sf.hm))

david4.1.aui.sf.hm<-david4.aui.sf.hm[order(david4.aui.sf.hm$ID),]
david4.aui.sf.hm<-as.matrix(t(david4.1.aui.sf.hm))

david5.1.aui.sf.hm<-david5.aui.sf.hm[order(david5.aui.sf.hm$ID),]
david5.aui.sf.hm<-as.matrix(t(david5.1.aui.sf.hm))

david6.1.aui.sf.hm<-david6.aui.sf.hm[order(david6.aui.sf.hm$ID),]
david6.aui.sf.hm<-as.matrix(t(david6.1.aui.sf.hm))

david7.1.aui.sf.hm<-david7.aui.sf.hm[order(david7.aui.sf.hm$ID),]
david7.aui.sf.hm<-as.matrix(t(david7.1.aui.sf.hm))

david8.1.aui.sf.hm<-david8.aui.sf.hm[order(david8.aui.sf.hm$ID),]
david8.aui.sf.hm<-as.matrix(t(david8.1.aui.sf.hm))

david9.1.aui.sf.hm<-david9.aui.sf.hm[order(david9.aui.sf.hm$ID),]
david9.aui.sf.hm<-as.matrix(t(david9.1.aui.sf.hm))

david10.1.aui.sf.hm<-david10.aui.sf.hm[order(david10.aui.sf.hm$ID),]
david10.aui.sf.hm<-as.matrix(t(david10.1.aui.sf.hm))

david.hm.aui.sf.hm<-as.data.frame(matrix(c(david1.aui.sf.hm,david2.aui.sf.hm,david3.aui.sf.hm,david4.aui.sf.hm,david5.aui.sf.hm,david6.aui.sf.hm,david7.aui.sf.hm,david8.aui.sf.hm,david9.aui.sf.hm,david10.aui.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aui.sf.hm<-data.frame(ID=david.hm.aui.sf.hm$V1,DS=david.hm.aui.sf.hm$V2,normDS=david.hm.aui.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aui.sf.hm<-lm(e1.1.aui.sf.hm$energy_over_time~as.numeric(david1.1.aui.sf.hm$normDS))
hm.lm.1.s.aui.sf.hm<-summary(lm.hm.1.aui.sf.hm)$coefficients
hm.1.slope.aui.sf.hm<-hm.lm.1.s.aui.sf.hm[2,1]
lm.hm.2.aui.sf.hm<-lm(e2.1.aui.sf.hm$energy_over_time~as.numeric(david2.1.aui.sf.hm$normDS))
hm.lm.2.s.aui.sf.hm<-summary(lm.hm.2.aui.sf.hm)$coefficients
hm.2.slope.aui.sf.hm<-hm.lm.2.s.aui.sf.hm[2,1]
lm.hm.3.aui.sf.hm<-lm(e3.1.aui.sf.hm$energy_over_time~as.numeric(david3.1.aui.sf.hm$normDS))
hm.lm.3.s.aui.sf.hm<-summary(lm.hm.3.aui.sf.hm)$coefficients
hm.3.slope.aui.sf.hm<-hm.lm.3.s.aui.sf.hm[2,1]
lm.hm.4.aui.sf.hm<-lm(e4.1.aui.sf.hm$energy_over_time~as.numeric(david4.1.aui.sf.hm$normDS))
hm.lm.4.s.aui.sf.hm<-summary(lm.hm.4.aui.sf.hm)$coefficients
hm.4.slope.aui.sf.hm<-hm.lm.4.s.aui.sf.hm[2,1]
lm.hm.5.aui.sf.hm<-lm(e5.1.aui.sf.hm$energy_over_time~as.numeric(david5.1.aui.sf.hm$normDS))
hm.lm.5.s.aui.sf.hm<-summary(lm.hm.5.aui.sf.hm)$coefficients
hm.5.slope.aui.sf.hm<-hm.lm.5.s.aui.sf.hm[2,1]
lm.hm.6.aui.sf.hm<-lm(e6.1.aui.sf.hm$energy_over_time~as.numeric(david6.1.aui.sf.hm$normDS))
hm.lm.6.s.aui.sf.hm<-summary(lm.hm.6.aui.sf.hm)$coefficients
hm.6.slope.aui.sf.hm<-hm.lm.6.s.aui.sf.hm[2,1]
lm.hm.7.aui.sf.hm<-lm(e7.1.aui.sf.hm$energy_over_time~as.numeric(david7.1.aui.sf.hm$normDS))
hm.lm.7.s.aui.sf.hm<-summary(lm.hm.7.aui.sf.hm)$coefficients
hm.7.slope.aui.sf.hm<-hm.lm.7.s.aui.sf.hm[2,1]
lm.hm.8.aui.sf.hm<-lm(e8.1.aui.sf.hm$energy_over_time~as.numeric(david8.1.aui.sf.hm$normDS))
hm.lm.8.s.aui.sf.hm<-summary(lm.hm.8.aui.sf.hm)$coefficients
hm.8.slope.aui.sf.hm<-hm.lm.8.s.aui.sf.hm[2,1]
lm.hm.9.aui.sf.hm<-lm(e9.1.aui.sf.hm$energy_over_time~as.numeric(david9.1.aui.sf.hm$normDS))
hm.lm.9.s.aui.sf.hm<-summary(lm.hm.9.aui.sf.hm)$coefficients
hm.9.slope.aui.sf.hm<-hm.lm.9.s.aui.sf.hm[2,1]
lm.hm.10.aui.sf.hm<-lm(e10.1.aui.sf.hm$energy_over_time~as.numeric(david10.1.aui.sf.hm$normDS))
hm.lm.10.s.aui.sf.hm<-summary(lm.hm.10.aui.sf.hm)$coefficients
hm.10.slope.aui.sf.hm<-hm.lm.10.s.aui.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aui.sf.ss.avoid.ui.sf.hm<-data.frame(triangle.transitivity=c(tri1.aui.sf.hm,tri2.aui.sf.hm,tri3.aui.sf.hm,tri4.aui.sf.hm,tri5.aui.sf.hm,tri6.aui.sf.hm,tri7.aui.sf.hm,tri8.aui.sf.hm,tri9.aui.sf.hm,tri10.aui.sf.hm),escalation=c(ep1.aui.sf.hm,ep2.aui.sf.hm,ep3.aui.sf.hm,ep4.aui.sf.hm,ep5.aui.sf.hm,ep6.aui.sf.hm,ep7.aui.sf.hm,ep8.aui.sf.hm,ep9.aui.sf.hm,ep10.aui.sf.hm),dci=c(dci1.aui.sf.hm,dci2.aui.sf.hm,dci3.aui.sf.hm,dci4.aui.sf.hm,dci5.aui.sf.hm,dci6.aui.sf.hm,dci7.aui.sf.hm,dci8.aui.sf.hm,dci9.aui.sf.hm,dci10.aui.sf.hm),steepness=c(s1.aui.sf.hm,s2.aui.sf.hm,s3.aui.sf.hm,s4.aui.sf.hm,s5.aui.sf.hm,s6.aui.sf.hm,s7.aui.sf.hm,s8.aui.sf.hm,s9.aui.sf.hm,s10.aui.sf.hm),slope=c(hm.1.slope.aui.sf.hm,hm.2.slope.aui.sf.hm,hm.3.slope.aui.sf.hm,hm.4.slope.aui.sf.hm,hm.5.slope.aui.sf.hm,hm.6.slope.aui.sf.hm,hm.7.slope.aui.sf.hm,hm.8.slope.aui.sf.hm,hm.9.slope.aui.sf.hm,hm.10.slope.aui.sf.hm))


```
```{r Avoids Uniform Deterministic Data Frame}
#knowledge mutual
km.tt.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$triangle.transitivity)
km.aiu.sfi.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$dci)
km.esc.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$escalation)
km.steep.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$steepness)
km.slope.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$slope)
km.mean.aiu.sf.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aiu.sf.avoid,dci=km.aiu.sfi.aiu.sf.avoid,esc=km.esc.aiu.sf.avoid,steepness=km.steep.aiu.sf.avoid,slope=km.slope.aiu.sf.avoid,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$triangle.transitivity)
hm.aiu.sfi.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$dci)
hm.esc.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$escalation)
hm.steep.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$steepness)
hm.slope.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$slope)
hm.mean.aiu.sf.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aiu.sf.avoid,dci=hm.aiu.sfi.aiu.sf.avoid,esc=hm.esc.aiu.sf.avoid,steepness=hm.steep.aiu.sf.avoid,slope=hm.slope.aiu.sf.avoid,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.aiu.sf.avoid,hm.mean.aiu.sf.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$triangle.transitivity)
km.aiu.sfi.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$dci)
km.esc.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$escalation)
km.steep.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$steepness)
km.slope.aiu.sf.avoid<-mean(km.aui.sf.ss.avoid.ui.sf.km$slope)
km.mean.aiu.sf.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aiu.sf.avoid,dci=km.aiu.sfi.aiu.sf.avoid,esc=km.esc.aiu.sf.avoid,steepness=km.steep.aiu.sf.avoid,slope=km.slope.aiu.sf.avoid,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$triangle.transitivity)
hm.aiu.sfi.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$dci)
hm.esc.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$escalation)
hm.steep.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$steepness)
hm.slope.aiu.sf.avoid<-mean(hm.aui.sf.ss.avoid.ui.sf.hm$slope)
hm.mean.aiu.sf.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aiu.sf.avoid,dci=hm.aiu.sfi.aiu.sf.avoid,esc=hm.esc.aiu.sf.avoid,steepness=hm.steep.aiu.sf.avoid,slope=hm.slope.aiu.sf.avoid,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.aiu.sf.avoid,hm.mean.aiu.sf.avoid)

#create overall dataframe of summary statistics
overall.unif.sf.avoid.initiator.sf<-data.frame(km.aui.sf.ss.avoid.ui.sf.km)
overall.unif.sf.avoid.initiator.sf<-rbind(overall.unif.sf.avoid.initiator.sf,hm.aui.sf.ss.avoid.ui.sf.hm)

overall.unif.sf.avoid.initiator.sf<-cbind(overall.unif.sf.avoid.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.unif.sf.avoid.initiator.sf<-cbind(overall.unif.sf.avoid.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("initiator",20))


rhp.ss.avoid.ui.sf<-overall.unif.sf.avoid.initiator.sf[overall.unif.sf.avoid.initiator.sf$variable=="rhp",]
history.ss.avoid.ui.sf<-overall.unif.sf.avoid.initiator.sf[overall.unif.sf.avoid.initiator.sf$variable=="history",]

overall.unif.sf.avoid.initiator.sf$combo<-paste(overall.unif.sf.avoid.initiator.sf$strategy,overall.unif.sf.avoid.initiator.sf$variable,overall.unif.sf.avoid.initiator.sf$distribution)
overall.unif.sf.avoid.initiator.sf$combo2<-paste(overall.unif.sf.avoid.initiator.sf$strategy,overall.unif.sf.avoid.initiator.sf$variable)
```

## Attacks Uniform Initiator Wins Data
```{r Attacks Uniform Deterministic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.km<-sapply(files, read.csv)

# Generate attacks.atui.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atui.km<-data.frame(X1=attacks.atui.km[[1]],X2=attacks.atui.km[[2]],Victories=attacks.atui.km[[3]])
mat1.atui.km<-inter.mat(mut1.atui.km)
tri1.atui.km<-tr.tri(mat1.atui.km)
dci1.atui.km<-DCindex(mat1.atui.km)
mat1.atui.km[is.na(mat1.atui.km)] = 0
h1.atui.km<-h.index(mat1.atui.km)

ep1.atui.km<-ep(mut1.atui.km,a1.ui.sf.km)
david1.atui.km<-DS(mat1.atui.km) #David's Scores - for steepness use normDS output
ordrank.1.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.km<-cbind(ordrank.1.atui.km,ds=david1.atui.km$normDS)
lm1.atui.km<-summary(lm(ordrank.1.atui.km$ds~ordrank.1.atui.km$ord.rank))
s1.atui.km<-lm1.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.km<-data.frame(X1=attacks.atui.km[[4]],X2=attacks.atui.km[[5]],Victories=attacks.atui.km[[6]])
mat2.atui.km<-inter.mat(mut2.atui.km)
tri2.atui.km<-tr.tri(mat2.atui.km)
dci2.atui.km<-DCindex(mat2.atui.km)
mat2.atui.km[is.na(mat2.atui.km)] = 0
h2.atui.km<-h.index(mat2.atui.km)

ep2.atui.km<-ep(mut2.atui.km,a2.ui.sf.km)
david2.atui.km<-DS(mat2.atui.km) #David's Scores - for steepness use normDS output
ordrank.2.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.km<-cbind(ordrank.2.atui.km,ds=david2.atui.km$normDS)
lm2.atui.km<-summary(lm(ordrank.2.atui.km$ds~ordrank.2.atui.km$ord.rank))
s2.atui.km<-lm2.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.km<-data.frame(X1=attacks.atui.km[[7]],X2=attacks.atui.km[[8]],Victories=attacks.atui.km[[9]])
mat3.atui.km<-inter.mat(mut3.atui.km)
tri3.atui.km<-tr.tri(mat3.atui.km)
dci3.atui.km<-DCindex(mat3.atui.km)
mat3.atui.km[is.na(mat3.atui.km)] = 0
h3.atui.km<-h.index(mat3.atui.km)

ep3.atui.km<-ep(mut3.atui.km,a3.ui.sf.km)
david3.atui.km<-DS(mat3.atui.km) #David's Scores - for steepness use normDS output
ordrank.3.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.km<-cbind(ordrank.3.atui.km,ds=david3.atui.km$normDS)
lm3.atui.km<-summary(lm(ordrank.3.atui.km$ds~ordrank.3.atui.km$ord.rank))
s3.atui.km<-lm3.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.km<-data.frame(X1=attacks.atui.km[[10]],X2=attacks.atui.km[[11]],Victories=attacks.atui.km[[12]])
mat4.atui.km<-inter.mat(mut4.atui.km)
tri4.atui.km<-tr.tri(mat4.atui.km)
dci4.atui.km<-DCindex(mat4.atui.km)
mat4.atui.km[is.na(mat4.atui.km)] = 0
h4.atui.km<-h.index(mat4.atui.km)

ep4.atui.km<-ep(mut4.atui.km,a4.ui.sf.km)
david4.atui.km<-DS(mat4.atui.km) #David's Scores - for steepness use normDS output
ordrank.4.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.km<-cbind(ordrank.4.atui.km,ds=david4.atui.km$normDS)
lm4.atui.km<-summary(lm(ordrank.4.atui.km$ds~ordrank.4.atui.km$ord.rank))
s4.atui.km<-lm4.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.km<-data.frame(X1=attacks.atui.km[[13]],X2=attacks.atui.km[[14]],Victories=attacks.atui.km[[15]])
mat5.atui.km<-inter.mat(mut5.atui.km)
tri5.atui.km<-tr.tri(mat5.atui.km)
dci5.atui.km<-DCindex(mat5.atui.km)
mat5.atui.km[is.na(mat5.atui.km)] = 0
h5.atui.km<-h.index(mat5.atui.km)

ep5.atui.km<-ep(mut5.atui.km,a5.ui.sf.km)
david5.atui.km<-DS(mat5.atui.km) #David's Scores - for steepness use normDS output
ordrank.5.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.km<-cbind(ordrank.5.atui.km,ds=david5.atui.km$normDS)
lm5.atui.km<-summary(lm(ordrank.5.atui.km$ds~ordrank.5.atui.km$ord.rank))
s5.atui.km<-lm5.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.km<-data.frame(X1=attacks.atui.km[[16]],X2=attacks.atui.km[[17]],Victories=attacks.atui.km[[18]])
mat6.atui.km<-inter.mat(mut6.atui.km)
tri6.atui.km<-tr.tri(mat6.atui.km)
dci6.atui.km<-DCindex(mat6.atui.km)
mat6.atui.km[is.na(mat6.atui.km)] = 0
h6.atui.km<-h.index(mat6.atui.km)

ep6.atui.km<-ep(mut6.atui.km,a6.ui.sf.km)
david6.atui.km<-DS(mat6.atui.km) #David's Scores - for steepness use normDS output
ordrank.6.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.km<-cbind(ordrank.6.atui.km,ds=david6.atui.km$normDS)
lm6.atui.km<-summary(lm(ordrank.6.atui.km$ds~ordrank.6.atui.km$ord.rank))
s6.atui.km<-lm6.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.km<-data.frame(X1=attacks.atui.km[[19]],X2=attacks.atui.km[[20]],Victories=attacks.atui.km[[21]])
mat7.atui.km<-inter.mat(mut7.atui.km)
tri7.atui.km<-tr.tri(mat7.atui.km)
dci7.atui.km<-DCindex(mat7.atui.km)
mat7.atui.km[is.na(mat7.atui.km)] = 0
h7.atui.km<-h.index(mat7.atui.km)

ep7.atui.km<-ep(mut7.atui.km,a7.ui.sf.km)
david7.atui.km<-DS(mat7.atui.km) #David's Scores - for steepness use normDS output
ordrank.7.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.km<-cbind(ordrank.7.atui.km,ds=david7.atui.km$normDS)
lm7.atui.km<-summary(lm(ordrank.7.atui.km$ds~ordrank.7.atui.km$ord.rank))
s7.atui.km<-lm7.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.km<-data.frame(X1=attacks.atui.km[[22]],X2=attacks.atui.km[[23]],Victories=attacks.atui.km[[24]])
mat8.atui.km<-inter.mat(mut8.atui.km)
tri8.atui.km<-tr.tri(mat8.atui.km)
dci8.atui.km<-DCindex(mat8.atui.km)
mat8.atui.km[is.na(mat8.atui.km)] = 0
h8.atui.km<-h.index(mat8.atui.km)

ep8.atui.km<-ep(mut8.atui.km,a8.ui.sf.km)
david8.atui.km<-DS(mat8.atui.km) #David's Scores - for steepness use normDS output
ordrank.8.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.km<-cbind(ordrank.8.atui.km,ds=david8.atui.km$normDS)
lm8.atui.km<-summary(lm(ordrank.8.atui.km$ds~ordrank.8.atui.km$ord.rank))
s8.atui.km<-lm8.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.km<-data.frame(X1=attacks.atui.km[[25]],X2=attacks.atui.km[[26]],Victories=attacks.atui.km[[27]])
mat9.atui.km<-inter.mat(mut9.atui.km)
tri9.atui.km<-tr.tri(mat9.atui.km)
dci9.atui.km<-DCindex(mat9.atui.km)
mat9.atui.km[is.na(mat9.atui.km)] = 0
h9.atui.km<-h.index(mat9.atui.km)

ep9.atui.km<-ep(mut9.atui.km,a9.ui.sf.km)
david9.atui.km<-DS(mat9.atui.km) #David's Scores - for steepness use normDS output
ordrank.9.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.km<-cbind(ordrank.9.atui.km,ds=david9.atui.km$normDS)
lm9.atui.km<-summary(lm(ordrank.9.atui.km$ds~ordrank.9.atui.km$ord.rank))
s9.atui.km<-lm9.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.km<-data.frame(X1=attacks.atui.km[[28]],X2=attacks.atui.km[[29]],Victories=attacks.atui.km[[30]])
mat10.atui.km<-inter.mat(mut10.atui.km)
tri10.atui.km<-tr.tri(mat10.atui.km)
dci10.atui.km<-DCindex(mat10.atui.km)
mat10.atui.km[is.na(mat10.atui.km)] = 0
h10.atui.km<-h.index(mat10.atui.km)

ep10.atui.km<-ep(mut10.atui.km,a10.ui.sf.km)
david10.atui.km<-DS(mat10.atui.km) #David's Scores - for steepness use normDS output
ordrank.10.atui.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.km<-cbind(ordrank.10.atui.km,ds=david10.atui.km$normDS)
lm10.atui.km<-summary(lm(ordrank.10.atui.km$ds~ordrank.10.atui.km$ord.rank))
s10.atui.km<-lm10.atui.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.km<-sum(mut1.atui.km$Victories)
int2.atui.km<-sum(mut2.atui.km$Victories)
int3.atui.km<-sum(mut3.atui.km$Victories)
int4.atui.km<-sum(mut4.atui.km$Victories)
int5.atui.km<-sum(mut5.atui.km$Victories)
int6.atui.km<-sum(mut6.atui.km$Victories)
int7.atui.km<-sum(mut7.atui.km$Victories)
int8.atui.km<-sum(mut8.atui.km$Victories)
int9.atui.km<-sum(mut9.atui.km$Victories)
int10.atui.km<-sum(mut10.atui.km$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.km<-sum(a1.ui.sf.km$Victories)
av2.atui.km<-sum(a2.ui.sf.km$Victories)
av3.atui.km<-sum(a3.ui.sf.km$Victories)
av4.atui.km<-sum(a4.ui.sf.km$Victories)
av5.atui.km<-sum(a5.ui.sf.km$Victories)
av6.atui.km<-sum(a6.ui.sf.km$Victories)
av7.atui.km<-sum(a7.ui.sf.km$Victories)
av8.atui.km<-sum(a8.ui.sf.km$Victories)
av9.atui.km<-sum(a9.ui.sf.km$Victories)
av10.atui.km<-sum(a10.ui.sf.km$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.km.atiu<-(sum(av1.atui.km, av2.atui.km, av3.atui.km, av4.atui.km, av5.atui.km, av6.atui.km, av7.atui.km, av8.atui.km, av9.atui.km, av10.atui.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.atiu<-(sum(int1.atui.km, int2.atui.km, int3.atui.km, int4.atui.km, int5.atui.km, int6.atui.km, int7.atui.km, int8.atui.km, int9.atui.km, int10.atui.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.km<-e1.atui.km[order(e1.atui.km$ID),]
e1.atui.km<-as.matrix(t(e1.1.atui.km))

e2.atui.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.km<-e2.atui.km[order(e2.atui.km$ID),]
e2.atui.km<-as.matrix(t(e2.1.atui.km))

e3.atui.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.km<-e3.atui.km[order(e3.atui.km$ID),]
e3.atui.km<-as.matrix(t(e3.1.atui.km))

e4.atui.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.km<-e4.atui.km[order(e4.atui.km$ID),]
e4.atui.km<-as.matrix(t(e4.1.atui.km))

e5.atui.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.km<-e5.atui.km[order(e5.atui.km$ID),]
e5.atui.km<-as.matrix(t(e5.1.atui.km))

e6.atui.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.km<-e6.atui.km[order(e6.atui.km$ID),]
e6.atui.km<-as.matrix(t(e6.1.atui.km))

e7.atui.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.km<-e7.atui.km[order(e7.atui.km$ID),]
e7.atui.km<-as.matrix(t(e7.1.atui.km))

e8.atui.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.km<-e8.atui.km[order(e8.atui.km$ID),]
e8.atui.km<-as.matrix(t(e8.1.atui.km))

e9.atui.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.km<-e9.atui.km[order(e9.atui.km$ID),]
e9.atui.km<-as.matrix(t(e9.1.atui.km))

e10.atui.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.km<-e10.atui.km[order(e10.atui.km$ID),]
e10.atui.km<-as.matrix(t(e10.1.atui.km))

energy.km.atui.km<-as.data.frame(matrix(c(e1.atui.km,e2.atui.km,e3.atui.km,e4.atui.km,e5.atui.km,e6.atui.km,e7.atui.km,e8.atui.km,e9.atui.km,e10.atui.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atui.km<-data.frame(ID=energy.km.atui.km$V1,energy_over_distance=energy.km.atui.km$V2,energy_over_time=energy.km.atui.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.km<-david1.atui.km[order(david1.atui.km$ID),]
david1.atui.km<-as.matrix(t(david1.1.atui.km))

david2.1.atui.km<-david2.atui.km[order(david2.atui.km$ID),]
david2.atui.km<-as.matrix(t(david2.1.atui.km))

david3.1.atui.km<-david3.atui.km[order(david3.atui.km$ID),]
david3.atui.km<-as.matrix(t(david3.1.atui.km))

david4.1.atui.km<-david4.atui.km[order(david4.atui.km$ID),]
david4.atui.km<-as.matrix(t(david4.1.atui.km))

david5.1.atui.km<-david5.atui.km[order(david5.atui.km$ID),]
david5.atui.km<-as.matrix(t(david5.1.atui.km))

david6.1.atui.km<-david6.atui.km[order(david6.atui.km$ID),]
david6.atui.km<-as.matrix(t(david6.1.atui.km))

david7.1.atui.km<-david7.atui.km[order(david7.atui.km$ID),]
david7.atui.km<-as.matrix(t(david7.1.atui.km))

david8.1.atui.km<-david8.atui.km[order(david8.atui.km$ID),]
david8.atui.km<-as.matrix(t(david8.1.atui.km))

david9.1.atui.km<-david9.atui.km[order(david9.atui.km$ID),]
david9.atui.km<-as.matrix(t(david9.1.atui.km))

david10.1.atui.km<-david10.atui.km[order(david10.atui.km$ID),]
david10.atui.km<-as.matrix(t(david10.1.atui.km))

david.km.atui.km<-as.data.frame(matrix(c(david1.atui.km,david2.atui.km,david3.atui.km,david4.atui.km,david5.atui.km,david6.atui.km,david7.atui.km,david8.atui.km,david9.atui.km,david10.atui.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atui.km<-data.frame(ID=david.km.atui.km$V1,DS=david.km.atui.km$V2,normDS=david.km.atui.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atui.km<-lm(e1.1.atui.km$energy_over_time~as.numeric(david1.1.atui.km$normDS))
km.lm.1.s.atui.km<-summary(lm.km.1.atui.km)$coefficients
km.1.slope.atui.km<-km.lm.1.s.atui.km[2,1]
lm.km.2.atui.km<-lm(e2.1.atui.km$energy_over_time~as.numeric(david2.1.atui.km$normDS))
km.lm.2.s.atui.km<-summary(lm.km.2.atui.km)$coefficients
km.2.slope.atui.km<-km.lm.2.s.atui.km[2,1]
lm.km.3.atui.km<-lm(e3.1.atui.km$energy_over_time~as.numeric(david3.1.atui.km$normDS))
km.lm.3.s.atui.km<-summary(lm.km.3.atui.km)$coefficients
km.3.slope.atui.km<-km.lm.3.s.atui.km[2,1]
lm.km.4.atui.km<-lm(e4.1.atui.km$energy_over_time~as.numeric(david4.1.atui.km$normDS))
km.lm.4.s.atui.km<-summary(lm.km.4.atui.km)$coefficients
km.4.slope.atui.km<-km.lm.4.s.atui.km[2,1]
lm.km.5.atui.km<-lm(e5.1.atui.km$energy_over_time~as.numeric(david5.1.atui.km$normDS))
km.lm.5.s.atui.km<-summary(lm.km.5.atui.km)$coefficients
km.5.slope.atui.km<-km.lm.5.s.atui.km[2,1]
lm.km.6.atui.km<-lm(e6.1.atui.km$energy_over_time~as.numeric(david6.1.atui.km$normDS))
km.lm.6.s.atui.km<-summary(lm.km.6.atui.km)$coefficients
km.6.slope.atui.km<-km.lm.6.s.atui.km[2,1]
lm.km.7.atui.km<-lm(e7.1.atui.km$energy_over_time~as.numeric(david7.1.atui.km$normDS))
km.lm.7.s.atui.km<-summary(lm.km.7.atui.km)$coefficients
km.7.slope.atui.km<-km.lm.7.s.atui.km[2,1]
lm.km.8.atui.km<-lm(e8.1.atui.km$energy_over_time~as.numeric(david8.1.atui.km$normDS))
km.lm.8.s.atui.km<-summary(lm.km.8.atui.km)$coefficients
km.8.slope.atui.km<-km.lm.8.s.atui.km[2,1]
lm.km.9.atui.km<-lm(e9.1.atui.km$energy_over_time~as.numeric(david9.1.atui.km$normDS))
km.lm.9.s.atui.km<-summary(lm.km.9.atui.km)$coefficients
km.9.slope.atui.km<-km.lm.9.s.atui.km[2,1]
lm.km.10.atui.km<-lm(e10.1.atui.km$energy_over_time~as.numeric(david10.1.atui.km$normDS))
km.lm.10.s.atui.km<-summary(lm.km.10.atui.km)$coefficients
km.10.slope.atui.km<-km.lm.10.s.atui.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atui.ss.attacks.atui.km<-data.frame(triangle.transitivity=c(tri1.atui.km,tri2.atui.km,tri3.atui.km,tri4.atui.km,tri5.atui.km,tri6.atui.km,tri7.atui.km,tri8.atui.km,tri9.atui.km,tri10.atui.km),escalation=c(ep1.atui.km,ep2.atui.km,ep3.atui.km,ep4.atui.km,ep5.atui.km,ep6.atui.km,ep7.atui.km,ep8.atui.km,ep9.atui.km,ep10.atui.km),dci=c(dci1.atui.km,dci2.atui.km,dci3.atui.km,dci4.atui.km,dci5.atui.km,dci6.atui.km,dci7.atui.km,dci8.atui.km,dci9.atui.km,dci10.atui.km),steepness=c(s1.atui.km,s2.atui.km,s3.atui.km,s4.atui.km,s5.atui.km,s6.atui.km,s7.atui.km,s8.atui.km,s9.atui.km,s10.atui.km),slope=c(km.1.slope.atui.km,km.2.slope.atui.km,km.3.slope.atui.km,km.4.slope.atui.km,km.5.slope.atui.km,km.6.slope.atui.km,km.7.slope.atui.km,km.8.slope.atui.km,km.9.slope.atui.km,km.10.slope.atui.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.ui.sf.hm<-sapply(files, read.csv)

# Generate attacks.ui.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[1]],X2=attacks.ui.sf.hm[[2]],Victories=attacks.ui.sf.hm[[3]])

mut1.atui.hm<-mut1.atui.hm[c(1:90),]
mut1.atui.hm<-transform(mut1.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat1.atui.hm<-inter.mat(mut1.atui.hm)
tri1.atui.hm<-tr.tri(mat1.atui.hm)
dci1.atui.hm<-DCindex(mat1.atui.hm)
mat1.atui.hm[is.na(mat1.atui.hm)] = 0
h1.atui.hm<-h.index(mat1.atui.hm)

ep1.atui.hm<-ep(mut1.atui.hm,a1.ui.sf.hm)
david1.atui.hm<-DS(mat1.atui.hm) #David's Scores - for steepness use normDS output
ordrank.1.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.hm<-cbind(ordrank.1.atui.hm,ds=david1.atui.hm$normDS)
lm1.atui.hm<-summary(lm(ordrank.1.atui.hm$ds~ordrank.1.atui.hm$ord.rank))
s1.atui.hm<-lm1.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[4]],X2=attacks.ui.sf.hm[[5]],Victories=attacks.ui.sf.hm[[6]])

mut2.atui.hm<-mut2.atui.hm[c(1:90),]
mut2.atui.hm<-transform(mut2.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat2.atui.hm<-inter.mat(mut2.atui.hm)
tri2.atui.hm<-tr.tri(mat2.atui.hm)
dci2.atui.hm<-DCindex(mat2.atui.hm)
mat2.atui.hm[is.na(mat2.atui.hm)] = 0
h2.atui.hm<-h.index(mat2.atui.hm)

ep2.atui.hm<-ep(mut2.atui.hm,a2.ui.sf.hm)
david2.atui.hm<-DS(mat2.atui.hm) #David's Scores - for steepness use normDS output
ordrank.2.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.hm<-cbind(ordrank.2.atui.hm,ds=david2.atui.hm$normDS)
lm2.atui.hm<-summary(lm(ordrank.2.atui.hm$ds~ordrank.2.atui.hm$ord.rank))
s2.atui.hm<-lm2.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[7]],X2=attacks.ui.sf.hm[[8]],Victories=attacks.ui.sf.hm[[9]])

mut3.atui.hm<-mut3.atui.hm[c(1:90),]
mut3.atui.hm<-transform(mut3.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat3.atui.hm<-inter.mat(mut3.atui.hm)
tri3.atui.hm<-tr.tri(mat3.atui.hm)
dci3.atui.hm<-DCindex(mat3.atui.hm)
mat3.atui.hm[is.na(mat3.atui.hm)] = 0
h3.atui.hm<-h.index(mat3.atui.hm)

ep3.atui.hm<-ep(mut3.atui.hm,a3.ui.sf.hm)
david3.atui.hm<-DS(mat3.atui.hm) #David's Scores - for steepness use normDS output
ordrank.3.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.hm<-cbind(ordrank.3.atui.hm,ds=david3.atui.hm$normDS)
lm3.atui.hm<-summary(lm(ordrank.3.atui.hm$ds~ordrank.3.atui.hm$ord.rank))
s3.atui.hm<-lm3.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[10]],X2=attacks.ui.sf.hm[[11]],Victories=attacks.ui.sf.hm[[12]])

mut4.atui.hm<-mut4.atui.hm[c(1:90),]
mut4.atui.hm<-transform(mut4.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat4.atui.hm<-inter.mat(mut4.atui.hm)
tri4.atui.hm<-tr.tri(mat4.atui.hm)
dci4.atui.hm<-DCindex(mat4.atui.hm)
mat4.atui.hm[is.na(mat4.atui.hm)] = 0
h4.atui.hm<-h.index(mat4.atui.hm)

ep4.atui.hm<-ep(mut4.atui.hm,a4.ui.sf.hm)
david4.atui.hm<-DS(mat4.atui.hm) #David's Scores - for steepness use normDS output
ordrank.4.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.hm<-cbind(ordrank.4.atui.hm,ds=david4.atui.hm$normDS)
lm4.atui.hm<-summary(lm(ordrank.4.atui.hm$ds~ordrank.4.atui.hm$ord.rank))
s4.atui.hm<-lm4.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[13]],X2=attacks.ui.sf.hm[[14]],Victories=attacks.ui.sf.hm[[15]])

mut5.atui.hm<-mut5.atui.hm[c(1:90),]
mut5.atui.hm<-transform(mut5.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat5.atui.hm<-inter.mat(mut5.atui.hm)
tri5.atui.hm<-tr.tri(mat5.atui.hm)
dci5.atui.hm<-DCindex(mat5.atui.hm)
mat5.atui.hm[is.na(mat5.atui.hm)] = 0
h5.atui.hm<-h.index(mat5.atui.hm)

ep5.atui.hm<-ep(mut5.atui.hm,a5.ui.sf.hm)
david5.atui.hm<-DS(mat5.atui.hm) #David's Scores - for steepness use normDS output
ordrank.5.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.hm<-cbind(ordrank.5.atui.hm,ds=david5.atui.hm$normDS)
lm5.atui.hm<-summary(lm(ordrank.5.atui.hm$ds~ordrank.5.atui.hm$ord.rank))
s5.atui.hm<-lm5.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[16]],X2=attacks.ui.sf.hm[[17]],Victories=attacks.ui.sf.hm[[18]])

mut6.atui.hm<-mut6.atui.hm[c(1:90),]
mut6.atui.hm<-transform(mut6.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat6.atui.hm<-inter.mat(mut6.atui.hm)
tri6.atui.hm<-tr.tri(mat6.atui.hm)
dci6.atui.hm<-DCindex(mat6.atui.hm)
mat6.atui.hm[is.na(mat6.atui.hm)] = 0
h6.atui.hm<-h.index(mat6.atui.hm)

ep6.atui.hm<-ep(mut6.atui.hm,a6.ui.sf.hm)
david6.atui.hm<-DS(mat6.atui.hm) #David's Scores - for steepness use normDS output
ordrank.6.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.hm<-cbind(ordrank.6.atui.hm,ds=david6.atui.hm$normDS)
lm6.atui.hm<-summary(lm(ordrank.6.atui.hm$ds~ordrank.6.atui.hm$ord.rank))
s6.atui.hm<-lm6.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[19]],X2=attacks.ui.sf.hm[[20]],Victories=attacks.ui.sf.hm[[21]])

mut7.atui.hm<-mut7.atui.hm[c(1:90),]
mut7.atui.hm<-transform(mut7.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat7.atui.hm<-inter.mat(mut7.atui.hm)
tri7.atui.hm<-tr.tri(mat7.atui.hm)
dci7.atui.hm<-DCindex(mat7.atui.hm)
mat7.atui.hm[is.na(mat7.atui.hm)] = 0
h7.atui.hm<-h.index(mat7.atui.hm)

ep7.atui.hm<-ep(mut7.atui.hm,a7.ui.sf.hm)
david7.atui.hm<-DS(mat7.atui.hm) #David's Scores - for steepness use normDS output
ordrank.7.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.hm<-cbind(ordrank.7.atui.hm,ds=david7.atui.hm$normDS)
lm7.atui.hm<-summary(lm(ordrank.7.atui.hm$ds~ordrank.7.atui.hm$ord.rank))
s7.atui.hm<-lm7.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[22]],X2=attacks.ui.sf.hm[[23]],Victories=attacks.ui.sf.hm[[24]])

mut8.atui.hm<-mut8.atui.hm[c(1:90),]
mut8.atui.hm<-transform(mut8.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat8.atui.hm<-inter.mat(mut8.atui.hm)
tri8.atui.hm<-tr.tri(mat8.atui.hm)
dci8.atui.hm<-DCindex(mat8.atui.hm)
mat8.atui.hm[is.na(mat8.atui.hm)] = 0
h8.atui.hm<-h.index(mat8.atui.hm)

ep8.atui.hm<-ep(mut8.atui.hm,a8.ui.sf.hm)
david8.atui.hm<-DS(mat8.atui.hm) #David's Scores - for steepness use normDS output
ordrank.8.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.hm<-cbind(ordrank.8.atui.hm,ds=david8.atui.hm$normDS)
lm8.atui.hm<-summary(lm(ordrank.8.atui.hm$ds~ordrank.8.atui.hm$ord.rank))
s8.atui.hm<-lm8.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[25]],X2=attacks.ui.sf.hm[[26]],Victories=attacks.ui.sf.hm[[27]])

mut9.atui.hm<-mut9.atui.hm[c(1:90),]
mut9.atui.hm<-transform(mut9.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat9.atui.hm<-inter.mat(mut9.atui.hm)
tri9.atui.hm<-tr.tri(mat9.atui.hm)
dci9.atui.hm<-DCindex(mat9.atui.hm)
mat9.atui.hm[is.na(mat9.atui.hm)] = 0
h9.atui.hm<-h.index(mat9.atui.hm)

ep9.atui.hm<-ep(mut9.atui.hm,a9.ui.sf.hm)
david9.atui.hm<-DS(mat9.atui.hm) #David's Scores - for steepness use normDS output
ordrank.9.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.hm<-cbind(ordrank.9.atui.hm,ds=david9.atui.hm$normDS)
lm9.atui.hm<-summary(lm(ordrank.9.atui.hm$ds~ordrank.9.atui.hm$ord.rank))
s9.atui.hm<-lm9.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.hm<-data.frame(X1=attacks.ui.sf.hm[[28]],X2=attacks.ui.sf.hm[[29]],Victories=attacks.ui.sf.hm[[30]])

mut10.atui.hm<-mut10.atui.hm[c(1:90),]
mut10.atui.hm<-transform(mut10.atui.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat10.atui.hm<-inter.mat(mut10.atui.hm)
tri10.atui.hm<-tr.tri(mat10.atui.hm)
dci10.atui.hm<-DCindex(mat10.atui.hm)
mat10.atui.hm[is.na(mat10.atui.hm)] = 0
h10.atui.hm<-h.index(mat10.atui.hm)

ep10.atui.hm<-ep(mut10.atui.hm,a10.ui.sf.hm)
david10.atui.hm<-DS(mat10.atui.hm) #David's Scores - for steepness use normDS output
ordrank.10.atui.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.hm<-cbind(ordrank.10.atui.hm,ds=david10.atui.hm$normDS)
lm10.atui.hm<-summary(lm(ordrank.10.atui.hm$ds~ordrank.10.atui.hm$ord.rank))
s10.atui.hm<-lm10.atui.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.hm<-sum(mut1.atui.hm$Victories)
int2.atui.hm<-sum(mut2.atui.hm$Victories)
int3.atui.hm<-sum(mut3.atui.hm$Victories)
int4.atui.hm<-sum(mut4.atui.hm$Victories)
int5.atui.hm<-sum(mut5.atui.hm$Victories)
int6.atui.hm<-sum(mut6.atui.hm$Victories)
int7.atui.hm<-sum(mut7.atui.hm$Victories)
int8.atui.hm<-sum(mut8.atui.hm$Victories)
int9.atui.hm<-sum(mut9.atui.hm$Victories)
int10.atui.hm<-sum(mut10.atui.hm$Victories)

  # Summarize the avoidances in each trial:
av1.atui.hm<-sum(a1.ui.sf.hm$Avoids)
av2.atui.hm<-sum(a2.ui.sf.hm$Avoids)
av3.atui.hm<-sum(a3.ui.sf.hm$Avoids)
av4.atui.hm<-sum(a4.ui.sf.hm$Avoids)
av5.atui.hm<-sum(a5.ui.sf.hm$Avoids)
av6.atui.hm<-sum(a6.ui.sf.hm$Avoids)
av7.atui.hm<-sum(a7.ui.sf.hm$Avoids)
av8.atui.hm<-sum(a8.ui.sf.hm$Avoids)
av9.atui.hm<-sum(a9.ui.sf.hm$Avoids)
av10.atui.hm<-sum(a10.ui.sf.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.atiu<-(sum(av1.atui.hm, av2.atui.hm, av3.atui.hm, av4.atui.hm, av5.atui.hm, av6.atui.hm, av7.atui.hm, av8.atui.hm, av9.atui.hm, av10.atui.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.atiu<-(sum(int1.atui.hm, int2.atui.hm, int3.atui.hm, int4.atui.hm, int5.atui.hm, int6.atui.hm, int7.atui.hm, int8.atui.hm, int9.atui.hm, int10.atui.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism sigmoid/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.atui.hm<-e1.atui.hm[c(1:10),]
e1.atui.hm<-transform(e1.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e1.1.atui.hm<-e1.atui.hm[order(e1.atui.hm$ID),]
e1.atui.hm<-as.matrix(t(e1.1.atui.hm))

e2.atui.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.atui.hm<-e2.atui.hm[c(1:10),]
e2.atui.hm<-transform(e2.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e2.1.atui.hm<-e2.atui.hm[order(e2.atui.hm$ID),]
e2.atui.hm<-as.matrix(t(e2.1.atui.hm))

e3.atui.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.atui.hm<-e3.atui.hm[c(1:10),]
e3.atui.hm<-transform(e3.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e3.1.atui.hm<-e3.atui.hm[order(e3.atui.hm$ID),]
e3.atui.hm<-as.matrix(t(e3.1.atui.hm))

e4.atui.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.atui.hm<-e4.atui.hm[c(1:10),]
e4.atui.hm<-transform(e4.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e4.1.atui.hm<-e4.atui.hm[order(e4.atui.hm$ID),]
e4.atui.hm<-as.matrix(t(e4.1.atui.hm))

e5.atui.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.atui.hm<-e5.atui.hm[c(1:10),]
e5.atui.hm<-transform(e5.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e5.1.atui.hm<-e5.atui.hm[order(e5.atui.hm$ID),]
e5.atui.hm<-as.matrix(t(e5.1.atui.hm))

e6.atui.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.atui.hm<-e6.atui.hm[c(1:10),]
e6.atui.hm<-transform(e6.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e6.1.atui.hm<-e6.atui.hm[order(e6.atui.hm$ID),]
e6.atui.hm<-as.matrix(t(e6.1.atui.hm))

e7.atui.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.atui.hm<-e7.atui.hm[c(1:10),]
e7.atui.hm<-transform(e7.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e7.1.atui.hm<-e7.atui.hm[order(e7.atui.hm$ID),]
e7.atui.hm<-as.matrix(t(e7.1.atui.hm))

e8.atui.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.atui.hm<-e8.atui.hm[c(1:10),]
e8.atui.hm<-transform(e8.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e8.1.atui.hm<-e8.atui.hm[order(e8.atui.hm$ID),]
e8.atui.hm<-as.matrix(t(e8.1.atui.hm))

e9.atui.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.atui.hm<-e9.atui.hm[c(1:10),]
e9.atui.hm<-transform(e9.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e9.1.atui.hm<-e9.atui.hm[order(e9.atui.hm$ID),]
e9.atui.hm<-as.matrix(t(e9.1.atui.hm))

e10.atui.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.atui.hm<-e10.atui.hm[c(1:10),]
e10.atui.hm<-transform(e10.atui.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e10.1.atui.hm<-e10.atui.hm[order(e10.atui.hm$ID),]
e10.atui.hm<-as.matrix(t(e10.1.atui.hm))

energy.hm.atui.hm<-as.data.frame(matrix(c(e1.atui.hm,e2.atui.hm,e3.atui.hm,e4.atui.hm,e5.atui.hm,e6.atui.hm,e7.atui.hm,e8.atui.hm,e9.atui.hm,e10.atui.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atui.hm<-data.frame(ID=energy.hm.atui.hm$V1,energy_over_distance=energy.hm.atui.hm$V2,energy_over_time=energy.hm.atui.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.hm<-david1.atui.hm[order(david1.atui.hm$ID),]
david1.atui.hm<-as.matrix(t(david1.1.atui.hm))

david2.1.atui.hm<-david2.atui.hm[order(david2.atui.hm$ID),]
david2.atui.hm<-as.matrix(t(david2.1.atui.hm))

david3.1.atui.hm<-david3.atui.hm[order(david3.atui.hm$ID),]
david3.atui.hm<-as.matrix(t(david3.1.atui.hm))

david4.1.atui.hm<-david4.atui.hm[order(david4.atui.hm$ID),]
david4.atui.hm<-as.matrix(t(david4.1.atui.hm))

david5.1.atui.hm<-david5.atui.hm[order(david5.atui.hm$ID),]
david5.atui.hm<-as.matrix(t(david5.1.atui.hm))

david6.1.atui.hm<-david6.atui.hm[order(david6.atui.hm$ID),]
david6.atui.hm<-as.matrix(t(david6.1.atui.hm))

david7.1.atui.hm<-david7.atui.hm[order(david7.atui.hm$ID),]
david7.atui.hm<-as.matrix(t(david7.1.atui.hm))

david8.1.atui.hm<-david8.atui.hm[order(david8.atui.hm$ID),]
david8.atui.hm<-as.matrix(t(david8.1.atui.hm))

david9.1.atui.hm<-david9.atui.hm[order(david9.atui.hm$ID),]
david9.atui.hm<-as.matrix(t(david9.1.atui.hm))

david10.1.atui.hm<-david10.atui.hm[order(david10.atui.hm$ID),]
david10.atui.hm<-as.matrix(t(david10.1.atui.hm))

david.hm.atui.hm<-as.data.frame(matrix(c(david1.atui.hm,david2.atui.hm,david3.atui.hm,david4.atui.hm,david5.atui.hm,david6.atui.hm,david7.atui.hm,david8.atui.hm,david9.atui.hm,david10.atui.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atui.hm<-data.frame(ID=david.hm.atui.hm$V1,DS=david.hm.atui.hm$V2,normDS=david.hm.atui.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atui.hm<-lm(e1.1.atui.hm$energy_over_time~as.numeric(david1.1.atui.hm$normDS))
hm.lm.1.s.atui.hm<-summary(lm.hm.1.atui.hm)$coefficients
hm.1.slope.atui.hm<-hm.lm.1.s.atui.hm[2,1]
lm.hm.2.atui.hm<-lm(e2.1.atui.hm$energy_over_time~as.numeric(david2.1.atui.hm$normDS))
hm.lm.2.s.atui.hm<-summary(lm.hm.2.atui.hm)$coefficients
hm.2.slope.atui.hm<-hm.lm.2.s.atui.hm[2,1]
lm.hm.3.atui.hm<-lm(e3.1.atui.hm$energy_over_time~as.numeric(david3.1.atui.hm$normDS))
hm.lm.3.s.atui.hm<-summary(lm.hm.3.atui.hm)$coefficients
hm.3.slope.atui.hm<-hm.lm.3.s.atui.hm[2,1]
lm.hm.4.atui.hm<-lm(e4.1.atui.hm$energy_over_time~as.numeric(david4.1.atui.hm$normDS))
hm.lm.4.s.atui.hm<-summary(lm.hm.4.atui.hm)$coefficients
hm.4.slope.atui.hm<-hm.lm.4.s.atui.hm[2,1]
lm.hm.5.atui.hm<-lm(e5.1.atui.hm$energy_over_time~as.numeric(david5.1.atui.hm$normDS))
hm.lm.5.s.atui.hm<-summary(lm.hm.5.atui.hm)$coefficients
hm.5.slope.atui.hm<-hm.lm.5.s.atui.hm[2,1]
lm.hm.6.atui.hm<-lm(e6.1.atui.hm$energy_over_time~as.numeric(david6.1.atui.hm$normDS))
hm.lm.6.s.atui.hm<-summary(lm.hm.6.atui.hm)$coefficients
hm.6.slope.atui.hm<-hm.lm.6.s.atui.hm[2,1]
lm.hm.7.atui.hm<-lm(e7.1.atui.hm$energy_over_time~as.numeric(david7.1.atui.hm$normDS))
hm.lm.7.s.atui.hm<-summary(lm.hm.7.atui.hm)$coefficients
hm.7.slope.atui.hm<-hm.lm.7.s.atui.hm[2,1]
lm.hm.8.atui.hm<-lm(e8.1.atui.hm$energy_over_time~as.numeric(david8.1.atui.hm$normDS))
hm.lm.8.s.atui.hm<-summary(lm.hm.8.atui.hm)$coefficients
hm.8.slope.atui.hm<-hm.lm.8.s.atui.hm[2,1]
lm.hm.9.atui.hm<-lm(e9.1.atui.hm$energy_over_time~as.numeric(david9.1.atui.hm$normDS))
hm.lm.9.s.atui.hm<-summary(lm.hm.9.atui.hm)$coefficients
hm.9.slope.atui.hm<-hm.lm.9.s.atui.hm[2,1]
lm.hm.10.atui.hm<-lm(e10.1.atui.hm$energy_over_time~as.numeric(david10.1.atui.hm$normDS))
hm.lm.10.s.atui.hm<-summary(lm.hm.10.atui.hm)$coefficients
hm.10.slope.atui.hm<-hm.lm.10.s.atui.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atui.ss.attacks.atui.hm<-data.frame(triangle.transitivity=c(tri1.atui.hm,tri2.atui.hm,tri3.atui.hm,tri4.atui.hm,tri5.atui.hm,tri6.atui.hm,tri7.atui.hm,tri8.atui.hm,tri9.atui.hm,tri10.atui.hm),escalation=c(ep1.atui.hm,ep2.atui.hm,ep3.atui.hm,ep4.atui.hm,ep5.atui.hm,ep6.atui.hm,ep7.atui.hm,ep8.atui.hm,ep9.atui.hm,ep10.atui.hm),dci=c(dci1.atui.hm,dci2.atui.hm,dci3.atui.hm,dci4.atui.hm,dci5.atui.hm,dci6.atui.hm,dci7.atui.hm,dci8.atui.hm,dci9.atui.hm,dci10.atui.hm),steepness=c(s1.atui.hm,s2.atui.hm,s3.atui.hm,s4.atui.hm,s5.atui.hm,s6.atui.hm,s7.atui.hm,s8.atui.hm,s9.atui.hm,s10.atui.hm),slope=c(hm.1.slope.atui.hm,hm.2.slope.atui.hm,hm.3.slope.atui.hm,hm.4.slope.atui.hm,hm.5.slope.atui.hm,hm.6.slope.atui.hm,hm.7.slope.atui.hm,hm.8.slope.atui.hm,hm.9.slope.atui.hm,hm.10.slope.atui.hm))


```
```{r attacks Uniform Deterministic Data Frame}
#knowledge mutual
km.tt.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$triangle.transitivity)
km.atiui.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$dci)
km.esc.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$escalation)
km.steep.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$steepness)
km.slope.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$slope)
km.mean.atiu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atiu.attacks,dci=km.atiui.atiu.attacks,esc=km.esc.atiu.attacks,steepness=km.steep.atiu.attacks,slope=km.slope.atiu.attacks,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$triangle.transitivity)
hm.atiui.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$dci)
hm.esc.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$escalation)
hm.steep.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$steepness)
hm.slope.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$slope)
hm.mean.atiu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atiu.attacks,dci=hm.atiui.atiu.attacks,esc=hm.esc.atiu.attacks,steepness=hm.steep.atiu.attacks,slope=hm.slope.atiu.attacks,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.atiu.attacks,hm.mean.atiu.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$triangle.transitivity)
km.atiui.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$dci)
km.esc.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$escalation)
km.steep.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$steepness)
km.slope.atiu.attacks<-mean(km.atui.ss.attacks.atui.km$slope)
km.mean.atiu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atiu.attacks,dci=km.atiui.atiu.attacks,esc=km.esc.atiu.attacks,steepness=km.steep.atiu.attacks,slope=km.slope.atiu.attacks,dist="Uniform",calc="deterministic")

#history mutual
hm.tt.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$triangle.transitivity)
hm.atiui.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$dci)
hm.esc.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$escalation)
hm.steep.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$steepness)
hm.slope.atiu.attacks<-mean(hm.atui.ss.attacks.atui.hm$slope)
hm.mean.atiu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atiu.attacks,dci=hm.atiui.atiu.attacks,esc=hm.esc.atiu.attacks,steepness=hm.steep.atiu.attacks,slope=hm.slope.atiu.attacks,dist="Uniform",calc="deterministic")

#total average dataframe
dc.ave<-rbind(km.mean.atiu.attacks,hm.mean.atiu.attacks)

#create overall dataframe of summary statistics
overall.unif.sf.attacks.initiator.sf<-data.frame(km.atui.ss.attacks.atui.km)
overall.unif.sf.attacks.initiator.sf<-rbind(overall.unif.sf.attacks.initiator.sf,hm.atui.ss.attacks.atui.hm)

overall.unif.sf.attacks.initiator.sf<-cbind(overall.unif.sf.attacks.initiator.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.unif.sf.attacks.initiator.sf<-cbind(overall.unif.sf.attacks.initiator.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("initiator",20))


rhp.ss.attacks.ui.sf<-overall.unif.sf.attacks.initiator.sf[overall.unif.sf.attacks.initiator.sf$variable=="rhp",]
history.ss.attacks.ui.sf<-overall.unif.sf.attacks.initiator.sf[overall.unif.sf.attacks.initiator.sf$variable=="history",]

overall.unif.sf.attacks.initiator.sf$combo<-paste(overall.unif.sf.attacks.initiator.sf$strategy,overall.unif.sf.attacks.initiator.sf$variable,overall.unif.sf.attacks.initiator.sf$distribution)
overall.unif.sf.attacks.initiator.sf$combo2<-paste(overall.unif.sf.attacks.initiator.sf$strategy,overall.unif.sf.attacks.initiator.sf$variable)
```

## Initiator Wins Attack Proportions Data
```{r Initiator Wins Attack Proportions}
# The original attack proportion (escalation) data needed to be collected and uploaded from NetLogo. The below code organizes and analyses these data.

library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

# Create data frame for initiator wins data
attack.prop.sf.i.2<-attack.prop.sf[attack.prop.sf$winning=="initiator",]
attack.prop.sf.i.2<-cbind(attack.prop.sf.i.2, run.number=as.numeric(attack.prop.sf.i.2$X.run.number.))

attack.prop.sf.i.2<-attack.prop.sf.i.2[order(attack.prop.sf.i.2$X.run.number),]


attack.prop.sf.i.2<-cbind(attack.prop.sf.i.2, rate.avoids=((as.numeric(attack.prop.sf.2$sum..avoid.counter..of.fightsavoided)/as.numeric(attack.prop.sf.2$ticks))), rate.attacks=((as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories)/as.numeric(attack.prop.sf.2$ticks))))

attack.prop.sf.i.2<-cbind(attack.prop.sf.i.2, proportion.attacking=((as.numeric(attack.prop.sf.i.2$sum..victory.counter..of.victories))/(as.numeric(attack.prop.sf.i.2$sum..victory.counter..of.victories)+as.numeric(attack.prop.sf.i.2$sum..avoid.counter..of.fightsavoided))))


# Label each set of 10 trials by the Who variable (mutual, opponent, self) and the What variable (History, RHP):
attack.prop.sf.i.2<-cbind(attack.prop.sf.i.2,combo2=c(rep("mutual history",10),rep("mutual rhp",10)))
```



## Clumped Probabilistic Data
```{r}
#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/avoid")


files<-list.files(pattern="*.csv")
avoid.cp.sf.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[1]],X2=avoid.cp.sf.km[[2]],Avoids=avoid.cp.sf.km[[3]])
a2.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[4]],X2=avoid.cp.sf.km[[5]],Avoids=avoid.cp.sf.km[[6]])
a3.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[7]],X2=avoid.cp.sf.km[[8]],Avoids=avoid.cp.sf.km[[9]])
a4.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[10]],X2=avoid.cp.sf.km[[11]],Avoids=avoid.cp.sf.km[[12]])
a5.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[13]],X2=avoid.cp.sf.km[[14]],Avoids=avoid.cp.sf.km[[15]])
a6.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[16]],X2=avoid.cp.sf.km[[17]],Avoids=avoid.cp.sf.km[[18]])
a7.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[19]],X2=avoid.cp.sf.km[[20]],Avoids=avoid.cp.sf.km[[21]])
a8.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[22]],X2=avoid.cp.sf.km[[23]],Avoids=avoid.cp.sf.km[[24]])
a9.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[25]],X2=avoid.cp.sf.km[[26]],Avoids=avoid.cp.sf.km[[27]])
a10.cp.sf.km<-data.frame(X1=avoid.cp.sf.km[[28]],X2=avoid.cp.sf.km[[29]],Avoids=avoid.cp.sf.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.km.cp.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[1]],X2=conflict.km.cp.sf[[2]],Victories=conflict.km.cp.sf[[3]])
mat1.cp.sf.km<-inter.mat(mut1.cp.sf.km)
tri1.cp.sf.km<-tr.tri(mat1.cp.sf.km)
dci1.cp.sf.km<-DCindex(mat1.cp.sf.km)
mat1.cp.sf.km[is.na(mat1.cp.sf.km)] = 0
h1.cp.sf.km<-h.index(mat1.cp.sf.km)

ep1.cp.sf.km<-ep(mut1.cp.sf.km,a1.cp.sf.km)
david1.cp.sf.km<-DS(mat1.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.sf.km<-cbind(ordrank.1.cp.sf.km,ds=david1.cp.sf.km$normDS)
lm1.cp.sf.km<-summary(lm(ordrank.1.cp.sf.km$ds~ordrank.1.cp.sf.km$ord.rank))
s1.cp.sf.km<-lm1.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[4]],X2=conflict.km.cp.sf[[5]],Victories=conflict.km.cp.sf[[6]])
mat2.cp.sf.km<-inter.mat(mut2.cp.sf.km)
tri2.cp.sf.km<-tr.tri(mat2.cp.sf.km)
dci2.cp.sf.km<-DCindex(mat2.cp.sf.km)
mat2.cp.sf.km[is.na(mat2.cp.sf.km)] = 0
h2.cp.sf.km<-h.index(mat2.cp.sf.km)

ep2.cp.sf.km<-ep(mut2.cp.sf.km,a2.cp.sf.km)
david2.cp.sf.km<-DS(mat2.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.sf.km<-cbind(ordrank.2.cp.sf.km,ds=david2.cp.sf.km$normDS)
lm2.cp.sf.km<-summary(lm(ordrank.2.cp.sf.km$ds~ordrank.2.cp.sf.km$ord.rank))
s2.cp.sf.km<-lm2.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[7]],X2=conflict.km.cp.sf[[8]],Victories=conflict.km.cp.sf[[9]])
mat3.cp.sf.km<-inter.mat(mut3.cp.sf.km)
tri3.cp.sf.km<-tr.tri(mat3.cp.sf.km)
dci3.cp.sf.km<-DCindex(mat3.cp.sf.km)
mat3.cp.sf.km[is.na(mat3.cp.sf.km)] = 0
h3.cp.sf.km<-h.index(mat3.cp.sf.km)

ep3.cp.sf.km<-ep(mut3.cp.sf.km,a3.cp.sf.km)
david3.cp.sf.km<-DS(mat3.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.sf.km<-cbind(ordrank.3.cp.sf.km,ds=david3.cp.sf.km$normDS)
lm3.cp.sf.km<-summary(lm(ordrank.3.cp.sf.km$ds~ordrank.3.cp.sf.km$ord.rank))
s3.cp.sf.km<-lm3.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[10]],X2=conflict.km.cp.sf[[11]],Victories=conflict.km.cp.sf[[12]])
mat4.cp.sf.km<-inter.mat(mut4.cp.sf.km)
tri4.cp.sf.km<-tr.tri(mat4.cp.sf.km)
dci4.cp.sf.km<-DCindex(mat4.cp.sf.km)
mat4.cp.sf.km[is.na(mat4.cp.sf.km)] = 0
h4.cp.sf.km<-h.index(mat4.cp.sf.km)

ep4.cp.sf.km<-ep(mut4.cp.sf.km,a4.cp.sf.km)
david4.cp.sf.km<-DS(mat4.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.sf.km<-cbind(ordrank.4.cp.sf.km,ds=david4.cp.sf.km$normDS)
lm4.cp.sf.km<-summary(lm(ordrank.4.cp.sf.km$ds~ordrank.4.cp.sf.km$ord.rank))
s4.cp.sf.km<-lm4.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[13]],X2=conflict.km.cp.sf[[14]],Victories=conflict.km.cp.sf[[15]])
mat5.cp.sf.km<-inter.mat(mut5.cp.sf.km)
tri5.cp.sf.km<-tr.tri(mat5.cp.sf.km)
dci5.cp.sf.km<-DCindex(mat5.cp.sf.km)
mat5.cp.sf.km[is.na(mat5.cp.sf.km)] = 0
h5.cp.sf.km<-h.index(mat5.cp.sf.km)

ep5.cp.sf.km<-ep(mut5.cp.sf.km,a5.cp.sf.km)
david5.cp.sf.km<-DS(mat5.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.sf.km<-cbind(ordrank.5.cp.sf.km,ds=david5.cp.sf.km$normDS)
lm5.cp.sf.km<-summary(lm(ordrank.5.cp.sf.km$ds~ordrank.5.cp.sf.km$ord.rank))
s5.cp.sf.km<-lm5.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[16]],X2=conflict.km.cp.sf[[17]],Victories=conflict.km.cp.sf[[18]])
mat6.cp.sf.km<-inter.mat(mut6.cp.sf.km)
tri6.cp.sf.km<-tr.tri(mat6.cp.sf.km)
dci6.cp.sf.km<-DCindex(mat6.cp.sf.km)
mat6.cp.sf.km[is.na(mat6.cp.sf.km)] = 0
h6.cp.sf.km<-h.index(mat6.cp.sf.km)

ep6.cp.sf.km<-ep(mut6.cp.sf.km,a6.cp.sf.km)
david6.cp.sf.km<-DS(mat6.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.sf.km<-cbind(ordrank.6.cp.sf.km,ds=david6.cp.sf.km$normDS)
lm6.cp.sf.km<-summary(lm(ordrank.6.cp.sf.km$ds~ordrank.6.cp.sf.km$ord.rank))
s6.cp.sf.km<-lm6.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[19]],X2=conflict.km.cp.sf[[20]],Victories=conflict.km.cp.sf[[21]])
mat7.cp.sf.km<-inter.mat(mut7.cp.sf.km)
tri7.cp.sf.km<-tr.tri(mat7.cp.sf.km)
dci7.cp.sf.km<-DCindex(mat7.cp.sf.km)
mat7.cp.sf.km[is.na(mat7.cp.sf.km)] = 0
h7.cp.sf.km<-h.index(mat7.cp.sf.km)

ep7.cp.sf.km<-ep(mut7.cp.sf.km,a7.cp.sf.km)
david7.cp.sf.km<-DS(mat7.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.sf.km<-cbind(ordrank.7.cp.sf.km,ds=david7.cp.sf.km$normDS)
lm7.cp.sf.km<-summary(lm(ordrank.7.cp.sf.km$ds~ordrank.7.cp.sf.km$ord.rank))
s7.cp.sf.km<-lm7.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[22]],X2=conflict.km.cp.sf[[23]],Victories=conflict.km.cp.sf[[24]])
mat8.cp.sf.km<-inter.mat(mut8.cp.sf.km)
tri8.cp.sf.km<-tr.tri(mat8.cp.sf.km)
dci8.cp.sf.km<-DCindex(mat8.cp.sf.km)
mat8.cp.sf.km[is.na(mat8.cp.sf.km)] = 0
h8.cp.sf.km<-h.index(mat8.cp.sf.km)

ep8.cp.sf.km<-ep(mut8.cp.sf.km,a8.cp.sf.km)
david8.cp.sf.km<-DS(mat8.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.sf.km<-cbind(ordrank.8.cp.sf.km,ds=david8.cp.sf.km$normDS)
lm8.cp.sf.km<-summary(lm(ordrank.8.cp.sf.km$ds~ordrank.8.cp.sf.km$ord.rank))
s8.cp.sf.km<-lm8.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[25]],X2=conflict.km.cp.sf[[26]],Victories=conflict.km.cp.sf[[27]])
mat9.cp.sf.km<-inter.mat(mut9.cp.sf.km)
tri9.cp.sf.km<-tr.tri(mat9.cp.sf.km)
dci9.cp.sf.km<-DCindex(mat9.cp.sf.km)
mat9.cp.sf.km[is.na(mat9.cp.sf.km)] = 0
h9.cp.sf.km<-h.index(mat9.cp.sf.km)

ep9.cp.sf.km<-ep(mut9.cp.sf.km,a9.cp.sf.km)
david9.cp.sf.km<-DS(mat9.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.sf.km<-cbind(ordrank.9.cp.sf.km,ds=david9.cp.sf.km$normDS)
lm9.cp.sf.km<-summary(lm(ordrank.9.cp.sf.km$ds~ordrank.9.cp.sf.km$ord.rank))
s9.cp.sf.km<-lm9.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.sf.km<-data.frame(X1=conflict.km.cp.sf[[28]],X2=conflict.km.cp.sf[[29]],Victories=conflict.km.cp.sf[[30]])
mat10.cp.sf.km<-inter.mat(mut10.cp.sf.km)
tri10.cp.sf.km<-tr.tri(mat10.cp.sf.km)
dci10.cp.sf.km<-DCindex(mat10.cp.sf.km)
mat10.cp.sf.km[is.na(mat10.cp.sf.km)] = 0
h10.cp.sf.km<-h.index(mat10.cp.sf.km)

ep10.cp.sf.km<-ep(mut10.cp.sf.km,a10.cp.sf.km)
david10.cp.sf.km<-DS(mat10.cp.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.cp.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.sf.km<-cbind(ordrank.10.cp.sf.km,ds=david10.cp.sf.km$normDS)
lm10.cp.sf.km<-summary(lm(ordrank.10.cp.sf.km$ds~ordrank.10.cp.sf.km$ord.rank))
s10.cp.sf.km<-lm10.cp.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.sf.km<-sum(mut1.cp.sf.km$Victories)
int2.cp.sf.km<-sum(mut2.cp.sf.km$Victories)
int3.cp.sf.km<-sum(mut3.cp.sf.km$Victories)
int4.cp.sf.km<-sum(mut4.cp.sf.km$Victories)
int5.cp.sf.km<-sum(mut5.cp.sf.km$Victories)
int6.cp.sf.km<-sum(mut6.cp.sf.km$Victories)
int7.cp.sf.km<-sum(mut7.cp.sf.km$Victories)
int8.cp.sf.km<-sum(mut8.cp.sf.km$Victories)
int9.cp.sf.km<-sum(mut9.cp.sf.km$Victories)
int10.cp.sf.km<-sum(mut10.cp.sf.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.sf.km<-sum(a1.cp.sf.km$Victories)
av2.cp.sf.km<-sum(a2.cp.sf.km$Victories)
av3.cp.sf.km<-sum(a3.cp.sf.km$Victories)
av4.cp.sf.km<-sum(a4.cp.sf.km$Victories)
av5.cp.sf.km<-sum(a5.cp.sf.km$Victories)
av6.cp.sf.km<-sum(a6.cp.sf.km$Victories)
av7.cp.sf.km<-sum(a7.cp.sf.km$Victories)
av8.cp.sf.km<-sum(a8.cp.sf.km$Victories)
av9.cp.sf.km<-sum(a9.cp.sf.km$Victories)
av10.cp.sf.km<-sum(a10.cp.sf.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.cp.sf<-(sum(av1.cp.sf.km, av2.cp.sf.km, av3.cp.sf.km, av4.cp.sf.km, av5.cp.sf.km, av6.cp.sf.km, av7.cp.sf.km, av8.cp.sf.km, av9.cp.sf.km, av10.cp.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.cp.sf<-(sum(int1.cp.sf.km, int2.cp.sf.km, int3.cp.sf.km, int4.cp.sf.km, int5.cp.sf.km, int6.cp.sf.km, int7.cp.sf.km, int8.cp.sf.km, int9.cp.sf.km, int10.cp.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.sf.km<-e1.cp.sf.km[order(e1.cp.sf.km$ID),]
e1.cp.sf.km<-as.matrix(t(e1.1.cp.sf.km))

e2.cp.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.sf.km<-e2.cp.sf.km[order(e2.cp.sf.km$ID),]
e2.cp.sf.km<-as.matrix(t(e2.1.cp.sf.km))

e3.cp.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.sf.km<-e3.cp.sf.km[order(e3.cp.sf.km$ID),]
e3.cp.sf.km<-as.matrix(t(e3.1.cp.sf.km))

e4.cp.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.sf.km<-e4.cp.sf.km[order(e4.cp.sf.km$ID),]
e4.cp.sf.km<-as.matrix(t(e4.1.cp.sf.km))

e5.cp.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.sf.km<-e5.cp.sf.km[order(e5.cp.sf.km$ID),]
e5.cp.sf.km<-as.matrix(t(e5.1.cp.sf.km))

e6.cp.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.sf.km<-e6.cp.sf.km[order(e6.cp.sf.km$ID),]
e6.cp.sf.km<-as.matrix(t(e6.1.cp.sf.km))

e7.cp.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.sf.km<-e7.cp.sf.km[order(e7.cp.sf.km$ID),]
e7.cp.sf.km<-as.matrix(t(e7.1.cp.sf.km))

e8.cp.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.sf.km<-e8.cp.sf.km[order(e8.cp.sf.km$ID),]
e8.cp.sf.km<-as.matrix(t(e8.1.cp.sf.km))

e9.cp.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.sf.km<-e9.cp.sf.km[order(e9.cp.sf.km$ID),]
e9.cp.sf.km<-as.matrix(t(e9.1.cp.sf.km))

e10.cp.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.sf.km<-e10.cp.sf.km[order(e10.cp.sf.km$ID),]
e10.cp.sf.km<-as.matrix(t(e10.1.cp.sf.km))

energy.km.cp.sf.km<-as.data.frame(matrix(c(e1.cp.sf.km,e2.cp.sf.km,e3.cp.sf.km,e4.cp.sf.km,e5.cp.sf.km,e6.cp.sf.km,e7.cp.sf.km,e8.cp.sf.km,e9.cp.sf.km,e10.cp.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.cp.sf.km<-data.frame(ID=energy.km.cp.sf.km$V1,energy_over_distance=energy.km.cp.sf.km$V2,energy_over_time=energy.km.cp.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.sf.km<-david1.cp.sf.km[order(david1.cp.sf.km$ID),]
david1.cp.sf.km<-as.matrix(t(david1.1.cp.sf.km))

david2.1.cp.sf.km<-david2.cp.sf.km[order(david2.cp.sf.km$ID),]
david2.cp.sf.km<-as.matrix(t(david2.1.cp.sf.km))

david3.1.cp.sf.km<-david3.cp.sf.km[order(david3.cp.sf.km$ID),]
david3.cp.sf.km<-as.matrix(t(david3.1.cp.sf.km))

david4.1.cp.sf.km<-david4.cp.sf.km[order(david4.cp.sf.km$ID),]
david4.cp.sf.km<-as.matrix(t(david4.1.cp.sf.km))

david5.1.cp.sf.km<-david5.cp.sf.km[order(david5.cp.sf.km$ID),]
david5.cp.sf.km<-as.matrix(t(david5.1.cp.sf.km))

david6.1.cp.sf.km<-david6.cp.sf.km[order(david6.cp.sf.km$ID),]
david6.cp.sf.km<-as.matrix(t(david6.1.cp.sf.km))

david7.1.cp.sf.km<-david7.cp.sf.km[order(david7.cp.sf.km$ID),]
david7.cp.sf.km<-as.matrix(t(david7.1.cp.sf.km))

david8.1.cp.sf.km<-david8.cp.sf.km[order(david8.cp.sf.km$ID),]
david8.cp.sf.km<-as.matrix(t(david8.1.cp.sf.km))

david9.1.cp.sf.km<-david9.cp.sf.km[order(david9.cp.sf.km$ID),]
david9.cp.sf.km<-as.matrix(t(david9.1.cp.sf.km))

david10.1.cp.sf.km<-david10.cp.sf.km[order(david10.cp.sf.km$ID),]
david10.cp.sf.km<-as.matrix(t(david10.1.cp.sf.km))

david.km.cp.sf.km<-as.data.frame(matrix(c(david1.cp.sf.km,david2.cp.sf.km,david3.cp.sf.km,david4.cp.sf.km,david5.cp.sf.km,david6.cp.sf.km,david7.cp.sf.km,david8.cp.sf.km,david9.cp.sf.km,david10.cp.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.cp.sf.km<-data.frame(ID=david.km.cp.sf.km$V1,DS=david.km.cp.sf.km$V2,normDS=david.km.cp.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.cp.sf.km<-lm(e1.1.cp.sf.km$energy_over_time~as.numeric(david1.1.cp.sf.km$normDS))
km.lm.1.s.cp.sf.km<-summary(lm.km.1.cp.sf.km)$coefficients
km.1.slope.cp.sf.km<-km.lm.1.s.cp.sf.km[2,1]
lm.km.2.cp.sf.km<-lm(e2.1.cp.sf.km$energy_over_time~as.numeric(david2.1.cp.sf.km$normDS))
km.lm.2.s.cp.sf.km<-summary(lm.km.2.cp.sf.km)$coefficients
km.2.slope.cp.sf.km<-km.lm.2.s.cp.sf.km[2,1]
lm.km.3.cp.sf.km<-lm(e3.1.cp.sf.km$energy_over_time~as.numeric(david3.1.cp.sf.km$normDS))
km.lm.3.s.cp.sf.km<-summary(lm.km.3.cp.sf.km)$coefficients
km.3.slope.cp.sf.km<-km.lm.3.s.cp.sf.km[2,1]
lm.km.4.cp.sf.km<-lm(e4.1.cp.sf.km$energy_over_time~as.numeric(david4.1.cp.sf.km$normDS))
km.lm.4.s.cp.sf.km<-summary(lm.km.4.cp.sf.km)$coefficients
km.4.slope.cp.sf.km<-km.lm.4.s.cp.sf.km[2,1]
lm.km.5.cp.sf.km<-lm(e5.1.cp.sf.km$energy_over_time~as.numeric(david5.1.cp.sf.km$normDS))
km.lm.5.s.cp.sf.km<-summary(lm.km.5.cp.sf.km)$coefficients
km.5.slope.cp.sf.km<-km.lm.5.s.cp.sf.km[2,1]
lm.km.6.cp.sf.km<-lm(e6.1.cp.sf.km$energy_over_time~as.numeric(david6.1.cp.sf.km$normDS))
km.lm.6.s.cp.sf.km<-summary(lm.km.6.cp.sf.km)$coefficients
km.6.slope.cp.sf.km<-km.lm.6.s.cp.sf.km[2,1]
lm.km.7.cp.sf.km<-lm(e7.1.cp.sf.km$energy_over_time~as.numeric(david7.1.cp.sf.km$normDS))
km.lm.7.s.cp.sf.km<-summary(lm.km.7.cp.sf.km)$coefficients
km.7.slope.cp.sf.km<-km.lm.7.s.cp.sf.km[2,1]
lm.km.8.cp.sf.km<-lm(e8.1.cp.sf.km$energy_over_time~as.numeric(david8.1.cp.sf.km$normDS))
km.lm.8.s.cp.sf.km<-summary(lm.km.8.cp.sf.km)$coefficients
km.8.slope.cp.sf.km<-km.lm.8.s.cp.sf.km[2,1]
lm.km.9.cp.sf.km<-lm(e9.1.cp.sf.km$energy_over_time~as.numeric(david9.1.cp.sf.km$normDS))
km.lm.9.s.cp.sf.km<-summary(lm.km.9.cp.sf.km)$coefficients
km.9.slope.cp.sf.km<-km.lm.9.s.cp.sf.km[2,1]
lm.km.10.cp.sf.km<-lm(e10.1.cp.sf.km$energy_over_time~as.numeric(david10.1.cp.sf.km$normDS))
km.lm.10.s.cp.sf.km<-summary(lm.km.10.cp.sf.km)$coefficients
km.10.slope.cp.sf.km<-km.lm.10.s.cp.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.cp.sf.ss<-data.frame(triangle.transitivity=c(tri1.cp.sf.km,tri2.cp.sf.km,tri3.cp.sf.km,tri4.cp.sf.km,tri5.cp.sf.km,tri6.cp.sf.km,tri7.cp.sf.km,tri8.cp.sf.km,tri9.cp.sf.km,tri10.cp.sf.km),escalation=c(ep1.cp.sf.km,ep2.cp.sf.km,ep3.cp.sf.km,ep4.cp.sf.km,ep5.cp.sf.km,ep6.cp.sf.km,ep7.cp.sf.km,ep8.cp.sf.km,ep9.cp.sf.km,ep10.cp.sf.km),dci=c(dci1.cp.sf.km,dci2.cp.sf.km,dci3.cp.sf.km,dci4.cp.sf.km,dci5.cp.sf.km,dci6.cp.sf.km,dci7.cp.sf.km,dci8.cp.sf.km,dci9.cp.sf.km,dci10.cp.sf.km),steepness=c(s1.cp.sf.km,s2.cp.sf.km,s3.cp.sf.km,s4.cp.sf.km,s5.cp.sf.km,s6.cp.sf.km,s7.cp.sf.km,s8.cp.sf.km,s9.cp.sf.km,s10.cp.sf.km),slope=c(km.1.slope.cp.sf.km,km.2.slope.cp.sf.km,km.3.slope.cp.sf.km,km.4.slope.cp.sf.km,km.5.slope.cp.sf.km,km.6.slope.cp.sf.km,km.7.slope.cp.sf.km,km.8.slope.cp.sf.km,km.9.slope.cp.sf.km,km.10.slope.cp.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.sf.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[1]],X2=avoid.cp.sf.hm[[2]],Avoids=avoid.cp.sf.hm[[3]])
a2.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[4]],X2=avoid.cp.sf.hm[[5]],Avoids=avoid.cp.sf.hm[[6]])
a3.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[7]],X2=avoid.cp.sf.hm[[8]],Avoids=avoid.cp.sf.hm[[9]])
a4.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[10]],X2=avoid.cp.sf.hm[[11]],Avoids=avoid.cp.sf.hm[[12]])
a5.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[13]],X2=avoid.cp.sf.hm[[14]],Avoids=avoid.cp.sf.hm[[15]])
a6.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[16]],X2=avoid.cp.sf.hm[[17]],Avoids=avoid.cp.sf.hm[[18]])
a7.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[19]],X2=avoid.cp.sf.hm[[20]],Avoids=avoid.cp.sf.hm[[21]])
a8.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[22]],X2=avoid.cp.sf.hm[[23]],Avoids=avoid.cp.sf.hm[[24]])
a9.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[25]],X2=avoid.cp.sf.hm[[26]],Avoids=avoid.cp.sf.hm[[27]])
a10.cp.sf.hm<-data.frame(X1=avoid.cp.sf.hm[[28]],X2=avoid.cp.sf.hm[[29]],Avoids=avoid.cp.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.cp.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[1]],X2=conflict.hm.cp.sf[[2]],Victories=conflict.hm.cp.sf[[3]])
mat1.cp.sf.hm<-inter.mat(mut1.cp.sf.hm)
tri1.cp.sf.hm<-tr.tri(mat1.cp.sf.hm)
dci1.cp.sf.hm<-DCindex(mat1.cp.sf.hm)
mat1.cp.sf.hm[is.na(mat1.cp.sf.hm)] = 0
h1.cp.sf.hm<-h.index(mat1.cp.sf.hm)

ep1.cp.sf.hm<-ep(mut1.cp.sf.hm,a1.cp.sf.hm)
david1.cp.sf.hm<-DS(mat1.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.sf.hm<-cbind(ordrank.1.cp.sf.hm,ds=david1.cp.sf.hm$normDS)
lm1.cp.sf.hm<-summary(lm(ordrank.1.cp.sf.hm$ds~ordrank.1.cp.sf.hm$ord.rank))
s1.cp.sf.hm<-lm1.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[4]],X2=conflict.hm.cp.sf[[5]],Victories=conflict.hm.cp.sf[[6]])
mat2.cp.sf.hm<-inter.mat(mut2.cp.sf.hm)
tri2.cp.sf.hm<-tr.tri(mat2.cp.sf.hm)
dci2.cp.sf.hm<-DCindex(mat2.cp.sf.hm)
mat2.cp.sf.hm[is.na(mat2.cp.sf.hm)] = 0
h2.cp.sf.hm<-h.index(mat2.cp.sf.hm)

ep2.cp.sf.hm<-ep(mut2.cp.sf.hm,a2.cp.sf.hm)
david2.cp.sf.hm<-DS(mat2.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.sf.hm<-cbind(ordrank.2.cp.sf.hm,ds=david2.cp.sf.hm$normDS)
lm2.cp.sf.hm<-summary(lm(ordrank.2.cp.sf.hm$ds~ordrank.2.cp.sf.hm$ord.rank))
s2.cp.sf.hm<-lm2.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[7]],X2=conflict.hm.cp.sf[[8]],Victories=conflict.hm.cp.sf[[9]])
mat3.cp.sf.hm<-inter.mat(mut3.cp.sf.hm)
tri3.cp.sf.hm<-tr.tri(mat3.cp.sf.hm)
dci3.cp.sf.hm<-DCindex(mat3.cp.sf.hm)
mat3.cp.sf.hm[is.na(mat3.cp.sf.hm)] = 0
h3.cp.sf.hm<-h.index(mat3.cp.sf.hm)

ep3.cp.sf.hm<-ep(mut3.cp.sf.hm,a3.cp.sf.hm)
david3.cp.sf.hm<-DS(mat3.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.sf.hm<-cbind(ordrank.3.cp.sf.hm,ds=david3.cp.sf.hm$normDS)
lm3.cp.sf.hm<-summary(lm(ordrank.3.cp.sf.hm$ds~ordrank.3.cp.sf.hm$ord.rank))
s3.cp.sf.hm<-lm3.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[10]],X2=conflict.hm.cp.sf[[11]],Victories=conflict.hm.cp.sf[[12]])
mat4.cp.sf.hm<-inter.mat(mut4.cp.sf.hm)
tri4.cp.sf.hm<-tr.tri(mat4.cp.sf.hm)
dci4.cp.sf.hm<-DCindex(mat4.cp.sf.hm)
mat4.cp.sf.hm[is.na(mat4.cp.sf.hm)] = 0
h4.cp.sf.hm<-h.index(mat4.cp.sf.hm)

ep4.cp.sf.hm<-ep(mut4.cp.sf.hm,a4.cp.sf.hm)
david4.cp.sf.hm<-DS(mat4.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.sf.hm<-cbind(ordrank.4.cp.sf.hm,ds=david4.cp.sf.hm$normDS)
lm4.cp.sf.hm<-summary(lm(ordrank.4.cp.sf.hm$ds~ordrank.4.cp.sf.hm$ord.rank))
s4.cp.sf.hm<-lm4.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[13]],X2=conflict.hm.cp.sf[[14]],Victories=conflict.hm.cp.sf[[15]])
mat5.cp.sf.hm<-inter.mat(mut5.cp.sf.hm)
tri5.cp.sf.hm<-tr.tri(mat5.cp.sf.hm)
dci5.cp.sf.hm<-DCindex(mat5.cp.sf.hm)
mat5.cp.sf.hm[is.na(mat5.cp.sf.hm)] = 0
h5.cp.sf.hm<-h.index(mat5.cp.sf.hm)

ep5.cp.sf.hm<-ep(mut5.cp.sf.hm,a5.cp.sf.hm)
david5.cp.sf.hm<-DS(mat5.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.sf.hm<-cbind(ordrank.5.cp.sf.hm,ds=david5.cp.sf.hm$normDS)
lm5.cp.sf.hm<-summary(lm(ordrank.5.cp.sf.hm$ds~ordrank.5.cp.sf.hm$ord.rank))
s5.cp.sf.hm<-lm5.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[16]],X2=conflict.hm.cp.sf[[17]],Victories=conflict.hm.cp.sf[[18]])
mat6.cp.sf.hm<-inter.mat(mut6.cp.sf.hm)
tri6.cp.sf.hm<-tr.tri(mat6.cp.sf.hm)
dci6.cp.sf.hm<-DCindex(mat6.cp.sf.hm)
mat6.cp.sf.hm[is.na(mat6.cp.sf.hm)] = 0
h6.cp.sf.hm<-h.index(mat6.cp.sf.hm)

ep6.cp.sf.hm<-ep(mut6.cp.sf.hm,a6.cp.sf.hm)
david6.cp.sf.hm<-DS(mat6.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.sf.hm<-cbind(ordrank.6.cp.sf.hm,ds=david6.cp.sf.hm$normDS)
lm6.cp.sf.hm<-summary(lm(ordrank.6.cp.sf.hm$ds~ordrank.6.cp.sf.hm$ord.rank))
s6.cp.sf.hm<-lm6.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[19]],X2=conflict.hm.cp.sf[[20]],Victories=conflict.hm.cp.sf[[21]])
mat7.cp.sf.hm<-inter.mat(mut7.cp.sf.hm)
tri7.cp.sf.hm<-tr.tri(mat7.cp.sf.hm)
dci7.cp.sf.hm<-DCindex(mat7.cp.sf.hm)
mat7.cp.sf.hm[is.na(mat7.cp.sf.hm)] = 0
h7.cp.sf.hm<-h.index(mat7.cp.sf.hm)

ep7.cp.sf.hm<-ep(mut7.cp.sf.hm,a7.cp.sf.hm)
david7.cp.sf.hm<-DS(mat7.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.sf.hm<-cbind(ordrank.7.cp.sf.hm,ds=david7.cp.sf.hm$normDS)
lm7.cp.sf.hm<-summary(lm(ordrank.7.cp.sf.hm$ds~ordrank.7.cp.sf.hm$ord.rank))
s7.cp.sf.hm<-lm7.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[22]],X2=conflict.hm.cp.sf[[23]],Victories=conflict.hm.cp.sf[[24]])
mat8.cp.sf.hm<-inter.mat(mut8.cp.sf.hm)
tri8.cp.sf.hm<-tr.tri(mat8.cp.sf.hm)
dci8.cp.sf.hm<-DCindex(mat8.cp.sf.hm)
mat8.cp.sf.hm[is.na(mat8.cp.sf.hm)] = 0
h8.cp.sf.hm<-h.index(mat8.cp.sf.hm)

ep8.cp.sf.hm<-ep(mut8.cp.sf.hm,a8.cp.sf.hm)
david8.cp.sf.hm<-DS(mat8.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.sf.hm<-cbind(ordrank.8.cp.sf.hm,ds=david8.cp.sf.hm$normDS)
lm8.cp.sf.hm<-summary(lm(ordrank.8.cp.sf.hm$ds~ordrank.8.cp.sf.hm$ord.rank))
s8.cp.sf.hm<-lm8.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[25]],X2=conflict.hm.cp.sf[[26]],Victories=conflict.hm.cp.sf[[27]])
mat9.cp.sf.hm<-inter.mat(mut9.cp.sf.hm)
tri9.cp.sf.hm<-tr.tri(mat9.cp.sf.hm)
dci9.cp.sf.hm<-DCindex(mat9.cp.sf.hm)
mat9.cp.sf.hm[is.na(mat9.cp.sf.hm)] = 0
h9.cp.sf.hm<-h.index(mat9.cp.sf.hm)

ep9.cp.sf.hm<-ep(mut9.cp.sf.hm,a9.cp.sf.hm)
david9.cp.sf.hm<-DS(mat9.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.sf.hm<-cbind(ordrank.9.cp.sf.hm,ds=david9.cp.sf.hm$normDS)
lm9.cp.sf.hm<-summary(lm(ordrank.9.cp.sf.hm$ds~ordrank.9.cp.sf.hm$ord.rank))
s9.cp.sf.hm<-lm9.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.sf.hm<-data.frame(X1=conflict.hm.cp.sf[[28]],X2=conflict.hm.cp.sf[[29]],Victories=conflict.hm.cp.sf[[30]])
mat10.cp.sf.hm<-inter.mat(mut10.cp.sf.hm)
tri10.cp.sf.hm<-tr.tri(mat10.cp.sf.hm)
dci10.cp.sf.hm<-DCindex(mat10.cp.sf.hm)
mat10.cp.sf.hm[is.na(mat10.cp.sf.hm)] = 0
h10.cp.sf.hm<-h.index(mat10.cp.sf.hm)

ep10.cp.sf.hm<-ep(mut10.cp.sf.hm,a10.cp.sf.hm)
david10.cp.sf.hm<-DS(mat10.cp.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.cp.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.sf.hm<-cbind(ordrank.10.cp.sf.hm,ds=david10.cp.sf.hm$normDS)
lm10.cp.sf.hm<-summary(lm(ordrank.10.cp.sf.hm$ds~ordrank.10.cp.sf.hm$ord.rank))
s10.cp.sf.hm<-lm10.cp.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.sf.hm<-sum(mut1.cp.sf.hm$Victories)
int2.cp.sf.hm<-sum(mut2.cp.sf.hm$Victories)
int3.cp.sf.hm<-sum(mut3.cp.sf.hm$Victories)
int4.cp.sf.hm<-sum(mut4.cp.sf.hm$Victories)
int5.cp.sf.hm<-sum(mut5.cp.sf.hm$Victories)
int6.cp.sf.hm<-sum(mut6.cp.sf.hm$Victories)
int7.cp.sf.hm<-sum(mut7.cp.sf.hm$Victories)
int8.cp.sf.hm<-sum(mut8.cp.sf.hm$Victories)
int9.cp.sf.hm<-sum(mut9.cp.sf.hm$Victories)
int10.cp.sf.hm<-sum(mut10.cp.sf.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.sf.hm<-sum(a1.cp.sf.hm$Victories)
av2.cp.sf.hm<-sum(a2.cp.sf.hm$Victories)
av3.cp.sf.hm<-sum(a3.cp.sf.hm$Victories)
av4.cp.sf.hm<-sum(a4.cp.sf.hm$Victories)
av5.cp.sf.hm<-sum(a5.cp.sf.hm$Victories)
av6.cp.sf.hm<-sum(a6.cp.sf.hm$Victories)
av7.cp.sf.hm<-sum(a7.cp.sf.hm$Victories)
av8.cp.sf.hm<-sum(a8.cp.sf.hm$Victories)
av9.cp.sf.hm<-sum(a9.cp.sf.hm$Victories)
av10.cp.sf.hm<-sum(a10.cp.sf.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.cp.sf<-(sum(av1.cp.sf.hm, av2.cp.sf.hm, av3.cp.sf.hm, av4.cp.sf.hm, av5.cp.sf.hm, av6.cp.sf.hm, av7.cp.sf.hm, av8.cp.sf.hm, av9.cp.sf.hm, av10.cp.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.cp.sf<-(sum(int1.cp.sf.hm, int2.cp.sf.hm, int3.cp.sf.hm, int4.cp.sf.hm, int5.cp.sf.hm, int6.cp.sf.hm, int7.cp.sf.hm, int8.cp.sf.hm, int9.cp.sf.hm, int10.cp.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.sf.hm<-e1.cp.sf.hm[order(e1.cp.sf.hm$ID),]
e1.cp.sf.hm<-as.matrix(t(e1.1.cp.sf.hm))

e2.cp.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.sf.hm<-e2.cp.sf.hm[order(e2.cp.sf.hm$ID),]
e2.cp.sf.hm<-as.matrix(t(e2.1.cp.sf.hm))

e3.cp.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.sf.hm<-e3.cp.sf.hm[order(e3.cp.sf.hm$ID),]
e3.cp.sf.hm<-as.matrix(t(e3.1.cp.sf.hm))

e4.cp.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.sf.hm<-e4.cp.sf.hm[order(e4.cp.sf.hm$ID),]
e4.cp.sf.hm<-as.matrix(t(e4.1.cp.sf.hm))

e5.cp.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.sf.hm<-e5.cp.sf.hm[order(e5.cp.sf.hm$ID),]
e5.cp.sf.hm<-as.matrix(t(e5.1.cp.sf.hm))

e6.cp.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.sf.hm<-e6.cp.sf.hm[order(e6.cp.sf.hm$ID),]
e6.cp.sf.hm<-as.matrix(t(e6.1.cp.sf.hm))

e7.cp.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.sf.hm<-e7.cp.sf.hm[order(e7.cp.sf.hm$ID),]
e7.cp.sf.hm<-as.matrix(t(e7.1.cp.sf.hm))

e8.cp.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.sf.hm<-e8.cp.sf.hm[order(e8.cp.sf.hm$ID),]
e8.cp.sf.hm<-as.matrix(t(e8.1.cp.sf.hm))

e9.cp.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.sf.hm<-e9.cp.sf.hm[order(e9.cp.sf.hm$ID),]
e9.cp.sf.hm<-as.matrix(t(e9.1.cp.sf.hm))

e10.cp.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.sf.hm<-e10.cp.sf.hm[order(e10.cp.sf.hm$ID),]
e10.cp.sf.hm<-as.matrix(t(e10.1.cp.sf.hm))

energy.hm.cp.sf.hm<-as.data.frame(matrix(c(e1.cp.sf.hm,e2.cp.sf.hm,e3.cp.sf.hm,e4.cp.sf.hm,e5.cp.sf.hm,e6.cp.sf.hm,e7.cp.sf.hm,e8.cp.sf.hm,e9.cp.sf.hm,e10.cp.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.cp.sf.hm<-data.frame(ID=energy.hm.cp.sf.hm$V1,energy_over_distance=energy.hm.cp.sf.hm$V2,energy_over_time=energy.hm.cp.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.sf.hm<-david1.cp.sf.hm[order(david1.cp.sf.hm$ID),]
david1.cp.sf.hm<-as.matrix(t(david1.1.cp.sf.hm))

david2.1.cp.sf.hm<-david2.cp.sf.hm[order(david2.cp.sf.hm$ID),]
david2.cp.sf.hm<-as.matrix(t(david2.1.cp.sf.hm))

david3.1.cp.sf.hm<-david3.cp.sf.hm[order(david3.cp.sf.hm$ID),]
david3.cp.sf.hm<-as.matrix(t(david3.1.cp.sf.hm))

david4.1.cp.sf.hm<-david4.cp.sf.hm[order(david4.cp.sf.hm$ID),]
david4.cp.sf.hm<-as.matrix(t(david4.1.cp.sf.hm))

david5.1.cp.sf.hm<-david5.cp.sf.hm[order(david5.cp.sf.hm$ID),]
david5.cp.sf.hm<-as.matrix(t(david5.1.cp.sf.hm))

david6.1.cp.sf.hm<-david6.cp.sf.hm[order(david6.cp.sf.hm$ID),]
david6.cp.sf.hm<-as.matrix(t(david6.1.cp.sf.hm))

david7.1.cp.sf.hm<-david7.cp.sf.hm[order(david7.cp.sf.hm$ID),]
david7.cp.sf.hm<-as.matrix(t(david7.1.cp.sf.hm))

david8.1.cp.sf.hm<-david8.cp.sf.hm[order(david8.cp.sf.hm$ID),]
david8.cp.sf.hm<-as.matrix(t(david8.1.cp.sf.hm))

david9.1.cp.sf.hm<-david9.cp.sf.hm[order(david9.cp.sf.hm$ID),]
david9.cp.sf.hm<-as.matrix(t(david9.1.cp.sf.hm))

david10.1.cp.sf.hm<-david10.cp.sf.hm[order(david10.cp.sf.hm$ID),]
david10.cp.sf.hm<-as.matrix(t(david10.1.cp.sf.hm))

david.hm.cp.sf.hm<-as.data.frame(matrix(c(david1.cp.sf.hm,david2.cp.sf.hm,david3.cp.sf.hm,david4.cp.sf.hm,david5.cp.sf.hm,david6.cp.sf.hm,david7.cp.sf.hm,david8.cp.sf.hm,david9.cp.sf.hm,david10.cp.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.cp.sf.hm<-data.frame(ID=david.hm.cp.sf.hm$V1,DS=david.hm.cp.sf.hm$V2,normDS=david.hm.cp.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.cp.sf.hm<-lm(e1.1.cp.sf.hm$energy_over_time~as.numeric(david1.1.cp.sf.hm$normDS))
hm.lm.1.s.cp.sf.hm<-summary(lm.hm.1.cp.sf.hm)$coefficients
hm.1.slope.cp.sf.hm<-hm.lm.1.s.cp.sf.hm[2,1]
lm.hm.2.cp.sf.hm<-lm(e2.1.cp.sf.hm$energy_over_time~as.numeric(david2.1.cp.sf.hm$normDS))
hm.lm.2.s.cp.sf.hm<-summary(lm.hm.2.cp.sf.hm)$coefficients
hm.2.slope.cp.sf.hm<-hm.lm.2.s.cp.sf.hm[2,1]
lm.hm.3.cp.sf.hm<-lm(e3.1.cp.sf.hm$energy_over_time~as.numeric(david3.1.cp.sf.hm$normDS))
hm.lm.3.s.cp.sf.hm<-summary(lm.hm.3.cp.sf.hm)$coefficients
hm.3.slope.cp.sf.hm<-hm.lm.3.s.cp.sf.hm[2,1]
lm.hm.4.cp.sf.hm<-lm(e4.1.cp.sf.hm$energy_over_time~as.numeric(david4.1.cp.sf.hm$normDS))
hm.lm.4.s.cp.sf.hm<-summary(lm.hm.4.cp.sf.hm)$coefficients
hm.4.slope.cp.sf.hm<-hm.lm.4.s.cp.sf.hm[2,1]
lm.hm.5.cp.sf.hm<-lm(e5.1.cp.sf.hm$energy_over_time~as.numeric(david5.1.cp.sf.hm$normDS))
hm.lm.5.s.cp.sf.hm<-summary(lm.hm.5.cp.sf.hm)$coefficients
hm.5.slope.cp.sf.hm<-hm.lm.5.s.cp.sf.hm[2,1]
lm.hm.6.cp.sf.hm<-lm(e6.1.cp.sf.hm$energy_over_time~as.numeric(david6.1.cp.sf.hm$normDS))
hm.lm.6.s.cp.sf.hm<-summary(lm.hm.6.cp.sf.hm)$coefficients
hm.6.slope.cp.sf.hm<-hm.lm.6.s.cp.sf.hm[2,1]
lm.hm.7.cp.sf.hm<-lm(e7.1.cp.sf.hm$energy_over_time~as.numeric(david7.1.cp.sf.hm$normDS))
hm.lm.7.s.cp.sf.hm<-summary(lm.hm.7.cp.sf.hm)$coefficients
hm.7.slope.cp.sf.hm<-hm.lm.7.s.cp.sf.hm[2,1]
lm.hm.8.cp.sf.hm<-lm(e8.1.cp.sf.hm$energy_over_time~as.numeric(david8.1.cp.sf.hm$normDS))
hm.lm.8.s.cp.sf.hm<-summary(lm.hm.8.cp.sf.hm)$coefficients
hm.8.slope.cp.sf.hm<-hm.lm.8.s.cp.sf.hm[2,1]
lm.hm.9.cp.sf.hm<-lm(e9.1.cp.sf.hm$energy_over_time~as.numeric(david9.1.cp.sf.hm$normDS))
hm.lm.9.s.cp.sf.hm<-summary(lm.hm.9.cp.sf.hm)$coefficients
hm.9.slope.cp.sf.hm<-hm.lm.9.s.cp.sf.hm[2,1]
lm.hm.10.cp.sf.hm<-lm(e10.1.cp.sf.hm$energy_over_time~as.numeric(david10.1.cp.sf.hm$normDS))
hm.lm.10.s.cp.sf.hm<-summary(lm.hm.10.cp.sf.hm)$coefficients
hm.10.slope.cp.sf.hm<-hm.lm.10.s.cp.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.cp.sf.ss<-data.frame(triangle.transitivity=c(tri1.cp.sf.hm,tri2.cp.sf.hm,tri3.cp.sf.hm,tri4.cp.sf.hm,tri5.cp.sf.hm,tri6.cp.sf.hm,tri7.cp.sf.hm,tri8.cp.sf.hm,tri9.cp.sf.hm,tri10.cp.sf.hm),escalation=c(ep1.cp.sf.hm,ep2.cp.sf.hm,ep3.cp.sf.hm,ep4.cp.sf.hm,ep5.cp.sf.hm,ep6.cp.sf.hm,ep7.cp.sf.hm,ep8.cp.sf.hm,ep9.cp.sf.hm,ep10.cp.sf.hm),dci=c(dci1.cp.sf.hm,dci2.cp.sf.hm,dci3.cp.sf.hm,dci4.cp.sf.hm,dci5.cp.sf.hm,dci6.cp.sf.hm,dci7.cp.sf.hm,dci8.cp.sf.hm,dci9.cp.sf.hm,dci10.cp.sf.hm),steepness=c(s1.cp.sf.hm,s2.cp.sf.hm,s3.cp.sf.hm,s4.cp.sf.hm,s5.cp.sf.hm,s6.cp.sf.hm,s7.cp.sf.hm,s8.cp.sf.hm,s9.cp.sf.hm,s10.cp.sf.hm),slope=c(hm.1.slope.cp.sf.hm,hm.2.slope.cp.sf.hm,hm.3.slope.cp.sf.hm,hm.4.slope.cp.sf.hm,hm.5.slope.cp.sf.hm,hm.6.slope.cp.sf.hm,hm.7.slope.cp.sf.hm,hm.8.slope.cp.sf.hm,hm.9.slope.cp.sf.hm,hm.10.slope.cp.sf.hm))
```
```{r Clumped Probabilistic Data Frame}
# Generate energy data frame:
total.energy.cp.sf<-data.frame(energy.km.df.cp.sf.km)
total.energy.cp.sf<-rbind(total.energy.cp.sf,energy.hm.df.cp.sf.hm)

total.david.cp.sf<-data.frame(david.km.df.cp.sf.km)
total.david.cp.sf<-rbind(total.david.cp.sf,david.hm.df.cp.sf.hm)

total.energy.cp.sf<-cbind(total.energy.cp.sf,normDS=total.david.cp.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.cp.sf<-mean(km.cp.sf.ss$triangle.transitivity)
  km.dci.cp.sf<-mean(km.cp.sf.ss$dci)
  km.esc.cp.sf<-mean(km.cp.sf.ss$escalation)
  km.steep.cp.sf<-mean(km.cp.sf.ss$steepness)
  km.slope.cp.sf<-mean(km.cp.sf.ss$slope)
  km.mean.cp.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.cp.sf,dci=km.dci.cp.sf,esc=km.esc.cp.sf,steepness=km.steep.cp.sf,slope=km.slope.cp.sf,dist="clumped",calc="Probabilistic")

  # history mutual
  hm.tt.cp.sf<-mean(hm.cp.sf.ss$triangle.transitivity)
  hm.dci.cp.sf<-mean(hm.cp.sf.ss$dci)
  hm.esc.cp.sf<-mean(hm.cp.sf.ss$escalation)
  hm.steep.cp.sf<-mean(hm.cp.sf.ss$steepness)
  hm.slope.cp.sf<-mean(hm.cp.sf.ss$slope)
  hm.mean.cp.sf<-data.frame(scenario="History Mutual",tt=hm.tt.cp.sf,dci=hm.dci.cp.sf,esc=hm.esc.cp.sf,steepness=hm.steep.cp.sf,slope=hm.slope.cp.sf,dist="clumped",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.cp.sf,hm.mean.cp.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.cp.sf<-mean(km.cp.sf.ss$triangle.transitivity)
  km.dci.cp.sf<-mean(km.cp.sf.ss$dci)
  km.esc.cp.sf<-mean(km.cp.sf.ss$escalation)
  km.steep.cp.sf<-mean(km.cp.sf.ss$steepness)
  km.slope.cp.sf<-mean(km.cp.sf.ss$slope)
  km.mean.cp.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.cp.sf,dci=km.dci.cp.sf,esc=km.esc.cp.sf,steepness=km.steep.cp.sf,slope=km.slope.cp.sf,dist="clumped",calc="Probabilistic")
  
  #history mutual
  hm.tt.cp.sf<-mean(hm.cp.sf.ss$triangle.transitivity)
  hm.dci.cp.sf<-mean(hm.cp.sf.ss$dci)
  hm.esc.cp.sf<-mean(hm.cp.sf.ss$escalation)
  hm.steep.cp.sf<-mean(hm.cp.sf.ss$steepness)
  hm.slope.cp.sf<-mean(hm.cp.sf.ss$slope)
  hm.mean.cp.sf<-data.frame(scenario="History Mutual",tt=hm.tt.cp.sf,dci=hm.dci.cp.sf,esc=hm.esc.cp.sf,steepness=hm.steep.cp.sf,slope=hm.slope.cp.sf,dist="clumped",calc="Probabilistic")
  
# Generate data frame for all averages:
dc.ave<-rbind(km.mean.cp.sf,hm.mean.cp.sf)

# Create overall dataframe of summary statistics:
overall.clump.prob.sf<-data.frame(km.cp.sf.ss)
overall.clump.prob.sf<-rbind(overall.clump.prob.sf,hm.cp.sf.ss)

overall.clump.prob.sf<-cbind(overall.clump.prob.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.clump.prob.sf<-cbind(overall.clump.prob.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("prob",20))


rhp.cp.sf.ss<-overall.clump.prob.sf[overall.clump.prob.sf$variable=="rhp",]
history.cp.sf.ss<-overall.clump.prob.sf[overall.clump.prob.sf$variable=="history",]

overall.clump.prob.sf$combo<-paste(overall.clump.prob.sf$strategy,overall.clump.prob.sf$variable,overall.clump.prob.sf$distribution)
overall.clump.prob.sf$combo2<-paste(overall.clump.prob.sf$strategy,overall.clump.prob.sf$variable) #final dataframe for Probabilistic clumped data
```

## Avoids Clumped Probabilistic Data
```{r}
#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.sf.km<-sapply(files, read.csv)

# Generate avoid.cp.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.acp.km<-data.frame(X1=avoid.cp.sf.km[[1]],X2=avoid.cp.sf.km[[2]],Avoids=avoid.cp.sf.km[[3]])
mat1.acp.km<-avoid.inter.mat(mut1.acp.km)
tri1.acp.km<-tr.tri(mat1.acp.km)
dci1.acp.km<-DCindex(mat1.acp.km)
mat1.acp.km[is.na(mat1.acp.km)] = 0
h1.acp.km<-h.index(mat1.acp.km)

ep1.acp.km<-ep(mut1.acp.km,a1.cp.sf.km)
david1.acp.km<-DS(mat1.acp.km) #David's Scores - for steepness use normDS output
ordrank.1.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.km<-cbind(ordrank.1.acp.km,ds=david1.acp.km$normDS)
lm1.acp.km<-summary(lm(ordrank.1.acp.km$ds~ordrank.1.acp.km$ord.rank))
s1.acp.km<-lm1.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.km<-data.frame(X1=avoid.cp.sf.km[[4]],X2=avoid.cp.sf.km[[5]],Avoids=avoid.cp.sf.km[[6]])
mat2.acp.km<-avoid.inter.mat(mut2.acp.km)
tri2.acp.km<-tr.tri(mat2.acp.km)
dci2.acp.km<-DCindex(mat2.acp.km)
mat2.acp.km[is.na(mat2.acp.km)] = 0
h2.acp.km<-h.index(mat2.acp.km)

ep2.acp.km<-ep(mut2.acp.km,a2.cp.sf.km)
david2.acp.km<-DS(mat2.acp.km) #David's Scores - for steepness use normDS output
ordrank.2.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.km<-cbind(ordrank.2.acp.km,ds=david2.acp.km$normDS)
lm2.acp.km<-summary(lm(ordrank.2.acp.km$ds~ordrank.2.acp.km$ord.rank))
s2.acp.km<-lm2.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.km<-data.frame(X1=avoid.cp.sf.km[[7]],X2=avoid.cp.sf.km[[8]],Avoids=avoid.cp.sf.km[[9]])
mat3.acp.km<-avoid.inter.mat(mut3.acp.km)
tri3.acp.km<-tr.tri(mat3.acp.km)
dci3.acp.km<-DCindex(mat3.acp.km)
mat3.acp.km[is.na(mat3.acp.km)] = 0
h3.acp.km<-h.index(mat3.acp.km)

ep3.acp.km<-ep(mut3.acp.km,a3.cp.sf.km)
david3.acp.km<-DS(mat3.acp.km) #David's Scores - for steepness use normDS output
ordrank.3.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.km<-cbind(ordrank.3.acp.km,ds=david3.acp.km$normDS)
lm3.acp.km<-summary(lm(ordrank.3.acp.km$ds~ordrank.3.acp.km$ord.rank))
s3.acp.km<-lm3.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.km<-data.frame(X1=avoid.cp.sf.km[[10]],X2=avoid.cp.sf.km[[11]],Avoids=avoid.cp.sf.km[[12]])
mat4.acp.km<-avoid.inter.mat(mut4.acp.km)
tri4.acp.km<-tr.tri(mat4.acp.km)
dci4.acp.km<-DCindex(mat4.acp.km)
mat4.acp.km[is.na(mat4.acp.km)] = 0
h4.acp.km<-h.index(mat4.acp.km)

ep4.acp.km<-ep(mut4.acp.km,a4.cp.sf.km)
david4.acp.km<-DS(mat4.acp.km) #David's Scores - for steepness use normDS output
ordrank.4.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.km<-cbind(ordrank.4.acp.km,ds=david4.acp.km$normDS)
lm4.acp.km<-summary(lm(ordrank.4.acp.km$ds~ordrank.4.acp.km$ord.rank))
s4.acp.km<-lm4.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.km<-data.frame(X1=avoid.cp.sf.km[[13]],X2=avoid.cp.sf.km[[14]],Avoids=avoid.cp.sf.km[[15]])
mat5.acp.km<-avoid.inter.mat(mut5.acp.km)
tri5.acp.km<-tr.tri(mat5.acp.km)
dci5.acp.km<-DCindex(mat5.acp.km)
mat5.acp.km[is.na(mat5.acp.km)] = 0
h5.acp.km<-h.index(mat5.acp.km)

ep5.acp.km<-ep(mut5.acp.km,a5.cp.sf.km)
david5.acp.km<-DS(mat5.acp.km) #David's Scores - for steepness use normDS output
ordrank.5.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.km<-cbind(ordrank.5.acp.km,ds=david5.acp.km$normDS)
lm5.acp.km<-summary(lm(ordrank.5.acp.km$ds~ordrank.5.acp.km$ord.rank))
s5.acp.km<-lm5.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.km<-data.frame(X1=avoid.cp.sf.km[[16]],X2=avoid.cp.sf.km[[17]],Avoids=avoid.cp.sf.km[[18]])
mat6.acp.km<-avoid.inter.mat(mut6.acp.km)
tri6.acp.km<-tr.tri(mat6.acp.km)
dci6.acp.km<-DCindex(mat6.acp.km)
mat6.acp.km[is.na(mat6.acp.km)] = 0
h6.acp.km<-h.index(mat6.acp.km)

ep6.acp.km<-ep(mut6.acp.km,a6.cp.sf.km)
david6.acp.km<-DS(mat6.acp.km) #David's Scores - for steepness use normDS output
ordrank.6.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.km<-cbind(ordrank.6.acp.km,ds=david6.acp.km$normDS)
lm6.acp.km<-summary(lm(ordrank.6.acp.km$ds~ordrank.6.acp.km$ord.rank))
s6.acp.km<-lm6.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.km<-data.frame(X1=avoid.cp.sf.km[[19]],X2=avoid.cp.sf.km[[20]],Avoids=avoid.cp.sf.km[[21]])
mat7.acp.km<-avoid.inter.mat(mut7.acp.km)
tri7.acp.km<-tr.tri(mat7.acp.km)
dci7.acp.km<-DCindex(mat7.acp.km)
mat7.acp.km[is.na(mat7.acp.km)] = 0
h7.acp.km<-h.index(mat7.acp.km)

ep7.acp.km<-ep(mut7.acp.km,a7.cp.sf.km)
david7.acp.km<-DS(mat7.acp.km) #David's Scores - for steepness use normDS output
ordrank.7.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.km<-cbind(ordrank.7.acp.km,ds=david7.acp.km$normDS)
lm7.acp.km<-summary(lm(ordrank.7.acp.km$ds~ordrank.7.acp.km$ord.rank))
s7.acp.km<-lm7.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.km<-data.frame(X1=avoid.cp.sf.km[[22]],X2=avoid.cp.sf.km[[23]],Avoids=avoid.cp.sf.km[[24]])
mat8.acp.km<-avoid.inter.mat(mut8.acp.km)
tri8.acp.km<-tr.tri(mat8.acp.km)
dci8.acp.km<-DCindex(mat8.acp.km)
mat8.acp.km[is.na(mat8.acp.km)] = 0
h8.acp.km<-h.index(mat8.acp.km)

ep8.acp.km<-ep(mut8.acp.km,a8.cp.sf.km)
david8.acp.km<-DS(mat8.acp.km) #David's Scores - for steepness use normDS output
ordrank.8.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.km<-cbind(ordrank.8.acp.km,ds=david8.acp.km$normDS)
lm8.acp.km<-summary(lm(ordrank.8.acp.km$ds~ordrank.8.acp.km$ord.rank))
s8.acp.km<-lm8.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.km<-data.frame(X1=avoid.cp.sf.km[[25]],X2=avoid.cp.sf.km[[26]],Avoids=avoid.cp.sf.km[[27]])
mat9.acp.km<-avoid.inter.mat(mut9.acp.km)
tri9.acp.km<-tr.tri(mat9.acp.km)
dci9.acp.km<-DCindex(mat9.acp.km)
mat9.acp.km[is.na(mat9.acp.km)] = 0
h9.acp.km<-h.index(mat9.acp.km)

ep9.acp.km<-ep(mut9.acp.km,a9.cp.sf.km)
david9.acp.km<-DS(mat9.acp.km) #David's Scores - for steepness use normDS output
ordrank.9.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.km<-cbind(ordrank.9.acp.km,ds=david9.acp.km$normDS)
lm9.acp.km<-summary(lm(ordrank.9.acp.km$ds~ordrank.9.acp.km$ord.rank))
s9.acp.km<-lm9.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.km<-data.frame(X1=avoid.cp.sf.km[[28]],X2=avoid.cp.sf.km[[29]],Avoids=avoid.cp.sf.km[[30]])
mat10.acp.km<-avoid.inter.mat(mut10.acp.km)
tri10.acp.km<-tr.tri(mat10.acp.km)
dci10.acp.km<-DCindex(mat10.acp.km)
mat10.acp.km[is.na(mat10.acp.km)] = 0
h10.acp.km<-h.index(mat10.acp.km)

ep10.acp.km<-ep(mut10.acp.km,a10.cp.sf.km)
david10.acp.km<-DS(mat10.acp.km) #David's Scores - for steepness use normDS output
ordrank.10.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.km<-cbind(ordrank.10.acp.km,ds=david10.acp.km$normDS)
lm10.acp.km<-summary(lm(ordrank.10.acp.km$ds~ordrank.10.acp.km$ord.rank))
s10.acp.km<-lm10.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.km<-sum(mut1.acp.km$Victories)
int2.acp.km<-sum(mut2.acp.km$Victories)
int3.acp.km<-sum(mut3.acp.km$Victories)
int4.acp.km<-sum(mut4.acp.km$Victories)
int5.acp.km<-sum(mut5.acp.km$Victories)
int6.acp.km<-sum(mut6.acp.km$Victories)
int7.acp.km<-sum(mut7.acp.km$Victories)
int8.acp.km<-sum(mut8.acp.km$Victories)
int9.acp.km<-sum(mut9.acp.km$Victories)
int10.acp.km<-sum(mut10.acp.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.km<-sum(a1.cp.sf.km$Victories)
av2.acp.km<-sum(a2.cp.sf.km$Victories)
av3.acp.km<-sum(a3.cp.sf.km$Victories)
av4.acp.km<-sum(a4.cp.sf.km$Victories)
av5.acp.km<-sum(a5.cp.sf.km$Victories)
av6.acp.km<-sum(a6.cp.sf.km$Victories)
av7.acp.km<-sum(a7.cp.sf.km$Victories)
av8.acp.km<-sum(a8.cp.sf.km$Victories)
av9.acp.km<-sum(a9.cp.sf.km$Victories)
av10.acp.km<-sum(a10.cp.sf.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.acp<-(sum(av1.acp.km, av2.acp.km, av3.acp.km, av4.acp.km, av5.acp.km, av6.acp.km, av7.acp.km, av8.acp.km, av9.acp.km, av10.acp.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.acp<-(sum(int1.acp.km, int2.acp.km, int3.acp.km, int4.acp.km, int5.acp.km, int6.acp.km, int7.acp.km, int8.acp.km, int9.acp.km, int10.acp.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.km<-e1.acp.km[order(e1.acp.km$ID),]
e1.acp.km<-as.matrix(t(e1.1.acp.km))

e2.acp.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.km<-e2.acp.km[order(e2.acp.km$ID),]
e2.acp.km<-as.matrix(t(e2.1.acp.km))

e3.acp.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.km<-e3.acp.km[order(e3.acp.km$ID),]
e3.acp.km<-as.matrix(t(e3.1.acp.km))

e4.acp.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.km<-e4.acp.km[order(e4.acp.km$ID),]
e4.acp.km<-as.matrix(t(e4.1.acp.km))

e5.acp.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.km<-e5.acp.km[order(e5.acp.km$ID),]
e5.acp.km<-as.matrix(t(e5.1.acp.km))

e6.acp.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.km<-e6.acp.km[order(e6.acp.km$ID),]
e6.acp.km<-as.matrix(t(e6.1.acp.km))

e7.acp.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.km<-e7.acp.km[order(e7.acp.km$ID),]
e7.acp.km<-as.matrix(t(e7.1.acp.km))

e8.acp.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.km<-e8.acp.km[order(e8.acp.km$ID),]
e8.acp.km<-as.matrix(t(e8.1.acp.km))

e9.acp.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.km<-e9.acp.km[order(e9.acp.km$ID),]
e9.acp.km<-as.matrix(t(e9.1.acp.km))

e10.acp.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.km<-e10.acp.km[order(e10.acp.km$ID),]
e10.acp.km<-as.matrix(t(e10.1.acp.km))

energy.km.acp.km<-as.data.frame(matrix(c(e1.acp.km,e2.acp.km,e3.acp.km,e4.acp.km,e5.acp.km,e6.acp.km,e7.acp.km,e8.acp.km,e9.acp.km,e10.acp.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.acp.km<-data.frame(ID=energy.km.acp.km$V1,energy_over_distance=energy.km.acp.km$V2,energy_over_time=energy.km.acp.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.km<-david1.acp.km[order(david1.acp.km$ID),]
david1.acp.km<-as.matrix(t(david1.1.acp.km))

david2.1.acp.km<-david2.acp.km[order(david2.acp.km$ID),]
david2.acp.km<-as.matrix(t(david2.1.acp.km))

david3.1.acp.km<-david3.acp.km[order(david3.acp.km$ID),]
david3.acp.km<-as.matrix(t(david3.1.acp.km))

david4.1.acp.km<-david4.acp.km[order(david4.acp.km$ID),]
david4.acp.km<-as.matrix(t(david4.1.acp.km))

david5.1.acp.km<-david5.acp.km[order(david5.acp.km$ID),]
david5.acp.km<-as.matrix(t(david5.1.acp.km))

david6.1.acp.km<-david6.acp.km[order(david6.acp.km$ID),]
david6.acp.km<-as.matrix(t(david6.1.acp.km))

david7.1.acp.km<-david7.acp.km[order(david7.acp.km$ID),]
david7.acp.km<-as.matrix(t(david7.1.acp.km))

david8.1.acp.km<-david8.acp.km[order(david8.acp.km$ID),]
david8.acp.km<-as.matrix(t(david8.1.acp.km))

david9.1.acp.km<-david9.acp.km[order(david9.acp.km$ID),]
david9.acp.km<-as.matrix(t(david9.1.acp.km))

david10.1.acp.km<-david10.acp.km[order(david10.acp.km$ID),]
david10.acp.km<-as.matrix(t(david10.1.acp.km))

david.km.acp.km<-as.data.frame(matrix(c(david1.acp.km,david2.acp.km,david3.acp.km,david4.acp.km,david5.acp.km,david6.acp.km,david7.acp.km,david8.acp.km,david9.acp.km,david10.acp.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.acp.km<-data.frame(ID=david.km.acp.km$V1,DS=david.km.acp.km$V2,normDS=david.km.acp.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.acp.km<-lm(e1.1.acp.km$energy_over_time~as.numeric(david1.1.acp.km$normDS))
km.lm.1.s.acp.km<-summary(lm.km.1.acp.km)$coefficients
km.1.slope.acp.km<-km.lm.1.s.acp.km[2,1]
lm.km.2.acp.km<-lm(e2.1.acp.km$energy_over_time~as.numeric(david2.1.acp.km$normDS))
km.lm.2.s.acp.km<-summary(lm.km.2.acp.km)$coefficients
km.2.slope.acp.km<-km.lm.2.s.acp.km[2,1]
lm.km.3.acp.km<-lm(e3.1.acp.km$energy_over_time~as.numeric(david3.1.acp.km$normDS))
km.lm.3.s.acp.km<-summary(lm.km.3.acp.km)$coefficients
km.3.slope.acp.km<-km.lm.3.s.acp.km[2,1]
lm.km.4.acp.km<-lm(e4.1.acp.km$energy_over_time~as.numeric(david4.1.acp.km$normDS))
km.lm.4.s.acp.km<-summary(lm.km.4.acp.km)$coefficients
km.4.slope.acp.km<-km.lm.4.s.acp.km[2,1]
lm.km.5.acp.km<-lm(e5.1.acp.km$energy_over_time~as.numeric(david5.1.acp.km$normDS))
km.lm.5.s.acp.km<-summary(lm.km.5.acp.km)$coefficients
km.5.slope.acp.km<-km.lm.5.s.acp.km[2,1]
lm.km.6.acp.km<-lm(e6.1.acp.km$energy_over_time~as.numeric(david6.1.acp.km$normDS))
km.lm.6.s.acp.km<-summary(lm.km.6.acp.km)$coefficients
km.6.slope.acp.km<-km.lm.6.s.acp.km[2,1]
lm.km.7.acp.km<-lm(e7.1.acp.km$energy_over_time~as.numeric(david7.1.acp.km$normDS))
km.lm.7.s.acp.km<-summary(lm.km.7.acp.km)$coefficients
km.7.slope.acp.km<-km.lm.7.s.acp.km[2,1]
lm.km.8.acp.km<-lm(e8.1.acp.km$energy_over_time~as.numeric(david8.1.acp.km$normDS))
km.lm.8.s.acp.km<-summary(lm.km.8.acp.km)$coefficients
km.8.slope.acp.km<-km.lm.8.s.acp.km[2,1]
lm.km.9.acp.km<-lm(e9.1.acp.km$energy_over_time~as.numeric(david9.1.acp.km$normDS))
km.lm.9.s.acp.km<-summary(lm.km.9.acp.km)$coefficients
km.9.slope.acp.km<-km.lm.9.s.acp.km[2,1]
lm.km.10.acp.km<-lm(e10.1.acp.km$energy_over_time~as.numeric(david10.1.acp.km$normDS))
km.lm.10.s.acp.km<-summary(lm.km.10.acp.km)$coefficients
km.10.slope.acp.km<-km.lm.10.s.acp.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.acp.ss.avoid.cp.sf.km<-data.frame(triangle.transitivity=c(tri1.acp.km,tri2.acp.km,tri3.acp.km,tri4.acp.km,tri5.acp.km,tri6.acp.km,tri7.acp.km,tri8.acp.km,tri9.acp.km,tri10.acp.km),escalation=c(ep1.acp.km,ep2.acp.km,ep3.acp.km,ep4.acp.km,ep5.acp.km,ep6.acp.km,ep7.acp.km,ep8.acp.km,ep9.acp.km,ep10.acp.km),dci=c(dci1.acp.km,dci2.acp.km,dci3.acp.km,dci4.acp.km,dci5.acp.km,dci6.acp.km,dci7.acp.km,dci8.acp.km,dci9.acp.km,dci10.acp.km),steepness=c(s1.acp.km,s2.acp.km,s3.acp.km,s4.acp.km,s5.acp.km,s6.acp.km,s7.acp.km,s8.acp.km,s9.acp.km,s10.acp.km),slope=c(km.1.slope.acp.km,km.2.slope.acp.km,km.3.slope.acp.km,km.4.slope.acp.km,km.5.slope.acp.km,km.6.slope.acp.km,km.7.slope.acp.km,km.8.slope.acp.km,km.9.slope.acp.km,km.10.slope.acp.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.sf.hm<-sapply(files, read.csv)

# Generate avoid.cp.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[1]],X2=avoid.cp.sf.hm[[2]],Avoids=avoid.cp.sf.hm[[3]])
mat1.acp.hm<-avoid.inter.mat(mut1.acp.hm)
tri1.acp.hm<-tr.tri(mat1.acp.hm)
dci1.acp.hm<-DCindex(mat1.acp.hm)
mat1.acp.hm[is.na(mat1.acp.hm)] = 0
h1.acp.hm<-h.index(mat1.acp.hm)

ep1.acp.hm<-ep(mut1.acp.hm,a1.cp.sf.hm)
david1.acp.hm<-DS(mat1.acp.hm) #David's Scores - for steepness use normDS output
ordrank.1.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.hm<-cbind(ordrank.1.acp.hm,ds=david1.acp.hm$normDS)
lm1.acp.hm<-summary(lm(ordrank.1.acp.hm$ds~ordrank.1.acp.hm$ord.rank))
s1.acp.hm<-lm1.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[4]],X2=avoid.cp.sf.hm[[5]],Avoids=avoid.cp.sf.hm[[6]])
mat2.acp.hm<-avoid.inter.mat(mut2.acp.hm)
tri2.acp.hm<-tr.tri(mat2.acp.hm)
dci2.acp.hm<-DCindex(mat2.acp.hm)
mat2.acp.hm[is.na(mat2.acp.hm)] = 0
h2.acp.hm<-h.index(mat2.acp.hm)

ep2.acp.hm<-ep(mut2.acp.hm,a2.cp.sf.hm)
david2.acp.hm<-DS(mat2.acp.hm) #David's Scores - for steepness use normDS output
ordrank.2.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.hm<-cbind(ordrank.2.acp.hm,ds=david2.acp.hm$normDS)
lm2.acp.hm<-summary(lm(ordrank.2.acp.hm$ds~ordrank.2.acp.hm$ord.rank))
s2.acp.hm<-lm2.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[7]],X2=avoid.cp.sf.hm[[8]],Avoids=avoid.cp.sf.hm[[9]])
mat3.acp.hm<-avoid.inter.mat(mut3.acp.hm)
tri3.acp.hm<-tr.tri(mat3.acp.hm)
dci3.acp.hm<-DCindex(mat3.acp.hm)
mat3.acp.hm[is.na(mat3.acp.hm)] = 0
h3.acp.hm<-h.index(mat3.acp.hm)

ep3.acp.hm<-ep(mut3.acp.hm,a3.cp.sf.hm)
david3.acp.hm<-DS(mat3.acp.hm) #David's Scores - for steepness use normDS output
ordrank.3.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.hm<-cbind(ordrank.3.acp.hm,ds=david3.acp.hm$normDS)
lm3.acp.hm<-summary(lm(ordrank.3.acp.hm$ds~ordrank.3.acp.hm$ord.rank))
s3.acp.hm<-lm3.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[10]],X2=avoid.cp.sf.hm[[11]],Avoids=avoid.cp.sf.hm[[12]])
mat4.acp.hm<-avoid.inter.mat(mut4.acp.hm)
tri4.acp.hm<-tr.tri(mat4.acp.hm)
dci4.acp.hm<-DCindex(mat4.acp.hm)
mat4.acp.hm[is.na(mat4.acp.hm)] = 0
h4.acp.hm<-h.index(mat4.acp.hm)

ep4.acp.hm<-ep(mut4.acp.hm,a4.cp.sf.hm)
david4.acp.hm<-DS(mat4.acp.hm) #David's Scores - for steepness use normDS output
ordrank.4.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.hm<-cbind(ordrank.4.acp.hm,ds=david4.acp.hm$normDS)
lm4.acp.hm<-summary(lm(ordrank.4.acp.hm$ds~ordrank.4.acp.hm$ord.rank))
s4.acp.hm<-lm4.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[13]],X2=avoid.cp.sf.hm[[14]],Avoids=avoid.cp.sf.hm[[15]])
mat5.acp.hm<-avoid.inter.mat(mut5.acp.hm)
tri5.acp.hm<-tr.tri(mat5.acp.hm)
dci5.acp.hm<-DCindex(mat5.acp.hm)
mat5.acp.hm[is.na(mat5.acp.hm)] = 0
h5.acp.hm<-h.index(mat5.acp.hm)

ep5.acp.hm<-ep(mut5.acp.hm,a5.cp.sf.hm)
david5.acp.hm<-DS(mat5.acp.hm) #David's Scores - for steepness use normDS output
ordrank.5.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.hm<-cbind(ordrank.5.acp.hm,ds=david5.acp.hm$normDS)
lm5.acp.hm<-summary(lm(ordrank.5.acp.hm$ds~ordrank.5.acp.hm$ord.rank))
s5.acp.hm<-lm5.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[16]],X2=avoid.cp.sf.hm[[17]],Avoids=avoid.cp.sf.hm[[18]])
mat6.acp.hm<-avoid.inter.mat(mut6.acp.hm)
tri6.acp.hm<-tr.tri(mat6.acp.hm)
dci6.acp.hm<-DCindex(mat6.acp.hm)
mat6.acp.hm[is.na(mat6.acp.hm)] = 0
h6.acp.hm<-h.index(mat6.acp.hm)

ep6.acp.hm<-ep(mut6.acp.hm,a6.cp.sf.hm)
david6.acp.hm<-DS(mat6.acp.hm) #David's Scores - for steepness use normDS output
ordrank.6.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.hm<-cbind(ordrank.6.acp.hm,ds=david6.acp.hm$normDS)
lm6.acp.hm<-summary(lm(ordrank.6.acp.hm$ds~ordrank.6.acp.hm$ord.rank))
s6.acp.hm<-lm6.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[19]],X2=avoid.cp.sf.hm[[20]],Avoids=avoid.cp.sf.hm[[21]])
mat7.acp.hm<-avoid.inter.mat(mut7.acp.hm)
tri7.acp.hm<-tr.tri(mat7.acp.hm)
dci7.acp.hm<-DCindex(mat7.acp.hm)
mat7.acp.hm[is.na(mat7.acp.hm)] = 0
h7.acp.hm<-h.index(mat7.acp.hm)

ep7.acp.hm<-ep(mut7.acp.hm,a7.cp.sf.hm)
david7.acp.hm<-DS(mat7.acp.hm) #David's Scores - for steepness use normDS output
ordrank.7.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.hm<-cbind(ordrank.7.acp.hm,ds=david7.acp.hm$normDS)
lm7.acp.hm<-summary(lm(ordrank.7.acp.hm$ds~ordrank.7.acp.hm$ord.rank))
s7.acp.hm<-lm7.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[22]],X2=avoid.cp.sf.hm[[23]],Avoids=avoid.cp.sf.hm[[24]])
mat8.acp.hm<-avoid.inter.mat(mut8.acp.hm)
tri8.acp.hm<-tr.tri(mat8.acp.hm)
dci8.acp.hm<-DCindex(mat8.acp.hm)
mat8.acp.hm[is.na(mat8.acp.hm)] = 0
h8.acp.hm<-h.index(mat8.acp.hm)

ep8.acp.hm<-ep(mut8.acp.hm,a8.cp.sf.hm)
david8.acp.hm<-DS(mat8.acp.hm) #David's Scores - for steepness use normDS output
ordrank.8.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.hm<-cbind(ordrank.8.acp.hm,ds=david8.acp.hm$normDS)
lm8.acp.hm<-summary(lm(ordrank.8.acp.hm$ds~ordrank.8.acp.hm$ord.rank))
s8.acp.hm<-lm8.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[25]],X2=avoid.cp.sf.hm[[26]],Avoids=avoid.cp.sf.hm[[27]])
mat9.acp.hm<-avoid.inter.mat(mut9.acp.hm)
tri9.acp.hm<-tr.tri(mat9.acp.hm)
dci9.acp.hm<-DCindex(mat9.acp.hm)
mat9.acp.hm[is.na(mat9.acp.hm)] = 0
h9.acp.hm<-h.index(mat9.acp.hm)

ep9.acp.hm<-ep(mut9.acp.hm,a9.cp.sf.hm)
david9.acp.hm<-DS(mat9.acp.hm) #David's Scores - for steepness use normDS output
ordrank.9.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.hm<-cbind(ordrank.9.acp.hm,ds=david9.acp.hm$normDS)
lm9.acp.hm<-summary(lm(ordrank.9.acp.hm$ds~ordrank.9.acp.hm$ord.rank))
s9.acp.hm<-lm9.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.hm<-data.frame(X1=avoid.cp.sf.hm[[28]],X2=avoid.cp.sf.hm[[29]],Avoids=avoid.cp.sf.hm[[30]])
mat10.acp.hm<-avoid.inter.mat(mut10.acp.hm)
tri10.acp.hm<-tr.tri(mat10.acp.hm)
dci10.acp.hm<-DCindex(mat10.acp.hm)
mat10.acp.hm[is.na(mat10.acp.hm)] = 0
h10.acp.hm<-h.index(mat10.acp.hm)

ep10.acp.hm<-ep(mut10.acp.hm,a10.cp.sf.hm)
david10.acp.hm<-DS(mat10.acp.hm) #David's Scores - for steepness use normDS output
ordrank.10.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.hm<-cbind(ordrank.10.acp.hm,ds=david10.acp.hm$normDS)
lm10.acp.hm<-summary(lm(ordrank.10.acp.hm$ds~ordrank.10.acp.hm$ord.rank))
s10.acp.hm<-lm10.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.hm<-sum(mut1.acp.hm$Victories)
int2.acp.hm<-sum(mut2.acp.hm$Victories)
int3.acp.hm<-sum(mut3.acp.hm$Victories)
int4.acp.hm<-sum(mut4.acp.hm$Victories)
int5.acp.hm<-sum(mut5.acp.hm$Victories)
int6.acp.hm<-sum(mut6.acp.hm$Victories)
int7.acp.hm<-sum(mut7.acp.hm$Victories)
int8.acp.hm<-sum(mut8.acp.hm$Victories)
int9.acp.hm<-sum(mut9.acp.hm$Victories)
int10.acp.hm<-sum(mut10.acp.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.hm<-sum(a1.cp.sf.hm$Victories)
av2.acp.hm<-sum(a2.cp.sf.hm$Victories)
av3.acp.hm<-sum(a3.cp.sf.hm$Victories)
av4.acp.hm<-sum(a4.cp.sf.hm$Victories)
av5.acp.hm<-sum(a5.cp.sf.hm$Victories)
av6.acp.hm<-sum(a6.cp.sf.hm$Victories)
av7.acp.hm<-sum(a7.cp.sf.hm$Victories)
av8.acp.hm<-sum(a8.cp.sf.hm$Victories)
av9.acp.hm<-sum(a9.cp.sf.hm$Victories)
av10.acp.hm<-sum(a10.cp.sf.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.acp<-(sum(av1.acp.hm, av2.acp.hm, av3.acp.hm, av4.acp.hm, av5.acp.hm, av6.acp.hm, av7.acp.hm, av8.acp.hm, av9.acp.hm, av10.acp.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.acp<-(sum(int1.acp.hm, int2.acp.hm, int3.acp.hm, int4.acp.hm, int5.acp.hm, int6.acp.hm, int7.acp.hm, int8.acp.hm, int9.acp.hm, int10.acp.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.hm<-e1.acp.hm[order(e1.acp.hm$ID),]
e1.acp.hm<-as.matrix(t(e1.1.acp.hm))

e2.acp.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.hm<-e2.acp.hm[order(e2.acp.hm$ID),]
e2.acp.hm<-as.matrix(t(e2.1.acp.hm))

e3.acp.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.hm<-e3.acp.hm[order(e3.acp.hm$ID),]
e3.acp.hm<-as.matrix(t(e3.1.acp.hm))

e4.acp.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.hm<-e4.acp.hm[order(e4.acp.hm$ID),]
e4.acp.hm<-as.matrix(t(e4.1.acp.hm))

e5.acp.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.hm<-e5.acp.hm[order(e5.acp.hm$ID),]
e5.acp.hm<-as.matrix(t(e5.1.acp.hm))

e6.acp.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.hm<-e6.acp.hm[order(e6.acp.hm$ID),]
e6.acp.hm<-as.matrix(t(e6.1.acp.hm))

e7.acp.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.hm<-e7.acp.hm[order(e7.acp.hm$ID),]
e7.acp.hm<-as.matrix(t(e7.1.acp.hm))

e8.acp.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.hm<-e8.acp.hm[order(e8.acp.hm$ID),]
e8.acp.hm<-as.matrix(t(e8.1.acp.hm))

e9.acp.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.hm<-e9.acp.hm[order(e9.acp.hm$ID),]
e9.acp.hm<-as.matrix(t(e9.1.acp.hm))

e10.acp.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.hm<-e10.acp.hm[order(e10.acp.hm$ID),]
e10.acp.hm<-as.matrix(t(e10.1.acp.hm))

energy.hm.acp.hm<-as.data.frame(matrix(c(e1.acp.hm,e2.acp.hm,e3.acp.hm,e4.acp.hm,e5.acp.hm,e6.acp.hm,e7.acp.hm,e8.acp.hm,e9.acp.hm,e10.acp.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.acp.hm<-data.frame(ID=energy.hm.acp.hm$V1,energy_over_distance=energy.hm.acp.hm$V2,energy_over_time=energy.hm.acp.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.hm<-david1.acp.hm[order(david1.acp.hm$ID),]
david1.acp.hm<-as.matrix(t(david1.1.acp.hm))

david2.1.acp.hm<-david2.acp.hm[order(david2.acp.hm$ID),]
david2.acp.hm<-as.matrix(t(david2.1.acp.hm))

david3.1.acp.hm<-david3.acp.hm[order(david3.acp.hm$ID),]
david3.acp.hm<-as.matrix(t(david3.1.acp.hm))

david4.1.acp.hm<-david4.acp.hm[order(david4.acp.hm$ID),]
david4.acp.hm<-as.matrix(t(david4.1.acp.hm))

david5.1.acp.hm<-david5.acp.hm[order(david5.acp.hm$ID),]
david5.acp.hm<-as.matrix(t(david5.1.acp.hm))

david6.1.acp.hm<-david6.acp.hm[order(david6.acp.hm$ID),]
david6.acp.hm<-as.matrix(t(david6.1.acp.hm))

david7.1.acp.hm<-david7.acp.hm[order(david7.acp.hm$ID),]
david7.acp.hm<-as.matrix(t(david7.1.acp.hm))

david8.1.acp.hm<-david8.acp.hm[order(david8.acp.hm$ID),]
david8.acp.hm<-as.matrix(t(david8.1.acp.hm))

david9.1.acp.hm<-david9.acp.hm[order(david9.acp.hm$ID),]
david9.acp.hm<-as.matrix(t(david9.1.acp.hm))

david10.1.acp.hm<-david10.acp.hm[order(david10.acp.hm$ID),]
david10.acp.hm<-as.matrix(t(david10.1.acp.hm))

david.hm.acp.hm<-as.data.frame(matrix(c(david1.acp.hm,david2.acp.hm,david3.acp.hm,david4.acp.hm,david5.acp.hm,david6.acp.hm,david7.acp.hm,david8.acp.hm,david9.acp.hm,david10.acp.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.acp.hm<-data.frame(ID=david.hm.acp.hm$V1,DS=david.hm.acp.hm$V2,normDS=david.hm.acp.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.acp.hm<-lm(e1.1.acp.hm$energy_over_time~as.numeric(david1.1.acp.hm$normDS))
hm.lm.1.s.acp.hm<-summary(lm.hm.1.acp.hm)$coefficients
hm.1.slope.acp.hm<-hm.lm.1.s.acp.hm[2,1]
lm.hm.2.acp.hm<-lm(e2.1.acp.hm$energy_over_time~as.numeric(david2.1.acp.hm$normDS))
hm.lm.2.s.acp.hm<-summary(lm.hm.2.acp.hm)$coefficients
hm.2.slope.acp.hm<-hm.lm.2.s.acp.hm[2,1]
lm.hm.3.acp.hm<-lm(e3.1.acp.hm$energy_over_time~as.numeric(david3.1.acp.hm$normDS))
hm.lm.3.s.acp.hm<-summary(lm.hm.3.acp.hm)$coefficients
hm.3.slope.acp.hm<-hm.lm.3.s.acp.hm[2,1]
lm.hm.4.acp.hm<-lm(e4.1.acp.hm$energy_over_time~as.numeric(david4.1.acp.hm$normDS))
hm.lm.4.s.acp.hm<-summary(lm.hm.4.acp.hm)$coefficients
hm.4.slope.acp.hm<-hm.lm.4.s.acp.hm[2,1]
lm.hm.5.acp.hm<-lm(e5.1.acp.hm$energy_over_time~as.numeric(david5.1.acp.hm$normDS))
hm.lm.5.s.acp.hm<-summary(lm.hm.5.acp.hm)$coefficients
hm.5.slope.acp.hm<-hm.lm.5.s.acp.hm[2,1]
lm.hm.6.acp.hm<-lm(e6.1.acp.hm$energy_over_time~as.numeric(david6.1.acp.hm$normDS))
hm.lm.6.s.acp.hm<-summary(lm.hm.6.acp.hm)$coefficients
hm.6.slope.acp.hm<-hm.lm.6.s.acp.hm[2,1]
lm.hm.7.acp.hm<-lm(e7.1.acp.hm$energy_over_time~as.numeric(david7.1.acp.hm$normDS))
hm.lm.7.s.acp.hm<-summary(lm.hm.7.acp.hm)$coefficients
hm.7.slope.acp.hm<-hm.lm.7.s.acp.hm[2,1]
lm.hm.8.acp.hm<-lm(e8.1.acp.hm$energy_over_time~as.numeric(david8.1.acp.hm$normDS))
hm.lm.8.s.acp.hm<-summary(lm.hm.8.acp.hm)$coefficients
hm.8.slope.acp.hm<-hm.lm.8.s.acp.hm[2,1]
lm.hm.9.acp.hm<-lm(e9.1.acp.hm$energy_over_time~as.numeric(david9.1.acp.hm$normDS))
hm.lm.9.s.acp.hm<-summary(lm.hm.9.acp.hm)$coefficients
hm.9.slope.acp.hm<-hm.lm.9.s.acp.hm[2,1]
lm.hm.10.acp.hm<-lm(e10.1.acp.hm$energy_over_time~as.numeric(david10.1.acp.hm$normDS))
hm.lm.10.s.acp.hm<-summary(lm.hm.10.acp.hm)$coefficients
hm.10.slope.acp.hm<-hm.lm.10.s.acp.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.acp.ss.avoid.cp.sf.hm<-data.frame(triangle.transitivity=c(tri1.acp.hm,tri2.acp.hm,tri3.acp.hm,tri4.acp.hm,tri5.acp.hm,tri6.acp.hm,tri7.acp.hm,tri8.acp.hm,tri9.acp.hm,tri10.acp.hm),escalation=c(ep1.acp.hm,ep2.acp.hm,ep3.acp.hm,ep4.acp.hm,ep5.acp.hm,ep6.acp.hm,ep7.acp.hm,ep8.acp.hm,ep9.acp.hm,ep10.acp.hm),dci=c(dci1.acp.hm,dci2.acp.hm,dci3.acp.hm,dci4.acp.hm,dci5.acp.hm,dci6.acp.hm,dci7.acp.hm,dci8.acp.hm,dci9.acp.hm,dci10.acp.hm),steepness=c(s1.acp.hm,s2.acp.hm,s3.acp.hm,s4.acp.hm,s5.acp.hm,s6.acp.hm,s7.acp.hm,s8.acp.hm,s9.acp.hm,s10.acp.hm),slope=c(hm.1.slope.acp.hm,hm.2.slope.acp.hm,hm.3.slope.acp.hm,hm.4.slope.acp.hm,hm.5.slope.acp.hm,hm.6.slope.acp.hm,hm.7.slope.acp.hm,hm.8.slope.acp.hm,hm.9.slope.acp.hm,hm.10.slope.acp.hm))
```
```{r Avoids Clumped Probabilistic Data Frame}
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#create overall dataframe of summary statistics
overall.prob.sf.clumped.avoid<-data.frame(km.acp.ss.avoid.cp.sf.km)
overall.prob.sf.clumped.avoid<-rbind(overall.prob.sf.clumped.avoid,hm.acp.ss.avoid.cp.sf.hm)

overall.prob.sf.clumped.avoid<-cbind(overall.prob.sf.clumped.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.clumped.avoid<-cbind(overall.prob.sf.clumped.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("prob",20))


rhp.ss.avoid<-overall.prob.sf.clumped.avoid[overall.prob.sf.clumped.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.sf.clumped.avoid[overall.prob.sf.clumped.avoid$variable=="history",]

overall.prob.sf.clumped.avoid$combo<-paste(overall.prob.sf.clumped.avoid$strategy,overall.prob.sf.clumped.avoid$variable,overall.prob.sf.clumped.avoid$distribution)
overall.prob.sf.clumped.avoid$combo2<-paste(overall.prob.sf.clumped.avoid$strategy,overall.prob.sf.clumped.avoid$variable)
```

## Avoids Clumped Probabilistic Data Frame
```{r}
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#create overall dataframe of summary statistics
overall.prob.sf.clump.sf.avoid<-data.frame(km.acp.ss.avoid.cp.sf.km)
overall.prob.sf.clump.sf.avoid<-rbind(overall.prob.sf.clump.sf.avoid,hm.acp.ss.avoid.cp.sf.hm)

overall.prob.sf.clump.sf.avoid<-cbind(overall.prob.sf.clump.sf.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.clump.sf.avoid<-cbind(overall.prob.sf.clump.sf.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("prob",20))


rhp.ss.avoid<-overall.prob.sf.clump.sf.avoid[overall.prob.sf.clump.sf.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.sf.clump.sf.avoid[overall.prob.sf.clump.sf.avoid$variable=="history",]

overall.prob.sf.clump.sf.avoid$combo<-paste(overall.prob.sf.clump.sf.avoid$strategy,overall.prob.sf.clump.sf.avoid$variable,overall.prob.sf.clump.sf.avoid$distribution)
overall.prob.sf.clump.sf.avoid$combo2<-paste(overall.prob.sf.clump.sf.avoid$strategy,overall.prob.sf.clump.sf.avoid$variable)
```
```{r Avoids Clumped Probabilistic Data Frame}
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.sf.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.sf.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,hm.mean.acp.avoid)

#create overall dataframe of summary statistics
overall.prob.sf.clumped.avoid<-data.frame(km.acp.ss.avoid.cp.sf.km)
overall.prob.sf.clumped.avoid<-rbind(overall.prob.sf.clumped.avoid,hm.acp.ss.avoid.cp.sf.hm)

overall.prob.sf.clumped.avoid<-cbind(overall.prob.sf.clumped.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.clumped.avoid<-cbind(overall.prob.sf.clumped.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("prob",20))


rhp.ss.avoid<-overall.prob.sf.clumped.avoid[overall.prob.sf.clumped.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.sf.clumped.avoid[overall.prob.sf.clumped.avoid$variable=="history",]

overall.prob.sf.clumped.avoid$combo<-paste(overall.prob.sf.clumped.avoid$strategy,overall.prob.sf.clumped.avoid$variable,overall.prob.sf.clumped.avoid$distribution)
overall.prob.sf.clumped.avoid$combo2<-paste(overall.prob.sf.clumped.avoid$strategy,overall.prob.sf.clumped.avoid$variable)
```

## Attacks Clumped Probabilistic Data
```{r}
#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.km<-sapply(files, read.csv)

# Generate attacks.atcp.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.km<-data.frame(X1=attacks.atcp.km[[1]],X2=attacks.atcp.km[[2]],Victories=attacks.atcp.km[[3]])
mat1.atcp.km<-inter.mat(mut1.atcp.km)
tri1.atcp.km<-tr.tri(mat1.atcp.km)
dci1.atcp.km<-DCindex(mat1.atcp.km)
mat1.atcp.km[is.na(mat1.atcp.km)] = 0
h1.atcp.km<-h.index(mat1.atcp.km)

ep1.atcp.km<-ep(mut1.atcp.km,a1.cp.sf.km)
david1.atcp.km<-DS(mat1.atcp.km) #David's Scores - for steepness use normDS output
ordrank.1.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.km<-cbind(ordrank.1.atcp.km,ds=david1.atcp.km$normDS)
lm1.atcp.km<-summary(lm(ordrank.1.atcp.km$ds~ordrank.1.atcp.km$ord.rank))
s1.atcp.km<-lm1.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.km<-data.frame(X1=attacks.atcp.km[[4]],X2=attacks.atcp.km[[5]],Victories=attacks.atcp.km[[6]])
mat2.atcp.km<-inter.mat(mut2.atcp.km)
tri2.atcp.km<-tr.tri(mat2.atcp.km)
dci2.atcp.km<-DCindex(mat2.atcp.km)
mat2.atcp.km[is.na(mat2.atcp.km)] = 0
h2.atcp.km<-h.index(mat2.atcp.km)

ep2.atcp.km<-ep(mut2.atcp.km,a2.cp.sf.km)
david2.atcp.km<-DS(mat2.atcp.km) #David's Scores - for steepness use normDS output
ordrank.2.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.km<-cbind(ordrank.2.atcp.km,ds=david2.atcp.km$normDS)
lm2.atcp.km<-summary(lm(ordrank.2.atcp.km$ds~ordrank.2.atcp.km$ord.rank))
s2.atcp.km<-lm2.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.km<-data.frame(X1=attacks.atcp.km[[7]],X2=attacks.atcp.km[[8]],Victories=attacks.atcp.km[[9]])
mat3.atcp.km<-inter.mat(mut3.atcp.km)
tri3.atcp.km<-tr.tri(mat3.atcp.km)
dci3.atcp.km<-DCindex(mat3.atcp.km)
mat3.atcp.km[is.na(mat3.atcp.km)] = 0
h3.atcp.km<-h.index(mat3.atcp.km)

ep3.atcp.km<-ep(mut3.atcp.km,a3.cp.sf.km)
david3.atcp.km<-DS(mat3.atcp.km) #David's Scores - for steepness use normDS output
ordrank.3.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.km<-cbind(ordrank.3.atcp.km,ds=david3.atcp.km$normDS)
lm3.atcp.km<-summary(lm(ordrank.3.atcp.km$ds~ordrank.3.atcp.km$ord.rank))
s3.atcp.km<-lm3.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.km<-data.frame(X1=attacks.atcp.km[[10]],X2=attacks.atcp.km[[11]],Victories=attacks.atcp.km[[12]])
mat4.atcp.km<-inter.mat(mut4.atcp.km)
tri4.atcp.km<-tr.tri(mat4.atcp.km)
dci4.atcp.km<-DCindex(mat4.atcp.km)
mat4.atcp.km[is.na(mat4.atcp.km)] = 0
h4.atcp.km<-h.index(mat4.atcp.km)

ep4.atcp.km<-ep(mut4.atcp.km,a4.cp.sf.km)
david4.atcp.km<-DS(mat4.atcp.km) #David's Scores - for steepness use normDS output
ordrank.4.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.km<-cbind(ordrank.4.atcp.km,ds=david4.atcp.km$normDS)
lm4.atcp.km<-summary(lm(ordrank.4.atcp.km$ds~ordrank.4.atcp.km$ord.rank))
s4.atcp.km<-lm4.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.km<-data.frame(X1=attacks.atcp.km[[13]],X2=attacks.atcp.km[[14]],Victories=attacks.atcp.km[[15]])
mat5.atcp.km<-inter.mat(mut5.atcp.km)
tri5.atcp.km<-tr.tri(mat5.atcp.km)
dci5.atcp.km<-DCindex(mat5.atcp.km)
mat5.atcp.km[is.na(mat5.atcp.km)] = 0
h5.atcp.km<-h.index(mat5.atcp.km)

ep5.atcp.km<-ep(mut5.atcp.km,a5.cp.sf.km)
david5.atcp.km<-DS(mat5.atcp.km) #David's Scores - for steepness use normDS output
ordrank.5.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.km<-cbind(ordrank.5.atcp.km,ds=david5.atcp.km$normDS)
lm5.atcp.km<-summary(lm(ordrank.5.atcp.km$ds~ordrank.5.atcp.km$ord.rank))
s5.atcp.km<-lm5.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.km<-data.frame(X1=attacks.atcp.km[[16]],X2=attacks.atcp.km[[17]],Victories=attacks.atcp.km[[18]])
mat6.atcp.km<-inter.mat(mut6.atcp.km)
tri6.atcp.km<-tr.tri(mat6.atcp.km)
dci6.atcp.km<-DCindex(mat6.atcp.km)
mat6.atcp.km[is.na(mat6.atcp.km)] = 0
h6.atcp.km<-h.index(mat6.atcp.km)

ep6.atcp.km<-ep(mut6.atcp.km,a6.cp.sf.km)
david6.atcp.km<-DS(mat6.atcp.km) #David's Scores - for steepness use normDS output
ordrank.6.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.km<-cbind(ordrank.6.atcp.km,ds=david6.atcp.km$normDS)
lm6.atcp.km<-summary(lm(ordrank.6.atcp.km$ds~ordrank.6.atcp.km$ord.rank))
s6.atcp.km<-lm6.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.km<-data.frame(X1=attacks.atcp.km[[19]],X2=attacks.atcp.km[[20]],Victories=attacks.atcp.km[[21]])
mat7.atcp.km<-inter.mat(mut7.atcp.km)
tri7.atcp.km<-tr.tri(mat7.atcp.km)
dci7.atcp.km<-DCindex(mat7.atcp.km)
mat7.atcp.km[is.na(mat7.atcp.km)] = 0
h7.atcp.km<-h.index(mat7.atcp.km)

ep7.atcp.km<-ep(mut7.atcp.km,a7.cp.sf.km)
david7.atcp.km<-DS(mat7.atcp.km) #David's Scores - for steepness use normDS output
ordrank.7.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.km<-cbind(ordrank.7.atcp.km,ds=david7.atcp.km$normDS)
lm7.atcp.km<-summary(lm(ordrank.7.atcp.km$ds~ordrank.7.atcp.km$ord.rank))
s7.atcp.km<-lm7.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.km<-data.frame(X1=attacks.atcp.km[[22]],X2=attacks.atcp.km[[23]],Victories=attacks.atcp.km[[24]])
mat8.atcp.km<-inter.mat(mut8.atcp.km)
tri8.atcp.km<-tr.tri(mat8.atcp.km)
dci8.atcp.km<-DCindex(mat8.atcp.km)
mat8.atcp.km[is.na(mat8.atcp.km)] = 0
h8.atcp.km<-h.index(mat8.atcp.km)

ep8.atcp.km<-ep(mut8.atcp.km,a8.cp.sf.km)
david8.atcp.km<-DS(mat8.atcp.km) #David's Scores - for steepness use normDS output
ordrank.8.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.km<-cbind(ordrank.8.atcp.km,ds=david8.atcp.km$normDS)
lm8.atcp.km<-summary(lm(ordrank.8.atcp.km$ds~ordrank.8.atcp.km$ord.rank))
s8.atcp.km<-lm8.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.km<-data.frame(X1=attacks.atcp.km[[25]],X2=attacks.atcp.km[[26]],Victories=attacks.atcp.km[[27]])
mat9.atcp.km<-inter.mat(mut9.atcp.km)
tri9.atcp.km<-tr.tri(mat9.atcp.km)
dci9.atcp.km<-DCindex(mat9.atcp.km)
mat9.atcp.km[is.na(mat9.atcp.km)] = 0
h9.atcp.km<-h.index(mat9.atcp.km)

ep9.atcp.km<-ep(mut9.atcp.km,a9.cp.sf.km)
david9.atcp.km<-DS(mat9.atcp.km) #David's Scores - for steepness use normDS output
ordrank.9.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.km<-cbind(ordrank.9.atcp.km,ds=david9.atcp.km$normDS)
lm9.atcp.km<-summary(lm(ordrank.9.atcp.km$ds~ordrank.9.atcp.km$ord.rank))
s9.atcp.km<-lm9.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.km<-data.frame(X1=attacks.atcp.km[[28]],X2=attacks.atcp.km[[29]],Victories=attacks.atcp.km[[30]])
mat10.atcp.km<-inter.mat(mut10.atcp.km)
tri10.atcp.km<-tr.tri(mat10.atcp.km)
dci10.atcp.km<-DCindex(mat10.atcp.km)
mat10.atcp.km[is.na(mat10.atcp.km)] = 0
h10.atcp.km<-h.index(mat10.atcp.km)

ep10.atcp.km<-ep(mut10.atcp.km,a10.cp.sf.km)
david10.atcp.km<-DS(mat10.atcp.km) #David's Scores - for steepness use normDS output
ordrank.10.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.km<-cbind(ordrank.10.atcp.km,ds=david10.atcp.km$normDS)
lm10.atcp.km<-summary(lm(ordrank.10.atcp.km$ds~ordrank.10.atcp.km$ord.rank))
s10.atcp.km<-lm10.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.km<-sum(mut1.atcp.km$Victories)
int2.atcp.km<-sum(mut2.atcp.km$Victories)
int3.atcp.km<-sum(mut3.atcp.km$Victories)
int4.atcp.km<-sum(mut4.atcp.km$Victories)
int5.atcp.km<-sum(mut5.atcp.km$Victories)
int6.atcp.km<-sum(mut6.atcp.km$Victories)
int7.atcp.km<-sum(mut7.atcp.km$Victories)
int8.atcp.km<-sum(mut8.atcp.km$Victories)
int9.atcp.km<-sum(mut9.atcp.km$Victories)
int10.atcp.km<-sum(mut10.atcp.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.sf.km<-sum(a1.cp.sf.km$Victories)
av2.cp.sf.km<-sum(a2.cp.sf.km$Victories)
av3.cp.sf.km<-sum(a3.cp.sf.km$Victories)
av4.cp.sf.km<-sum(a4.cp.sf.km$Victories)
av5.cp.sf.km<-sum(a5.cp.sf.km$Victories)
av6.cp.sf.km<-sum(a6.cp.sf.km$Victories)
av7.cp.sf.km<-sum(a7.cp.sf.km$Victories)
av8.cp.sf.km<-sum(a8.cp.sf.km$Victories)
av9.cp.sf.km<-sum(a9.cp.sf.km$Victories)
av10.cp.sf.km<-sum(a10.cp.sf.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.cp.sf<-(sum(av1.cp.sf.km, av2.cp.sf.km, av3.cp.sf.km, av4.cp.sf.km, av5.cp.sf.km, av6.cp.sf.km, av7.cp.sf.km, av8.cp.sf.km, av9.cp.sf.km, av10.cp.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.cp.sf<-(sum(int1.atcp.km, int2.atcp.km, int3.atcp.km, int4.atcp.km, int5.atcp.km, int6.atcp.km, int7.atcp.km, int8.atcp.km, int9.atcp.km, int10.atcp.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.km<-e1.atcp.km[order(e1.atcp.km$ID),]
e1.atcp.km<-as.matrix(t(e1.1.atcp.km))

e2.atcp.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.km<-e2.atcp.km[order(e2.atcp.km$ID),]
e2.atcp.km<-as.matrix(t(e2.1.atcp.km))

e3.atcp.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.km<-e3.atcp.km[order(e3.atcp.km$ID),]
e3.atcp.km<-as.matrix(t(e3.1.atcp.km))

e4.atcp.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.km<-e4.atcp.km[order(e4.atcp.km$ID),]
e4.atcp.km<-as.matrix(t(e4.1.atcp.km))

e5.atcp.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.km<-e5.atcp.km[order(e5.atcp.km$ID),]
e5.atcp.km<-as.matrix(t(e5.1.atcp.km))

e6.atcp.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.km<-e6.atcp.km[order(e6.atcp.km$ID),]
e6.atcp.km<-as.matrix(t(e6.1.atcp.km))

e7.atcp.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.km<-e7.atcp.km[order(e7.atcp.km$ID),]
e7.atcp.km<-as.matrix(t(e7.1.atcp.km))

e8.atcp.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.km<-e8.atcp.km[order(e8.atcp.km$ID),]
e8.atcp.km<-as.matrix(t(e8.1.atcp.km))

e9.atcp.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.km<-e9.atcp.km[order(e9.atcp.km$ID),]
e9.atcp.km<-as.matrix(t(e9.1.atcp.km))

e10.atcp.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.km<-e10.atcp.km[order(e10.atcp.km$ID),]
e10.atcp.km<-as.matrix(t(e10.1.atcp.km))

energy.km.atcp.km<-as.data.frame(matrix(c(e1.atcp.km,e2.atcp.km,e3.atcp.km,e4.atcp.km,e5.atcp.km,e6.atcp.km,e7.atcp.km,e8.atcp.km,e9.atcp.km,e10.atcp.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atcp.km<-data.frame(ID=energy.km.atcp.km$V1,energy_over_distance=energy.km.atcp.km$V2,energy_over_time=energy.km.atcp.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.km<-david1.atcp.km[order(david1.atcp.km$ID),]
david1.atcp.km<-as.matrix(t(david1.1.atcp.km))

david2.1.atcp.km<-david2.atcp.km[order(david2.atcp.km$ID),]
david2.atcp.km<-as.matrix(t(david2.1.atcp.km))

david3.1.atcp.km<-david3.atcp.km[order(david3.atcp.km$ID),]
david3.atcp.km<-as.matrix(t(david3.1.atcp.km))

david4.1.atcp.km<-david4.atcp.km[order(david4.atcp.km$ID),]
david4.atcp.km<-as.matrix(t(david4.1.atcp.km))

david5.1.atcp.km<-david5.atcp.km[order(david5.atcp.km$ID),]
david5.atcp.km<-as.matrix(t(david5.1.atcp.km))

david6.1.atcp.km<-david6.atcp.km[order(david6.atcp.km$ID),]
david6.atcp.km<-as.matrix(t(david6.1.atcp.km))

david7.1.atcp.km<-david7.atcp.km[order(david7.atcp.km$ID),]
david7.atcp.km<-as.matrix(t(david7.1.atcp.km))

david8.1.atcp.km<-david8.atcp.km[order(david8.atcp.km$ID),]
david8.atcp.km<-as.matrix(t(david8.1.atcp.km))

david9.1.atcp.km<-david9.atcp.km[order(david9.atcp.km$ID),]
david9.atcp.km<-as.matrix(t(david9.1.atcp.km))

david10.1.atcp.km<-david10.atcp.km[order(david10.atcp.km$ID),]
david10.atcp.km<-as.matrix(t(david10.1.atcp.km))

david.km.atcp.km<-as.data.frame(matrix(c(david1.atcp.km,david2.atcp.km,david3.atcp.km,david4.atcp.km,david5.atcp.km,david6.atcp.km,david7.atcp.km,david8.atcp.km,david9.atcp.km,david10.atcp.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atcp.km<-data.frame(ID=david.km.atcp.km$V1,DS=david.km.atcp.km$V2,normDS=david.km.atcp.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atcp.km<-lm(e1.1.atcp.km$energy_over_time~as.numeric(david1.1.atcp.km$normDS))
km.lm.1.s.atcp.km<-summary(lm.km.1.atcp.km)$coefficients
km.1.slope.atcp.km<-km.lm.1.s.atcp.km[2,1]
lm.km.2.atcp.km<-lm(e2.1.atcp.km$energy_over_time~as.numeric(david2.1.atcp.km$normDS))
km.lm.2.s.atcp.km<-summary(lm.km.2.atcp.km)$coefficients
km.2.slope.atcp.km<-km.lm.2.s.atcp.km[2,1]
lm.km.3.atcp.km<-lm(e3.1.atcp.km$energy_over_time~as.numeric(david3.1.atcp.km$normDS))
km.lm.3.s.atcp.km<-summary(lm.km.3.atcp.km)$coefficients
km.3.slope.atcp.km<-km.lm.3.s.atcp.km[2,1]
lm.km.4.atcp.km<-lm(e4.1.atcp.km$energy_over_time~as.numeric(david4.1.atcp.km$normDS))
km.lm.4.s.atcp.km<-summary(lm.km.4.atcp.km)$coefficients
km.4.slope.atcp.km<-km.lm.4.s.atcp.km[2,1]
lm.km.5.atcp.km<-lm(e5.1.atcp.km$energy_over_time~as.numeric(david5.1.atcp.km$normDS))
km.lm.5.s.atcp.km<-summary(lm.km.5.atcp.km)$coefficients
km.5.slope.atcp.km<-km.lm.5.s.atcp.km[2,1]
lm.km.6.atcp.km<-lm(e6.1.atcp.km$energy_over_time~as.numeric(david6.1.atcp.km$normDS))
km.lm.6.s.atcp.km<-summary(lm.km.6.atcp.km)$coefficients
km.6.slope.atcp.km<-km.lm.6.s.atcp.km[2,1]
lm.km.7.atcp.km<-lm(e7.1.atcp.km$energy_over_time~as.numeric(david7.1.atcp.km$normDS))
km.lm.7.s.atcp.km<-summary(lm.km.7.atcp.km)$coefficients
km.7.slope.atcp.km<-km.lm.7.s.atcp.km[2,1]
lm.km.8.atcp.km<-lm(e8.1.atcp.km$energy_over_time~as.numeric(david8.1.atcp.km$normDS))
km.lm.8.s.atcp.km<-summary(lm.km.8.atcp.km)$coefficients
km.8.slope.atcp.km<-km.lm.8.s.atcp.km[2,1]
lm.km.9.atcp.km<-lm(e9.1.atcp.km$energy_over_time~as.numeric(david9.1.atcp.km$normDS))
km.lm.9.s.atcp.km<-summary(lm.km.9.atcp.km)$coefficients
km.9.slope.atcp.km<-km.lm.9.s.atcp.km[2,1]
lm.km.10.atcp.km<-lm(e10.1.atcp.km$energy_over_time~as.numeric(david10.1.atcp.km$normDS))
km.lm.10.s.atcp.km<-summary(lm.km.10.atcp.km)$coefficients
km.10.slope.atcp.km<-km.lm.10.s.atcp.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atcp.ss.attacks.atcp.km<-data.frame(triangle.transitivity=c(tri1.atcp.km,tri2.atcp.km,tri3.atcp.km,tri4.atcp.km,tri5.atcp.km,tri6.atcp.km,tri7.atcp.km,tri8.atcp.km,tri9.atcp.km,tri10.atcp.km),escalation=c(ep1.atcp.km,ep2.atcp.km,ep3.atcp.km,ep4.atcp.km,ep5.atcp.km,ep6.atcp.km,ep7.atcp.km,ep8.atcp.km,ep9.atcp.km,ep10.atcp.km),dci=c(dci1.atcp.km,dci2.atcp.km,dci3.atcp.km,dci4.atcp.km,dci5.atcp.km,dci6.atcp.km,dci7.atcp.km,dci8.atcp.km,dci9.atcp.km,dci10.atcp.km),steepness=c(s1.atcp.km,s2.atcp.km,s3.atcp.km,s4.atcp.km,s5.atcp.km,s6.atcp.km,s7.atcp.km,s8.atcp.km,s9.atcp.km,s10.atcp.km),slope=c(km.1.slope.atcp.km,km.2.slope.atcp.km,km.3.slope.atcp.km,km.4.slope.atcp.km,km.5.slope.atcp.km,km.6.slope.atcp.km,km.7.slope.atcp.km,km.8.slope.atcp.km,km.9.slope.atcp.km,km.10.slope.atcp.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.hm<-sapply(files, read.csv)

# Generate attacks.atcp.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.hm<-data.frame(X1=attacks.atcp.hm[[1]],X2=attacks.atcp.hm[[2]],Victories=attacks.atcp.hm[[3]])
mat1.atcp.hm<-inter.mat(mut1.atcp.hm)
tri1.atcp.hm<-tr.tri(mat1.atcp.hm)
dci1.atcp.hm<-DCindex(mat1.atcp.hm)
mat1.atcp.hm[is.na(mat1.atcp.hm)] = 0
h1.atcp.hm<-h.index(mat1.atcp.hm)

ep1.atcp.hm<-ep(mut1.atcp.hm,a1.cp.sf.hm)
david1.atcp.hm<-DS(mat1.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.1.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.hm<-cbind(ordrank.1.atcp.hm,ds=david1.atcp.hm$normDS)
lm1.atcp.hm<-summary(lm(ordrank.1.atcp.hm$ds~ordrank.1.atcp.hm$ord.rank))
s1.atcp.hm<-lm1.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.hm<-data.frame(X1=attacks.atcp.hm[[4]],X2=attacks.atcp.hm[[5]],Victories=attacks.atcp.hm[[6]])
mat2.atcp.hm<-inter.mat(mut2.atcp.hm)
tri2.atcp.hm<-tr.tri(mat2.atcp.hm)
dci2.atcp.hm<-DCindex(mat2.atcp.hm)
mat2.atcp.hm[is.na(mat2.atcp.hm)] = 0
h2.atcp.hm<-h.index(mat2.atcp.hm)

ep2.atcp.hm<-ep(mut2.atcp.hm,a2.cp.sf.hm)
david2.atcp.hm<-DS(mat2.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.2.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.hm<-cbind(ordrank.2.atcp.hm,ds=david2.atcp.hm$normDS)
lm2.atcp.hm<-summary(lm(ordrank.2.atcp.hm$ds~ordrank.2.atcp.hm$ord.rank))
s2.atcp.hm<-lm2.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.hm<-data.frame(X1=attacks.atcp.hm[[7]],X2=attacks.atcp.hm[[8]],Victories=attacks.atcp.hm[[9]])
mat3.atcp.hm<-inter.mat(mut3.atcp.hm)
tri3.atcp.hm<-tr.tri(mat3.atcp.hm)
dci3.atcp.hm<-DCindex(mat3.atcp.hm)
mat3.atcp.hm[is.na(mat3.atcp.hm)] = 0
h3.atcp.hm<-h.index(mat3.atcp.hm)

ep3.atcp.hm<-ep(mut3.atcp.hm,a3.cp.sf.hm)
david3.atcp.hm<-DS(mat3.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.3.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.hm<-cbind(ordrank.3.atcp.hm,ds=david3.atcp.hm$normDS)
lm3.atcp.hm<-summary(lm(ordrank.3.atcp.hm$ds~ordrank.3.atcp.hm$ord.rank))
s3.atcp.hm<-lm3.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.hm<-data.frame(X1=attacks.atcp.hm[[10]],X2=attacks.atcp.hm[[11]],Victories=attacks.atcp.hm[[12]])
mat4.atcp.hm<-inter.mat(mut4.atcp.hm)
tri4.atcp.hm<-tr.tri(mat4.atcp.hm)
dci4.atcp.hm<-DCindex(mat4.atcp.hm)
mat4.atcp.hm[is.na(mat4.atcp.hm)] = 0
h4.atcp.hm<-h.index(mat4.atcp.hm)

ep4.atcp.hm<-ep(mut4.atcp.hm,a4.cp.sf.hm)
david4.atcp.hm<-DS(mat4.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.4.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.hm<-cbind(ordrank.4.atcp.hm,ds=david4.atcp.hm$normDS)
lm4.atcp.hm<-summary(lm(ordrank.4.atcp.hm$ds~ordrank.4.atcp.hm$ord.rank))
s4.atcp.hm<-lm4.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.hm<-data.frame(X1=attacks.atcp.hm[[13]],X2=attacks.atcp.hm[[14]],Victories=attacks.atcp.hm[[15]])
mat5.atcp.hm<-inter.mat(mut5.atcp.hm)
tri5.atcp.hm<-tr.tri(mat5.atcp.hm)
dci5.atcp.hm<-DCindex(mat5.atcp.hm)
mat5.atcp.hm[is.na(mat5.atcp.hm)] = 0
h5.atcp.hm<-h.index(mat5.atcp.hm)

ep5.atcp.hm<-ep(mut5.atcp.hm,a5.cp.sf.hm)
david5.atcp.hm<-DS(mat5.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.5.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.hm<-cbind(ordrank.5.atcp.hm,ds=david5.atcp.hm$normDS)
lm5.atcp.hm<-summary(lm(ordrank.5.atcp.hm$ds~ordrank.5.atcp.hm$ord.rank))
s5.atcp.hm<-lm5.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.hm<-data.frame(X1=attacks.atcp.hm[[16]],X2=attacks.atcp.hm[[17]],Victories=attacks.atcp.hm[[18]])
mat6.atcp.hm<-inter.mat(mut6.atcp.hm)
tri6.atcp.hm<-tr.tri(mat6.atcp.hm)
dci6.atcp.hm<-DCindex(mat6.atcp.hm)
mat6.atcp.hm[is.na(mat6.atcp.hm)] = 0
h6.atcp.hm<-h.index(mat6.atcp.hm)

ep6.atcp.hm<-ep(mut6.atcp.hm,a6.cp.sf.hm)
david6.atcp.hm<-DS(mat6.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.6.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.hm<-cbind(ordrank.6.atcp.hm,ds=david6.atcp.hm$normDS)
lm6.atcp.hm<-summary(lm(ordrank.6.atcp.hm$ds~ordrank.6.atcp.hm$ord.rank))
s6.atcp.hm<-lm6.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.hm<-data.frame(X1=attacks.atcp.hm[[19]],X2=attacks.atcp.hm[[20]],Victories=attacks.atcp.hm[[21]])
mat7.atcp.hm<-inter.mat(mut7.atcp.hm)
tri7.atcp.hm<-tr.tri(mat7.atcp.hm)
dci7.atcp.hm<-DCindex(mat7.atcp.hm)
mat7.atcp.hm[is.na(mat7.atcp.hm)] = 0
h7.atcp.hm<-h.index(mat7.atcp.hm)

ep7.atcp.hm<-ep(mut7.atcp.hm,a7.cp.sf.hm)
david7.atcp.hm<-DS(mat7.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.7.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.hm<-cbind(ordrank.7.atcp.hm,ds=david7.atcp.hm$normDS)
lm7.atcp.hm<-summary(lm(ordrank.7.atcp.hm$ds~ordrank.7.atcp.hm$ord.rank))
s7.atcp.hm<-lm7.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.hm<-data.frame(X1=attacks.atcp.hm[[22]],X2=attacks.atcp.hm[[23]],Victories=attacks.atcp.hm[[24]])
mat8.atcp.hm<-inter.mat(mut8.atcp.hm)
tri8.atcp.hm<-tr.tri(mat8.atcp.hm)
dci8.atcp.hm<-DCindex(mat8.atcp.hm)
mat8.atcp.hm[is.na(mat8.atcp.hm)] = 0
h8.atcp.hm<-h.index(mat8.atcp.hm)

ep8.atcp.hm<-ep(mut8.atcp.hm,a8.cp.sf.hm)
david8.atcp.hm<-DS(mat8.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.8.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.hm<-cbind(ordrank.8.atcp.hm,ds=david8.atcp.hm$normDS)
lm8.atcp.hm<-summary(lm(ordrank.8.atcp.hm$ds~ordrank.8.atcp.hm$ord.rank))
s8.atcp.hm<-lm8.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.hm<-data.frame(X1=attacks.atcp.hm[[25]],X2=attacks.atcp.hm[[26]],Victories=attacks.atcp.hm[[27]])
mat9.atcp.hm<-inter.mat(mut9.atcp.hm)
tri9.atcp.hm<-tr.tri(mat9.atcp.hm)
dci9.atcp.hm<-DCindex(mat9.atcp.hm)
mat9.atcp.hm[is.na(mat9.atcp.hm)] = 0
h9.atcp.hm<-h.index(mat9.atcp.hm)

ep9.atcp.hm<-ep(mut9.atcp.hm,a9.cp.sf.hm)
david9.atcp.hm<-DS(mat9.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.9.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.hm<-cbind(ordrank.9.atcp.hm,ds=david9.atcp.hm$normDS)
lm9.atcp.hm<-summary(lm(ordrank.9.atcp.hm$ds~ordrank.9.atcp.hm$ord.rank))
s9.atcp.hm<-lm9.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.hm<-data.frame(X1=attacks.atcp.hm[[28]],X2=attacks.atcp.hm[[29]],Victories=attacks.atcp.hm[[30]])
mat10.atcp.hm<-inter.mat(mut10.atcp.hm)
tri10.atcp.hm<-tr.tri(mat10.atcp.hm)
dci10.atcp.hm<-DCindex(mat10.atcp.hm)
mat10.atcp.hm[is.na(mat10.atcp.hm)] = 0
h10.atcp.hm<-h.index(mat10.atcp.hm)

ep10.atcp.hm<-ep(mut10.atcp.hm,a10.cp.sf.hm)
david10.atcp.hm<-DS(mat10.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.10.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.hm<-cbind(ordrank.10.atcp.hm,ds=david10.atcp.hm$normDS)
lm10.atcp.hm<-summary(lm(ordrank.10.atcp.hm$ds~ordrank.10.atcp.hm$ord.rank))
s10.atcp.hm<-lm10.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.hm<-sum(mut1.atcp.hm$Victories)
int2.atcp.hm<-sum(mut2.atcp.hm$Victories)
int3.atcp.hm<-sum(mut3.atcp.hm$Victories)
int4.atcp.hm<-sum(mut4.atcp.hm$Victories)
int5.atcp.hm<-sum(mut5.atcp.hm$Victories)
int6.atcp.hm<-sum(mut6.atcp.hm$Victories)
int7.atcp.hm<-sum(mut7.atcp.hm$Victories)
int8.atcp.hm<-sum(mut8.atcp.hm$Victories)
int9.atcp.hm<-sum(mut9.atcp.hm$Victories)
int10.atcp.hm<-sum(mut10.atcp.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.sf.hm<-sum(a1.cp.sf.hm$Victories)
av2.cp.sf.hm<-sum(a2.cp.sf.hm$Victories)
av3.cp.sf.hm<-sum(a3.cp.sf.hm$Victories)
av4.cp.sf.hm<-sum(a4.cp.sf.hm$Victories)
av5.cp.sf.hm<-sum(a5.cp.sf.hm$Victories)
av6.cp.sf.hm<-sum(a6.cp.sf.hm$Victories)
av7.cp.sf.hm<-sum(a7.cp.sf.hm$Victories)
av8.cp.sf.hm<-sum(a8.cp.sf.hm$Victories)
av9.cp.sf.hm<-sum(a9.cp.sf.hm$Victories)
av10.cp.sf.hm<-sum(a10.cp.sf.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.cp.sf<-(sum(av1.cp.sf.hm, av2.cp.sf.hm, av3.cp.sf.hm, av4.cp.sf.hm, av5.cp.sf.hm, av6.cp.sf.hm, av7.cp.sf.hm, av8.cp.sf.hm, av9.cp.sf.hm, av10.cp.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.cp.sf<-(sum(int1.atcp.hm, int2.atcp.hm, int3.atcp.hm, int4.atcp.hm, int5.atcp.hm, int6.atcp.hm, int7.atcp.hm, int8.atcp.hm, int9.atcp.hm, int10.atcp.hm))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.hm<-e1.atcp.hm[order(e1.atcp.hm$ID),]
e1.atcp.hm<-as.matrix(t(e1.1.atcp.hm))

e2.atcp.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.hm<-e2.atcp.hm[order(e2.atcp.hm$ID),]
e2.atcp.hm<-as.matrix(t(e2.1.atcp.hm))

e3.atcp.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.hm<-e3.atcp.hm[order(e3.atcp.hm$ID),]
e3.atcp.hm<-as.matrix(t(e3.1.atcp.hm))

e4.atcp.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.hm<-e4.atcp.hm[order(e4.atcp.hm$ID),]
e4.atcp.hm<-as.matrix(t(e4.1.atcp.hm))

e5.atcp.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.hm<-e5.atcp.hm[order(e5.atcp.hm$ID),]
e5.atcp.hm<-as.matrix(t(e5.1.atcp.hm))

e6.atcp.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.hm<-e6.atcp.hm[order(e6.atcp.hm$ID),]
e6.atcp.hm<-as.matrix(t(e6.1.atcp.hm))

e7.atcp.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.hm<-e7.atcp.hm[order(e7.atcp.hm$ID),]
e7.atcp.hm<-as.matrix(t(e7.1.atcp.hm))

e8.atcp.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.hm<-e8.atcp.hm[order(e8.atcp.hm$ID),]
e8.atcp.hm<-as.matrix(t(e8.1.atcp.hm))

e9.atcp.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.hm<-e9.atcp.hm[order(e9.atcp.hm$ID),]
e9.atcp.hm<-as.matrix(t(e9.1.atcp.hm))

e10.atcp.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.hm<-e10.atcp.hm[order(e10.atcp.hm$ID),]
e10.atcp.hm<-as.matrix(t(e10.1.atcp.hm))

energy.hm.atcp.hm<-as.data.frame(matrix(c(e1.atcp.hm,e2.atcp.hm,e3.atcp.hm,e4.atcp.hm,e5.atcp.hm,e6.atcp.hm,e7.atcp.hm,e8.atcp.hm,e9.atcp.hm,e10.atcp.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atcp.hm<-data.frame(ID=energy.hm.atcp.hm$V1,energy_over_distance=energy.hm.atcp.hm$V2,energy_over_time=energy.hm.atcp.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.hm<-david1.atcp.hm[order(david1.atcp.hm$ID),]
david1.atcp.hm<-as.matrix(t(david1.1.atcp.hm))

david2.1.atcp.hm<-david2.atcp.hm[order(david2.atcp.hm$ID),]
david2.atcp.hm<-as.matrix(t(david2.1.atcp.hm))

david3.1.atcp.hm<-david3.atcp.hm[order(david3.atcp.hm$ID),]
david3.atcp.hm<-as.matrix(t(david3.1.atcp.hm))

david4.1.atcp.hm<-david4.atcp.hm[order(david4.atcp.hm$ID),]
david4.atcp.hm<-as.matrix(t(david4.1.atcp.hm))

david5.1.atcp.hm<-david5.atcp.hm[order(david5.atcp.hm$ID),]
david5.atcp.hm<-as.matrix(t(david5.1.atcp.hm))

david6.1.atcp.hm<-david6.atcp.hm[order(david6.atcp.hm$ID),]
david6.atcp.hm<-as.matrix(t(david6.1.atcp.hm))

david7.1.atcp.hm<-david7.atcp.hm[order(david7.atcp.hm$ID),]
david7.atcp.hm<-as.matrix(t(david7.1.atcp.hm))

david8.1.atcp.hm<-david8.atcp.hm[order(david8.atcp.hm$ID),]
david8.atcp.hm<-as.matrix(t(david8.1.atcp.hm))

david9.1.atcp.hm<-david9.atcp.hm[order(david9.atcp.hm$ID),]
david9.atcp.hm<-as.matrix(t(david9.1.atcp.hm))

david10.1.atcp.hm<-david10.atcp.hm[order(david10.atcp.hm$ID),]
david10.atcp.hm<-as.matrix(t(david10.1.atcp.hm))

david.hm.atcp.hm<-as.data.frame(matrix(c(david1.atcp.hm,david2.atcp.hm,david3.atcp.hm,david4.atcp.hm,david5.atcp.hm,david6.atcp.hm,david7.atcp.hm,david8.atcp.hm,david9.atcp.hm,david10.atcp.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atcp.hm<-data.frame(ID=david.hm.atcp.hm$V1,DS=david.hm.atcp.hm$V2,normDS=david.hm.atcp.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atcp.hm<-lm(e1.1.atcp.hm$energy_over_time~as.numeric(david1.1.atcp.hm$normDS))
hm.lm.1.s.atcp.hm<-summary(lm.hm.1.atcp.hm)$coefficients
hm.1.slope.atcp.hm<-hm.lm.1.s.atcp.hm[2,1]
lm.hm.2.atcp.hm<-lm(e2.1.atcp.hm$energy_over_time~as.numeric(david2.1.atcp.hm$normDS))
hm.lm.2.s.atcp.hm<-summary(lm.hm.2.atcp.hm)$coefficients
hm.2.slope.atcp.hm<-hm.lm.2.s.atcp.hm[2,1]
lm.hm.3.atcp.hm<-lm(e3.1.atcp.hm$energy_over_time~as.numeric(david3.1.atcp.hm$normDS))
hm.lm.3.s.atcp.hm<-summary(lm.hm.3.atcp.hm)$coefficients
hm.3.slope.atcp.hm<-hm.lm.3.s.atcp.hm[2,1]
lm.hm.4.atcp.hm<-lm(e4.1.atcp.hm$energy_over_time~as.numeric(david4.1.atcp.hm$normDS))
hm.lm.4.s.atcp.hm<-summary(lm.hm.4.atcp.hm)$coefficients
hm.4.slope.atcp.hm<-hm.lm.4.s.atcp.hm[2,1]
lm.hm.5.atcp.hm<-lm(e5.1.atcp.hm$energy_over_time~as.numeric(david5.1.atcp.hm$normDS))
hm.lm.5.s.atcp.hm<-summary(lm.hm.5.atcp.hm)$coefficients
hm.5.slope.atcp.hm<-hm.lm.5.s.atcp.hm[2,1]
lm.hm.6.atcp.hm<-lm(e6.1.atcp.hm$energy_over_time~as.numeric(david6.1.atcp.hm$normDS))
hm.lm.6.s.atcp.hm<-summary(lm.hm.6.atcp.hm)$coefficients
hm.6.slope.atcp.hm<-hm.lm.6.s.atcp.hm[2,1]
lm.hm.7.atcp.hm<-lm(e7.1.atcp.hm$energy_over_time~as.numeric(david7.1.atcp.hm$normDS))
hm.lm.7.s.atcp.hm<-summary(lm.hm.7.atcp.hm)$coefficients
hm.7.slope.atcp.hm<-hm.lm.7.s.atcp.hm[2,1]
lm.hm.8.atcp.hm<-lm(e8.1.atcp.hm$energy_over_time~as.numeric(david8.1.atcp.hm$normDS))
hm.lm.8.s.atcp.hm<-summary(lm.hm.8.atcp.hm)$coefficients
hm.8.slope.atcp.hm<-hm.lm.8.s.atcp.hm[2,1]
lm.hm.9.atcp.hm<-lm(e9.1.atcp.hm$energy_over_time~as.numeric(david9.1.atcp.hm$normDS))
hm.lm.9.s.atcp.hm<-summary(lm.hm.9.atcp.hm)$coefficients
hm.9.slope.atcp.hm<-hm.lm.9.s.atcp.hm[2,1]
lm.hm.10.atcp.hm<-lm(e10.1.atcp.hm$energy_over_time~as.numeric(david10.1.atcp.hm$normDS))
hm.lm.10.s.atcp.hm<-summary(lm.hm.10.atcp.hm)$coefficients
hm.10.slope.atcp.hm<-hm.lm.10.s.atcp.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atcp.ss.attacks.atcp.hm<-data.frame(triangle.transitivity=c(tri1.atcp.hm,tri2.atcp.hm,tri3.atcp.hm,tri4.atcp.hm,tri5.atcp.hm,tri6.atcp.hm,tri7.atcp.hm,tri8.atcp.hm,tri9.atcp.hm,tri10.atcp.hm),escalation=c(ep1.atcp.hm,ep2.atcp.hm,ep3.atcp.hm,ep4.atcp.hm,ep5.atcp.hm,ep6.atcp.hm,ep7.atcp.hm,ep8.atcp.hm,ep9.atcp.hm,ep10.atcp.hm),dci=c(dci1.atcp.hm,dci2.atcp.hm,dci3.atcp.hm,dci4.atcp.hm,dci5.atcp.hm,dci6.atcp.hm,dci7.atcp.hm,dci8.atcp.hm,dci9.atcp.hm,dci10.atcp.hm),steepness=c(s1.atcp.hm,s2.atcp.hm,s3.atcp.hm,s4.atcp.hm,s5.atcp.hm,s6.atcp.hm,s7.atcp.hm,s8.atcp.hm,s9.atcp.hm,s10.atcp.hm),slope=c(hm.1.slope.atcp.hm,hm.2.slope.atcp.hm,hm.3.slope.atcp.hm,hm.4.slope.atcp.hm,hm.5.slope.atcp.hm,hm.6.slope.atcp.hm,hm.7.slope.atcp.hm,hm.8.slope.atcp.hm,hm.9.slope.atcp.hm,hm.10.slope.atcp.hm))
```
```{r}
#knowledge mutual
km.tt.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$triangle.transitivity)
km.dc.sfi.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$dci)
km.esc.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$escalation)
km.steep.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$steepness)
km.slope.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$slope)
km.mean.cp.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.cp.sf.attacks,dci=km.dc.sfi.cp.sf.attacks,esc=km.esc.cp.sf.attacks,steepness=km.steep.cp.sf.attacks,slope=km.slope.cp.sf.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$triangle.transitivity)
hm.dc.sfi.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$dci)
hm.esc.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$escalation)
hm.steep.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$steepness)
hm.slope.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$slope)
hm.mean.cp.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.cp.sf.attacks,dci=hm.dc.sfi.cp.sf.attacks,esc=hm.esc.cp.sf.attacks,steepness=hm.steep.cp.sf.attacks,slope=hm.slope.cp.sf.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.cp.sf.attacks,hm.mean.cp.sf.attacks)


#calculate means of each scenario data frame
#knowledge mutual
km.tt.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$triangle.transitivity)
km.dc.sfi.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$dci)
km.esc.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$escalation)
km.steep.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$steepness)
km.slope.cp.sf.attacks<-mean(km.atcp.ss.attacks.atcp.km$slope)
km.mean.cp.sf.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.cp.sf.attacks,dci=km.dc.sfi.cp.sf.attacks,esc=km.esc.cp.sf.attacks,steepness=km.steep.cp.sf.attacks,slope=km.slope.cp.sf.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$triangle.transitivity)
hm.dc.sfi.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$dci)
hm.esc.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$escalation)
hm.steep.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$steepness)
hm.slope.cp.sf.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$slope)
hm.mean.cp.sf.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.cp.sf.attacks,dci=hm.dc.sfi.cp.sf.attacks,esc=hm.esc.cp.sf.attacks,steepness=hm.steep.cp.sf.attacks,slope=hm.slope.cp.sf.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.cp.sf.attacks,hm.mean.cp.sf.attacks)


#create overall dataframe of summary statistics
overall.prob.sf.clump.sf.attacks<-data.frame(km.atcp.ss.attacks.atcp.km)
overall.prob.sf.clump.sf.attacks<-rbind(overall.prob.sf.clump.sf.attacks,hm.atcp.ss.attacks.atcp.hm)


overall.prob.sf.clump.sf.attacks<-cbind(overall.prob.sf.clump.sf.attacks,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.clump.sf.attacks<-cbind(overall.prob.sf.clump.sf.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("clumped",20),calc=rep("prob",20))


rhp.ss.attacks<-overall.prob.sf.clump.sf.attacks[overall.prob.sf.clump.sf.attacks$variable=="rhp",]
history.ss.attacks<-overall.prob.sf.clump.sf.attacks[overall.prob.sf.clump.sf.attacks$variable=="history",]

overall.prob.sf.clump.sf.attacks$combo<-paste(overall.prob.sf.clump.sf.attacks$strategy,overall.prob.sf.clump.sf.attacks$variable,overall.prob.sf.clump.sf.attacks$distribution)
overall.prob.sf.clump.sf.attacks$combo2<-paste(overall.prob.sf.clump.sf.attacks$strategy,overall.prob.sf.clump.sf.attacks$variable)
```

## Uniform Probabilistic Data
```{r Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.sf.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.sf.km<-data.frame(X1=avoid.up.sf.km[[1]],X2=avoid.up.sf.km[[2]],Avoids=avoid.up.sf.km[[3]])
a2.up.sf.km<-data.frame(X1=avoid.up.sf.km[[4]],X2=avoid.up.sf.km[[5]],Avoids=avoid.up.sf.km[[6]])
a3.up.sf.km<-data.frame(X1=avoid.up.sf.km[[7]],X2=avoid.up.sf.km[[8]],Avoids=avoid.up.sf.km[[9]])
a4.up.sf.km<-data.frame(X1=avoid.up.sf.km[[10]],X2=avoid.up.sf.km[[11]],Avoids=avoid.up.sf.km[[12]])
a5.up.sf.km<-data.frame(X1=avoid.up.sf.km[[13]],X2=avoid.up.sf.km[[14]],Avoids=avoid.up.sf.km[[15]])
a6.up.sf.km<-data.frame(X1=avoid.up.sf.km[[16]],X2=avoid.up.sf.km[[17]],Avoids=avoid.up.sf.km[[18]])
a7.up.sf.km<-data.frame(X1=avoid.up.sf.km[[19]],X2=avoid.up.sf.km[[20]],Avoids=avoid.up.sf.km[[21]])
a8.up.sf.km<-data.frame(X1=avoid.up.sf.km[[22]],X2=avoid.up.sf.km[[23]],Avoids=avoid.up.sf.km[[24]])
a9.up.sf.km<-data.frame(X1=avoid.up.sf.km[[25]],X2=avoid.up.sf.km[[26]],Avoids=avoid.up.sf.km[[27]])
a10.up.sf.km<-data.frame(X1=avoid.up.sf.km[[28]],X2=avoid.up.sf.km[[29]],Avoids=avoid.up.sf.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.km.up.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.sf.km<-data.frame(X1=conflict.km.up.sf[[1]],X2=conflict.km.up.sf[[2]],Victories=conflict.km.up.sf[[3]])
mat1.up.sf.km<-inter.mat(mut1.up.sf.km)
tri1.up.sf.km<-tr.tri(mat1.up.sf.km)
dci1.up.sf.km<-DCindex(mat1.up.sf.km)
mat1.up.sf.km[is.na(mat1.up.sf.km)] = 0
h1.up.sf.km<-h.index(mat1.up.sf.km)

ep1.up.sf.km<-ep(mut1.up.sf.km,a1.up.sf.km)
david1.up.sf.km<-DS(mat1.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.1.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.sf.km<-cbind(ordrank.1.up.sf.km,ds=david1.up.sf.km$normDS)
lm1.up.sf.km<-summary(lm(ordrank.1.up.sf.km$ds~ordrank.1.up.sf.km$ord.rank))
s1.up.sf.km<-lm1.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.sf.km<-data.frame(X1=conflict.km.up.sf[[4]],X2=conflict.km.up.sf[[5]],Victories=conflict.km.up.sf[[6]])
mat2.up.sf.km<-inter.mat(mut2.up.sf.km)
tri2.up.sf.km<-tr.tri(mat2.up.sf.km)
dci2.up.sf.km<-DCindex(mat2.up.sf.km)
mat2.up.sf.km[is.na(mat2.up.sf.km)] = 0
h2.up.sf.km<-h.index(mat2.up.sf.km)

ep2.up.sf.km<-ep(mut2.up.sf.km,a2.up.sf.km)
david2.up.sf.km<-DS(mat2.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.2.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.sf.km<-cbind(ordrank.2.up.sf.km,ds=david2.up.sf.km$normDS)
lm2.up.sf.km<-summary(lm(ordrank.2.up.sf.km$ds~ordrank.2.up.sf.km$ord.rank))
s2.up.sf.km<-lm2.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.sf.km<-data.frame(X1=conflict.km.up.sf[[7]],X2=conflict.km.up.sf[[8]],Victories=conflict.km.up.sf[[9]])
mat3.up.sf.km<-inter.mat(mut3.up.sf.km)
tri3.up.sf.km<-tr.tri(mat3.up.sf.km)
dci3.up.sf.km<-DCindex(mat3.up.sf.km)
mat3.up.sf.km[is.na(mat3.up.sf.km)] = 0
h3.up.sf.km<-h.index(mat3.up.sf.km)

ep3.up.sf.km<-ep(mut3.up.sf.km,a3.up.sf.km)
david3.up.sf.km<-DS(mat3.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.3.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.sf.km<-cbind(ordrank.3.up.sf.km,ds=david3.up.sf.km$normDS)
lm3.up.sf.km<-summary(lm(ordrank.3.up.sf.km$ds~ordrank.3.up.sf.km$ord.rank))
s3.up.sf.km<-lm3.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.sf.km<-data.frame(X1=conflict.km.up.sf[[10]],X2=conflict.km.up.sf[[11]],Victories=conflict.km.up.sf[[12]])
mat4.up.sf.km<-inter.mat(mut4.up.sf.km)
tri4.up.sf.km<-tr.tri(mat4.up.sf.km)
dci4.up.sf.km<-DCindex(mat4.up.sf.km)
mat4.up.sf.km[is.na(mat4.up.sf.km)] = 0
h4.up.sf.km<-h.index(mat4.up.sf.km)

ep4.up.sf.km<-ep(mut4.up.sf.km,a4.up.sf.km)
david4.up.sf.km<-DS(mat4.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.4.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.sf.km<-cbind(ordrank.4.up.sf.km,ds=david4.up.sf.km$normDS)
lm4.up.sf.km<-summary(lm(ordrank.4.up.sf.km$ds~ordrank.4.up.sf.km$ord.rank))
s4.up.sf.km<-lm4.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.sf.km<-data.frame(X1=conflict.km.up.sf[[13]],X2=conflict.km.up.sf[[14]],Victories=conflict.km.up.sf[[15]])
mat5.up.sf.km<-inter.mat(mut5.up.sf.km)
tri5.up.sf.km<-tr.tri(mat5.up.sf.km)
dci5.up.sf.km<-DCindex(mat5.up.sf.km)
mat5.up.sf.km[is.na(mat5.up.sf.km)] = 0
h5.up.sf.km<-h.index(mat5.up.sf.km)

ep5.up.sf.km<-ep(mut5.up.sf.km,a5.up.sf.km)
david5.up.sf.km<-DS(mat5.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.5.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.sf.km<-cbind(ordrank.5.up.sf.km,ds=david5.up.sf.km$normDS)
lm5.up.sf.km<-summary(lm(ordrank.5.up.sf.km$ds~ordrank.5.up.sf.km$ord.rank))
s5.up.sf.km<-lm5.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.sf.km<-data.frame(X1=conflict.km.up.sf[[16]],X2=conflict.km.up.sf[[17]],Victories=conflict.km.up.sf[[18]])
mat6.up.sf.km<-inter.mat(mut6.up.sf.km)
tri6.up.sf.km<-tr.tri(mat6.up.sf.km)
dci6.up.sf.km<-DCindex(mat6.up.sf.km)
mat6.up.sf.km[is.na(mat6.up.sf.km)] = 0
h6.up.sf.km<-h.index(mat6.up.sf.km)

ep6.up.sf.km<-ep(mut6.up.sf.km,a6.up.sf.km)
david6.up.sf.km<-DS(mat6.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.6.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.sf.km<-cbind(ordrank.6.up.sf.km,ds=david6.up.sf.km$normDS)
lm6.up.sf.km<-summary(lm(ordrank.6.up.sf.km$ds~ordrank.6.up.sf.km$ord.rank))
s6.up.sf.km<-lm6.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.sf.km<-data.frame(X1=conflict.km.up.sf[[19]],X2=conflict.km.up.sf[[20]],Victories=conflict.km.up.sf[[21]])
mat7.up.sf.km<-inter.mat(mut7.up.sf.km)
tri7.up.sf.km<-tr.tri(mat7.up.sf.km)
dci7.up.sf.km<-DCindex(mat7.up.sf.km)
mat7.up.sf.km[is.na(mat7.up.sf.km)] = 0
h7.up.sf.km<-h.index(mat7.up.sf.km)

ep7.up.sf.km<-ep(mut7.up.sf.km,a7.up.sf.km)
david7.up.sf.km<-DS(mat7.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.7.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.sf.km<-cbind(ordrank.7.up.sf.km,ds=david7.up.sf.km$normDS)
lm7.up.sf.km<-summary(lm(ordrank.7.up.sf.km$ds~ordrank.7.up.sf.km$ord.rank))
s7.up.sf.km<-lm7.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.sf.km<-data.frame(X1=conflict.km.up.sf[[22]],X2=conflict.km.up.sf[[23]],Victories=conflict.km.up.sf[[24]])
mat8.up.sf.km<-inter.mat(mut8.up.sf.km)
tri8.up.sf.km<-tr.tri(mat8.up.sf.km)
dci8.up.sf.km<-DCindex(mat8.up.sf.km)
mat8.up.sf.km[is.na(mat8.up.sf.km)] = 0
h8.up.sf.km<-h.index(mat8.up.sf.km)

ep8.up.sf.km<-ep(mut8.up.sf.km,a8.up.sf.km)
david8.up.sf.km<-DS(mat8.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.8.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.sf.km<-cbind(ordrank.8.up.sf.km,ds=david8.up.sf.km$normDS)
lm8.up.sf.km<-summary(lm(ordrank.8.up.sf.km$ds~ordrank.8.up.sf.km$ord.rank))
s8.up.sf.km<-lm8.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.sf.km<-data.frame(X1=conflict.km.up.sf[[25]],X2=conflict.km.up.sf[[26]],Victories=conflict.km.up.sf[[27]])
mat9.up.sf.km<-inter.mat(mut9.up.sf.km)
tri9.up.sf.km<-tr.tri(mat9.up.sf.km)
dci9.up.sf.km<-DCindex(mat9.up.sf.km)
mat9.up.sf.km[is.na(mat9.up.sf.km)] = 0
h9.up.sf.km<-h.index(mat9.up.sf.km)

ep9.up.sf.km<-ep(mut9.up.sf.km,a9.up.sf.km)
david9.up.sf.km<-DS(mat9.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.9.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.sf.km<-cbind(ordrank.9.up.sf.km,ds=david9.up.sf.km$normDS)
lm9.up.sf.km<-summary(lm(ordrank.9.up.sf.km$ds~ordrank.9.up.sf.km$ord.rank))
s9.up.sf.km<-lm9.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.sf.km<-data.frame(X1=conflict.km.up.sf[[28]],X2=conflict.km.up.sf[[29]],Victories=conflict.km.up.sf[[30]])
mat10.up.sf.km<-inter.mat(mut10.up.sf.km)
tri10.up.sf.km<-tr.tri(mat10.up.sf.km)
dci10.up.sf.km<-DCindex(mat10.up.sf.km)
mat10.up.sf.km[is.na(mat10.up.sf.km)] = 0
h10.up.sf.km<-h.index(mat10.up.sf.km)

ep10.up.sf.km<-ep(mut10.up.sf.km,a10.up.sf.km)
david10.up.sf.km<-DS(mat10.up.sf.km) #David's Scores - for steepness use normDS output
ordrank.10.up.sf.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.sf.km<-cbind(ordrank.10.up.sf.km,ds=david10.up.sf.km$normDS)
lm10.up.sf.km<-summary(lm(ordrank.10.up.sf.km$ds~ordrank.10.up.sf.km$ord.rank))
s10.up.sf.km<-lm10.up.sf.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.sf.km<-sum(mut1.up.sf.km$Victories)
int2.up.sf.km<-sum(mut2.up.sf.km$Victories)
int3.up.sf.km<-sum(mut3.up.sf.km$Victories)
int4.up.sf.km<-sum(mut4.up.sf.km$Victories)
int5.up.sf.km<-sum(mut5.up.sf.km$Victories)
int6.up.sf.km<-sum(mut6.up.sf.km$Victories)
int7.up.sf.km<-sum(mut7.up.sf.km$Victories)
int8.up.sf.km<-sum(mut8.up.sf.km$Victories)
int9.up.sf.km<-sum(mut9.up.sf.km$Victories)
int10.up.sf.km<-sum(mut10.up.sf.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.sf.km<-sum(a1.up.sf.km$Victories)
av2.up.sf.km<-sum(a2.up.sf.km$Victories)
av3.up.sf.km<-sum(a3.up.sf.km$Victories)
av4.up.sf.km<-sum(a4.up.sf.km$Victories)
av5.up.sf.km<-sum(a5.up.sf.km$Victories)
av6.up.sf.km<-sum(a6.up.sf.km$Victories)
av7.up.sf.km<-sum(a7.up.sf.km$Victories)
av8.up.sf.km<-sum(a8.up.sf.km$Victories)
av9.up.sf.km<-sum(a9.up.sf.km$Victories)
av10.up.sf.km<-sum(a10.up.sf.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.pu.sf<-(sum(av1.up.sf.km, av2.up.sf.km, av3.up.sf.km, av4.up.sf.km, av5.up.sf.km, av6.up.sf.km, av7.up.sf.km, av8.up.sf.km, av9.up.sf.km, av10.up.sf.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.pu.sf<-(sum(int1.up.sf.km, int2.up.sf.km, int3.up.sf.km, int4.up.sf.km, int5.up.sf.km, int6.up.sf.km, int7.up.sf.km, int8.up.sf.km, int9.up.sf.km, int10.up.sf.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.sf.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.sf.km<-e1.up.sf.km[order(e1.up.sf.km$ID),]
e1.up.sf.km<-as.matrix(t(e1.1.up.sf.km))

e2.up.sf.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.sf.km<-e2.up.sf.km[order(e2.up.sf.km$ID),]
e2.up.sf.km<-as.matrix(t(e2.1.up.sf.km))

e3.up.sf.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.sf.km<-e3.up.sf.km[order(e3.up.sf.km$ID),]
e3.up.sf.km<-as.matrix(t(e3.1.up.sf.km))

e4.up.sf.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.sf.km<-e4.up.sf.km[order(e4.up.sf.km$ID),]
e4.up.sf.km<-as.matrix(t(e4.1.up.sf.km))

e5.up.sf.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.sf.km<-e5.up.sf.km[order(e5.up.sf.km$ID),]
e5.up.sf.km<-as.matrix(t(e5.1.up.sf.km))

e6.up.sf.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.sf.km<-e6.up.sf.km[order(e6.up.sf.km$ID),]
e6.up.sf.km<-as.matrix(t(e6.1.up.sf.km))

e7.up.sf.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.sf.km<-e7.up.sf.km[order(e7.up.sf.km$ID),]
e7.up.sf.km<-as.matrix(t(e7.1.up.sf.km))

e8.up.sf.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.sf.km<-e8.up.sf.km[order(e8.up.sf.km$ID),]
e8.up.sf.km<-as.matrix(t(e8.1.up.sf.km))

e9.up.sf.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.sf.km<-e9.up.sf.km[order(e9.up.sf.km$ID),]
e9.up.sf.km<-as.matrix(t(e9.1.up.sf.km))

e10.up.sf.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.sf.km<-e10.up.sf.km[order(e10.up.sf.km$ID),]
e10.up.sf.km<-as.matrix(t(e10.1.up.sf.km))

energy.km.up.sf.km<-as.data.frame(matrix(c(e1.up.sf.km,e2.up.sf.km,e3.up.sf.km,e4.up.sf.km,e5.up.sf.km,e6.up.sf.km,e7.up.sf.km,e8.up.sf.km,e9.up.sf.km,e10.up.sf.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.up.sf.km<-data.frame(ID=energy.km.up.sf.km$V1,energy_over_distance=energy.km.up.sf.km$V2,energy_over_time=energy.km.up.sf.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.sf.km<-david1.up.sf.km[order(david1.up.sf.km$ID),]
david1.up.sf.km<-as.matrix(t(david1.1.up.sf.km))

david2.1.up.sf.km<-david2.up.sf.km[order(david2.up.sf.km$ID),]
david2.up.sf.km<-as.matrix(t(david2.1.up.sf.km))

david3.1.up.sf.km<-david3.up.sf.km[order(david3.up.sf.km$ID),]
david3.up.sf.km<-as.matrix(t(david3.1.up.sf.km))

david4.1.up.sf.km<-david4.up.sf.km[order(david4.up.sf.km$ID),]
david4.up.sf.km<-as.matrix(t(david4.1.up.sf.km))

david5.1.up.sf.km<-david5.up.sf.km[order(david5.up.sf.km$ID),]
david5.up.sf.km<-as.matrix(t(david5.1.up.sf.km))

david6.1.up.sf.km<-david6.up.sf.km[order(david6.up.sf.km$ID),]
david6.up.sf.km<-as.matrix(t(david6.1.up.sf.km))

david7.1.up.sf.km<-david7.up.sf.km[order(david7.up.sf.km$ID),]
david7.up.sf.km<-as.matrix(t(david7.1.up.sf.km))

david8.1.up.sf.km<-david8.up.sf.km[order(david8.up.sf.km$ID),]
david8.up.sf.km<-as.matrix(t(david8.1.up.sf.km))

david9.1.up.sf.km<-david9.up.sf.km[order(david9.up.sf.km$ID),]
david9.up.sf.km<-as.matrix(t(david9.1.up.sf.km))

david10.1.up.sf.km<-david10.up.sf.km[order(david10.up.sf.km$ID),]
david10.up.sf.km<-as.matrix(t(david10.1.up.sf.km))

david.km.up.sf.km<-as.data.frame(matrix(c(david1.up.sf.km,david2.up.sf.km,david3.up.sf.km,david4.up.sf.km,david5.up.sf.km,david6.up.sf.km,david7.up.sf.km,david8.up.sf.km,david9.up.sf.km,david10.up.sf.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.up.sf.km<-data.frame(ID=david.km.up.sf.km$V1,DS=david.km.up.sf.km$V2,normDS=david.km.up.sf.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.up.sf.km<-lm(e1.1.up.sf.km$energy_over_time~as.numeric(david1.1.up.sf.km$normDS))
km.lm.1.s.up.sf.km<-summary(lm.km.1.up.sf.km)$coefficients
km.1.slope.up.sf.km<-km.lm.1.s.up.sf.km[2,1]
lm.km.2.up.sf.km<-lm(e2.1.up.sf.km$energy_over_time~as.numeric(david2.1.up.sf.km$normDS))
km.lm.2.s.up.sf.km<-summary(lm.km.2.up.sf.km)$coefficients
km.2.slope.up.sf.km<-km.lm.2.s.up.sf.km[2,1]
lm.km.3.up.sf.km<-lm(e3.1.up.sf.km$energy_over_time~as.numeric(david3.1.up.sf.km$normDS))
km.lm.3.s.up.sf.km<-summary(lm.km.3.up.sf.km)$coefficients
km.3.slope.up.sf.km<-km.lm.3.s.up.sf.km[2,1]
lm.km.4.up.sf.km<-lm(e4.1.up.sf.km$energy_over_time~as.numeric(david4.1.up.sf.km$normDS))
km.lm.4.s.up.sf.km<-summary(lm.km.4.up.sf.km)$coefficients
km.4.slope.up.sf.km<-km.lm.4.s.up.sf.km[2,1]
lm.km.5.up.sf.km<-lm(e5.1.up.sf.km$energy_over_time~as.numeric(david5.1.up.sf.km$normDS))
km.lm.5.s.up.sf.km<-summary(lm.km.5.up.sf.km)$coefficients
km.5.slope.up.sf.km<-km.lm.5.s.up.sf.km[2,1]
lm.km.6.up.sf.km<-lm(e6.1.up.sf.km$energy_over_time~as.numeric(david6.1.up.sf.km$normDS))
km.lm.6.s.up.sf.km<-summary(lm.km.6.up.sf.km)$coefficients
km.6.slope.up.sf.km<-km.lm.6.s.up.sf.km[2,1]
lm.km.7.up.sf.km<-lm(e7.1.up.sf.km$energy_over_time~as.numeric(david7.1.up.sf.km$normDS))
km.lm.7.s.up.sf.km<-summary(lm.km.7.up.sf.km)$coefficients
km.7.slope.up.sf.km<-km.lm.7.s.up.sf.km[2,1]
lm.km.8.up.sf.km<-lm(e8.1.up.sf.km$energy_over_time~as.numeric(david8.1.up.sf.km$normDS))
km.lm.8.s.up.sf.km<-summary(lm.km.8.up.sf.km)$coefficients
km.8.slope.up.sf.km<-km.lm.8.s.up.sf.km[2,1]
lm.km.9.up.sf.km<-lm(e9.1.up.sf.km$energy_over_time~as.numeric(david9.1.up.sf.km$normDS))
km.lm.9.s.up.sf.km<-summary(lm.km.9.up.sf.km)$coefficients
km.9.slope.up.sf.km<-km.lm.9.s.up.sf.km[2,1]
lm.km.10.up.sf.km<-lm(e10.1.up.sf.km$energy_over_time~as.numeric(david10.1.up.sf.km$normDS))
km.lm.10.s.up.sf.km<-summary(lm.km.10.up.sf.km)$coefficients
km.10.slope.up.sf.km<-km.lm.10.s.up.sf.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.up.sf.ss<-data.frame(triangle.transitivity=c(tri1.up.sf.km,tri2.up.sf.km,tri3.up.sf.km,tri4.up.sf.km,tri5.up.sf.km,tri6.up.sf.km,tri7.up.sf.km,tri8.up.sf.km,tri9.up.sf.km,tri10.up.sf.km),escalation=c(ep1.up.sf.km,ep2.up.sf.km,ep3.up.sf.km,ep4.up.sf.km,ep5.up.sf.km,ep6.up.sf.km,ep7.up.sf.km,ep8.up.sf.km,ep9.up.sf.km,ep10.up.sf.km),dci=c(dci1.up.sf.km,dci2.up.sf.km,dci3.up.sf.km,dci4.up.sf.km,dci5.up.sf.km,dci6.up.sf.km,dci7.up.sf.km,dci8.up.sf.km,dci9.up.sf.km,dci10.up.sf.km),steepness=c(s1.up.sf.km,s2.up.sf.km,s3.up.sf.km,s4.up.sf.km,s5.up.sf.km,s6.up.sf.km,s7.up.sf.km,s8.up.sf.km,s9.up.sf.km,s10.up.sf.km),slope=c(km.1.slope.up.sf.km,km.2.slope.up.sf.km,km.3.slope.up.sf.km,km.4.slope.up.sf.km,km.5.slope.up.sf.km,km.6.slope.up.sf.km,km.7.slope.up.sf.km,km.8.slope.up.sf.km,km.9.slope.up.sf.km,km.10.slope.up.sf.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.sf.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[1]],X2=avoid.up.sf.hm[[2]],Avoids=avoid.up.sf.hm[[3]])
a2.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[4]],X2=avoid.up.sf.hm[[5]],Avoids=avoid.up.sf.hm[[6]])
a3.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[7]],X2=avoid.up.sf.hm[[8]],Avoids=avoid.up.sf.hm[[9]])
a4.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[10]],X2=avoid.up.sf.hm[[11]],Avoids=avoid.up.sf.hm[[12]])
a5.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[13]],X2=avoid.up.sf.hm[[14]],Avoids=avoid.up.sf.hm[[15]])
a6.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[16]],X2=avoid.up.sf.hm[[17]],Avoids=avoid.up.sf.hm[[18]])
a7.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[19]],X2=avoid.up.sf.hm[[20]],Avoids=avoid.up.sf.hm[[21]])
a8.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[22]],X2=avoid.up.sf.hm[[23]],Avoids=avoid.up.sf.hm[[24]])
a9.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[25]],X2=avoid.up.sf.hm[[26]],Avoids=avoid.up.sf.hm[[27]])
a10.up.sf.hm<-data.frame(X1=avoid.up.sf.hm[[28]],X2=avoid.up.sf.hm[[29]],Avoids=avoid.up.sf.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.up.sf<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[1]],X2=conflict.hm.up.sf[[2]],Victories=conflict.hm.up.sf[[3]])
mat1.up.sf.hm<-inter.mat(mut1.up.sf.hm)
tri1.up.sf.hm<-tr.tri(mat1.up.sf.hm)
dci1.up.sf.hm<-DCindex(mat1.up.sf.hm)
mat1.up.sf.hm[is.na(mat1.up.sf.hm)] = 0
h1.up.sf.hm<-h.index(mat1.up.sf.hm)

ep1.up.sf.hm<-ep(mut1.up.sf.hm,a1.up.sf.hm)
david1.up.sf.hm<-DS(mat1.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.1.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.sf.hm<-cbind(ordrank.1.up.sf.hm,ds=david1.up.sf.hm$normDS)
lm1.up.sf.hm<-summary(lm(ordrank.1.up.sf.hm$ds~ordrank.1.up.sf.hm$ord.rank))
s1.up.sf.hm<-lm1.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[4]],X2=conflict.hm.up.sf[[5]],Victories=conflict.hm.up.sf[[6]])
mat2.up.sf.hm<-inter.mat(mut2.up.sf.hm)
tri2.up.sf.hm<-tr.tri(mat2.up.sf.hm)
dci2.up.sf.hm<-DCindex(mat2.up.sf.hm)
mat2.up.sf.hm[is.na(mat2.up.sf.hm)] = 0
h2.up.sf.hm<-h.index(mat2.up.sf.hm)

ep2.up.sf.hm<-ep(mut2.up.sf.hm,a2.up.sf.hm)
david2.up.sf.hm<-DS(mat2.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.2.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.sf.hm<-cbind(ordrank.2.up.sf.hm,ds=david2.up.sf.hm$normDS)
lm2.up.sf.hm<-summary(lm(ordrank.2.up.sf.hm$ds~ordrank.2.up.sf.hm$ord.rank))
s2.up.sf.hm<-lm2.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[7]],X2=conflict.hm.up.sf[[8]],Victories=conflict.hm.up.sf[[9]])
mat3.up.sf.hm<-inter.mat(mut3.up.sf.hm)
tri3.up.sf.hm<-tr.tri(mat3.up.sf.hm)
dci3.up.sf.hm<-DCindex(mat3.up.sf.hm)
mat3.up.sf.hm[is.na(mat3.up.sf.hm)] = 0
h3.up.sf.hm<-h.index(mat3.up.sf.hm)

ep3.up.sf.hm<-ep(mut3.up.sf.hm,a3.up.sf.hm)
david3.up.sf.hm<-DS(mat3.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.3.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.sf.hm<-cbind(ordrank.3.up.sf.hm,ds=david3.up.sf.hm$normDS)
lm3.up.sf.hm<-summary(lm(ordrank.3.up.sf.hm$ds~ordrank.3.up.sf.hm$ord.rank))
s3.up.sf.hm<-lm3.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[10]],X2=conflict.hm.up.sf[[11]],Victories=conflict.hm.up.sf[[12]])
mat4.up.sf.hm<-inter.mat(mut4.up.sf.hm)
tri4.up.sf.hm<-tr.tri(mat4.up.sf.hm)
dci4.up.sf.hm<-DCindex(mat4.up.sf.hm)
mat4.up.sf.hm[is.na(mat4.up.sf.hm)] = 0
h4.up.sf.hm<-h.index(mat4.up.sf.hm)

ep4.up.sf.hm<-ep(mut4.up.sf.hm,a4.up.sf.hm)
david4.up.sf.hm<-DS(mat4.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.4.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.sf.hm<-cbind(ordrank.4.up.sf.hm,ds=david4.up.sf.hm$normDS)
lm4.up.sf.hm<-summary(lm(ordrank.4.up.sf.hm$ds~ordrank.4.up.sf.hm$ord.rank))
s4.up.sf.hm<-lm4.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[13]],X2=conflict.hm.up.sf[[14]],Victories=conflict.hm.up.sf[[15]])
mat5.up.sf.hm<-inter.mat(mut5.up.sf.hm)
tri5.up.sf.hm<-tr.tri(mat5.up.sf.hm)
dci5.up.sf.hm<-DCindex(mat5.up.sf.hm)
mat5.up.sf.hm[is.na(mat5.up.sf.hm)] = 0
h5.up.sf.hm<-h.index(mat5.up.sf.hm)

ep5.up.sf.hm<-ep(mut5.up.sf.hm,a5.up.sf.hm)
david5.up.sf.hm<-DS(mat5.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.5.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.sf.hm<-cbind(ordrank.5.up.sf.hm,ds=david5.up.sf.hm$normDS)
lm5.up.sf.hm<-summary(lm(ordrank.5.up.sf.hm$ds~ordrank.5.up.sf.hm$ord.rank))
s5.up.sf.hm<-lm5.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[16]],X2=conflict.hm.up.sf[[17]],Victories=conflict.hm.up.sf[[18]])
mat6.up.sf.hm<-inter.mat(mut6.up.sf.hm)
tri6.up.sf.hm<-tr.tri(mat6.up.sf.hm)
dci6.up.sf.hm<-DCindex(mat6.up.sf.hm)
mat6.up.sf.hm[is.na(mat6.up.sf.hm)] = 0
h6.up.sf.hm<-h.index(mat6.up.sf.hm)

ep6.up.sf.hm<-ep(mut6.up.sf.hm,a6.up.sf.hm)
david6.up.sf.hm<-DS(mat6.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.6.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.sf.hm<-cbind(ordrank.6.up.sf.hm,ds=david6.up.sf.hm$normDS)
lm6.up.sf.hm<-summary(lm(ordrank.6.up.sf.hm$ds~ordrank.6.up.sf.hm$ord.rank))
s6.up.sf.hm<-lm6.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[19]],X2=conflict.hm.up.sf[[20]],Victories=conflict.hm.up.sf[[21]])
mat7.up.sf.hm<-inter.mat(mut7.up.sf.hm)
tri7.up.sf.hm<-tr.tri(mat7.up.sf.hm)
dci7.up.sf.hm<-DCindex(mat7.up.sf.hm)
mat7.up.sf.hm[is.na(mat7.up.sf.hm)] = 0
h7.up.sf.hm<-h.index(mat7.up.sf.hm)

ep7.up.sf.hm<-ep(mut7.up.sf.hm,a7.up.sf.hm)
david7.up.sf.hm<-DS(mat7.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.7.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.sf.hm<-cbind(ordrank.7.up.sf.hm,ds=david7.up.sf.hm$normDS)
lm7.up.sf.hm<-summary(lm(ordrank.7.up.sf.hm$ds~ordrank.7.up.sf.hm$ord.rank))
s7.up.sf.hm<-lm7.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[22]],X2=conflict.hm.up.sf[[23]],Victories=conflict.hm.up.sf[[24]])
mat8.up.sf.hm<-inter.mat(mut8.up.sf.hm)
tri8.up.sf.hm<-tr.tri(mat8.up.sf.hm)
dci8.up.sf.hm<-DCindex(mat8.up.sf.hm)
mat8.up.sf.hm[is.na(mat8.up.sf.hm)] = 0
h8.up.sf.hm<-h.index(mat8.up.sf.hm)

ep8.up.sf.hm<-ep(mut8.up.sf.hm,a8.up.sf.hm)
david8.up.sf.hm<-DS(mat8.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.8.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.sf.hm<-cbind(ordrank.8.up.sf.hm,ds=david8.up.sf.hm$normDS)
lm8.up.sf.hm<-summary(lm(ordrank.8.up.sf.hm$ds~ordrank.8.up.sf.hm$ord.rank))
s8.up.sf.hm<-lm8.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[25]],X2=conflict.hm.up.sf[[26]],Victories=conflict.hm.up.sf[[27]])
mat9.up.sf.hm<-inter.mat(mut9.up.sf.hm)
tri9.up.sf.hm<-tr.tri(mat9.up.sf.hm)
dci9.up.sf.hm<-DCindex(mat9.up.sf.hm)
mat9.up.sf.hm[is.na(mat9.up.sf.hm)] = 0
h9.up.sf.hm<-h.index(mat9.up.sf.hm)

ep9.up.sf.hm<-ep(mut9.up.sf.hm,a9.up.sf.hm)
david9.up.sf.hm<-DS(mat9.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.9.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.sf.hm<-cbind(ordrank.9.up.sf.hm,ds=david9.up.sf.hm$normDS)
lm9.up.sf.hm<-summary(lm(ordrank.9.up.sf.hm$ds~ordrank.9.up.sf.hm$ord.rank))
s9.up.sf.hm<-lm9.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.sf.hm<-data.frame(X1=conflict.hm.up.sf[[28]],X2=conflict.hm.up.sf[[29]],Victories=conflict.hm.up.sf[[30]])
mat10.up.sf.hm<-inter.mat(mut10.up.sf.hm)
tri10.up.sf.hm<-tr.tri(mat10.up.sf.hm)
dci10.up.sf.hm<-DCindex(mat10.up.sf.hm)
mat10.up.sf.hm[is.na(mat10.up.sf.hm)] = 0
h10.up.sf.hm<-h.index(mat10.up.sf.hm)

ep10.up.sf.hm<-ep(mut10.up.sf.hm,a10.up.sf.hm)
david10.up.sf.hm<-DS(mat10.up.sf.hm) #David's Scores - for steepness use normDS output
ordrank.10.up.sf.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.sf.hm<-cbind(ordrank.10.up.sf.hm,ds=david10.up.sf.hm$normDS)
lm10.up.sf.hm<-summary(lm(ordrank.10.up.sf.hm$ds~ordrank.10.up.sf.hm$ord.rank))
s10.up.sf.hm<-lm10.up.sf.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.sf.hm<-sum(mut1.up.sf.hm$Victories)
int2.up.sf.hm<-sum(mut2.up.sf.hm$Victories)
int3.up.sf.hm<-sum(mut3.up.sf.hm$Victories)
int4.up.sf.hm<-sum(mut4.up.sf.hm$Victories)
int5.up.sf.hm<-sum(mut5.up.sf.hm$Victories)
int6.up.sf.hm<-sum(mut6.up.sf.hm$Victories)
int7.up.sf.hm<-sum(mut7.up.sf.hm$Victories)
int8.up.sf.hm<-sum(mut8.up.sf.hm$Victories)
int9.up.sf.hm<-sum(mut9.up.sf.hm$Victories)
int10.up.sf.hm<-sum(mut10.up.sf.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.sf.hm<-sum(a1.up.sf.hm$Victories)
av2.up.sf.hm<-sum(a2.up.sf.hm$Victories)
av3.up.sf.hm<-sum(a3.up.sf.hm$Victories)
av4.up.sf.hm<-sum(a4.up.sf.hm$Victories)
av5.up.sf.hm<-sum(a5.up.sf.hm$Victories)
av6.up.sf.hm<-sum(a6.up.sf.hm$Victories)
av7.up.sf.hm<-sum(a7.up.sf.hm$Victories)
av8.up.sf.hm<-sum(a8.up.sf.hm$Victories)
av9.up.sf.hm<-sum(a9.up.sf.hm$Victories)
av10.up.sf.hm<-sum(a10.up.sf.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.pu.sf<-(sum(av1.up.sf.hm, av2.up.sf.hm, av3.up.sf.hm, av4.up.sf.hm, av5.up.sf.hm, av6.up.sf.hm, av7.up.sf.hm, av8.up.sf.hm, av9.up.sf.hm, av10.up.sf.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.pu.sf<-(sum(int1.up.sf.hm, int2.up.sf.hm, int3.up.sf.hm, int4.up.sf.hm, int5.up.sf.hm, int6.up.sf.hm, int7.up.sf.hm, int8.up.sf.hm, int9.up.sf.hm, int10.up.sf.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.sf.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.sf.hm<-e1.up.sf.hm[order(e1.up.sf.hm$ID),]
e1.up.sf.hm<-as.matrix(t(e1.1.up.sf.hm))

e2.up.sf.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.sf.hm<-e2.up.sf.hm[order(e2.up.sf.hm$ID),]
e2.up.sf.hm<-as.matrix(t(e2.1.up.sf.hm))

e3.up.sf.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.sf.hm<-e3.up.sf.hm[order(e3.up.sf.hm$ID),]
e3.up.sf.hm<-as.matrix(t(e3.1.up.sf.hm))

e4.up.sf.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.sf.hm<-e4.up.sf.hm[order(e4.up.sf.hm$ID),]
e4.up.sf.hm<-as.matrix(t(e4.1.up.sf.hm))

e5.up.sf.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.sf.hm<-e5.up.sf.hm[order(e5.up.sf.hm$ID),]
e5.up.sf.hm<-as.matrix(t(e5.1.up.sf.hm))

e6.up.sf.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.sf.hm<-e6.up.sf.hm[order(e6.up.sf.hm$ID),]
e6.up.sf.hm<-as.matrix(t(e6.1.up.sf.hm))

e7.up.sf.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.sf.hm<-e7.up.sf.hm[order(e7.up.sf.hm$ID),]
e7.up.sf.hm<-as.matrix(t(e7.1.up.sf.hm))

e8.up.sf.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.sf.hm<-e8.up.sf.hm[order(e8.up.sf.hm$ID),]
e8.up.sf.hm<-as.matrix(t(e8.1.up.sf.hm))

e9.up.sf.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.sf.hm<-e9.up.sf.hm[order(e9.up.sf.hm$ID),]
e9.up.sf.hm<-as.matrix(t(e9.1.up.sf.hm))

e10.up.sf.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.sf.hm<-e10.up.sf.hm[order(e10.up.sf.hm$ID),]
e10.up.sf.hm<-as.matrix(t(e10.1.up.sf.hm))

energy.hm.up.sf.hm<-as.data.frame(matrix(c(e1.up.sf.hm,e2.up.sf.hm,e3.up.sf.hm,e4.up.sf.hm,e5.up.sf.hm,e6.up.sf.hm,e7.up.sf.hm,e8.up.sf.hm,e9.up.sf.hm,e10.up.sf.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.up.sf.hm<-data.frame(ID=energy.hm.up.sf.hm$V1,energy_over_distance=energy.hm.up.sf.hm$V2,energy_over_time=energy.hm.up.sf.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.sf.hm<-david1.up.sf.hm[order(david1.up.sf.hm$ID),]
david1.up.sf.hm<-as.matrix(t(david1.1.up.sf.hm))

david2.1.up.sf.hm<-david2.up.sf.hm[order(david2.up.sf.hm$ID),]
david2.up.sf.hm<-as.matrix(t(david2.1.up.sf.hm))

david3.1.up.sf.hm<-david3.up.sf.hm[order(david3.up.sf.hm$ID),]
david3.up.sf.hm<-as.matrix(t(david3.1.up.sf.hm))

david4.1.up.sf.hm<-david4.up.sf.hm[order(david4.up.sf.hm$ID),]
david4.up.sf.hm<-as.matrix(t(david4.1.up.sf.hm))

david5.1.up.sf.hm<-david5.up.sf.hm[order(david5.up.sf.hm$ID),]
david5.up.sf.hm<-as.matrix(t(david5.1.up.sf.hm))

david6.1.up.sf.hm<-david6.up.sf.hm[order(david6.up.sf.hm$ID),]
david6.up.sf.hm<-as.matrix(t(david6.1.up.sf.hm))

david7.1.up.sf.hm<-david7.up.sf.hm[order(david7.up.sf.hm$ID),]
david7.up.sf.hm<-as.matrix(t(david7.1.up.sf.hm))

david8.1.up.sf.hm<-david8.up.sf.hm[order(david8.up.sf.hm$ID),]
david8.up.sf.hm<-as.matrix(t(david8.1.up.sf.hm))

david9.1.up.sf.hm<-david9.up.sf.hm[order(david9.up.sf.hm$ID),]
david9.up.sf.hm<-as.matrix(t(david9.1.up.sf.hm))

david10.1.up.sf.hm<-david10.up.sf.hm[order(david10.up.sf.hm$ID),]
david10.up.sf.hm<-as.matrix(t(david10.1.up.sf.hm))

david.hm.up.sf.hm<-as.data.frame(matrix(c(david1.up.sf.hm,david2.up.sf.hm,david3.up.sf.hm,david4.up.sf.hm,david5.up.sf.hm,david6.up.sf.hm,david7.up.sf.hm,david8.up.sf.hm,david9.up.sf.hm,david10.up.sf.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.up.sf.hm<-data.frame(ID=david.hm.up.sf.hm$V1,DS=david.hm.up.sf.hm$V2,normDS=david.hm.up.sf.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.up.sf.hm<-lm(e1.1.up.sf.hm$energy_over_time~as.numeric(david1.1.up.sf.hm$normDS))
hm.lm.1.s.up.sf.hm<-summary(lm.hm.1.up.sf.hm)$coefficients
hm.1.slope.up.sf.hm<-hm.lm.1.s.up.sf.hm[2,1]
lm.hm.2.up.sf.hm<-lm(e2.1.up.sf.hm$energy_over_time~as.numeric(david2.1.up.sf.hm$normDS))
hm.lm.2.s.up.sf.hm<-summary(lm.hm.2.up.sf.hm)$coefficients
hm.2.slope.up.sf.hm<-hm.lm.2.s.up.sf.hm[2,1]
lm.hm.3.up.sf.hm<-lm(e3.1.up.sf.hm$energy_over_time~as.numeric(david3.1.up.sf.hm$normDS))
hm.lm.3.s.up.sf.hm<-summary(lm.hm.3.up.sf.hm)$coefficients
hm.3.slope.up.sf.hm<-hm.lm.3.s.up.sf.hm[2,1]
lm.hm.4.up.sf.hm<-lm(e4.1.up.sf.hm$energy_over_time~as.numeric(david4.1.up.sf.hm$normDS))
hm.lm.4.s.up.sf.hm<-summary(lm.hm.4.up.sf.hm)$coefficients
hm.4.slope.up.sf.hm<-hm.lm.4.s.up.sf.hm[2,1]
lm.hm.5.up.sf.hm<-lm(e5.1.up.sf.hm$energy_over_time~as.numeric(david5.1.up.sf.hm$normDS))
hm.lm.5.s.up.sf.hm<-summary(lm.hm.5.up.sf.hm)$coefficients
hm.5.slope.up.sf.hm<-hm.lm.5.s.up.sf.hm[2,1]
lm.hm.6.up.sf.hm<-lm(e6.1.up.sf.hm$energy_over_time~as.numeric(david6.1.up.sf.hm$normDS))
hm.lm.6.s.up.sf.hm<-summary(lm.hm.6.up.sf.hm)$coefficients
hm.6.slope.up.sf.hm<-hm.lm.6.s.up.sf.hm[2,1]
lm.hm.7.up.sf.hm<-lm(e7.1.up.sf.hm$energy_over_time~as.numeric(david7.1.up.sf.hm$normDS))
hm.lm.7.s.up.sf.hm<-summary(lm.hm.7.up.sf.hm)$coefficients
hm.7.slope.up.sf.hm<-hm.lm.7.s.up.sf.hm[2,1]
lm.hm.8.up.sf.hm<-lm(e8.1.up.sf.hm$energy_over_time~as.numeric(david8.1.up.sf.hm$normDS))
hm.lm.8.s.up.sf.hm<-summary(lm.hm.8.up.sf.hm)$coefficients
hm.8.slope.up.sf.hm<-hm.lm.8.s.up.sf.hm[2,1]
lm.hm.9.up.sf.hm<-lm(e9.1.up.sf.hm$energy_over_time~as.numeric(david9.1.up.sf.hm$normDS))
hm.lm.9.s.up.sf.hm<-summary(lm.hm.9.up.sf.hm)$coefficients
hm.9.slope.up.sf.hm<-hm.lm.9.s.up.sf.hm[2,1]
lm.hm.10.up.sf.hm<-lm(e10.1.up.sf.hm$energy_over_time~as.numeric(david10.1.up.sf.hm$normDS))
hm.lm.10.s.up.sf.hm<-summary(lm.hm.10.up.sf.hm)$coefficients
hm.10.slope.up.sf.hm<-hm.lm.10.s.up.sf.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.up.sf.ss<-data.frame(triangle.transitivity=c(tri1.up.sf.hm,tri2.up.sf.hm,tri3.up.sf.hm,tri4.up.sf.hm,tri5.up.sf.hm,tri6.up.sf.hm,tri7.up.sf.hm,tri8.up.sf.hm,tri9.up.sf.hm,tri10.up.sf.hm),escalation=c(ep1.up.sf.hm,ep2.up.sf.hm,ep3.up.sf.hm,ep4.up.sf.hm,ep5.up.sf.hm,ep6.up.sf.hm,ep7.up.sf.hm,ep8.up.sf.hm,ep9.up.sf.hm,ep10.up.sf.hm),dci=c(dci1.up.sf.hm,dci2.up.sf.hm,dci3.up.sf.hm,dci4.up.sf.hm,dci5.up.sf.hm,dci6.up.sf.hm,dci7.up.sf.hm,dci8.up.sf.hm,dci9.up.sf.hm,dci10.up.sf.hm),steepness=c(s1.up.sf.hm,s2.up.sf.hm,s3.up.sf.hm,s4.up.sf.hm,s5.up.sf.hm,s6.up.sf.hm,s7.up.sf.hm,s8.up.sf.hm,s9.up.sf.hm,s10.up.sf.hm),slope=c(hm.1.slope.up.sf.hm,hm.2.slope.up.sf.hm,hm.3.slope.up.sf.hm,hm.4.slope.up.sf.hm,hm.5.slope.up.sf.hm,hm.6.slope.up.sf.hm,hm.7.slope.up.sf.hm,hm.8.slope.up.sf.hm,hm.9.slope.up.sf.hm,hm.10.slope.up.sf.hm))


```
```{r Uniform Probabilistic Data Frame}
# Generate energy data frame:
total.energy.pu.sf<-data.frame(energy.km.df.up.sf.km)
total.energy.pu.sf<-rbind(total.energy.pu.sf,energy.hm.df.up.sf.hm)

total.david.pu.sf<-data.frame(david.km.df.up.sf.km)
total.david.pu.sf<-rbind(total.david.pu.sf,david.hm.df.up.sf.hm)

total.energy.pu.sf<-cbind(total.energy.pu.sf,normDS=total.david.pu.sf$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.pu.sf<-mean(km.up.sf.ss$triangle.transitivity)
  km.pu.sfi.pu.sf<-mean(km.up.sf.ss$dci)
  km.esc.pu.sf<-mean(km.up.sf.ss$escalation)
  km.steep.pu.sf<-mean(km.up.sf.ss$steepness)
  km.slope.pu.sf<-mean(km.up.sf.ss$slope)
  km.mean.pu.sf<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.pu.sf,dci=km.pu.sfi.pu.sf,esc=km.esc.pu.sf,steepness=km.steep.pu.sf,slope=km.slope.pu.sf,dist="Uniform",calc="Probabilistic")

  # history mutual
  hm.tt.pu.sf<-mean(hm.up.sf.ss$triangle.transitivity)
  hm.pu.sfi.pu.sf<-mean(hm.up.sf.ss$dci)
  hm.esc.pu.sf<-mean(hm.up.sf.ss$escalation)
  hm.steep.pu.sf<-mean(hm.up.sf.ss$steepness)
  hm.slope.pu.sf<-mean(hm.up.sf.ss$slope)
  hm.mean.pu.sf<-data.frame(scenario="History Mutual",tt=hm.tt.pu.sf,dci=hm.pu.sfi.pu.sf,esc=hm.esc.pu.sf,steepness=hm.steep.pu.sf,slope=hm.slope.pu.sf,dist="Uniform",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.pu.sf,hm.mean.pu.sf)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.pu.sf<-mean(km.up.sf.ss$triangle.transitivity)
  km.pu.sfi.pu.sf<-mean(km.up.sf.ss$dci)
  km.esc.pu.sf<-mean(km.up.sf.ss$escalation)
  km.steep.pu.sf<-mean(km.up.sf.ss$steepness)
  km.slope.pu.sf<-mean(km.up.sf.ss$slope)
  km.mean.pu.sf<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu.sf,dci=km.pu.sfi.pu.sf,esc=km.esc.pu.sf,steepness=km.steep.pu.sf,slope=km.slope.pu.sf,dist="Uniform",calc="Probabilistic")
  
  #history mutual
  hm.tt.pu.sf<-mean(hm.up.sf.ss$triangle.transitivity)
  hm.pu.sfi.pu.sf<-mean(hm.up.sf.ss$dci)
  hm.esc.pu.sf<-mean(hm.up.sf.ss$escalation)
  hm.steep.pu.sf<-mean(hm.up.sf.ss$steepness)
  hm.slope.pu.sf<-mean(hm.up.sf.ss$slope)
  hm.mean.pu.sf<-data.frame(scenario="History Mutual",tt=hm.tt.pu.sf,dci=hm.pu.sfi.pu.sf,esc=hm.esc.pu.sf,steepness=hm.steep.pu.sf,slope=hm.slope.pu.sf,dist="Uniform",calc="Probabilistic")
  
# Generate data frame for all averages:
dc.ave<-rbind(km.mean.pu.sf,hm.mean.pu.sf)

# Create overall dataframe of summary statistics:
overall.unif.sf.prob.sf<-data.frame(km.up.sf.ss)
overall.unif.sf.prob.sf<-rbind(overall.unif.sf.prob.sf,hm.up.sf.ss)

overall.unif.sf.prob.sf<-cbind(overall.unif.sf.prob.sf,variable=c(rep("rhp",10),rep("history",10)))
overall.unif.sf.prob.sf<-cbind(overall.unif.sf.prob.sf,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("prob",20))


rhp.up.sf.ss<-overall.unif.sf.prob.sf[overall.unif.sf.prob.sf$variable=="rhp",]
history.up.sf.ss<-overall.unif.sf.prob.sf[overall.unif.sf.prob.sf$variable=="history",]

overall.unif.sf.prob.sf$combo<-paste(overall.unif.sf.prob.sf$strategy,overall.unif.sf.prob.sf$variable,overall.unif.sf.prob.sf$distribution)
overall.unif.sf.prob.sf$combo2<-paste(overall.unif.sf.prob.sf$strategy,overall.unif.sf.prob.sf$variable) #final dataframe for Probabilistic Uniform data
```

## Avoids Uniform Probabilistic Data
```{r Avoids Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.sf.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aup.km<-data.frame(X1=avoid.up.sf.km[[1]],X2=avoid.up.sf.km[[2]],Avoids=avoid.up.sf.km[[3]])
mat1.aup.km<-avoid.inter.mat(mut1.aup.km)
tri1.aup.km<-tr.tri(mat1.aup.km)
dci1.aup.km<-DCindex(mat1.aup.km)
mat1.aup.km[is.na(mat1.aup.km)] = 0
h1.aup.km<-h.index(mat1.aup.km)

ep1.aup.km<-ep(mut1.aup.km,a1.up.sf.km)
david1.aup.km<-DS(mat1.aup.km) #David's Scores - for steepness use normDS output
ordrank.1.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.km<-cbind(ordrank.1.aup.km,ds=david1.aup.km$normDS)
lm1.aup.km<-summary(lm(ordrank.1.aup.km$ds~ordrank.1.aup.km$ord.rank))
s1.aup.km<-lm1.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.km<-data.frame(X1=avoid.up.sf.km[[4]],X2=avoid.up.sf.km[[5]],Avoids=avoid.up.sf.km[[6]])
mat2.aup.km<-avoid.inter.mat(mut2.aup.km)
tri2.aup.km<-tr.tri(mat2.aup.km)
dci2.aup.km<-DCindex(mat2.aup.km)
mat2.aup.km[is.na(mat2.aup.km)] = 0
h2.aup.km<-h.index(mat2.aup.km)

ep2.aup.km<-ep(mut2.aup.km,a2.up.sf.km)
david2.aup.km<-DS(mat2.aup.km) #David's Scores - for steepness use normDS output
ordrank.2.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.km<-cbind(ordrank.2.aup.km,ds=david2.aup.km$normDS)
lm2.aup.km<-summary(lm(ordrank.2.aup.km$ds~ordrank.2.aup.km$ord.rank))
s2.aup.km<-lm2.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.km<-data.frame(X1=avoid.up.sf.km[[7]],X2=avoid.up.sf.km[[8]],Avoids=avoid.up.sf.km[[9]])
mat3.aup.km<-avoid.inter.mat(mut3.aup.km)
tri3.aup.km<-tr.tri(mat3.aup.km)
dci3.aup.km<-DCindex(mat3.aup.km)
mat3.aup.km[is.na(mat3.aup.km)] = 0
h3.aup.km<-h.index(mat3.aup.km)

ep3.aup.km<-ep(mut3.aup.km,a3.up.sf.km)
david3.aup.km<-DS(mat3.aup.km) #David's Scores - for steepness use normDS output
ordrank.3.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.km<-cbind(ordrank.3.aup.km,ds=david3.aup.km$normDS)
lm3.aup.km<-summary(lm(ordrank.3.aup.km$ds~ordrank.3.aup.km$ord.rank))
s3.aup.km<-lm3.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.km<-data.frame(X1=avoid.up.sf.km[[10]],X2=avoid.up.sf.km[[11]],Avoids=avoid.up.sf.km[[12]])
mat4.aup.km<-avoid.inter.mat(mut4.aup.km)
tri4.aup.km<-tr.tri(mat4.aup.km)
dci4.aup.km<-DCindex(mat4.aup.km)
mat4.aup.km[is.na(mat4.aup.km)] = 0
h4.aup.km<-h.index(mat4.aup.km)

ep4.aup.km<-ep(mut4.aup.km,a4.up.sf.km)
david4.aup.km<-DS(mat4.aup.km) #David's Scores - for steepness use normDS output
ordrank.4.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.km<-cbind(ordrank.4.aup.km,ds=david4.aup.km$normDS)
lm4.aup.km<-summary(lm(ordrank.4.aup.km$ds~ordrank.4.aup.km$ord.rank))
s4.aup.km<-lm4.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.km<-data.frame(X1=avoid.up.sf.km[[13]],X2=avoid.up.sf.km[[14]],Avoids=avoid.up.sf.km[[15]])
mat5.aup.km<-avoid.inter.mat(mut5.aup.km)
tri5.aup.km<-tr.tri(mat5.aup.km)
dci5.aup.km<-DCindex(mat5.aup.km)
mat5.aup.km[is.na(mat5.aup.km)] = 0
h5.aup.km<-h.index(mat5.aup.km)

ep5.aup.km<-ep(mut5.aup.km,a5.up.sf.km)
david5.aup.km<-DS(mat5.aup.km) #David's Scores - for steepness use normDS output
ordrank.5.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.km<-cbind(ordrank.5.aup.km,ds=david5.aup.km$normDS)
lm5.aup.km<-summary(lm(ordrank.5.aup.km$ds~ordrank.5.aup.km$ord.rank))
s5.aup.km<-lm5.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.km<-data.frame(X1=avoid.up.sf.km[[16]],X2=avoid.up.sf.km[[17]],Avoids=avoid.up.sf.km[[18]])
mat6.aup.km<-avoid.inter.mat(mut6.aup.km)
tri6.aup.km<-tr.tri(mat6.aup.km)
dci6.aup.km<-DCindex(mat6.aup.km)
mat6.aup.km[is.na(mat6.aup.km)] = 0
h6.aup.km<-h.index(mat6.aup.km)

ep6.aup.km<-ep(mut6.aup.km,a6.up.sf.km)
david6.aup.km<-DS(mat6.aup.km) #David's Scores - for steepness use normDS output
ordrank.6.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.km<-cbind(ordrank.6.aup.km,ds=david6.aup.km$normDS)
lm6.aup.km<-summary(lm(ordrank.6.aup.km$ds~ordrank.6.aup.km$ord.rank))
s6.aup.km<-lm6.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.km<-data.frame(X1=avoid.up.sf.km[[19]],X2=avoid.up.sf.km[[20]],Avoids=avoid.up.sf.km[[21]])
mat7.aup.km<-avoid.inter.mat(mut7.aup.km)
tri7.aup.km<-tr.tri(mat7.aup.km)
dci7.aup.km<-DCindex(mat7.aup.km)
mat7.aup.km[is.na(mat7.aup.km)] = 0
h7.aup.km<-h.index(mat7.aup.km)

ep7.aup.km<-ep(mut7.aup.km,a7.up.sf.km)
david7.aup.km<-DS(mat7.aup.km) #David's Scores - for steepness use normDS output
ordrank.7.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.km<-cbind(ordrank.7.aup.km,ds=david7.aup.km$normDS)
lm7.aup.km<-summary(lm(ordrank.7.aup.km$ds~ordrank.7.aup.km$ord.rank))
s7.aup.km<-lm7.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.km<-data.frame(X1=avoid.up.sf.km[[22]],X2=avoid.up.sf.km[[23]],Avoids=avoid.up.sf.km[[24]])
mat8.aup.km<-avoid.inter.mat(mut8.aup.km)
tri8.aup.km<-tr.tri(mat8.aup.km)
dci8.aup.km<-DCindex(mat8.aup.km)
mat8.aup.km[is.na(mat8.aup.km)] = 0
h8.aup.km<-h.index(mat8.aup.km)

ep8.aup.km<-ep(mut8.aup.km,a8.up.sf.km)
david8.aup.km<-DS(mat8.aup.km) #David's Scores - for steepness use normDS output
ordrank.8.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.km<-cbind(ordrank.8.aup.km,ds=david8.aup.km$normDS)
lm8.aup.km<-summary(lm(ordrank.8.aup.km$ds~ordrank.8.aup.km$ord.rank))
s8.aup.km<-lm8.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.km<-data.frame(X1=avoid.up.sf.km[[25]],X2=avoid.up.sf.km[[26]],Avoids=avoid.up.sf.km[[27]])
mat9.aup.km<-avoid.inter.mat(mut9.aup.km)
tri9.aup.km<-tr.tri(mat9.aup.km)
dci9.aup.km<-DCindex(mat9.aup.km)
mat9.aup.km[is.na(mat9.aup.km)] = 0
h9.aup.km<-h.index(mat9.aup.km)

ep9.aup.km<-ep(mut9.aup.km,a9.up.sf.km)
david9.aup.km<-DS(mat9.aup.km) #David's Scores - for steepness use normDS output
ordrank.9.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.km<-cbind(ordrank.9.aup.km,ds=david9.aup.km$normDS)
lm9.aup.km<-summary(lm(ordrank.9.aup.km$ds~ordrank.9.aup.km$ord.rank))
s9.aup.km<-lm9.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.km<-data.frame(X1=avoid.up.sf.km[[28]],X2=avoid.up.sf.km[[29]],Avoids=avoid.up.sf.km[[30]])
mat10.aup.km<-avoid.inter.mat(mut10.aup.km)
tri10.aup.km<-tr.tri(mat10.aup.km)
dci10.aup.km<-DCindex(mat10.aup.km)
mat10.aup.km[is.na(mat10.aup.km)] = 0
h10.aup.km<-h.index(mat10.aup.km)

ep10.aup.km<-ep(mut10.aup.km,a10.up.sf.km)
david10.aup.km<-DS(mat10.aup.km) #David's Scores - for steepness use normDS output
ordrank.10.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.km<-cbind(ordrank.10.aup.km,ds=david10.aup.km$normDS)
lm10.aup.km<-summary(lm(ordrank.10.aup.km$ds~ordrank.10.aup.km$ord.rank))
s10.aup.km<-lm10.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.km<-sum(mut1.aup.km$Victories)
int2.aup.km<-sum(mut2.aup.km$Victories)
int3.aup.km<-sum(mut3.aup.km$Victories)
int4.aup.km<-sum(mut4.aup.km$Victories)
int5.aup.km<-sum(mut5.aup.km$Victories)
int6.aup.km<-sum(mut6.aup.km$Victories)
int7.aup.km<-sum(mut7.aup.km$Victories)
int8.aup.km<-sum(mut8.aup.km$Victories)
int9.aup.km<-sum(mut9.aup.km$Victories)
int10.aup.km<-sum(mut10.aup.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.km<-sum(a1.up.sf.km$Victories)
av2.aup.km<-sum(a2.up.sf.km$Victories)
av3.aup.km<-sum(a3.up.sf.km$Victories)
av4.aup.km<-sum(a4.up.sf.km$Victories)
av5.aup.km<-sum(a5.up.sf.km$Victories)
av6.aup.km<-sum(a6.up.sf.km$Victories)
av7.aup.km<-sum(a7.up.sf.km$Victories)
av8.aup.km<-sum(a8.up.sf.km$Victories)
av9.aup.km<-sum(a9.up.sf.km$Victories)
av10.aup.km<-sum(a10.up.sf.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.adu<-(sum(av1.aup.km, av2.aup.km, av3.aup.km, av4.aup.km, av5.aup.km, av6.aup.km, av7.aup.km, av8.aup.km, av9.aup.km, av10.aup.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.adu<-(sum(int1.aup.km, int2.aup.km, int3.aup.km, int4.aup.km, int5.aup.km, int6.aup.km, int7.aup.km, int8.aup.km, int9.aup.km, int10.aup.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.km<-e1.aup.km[order(e1.aup.km$ID),]
e1.aup.km<-as.matrix(t(e1.1.aup.km))

e2.aup.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.km<-e2.aup.km[order(e2.aup.km$ID),]
e2.aup.km<-as.matrix(t(e2.1.aup.km))

e3.aup.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.km<-e3.aup.km[order(e3.aup.km$ID),]
e3.aup.km<-as.matrix(t(e3.1.aup.km))

e4.aup.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.km<-e4.aup.km[order(e4.aup.km$ID),]
e4.aup.km<-as.matrix(t(e4.1.aup.km))

e5.aup.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.km<-e5.aup.km[order(e5.aup.km$ID),]
e5.aup.km<-as.matrix(t(e5.1.aup.km))

e6.aup.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.km<-e6.aup.km[order(e6.aup.km$ID),]
e6.aup.km<-as.matrix(t(e6.1.aup.km))

e7.aup.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.km<-e7.aup.km[order(e7.aup.km$ID),]
e7.aup.km<-as.matrix(t(e7.1.aup.km))

e8.aup.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.km<-e8.aup.km[order(e8.aup.km$ID),]
e8.aup.km<-as.matrix(t(e8.1.aup.km))

e9.aup.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.km<-e9.aup.km[order(e9.aup.km$ID),]
e9.aup.km<-as.matrix(t(e9.1.aup.km))

e10.aup.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.km<-e10.aup.km[order(e10.aup.km$ID),]
e10.aup.km<-as.matrix(t(e10.1.aup.km))

energy.km.aup.km<-as.data.frame(matrix(c(e1.aup.km,e2.aup.km,e3.aup.km,e4.aup.km,e5.aup.km,e6.aup.km,e7.aup.km,e8.aup.km,e9.aup.km,e10.aup.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aup.km<-data.frame(ID=energy.km.aup.km$V1,energy_over_distance=energy.km.aup.km$V2,energy_over_time=energy.km.aup.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.km<-david1.aup.km[order(david1.aup.km$ID),]
david1.aup.km<-as.matrix(t(david1.1.aup.km))

david2.1.aup.km<-david2.aup.km[order(david2.aup.km$ID),]
david2.aup.km<-as.matrix(t(david2.1.aup.km))

david3.1.aup.km<-david3.aup.km[order(david3.aup.km$ID),]
david3.aup.km<-as.matrix(t(david3.1.aup.km))

david4.1.aup.km<-david4.aup.km[order(david4.aup.km$ID),]
david4.aup.km<-as.matrix(t(david4.1.aup.km))

david5.1.aup.km<-david5.aup.km[order(david5.aup.km$ID),]
david5.aup.km<-as.matrix(t(david5.1.aup.km))

david6.1.aup.km<-david6.aup.km[order(david6.aup.km$ID),]
david6.aup.km<-as.matrix(t(david6.1.aup.km))

david7.1.aup.km<-david7.aup.km[order(david7.aup.km$ID),]
david7.aup.km<-as.matrix(t(david7.1.aup.km))

david8.1.aup.km<-david8.aup.km[order(david8.aup.km$ID),]
david8.aup.km<-as.matrix(t(david8.1.aup.km))

david9.1.aup.km<-david9.aup.km[order(david9.aup.km$ID),]
david9.aup.km<-as.matrix(t(david9.1.aup.km))

david10.1.aup.km<-david10.aup.km[order(david10.aup.km$ID),]
david10.aup.km<-as.matrix(t(david10.1.aup.km))

david.km.aup.km<-as.data.frame(matrix(c(david1.aup.km,david2.aup.km,david3.aup.km,david4.aup.km,david5.aup.km,david6.aup.km,david7.aup.km,david8.aup.km,david9.aup.km,david10.aup.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aup.km<-data.frame(ID=david.km.aup.km$V1,DS=david.km.aup.km$V2,normDS=david.km.aup.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aup.km<-lm(e1.1.aup.km$energy_over_time~as.numeric(david1.1.aup.km$normDS))
km.lm.1.s.aup.km<-summary(lm.km.1.aup.km)$coefficients
km.1.slope.aup.km<-km.lm.1.s.aup.km[2,1]
lm.km.2.aup.km<-lm(e2.1.aup.km$energy_over_time~as.numeric(david2.1.aup.km$normDS))
km.lm.2.s.aup.km<-summary(lm.km.2.aup.km)$coefficients
km.2.slope.aup.km<-km.lm.2.s.aup.km[2,1]
lm.km.3.aup.km<-lm(e3.1.aup.km$energy_over_time~as.numeric(david3.1.aup.km$normDS))
km.lm.3.s.aup.km<-summary(lm.km.3.aup.km)$coefficients
km.3.slope.aup.km<-km.lm.3.s.aup.km[2,1]
lm.km.4.aup.km<-lm(e4.1.aup.km$energy_over_time~as.numeric(david4.1.aup.km$normDS))
km.lm.4.s.aup.km<-summary(lm.km.4.aup.km)$coefficients
km.4.slope.aup.km<-km.lm.4.s.aup.km[2,1]
lm.km.5.aup.km<-lm(e5.1.aup.km$energy_over_time~as.numeric(david5.1.aup.km$normDS))
km.lm.5.s.aup.km<-summary(lm.km.5.aup.km)$coefficients
km.5.slope.aup.km<-km.lm.5.s.aup.km[2,1]
lm.km.6.aup.km<-lm(e6.1.aup.km$energy_over_time~as.numeric(david6.1.aup.km$normDS))
km.lm.6.s.aup.km<-summary(lm.km.6.aup.km)$coefficients
km.6.slope.aup.km<-km.lm.6.s.aup.km[2,1]
lm.km.7.aup.km<-lm(e7.1.aup.km$energy_over_time~as.numeric(david7.1.aup.km$normDS))
km.lm.7.s.aup.km<-summary(lm.km.7.aup.km)$coefficients
km.7.slope.aup.km<-km.lm.7.s.aup.km[2,1]
lm.km.8.aup.km<-lm(e8.1.aup.km$energy_over_time~as.numeric(david8.1.aup.km$normDS))
km.lm.8.s.aup.km<-summary(lm.km.8.aup.km)$coefficients
km.8.slope.aup.km<-km.lm.8.s.aup.km[2,1]
lm.km.9.aup.km<-lm(e9.1.aup.km$energy_over_time~as.numeric(david9.1.aup.km$normDS))
km.lm.9.s.aup.km<-summary(lm.km.9.aup.km)$coefficients
km.9.slope.aup.km<-km.lm.9.s.aup.km[2,1]
lm.km.10.aup.km<-lm(e10.1.aup.km$energy_over_time~as.numeric(david10.1.aup.km$normDS))
km.lm.10.s.aup.km<-summary(lm.km.10.aup.km)$coefficients
km.10.slope.aup.km<-km.lm.10.s.aup.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aup.ss.avoid.up.sf.km<-data.frame(triangle.transitivity=c(tri1.aup.km,tri2.aup.km,tri3.aup.km,tri4.aup.km,tri5.aup.km,tri6.aup.km,tri7.aup.km,tri8.aup.km,tri9.aup.km,tri10.aup.km),escalation=c(ep1.aup.km,ep2.aup.km,ep3.aup.km,ep4.aup.km,ep5.aup.km,ep6.aup.km,ep7.aup.km,ep8.aup.km,ep9.aup.km,ep10.aup.km),dci=c(dci1.aup.km,dci2.aup.km,dci3.aup.km,dci4.aup.km,dci5.aup.km,dci6.aup.km,dci7.aup.km,dci8.aup.km,dci9.aup.km,dci10.aup.km),steepness=c(s1.aup.km,s2.aup.km,s3.aup.km,s4.aup.km,s5.aup.km,s6.aup.km,s7.aup.km,s8.aup.km,s9.aup.km,s10.aup.km),slope=c(km.1.slope.aup.km,km.2.slope.aup.km,km.3.slope.aup.km,km.4.slope.aup.km,km.5.slope.aup.km,km.6.slope.aup.km,km.7.slope.aup.km,km.8.slope.aup.km,km.9.slope.aup.km,km.10.slope.aup.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.sf.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.hm<-data.frame(X1=avoid.up.sf.hm[[1]],X2=avoid.up.sf.hm[[2]],Avoids=avoid.up.sf.hm[[3]])
mat1.aup.hm<-avoid.inter.mat(mut1.aup.hm)
tri1.aup.hm<-tr.tri(mat1.aup.hm)
dci1.aup.hm<-DCindex(mat1.aup.hm)
mat1.aup.hm[is.na(mat1.aup.hm)] = 0
h1.aup.hm<-h.index(mat1.aup.hm)

ep1.aup.hm<-ep(mut1.aup.hm,a1.up.sf.hm)
david1.aup.hm<-DS(mat1.aup.hm) #David's Scores - for steepness use normDS output
ordrank.1.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.hm<-cbind(ordrank.1.aup.hm,ds=david1.aup.hm$normDS)
lm1.aup.hm<-summary(lm(ordrank.1.aup.hm$ds~ordrank.1.aup.hm$ord.rank))
s1.aup.hm<-lm1.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.hm<-data.frame(X1=avoid.up.sf.hm[[4]],X2=avoid.up.sf.hm[[5]],Avoids=avoid.up.sf.hm[[6]])
mat2.aup.hm<-avoid.inter.mat(mut2.aup.hm)
tri2.aup.hm<-tr.tri(mat2.aup.hm)
dci2.aup.hm<-DCindex(mat2.aup.hm)
mat2.aup.hm[is.na(mat2.aup.hm)] = 0
h2.aup.hm<-h.index(mat2.aup.hm)

ep2.aup.hm<-ep(mut2.aup.hm,a2.up.sf.hm)
david2.aup.hm<-DS(mat2.aup.hm) #David's Scores - for steepness use normDS output
ordrank.2.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.hm<-cbind(ordrank.2.aup.hm,ds=david2.aup.hm$normDS)
lm2.aup.hm<-summary(lm(ordrank.2.aup.hm$ds~ordrank.2.aup.hm$ord.rank))
s2.aup.hm<-lm2.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.hm<-data.frame(X1=avoid.up.sf.hm[[7]],X2=avoid.up.sf.hm[[8]],Avoids=avoid.up.sf.hm[[9]])
mat3.aup.hm<-avoid.inter.mat(mut3.aup.hm)
tri3.aup.hm<-tr.tri(mat3.aup.hm)
dci3.aup.hm<-DCindex(mat3.aup.hm)
mat3.aup.hm[is.na(mat3.aup.hm)] = 0
h3.aup.hm<-h.index(mat3.aup.hm)

ep3.aup.hm<-ep(mut3.aup.hm,a3.up.sf.hm)
david3.aup.hm<-DS(mat3.aup.hm) #David's Scores - for steepness use normDS output
ordrank.3.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.hm<-cbind(ordrank.3.aup.hm,ds=david3.aup.hm$normDS)
lm3.aup.hm<-summary(lm(ordrank.3.aup.hm$ds~ordrank.3.aup.hm$ord.rank))
s3.aup.hm<-lm3.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.hm<-data.frame(X1=avoid.up.sf.hm[[10]],X2=avoid.up.sf.hm[[11]],Avoids=avoid.up.sf.hm[[12]])
mat4.aup.hm<-avoid.inter.mat(mut4.aup.hm)
tri4.aup.hm<-tr.tri(mat4.aup.hm)
dci4.aup.hm<-DCindex(mat4.aup.hm)
mat4.aup.hm[is.na(mat4.aup.hm)] = 0
h4.aup.hm<-h.index(mat4.aup.hm)

ep4.aup.hm<-ep(mut4.aup.hm,a4.up.sf.hm)
david4.aup.hm<-DS(mat4.aup.hm) #David's Scores - for steepness use normDS output
ordrank.4.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.hm<-cbind(ordrank.4.aup.hm,ds=david4.aup.hm$normDS)
lm4.aup.hm<-summary(lm(ordrank.4.aup.hm$ds~ordrank.4.aup.hm$ord.rank))
s4.aup.hm<-lm4.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.hm<-data.frame(X1=avoid.up.sf.hm[[13]],X2=avoid.up.sf.hm[[14]],Avoids=avoid.up.sf.hm[[15]])
mat5.aup.hm<-avoid.inter.mat(mut5.aup.hm)
tri5.aup.hm<-tr.tri(mat5.aup.hm)
dci5.aup.hm<-DCindex(mat5.aup.hm)
mat5.aup.hm[is.na(mat5.aup.hm)] = 0
h5.aup.hm<-h.index(mat5.aup.hm)

ep5.aup.hm<-ep(mut5.aup.hm,a5.up.sf.hm)
david5.aup.hm<-DS(mat5.aup.hm) #David's Scores - for steepness use normDS output
ordrank.5.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.hm<-cbind(ordrank.5.aup.hm,ds=david5.aup.hm$normDS)
lm5.aup.hm<-summary(lm(ordrank.5.aup.hm$ds~ordrank.5.aup.hm$ord.rank))
s5.aup.hm<-lm5.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.hm<-data.frame(X1=avoid.up.sf.hm[[16]],X2=avoid.up.sf.hm[[17]],Avoids=avoid.up.sf.hm[[18]])
mat6.aup.hm<-avoid.inter.mat(mut6.aup.hm)
tri6.aup.hm<-tr.tri(mat6.aup.hm)
dci6.aup.hm<-DCindex(mat6.aup.hm)
mat6.aup.hm[is.na(mat6.aup.hm)] = 0
h6.aup.hm<-h.index(mat6.aup.hm)

ep6.aup.hm<-ep(mut6.aup.hm,a6.up.sf.hm)
david6.aup.hm<-DS(mat6.aup.hm) #David's Scores - for steepness use normDS output
ordrank.6.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.hm<-cbind(ordrank.6.aup.hm,ds=david6.aup.hm$normDS)
lm6.aup.hm<-summary(lm(ordrank.6.aup.hm$ds~ordrank.6.aup.hm$ord.rank))
s6.aup.hm<-lm6.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.hm<-data.frame(X1=avoid.up.sf.hm[[19]],X2=avoid.up.sf.hm[[20]],Avoids=avoid.up.sf.hm[[21]])
mat7.aup.hm<-avoid.inter.mat(mut7.aup.hm)
tri7.aup.hm<-tr.tri(mat7.aup.hm)
dci7.aup.hm<-DCindex(mat7.aup.hm)
mat7.aup.hm[is.na(mat7.aup.hm)] = 0
h7.aup.hm<-h.index(mat7.aup.hm)

ep7.aup.hm<-ep(mut7.aup.hm,a7.up.sf.hm)
david7.aup.hm<-DS(mat7.aup.hm) #David's Scores - for steepness use normDS output
ordrank.7.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.hm<-cbind(ordrank.7.aup.hm,ds=david7.aup.hm$normDS)
lm7.aup.hm<-summary(lm(ordrank.7.aup.hm$ds~ordrank.7.aup.hm$ord.rank))
s7.aup.hm<-lm7.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.hm<-data.frame(X1=avoid.up.sf.hm[[22]],X2=avoid.up.sf.hm[[23]],Avoids=avoid.up.sf.hm[[24]])
mat8.aup.hm<-avoid.inter.mat(mut8.aup.hm)
tri8.aup.hm<-tr.tri(mat8.aup.hm)
dci8.aup.hm<-DCindex(mat8.aup.hm)
mat8.aup.hm[is.na(mat8.aup.hm)] = 0
h8.aup.hm<-h.index(mat8.aup.hm)

ep8.aup.hm<-ep(mut8.aup.hm,a8.up.sf.hm)
david8.aup.hm<-DS(mat8.aup.hm) #David's Scores - for steepness use normDS output
ordrank.8.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.hm<-cbind(ordrank.8.aup.hm,ds=david8.aup.hm$normDS)
lm8.aup.hm<-summary(lm(ordrank.8.aup.hm$ds~ordrank.8.aup.hm$ord.rank))
s8.aup.hm<-lm8.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.hm<-data.frame(X1=avoid.up.sf.hm[[25]],X2=avoid.up.sf.hm[[26]],Avoids=avoid.up.sf.hm[[27]])
mat9.aup.hm<-avoid.inter.mat(mut9.aup.hm)
tri9.aup.hm<-tr.tri(mat9.aup.hm)
dci9.aup.hm<-DCindex(mat9.aup.hm)
mat9.aup.hm[is.na(mat9.aup.hm)] = 0
h9.aup.hm<-h.index(mat9.aup.hm)

ep9.aup.hm<-ep(mut9.aup.hm,a9.up.sf.hm)
david9.aup.hm<-DS(mat9.aup.hm) #David's Scores - for steepness use normDS output
ordrank.9.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.hm<-cbind(ordrank.9.aup.hm,ds=david9.aup.hm$normDS)
lm9.aup.hm<-summary(lm(ordrank.9.aup.hm$ds~ordrank.9.aup.hm$ord.rank))
s9.aup.hm<-lm9.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.hm<-data.frame(X1=avoid.up.sf.hm[[28]],X2=avoid.up.sf.hm[[29]],Avoids=avoid.up.sf.hm[[30]])
mat10.aup.hm<-avoid.inter.mat(mut10.aup.hm)
tri10.aup.hm<-tr.tri(mat10.aup.hm)
dci10.aup.hm<-DCindex(mat10.aup.hm)
mat10.aup.hm[is.na(mat10.aup.hm)] = 0
h10.aup.hm<-h.index(mat10.aup.hm)

ep10.aup.hm<-ep(mut10.aup.hm,a10.up.sf.hm)
david10.aup.hm<-DS(mat10.aup.hm) #David's Scores - for steepness use normDS output
ordrank.10.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.hm<-cbind(ordrank.10.aup.hm,ds=david10.aup.hm$normDS)
lm10.aup.hm<-summary(lm(ordrank.10.aup.hm$ds~ordrank.10.aup.hm$ord.rank))
s10.aup.hm<-lm10.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.hm<-sum(mut1.aup.hm$Victories)
int2.aup.hm<-sum(mut2.aup.hm$Victories)
int3.aup.hm<-sum(mut3.aup.hm$Victories)
int4.aup.hm<-sum(mut4.aup.hm$Victories)
int5.aup.hm<-sum(mut5.aup.hm$Victories)
int6.aup.hm<-sum(mut6.aup.hm$Victories)
int7.aup.hm<-sum(mut7.aup.hm$Victories)
int8.aup.hm<-sum(mut8.aup.hm$Victories)
int9.aup.hm<-sum(mut9.aup.hm$Victories)
int10.aup.hm<-sum(mut10.aup.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.hm<-sum(a1.up.sf.hm$Victories)
av2.aup.hm<-sum(a2.up.sf.hm$Victories)
av3.aup.hm<-sum(a3.up.sf.hm$Victories)
av4.aup.hm<-sum(a4.up.sf.hm$Victories)
av5.aup.hm<-sum(a5.up.sf.hm$Victories)
av6.aup.hm<-sum(a6.up.sf.hm$Victories)
av7.aup.hm<-sum(a7.up.sf.hm$Victories)
av8.aup.hm<-sum(a8.up.sf.hm$Victories)
av9.aup.hm<-sum(a9.up.sf.hm$Victories)
av10.aup.hm<-sum(a10.up.sf.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.adu<-(sum(av1.aup.hm, av2.aup.hm, av3.aup.hm, av4.aup.hm, av5.aup.hm, av6.aup.hm, av7.aup.hm, av8.aup.hm, av9.aup.hm, av10.aup.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.adu<-(sum(int1.aup.hm, int2.aup.hm, int3.aup.hm, int4.aup.hm, int5.aup.hm, int6.aup.hm, int7.aup.hm, int8.aup.hm, int9.aup.hm, int10.aup.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.hm<-e1.aup.hm[order(e1.aup.hm$ID),]
e1.aup.hm<-as.matrix(t(e1.1.aup.hm))

e2.aup.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.hm<-e2.aup.hm[order(e2.aup.hm$ID),]
e2.aup.hm<-as.matrix(t(e2.1.aup.hm))

e3.aup.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.hm<-e3.aup.hm[order(e3.aup.hm$ID),]
e3.aup.hm<-as.matrix(t(e3.1.aup.hm))

e4.aup.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.hm<-e4.aup.hm[order(e4.aup.hm$ID),]
e4.aup.hm<-as.matrix(t(e4.1.aup.hm))

e5.aup.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.hm<-e5.aup.hm[order(e5.aup.hm$ID),]
e5.aup.hm<-as.matrix(t(e5.1.aup.hm))

e6.aup.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.hm<-e6.aup.hm[order(e6.aup.hm$ID),]
e6.aup.hm<-as.matrix(t(e6.1.aup.hm))

e7.aup.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.hm<-e7.aup.hm[order(e7.aup.hm$ID),]
e7.aup.hm<-as.matrix(t(e7.1.aup.hm))

e8.aup.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.hm<-e8.aup.hm[order(e8.aup.hm$ID),]
e8.aup.hm<-as.matrix(t(e8.1.aup.hm))

e9.aup.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.hm<-e9.aup.hm[order(e9.aup.hm$ID),]
e9.aup.hm<-as.matrix(t(e9.1.aup.hm))

e10.aup.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.hm<-e10.aup.hm[order(e10.aup.hm$ID),]
e10.aup.hm<-as.matrix(t(e10.1.aup.hm))

energy.hm.aup.hm<-as.data.frame(matrix(c(e1.aup.hm,e2.aup.hm,e3.aup.hm,e4.aup.hm,e5.aup.hm,e6.aup.hm,e7.aup.hm,e8.aup.hm,e9.aup.hm,e10.aup.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aup.hm<-data.frame(ID=energy.hm.aup.hm$V1,energy_over_distance=energy.hm.aup.hm$V2,energy_over_time=energy.hm.aup.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.hm<-david1.aup.hm[order(david1.aup.hm$ID),]
david1.aup.hm<-as.matrix(t(david1.1.aup.hm))

david2.1.aup.hm<-david2.aup.hm[order(david2.aup.hm$ID),]
david2.aup.hm<-as.matrix(t(david2.1.aup.hm))

david3.1.aup.hm<-david3.aup.hm[order(david3.aup.hm$ID),]
david3.aup.hm<-as.matrix(t(david3.1.aup.hm))

david4.1.aup.hm<-david4.aup.hm[order(david4.aup.hm$ID),]
david4.aup.hm<-as.matrix(t(david4.1.aup.hm))

david5.1.aup.hm<-david5.aup.hm[order(david5.aup.hm$ID),]
david5.aup.hm<-as.matrix(t(david5.1.aup.hm))

david6.1.aup.hm<-david6.aup.hm[order(david6.aup.hm$ID),]
david6.aup.hm<-as.matrix(t(david6.1.aup.hm))

david7.1.aup.hm<-david7.aup.hm[order(david7.aup.hm$ID),]
david7.aup.hm<-as.matrix(t(david7.1.aup.hm))

david8.1.aup.hm<-david8.aup.hm[order(david8.aup.hm$ID),]
david8.aup.hm<-as.matrix(t(david8.1.aup.hm))

david9.1.aup.hm<-david9.aup.hm[order(david9.aup.hm$ID),]
david9.aup.hm<-as.matrix(t(david9.1.aup.hm))

david10.1.aup.hm<-david10.aup.hm[order(david10.aup.hm$ID),]
david10.aup.hm<-as.matrix(t(david10.1.aup.hm))

david.hm.aup.hm<-as.data.frame(matrix(c(david1.aup.hm,david2.aup.hm,david3.aup.hm,david4.aup.hm,david5.aup.hm,david6.aup.hm,david7.aup.hm,david8.aup.hm,david9.aup.hm,david10.aup.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aup.hm<-data.frame(ID=david.hm.aup.hm$V1,DS=david.hm.aup.hm$V2,normDS=david.hm.aup.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aup.hm<-lm(e1.1.aup.hm$energy_over_time~as.numeric(david1.1.aup.hm$normDS))
hm.lm.1.s.aup.hm<-summary(lm.hm.1.aup.hm)$coefficients
hm.1.slope.aup.hm<-hm.lm.1.s.aup.hm[2,1]
lm.hm.2.aup.hm<-lm(e2.1.aup.hm$energy_over_time~as.numeric(david2.1.aup.hm$normDS))
hm.lm.2.s.aup.hm<-summary(lm.hm.2.aup.hm)$coefficients
hm.2.slope.aup.hm<-hm.lm.2.s.aup.hm[2,1]
lm.hm.3.aup.hm<-lm(e3.1.aup.hm$energy_over_time~as.numeric(david3.1.aup.hm$normDS))
hm.lm.3.s.aup.hm<-summary(lm.hm.3.aup.hm)$coefficients
hm.3.slope.aup.hm<-hm.lm.3.s.aup.hm[2,1]
lm.hm.4.aup.hm<-lm(e4.1.aup.hm$energy_over_time~as.numeric(david4.1.aup.hm$normDS))
hm.lm.4.s.aup.hm<-summary(lm.hm.4.aup.hm)$coefficients
hm.4.slope.aup.hm<-hm.lm.4.s.aup.hm[2,1]
lm.hm.5.aup.hm<-lm(e5.1.aup.hm$energy_over_time~as.numeric(david5.1.aup.hm$normDS))
hm.lm.5.s.aup.hm<-summary(lm.hm.5.aup.hm)$coefficients
hm.5.slope.aup.hm<-hm.lm.5.s.aup.hm[2,1]
lm.hm.6.aup.hm<-lm(e6.1.aup.hm$energy_over_time~as.numeric(david6.1.aup.hm$normDS))
hm.lm.6.s.aup.hm<-summary(lm.hm.6.aup.hm)$coefficients
hm.6.slope.aup.hm<-hm.lm.6.s.aup.hm[2,1]
lm.hm.7.aup.hm<-lm(e7.1.aup.hm$energy_over_time~as.numeric(david7.1.aup.hm$normDS))
hm.lm.7.s.aup.hm<-summary(lm.hm.7.aup.hm)$coefficients
hm.7.slope.aup.hm<-hm.lm.7.s.aup.hm[2,1]
lm.hm.8.aup.hm<-lm(e8.1.aup.hm$energy_over_time~as.numeric(david8.1.aup.hm$normDS))
hm.lm.8.s.aup.hm<-summary(lm.hm.8.aup.hm)$coefficients
hm.8.slope.aup.hm<-hm.lm.8.s.aup.hm[2,1]
lm.hm.9.aup.hm<-lm(e9.1.aup.hm$energy_over_time~as.numeric(david9.1.aup.hm$normDS))
hm.lm.9.s.aup.hm<-summary(lm.hm.9.aup.hm)$coefficients
hm.9.slope.aup.hm<-hm.lm.9.s.aup.hm[2,1]
lm.hm.10.aup.hm<-lm(e10.1.aup.hm$energy_over_time~as.numeric(david10.1.aup.hm$normDS))
hm.lm.10.s.aup.hm<-summary(lm.hm.10.aup.hm)$coefficients
hm.10.slope.aup.hm<-hm.lm.10.s.aup.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aup.ss.avoid.up.sf.hm<-data.frame(triangle.transitivity=c(tri1.aup.hm,tri2.aup.hm,tri3.aup.hm,tri4.aup.hm,tri5.aup.hm,tri6.aup.hm,tri7.aup.hm,tri8.aup.hm,tri9.aup.hm,tri10.aup.hm),escalation=c(ep1.aup.hm,ep2.aup.hm,ep3.aup.hm,ep4.aup.hm,ep5.aup.hm,ep6.aup.hm,ep7.aup.hm,ep8.aup.hm,ep9.aup.hm,ep10.aup.hm),dci=c(dci1.aup.hm,dci2.aup.hm,dci3.aup.hm,dci4.aup.hm,dci5.aup.hm,dci6.aup.hm,dci7.aup.hm,dci8.aup.hm,dci9.aup.hm,dci10.aup.hm),steepness=c(s1.aup.hm,s2.aup.hm,s3.aup.hm,s4.aup.hm,s5.aup.hm,s6.aup.hm,s7.aup.hm,s8.aup.hm,s9.aup.hm,s10.aup.hm),slope=c(hm.1.slope.aup.hm,hm.2.slope.aup.hm,hm.3.slope.aup.hm,hm.4.slope.aup.hm,hm.5.slope.aup.hm,hm.6.slope.aup.hm,hm.7.slope.aup.hm,hm.8.slope.aup.hm,hm.9.slope.aup.hm,hm.10.slope.aup.hm))


```
```{r Avoids Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$dci)
km.esc.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$escalation)
km.steep.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$steepness)
km.slope.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$dci)
hm.esc.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,hm.mean.adu.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$dci)
km.esc.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$escalation)
km.steep.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$steepness)
km.slope.adu.avoid<-mean(km.aup.ss.avoid.up.sf.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$dci)
hm.esc.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aup.ss.avoid.up.sf.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,hm.mean.adu.avoid)

#create overall dataframe of summary statistics
overall.prob.sf.unif.sf.avoid<-data.frame(km.aup.ss.avoid.up.sf.km)
overall.prob.sf.unif.sf.avoid<-rbind(overall.prob.sf.unif.sf.avoid,hm.aup.ss.avoid.up.sf.hm)

overall.prob.sf.unif.sf.avoid<-cbind(overall.prob.sf.unif.sf.avoid,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.unif.sf.avoid<-cbind(overall.prob.sf.unif.sf.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("prob",20))


rhp.ss.avoid<-overall.prob.sf.unif.sf.avoid[overall.prob.sf.unif.sf.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.sf.unif.sf.avoid[overall.prob.sf.unif.sf.avoid$variable=="history",]

overall.prob.sf.unif.sf.avoid$combo<-paste(overall.prob.sf.unif.sf.avoid$strategy,overall.prob.sf.unif.sf.avoid$variable,overall.prob.sf.unif.sf.avoid$distribution)
overall.prob.sf.unif.sf.avoid$combo2<-paste(overall.prob.sf.unif.sf.avoid$strategy,overall.prob.sf.unif.sf.avoid$variable)
```

## Attacks Uniform Probabilistic Data
```{r Attacks Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.km<-sapply(files, read.csv)

# Generate attacks.atup.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atup.km<-data.frame(X1=attacks.atup.km[[1]],X2=attacks.atup.km[[2]],Victories=attacks.atup.km[[3]])
mat1.atup.km<-inter.mat(mut1.atup.km)
tri1.atup.km<-tr.tri(mat1.atup.km)
dci1.atup.km<-DCindex(mat1.atup.km)
mat1.atup.km[is.na(mat1.atup.km)] = 0
h1.atup.km<-h.index(mat1.atup.km)

ep1.atup.km<-ep(mut1.atup.km,a1.up.sf.km)
david1.atup.km<-DS(mat1.atup.km) #David's Scores - for steepness use normDS output
ordrank.1.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.km<-cbind(ordrank.1.atup.km,ds=david1.atup.km$normDS)
lm1.atup.km<-summary(lm(ordrank.1.atup.km$ds~ordrank.1.atup.km$ord.rank))
s1.atup.km<-lm1.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.km<-data.frame(X1=attacks.atup.km[[4]],X2=attacks.atup.km[[5]],Victories=attacks.atup.km[[6]])
mat2.atup.km<-inter.mat(mut2.atup.km)
tri2.atup.km<-tr.tri(mat2.atup.km)
dci2.atup.km<-DCindex(mat2.atup.km)
mat2.atup.km[is.na(mat2.atup.km)] = 0
h2.atup.km<-h.index(mat2.atup.km)

ep2.atup.km<-ep(mut2.atup.km,a2.up.sf.km)
david2.atup.km<-DS(mat2.atup.km) #David's Scores - for steepness use normDS output
ordrank.2.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.km<-cbind(ordrank.2.atup.km,ds=david2.atup.km$normDS)
lm2.atup.km<-summary(lm(ordrank.2.atup.km$ds~ordrank.2.atup.km$ord.rank))
s2.atup.km<-lm2.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.km<-data.frame(X1=attacks.atup.km[[7]],X2=attacks.atup.km[[8]],Victories=attacks.atup.km[[9]])
mat3.atup.km<-inter.mat(mut3.atup.km)
tri3.atup.km<-tr.tri(mat3.atup.km)
dci3.atup.km<-DCindex(mat3.atup.km)
mat3.atup.km[is.na(mat3.atup.km)] = 0
h3.atup.km<-h.index(mat3.atup.km)

ep3.atup.km<-ep(mut3.atup.km,a3.up.sf.km)
david3.atup.km<-DS(mat3.atup.km) #David's Scores - for steepness use normDS output
ordrank.3.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.km<-cbind(ordrank.3.atup.km,ds=david3.atup.km$normDS)
lm3.atup.km<-summary(lm(ordrank.3.atup.km$ds~ordrank.3.atup.km$ord.rank))
s3.atup.km<-lm3.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.km<-data.frame(X1=attacks.atup.km[[10]],X2=attacks.atup.km[[11]],Victories=attacks.atup.km[[12]])
mat4.atup.km<-inter.mat(mut4.atup.km)
tri4.atup.km<-tr.tri(mat4.atup.km)
dci4.atup.km<-DCindex(mat4.atup.km)
mat4.atup.km[is.na(mat4.atup.km)] = 0
h4.atup.km<-h.index(mat4.atup.km)

ep4.atup.km<-ep(mut4.atup.km,a4.up.sf.km)
david4.atup.km<-DS(mat4.atup.km) #David's Scores - for steepness use normDS output
ordrank.4.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.km<-cbind(ordrank.4.atup.km,ds=david4.atup.km$normDS)
lm4.atup.km<-summary(lm(ordrank.4.atup.km$ds~ordrank.4.atup.km$ord.rank))
s4.atup.km<-lm4.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.km<-data.frame(X1=attacks.atup.km[[13]],X2=attacks.atup.km[[14]],Victories=attacks.atup.km[[15]])
mat5.atup.km<-inter.mat(mut5.atup.km)
tri5.atup.km<-tr.tri(mat5.atup.km)
dci5.atup.km<-DCindex(mat5.atup.km)
mat5.atup.km[is.na(mat5.atup.km)] = 0
h5.atup.km<-h.index(mat5.atup.km)

ep5.atup.km<-ep(mut5.atup.km,a5.up.sf.km)
david5.atup.km<-DS(mat5.atup.km) #David's Scores - for steepness use normDS output
ordrank.5.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.km<-cbind(ordrank.5.atup.km,ds=david5.atup.km$normDS)
lm5.atup.km<-summary(lm(ordrank.5.atup.km$ds~ordrank.5.atup.km$ord.rank))
s5.atup.km<-lm5.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.km<-data.frame(X1=attacks.atup.km[[16]],X2=attacks.atup.km[[17]],Victories=attacks.atup.km[[18]])
mat6.atup.km<-inter.mat(mut6.atup.km)
tri6.atup.km<-tr.tri(mat6.atup.km)
dci6.atup.km<-DCindex(mat6.atup.km)
mat6.atup.km[is.na(mat6.atup.km)] = 0
h6.atup.km<-h.index(mat6.atup.km)

ep6.atup.km<-ep(mut6.atup.km,a6.up.sf.km)
david6.atup.km<-DS(mat6.atup.km) #David's Scores - for steepness use normDS output
ordrank.6.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.km<-cbind(ordrank.6.atup.km,ds=david6.atup.km$normDS)
lm6.atup.km<-summary(lm(ordrank.6.atup.km$ds~ordrank.6.atup.km$ord.rank))
s6.atup.km<-lm6.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.km<-data.frame(X1=attacks.atup.km[[19]],X2=attacks.atup.km[[20]],Victories=attacks.atup.km[[21]])
mat7.atup.km<-inter.mat(mut7.atup.km)
tri7.atup.km<-tr.tri(mat7.atup.km)
dci7.atup.km<-DCindex(mat7.atup.km)
mat7.atup.km[is.na(mat7.atup.km)] = 0
h7.atup.km<-h.index(mat7.atup.km)

ep7.atup.km<-ep(mut7.atup.km,a7.up.sf.km)
david7.atup.km<-DS(mat7.atup.km) #David's Scores - for steepness use normDS output
ordrank.7.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.km<-cbind(ordrank.7.atup.km,ds=david7.atup.km$normDS)
lm7.atup.km<-summary(lm(ordrank.7.atup.km$ds~ordrank.7.atup.km$ord.rank))
s7.atup.km<-lm7.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.km<-data.frame(X1=attacks.atup.km[[22]],X2=attacks.atup.km[[23]],Victories=attacks.atup.km[[24]])
mat8.atup.km<-inter.mat(mut8.atup.km)
tri8.atup.km<-tr.tri(mat8.atup.km)
dci8.atup.km<-DCindex(mat8.atup.km)
mat8.atup.km[is.na(mat8.atup.km)] = 0
h8.atup.km<-h.index(mat8.atup.km)

ep8.atup.km<-ep(mut8.atup.km,a8.up.sf.km)
david8.atup.km<-DS(mat8.atup.km) #David's Scores - for steepness use normDS output
ordrank.8.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.km<-cbind(ordrank.8.atup.km,ds=david8.atup.km$normDS)
lm8.atup.km<-summary(lm(ordrank.8.atup.km$ds~ordrank.8.atup.km$ord.rank))
s8.atup.km<-lm8.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.km<-data.frame(X1=attacks.atup.km[[25]],X2=attacks.atup.km[[26]],Victories=attacks.atup.km[[27]])
mat9.atup.km<-inter.mat(mut9.atup.km)
tri9.atup.km<-tr.tri(mat9.atup.km)
dci9.atup.km<-DCindex(mat9.atup.km)
mat9.atup.km[is.na(mat9.atup.km)] = 0
h9.atup.km<-h.index(mat9.atup.km)

ep9.atup.km<-ep(mut9.atup.km,a9.up.sf.km)
david9.atup.km<-DS(mat9.atup.km) #David's Scores - for steepness use normDS output
ordrank.9.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.km<-cbind(ordrank.9.atup.km,ds=david9.atup.km$normDS)
lm9.atup.km<-summary(lm(ordrank.9.atup.km$ds~ordrank.9.atup.km$ord.rank))
s9.atup.km<-lm9.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.km<-data.frame(X1=attacks.atup.km[[28]],X2=attacks.atup.km[[29]],Victories=attacks.atup.km[[30]])
mat10.atup.km<-inter.mat(mut10.atup.km)
tri10.atup.km<-tr.tri(mat10.atup.km)
dci10.atup.km<-DCindex(mat10.atup.km)
mat10.atup.km[is.na(mat10.atup.km)] = 0
h10.atup.km<-h.index(mat10.atup.km)

ep10.atup.km<-ep(mut10.atup.km,a10.up.sf.km)
david10.atup.km<-DS(mat10.atup.km) #David's Scores - for steepness use normDS output
ordrank.10.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.km<-cbind(ordrank.10.atup.km,ds=david10.atup.km$normDS)
lm10.atup.km<-summary(lm(ordrank.10.atup.km$ds~ordrank.10.atup.km$ord.rank))
s10.atup.km<-lm10.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.km<-sum(mut1.atup.km$Victories)
int2.atup.km<-sum(mut2.atup.km$Victories)
int3.atup.km<-sum(mut3.atup.km$Victories)
int4.atup.km<-sum(mut4.atup.km$Victories)
int5.atup.km<-sum(mut5.atup.km$Victories)
int6.atup.km<-sum(mut6.atup.km$Victories)
int7.atup.km<-sum(mut7.atup.km$Victories)
int8.atup.km<-sum(mut8.atup.km$Victories)
int9.atup.km<-sum(mut9.atup.km$Victories)
int10.atup.km<-sum(mut10.atup.km$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.km<-sum(a1.up.sf.km$Victories)
av2.atup.km<-sum(a2.up.sf.km$Victories)
av3.atup.km<-sum(a3.up.sf.km$Victories)
av4.atup.km<-sum(a4.up.sf.km$Victories)
av5.atup.km<-sum(a5.up.sf.km$Victories)
av6.atup.km<-sum(a6.up.sf.km$Victories)
av7.atup.km<-sum(a7.up.sf.km$Victories)
av8.atup.km<-sum(a8.up.sf.km$Victories)
av9.atup.km<-sum(a9.up.sf.km$Victories)
av10.atup.km<-sum(a10.up.sf.km$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.km.atdu<-(sum(av1.atup.km, av2.atup.km, av3.atup.km, av4.atup.km, av5.atup.km, av6.atup.km, av7.atup.km, av8.atup.km, av9.atup.km, av10.atup.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.atdu<-(sum(int1.atup.km, int2.atup.km, int3.atup.km, int4.atup.km, int5.atup.km, int6.atup.km, int7.atup.km, int8.atup.km, int9.atup.km, int10.atup.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.km<-e1.atup.km[order(e1.atup.km$ID),]
e1.atup.km<-as.matrix(t(e1.1.atup.km))

e2.atup.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.km<-e2.atup.km[order(e2.atup.km$ID),]
e2.atup.km<-as.matrix(t(e2.1.atup.km))

e3.atup.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.km<-e3.atup.km[order(e3.atup.km$ID),]
e3.atup.km<-as.matrix(t(e3.1.atup.km))

e4.atup.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.km<-e4.atup.km[order(e4.atup.km$ID),]
e4.atup.km<-as.matrix(t(e4.1.atup.km))

e5.atup.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.km<-e5.atup.km[order(e5.atup.km$ID),]
e5.atup.km<-as.matrix(t(e5.1.atup.km))

e6.atup.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.km<-e6.atup.km[order(e6.atup.km$ID),]
e6.atup.km<-as.matrix(t(e6.1.atup.km))

e7.atup.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.km<-e7.atup.km[order(e7.atup.km$ID),]
e7.atup.km<-as.matrix(t(e7.1.atup.km))

e8.atup.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.km<-e8.atup.km[order(e8.atup.km$ID),]
e8.atup.km<-as.matrix(t(e8.1.atup.km))

e9.atup.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.km<-e9.atup.km[order(e9.atup.km$ID),]
e9.atup.km<-as.matrix(t(e9.1.atup.km))

e10.atup.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.km<-e10.atup.km[order(e10.atup.km$ID),]
e10.atup.km<-as.matrix(t(e10.1.atup.km))

energy.km.atup.km<-as.data.frame(matrix(c(e1.atup.km,e2.atup.km,e3.atup.km,e4.atup.km,e5.atup.km,e6.atup.km,e7.atup.km,e8.atup.km,e9.atup.km,e10.atup.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atup.km<-data.frame(ID=energy.km.atup.km$V1,energy_over_distance=energy.km.atup.km$V2,energy_over_time=energy.km.atup.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.km<-david1.atup.km[order(david1.atup.km$ID),]
david1.atup.km<-as.matrix(t(david1.1.atup.km))

david2.1.atup.km<-david2.atup.km[order(david2.atup.km$ID),]
david2.atup.km<-as.matrix(t(david2.1.atup.km))

david3.1.atup.km<-david3.atup.km[order(david3.atup.km$ID),]
david3.atup.km<-as.matrix(t(david3.1.atup.km))

david4.1.atup.km<-david4.atup.km[order(david4.atup.km$ID),]
david4.atup.km<-as.matrix(t(david4.1.atup.km))

david5.1.atup.km<-david5.atup.km[order(david5.atup.km$ID),]
david5.atup.km<-as.matrix(t(david5.1.atup.km))

david6.1.atup.km<-david6.atup.km[order(david6.atup.km$ID),]
david6.atup.km<-as.matrix(t(david6.1.atup.km))

david7.1.atup.km<-david7.atup.km[order(david7.atup.km$ID),]
david7.atup.km<-as.matrix(t(david7.1.atup.km))

david8.1.atup.km<-david8.atup.km[order(david8.atup.km$ID),]
david8.atup.km<-as.matrix(t(david8.1.atup.km))

david9.1.atup.km<-david9.atup.km[order(david9.atup.km$ID),]
david9.atup.km<-as.matrix(t(david9.1.atup.km))

david10.1.atup.km<-david10.atup.km[order(david10.atup.km$ID),]
david10.atup.km<-as.matrix(t(david10.1.atup.km))

david.km.atup.km<-as.data.frame(matrix(c(david1.atup.km,david2.atup.km,david3.atup.km,david4.atup.km,david5.atup.km,david6.atup.km,david7.atup.km,david8.atup.km,david9.atup.km,david10.atup.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atup.km<-data.frame(ID=david.km.atup.km$V1,DS=david.km.atup.km$V2,normDS=david.km.atup.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atup.km<-lm(e1.1.atup.km$energy_over_time~as.numeric(david1.1.atup.km$normDS))
km.lm.1.s.atup.km<-summary(lm.km.1.atup.km)$coefficients
km.1.slope.atup.km<-km.lm.1.s.atup.km[2,1]
lm.km.2.atup.km<-lm(e2.1.atup.km$energy_over_time~as.numeric(david2.1.atup.km$normDS))
km.lm.2.s.atup.km<-summary(lm.km.2.atup.km)$coefficients
km.2.slope.atup.km<-km.lm.2.s.atup.km[2,1]
lm.km.3.atup.km<-lm(e3.1.atup.km$energy_over_time~as.numeric(david3.1.atup.km$normDS))
km.lm.3.s.atup.km<-summary(lm.km.3.atup.km)$coefficients
km.3.slope.atup.km<-km.lm.3.s.atup.km[2,1]
lm.km.4.atup.km<-lm(e4.1.atup.km$energy_over_time~as.numeric(david4.1.atup.km$normDS))
km.lm.4.s.atup.km<-summary(lm.km.4.atup.km)$coefficients
km.4.slope.atup.km<-km.lm.4.s.atup.km[2,1]
lm.km.5.atup.km<-lm(e5.1.atup.km$energy_over_time~as.numeric(david5.1.atup.km$normDS))
km.lm.5.s.atup.km<-summary(lm.km.5.atup.km)$coefficients
km.5.slope.atup.km<-km.lm.5.s.atup.km[2,1]
lm.km.6.atup.km<-lm(e6.1.atup.km$energy_over_time~as.numeric(david6.1.atup.km$normDS))
km.lm.6.s.atup.km<-summary(lm.km.6.atup.km)$coefficients
km.6.slope.atup.km<-km.lm.6.s.atup.km[2,1]
lm.km.7.atup.km<-lm(e7.1.atup.km$energy_over_time~as.numeric(david7.1.atup.km$normDS))
km.lm.7.s.atup.km<-summary(lm.km.7.atup.km)$coefficients
km.7.slope.atup.km<-km.lm.7.s.atup.km[2,1]
lm.km.8.atup.km<-lm(e8.1.atup.km$energy_over_time~as.numeric(david8.1.atup.km$normDS))
km.lm.8.s.atup.km<-summary(lm.km.8.atup.km)$coefficients
km.8.slope.atup.km<-km.lm.8.s.atup.km[2,1]
lm.km.9.atup.km<-lm(e9.1.atup.km$energy_over_time~as.numeric(david9.1.atup.km$normDS))
km.lm.9.s.atup.km<-summary(lm.km.9.atup.km)$coefficients
km.9.slope.atup.km<-km.lm.9.s.atup.km[2,1]
lm.km.10.atup.km<-lm(e10.1.atup.km$energy_over_time~as.numeric(david10.1.atup.km$normDS))
km.lm.10.s.atup.km<-summary(lm.km.10.atup.km)$coefficients
km.10.slope.atup.km<-km.lm.10.s.atup.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atup.ss.attacks.atup.km<-data.frame(triangle.transitivity=c(tri1.atup.km,tri2.atup.km,tri3.atup.km,tri4.atup.km,tri5.atup.km,tri6.atup.km,tri7.atup.km,tri8.atup.km,tri9.atup.km,tri10.atup.km),escalation=c(ep1.atup.km,ep2.atup.km,ep3.atup.km,ep4.atup.km,ep5.atup.km,ep6.atup.km,ep7.atup.km,ep8.atup.km,ep9.atup.km,ep10.atup.km),dci=c(dci1.atup.km,dci2.atup.km,dci3.atup.km,dci4.atup.km,dci5.atup.km,dci6.atup.km,dci7.atup.km,dci8.atup.km,dci9.atup.km,dci10.atup.km),steepness=c(s1.atup.km,s2.atup.km,s3.atup.km,s4.atup.km,s5.atup.km,s6.atup.km,s7.atup.km,s8.atup.km,s9.atup.km,s10.atup.km),slope=c(km.1.slope.atup.km,km.2.slope.atup.km,km.3.slope.atup.km,km.4.slope.atup.km,km.5.slope.atup.km,km.6.slope.atup.km,km.7.slope.atup.km,km.8.slope.atup.km,km.9.slope.atup.km,km.10.slope.atup.km))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.hm<-sapply(files, read.csv)

# Generate attacks.atup.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.hm<-data.frame(X1=attacks.atup.hm[[1]],X2=attacks.atup.hm[[2]],Victories=attacks.atup.hm[[3]])
mat1.atup.hm<-inter.mat(mut1.atup.hm)
tri1.atup.hm<-tr.tri(mat1.atup.hm)
dci1.atup.hm<-DCindex(mat1.atup.hm)
mat1.atup.hm[is.na(mat1.atup.hm)] = 0
h1.atup.hm<-h.index(mat1.atup.hm)

ep1.atup.hm<-ep(mut1.atup.hm,a1.up.sf.hm)
david1.atup.hm<-DS(mat1.atup.hm) #David's Scores - for steepness use normDS output
ordrank.1.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.hm<-cbind(ordrank.1.atup.hm,ds=david1.atup.hm$normDS)
lm1.atup.hm<-summary(lm(ordrank.1.atup.hm$ds~ordrank.1.atup.hm$ord.rank))
s1.atup.hm<-lm1.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.hm<-data.frame(X1=attacks.atup.hm[[4]],X2=attacks.atup.hm[[5]],Victories=attacks.atup.hm[[6]])
mat2.atup.hm<-inter.mat(mut2.atup.hm)
tri2.atup.hm<-tr.tri(mat2.atup.hm)
dci2.atup.hm<-DCindex(mat2.atup.hm)
mat2.atup.hm[is.na(mat2.atup.hm)] = 0
h2.atup.hm<-h.index(mat2.atup.hm)

ep2.atup.hm<-ep(mut2.atup.hm,a2.up.sf.hm)
david2.atup.hm<-DS(mat2.atup.hm) #David's Scores - for steepness use normDS output
ordrank.2.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.hm<-cbind(ordrank.2.atup.hm,ds=david2.atup.hm$normDS)
lm2.atup.hm<-summary(lm(ordrank.2.atup.hm$ds~ordrank.2.atup.hm$ord.rank))
s2.atup.hm<-lm2.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.hm<-data.frame(X1=attacks.atup.hm[[7]],X2=attacks.atup.hm[[8]],Victories=attacks.atup.hm[[9]])
mat3.atup.hm<-inter.mat(mut3.atup.hm)
tri3.atup.hm<-tr.tri(mat3.atup.hm)
dci3.atup.hm<-DCindex(mat3.atup.hm)
mat3.atup.hm[is.na(mat3.atup.hm)] = 0
h3.atup.hm<-h.index(mat3.atup.hm)

ep3.atup.hm<-ep(mut3.atup.hm,a3.up.sf.hm)
david3.atup.hm<-DS(mat3.atup.hm) #David's Scores - for steepness use normDS output
ordrank.3.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.hm<-cbind(ordrank.3.atup.hm,ds=david3.atup.hm$normDS)
lm3.atup.hm<-summary(lm(ordrank.3.atup.hm$ds~ordrank.3.atup.hm$ord.rank))
s3.atup.hm<-lm3.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.hm<-data.frame(X1=attacks.atup.hm[[10]],X2=attacks.atup.hm[[11]],Victories=attacks.atup.hm[[12]])
mat4.atup.hm<-inter.mat(mut4.atup.hm)
tri4.atup.hm<-tr.tri(mat4.atup.hm)
dci4.atup.hm<-DCindex(mat4.atup.hm)
mat4.atup.hm[is.na(mat4.atup.hm)] = 0
h4.atup.hm<-h.index(mat4.atup.hm)

ep4.atup.hm<-ep(mut4.atup.hm,a4.up.sf.hm)
david4.atup.hm<-DS(mat4.atup.hm) #David's Scores - for steepness use normDS output
ordrank.4.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.hm<-cbind(ordrank.4.atup.hm,ds=david4.atup.hm$normDS)
lm4.atup.hm<-summary(lm(ordrank.4.atup.hm$ds~ordrank.4.atup.hm$ord.rank))
s4.atup.hm<-lm4.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.hm<-data.frame(X1=attacks.atup.hm[[13]],X2=attacks.atup.hm[[14]],Victories=attacks.atup.hm[[15]])
mat5.atup.hm<-inter.mat(mut5.atup.hm)
tri5.atup.hm<-tr.tri(mat5.atup.hm)
dci5.atup.hm<-DCindex(mat5.atup.hm)
mat5.atup.hm[is.na(mat5.atup.hm)] = 0
h5.atup.hm<-h.index(mat5.atup.hm)

ep5.atup.hm<-ep(mut5.atup.hm,a5.up.sf.hm)
david5.atup.hm<-DS(mat5.atup.hm) #David's Scores - for steepness use normDS output
ordrank.5.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.hm<-cbind(ordrank.5.atup.hm,ds=david5.atup.hm$normDS)
lm5.atup.hm<-summary(lm(ordrank.5.atup.hm$ds~ordrank.5.atup.hm$ord.rank))
s5.atup.hm<-lm5.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.hm<-data.frame(X1=attacks.atup.hm[[16]],X2=attacks.atup.hm[[17]],Victories=attacks.atup.hm[[18]])
mat6.atup.hm<-inter.mat(mut6.atup.hm)
tri6.atup.hm<-tr.tri(mat6.atup.hm)
dci6.atup.hm<-DCindex(mat6.atup.hm)
mat6.atup.hm[is.na(mat6.atup.hm)] = 0
h6.atup.hm<-h.index(mat6.atup.hm)

ep6.atup.hm<-ep(mut6.atup.hm,a6.up.sf.hm)
david6.atup.hm<-DS(mat6.atup.hm) #David's Scores - for steepness use normDS output
ordrank.6.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.hm<-cbind(ordrank.6.atup.hm,ds=david6.atup.hm$normDS)
lm6.atup.hm<-summary(lm(ordrank.6.atup.hm$ds~ordrank.6.atup.hm$ord.rank))
s6.atup.hm<-lm6.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.hm<-data.frame(X1=attacks.atup.hm[[19]],X2=attacks.atup.hm[[20]],Victories=attacks.atup.hm[[21]])
mat7.atup.hm<-inter.mat(mut7.atup.hm)
tri7.atup.hm<-tr.tri(mat7.atup.hm)
dci7.atup.hm<-DCindex(mat7.atup.hm)
mat7.atup.hm[is.na(mat7.atup.hm)] = 0
h7.atup.hm<-h.index(mat7.atup.hm)

ep7.atup.hm<-ep(mut7.atup.hm,a7.up.sf.hm)
david7.atup.hm<-DS(mat7.atup.hm) #David's Scores - for steepness use normDS output
ordrank.7.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.hm<-cbind(ordrank.7.atup.hm,ds=david7.atup.hm$normDS)
lm7.atup.hm<-summary(lm(ordrank.7.atup.hm$ds~ordrank.7.atup.hm$ord.rank))
s7.atup.hm<-lm7.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.hm<-data.frame(X1=attacks.atup.hm[[22]],X2=attacks.atup.hm[[23]],Victories=attacks.atup.hm[[24]])
mat8.atup.hm<-inter.mat(mut8.atup.hm)
tri8.atup.hm<-tr.tri(mat8.atup.hm)
dci8.atup.hm<-DCindex(mat8.atup.hm)
mat8.atup.hm[is.na(mat8.atup.hm)] = 0
h8.atup.hm<-h.index(mat8.atup.hm)

ep8.atup.hm<-ep(mut8.atup.hm,a8.up.sf.hm)
david8.atup.hm<-DS(mat8.atup.hm) #David's Scores - for steepness use normDS output
ordrank.8.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.hm<-cbind(ordrank.8.atup.hm,ds=david8.atup.hm$normDS)
lm8.atup.hm<-summary(lm(ordrank.8.atup.hm$ds~ordrank.8.atup.hm$ord.rank))
s8.atup.hm<-lm8.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.hm<-data.frame(X1=attacks.atup.hm[[25]],X2=attacks.atup.hm[[26]],Victories=attacks.atup.hm[[27]])
mat9.atup.hm<-inter.mat(mut9.atup.hm)
tri9.atup.hm<-tr.tri(mat9.atup.hm)
dci9.atup.hm<-DCindex(mat9.atup.hm)
mat9.atup.hm[is.na(mat9.atup.hm)] = 0
h9.atup.hm<-h.index(mat9.atup.hm)

ep9.atup.hm<-ep(mut9.atup.hm,a9.up.sf.hm)
david9.atup.hm<-DS(mat9.atup.hm) #David's Scores - for steepness use normDS output
ordrank.9.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.hm<-cbind(ordrank.9.atup.hm,ds=david9.atup.hm$normDS)
lm9.atup.hm<-summary(lm(ordrank.9.atup.hm$ds~ordrank.9.atup.hm$ord.rank))
s9.atup.hm<-lm9.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.hm<-data.frame(X1=attacks.atup.hm[[28]],X2=attacks.atup.hm[[29]],Victories=attacks.atup.hm[[30]])
mat10.atup.hm<-inter.mat(mut10.atup.hm)
tri10.atup.hm<-tr.tri(mat10.atup.hm)
dci10.atup.hm<-DCindex(mat10.atup.hm)
mat10.atup.hm[is.na(mat10.atup.hm)] = 0
h10.atup.hm<-h.index(mat10.atup.hm)

ep10.atup.hm<-ep(mut10.atup.hm,a10.up.sf.hm)
david10.atup.hm<-DS(mat10.atup.hm) #David's Scores - for steepness use normDS output
ordrank.10.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.hm<-cbind(ordrank.10.atup.hm,ds=david10.atup.hm$normDS)
lm10.atup.hm<-summary(lm(ordrank.10.atup.hm$ds~ordrank.10.atup.hm$ord.rank))
s10.atup.hm<-lm10.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.hm<-sum(mut1.atup.hm$Victories)
int2.atup.hm<-sum(mut2.atup.hm$Victories)
int3.atup.hm<-sum(mut3.atup.hm$Victories)
int4.atup.hm<-sum(mut4.atup.hm$Victories)
int5.atup.hm<-sum(mut5.atup.hm$Victories)
int6.atup.hm<-sum(mut6.atup.hm$Victories)
int7.atup.hm<-sum(mut7.atup.hm$Victories)
int8.atup.hm<-sum(mut8.atup.hm$Victories)
int9.atup.hm<-sum(mut9.atup.hm$Victories)
int10.atup.hm<-sum(mut10.atup.hm$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.hm<-sum(a1.up.sf.hm$Victories)
av2.atup.hm<-sum(a2.up.sf.hm$Victories)
av3.atup.hm<-sum(a3.up.sf.hm$Victories)
av4.atup.hm<-sum(a4.up.sf.hm$Victories)
av5.atup.hm<-sum(a5.up.sf.hm$Victories)
av6.atup.hm<-sum(a6.up.sf.hm$Victories)
av7.atup.hm<-sum(a7.up.sf.hm$Victories)
av8.atup.hm<-sum(a8.up.sf.hm$Victories)
av9.atup.hm<-sum(a9.up.sf.hm$Victories)
av10.atup.hm<-sum(a10.up.sf.hm$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.hm.atdu<-(sum(av1.atup.hm, av2.atup.hm, av3.atup.hm, av4.atup.hm, av5.atup.hm, av6.atup.hm, av7.atup.hm, av8.atup.hm, av9.atup.hm, av10.atup.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.atdu<-(sum(int1.atup.hm, int2.atup.hm, int3.atup.hm, int4.atup.hm, int5.atup.hm, int6.atup.hm, int7.atup.hm, int8.atup.hm, int9.atup.hm, int10.atup.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/SET/YOUR/WORKING/DIRECTORY/despotism full results 12.23.22/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.hm<-e1.atup.hm[order(e1.atup.hm$ID),]
e1.atup.hm<-as.matrix(t(e1.1.atup.hm))

e2.atup.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.hm<-e2.atup.hm[order(e2.atup.hm$ID),]
e2.atup.hm<-as.matrix(t(e2.1.atup.hm))

e3.atup.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.hm<-e3.atup.hm[order(e3.atup.hm$ID),]
e3.atup.hm<-as.matrix(t(e3.1.atup.hm))

e4.atup.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.hm<-e4.atup.hm[order(e4.atup.hm$ID),]
e4.atup.hm<-as.matrix(t(e4.1.atup.hm))

e5.atup.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.hm<-e5.atup.hm[order(e5.atup.hm$ID),]
e5.atup.hm<-as.matrix(t(e5.1.atup.hm))

e6.atup.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.hm<-e6.atup.hm[order(e6.atup.hm$ID),]
e6.atup.hm<-as.matrix(t(e6.1.atup.hm))

e7.atup.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.hm<-e7.atup.hm[order(e7.atup.hm$ID),]
e7.atup.hm<-as.matrix(t(e7.1.atup.hm))

e8.atup.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.hm<-e8.atup.hm[order(e8.atup.hm$ID),]
e8.atup.hm<-as.matrix(t(e8.1.atup.hm))

e9.atup.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.hm<-e9.atup.hm[order(e9.atup.hm$ID),]
e9.atup.hm<-as.matrix(t(e9.1.atup.hm))

e10.atup.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.hm<-e10.atup.hm[order(e10.atup.hm$ID),]
e10.atup.hm<-as.matrix(t(e10.1.atup.hm))

energy.hm.atup.hm<-as.data.frame(matrix(c(e1.atup.hm,e2.atup.hm,e3.atup.hm,e4.atup.hm,e5.atup.hm,e6.atup.hm,e7.atup.hm,e8.atup.hm,e9.atup.hm,e10.atup.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atup.hm<-data.frame(ID=energy.hm.atup.hm$V1,energy_over_distance=energy.hm.atup.hm$V2,energy_over_time=energy.hm.atup.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.hm<-david1.atup.hm[order(david1.atup.hm$ID),]
david1.atup.hm<-as.matrix(t(david1.1.atup.hm))

david2.1.atup.hm<-david2.atup.hm[order(david2.atup.hm$ID),]
david2.atup.hm<-as.matrix(t(david2.1.atup.hm))

david3.1.atup.hm<-david3.atup.hm[order(david3.atup.hm$ID),]
david3.atup.hm<-as.matrix(t(david3.1.atup.hm))

david4.1.atup.hm<-david4.atup.hm[order(david4.atup.hm$ID),]
david4.atup.hm<-as.matrix(t(david4.1.atup.hm))

david5.1.atup.hm<-david5.atup.hm[order(david5.atup.hm$ID),]
david5.atup.hm<-as.matrix(t(david5.1.atup.hm))

david6.1.atup.hm<-david6.atup.hm[order(david6.atup.hm$ID),]
david6.atup.hm<-as.matrix(t(david6.1.atup.hm))

david7.1.atup.hm<-david7.atup.hm[order(david7.atup.hm$ID),]
david7.atup.hm<-as.matrix(t(david7.1.atup.hm))

david8.1.atup.hm<-david8.atup.hm[order(david8.atup.hm$ID),]
david8.atup.hm<-as.matrix(t(david8.1.atup.hm))

david9.1.atup.hm<-david9.atup.hm[order(david9.atup.hm$ID),]
david9.atup.hm<-as.matrix(t(david9.1.atup.hm))

david10.1.atup.hm<-david10.atup.hm[order(david10.atup.hm$ID),]
david10.atup.hm<-as.matrix(t(david10.1.atup.hm))

david.hm.atup.hm<-as.data.frame(matrix(c(david1.atup.hm,david2.atup.hm,david3.atup.hm,david4.atup.hm,david5.atup.hm,david6.atup.hm,david7.atup.hm,david8.atup.hm,david9.atup.hm,david10.atup.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atup.hm<-data.frame(ID=david.hm.atup.hm$V1,DS=david.hm.atup.hm$V2,normDS=david.hm.atup.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atup.hm<-lm(e1.1.atup.hm$energy_over_time~as.numeric(david1.1.atup.hm$normDS))
hm.lm.1.s.atup.hm<-summary(lm.hm.1.atup.hm)$coefficients
hm.1.slope.atup.hm<-hm.lm.1.s.atup.hm[2,1]
lm.hm.2.atup.hm<-lm(e2.1.atup.hm$energy_over_time~as.numeric(david2.1.atup.hm$normDS))
hm.lm.2.s.atup.hm<-summary(lm.hm.2.atup.hm)$coefficients
hm.2.slope.atup.hm<-hm.lm.2.s.atup.hm[2,1]
lm.hm.3.atup.hm<-lm(e3.1.atup.hm$energy_over_time~as.numeric(david3.1.atup.hm$normDS))
hm.lm.3.s.atup.hm<-summary(lm.hm.3.atup.hm)$coefficients
hm.3.slope.atup.hm<-hm.lm.3.s.atup.hm[2,1]
lm.hm.4.atup.hm<-lm(e4.1.atup.hm$energy_over_time~as.numeric(david4.1.atup.hm$normDS))
hm.lm.4.s.atup.hm<-summary(lm.hm.4.atup.hm)$coefficients
hm.4.slope.atup.hm<-hm.lm.4.s.atup.hm[2,1]
lm.hm.5.atup.hm<-lm(e5.1.atup.hm$energy_over_time~as.numeric(david5.1.atup.hm$normDS))
hm.lm.5.s.atup.hm<-summary(lm.hm.5.atup.hm)$coefficients
hm.5.slope.atup.hm<-hm.lm.5.s.atup.hm[2,1]
lm.hm.6.atup.hm<-lm(e6.1.atup.hm$energy_over_time~as.numeric(david6.1.atup.hm$normDS))
hm.lm.6.s.atup.hm<-summary(lm.hm.6.atup.hm)$coefficients
hm.6.slope.atup.hm<-hm.lm.6.s.atup.hm[2,1]
lm.hm.7.atup.hm<-lm(e7.1.atup.hm$energy_over_time~as.numeric(david7.1.atup.hm$normDS))
hm.lm.7.s.atup.hm<-summary(lm.hm.7.atup.hm)$coefficients
hm.7.slope.atup.hm<-hm.lm.7.s.atup.hm[2,1]
lm.hm.8.atup.hm<-lm(e8.1.atup.hm$energy_over_time~as.numeric(david8.1.atup.hm$normDS))
hm.lm.8.s.atup.hm<-summary(lm.hm.8.atup.hm)$coefficients
hm.8.slope.atup.hm<-hm.lm.8.s.atup.hm[2,1]
lm.hm.9.atup.hm<-lm(e9.1.atup.hm$energy_over_time~as.numeric(david9.1.atup.hm$normDS))
hm.lm.9.s.atup.hm<-summary(lm.hm.9.atup.hm)$coefficients
hm.9.slope.atup.hm<-hm.lm.9.s.atup.hm[2,1]
lm.hm.10.atup.hm<-lm(e10.1.atup.hm$energy_over_time~as.numeric(david10.1.atup.hm$normDS))
hm.lm.10.s.atup.hm<-summary(lm.hm.10.atup.hm)$coefficients
hm.10.slope.atup.hm<-hm.lm.10.s.atup.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atup.ss.attacks.atup.hm<-data.frame(triangle.transitivity=c(tri1.atup.hm,tri2.atup.hm,tri3.atup.hm,tri4.atup.hm,tri5.atup.hm,tri6.atup.hm,tri7.atup.hm,tri8.atup.hm,tri9.atup.hm,tri10.atup.hm),escalation=c(ep1.atup.hm,ep2.atup.hm,ep3.atup.hm,ep4.atup.hm,ep5.atup.hm,ep6.atup.hm,ep7.atup.hm,ep8.atup.hm,ep9.atup.hm,ep10.atup.hm),dci=c(dci1.atup.hm,dci2.atup.hm,dci3.atup.hm,dci4.atup.hm,dci5.atup.hm,dci6.atup.hm,dci7.atup.hm,dci8.atup.hm,dci9.atup.hm,dci10.atup.hm),steepness=c(s1.atup.hm,s2.atup.hm,s3.atup.hm,s4.atup.hm,s5.atup.hm,s6.atup.hm,s7.atup.hm,s8.atup.hm,s9.atup.hm,s10.atup.hm),slope=c(hm.1.slope.atup.hm,hm.2.slope.atup.hm,hm.3.slope.atup.hm,hm.4.slope.atup.hm,hm.5.slope.atup.hm,hm.6.slope.atup.hm,hm.7.slope.atup.hm,hm.8.slope.atup.hm,hm.9.slope.atup.hm,hm.10.slope.atup.hm))


```
```{r attacks Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$dci)
km.esc.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$escalation)
km.steep.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$steepness)
km.slope.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,hm.mean.atdu.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$dci)
km.esc.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$escalation)
km.steep.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$steepness)
km.slope.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,hm.mean.atdu.attacks)

#create overall dataframe of summary statistics
overall.prob.sf.unif.sf.attacks<-data.frame(km.atup.ss.attacks.atup.km)
overall.prob.sf.unif.sf.attacks<-rbind(overall.prob.sf.unif.sf.attacks,hm.atup.ss.attacks.atup.hm)

overall.prob.sf.unif.sf.attacks<-cbind(overall.prob.sf.unif.sf.attacks,variable=c(rep("rhp",10),rep("history",10)))
overall.prob.sf.unif.sf.attacks<-cbind(overall.prob.sf.unif.sf.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual"),2),distribution=rep("Uniform",20),calc=rep("prob",20))


rhp.ss.attacks<-overall.prob.sf.unif.sf.attacks[overall.prob.sf.unif.sf.attacks$variable=="rhp",]
history.ss.attacks<-overall.prob.sf.unif.sf.attacks[overall.prob.sf.unif.sf.attacks$variable=="history",]

overall.prob.sf.unif.sf.attacks$combo<-paste(overall.prob.sf.unif.sf.attacks$strategy,overall.prob.sf.unif.sf.attacks$variable,overall.prob.sf.unif.sf.attacks$distribution)
overall.prob.sf.unif.sf.attacks$combo2<-paste(overall.prob.sf.unif.sf.attacks$strategy,overall.prob.sf.unif.sf.attacks$variable)
```

## Probabilistic Attack Proportions Data
```{r Initiator Wins Attack Proportions}
# The original attack proportion (escalation) data needed to be collected and uploaded from NetLogo. The below code organizes and analyses these data.

library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

# Create data frame for initiator wins data
attack.prop.sf.p.2<-attack.prop.sf[attack.prop.sf$winning=="probabilistic",]
attack.prop.sf.p.2<-cbind(attack.prop.sf.p.2, run.number=as.numeric(attack.prop.sf.p.2$X.run.number.))

attack.prop.sf.p.2<-attack.prop.sf.p.2[order(attack.prop.sf.p.2$X.run.number),]


attack.prop.sf.p.2<-cbind(attack.prop.sf.p.2, rate.avoids=((as.numeric(attack.prop.sf.2$sum..avoid.counter..of.fightsavoided)/as.numeric(attack.prop.sf.2$ticks))), rate.attacks=((as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories)/as.numeric(attack.prop.sf.2$ticks))))
attack.prop.sf.p.2<-cbind(attack.prop.sf.p.2,proportion.attacking=((as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories))/(as.numeric(attack.prop.sf.2$sum..victory.counter..of.victories)+as.numeric(attack.prop.sf.2$sum..avoid.counter..of.fightsavoided))))


# Label each set of 10 trials by the Who variable (mutual, opponent, self) and the What variable (History, RHP):
attack.prop.sf.p.2<-cbind(attack.prop.sf.p.2,combo2=c(rep("mutual history",10),rep("mutual rhp",10)))
```



#Linear model files for each scenario
```{r}
#Overall linear models of each deterministic clump scenario 
km.lm.dc.sf<-lm((energy.km.df.cd.sf.km$energy_over_time)~as.numeric(david.km.df.cd.sf.km$normDS)) #knowledge mutual linear model
hm.lm.dc.sf<-lm((energy.hm.df.cd.sf.hm$energy_over_time)~as.numeric(david.hm.df.cd.sf.hm$normDS)) #history mutual linear model

#Overall linear models of each deterministic uniform scenario  
km.lm.du.sf<-lm((energy.km.df.ud.sf.km$energy_over_time)~as.numeric(david.km.df.ud.sf.km$normDS)) #knowledge mutual linear model
hm.lm.du.sf<-lm((energy.hm.df.ud.sf.hm$energy_over_time)~as.numeric(david.hm.df.ud.sf.hm$normDS)) #history mutual linear model

#Overall linear models of each initiator clump scenario 
km.lm.ci.sf<-lm((energy.km.df.ci.sf.km$energy_over_time)~as.numeric(david.km.df.ci.sf.km$normDS)) #knowledge mutual linear model
hm.lm.ci.sf<-lm((energy.hm.df.ci.sf.hm$energy_over_time)~as.numeric(david.hm.df.ci.sf.hm$normDS)) #history mutual linear model

#Overall linear models of each initiator uniform scenario 
km.lm.ui.sf<-lm((energy.km.df.ui.sf.km$energy_over_time)~as.numeric(david.km.df.ui.sf.km$normDS)) #knowledge mutual linear model
hm.lm.ui.sf<-lm((energy.hm.df.ui.sf.hm$energy_over_time)~as.numeric(david.hm.df.ui.sf.hm$normDS)) #history mutual linear model

#Overall linear models of each probabilistic clump scenario 
km.lm.cp.sf<-lm((energy.km.df.cp.sf.km$energy_over_time)~as.numeric(david.km.df.cp.sf.km$normDS)) #knowledge mutual linear model
hm.lm.cp.sf<-lm((energy.hm.df.cp.sf.hm$energy_over_time)~as.numeric(david.hm.df.cp.sf.hm$normDS)) #history mutual linear model

#Overall linear models of each probabilistic uniform scenario  
km.lm.up.sf<-lm((energy.km.df.up.sf.km$energy_over_time)~as.numeric(david.km.df.up.sf.km$normDS)) #knowledge mutual linear model
hm.lm.up.sf<-lm((energy.hm.df.up.sf.hm$energy_over_time)~as.numeric(david.hm.df.up.sf.hm$normDS)) #history mutual linear model
```


## Dataframes for all (overall) data from each scenario
```{r}
#overall dataframes for deterministic clump and uniform data
overall.deter.sf<-rbind(overall.clump.sf.deter.sf, overall.unif.sf.deter.sf)
overall.deter.sf.avoids<-rbind(overall.deter.sf.clump.sf.avoid, overall.deter.sf.unif.sf.avoid)
overall.deter.sf.attacks<-rbind(overall.deter.sf.clump.sf.attacks, overall.deter.sf.unif.sf.attacks)

#overall dataframes for probabilistic clump and uniform data
overall.prob.sf<-rbind(overall.clump.prob.sf, overall.unif.sf.prob.sf)
overall.prob.sf.avoids<-rbind(overall.prob.sf.clump.sf.avoid, overall.prob.sf.unif.sf.avoid)
overall.prob.sf.attacks<-rbind(overall.prob.sf.clump.sf.attacks, overall.prob.sf.unif.sf.attacks)

#overall dataframes for initiator clump and uniform data
overall.initiator.sf<-rbind(overall.clump.sf.initiator.sf, overall.unif.sf.initiator.sf)
overall.initiator.sf.avoids<-rbind(overall.clump.sf.avoid.initiator.sf, overall.unif.sf.avoid.initiator.sf)
overall.initiator.sf.attacks<-rbind(overall.clump.sf.attacks.initiator.sf, overall.unif.sf.attacks.initiator.sf)
```