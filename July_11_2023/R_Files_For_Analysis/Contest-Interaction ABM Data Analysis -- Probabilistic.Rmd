---
title: "Contest-Interaction ABM Data Analysis -- Probabilistic"
author: "C.J. O'Connor-Coates"
date: "2023-01-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---
title: "Contest-Interaction ABM Data Analysis -- Probabilistic"
author: "C.J. O'Connor-Coates"
date: "2022-12-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


#-------------------------------------------------------------------------------------------------------------------------

# All data was generated in NetLogo Agent-Based Models (ABM) and imported into this program for analysis. These data and analyses are used in the publication "Steep hierarchies without skew? Modeling how ecology and decision-making shape despotism of relationships" by Marcy S. Ekanayake-Weber, Christopher J. O'Connor-Coates, and Andreas Koenig.

# The NetLogo model was created by Marcy S. Ekanayake-Weber and Christopher J. O'Connor-Coates. The following R-code was written by Christopher J. O'Connor-Coates. The code for the Triangle Transitivity Function was written by Shizuka & McDonald (2012). For questions regarding the R-code email Christopher J. O'Connor-Coates at christopher.oconnor-coates@stonybrook.edu.

#-------------------------------------------------------------------------------------------------------------------------

#-------------------------------------------------------------------------------------------------------------------------

# DEFINITIONS:
# 1. Knowledge (k): Individuals know of either their own or their opponent's Resource Holding Potential (RHP)
# 2. History (h): Individuals know of either their own or their opponent's fighting history, including how often theiy won or lost conflicts
# 3. Mutual (m): Individuals have knowledge of both their own and their opponent's RHP or History
# 4. Self (s): Individuals have knowledge of only their own RHP or History
# 5. Opponent (o): Individuals have knowledge of only their opponent's RHP or History
# 6. Deterministic (d): Scenarios in which fight outcomes were determined by the strength of an individual's RHP. Individuals with higher RHP values always won escalated conflicts.
# 7. Probabilistic (p): Scenarios in which fight outcomes were determined by a probability calculated in the NetLogo program. Individuals with higher RHP values are more likely to win escalated conflicts, but there is also a (smaller) chance that the individual with lower RHP could win the conflict.
# 8. Initiator Wins (iw; i): Scenarios in which the escalated conflict is always won by the individual which initiated the conflict.
# 9. Sigmoid Function (sf): Scenarios in which fights were escalated through a cost-benefit analysis that was modeled as a sigmoid function.
# 10. Clumped Distribution (cd; c): Resources were arranged in the landscape such that they only appeared in clumps; can also be called a heterogenous distribution
# 11. Uniform Distribution (ud; u): Resources were arranged in the landscape such that they were evenly distributed across the area; can also be called a homogenous distribution
# 12. Avoid: An individual avoided an escalation/conflict
# 13. Victory: An individual won an escalation/conflict
# 14. Foraging Efficiency: An Individual's Energy Intake Over Time

#ABBREVIATIONS:
# 1. inter.mat: Interaction Matrices
# 2. ep: Proportion of Escalation
# 3. t.tri: Triangle Transitivity
# 4. dci: Directional Conistency Index
# 5. Steep: steepness

#-------------------------------------------------------------------------------------------------------------------------


#-------------------------------------------------------------------------------------------------------------------------

# TO USE CODE SET YOUR WORKING DIRECTORY FILEPATHS (WHERE INDICATED) TO WHERE YOU HAVE SAVED THE DATA FILES.
# INDICATED FILEPATHS LOOK LIKE: setwd("~/SET/YOUR/WORKING/DIRECTORY/...")

#-------------------------------------------------------------------------------------------------------------------------


## Functions
```{r Functions}
# Functions used to generate the interaction matrices and TTri

ep<-function(x,y){
  sum(x[,3])/(sum(x[,3])+sum(y[,3]))
}


# Interaction Matrices Function:
inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Victories=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  victory.interaction.matrix<-(matrix(vdf$Victories,nrow=10,ncol=10,byrow=F))
  victory.interaction.matrix<-data.frame(victory.interaction.matrix)
  
  victory.interaction.matrix<-t(victory.interaction.matrix)
  victory.interaction.matrix<-matrix(victory.interaction.matrix,nrow=10,ncol=10)
  colnames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  victory.interaction.matrix
}

# Function to calculate Avoids Interaction Matrices:
avoid.inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Avoids=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  avoid.interaction.matrix<-(matrix(vdf$Avoids,nrow=10,ncol=10,byrow=F))
  avoid.interaction.matrix<-data.frame(avoid.interaction.matrix)
  
  avoid.interaction.matrix<-t(avoid.interaction.matrix)
  avoid.interaction.matrix<-matrix(avoid.interaction.matrix,nrow=10,ncol=10)
  colnames(avoid.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(avoid.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  avoid.interaction.matrix
}


int.to.dom=function(x){ 
  ((x>t(x)) & (x+t(x)>0))+0
}


# Triangle Transitivity Function (Shizuka & McDonald, 2012)
tr.tri<-function(x){

  m=int.to.dom(as.matrix(x))
  
  g=network(m,directed=TRUE)
  
  # We calculate P.t and t.tri for this empirical network.
  
  tri=triad.census(g) #The full triad census as an 16-element vector 
  
  w=as.vector(c(0,0,0,0,0,0,0,0,1,0,0,1,1,0.5,0.75,0.75)) # The weighting vector for transitivity 
  
  N.triangle=sum(tri*as.vector(c(0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1))) #Count and sum the number of triangles
  
  Pt=sum(tri*w)/N.triangle 
  
  t.tri=4*(Pt-0.75) 
  
  Pt 
  
  t.tri
  
  ## We now conduct 1,000 simulations of random networks with the same number of mutual, asymmetric and null dyads as the empirical dominance matrix. We calculate Pt from each of these simulated networks (r.P.t). I use a while() loop because randomizations of some sparse matrices will produce networks with no triangles. For simplicity, we just throw these out. 
  
  dyads=dyad.census(g) 
  
  r.p.t=vector(length=1000)
  
  j=1
  
  while(j<1001){
  
  r=rguman(1,nv=nrow(m),mut=dyads[1],asym=dyads[2],null=dyads[3])
  
  r.triad=triad.census(r)
  
  r.p.t[j]=r.triad[9]/(r.triad[10]+r.triad[9])
  
  if (is.na(r.p.t[j])) next else j=j+1
  
  }
  
  p=length(r.p.t[r.p.t>=Pt])/1000
  
  p
  
  t.tri
}


#adds new line to axis tick labels in ggplot
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}

ggplotRegression <- function (fit) {

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
                     "Intercept =",signif(fit$coef[[1]],5 ),
                     " Slope =",signif(fit$coef[[2]], 5),
                     " P =",signif(summary(fit)$coef[2,4], 5)))
}
```

## Clumped Probabilistic Data
```{r Clumped Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.km<-data.frame(X1=avoid.cp.km[[1]],X2=avoid.cp.km[[2]],Avoids=avoid.cp.km[[3]])
a2.cp.km<-data.frame(X1=avoid.cp.km[[4]],X2=avoid.cp.km[[5]],Avoids=avoid.cp.km[[6]])
a3.cp.km<-data.frame(X1=avoid.cp.km[[7]],X2=avoid.cp.km[[8]],Avoids=avoid.cp.km[[9]])
a4.cp.km<-data.frame(X1=avoid.cp.km[[10]],X2=avoid.cp.km[[11]],Avoids=avoid.cp.km[[12]])
a5.cp.km<-data.frame(X1=avoid.cp.km[[13]],X2=avoid.cp.km[[14]],Avoids=avoid.cp.km[[15]])
a6.cp.km<-data.frame(X1=avoid.cp.km[[16]],X2=avoid.cp.km[[17]],Avoids=avoid.cp.km[[18]])
a7.cp.km<-data.frame(X1=avoid.cp.km[[19]],X2=avoid.cp.km[[20]],Avoids=avoid.cp.km[[21]])
a8.cp.km<-data.frame(X1=avoid.cp.km[[22]],X2=avoid.cp.km[[23]],Avoids=avoid.cp.km[[24]])
a9.cp.km<-data.frame(X1=avoid.cp.km[[25]],X2=avoid.cp.km[[26]],Avoids=avoid.cp.km[[27]])
a10.cp.km<-data.frame(X1=avoid.cp.km[[28]],X2=avoid.cp.km[[29]],Avoids=avoid.cp.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.km.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.km<-data.frame(X1=conflict.km.cp[[1]],X2=conflict.km.cp[[2]],Victories=conflict.km.cp[[3]])
mat1.cp.km<-inter.mat(mut1.cp.km)
tri1.cp.km<-tr.tri(mat1.cp.km)
dci1.cp.km<-DCindex(mat1.cp.km)
mat1.cp.km[is.na(mat1.cp.km)] = 0
h1.cp.km<-h.index(mat1.cp.km)

ep1.cp.km<-ep(mut1.cp.km,a1.cp.km)
david1.cp.km<-DS(mat1.cp.km) #David's Scores - for steepness use normDS output
ordrank.1.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.km<-cbind(ordrank.1.cp.km,ds=david1.cp.km$normDS)
lm1.cp.km<-summary(lm(ordrank.1.cp.km$ds~ordrank.1.cp.km$ord.rank))
s1.cp.km<-lm1.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.km<-data.frame(X1=conflict.km.cp[[4]],X2=conflict.km.cp[[5]],Victories=conflict.km.cp[[6]])
mat2.cp.km<-inter.mat(mut2.cp.km)
tri2.cp.km<-tr.tri(mat2.cp.km)
dci2.cp.km<-DCindex(mat2.cp.km)
mat2.cp.km[is.na(mat2.cp.km)] = 0
h2.cp.km<-h.index(mat2.cp.km)

ep2.cp.km<-ep(mut2.cp.km,a2.cp.km)
david2.cp.km<-DS(mat2.cp.km) #David's Scores - for steepness use normDS output
ordrank.2.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.km<-cbind(ordrank.2.cp.km,ds=david2.cp.km$normDS)
lm2.cp.km<-summary(lm(ordrank.2.cp.km$ds~ordrank.2.cp.km$ord.rank))
s2.cp.km<-lm2.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.km<-data.frame(X1=conflict.km.cp[[7]],X2=conflict.km.cp[[8]],Victories=conflict.km.cp[[9]])
mat3.cp.km<-inter.mat(mut3.cp.km)
tri3.cp.km<-tr.tri(mat3.cp.km)
dci3.cp.km<-DCindex(mat3.cp.km)
mat3.cp.km[is.na(mat3.cp.km)] = 0
h3.cp.km<-h.index(mat3.cp.km)

ep3.cp.km<-ep(mut3.cp.km,a3.cp.km)
david3.cp.km<-DS(mat3.cp.km) #David's Scores - for steepness use normDS output
ordrank.3.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.km<-cbind(ordrank.3.cp.km,ds=david3.cp.km$normDS)
lm3.cp.km<-summary(lm(ordrank.3.cp.km$ds~ordrank.3.cp.km$ord.rank))
s3.cp.km<-lm3.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.km<-data.frame(X1=conflict.km.cp[[10]],X2=conflict.km.cp[[11]],Victories=conflict.km.cp[[12]])
mat4.cp.km<-inter.mat(mut4.cp.km)
tri4.cp.km<-tr.tri(mat4.cp.km)
dci4.cp.km<-DCindex(mat4.cp.km)
mat4.cp.km[is.na(mat4.cp.km)] = 0
h4.cp.km<-h.index(mat4.cp.km)

ep4.cp.km<-ep(mut4.cp.km,a4.cp.km)
david4.cp.km<-DS(mat4.cp.km) #David's Scores - for steepness use normDS output
ordrank.4.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.km<-cbind(ordrank.4.cp.km,ds=david4.cp.km$normDS)
lm4.cp.km<-summary(lm(ordrank.4.cp.km$ds~ordrank.4.cp.km$ord.rank))
s4.cp.km<-lm4.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.km<-data.frame(X1=conflict.km.cp[[13]],X2=conflict.km.cp[[14]],Victories=conflict.km.cp[[15]])
mat5.cp.km<-inter.mat(mut5.cp.km)
tri5.cp.km<-tr.tri(mat5.cp.km)
dci5.cp.km<-DCindex(mat5.cp.km)
mat5.cp.km[is.na(mat5.cp.km)] = 0
h5.cp.km<-h.index(mat5.cp.km)

ep5.cp.km<-ep(mut5.cp.km,a5.cp.km)
david5.cp.km<-DS(mat5.cp.km) #David's Scores - for steepness use normDS output
ordrank.5.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.km<-cbind(ordrank.5.cp.km,ds=david5.cp.km$normDS)
lm5.cp.km<-summary(lm(ordrank.5.cp.km$ds~ordrank.5.cp.km$ord.rank))
s5.cp.km<-lm5.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.km<-data.frame(X1=conflict.km.cp[[16]],X2=conflict.km.cp[[17]],Victories=conflict.km.cp[[18]])
mat6.cp.km<-inter.mat(mut6.cp.km)
tri6.cp.km<-tr.tri(mat6.cp.km)
dci6.cp.km<-DCindex(mat6.cp.km)
mat6.cp.km[is.na(mat6.cp.km)] = 0
h6.cp.km<-h.index(mat6.cp.km)

ep6.cp.km<-ep(mut6.cp.km,a6.cp.km)
david6.cp.km<-DS(mat6.cp.km) #David's Scores - for steepness use normDS output
ordrank.6.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.km<-cbind(ordrank.6.cp.km,ds=david6.cp.km$normDS)
lm6.cp.km<-summary(lm(ordrank.6.cp.km$ds~ordrank.6.cp.km$ord.rank))
s6.cp.km<-lm6.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.km<-data.frame(X1=conflict.km.cp[[19]],X2=conflict.km.cp[[20]],Victories=conflict.km.cp[[21]])
mat7.cp.km<-inter.mat(mut7.cp.km)
tri7.cp.km<-tr.tri(mat7.cp.km)
dci7.cp.km<-DCindex(mat7.cp.km)
mat7.cp.km[is.na(mat7.cp.km)] = 0
h7.cp.km<-h.index(mat7.cp.km)

ep7.cp.km<-ep(mut7.cp.km,a7.cp.km)
david7.cp.km<-DS(mat7.cp.km) #David's Scores - for steepness use normDS output
ordrank.7.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.km<-cbind(ordrank.7.cp.km,ds=david7.cp.km$normDS)
lm7.cp.km<-summary(lm(ordrank.7.cp.km$ds~ordrank.7.cp.km$ord.rank))
s7.cp.km<-lm7.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.km<-data.frame(X1=conflict.km.cp[[22]],X2=conflict.km.cp[[23]],Victories=conflict.km.cp[[24]])
mat8.cp.km<-inter.mat(mut8.cp.km)
tri8.cp.km<-tr.tri(mat8.cp.km)
dci8.cp.km<-DCindex(mat8.cp.km)
mat8.cp.km[is.na(mat8.cp.km)] = 0
h8.cp.km<-h.index(mat8.cp.km)

ep8.cp.km<-ep(mut8.cp.km,a8.cp.km)
david8.cp.km<-DS(mat8.cp.km) #David's Scores - for steepness use normDS output
ordrank.8.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.km<-cbind(ordrank.8.cp.km,ds=david8.cp.km$normDS)
lm8.cp.km<-summary(lm(ordrank.8.cp.km$ds~ordrank.8.cp.km$ord.rank))
s8.cp.km<-lm8.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.km<-data.frame(X1=conflict.km.cp[[25]],X2=conflict.km.cp[[26]],Victories=conflict.km.cp[[27]])
mat9.cp.km<-inter.mat(mut9.cp.km)
tri9.cp.km<-tr.tri(mat9.cp.km)
dci9.cp.km<-DCindex(mat9.cp.km)
mat9.cp.km[is.na(mat9.cp.km)] = 0
h9.cp.km<-h.index(mat9.cp.km)

ep9.cp.km<-ep(mut9.cp.km,a9.cp.km)
david9.cp.km<-DS(mat9.cp.km) #David's Scores - for steepness use normDS output
ordrank.9.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.km<-cbind(ordrank.9.cp.km,ds=david9.cp.km$normDS)
lm9.cp.km<-summary(lm(ordrank.9.cp.km$ds~ordrank.9.cp.km$ord.rank))
s9.cp.km<-lm9.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.km<-data.frame(X1=conflict.km.cp[[28]],X2=conflict.km.cp[[29]],Victories=conflict.km.cp[[30]])
mat10.cp.km<-inter.mat(mut10.cp.km)
tri10.cp.km<-tr.tri(mat10.cp.km)
dci10.cp.km<-DCindex(mat10.cp.km)
mat10.cp.km[is.na(mat10.cp.km)] = 0
h10.cp.km<-h.index(mat10.cp.km)

ep10.cp.km<-ep(mut10.cp.km,a10.cp.km)
david10.cp.km<-DS(mat10.cp.km) #David's Scores - for steepness use normDS output
ordrank.10.cp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.km<-cbind(ordrank.10.cp.km,ds=david10.cp.km$normDS)
lm10.cp.km<-summary(lm(ordrank.10.cp.km$ds~ordrank.10.cp.km$ord.rank))
s10.cp.km<-lm10.cp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.km<-sum(mut1.cp.km$Victories)
int2.cp.km<-sum(mut2.cp.km$Victories)
int3.cp.km<-sum(mut3.cp.km$Victories)
int4.cp.km<-sum(mut4.cp.km$Victories)
int5.cp.km<-sum(mut5.cp.km$Victories)
int6.cp.km<-sum(mut6.cp.km$Victories)
int7.cp.km<-sum(mut7.cp.km$Victories)
int8.cp.km<-sum(mut8.cp.km$Victories)
int9.cp.km<-sum(mut9.cp.km$Victories)
int10.cp.km<-sum(mut10.cp.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.km<-sum(a1.cp.km$Victories)
av2.cp.km<-sum(a2.cp.km$Victories)
av3.cp.km<-sum(a3.cp.km$Victories)
av4.cp.km<-sum(a4.cp.km$Victories)
av5.cp.km<-sum(a5.cp.km$Victories)
av6.cp.km<-sum(a6.cp.km$Victories)
av7.cp.km<-sum(a7.cp.km$Victories)
av8.cp.km<-sum(a8.cp.km$Victories)
av9.cp.km<-sum(a9.cp.km$Victories)
av10.cp.km<-sum(a10.cp.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.pc<-(sum(av1.cp.km, av2.cp.km, av3.cp.km, av4.cp.km, av5.cp.km, av6.cp.km, av7.cp.km, av8.cp.km, av9.cp.km, av10.cp.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.pc<-(sum(int1.cp.km, int2.cp.km, int3.cp.km, int4.cp.km, int5.cp.km, int6.cp.km, int7.cp.km, int8.cp.km, int9.cp.km, int10.cp.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.km<-e1.cp.km[order(e1.cp.km$ID),]
e1.cp.km<-as.matrix(t(e1.1.cp.km))

e2.cp.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.km<-e2.cp.km[order(e2.cp.km$ID),]
e2.cp.km<-as.matrix(t(e2.1.cp.km))

e3.cp.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.km<-e3.cp.km[order(e3.cp.km$ID),]
e3.cp.km<-as.matrix(t(e3.1.cp.km))

e4.cp.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.km<-e4.cp.km[order(e4.cp.km$ID),]
e4.cp.km<-as.matrix(t(e4.1.cp.km))

e5.cp.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.km<-e5.cp.km[order(e5.cp.km$ID),]
e5.cp.km<-as.matrix(t(e5.1.cp.km))

e6.cp.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.km<-e6.cp.km[order(e6.cp.km$ID),]
e6.cp.km<-as.matrix(t(e6.1.cp.km))

e7.cp.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.km<-e7.cp.km[order(e7.cp.km$ID),]
e7.cp.km<-as.matrix(t(e7.1.cp.km))

e8.cp.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.km<-e8.cp.km[order(e8.cp.km$ID),]
e8.cp.km<-as.matrix(t(e8.1.cp.km))

e9.cp.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.km<-e9.cp.km[order(e9.cp.km$ID),]
e9.cp.km<-as.matrix(t(e9.1.cp.km))

e10.cp.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.km<-e10.cp.km[order(e10.cp.km$ID),]
e10.cp.km<-as.matrix(t(e10.1.cp.km))

energy.km.cp.km<-as.data.frame(matrix(c(e1.cp.km,e2.cp.km,e3.cp.km,e4.cp.km,e5.cp.km,e6.cp.km,e7.cp.km,e8.cp.km,e9.cp.km,e10.cp.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.cp.km<-data.frame(ID=energy.km.cp.km$V1,energy_over_distance=energy.km.cp.km$V2,energy_over_time=energy.km.cp.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.km<-david1.cp.km[order(david1.cp.km$ID),]
david1.cp.km<-as.matrix(t(david1.1.cp.km))

david2.1.cp.km<-david2.cp.km[order(david2.cp.km$ID),]
david2.cp.km<-as.matrix(t(david2.1.cp.km))

david3.1.cp.km<-david3.cp.km[order(david3.cp.km$ID),]
david3.cp.km<-as.matrix(t(david3.1.cp.km))

david4.1.cp.km<-david4.cp.km[order(david4.cp.km$ID),]
david4.cp.km<-as.matrix(t(david4.1.cp.km))

david5.1.cp.km<-david5.cp.km[order(david5.cp.km$ID),]
david5.cp.km<-as.matrix(t(david5.1.cp.km))

david6.1.cp.km<-david6.cp.km[order(david6.cp.km$ID),]
david6.cp.km<-as.matrix(t(david6.1.cp.km))

david7.1.cp.km<-david7.cp.km[order(david7.cp.km$ID),]
david7.cp.km<-as.matrix(t(david7.1.cp.km))

david8.1.cp.km<-david8.cp.km[order(david8.cp.km$ID),]
david8.cp.km<-as.matrix(t(david8.1.cp.km))

david9.1.cp.km<-david9.cp.km[order(david9.cp.km$ID),]
david9.cp.km<-as.matrix(t(david9.1.cp.km))

david10.1.cp.km<-david10.cp.km[order(david10.cp.km$ID),]
david10.cp.km<-as.matrix(t(david10.1.cp.km))

david.km.cp.km<-as.data.frame(matrix(c(david1.cp.km,david2.cp.km,david3.cp.km,david4.cp.km,david5.cp.km,david6.cp.km,david7.cp.km,david8.cp.km,david9.cp.km,david10.cp.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.cp.km<-data.frame(ID=david.km.cp.km$V1,DS=david.km.cp.km$V2,normDS=david.km.cp.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.cp.km<-lm(e1.1.cp.km$energy_over_time~as.numeric(david1.1.cp.km$normDS))
km.lm.1.s.cp.km<-summary(lm.km.1.cp.km)$coefficients
km.1.slope.cp.km<-km.lm.1.s.cp.km[2,1]
lm.km.2.cp.km<-lm(e2.1.cp.km$energy_over_time~as.numeric(david2.1.cp.km$normDS))
km.lm.2.s.cp.km<-summary(lm.km.2.cp.km)$coefficients
km.2.slope.cp.km<-km.lm.2.s.cp.km[2,1]
lm.km.3.cp.km<-lm(e3.1.cp.km$energy_over_time~as.numeric(david3.1.cp.km$normDS))
km.lm.3.s.cp.km<-summary(lm.km.3.cp.km)$coefficients
km.3.slope.cp.km<-km.lm.3.s.cp.km[2,1]
lm.km.4.cp.km<-lm(e4.1.cp.km$energy_over_time~as.numeric(david4.1.cp.km$normDS))
km.lm.4.s.cp.km<-summary(lm.km.4.cp.km)$coefficients
km.4.slope.cp.km<-km.lm.4.s.cp.km[2,1]
lm.km.5.cp.km<-lm(e5.1.cp.km$energy_over_time~as.numeric(david5.1.cp.km$normDS))
km.lm.5.s.cp.km<-summary(lm.km.5.cp.km)$coefficients
km.5.slope.cp.km<-km.lm.5.s.cp.km[2,1]
lm.km.6.cp.km<-lm(e6.1.cp.km$energy_over_time~as.numeric(david6.1.cp.km$normDS))
km.lm.6.s.cp.km<-summary(lm.km.6.cp.km)$coefficients
km.6.slope.cp.km<-km.lm.6.s.cp.km[2,1]
lm.km.7.cp.km<-lm(e7.1.cp.km$energy_over_time~as.numeric(david7.1.cp.km$normDS))
km.lm.7.s.cp.km<-summary(lm.km.7.cp.km)$coefficients
km.7.slope.cp.km<-km.lm.7.s.cp.km[2,1]
lm.km.8.cp.km<-lm(e8.1.cp.km$energy_over_time~as.numeric(david8.1.cp.km$normDS))
km.lm.8.s.cp.km<-summary(lm.km.8.cp.km)$coefficients
km.8.slope.cp.km<-km.lm.8.s.cp.km[2,1]
lm.km.9.cp.km<-lm(e9.1.cp.km$energy_over_time~as.numeric(david9.1.cp.km$normDS))
km.lm.9.s.cp.km<-summary(lm.km.9.cp.km)$coefficients
km.9.slope.cp.km<-km.lm.9.s.cp.km[2,1]
lm.km.10.cp.km<-lm(e10.1.cp.km$energy_over_time~as.numeric(david10.1.cp.km$normDS))
km.lm.10.s.cp.km<-summary(lm.km.10.cp.km)$coefficients
km.10.slope.cp.km<-km.lm.10.s.cp.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.km,tri2.cp.km,tri3.cp.km,tri4.cp.km,tri5.cp.km,tri6.cp.km,tri7.cp.km,tri8.cp.km,tri9.cp.km,tri10.cp.km),escalation=c(ep1.cp.km,ep2.cp.km,ep3.cp.km,ep4.cp.km,ep5.cp.km,ep6.cp.km,ep7.cp.km,ep8.cp.km,ep9.cp.km,ep10.cp.km),dci=c(dci1.cp.km,dci2.cp.km,dci3.cp.km,dci4.cp.km,dci5.cp.km,dci6.cp.km,dci7.cp.km,dci8.cp.km,dci9.cp.km,dci10.cp.km),steepness=c(s1.cp.km,s2.cp.km,s3.cp.km,s4.cp.km,s5.cp.km,s6.cp.km,s7.cp.km,s8.cp.km,s9.cp.km,s10.cp.km),slope=c(km.1.slope.cp.km,km.2.slope.cp.km,km.3.slope.cp.km,km.4.slope.cp.km,km.5.slope.cp.km,km.6.slope.cp.km,km.7.slope.cp.km,km.8.slope.cp.km,km.9.slope.cp.km,km.10.slope.cp.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ks<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.ks<-data.frame(X1=avoid.cp.ks[[1]],X2=avoid.cp.ks[[2]],Avoids=avoid.cp.ks[[3]])
a2.cp.ks<-data.frame(X1=avoid.cp.ks[[4]],X2=avoid.cp.ks[[5]],Avoids=avoid.cp.ks[[6]])
a3.cp.ks<-data.frame(X1=avoid.cp.ks[[7]],X2=avoid.cp.ks[[8]],Avoids=avoid.cp.ks[[9]])
a4.cp.ks<-data.frame(X1=avoid.cp.ks[[10]],X2=avoid.cp.ks[[11]],Avoids=avoid.cp.ks[[12]])
a5.cp.ks<-data.frame(X1=avoid.cp.ks[[13]],X2=avoid.cp.ks[[14]],Avoids=avoid.cp.ks[[15]])
a6.cp.ks<-data.frame(X1=avoid.cp.ks[[16]],X2=avoid.cp.ks[[17]],Avoids=avoid.cp.ks[[18]])
a7.cp.ks<-data.frame(X1=avoid.cp.ks[[19]],X2=avoid.cp.ks[[20]],Avoids=avoid.cp.ks[[21]])
a8.cp.ks<-data.frame(X1=avoid.cp.ks[[22]],X2=avoid.cp.ks[[23]],Avoids=avoid.cp.ks[[24]])
a9.cp.ks<-data.frame(X1=avoid.cp.ks[[25]],X2=avoid.cp.ks[[26]],Avoids=avoid.cp.ks[[27]])
a10.cp.ks<-data.frame(X1=avoid.cp.ks[[28]],X2=avoid.cp.ks[[29]],Avoids=avoid.cp.ks[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ks.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.ks<-data.frame(X1=conflict.ks.cp[[1]],X2=conflict.ks.cp[[2]],Victories=conflict.ks.cp[[3]])
mat1.cp.ks<-inter.mat(mut1.cp.ks)
tri1.cp.ks<-tr.tri(mat1.cp.ks)
dci1.cp.ks<-DCindex(mat1.cp.ks)
mat1.cp.ks[is.na(mat1.cp.ks)] = 0
h1.cp.ks<-h.index(mat1.cp.ks)

ep1.cp.ks<-ep(mut1.cp.ks,a1.cp.ks)
david1.cp.ks<-DS(mat1.cp.ks) #David's Scores - for steepness use normDS output
ordrank.1.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.ks<-cbind(ordrank.1.cp.ks,ds=david1.cp.ks$normDS)
lm1.cp.ks<-summary(lm(ordrank.1.cp.ks$ds~ordrank.1.cp.ks$ord.rank))
s1.cp.ks<-lm1.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.ks<-data.frame(X1=conflict.ks.cp[[4]],X2=conflict.ks.cp[[5]],Victories=conflict.ks.cp[[6]])
mat2.cp.ks<-inter.mat(mut2.cp.ks)
tri2.cp.ks<-tr.tri(mat2.cp.ks)
dci2.cp.ks<-DCindex(mat2.cp.ks)
mat2.cp.ks[is.na(mat2.cp.ks)] = 0
h2.cp.ks<-h.index(mat2.cp.ks)

ep2.cp.ks<-ep(mut2.cp.ks,a2.cp.ks)
david2.cp.ks<-DS(mat2.cp.ks) #David's Scores - for steepness use normDS output
ordrank.2.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.ks<-cbind(ordrank.2.cp.ks,ds=david2.cp.ks$normDS)
lm2.cp.ks<-summary(lm(ordrank.2.cp.ks$ds~ordrank.2.cp.ks$ord.rank))
s2.cp.ks<-lm2.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.ks<-data.frame(X1=conflict.ks.cp[[7]],X2=conflict.ks.cp[[8]],Victories=conflict.ks.cp[[9]])
mat3.cp.ks<-inter.mat(mut3.cp.ks)
tri3.cp.ks<-tr.tri(mat3.cp.ks)
dci3.cp.ks<-DCindex(mat3.cp.ks)
mat3.cp.ks[is.na(mat3.cp.ks)] = 0
h3.cp.ks<-h.index(mat3.cp.ks)

ep3.cp.ks<-ep(mut3.cp.ks,a3.cp.ks)
david3.cp.ks<-DS(mat3.cp.ks) #David's Scores - for steepness use normDS output
ordrank.3.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.ks<-cbind(ordrank.3.cp.ks,ds=david3.cp.ks$normDS)
lm3.cp.ks<-summary(lm(ordrank.3.cp.ks$ds~ordrank.3.cp.ks$ord.rank))
s3.cp.ks<-lm3.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.ks<-data.frame(X1=conflict.ks.cp[[10]],X2=conflict.ks.cp[[11]],Victories=conflict.ks.cp[[12]])
mat4.cp.ks<-inter.mat(mut4.cp.ks)
tri4.cp.ks<-tr.tri(mat4.cp.ks)
dci4.cp.ks<-DCindex(mat4.cp.ks)
mat4.cp.ks[is.na(mat4.cp.ks)] = 0
h4.cp.ks<-h.index(mat4.cp.ks)

ep4.cp.ks<-ep(mut4.cp.ks,a4.cp.ks)
david4.cp.ks<-DS(mat4.cp.ks) #David's Scores - for steepness use normDS output
ordrank.4.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.ks<-cbind(ordrank.4.cp.ks,ds=david4.cp.ks$normDS)
lm4.cp.ks<-summary(lm(ordrank.4.cp.ks$ds~ordrank.4.cp.ks$ord.rank))
s4.cp.ks<-lm4.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.ks<-data.frame(X1=conflict.ks.cp[[13]],X2=conflict.ks.cp[[14]],Victories=conflict.ks.cp[[15]])
mat5.cp.ks<-inter.mat(mut5.cp.ks)
tri5.cp.ks<-tr.tri(mat5.cp.ks)
dci5.cp.ks<-DCindex(mat5.cp.ks)
mat5.cp.ks[is.na(mat5.cp.ks)] = 0
h5.cp.ks<-h.index(mat5.cp.ks)

ep5.cp.ks<-ep(mut5.cp.ks,a5.cp.ks)
david5.cp.ks<-DS(mat5.cp.ks) #David's Scores - for steepness use normDS output
ordrank.5.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.ks<-cbind(ordrank.5.cp.ks,ds=david5.cp.ks$normDS)
lm5.cp.ks<-summary(lm(ordrank.5.cp.ks$ds~ordrank.5.cp.ks$ord.rank))
s5.cp.ks<-lm5.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.ks<-data.frame(X1=conflict.ks.cp[[16]],X2=conflict.ks.cp[[17]],Victories=conflict.ks.cp[[18]])
mat6.cp.ks<-inter.mat(mut6.cp.ks)
tri6.cp.ks<-tr.tri(mat6.cp.ks)
dci6.cp.ks<-DCindex(mat6.cp.ks)
mat6.cp.ks[is.na(mat6.cp.ks)] = 0
h6.cp.ks<-h.index(mat6.cp.ks)

ep6.cp.ks<-ep(mut6.cp.ks,a6.cp.ks)
david6.cp.ks<-DS(mat6.cp.ks) #David's Scores - for steepness use normDS output
ordrank.6.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.ks<-cbind(ordrank.6.cp.ks,ds=david6.cp.ks$normDS)
lm6.cp.ks<-summary(lm(ordrank.6.cp.ks$ds~ordrank.6.cp.ks$ord.rank))
s6.cp.ks<-lm6.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.ks<-data.frame(X1=conflict.ks.cp[[19]],X2=conflict.ks.cp[[20]],Victories=conflict.ks.cp[[21]])
mat7.cp.ks<-inter.mat(mut7.cp.ks)
tri7.cp.ks<-tr.tri(mat7.cp.ks)
dci7.cp.ks<-DCindex(mat7.cp.ks)
mat7.cp.ks[is.na(mat7.cp.ks)] = 0
h7.cp.ks<-h.index(mat7.cp.ks)

ep7.cp.ks<-ep(mut7.cp.ks,a7.cp.ks)
david7.cp.ks<-DS(mat7.cp.ks) #David's Scores - for steepness use normDS output
ordrank.7.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.ks<-cbind(ordrank.7.cp.ks,ds=david7.cp.ks$normDS)
lm7.cp.ks<-summary(lm(ordrank.7.cp.ks$ds~ordrank.7.cp.ks$ord.rank))
s7.cp.ks<-lm7.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.ks<-data.frame(X1=conflict.ks.cp[[22]],X2=conflict.ks.cp[[23]],Victories=conflict.ks.cp[[24]])
mat8.cp.ks<-inter.mat(mut8.cp.ks)
tri8.cp.ks<-tr.tri(mat8.cp.ks)
dci8.cp.ks<-DCindex(mat8.cp.ks)
mat8.cp.ks[is.na(mat8.cp.ks)] = 0
h8.cp.ks<-h.index(mat8.cp.ks)

ep8.cp.ks<-ep(mut8.cp.ks,a8.cp.ks)
david8.cp.ks<-DS(mat8.cp.ks) #David's Scores - for steepness use normDS output
ordrank.8.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.ks<-cbind(ordrank.8.cp.ks,ds=david8.cp.ks$normDS)
lm8.cp.ks<-summary(lm(ordrank.8.cp.ks$ds~ordrank.8.cp.ks$ord.rank))
s8.cp.ks<-lm8.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.ks<-data.frame(X1=conflict.ks.cp[[25]],X2=conflict.ks.cp[[26]],Victories=conflict.ks.cp[[27]])
mat9.cp.ks<-inter.mat(mut9.cp.ks)
tri9.cp.ks<-tr.tri(mat9.cp.ks)
dci9.cp.ks<-DCindex(mat9.cp.ks)
mat9.cp.ks[is.na(mat9.cp.ks)] = 0
h9.cp.ks<-h.index(mat9.cp.ks)

ep9.cp.ks<-ep(mut9.cp.ks,a9.cp.ks)
david9.cp.ks<-DS(mat9.cp.ks) #David's Scores - for steepness use normDS output
ordrank.9.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.ks<-cbind(ordrank.9.cp.ks,ds=david9.cp.ks$normDS)
lm9.cp.ks<-summary(lm(ordrank.9.cp.ks$ds~ordrank.9.cp.ks$ord.rank))
s9.cp.ks<-lm9.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.ks<-data.frame(X1=conflict.ks.cp[[28]],X2=conflict.ks.cp[[29]],Victories=conflict.ks.cp[[30]])
mat10.cp.ks<-inter.mat(mut10.cp.ks)
tri10.cp.ks<-tr.tri(mat10.cp.ks)
dci10.cp.ks<-DCindex(mat10.cp.ks)
mat10.cp.ks[is.na(mat10.cp.ks)] = 0
h10.cp.ks<-h.index(mat10.cp.ks)

ep10.cp.ks<-ep(mut10.cp.ks,a10.cp.ks)
david10.cp.ks<-DS(mat10.cp.ks) #David's Scores - for steepness use normDS output
ordrank.10.cp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.ks<-cbind(ordrank.10.cp.ks,ds=david10.cp.ks$normDS)
lm10.cp.ks<-summary(lm(ordrank.10.cp.ks$ds~ordrank.10.cp.ks$ord.rank))
s10.cp.ks<-lm10.cp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.ks<-sum(mut1.cp.ks$Victories)
int2.cp.ks<-sum(mut2.cp.ks$Victories)
int3.cp.ks<-sum(mut3.cp.ks$Victories)
int4.cp.ks<-sum(mut4.cp.ks$Victories)
int5.cp.ks<-sum(mut5.cp.ks$Victories)
int6.cp.ks<-sum(mut6.cp.ks$Victories)
int7.cp.ks<-sum(mut7.cp.ks$Victories)
int8.cp.ks<-sum(mut8.cp.ks$Victories)
int9.cp.ks<-sum(mut9.cp.ks$Victories)
int10.cp.ks<-sum(mut10.cp.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ks<-sum(a1.cp.ks$Victories)
av2.cp.ks<-sum(a2.cp.ks$Victories)
av3.cp.ks<-sum(a3.cp.ks$Victories)
av4.cp.ks<-sum(a4.cp.ks$Victories)
av5.cp.ks<-sum(a5.cp.ks$Victories)
av6.cp.ks<-sum(a6.cp.ks$Victories)
av7.cp.ks<-sum(a7.cp.ks$Victories)
av8.cp.ks<-sum(a8.cp.ks$Victories)
av9.cp.ks<-sum(a9.cp.ks$Victories)
av10.cp.ks<-sum(a10.cp.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.pc<-(sum(av1.cp.ks, av2.cp.ks, av3.cp.ks, av4.cp.ks, av5.cp.ks, av6.cp.ks, av7.cp.ks, av8.cp.ks, av9.cp.ks, av10.cp.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.pc<-(sum(int1.cp.ks, int2.cp.ks, int3.cp.ks, int4.cp.ks, int5.cp.ks, int6.cp.ks, int7.cp.ks, int8.cp.ks, int9.cp.ks, int10.cp.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.ks<-e1.cp.ks[order(e1.cp.ks$ID),]
e1.cp.ks<-as.matrix(t(e1.1.cp.ks))

e2.cp.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.ks<-e2.cp.ks[order(e2.cp.ks$ID),]
e2.cp.ks<-as.matrix(t(e2.1.cp.ks))

e3.cp.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.ks<-e3.cp.ks[order(e3.cp.ks$ID),]
e3.cp.ks<-as.matrix(t(e3.1.cp.ks))

e4.cp.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.ks<-e4.cp.ks[order(e4.cp.ks$ID),]
e4.cp.ks<-as.matrix(t(e4.1.cp.ks))

e5.cp.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.ks<-e5.cp.ks[order(e5.cp.ks$ID),]
e5.cp.ks<-as.matrix(t(e5.1.cp.ks))

e6.cp.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.ks<-e6.cp.ks[order(e6.cp.ks$ID),]
e6.cp.ks<-as.matrix(t(e6.1.cp.ks))

e7.cp.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.ks<-e7.cp.ks[order(e7.cp.ks$ID),]
e7.cp.ks<-as.matrix(t(e7.1.cp.ks))

e8.cp.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.ks<-e8.cp.ks[order(e8.cp.ks$ID),]
e8.cp.ks<-as.matrix(t(e8.1.cp.ks))

e9.cp.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.ks<-e9.cp.ks[order(e9.cp.ks$ID),]
e9.cp.ks<-as.matrix(t(e9.1.cp.ks))

e10.cp.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.ks<-e10.cp.ks[order(e10.cp.ks$ID),]
e10.cp.ks<-as.matrix(t(e10.1.cp.ks))

energy.ks.cp.ks<-as.data.frame(matrix(c(e1.cp.ks,e2.cp.ks,e3.cp.ks,e4.cp.ks,e5.cp.ks,e6.cp.ks,e7.cp.ks,e8.cp.ks,e9.cp.ks,e10.cp.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.cp.ks<-data.frame(ID=energy.ks.cp.ks$V1,energy_over_distance=energy.ks.cp.ks$V2,energy_over_time=energy.ks.cp.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.ks<-david1.cp.ks[order(david1.cp.ks$ID),]
david1.cp.ks<-as.matrix(t(david1.1.cp.ks))

david2.1.cp.ks<-david2.cp.ks[order(david2.cp.ks$ID),]
david2.cp.ks<-as.matrix(t(david2.1.cp.ks))

david3.1.cp.ks<-david3.cp.ks[order(david3.cp.ks$ID),]
david3.cp.ks<-as.matrix(t(david3.1.cp.ks))

david4.1.cp.ks<-david4.cp.ks[order(david4.cp.ks$ID),]
david4.cp.ks<-as.matrix(t(david4.1.cp.ks))

david5.1.cp.ks<-david5.cp.ks[order(david5.cp.ks$ID),]
david5.cp.ks<-as.matrix(t(david5.1.cp.ks))

david6.1.cp.ks<-david6.cp.ks[order(david6.cp.ks$ID),]
david6.cp.ks<-as.matrix(t(david6.1.cp.ks))

david7.1.cp.ks<-david7.cp.ks[order(david7.cp.ks$ID),]
david7.cp.ks<-as.matrix(t(david7.1.cp.ks))

david8.1.cp.ks<-david8.cp.ks[order(david8.cp.ks$ID),]
david8.cp.ks<-as.matrix(t(david8.1.cp.ks))

david9.1.cp.ks<-david9.cp.ks[order(david9.cp.ks$ID),]
david9.cp.ks<-as.matrix(t(david9.1.cp.ks))

david10.1.cp.ks<-david10.cp.ks[order(david10.cp.ks$ID),]
david10.cp.ks<-as.matrix(t(david10.1.cp.ks))

david.ks.cp.ks<-as.data.frame(matrix(c(david1.cp.ks,david2.cp.ks,david3.cp.ks,david4.cp.ks,david5.cp.ks,david6.cp.ks,david7.cp.ks,david8.cp.ks,david9.cp.ks,david10.cp.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.cp.ks<-data.frame(ID=david.ks.cp.ks$V1,DS=david.ks.cp.ks$V2,normDS=david.ks.cp.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.cp.ks<-lm(e1.1.cp.ks$energy_over_time~as.numeric(david1.1.cp.ks$normDS))
ks.lm.1.s.cp.ks<-summary(lm.ks.1.cp.ks)$coefficients
ks.1.slope.cp.ks<-ks.lm.1.s.cp.ks[2,1]
lm.ks.2.cp.ks<-lm(e2.1.cp.ks$energy_over_time~as.numeric(david2.1.cp.ks$normDS))
ks.lm.2.s.cp.ks<-summary(lm.ks.2.cp.ks)$coefficients
ks.2.slope.cp.ks<-ks.lm.2.s.cp.ks[2,1]
lm.ks.3.cp.ks<-lm(e3.1.cp.ks$energy_over_time~as.numeric(david3.1.cp.ks$normDS))
ks.lm.3.s.cp.ks<-summary(lm.ks.3.cp.ks)$coefficients
ks.3.slope.cp.ks<-ks.lm.3.s.cp.ks[2,1]
lm.ks.4.cp.ks<-lm(e4.1.cp.ks$energy_over_time~as.numeric(david4.1.cp.ks$normDS))
ks.lm.4.s.cp.ks<-summary(lm.ks.4.cp.ks)$coefficients
ks.4.slope.cp.ks<-ks.lm.4.s.cp.ks[2,1]
lm.ks.5.cp.ks<-lm(e5.1.cp.ks$energy_over_time~as.numeric(david5.1.cp.ks$normDS))
ks.lm.5.s.cp.ks<-summary(lm.ks.5.cp.ks)$coefficients
ks.5.slope.cp.ks<-ks.lm.5.s.cp.ks[2,1]
lm.ks.6.cp.ks<-lm(e6.1.cp.ks$energy_over_time~as.numeric(david6.1.cp.ks$normDS))
ks.lm.6.s.cp.ks<-summary(lm.ks.6.cp.ks)$coefficients
ks.6.slope.cp.ks<-ks.lm.6.s.cp.ks[2,1]
lm.ks.7.cp.ks<-lm(e7.1.cp.ks$energy_over_time~as.numeric(david7.1.cp.ks$normDS))
ks.lm.7.s.cp.ks<-summary(lm.ks.7.cp.ks)$coefficients
ks.7.slope.cp.ks<-ks.lm.7.s.cp.ks[2,1]
lm.ks.8.cp.ks<-lm(e8.1.cp.ks$energy_over_time~as.numeric(david8.1.cp.ks$normDS))
ks.lm.8.s.cp.ks<-summary(lm.ks.8.cp.ks)$coefficients
ks.8.slope.cp.ks<-ks.lm.8.s.cp.ks[2,1]
lm.ks.9.cp.ks<-lm(e9.1.cp.ks$energy_over_time~as.numeric(david9.1.cp.ks$normDS))
ks.lm.9.s.cp.ks<-summary(lm.ks.9.cp.ks)$coefficients
ks.9.slope.cp.ks<-ks.lm.9.s.cp.ks[2,1]
lm.ks.10.cp.ks<-lm(e10.1.cp.ks$energy_over_time~as.numeric(david10.1.cp.ks$normDS))
ks.lm.10.s.cp.ks<-summary(lm.ks.10.cp.ks)$coefficients
ks.10.slope.cp.ks<-ks.lm.10.s.cp.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.ks,tri2.cp.ks,tri3.cp.ks,tri4.cp.ks,tri5.cp.ks,tri6.cp.ks,tri7.cp.ks,tri8.cp.ks,tri9.cp.ks,tri10.cp.ks),escalation=c(ep1.cp.ks,ep2.cp.ks,ep3.cp.ks,ep4.cp.ks,ep5.cp.ks,ep6.cp.ks,ep7.cp.ks,ep8.cp.ks,ep9.cp.ks,ep10.cp.ks),dci=c(dci1.cp.ks,dci2.cp.ks,dci3.cp.ks,dci4.cp.ks,dci5.cp.ks,dci6.cp.ks,dci7.cp.ks,dci8.cp.ks,dci9.cp.ks,dci10.cp.ks),steepness=c(s1.cp.ks,s2.cp.ks,s3.cp.ks,s4.cp.ks,s5.cp.ks,s6.cp.ks,s7.cp.ks,s8.cp.ks,s9.cp.ks,s10.cp.ks),slope=c(ks.1.slope.cp.ks,ks.2.slope.cp.ks,ks.3.slope.cp.ks,ks.4.slope.cp.ks,ks.5.slope.cp.ks,ks.6.slope.cp.ks,ks.7.slope.cp.ks,ks.8.slope.cp.ks,ks.9.slope.cp.ks,ks.10.slope.cp.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Clump

# Data organization for the Knowledge Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ko<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.ko<-data.frame(X1=avoid.cp.ko[[1]],X2=avoid.cp.ko[[2]],Avoids=avoid.cp.ko[[3]])
a2.cp.ko<-data.frame(X1=avoid.cp.ko[[4]],X2=avoid.cp.ko[[5]],Avoids=avoid.cp.ko[[6]])
a3.cp.ko<-data.frame(X1=avoid.cp.ko[[7]],X2=avoid.cp.ko[[8]],Avoids=avoid.cp.ko[[9]])
a4.cp.ko<-data.frame(X1=avoid.cp.ko[[10]],X2=avoid.cp.ko[[11]],Avoids=avoid.cp.ko[[12]])
a5.cp.ko<-data.frame(X1=avoid.cp.ko[[13]],X2=avoid.cp.ko[[14]],Avoids=avoid.cp.ko[[15]])
a6.cp.ko<-data.frame(X1=avoid.cp.ko[[16]],X2=avoid.cp.ko[[17]],Avoids=avoid.cp.ko[[18]])
a7.cp.ko<-data.frame(X1=avoid.cp.ko[[19]],X2=avoid.cp.ko[[20]],Avoids=avoid.cp.ko[[21]])
a8.cp.ko<-data.frame(X1=avoid.cp.ko[[22]],X2=avoid.cp.ko[[23]],Avoids=avoid.cp.ko[[24]])
a9.cp.ko<-data.frame(X1=avoid.cp.ko[[25]],X2=avoid.cp.ko[[26]],Avoids=avoid.cp.ko[[27]])
a10.cp.ko<-data.frame(X1=avoid.cp.ko[[28]],X2=avoid.cp.ko[[29]],Avoids=avoid.cp.ko[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ko.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.ko<-data.frame(X1=conflict.ko.cp[[1]],X2=conflict.ko.cp[[2]],Victories=conflict.ko.cp[[3]])
mat1.cp.ko<-inter.mat(mut1.cp.ko)
tri1.cp.ko<-tr.tri(mat1.cp.ko)
dci1.cp.ko<-DCindex(mat1.cp.ko)
mat1.cp.ko[is.na(mat1.cp.ko)] = 0
h1.cp.ko<-h.index(mat1.cp.ko)

ep1.cp.ko<-ep(mut1.cp.ko,a1.cp.ko)
david1.cp.ko<-DS(mat1.cp.ko) #David's Scores - for steepness use normDS output
ordrank.1.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.ko<-cbind(ordrank.1.cp.ko,ds=david1.cp.ko$normDS)
lm1.cp.ko<-summary(lm(ordrank.1.cp.ko$ds~ordrank.1.cp.ko$ord.rank))
s1.cp.ko<-lm1.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.ko<-data.frame(X1=conflict.ko.cp[[4]],X2=conflict.ko.cp[[5]],Victories=conflict.ko.cp[[6]])
mat2.cp.ko<-inter.mat(mut2.cp.ko)
tri2.cp.ko<-tr.tri(mat2.cp.ko)
dci2.cp.ko<-DCindex(mat2.cp.ko)
mat2.cp.ko[is.na(mat2.cp.ko)] = 0
h2.cp.ko<-h.index(mat2.cp.ko)

ep2.cp.ko<-ep(mut2.cp.ko,a2.cp.ko)
david2.cp.ko<-DS(mat2.cp.ko) #David's Scores - for steepness use normDS output
ordrank.2.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.ko<-cbind(ordrank.2.cp.ko,ds=david2.cp.ko$normDS)
lm2.cp.ko<-summary(lm(ordrank.2.cp.ko$ds~ordrank.2.cp.ko$ord.rank))
s2.cp.ko<-lm2.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.ko<-data.frame(X1=conflict.ko.cp[[7]],X2=conflict.ko.cp[[8]],Victories=conflict.ko.cp[[9]])
mat3.cp.ko<-inter.mat(mut3.cp.ko)
tri3.cp.ko<-tr.tri(mat3.cp.ko)
dci3.cp.ko<-DCindex(mat3.cp.ko)
mat3.cp.ko[is.na(mat3.cp.ko)] = 0
h3.cp.ko<-h.index(mat3.cp.ko)

ep3.cp.ko<-ep(mut3.cp.ko,a3.cp.ko)
david3.cp.ko<-DS(mat3.cp.ko) #David's Scores - for steepness use normDS output
ordrank.3.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.ko<-cbind(ordrank.3.cp.ko,ds=david3.cp.ko$normDS)
lm3.cp.ko<-summary(lm(ordrank.3.cp.ko$ds~ordrank.3.cp.ko$ord.rank))
s3.cp.ko<-lm3.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.ko<-data.frame(X1=conflict.ko.cp[[10]],X2=conflict.ko.cp[[11]],Victories=conflict.ko.cp[[12]])
mat4.cp.ko<-inter.mat(mut4.cp.ko)
tri4.cp.ko<-tr.tri(mat4.cp.ko)
dci4.cp.ko<-DCindex(mat4.cp.ko)
mat4.cp.ko[is.na(mat4.cp.ko)] = 0
h4.cp.ko<-h.index(mat4.cp.ko)

ep4.cp.ko<-ep(mut4.cp.ko,a4.cp.ko)
david4.cp.ko<-DS(mat4.cp.ko) #David's Scores - for steepness use normDS output
ordrank.4.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.ko<-cbind(ordrank.4.cp.ko,ds=david4.cp.ko$normDS)
lm4.cp.ko<-summary(lm(ordrank.4.cp.ko$ds~ordrank.4.cp.ko$ord.rank))
s4.cp.ko<-lm4.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.ko<-data.frame(X1=conflict.ko.cp[[13]],X2=conflict.ko.cp[[14]],Victories=conflict.ko.cp[[15]])
mat5.cp.ko<-inter.mat(mut5.cp.ko)
tri5.cp.ko<-tr.tri(mat5.cp.ko)
dci5.cp.ko<-DCindex(mat5.cp.ko)
mat5.cp.ko[is.na(mat5.cp.ko)] = 0
h5.cp.ko<-h.index(mat5.cp.ko)

ep5.cp.ko<-ep(mut5.cp.ko,a5.cp.ko)
david5.cp.ko<-DS(mat5.cp.ko) #David's Scores - for steepness use normDS output
ordrank.5.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.ko<-cbind(ordrank.5.cp.ko,ds=david5.cp.ko$normDS)
lm5.cp.ko<-summary(lm(ordrank.5.cp.ko$ds~ordrank.5.cp.ko$ord.rank))
s5.cp.ko<-lm5.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.ko<-data.frame(X1=conflict.ko.cp[[16]],X2=conflict.ko.cp[[17]],Victories=conflict.ko.cp[[18]])
mat6.cp.ko<-inter.mat(mut6.cp.ko)
tri6.cp.ko<-tr.tri(mat6.cp.ko)
dci6.cp.ko<-DCindex(mat6.cp.ko)
mat6.cp.ko[is.na(mat6.cp.ko)] = 0
h6.cp.ko<-h.index(mat6.cp.ko)

ep6.cp.ko<-ep(mut6.cp.ko,a6.cp.ko)
david6.cp.ko<-DS(mat6.cp.ko) #David's Scores - for steepness use normDS output
ordrank.6.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.ko<-cbind(ordrank.6.cp.ko,ds=david6.cp.ko$normDS)
lm6.cp.ko<-summary(lm(ordrank.6.cp.ko$ds~ordrank.6.cp.ko$ord.rank))
s6.cp.ko<-lm6.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.ko<-data.frame(X1=conflict.ko.cp[[19]],X2=conflict.ko.cp[[20]],Victories=conflict.ko.cp[[21]])
mat7.cp.ko<-inter.mat(mut7.cp.ko)
tri7.cp.ko<-tr.tri(mat7.cp.ko)
dci7.cp.ko<-DCindex(mat7.cp.ko)
mat7.cp.ko[is.na(mat7.cp.ko)] = 0
h7.cp.ko<-h.index(mat7.cp.ko)

ep7.cp.ko<-ep(mut7.cp.ko,a7.cp.ko)
david7.cp.ko<-DS(mat7.cp.ko) #David's Scores - for steepness use normDS output
ordrank.7.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.ko<-cbind(ordrank.7.cp.ko,ds=david7.cp.ko$normDS)
lm7.cp.ko<-summary(lm(ordrank.7.cp.ko$ds~ordrank.7.cp.ko$ord.rank))
s7.cp.ko<-lm7.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.ko<-data.frame(X1=conflict.ko.cp[[22]],X2=conflict.ko.cp[[23]],Victories=conflict.ko.cp[[24]])
mat8.cp.ko<-inter.mat(mut8.cp.ko)
tri8.cp.ko<-tr.tri(mat8.cp.ko)
dci8.cp.ko<-DCindex(mat8.cp.ko)
mat8.cp.ko[is.na(mat8.cp.ko)] = 0
h8.cp.ko<-h.index(mat8.cp.ko)

ep8.cp.ko<-ep(mut8.cp.ko,a8.cp.ko)
david8.cp.ko<-DS(mat8.cp.ko) #David's Scores - for steepness use normDS output
ordrank.8.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.ko<-cbind(ordrank.8.cp.ko,ds=david8.cp.ko$normDS)
lm8.cp.ko<-summary(lm(ordrank.8.cp.ko$ds~ordrank.8.cp.ko$ord.rank))
s8.cp.ko<-lm8.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.ko<-data.frame(X1=conflict.ko.cp[[25]],X2=conflict.ko.cp[[26]],Victories=conflict.ko.cp[[27]])
mat9.cp.ko<-inter.mat(mut9.cp.ko)
tri9.cp.ko<-tr.tri(mat9.cp.ko)
dci9.cp.ko<-DCindex(mat9.cp.ko)
mat9.cp.ko[is.na(mat9.cp.ko)] = 0
h9.cp.ko<-h.index(mat9.cp.ko)

ep9.cp.ko<-ep(mut9.cp.ko,a9.cp.ko)
david9.cp.ko<-DS(mat9.cp.ko) #David's Scores - for steepness use normDS output
ordrank.9.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.ko<-cbind(ordrank.9.cp.ko,ds=david9.cp.ko$normDS)
lm9.cp.ko<-summary(lm(ordrank.9.cp.ko$ds~ordrank.9.cp.ko$ord.rank))
s9.cp.ko<-lm9.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.ko<-data.frame(X1=conflict.ko.cp[[28]],X2=conflict.ko.cp[[29]],Victories=conflict.ko.cp[[30]])
mat10.cp.ko<-inter.mat(mut10.cp.ko)
tri10.cp.ko<-tr.tri(mat10.cp.ko)
dci10.cp.ko<-DCindex(mat10.cp.ko)
mat10.cp.ko[is.na(mat10.cp.ko)] = 0
h10.cp.ko<-h.index(mat10.cp.ko)

ep10.cp.ko<-ep(mut10.cp.ko,a10.cp.ko)
david10.cp.ko<-DS(mat10.cp.ko) #David's Scores - for steepness use normDS output
ordrank.10.cp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.ko<-cbind(ordrank.10.cp.ko,ds=david10.cp.ko$normDS)
lm10.cp.ko<-summary(lm(ordrank.10.cp.ko$ds~ordrank.10.cp.ko$ord.rank))
s10.cp.ko<-lm10.cp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.ko<-sum(mut1.cp.ko$Victories)
int2.cp.ko<-sum(mut2.cp.ko$Victories)
int3.cp.ko<-sum(mut3.cp.ko$Victories)
int4.cp.ko<-sum(mut4.cp.ko$Victories)
int5.cp.ko<-sum(mut5.cp.ko$Victories)
int6.cp.ko<-sum(mut6.cp.ko$Victories)
int7.cp.ko<-sum(mut7.cp.ko$Victories)
int8.cp.ko<-sum(mut8.cp.ko$Victories)
int9.cp.ko<-sum(mut9.cp.ko$Victories)
int10.cp.ko<-sum(mut10.cp.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ko<-sum(a1.cp.ko$Victories)
av2.cp.ko<-sum(a2.cp.ko$Victories)
av3.cp.ko<-sum(a3.cp.ko$Victories)
av4.cp.ko<-sum(a4.cp.ko$Victories)
av5.cp.ko<-sum(a5.cp.ko$Victories)
av6.cp.ko<-sum(a6.cp.ko$Victories)
av7.cp.ko<-sum(a7.cp.ko$Victories)
av8.cp.ko<-sum(a8.cp.ko$Victories)
av9.cp.ko<-sum(a9.cp.ko$Victories)
av10.cp.ko<-sum(a10.cp.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.pc<-(sum(av1.cp.ko, av2.cp.ko, av3.cp.ko, av4.cp.ko, av5.cp.ko, av6.cp.ko, av7.cp.ko, av8.cp.ko, av9.cp.ko, av10.cp.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.pc<-(sum(int1.cp.ko, int2.cp.ko, int3.cp.ko, int4.cp.ko, int5.cp.ko, int6.cp.ko, int7.cp.ko, int8.cp.ko, int9.cp.ko, int10.cp.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.ko<-e1.cp.ko[order(e1.cp.ko$ID),]
e1.cp.ko<-as.matrix(t(e1.1.cp.ko))

e2.cp.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.ko<-e2.cp.ko[order(e2.cp.ko$ID),]
e2.cp.ko<-as.matrix(t(e2.1.cp.ko))

e3.cp.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.ko<-e3.cp.ko[order(e3.cp.ko$ID),]
e3.cp.ko<-as.matrix(t(e3.1.cp.ko))

e4.cp.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.ko<-e4.cp.ko[order(e4.cp.ko$ID),]
e4.cp.ko<-as.matrix(t(e4.1.cp.ko))

e5.cp.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.ko<-e5.cp.ko[order(e5.cp.ko$ID),]
e5.cp.ko<-as.matrix(t(e5.1.cp.ko))

e6.cp.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.ko<-e6.cp.ko[order(e6.cp.ko$ID),]
e6.cp.ko<-as.matrix(t(e6.1.cp.ko))

e7.cp.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.ko<-e7.cp.ko[order(e7.cp.ko$ID),]
e7.cp.ko<-as.matrix(t(e7.1.cp.ko))

e8.cp.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.ko<-e8.cp.ko[order(e8.cp.ko$ID),]
e8.cp.ko<-as.matrix(t(e8.1.cp.ko))

e9.cp.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.ko<-e9.cp.ko[order(e9.cp.ko$ID),]
e9.cp.ko<-as.matrix(t(e9.1.cp.ko))

e10.cp.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.ko<-e10.cp.ko[order(e10.cp.ko$ID),]
e10.cp.ko<-as.matrix(t(e10.1.cp.ko))

energy.ko.cp.ko<-as.data.frame(matrix(c(e1.cp.ko,e2.cp.ko,e3.cp.ko,e4.cp.ko,e5.cp.ko,e6.cp.ko,e7.cp.ko,e8.cp.ko,e9.cp.ko,e10.cp.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.cp.ko<-data.frame(ID=energy.ko.cp.ko$V1,energy_over_distance=energy.ko.cp.ko$V2,energy_over_time=energy.ko.cp.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.ko<-david1.cp.ko[order(david1.cp.ko$ID),]
david1.cp.ko<-as.matrix(t(david1.1.cp.ko))

david2.1.cp.ko<-david2.cp.ko[order(david2.cp.ko$ID),]
david2.cp.ko<-as.matrix(t(david2.1.cp.ko))

david3.1.cp.ko<-david3.cp.ko[order(david3.cp.ko$ID),]
david3.cp.ko<-as.matrix(t(david3.1.cp.ko))

david4.1.cp.ko<-david4.cp.ko[order(david4.cp.ko$ID),]
david4.cp.ko<-as.matrix(t(david4.1.cp.ko))

david5.1.cp.ko<-david5.cp.ko[order(david5.cp.ko$ID),]
david5.cp.ko<-as.matrix(t(david5.1.cp.ko))

david6.1.cp.ko<-david6.cp.ko[order(david6.cp.ko$ID),]
david6.cp.ko<-as.matrix(t(david6.1.cp.ko))

david7.1.cp.ko<-david7.cp.ko[order(david7.cp.ko$ID),]
david7.cp.ko<-as.matrix(t(david7.1.cp.ko))

david8.1.cp.ko<-david8.cp.ko[order(david8.cp.ko$ID),]
david8.cp.ko<-as.matrix(t(david8.1.cp.ko))

david9.1.cp.ko<-david9.cp.ko[order(david9.cp.ko$ID),]
david9.cp.ko<-as.matrix(t(david9.1.cp.ko))

david10.1.cp.ko<-david10.cp.ko[order(david10.cp.ko$ID),]
david10.cp.ko<-as.matrix(t(david10.1.cp.ko))

david.ko.cp.ko<-as.data.frame(matrix(c(david1.cp.ko,david2.cp.ko,david3.cp.ko,david4.cp.ko,david5.cp.ko,david6.cp.ko,david7.cp.ko,david8.cp.ko,david9.cp.ko,david10.cp.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.cp.ko<-data.frame(ID=david.ko.cp.ko$V1,DS=david.ko.cp.ko$V2,normDS=david.ko.cp.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.cp.ko<-lm(e1.1.cp.ko$energy_over_time~as.numeric(david1.1.cp.ko$normDS))
ko.lm.1.s.cp.ko<-summary(lm.ko.1.cp.ko)$coefficients
ko.1.slope.cp.ko<-ko.lm.1.s.cp.ko[2,1]
lm.ko.2.cp.ko<-lm(e2.1.cp.ko$energy_over_time~as.numeric(david2.1.cp.ko$normDS))
ko.lm.2.s.cp.ko<-summary(lm.ko.2.cp.ko)$coefficients
ko.2.slope.cp.ko<-ko.lm.2.s.cp.ko[2,1]
lm.ko.3.cp.ko<-lm(e3.1.cp.ko$energy_over_time~as.numeric(david3.1.cp.ko$normDS))
ko.lm.3.s.cp.ko<-summary(lm.ko.3.cp.ko)$coefficients
ko.3.slope.cp.ko<-ko.lm.3.s.cp.ko[2,1]
lm.ko.4.cp.ko<-lm(e4.1.cp.ko$energy_over_time~as.numeric(david4.1.cp.ko$normDS))
ko.lm.4.s.cp.ko<-summary(lm.ko.4.cp.ko)$coefficients
ko.4.slope.cp.ko<-ko.lm.4.s.cp.ko[2,1]
lm.ko.5.cp.ko<-lm(e5.1.cp.ko$energy_over_time~as.numeric(david5.1.cp.ko$normDS))
ko.lm.5.s.cp.ko<-summary(lm.ko.5.cp.ko)$coefficients
ko.5.slope.cp.ko<-ko.lm.5.s.cp.ko[2,1]
lm.ko.6.cp.ko<-lm(e6.1.cp.ko$energy_over_time~as.numeric(david6.1.cp.ko$normDS))
ko.lm.6.s.cp.ko<-summary(lm.ko.6.cp.ko)$coefficients
ko.6.slope.cp.ko<-ko.lm.6.s.cp.ko[2,1]
lm.ko.7.cp.ko<-lm(e7.1.cp.ko$energy_over_time~as.numeric(david7.1.cp.ko$normDS))
ko.lm.7.s.cp.ko<-summary(lm.ko.7.cp.ko)$coefficients
ko.7.slope.cp.ko<-ko.lm.7.s.cp.ko[2,1]
lm.ko.8.cp.ko<-lm(e8.1.cp.ko$energy_over_time~as.numeric(david8.1.cp.ko$normDS))
ko.lm.8.s.cp.ko<-summary(lm.ko.8.cp.ko)$coefficients
ko.8.slope.cp.ko<-ko.lm.8.s.cp.ko[2,1]
lm.ko.9.cp.ko<-lm(e9.1.cp.ko$energy_over_time~as.numeric(david9.1.cp.ko$normDS))
ko.lm.9.s.cp.ko<-summary(lm.ko.9.cp.ko)$coefficients
ko.9.slope.cp.ko<-ko.lm.9.s.cp.ko[2,1]
lm.ko.10.cp.ko<-lm(e10.1.cp.ko$energy_over_time~as.numeric(david10.1.cp.ko$normDS))
ko.lm.10.s.cp.ko<-summary(lm.ko.10.cp.ko)$coefficients
ko.10.slope.cp.ko<-ko.lm.10.s.cp.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.ko,tri2.cp.ko,tri3.cp.ko,tri4.cp.ko,tri5.cp.ko,tri6.cp.ko,tri7.cp.ko,tri8.cp.ko,tri9.cp.ko,tri10.cp.ko),escalation=c(ep1.cp.ko,ep2.cp.ko,ep3.cp.ko,ep4.cp.ko,ep5.cp.ko,ep6.cp.ko,ep7.cp.ko,ep8.cp.ko,ep9.cp.ko,ep10.cp.ko),dci=c(dci1.cp.ko,dci2.cp.ko,dci3.cp.ko,dci4.cp.ko,dci5.cp.ko,dci6.cp.ko,dci7.cp.ko,dci8.cp.ko,dci9.cp.ko,dci10.cp.ko),steepness=c(s1.cp.ko,s2.cp.ko,s3.cp.ko,s4.cp.ko,s5.cp.ko,s6.cp.ko,s7.cp.ko,s8.cp.ko,s9.cp.ko,s10.cp.ko),slope=c(ko.1.slope.cp.ko,ko.2.slope.cp.ko,ko.3.slope.cp.ko,ko.4.slope.cp.ko,ko.5.slope.cp.ko,ko.6.slope.cp.ko,ko.7.slope.cp.ko,ko.8.slope.cp.ko,ko.9.slope.cp.ko,ko.10.slope.cp.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.hm<-data.frame(X1=avoid.cp.hm[[1]],X2=avoid.cp.hm[[2]],Avoids=avoid.cp.hm[[3]])
a2.cp.hm<-data.frame(X1=avoid.cp.hm[[4]],X2=avoid.cp.hm[[5]],Avoids=avoid.cp.hm[[6]])
a3.cp.hm<-data.frame(X1=avoid.cp.hm[[7]],X2=avoid.cp.hm[[8]],Avoids=avoid.cp.hm[[9]])
a4.cp.hm<-data.frame(X1=avoid.cp.hm[[10]],X2=avoid.cp.hm[[11]],Avoids=avoid.cp.hm[[12]])
a5.cp.hm<-data.frame(X1=avoid.cp.hm[[13]],X2=avoid.cp.hm[[14]],Avoids=avoid.cp.hm[[15]])
a6.cp.hm<-data.frame(X1=avoid.cp.hm[[16]],X2=avoid.cp.hm[[17]],Avoids=avoid.cp.hm[[18]])
a7.cp.hm<-data.frame(X1=avoid.cp.hm[[19]],X2=avoid.cp.hm[[20]],Avoids=avoid.cp.hm[[21]])
a8.cp.hm<-data.frame(X1=avoid.cp.hm[[22]],X2=avoid.cp.hm[[23]],Avoids=avoid.cp.hm[[24]])
a9.cp.hm<-data.frame(X1=avoid.cp.hm[[25]],X2=avoid.cp.hm[[26]],Avoids=avoid.cp.hm[[27]])
a10.cp.hm<-data.frame(X1=avoid.cp.hm[[28]],X2=avoid.cp.hm[[29]],Avoids=avoid.cp.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.hm<-data.frame(X1=conflict.hm.cp[[1]],X2=conflict.hm.cp[[2]],Victories=conflict.hm.cp[[3]])
mat1.cp.hm<-inter.mat(mut1.cp.hm)
tri1.cp.hm<-tr.tri(mat1.cp.hm)
dci1.cp.hm<-DCindex(mat1.cp.hm)
mat1.cp.hm[is.na(mat1.cp.hm)] = 0
h1.cp.hm<-h.index(mat1.cp.hm)

ep1.cp.hm<-ep(mut1.cp.hm,a1.cp.hm)
david1.cp.hm<-DS(mat1.cp.hm) #David's Scores - for steepness use normDS output
ordrank.1.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.hm<-cbind(ordrank.1.cp.hm,ds=david1.cp.hm$normDS)
lm1.cp.hm<-summary(lm(ordrank.1.cp.hm$ds~ordrank.1.cp.hm$ord.rank))
s1.cp.hm<-lm1.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.hm<-data.frame(X1=conflict.hm.cp[[4]],X2=conflict.hm.cp[[5]],Victories=conflict.hm.cp[[6]])
mat2.cp.hm<-inter.mat(mut2.cp.hm)
tri2.cp.hm<-tr.tri(mat2.cp.hm)
dci2.cp.hm<-DCindex(mat2.cp.hm)
mat2.cp.hm[is.na(mat2.cp.hm)] = 0
h2.cp.hm<-h.index(mat2.cp.hm)

ep2.cp.hm<-ep(mut2.cp.hm,a2.cp.hm)
david2.cp.hm<-DS(mat2.cp.hm) #David's Scores - for steepness use normDS output
ordrank.2.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.hm<-cbind(ordrank.2.cp.hm,ds=david2.cp.hm$normDS)
lm2.cp.hm<-summary(lm(ordrank.2.cp.hm$ds~ordrank.2.cp.hm$ord.rank))
s2.cp.hm<-lm2.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.hm<-data.frame(X1=conflict.hm.cp[[7]],X2=conflict.hm.cp[[8]],Victories=conflict.hm.cp[[9]])
mat3.cp.hm<-inter.mat(mut3.cp.hm)
tri3.cp.hm<-tr.tri(mat3.cp.hm)
dci3.cp.hm<-DCindex(mat3.cp.hm)
mat3.cp.hm[is.na(mat3.cp.hm)] = 0
h3.cp.hm<-h.index(mat3.cp.hm)

ep3.cp.hm<-ep(mut3.cp.hm,a3.cp.hm)
david3.cp.hm<-DS(mat3.cp.hm) #David's Scores - for steepness use normDS output
ordrank.3.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.hm<-cbind(ordrank.3.cp.hm,ds=david3.cp.hm$normDS)
lm3.cp.hm<-summary(lm(ordrank.3.cp.hm$ds~ordrank.3.cp.hm$ord.rank))
s3.cp.hm<-lm3.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.hm<-data.frame(X1=conflict.hm.cp[[10]],X2=conflict.hm.cp[[11]],Victories=conflict.hm.cp[[12]])
mat4.cp.hm<-inter.mat(mut4.cp.hm)
tri4.cp.hm<-tr.tri(mat4.cp.hm)
dci4.cp.hm<-DCindex(mat4.cp.hm)
mat4.cp.hm[is.na(mat4.cp.hm)] = 0
h4.cp.hm<-h.index(mat4.cp.hm)

ep4.cp.hm<-ep(mut4.cp.hm,a4.cp.hm)
david4.cp.hm<-DS(mat4.cp.hm) #David's Scores - for steepness use normDS output
ordrank.4.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.hm<-cbind(ordrank.4.cp.hm,ds=david4.cp.hm$normDS)
lm4.cp.hm<-summary(lm(ordrank.4.cp.hm$ds~ordrank.4.cp.hm$ord.rank))
s4.cp.hm<-lm4.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.hm<-data.frame(X1=conflict.hm.cp[[13]],X2=conflict.hm.cp[[14]],Victories=conflict.hm.cp[[15]])
mat5.cp.hm<-inter.mat(mut5.cp.hm)
tri5.cp.hm<-tr.tri(mat5.cp.hm)
dci5.cp.hm<-DCindex(mat5.cp.hm)
mat5.cp.hm[is.na(mat5.cp.hm)] = 0
h5.cp.hm<-h.index(mat5.cp.hm)

ep5.cp.hm<-ep(mut5.cp.hm,a5.cp.hm)
david5.cp.hm<-DS(mat5.cp.hm) #David's Scores - for steepness use normDS output
ordrank.5.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.hm<-cbind(ordrank.5.cp.hm,ds=david5.cp.hm$normDS)
lm5.cp.hm<-summary(lm(ordrank.5.cp.hm$ds~ordrank.5.cp.hm$ord.rank))
s5.cp.hm<-lm5.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.hm<-data.frame(X1=conflict.hm.cp[[16]],X2=conflict.hm.cp[[17]],Victories=conflict.hm.cp[[18]])
mat6.cp.hm<-inter.mat(mut6.cp.hm)
tri6.cp.hm<-tr.tri(mat6.cp.hm)
dci6.cp.hm<-DCindex(mat6.cp.hm)
mat6.cp.hm[is.na(mat6.cp.hm)] = 0
h6.cp.hm<-h.index(mat6.cp.hm)

ep6.cp.hm<-ep(mut6.cp.hm,a6.cp.hm)
david6.cp.hm<-DS(mat6.cp.hm) #David's Scores - for steepness use normDS output
ordrank.6.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.hm<-cbind(ordrank.6.cp.hm,ds=david6.cp.hm$normDS)
lm6.cp.hm<-summary(lm(ordrank.6.cp.hm$ds~ordrank.6.cp.hm$ord.rank))
s6.cp.hm<-lm6.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.hm<-data.frame(X1=conflict.hm.cp[[19]],X2=conflict.hm.cp[[20]],Victories=conflict.hm.cp[[21]])
mat7.cp.hm<-inter.mat(mut7.cp.hm)
tri7.cp.hm<-tr.tri(mat7.cp.hm)
dci7.cp.hm<-DCindex(mat7.cp.hm)
mat7.cp.hm[is.na(mat7.cp.hm)] = 0
h7.cp.hm<-h.index(mat7.cp.hm)

ep7.cp.hm<-ep(mut7.cp.hm,a7.cp.hm)
david7.cp.hm<-DS(mat7.cp.hm) #David's Scores - for steepness use normDS output
ordrank.7.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.hm<-cbind(ordrank.7.cp.hm,ds=david7.cp.hm$normDS)
lm7.cp.hm<-summary(lm(ordrank.7.cp.hm$ds~ordrank.7.cp.hm$ord.rank))
s7.cp.hm<-lm7.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.hm<-data.frame(X1=conflict.hm.cp[[22]],X2=conflict.hm.cp[[23]],Victories=conflict.hm.cp[[24]])
mat8.cp.hm<-inter.mat(mut8.cp.hm)
tri8.cp.hm<-tr.tri(mat8.cp.hm)
dci8.cp.hm<-DCindex(mat8.cp.hm)
mat8.cp.hm[is.na(mat8.cp.hm)] = 0
h8.cp.hm<-h.index(mat8.cp.hm)

ep8.cp.hm<-ep(mut8.cp.hm,a8.cp.hm)
david8.cp.hm<-DS(mat8.cp.hm) #David's Scores - for steepness use normDS output
ordrank.8.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.hm<-cbind(ordrank.8.cp.hm,ds=david8.cp.hm$normDS)
lm8.cp.hm<-summary(lm(ordrank.8.cp.hm$ds~ordrank.8.cp.hm$ord.rank))
s8.cp.hm<-lm8.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.hm<-data.frame(X1=conflict.hm.cp[[25]],X2=conflict.hm.cp[[26]],Victories=conflict.hm.cp[[27]])
mat9.cp.hm<-inter.mat(mut9.cp.hm)
tri9.cp.hm<-tr.tri(mat9.cp.hm)
dci9.cp.hm<-DCindex(mat9.cp.hm)
mat9.cp.hm[is.na(mat9.cp.hm)] = 0
h9.cp.hm<-h.index(mat9.cp.hm)

ep9.cp.hm<-ep(mut9.cp.hm,a9.cp.hm)
david9.cp.hm<-DS(mat9.cp.hm) #David's Scores - for steepness use normDS output
ordrank.9.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.hm<-cbind(ordrank.9.cp.hm,ds=david9.cp.hm$normDS)
lm9.cp.hm<-summary(lm(ordrank.9.cp.hm$ds~ordrank.9.cp.hm$ord.rank))
s9.cp.hm<-lm9.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.hm<-data.frame(X1=conflict.hm.cp[[28]],X2=conflict.hm.cp[[29]],Victories=conflict.hm.cp[[30]])
mat10.cp.hm<-inter.mat(mut10.cp.hm)
tri10.cp.hm<-tr.tri(mat10.cp.hm)
dci10.cp.hm<-DCindex(mat10.cp.hm)
mat10.cp.hm[is.na(mat10.cp.hm)] = 0
h10.cp.hm<-h.index(mat10.cp.hm)

ep10.cp.hm<-ep(mut10.cp.hm,a10.cp.hm)
david10.cp.hm<-DS(mat10.cp.hm) #David's Scores - for steepness use normDS output
ordrank.10.cp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.hm<-cbind(ordrank.10.cp.hm,ds=david10.cp.hm$normDS)
lm10.cp.hm<-summary(lm(ordrank.10.cp.hm$ds~ordrank.10.cp.hm$ord.rank))
s10.cp.hm<-lm10.cp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.hm<-sum(mut1.cp.hm$Victories)
int2.cp.hm<-sum(mut2.cp.hm$Victories)
int3.cp.hm<-sum(mut3.cp.hm$Victories)
int4.cp.hm<-sum(mut4.cp.hm$Victories)
int5.cp.hm<-sum(mut5.cp.hm$Victories)
int6.cp.hm<-sum(mut6.cp.hm$Victories)
int7.cp.hm<-sum(mut7.cp.hm$Victories)
int8.cp.hm<-sum(mut8.cp.hm$Victories)
int9.cp.hm<-sum(mut9.cp.hm$Victories)
int10.cp.hm<-sum(mut10.cp.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.hm<-sum(a1.cp.hm$Victories)
av2.cp.hm<-sum(a2.cp.hm$Victories)
av3.cp.hm<-sum(a3.cp.hm$Victories)
av4.cp.hm<-sum(a4.cp.hm$Victories)
av5.cp.hm<-sum(a5.cp.hm$Victories)
av6.cp.hm<-sum(a6.cp.hm$Victories)
av7.cp.hm<-sum(a7.cp.hm$Victories)
av8.cp.hm<-sum(a8.cp.hm$Victories)
av9.cp.hm<-sum(a9.cp.hm$Victories)
av10.cp.hm<-sum(a10.cp.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.pc<-(sum(av1.cp.hm, av2.cp.hm, av3.cp.hm, av4.cp.hm, av5.cp.hm, av6.cp.hm, av7.cp.hm, av8.cp.hm, av9.cp.hm, av10.cp.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.pc<-(sum(int1.cp.hm, int2.cp.hm, int3.cp.hm, int4.cp.hm, int5.cp.hm, int6.cp.hm, int7.cp.hm, int8.cp.hm, int9.cp.hm, int10.cp.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.hm<-e1.cp.hm[order(e1.cp.hm$ID),]
e1.cp.hm<-as.matrix(t(e1.1.cp.hm))

e2.cp.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.hm<-e2.cp.hm[order(e2.cp.hm$ID),]
e2.cp.hm<-as.matrix(t(e2.1.cp.hm))

e3.cp.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.hm<-e3.cp.hm[order(e3.cp.hm$ID),]
e3.cp.hm<-as.matrix(t(e3.1.cp.hm))

e4.cp.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.hm<-e4.cp.hm[order(e4.cp.hm$ID),]
e4.cp.hm<-as.matrix(t(e4.1.cp.hm))

e5.cp.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.hm<-e5.cp.hm[order(e5.cp.hm$ID),]
e5.cp.hm<-as.matrix(t(e5.1.cp.hm))

e6.cp.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.hm<-e6.cp.hm[order(e6.cp.hm$ID),]
e6.cp.hm<-as.matrix(t(e6.1.cp.hm))

e7.cp.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.hm<-e7.cp.hm[order(e7.cp.hm$ID),]
e7.cp.hm<-as.matrix(t(e7.1.cp.hm))

e8.cp.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.hm<-e8.cp.hm[order(e8.cp.hm$ID),]
e8.cp.hm<-as.matrix(t(e8.1.cp.hm))

e9.cp.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.hm<-e9.cp.hm[order(e9.cp.hm$ID),]
e9.cp.hm<-as.matrix(t(e9.1.cp.hm))

e10.cp.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.hm<-e10.cp.hm[order(e10.cp.hm$ID),]
e10.cp.hm<-as.matrix(t(e10.1.cp.hm))

energy.hm.cp.hm<-as.data.frame(matrix(c(e1.cp.hm,e2.cp.hm,e3.cp.hm,e4.cp.hm,e5.cp.hm,e6.cp.hm,e7.cp.hm,e8.cp.hm,e9.cp.hm,e10.cp.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.cp.hm<-data.frame(ID=energy.hm.cp.hm$V1,energy_over_distance=energy.hm.cp.hm$V2,energy_over_time=energy.hm.cp.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.hm<-david1.cp.hm[order(david1.cp.hm$ID),]
david1.cp.hm<-as.matrix(t(david1.1.cp.hm))

david2.1.cp.hm<-david2.cp.hm[order(david2.cp.hm$ID),]
david2.cp.hm<-as.matrix(t(david2.1.cp.hm))

david3.1.cp.hm<-david3.cp.hm[order(david3.cp.hm$ID),]
david3.cp.hm<-as.matrix(t(david3.1.cp.hm))

david4.1.cp.hm<-david4.cp.hm[order(david4.cp.hm$ID),]
david4.cp.hm<-as.matrix(t(david4.1.cp.hm))

david5.1.cp.hm<-david5.cp.hm[order(david5.cp.hm$ID),]
david5.cp.hm<-as.matrix(t(david5.1.cp.hm))

david6.1.cp.hm<-david6.cp.hm[order(david6.cp.hm$ID),]
david6.cp.hm<-as.matrix(t(david6.1.cp.hm))

david7.1.cp.hm<-david7.cp.hm[order(david7.cp.hm$ID),]
david7.cp.hm<-as.matrix(t(david7.1.cp.hm))

david8.1.cp.hm<-david8.cp.hm[order(david8.cp.hm$ID),]
david8.cp.hm<-as.matrix(t(david8.1.cp.hm))

david9.1.cp.hm<-david9.cp.hm[order(david9.cp.hm$ID),]
david9.cp.hm<-as.matrix(t(david9.1.cp.hm))

david10.1.cp.hm<-david10.cp.hm[order(david10.cp.hm$ID),]
david10.cp.hm<-as.matrix(t(david10.1.cp.hm))

david.hm.cp.hm<-as.data.frame(matrix(c(david1.cp.hm,david2.cp.hm,david3.cp.hm,david4.cp.hm,david5.cp.hm,david6.cp.hm,david7.cp.hm,david8.cp.hm,david9.cp.hm,david10.cp.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.cp.hm<-data.frame(ID=david.hm.cp.hm$V1,DS=david.hm.cp.hm$V2,normDS=david.hm.cp.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.cp.hm<-lm(e1.1.cp.hm$energy_over_time~as.numeric(david1.1.cp.hm$normDS))
hm.lm.1.s.cp.hm<-summary(lm.hm.1.cp.hm)$coefficients
hm.1.slope.cp.hm<-hm.lm.1.s.cp.hm[2,1]
lm.hm.2.cp.hm<-lm(e2.1.cp.hm$energy_over_time~as.numeric(david2.1.cp.hm$normDS))
hm.lm.2.s.cp.hm<-summary(lm.hm.2.cp.hm)$coefficients
hm.2.slope.cp.hm<-hm.lm.2.s.cp.hm[2,1]
lm.hm.3.cp.hm<-lm(e3.1.cp.hm$energy_over_time~as.numeric(david3.1.cp.hm$normDS))
hm.lm.3.s.cp.hm<-summary(lm.hm.3.cp.hm)$coefficients
hm.3.slope.cp.hm<-hm.lm.3.s.cp.hm[2,1]
lm.hm.4.cp.hm<-lm(e4.1.cp.hm$energy_over_time~as.numeric(david4.1.cp.hm$normDS))
hm.lm.4.s.cp.hm<-summary(lm.hm.4.cp.hm)$coefficients
hm.4.slope.cp.hm<-hm.lm.4.s.cp.hm[2,1]
lm.hm.5.cp.hm<-lm(e5.1.cp.hm$energy_over_time~as.numeric(david5.1.cp.hm$normDS))
hm.lm.5.s.cp.hm<-summary(lm.hm.5.cp.hm)$coefficients
hm.5.slope.cp.hm<-hm.lm.5.s.cp.hm[2,1]
lm.hm.6.cp.hm<-lm(e6.1.cp.hm$energy_over_time~as.numeric(david6.1.cp.hm$normDS))
hm.lm.6.s.cp.hm<-summary(lm.hm.6.cp.hm)$coefficients
hm.6.slope.cp.hm<-hm.lm.6.s.cp.hm[2,1]
lm.hm.7.cp.hm<-lm(e7.1.cp.hm$energy_over_time~as.numeric(david7.1.cp.hm$normDS))
hm.lm.7.s.cp.hm<-summary(lm.hm.7.cp.hm)$coefficients
hm.7.slope.cp.hm<-hm.lm.7.s.cp.hm[2,1]
lm.hm.8.cp.hm<-lm(e8.1.cp.hm$energy_over_time~as.numeric(david8.1.cp.hm$normDS))
hm.lm.8.s.cp.hm<-summary(lm.hm.8.cp.hm)$coefficients
hm.8.slope.cp.hm<-hm.lm.8.s.cp.hm[2,1]
lm.hm.9.cp.hm<-lm(e9.1.cp.hm$energy_over_time~as.numeric(david9.1.cp.hm$normDS))
hm.lm.9.s.cp.hm<-summary(lm.hm.9.cp.hm)$coefficients
hm.9.slope.cp.hm<-hm.lm.9.s.cp.hm[2,1]
lm.hm.10.cp.hm<-lm(e10.1.cp.hm$energy_over_time~as.numeric(david10.1.cp.hm$normDS))
hm.lm.10.s.cp.hm<-summary(lm.hm.10.cp.hm)$coefficients
hm.10.slope.cp.hm<-hm.lm.10.s.cp.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.hm,tri2.cp.hm,tri3.cp.hm,tri4.cp.hm,tri5.cp.hm,tri6.cp.hm,tri7.cp.hm,tri8.cp.hm,tri9.cp.hm,tri10.cp.hm),escalation=c(ep1.cp.hm,ep2.cp.hm,ep3.cp.hm,ep4.cp.hm,ep5.cp.hm,ep6.cp.hm,ep7.cp.hm,ep8.cp.hm,ep9.cp.hm,ep10.cp.hm),dci=c(dci1.cp.hm,dci2.cp.hm,dci3.cp.hm,dci4.cp.hm,dci5.cp.hm,dci6.cp.hm,dci7.cp.hm,dci8.cp.hm,dci9.cp.hm,dci10.cp.hm),steepness=c(s1.cp.hm,s2.cp.hm,s3.cp.hm,s4.cp.hm,s5.cp.hm,s6.cp.hm,s7.cp.hm,s8.cp.hm,s9.cp.hm,s10.cp.hm),slope=c(hm.1.slope.cp.hm,hm.2.slope.cp.hm,hm.3.slope.cp.hm,hm.4.slope.cp.hm,hm.5.slope.cp.hm,hm.6.slope.cp.hm,hm.7.slope.cp.hm,hm.8.slope.cp.hm,hm.9.slope.cp.hm,hm.10.slope.cp.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the History Self Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.hs<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.hs<-data.frame(X1=avoid.cp.hs[[1]],X2=avoid.cp.hs[[2]],Avoids=avoid.cp.hs[[3]])
a2.cp.hs<-data.frame(X1=avoid.cp.hs[[4]],X2=avoid.cp.hs[[5]],Avoids=avoid.cp.hs[[6]])
a3.cp.hs<-data.frame(X1=avoid.cp.hs[[7]],X2=avoid.cp.hs[[8]],Avoids=avoid.cp.hs[[9]])
a4.cp.hs<-data.frame(X1=avoid.cp.hs[[10]],X2=avoid.cp.hs[[11]],Avoids=avoid.cp.hs[[12]])
a5.cp.hs<-data.frame(X1=avoid.cp.hs[[13]],X2=avoid.cp.hs[[14]],Avoids=avoid.cp.hs[[15]])
a6.cp.hs<-data.frame(X1=avoid.cp.hs[[16]],X2=avoid.cp.hs[[17]],Avoids=avoid.cp.hs[[18]])
a7.cp.hs<-data.frame(X1=avoid.cp.hs[[19]],X2=avoid.cp.hs[[20]],Avoids=avoid.cp.hs[[21]])
a8.cp.hs<-data.frame(X1=avoid.cp.hs[[22]],X2=avoid.cp.hs[[23]],Avoids=avoid.cp.hs[[24]])
a9.cp.hs<-data.frame(X1=avoid.cp.hs[[25]],X2=avoid.cp.hs[[26]],Avoids=avoid.cp.hs[[27]])
a10.cp.hs<-data.frame(X1=avoid.cp.hs[[28]],X2=avoid.cp.hs[[29]],Avoids=avoid.cp.hs[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hs.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.hs<-data.frame(X1=conflict.hs.cp[[1]],X2=conflict.hs.cp[[2]],Victories=conflict.hs.cp[[3]])
mat1.cp.hs<-inter.mat(mut1.cp.hs)
tri1.cp.hs<-tr.tri(mat1.cp.hs)
dci1.cp.hs<-DCindex(mat1.cp.hs)
mat1.cp.hs[is.na(mat1.cp.hs)] = 0
h1.cp.hs<-h.index(mat1.cp.hs)

ep1.cp.hs<-ep(mut1.cp.hs,a1.cp.hs)
david1.cp.hs<-DS(mat1.cp.hs) #David's Scores - for steepness use normDS output
ordrank.1.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.hs<-cbind(ordrank.1.cp.hs,ds=david1.cp.hs$normDS)
lm1.cp.hs<-summary(lm(ordrank.1.cp.hs$ds~ordrank.1.cp.hs$ord.rank))
s1.cp.hs<-lm1.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.hs<-data.frame(X1=conflict.hs.cp[[4]],X2=conflict.hs.cp[[5]],Victories=conflict.hs.cp[[6]])
mat2.cp.hs<-inter.mat(mut2.cp.hs)
tri2.cp.hs<-tr.tri(mat2.cp.hs)
dci2.cp.hs<-DCindex(mat2.cp.hs)
mat2.cp.hs[is.na(mat2.cp.hs)] = 0
h2.cp.hs<-h.index(mat2.cp.hs)

ep2.cp.hs<-ep(mut2.cp.hs,a2.cp.hs)
david2.cp.hs<-DS(mat2.cp.hs) #David's Scores - for steepness use normDS output
ordrank.2.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.hs<-cbind(ordrank.2.cp.hs,ds=david2.cp.hs$normDS)
lm2.cp.hs<-summary(lm(ordrank.2.cp.hs$ds~ordrank.2.cp.hs$ord.rank))
s2.cp.hs<-lm2.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.hs<-data.frame(X1=conflict.hs.cp[[7]],X2=conflict.hs.cp[[8]],Victories=conflict.hs.cp[[9]])
mat3.cp.hs<-inter.mat(mut3.cp.hs)
tri3.cp.hs<-tr.tri(mat3.cp.hs)
dci3.cp.hs<-DCindex(mat3.cp.hs)
mat3.cp.hs[is.na(mat3.cp.hs)] = 0
h3.cp.hs<-h.index(mat3.cp.hs)

ep3.cp.hs<-ep(mut3.cp.hs,a3.cp.hs)
david3.cp.hs<-DS(mat3.cp.hs) #David's Scores - for steepness use normDS output
ordrank.3.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.hs<-cbind(ordrank.3.cp.hs,ds=david3.cp.hs$normDS)
lm3.cp.hs<-summary(lm(ordrank.3.cp.hs$ds~ordrank.3.cp.hs$ord.rank))
s3.cp.hs<-lm3.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.hs<-data.frame(X1=conflict.hs.cp[[10]],X2=conflict.hs.cp[[11]],Victories=conflict.hs.cp[[12]])
mat4.cp.hs<-inter.mat(mut4.cp.hs)
tri4.cp.hs<-tr.tri(mat4.cp.hs)
dci4.cp.hs<-DCindex(mat4.cp.hs)
mat4.cp.hs[is.na(mat4.cp.hs)] = 0
h4.cp.hs<-h.index(mat4.cp.hs)

ep4.cp.hs<-ep(mut4.cp.hs,a4.cp.hs)
david4.cp.hs<-DS(mat4.cp.hs) #David's Scores - for steepness use normDS output
ordrank.4.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.hs<-cbind(ordrank.4.cp.hs,ds=david4.cp.hs$normDS)
lm4.cp.hs<-summary(lm(ordrank.4.cp.hs$ds~ordrank.4.cp.hs$ord.rank))
s4.cp.hs<-lm4.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.hs<-data.frame(X1=conflict.hs.cp[[13]],X2=conflict.hs.cp[[14]],Victories=conflict.hs.cp[[15]])
mat5.cp.hs<-inter.mat(mut5.cp.hs)
tri5.cp.hs<-tr.tri(mat5.cp.hs)
dci5.cp.hs<-DCindex(mat5.cp.hs)
mat5.cp.hs[is.na(mat5.cp.hs)] = 0
h5.cp.hs<-h.index(mat5.cp.hs)

ep5.cp.hs<-ep(mut5.cp.hs,a5.cp.hs)
david5.cp.hs<-DS(mat5.cp.hs) #David's Scores - for steepness use normDS output
ordrank.5.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.hs<-cbind(ordrank.5.cp.hs,ds=david5.cp.hs$normDS)
lm5.cp.hs<-summary(lm(ordrank.5.cp.hs$ds~ordrank.5.cp.hs$ord.rank))
s5.cp.hs<-lm5.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.hs<-data.frame(X1=conflict.hs.cp[[16]],X2=conflict.hs.cp[[17]],Victories=conflict.hs.cp[[18]])
mat6.cp.hs<-inter.mat(mut6.cp.hs)
tri6.cp.hs<-tr.tri(mat6.cp.hs)
dci6.cp.hs<-DCindex(mat6.cp.hs)
mat6.cp.hs[is.na(mat6.cp.hs)] = 0
h6.cp.hs<-h.index(mat6.cp.hs)

ep6.cp.hs<-ep(mut6.cp.hs,a6.cp.hs)
david6.cp.hs<-DS(mat6.cp.hs) #David's Scores - for steepness use normDS output
ordrank.6.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.hs<-cbind(ordrank.6.cp.hs,ds=david6.cp.hs$normDS)
lm6.cp.hs<-summary(lm(ordrank.6.cp.hs$ds~ordrank.6.cp.hs$ord.rank))
s6.cp.hs<-lm6.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.hs<-data.frame(X1=conflict.hs.cp[[19]],X2=conflict.hs.cp[[20]],Victories=conflict.hs.cp[[21]])
mat7.cp.hs<-inter.mat(mut7.cp.hs)
tri7.cp.hs<-tr.tri(mat7.cp.hs)
dci7.cp.hs<-DCindex(mat7.cp.hs)
mat7.cp.hs[is.na(mat7.cp.hs)] = 0
h7.cp.hs<-h.index(mat7.cp.hs)

ep7.cp.hs<-ep(mut7.cp.hs,a7.cp.hs)
david7.cp.hs<-DS(mat7.cp.hs) #David's Scores - for steepness use normDS output
ordrank.7.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.hs<-cbind(ordrank.7.cp.hs,ds=david7.cp.hs$normDS)
lm7.cp.hs<-summary(lm(ordrank.7.cp.hs$ds~ordrank.7.cp.hs$ord.rank))
s7.cp.hs<-lm7.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.hs<-data.frame(X1=conflict.hs.cp[[22]],X2=conflict.hs.cp[[23]],Victories=conflict.hs.cp[[24]])
mat8.cp.hs<-inter.mat(mut8.cp.hs)
tri8.cp.hs<-tr.tri(mat8.cp.hs)
dci8.cp.hs<-DCindex(mat8.cp.hs)
mat8.cp.hs[is.na(mat8.cp.hs)] = 0
h8.cp.hs<-h.index(mat8.cp.hs)

ep8.cp.hs<-ep(mut8.cp.hs,a8.cp.hs)
david8.cp.hs<-DS(mat8.cp.hs) #David's Scores - for steepness use normDS output
ordrank.8.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.hs<-cbind(ordrank.8.cp.hs,ds=david8.cp.hs$normDS)
lm8.cp.hs<-summary(lm(ordrank.8.cp.hs$ds~ordrank.8.cp.hs$ord.rank))
s8.cp.hs<-lm8.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.hs<-data.frame(X1=conflict.hs.cp[[25]],X2=conflict.hs.cp[[26]],Victories=conflict.hs.cp[[27]])
mat9.cp.hs<-inter.mat(mut9.cp.hs)
tri9.cp.hs<-tr.tri(mat9.cp.hs)
dci9.cp.hs<-DCindex(mat9.cp.hs)
mat9.cp.hs[is.na(mat9.cp.hs)] = 0
h9.cp.hs<-h.index(mat9.cp.hs)

ep9.cp.hs<-ep(mut9.cp.hs,a9.cp.hs)
david9.cp.hs<-DS(mat9.cp.hs) #David's Scores - for steepness use normDS output
ordrank.9.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.hs<-cbind(ordrank.9.cp.hs,ds=david9.cp.hs$normDS)
lm9.cp.hs<-summary(lm(ordrank.9.cp.hs$ds~ordrank.9.cp.hs$ord.rank))
s9.cp.hs<-lm9.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.hs<-data.frame(X1=conflict.hs.cp[[28]],X2=conflict.hs.cp[[29]],Victories=conflict.hs.cp[[30]])
mat10.cp.hs<-inter.mat(mut10.cp.hs)
tri10.cp.hs<-tr.tri(mat10.cp.hs)
dci10.cp.hs<-DCindex(mat10.cp.hs)
mat10.cp.hs[is.na(mat10.cp.hs)] = 0
h10.cp.hs<-h.index(mat10.cp.hs)

ep10.cp.hs<-ep(mut10.cp.hs,a10.cp.hs)
david10.cp.hs<-DS(mat10.cp.hs) #David's Scores - for steepness use normDS output
ordrank.10.cp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.hs<-cbind(ordrank.10.cp.hs,ds=david10.cp.hs$normDS)
lm10.cp.hs<-summary(lm(ordrank.10.cp.hs$ds~ordrank.10.cp.hs$ord.rank))
s10.cp.hs<-lm10.cp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.hs<-sum(mut1.cp.hs$Victories)
int2.cp.hs<-sum(mut2.cp.hs$Victories)
int3.cp.hs<-sum(mut3.cp.hs$Victories)
int4.cp.hs<-sum(mut4.cp.hs$Victories)
int5.cp.hs<-sum(mut5.cp.hs$Victories)
int6.cp.hs<-sum(mut6.cp.hs$Victories)
int7.cp.hs<-sum(mut7.cp.hs$Victories)
int8.cp.hs<-sum(mut8.cp.hs$Victories)
int9.cp.hs<-sum(mut9.cp.hs$Victories)
int10.cp.hs<-sum(mut10.cp.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.hs<-sum(a1.cp.hs$Victories)
av2.cp.hs<-sum(a2.cp.hs$Victories)
av3.cp.hs<-sum(a3.cp.hs$Victories)
av4.cp.hs<-sum(a4.cp.hs$Victories)
av5.cp.hs<-sum(a5.cp.hs$Victories)
av6.cp.hs<-sum(a6.cp.hs$Victories)
av7.cp.hs<-sum(a7.cp.hs$Victories)
av8.cp.hs<-sum(a8.cp.hs$Victories)
av9.cp.hs<-sum(a9.cp.hs$Victories)
av10.cp.hs<-sum(a10.cp.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.pc<-(sum(av1.cp.hs, av2.cp.hs, av3.cp.hs, av4.cp.hs, av5.cp.hs, av6.cp.hs, av7.cp.hs, av8.cp.hs, av9.cp.hs, av10.cp.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.pc<-(sum(int1.cp.hs, int2.cp.hs, int3.cp.hs, int4.cp.hs, int5.cp.hs, int6.cp.hs, int7.cp.hs, int8.cp.hs, int9.cp.hs, int10.cp.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.hs<-e1.cp.hs[order(e1.cp.hs$ID),]
e1.cp.hs<-as.matrix(t(e1.1.cp.hs))

e2.cp.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.hs<-e2.cp.hs[order(e2.cp.hs$ID),]
e2.cp.hs<-as.matrix(t(e2.1.cp.hs))

e3.cp.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.hs<-e3.cp.hs[order(e3.cp.hs$ID),]
e3.cp.hs<-as.matrix(t(e3.1.cp.hs))

e4.cp.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.hs<-e4.cp.hs[order(e4.cp.hs$ID),]
e4.cp.hs<-as.matrix(t(e4.1.cp.hs))

e5.cp.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.hs<-e5.cp.hs[order(e5.cp.hs$ID),]
e5.cp.hs<-as.matrix(t(e5.1.cp.hs))

e6.cp.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.hs<-e6.cp.hs[order(e6.cp.hs$ID),]
e6.cp.hs<-as.matrix(t(e6.1.cp.hs))

e7.cp.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.hs<-e7.cp.hs[order(e7.cp.hs$ID),]
e7.cp.hs<-as.matrix(t(e7.1.cp.hs))

e8.cp.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.hs<-e8.cp.hs[order(e8.cp.hs$ID),]
e8.cp.hs<-as.matrix(t(e8.1.cp.hs))

e9.cp.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.hs<-e9.cp.hs[order(e9.cp.hs$ID),]
e9.cp.hs<-as.matrix(t(e9.1.cp.hs))

e10.cp.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.hs<-e10.cp.hs[order(e10.cp.hs$ID),]
e10.cp.hs<-as.matrix(t(e10.1.cp.hs))

energy.hs.cp.hs<-as.data.frame(matrix(c(e1.cp.hs,e2.cp.hs,e3.cp.hs,e4.cp.hs,e5.cp.hs,e6.cp.hs,e7.cp.hs,e8.cp.hs,e9.cp.hs,e10.cp.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.cp.hs<-data.frame(ID=energy.hs.cp.hs$V1,energy_over_distance=energy.hs.cp.hs$V2,energy_over_time=energy.hs.cp.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.hs<-david1.cp.hs[order(david1.cp.hs$ID),]
david1.cp.hs<-as.matrix(t(david1.1.cp.hs))

david2.1.cp.hs<-david2.cp.hs[order(david2.cp.hs$ID),]
david2.cp.hs<-as.matrix(t(david2.1.cp.hs))

david3.1.cp.hs<-david3.cp.hs[order(david3.cp.hs$ID),]
david3.cp.hs<-as.matrix(t(david3.1.cp.hs))

david4.1.cp.hs<-david4.cp.hs[order(david4.cp.hs$ID),]
david4.cp.hs<-as.matrix(t(david4.1.cp.hs))

david5.1.cp.hs<-david5.cp.hs[order(david5.cp.hs$ID),]
david5.cp.hs<-as.matrix(t(david5.1.cp.hs))

david6.1.cp.hs<-david6.cp.hs[order(david6.cp.hs$ID),]
david6.cp.hs<-as.matrix(t(david6.1.cp.hs))

david7.1.cp.hs<-david7.cp.hs[order(david7.cp.hs$ID),]
david7.cp.hs<-as.matrix(t(david7.1.cp.hs))

david8.1.cp.hs<-david8.cp.hs[order(david8.cp.hs$ID),]
david8.cp.hs<-as.matrix(t(david8.1.cp.hs))

david9.1.cp.hs<-david9.cp.hs[order(david9.cp.hs$ID),]
david9.cp.hs<-as.matrix(t(david9.1.cp.hs))

david10.1.cp.hs<-david10.cp.hs[order(david10.cp.hs$ID),]
david10.cp.hs<-as.matrix(t(david10.1.cp.hs))

david.hs.cp.hs<-as.data.frame(matrix(c(david1.cp.hs,david2.cp.hs,david3.cp.hs,david4.cp.hs,david5.cp.hs,david6.cp.hs,david7.cp.hs,david8.cp.hs,david9.cp.hs,david10.cp.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.cp.hs<-data.frame(ID=david.hs.cp.hs$V1,DS=david.hs.cp.hs$V2,normDS=david.hs.cp.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.cp.hs<-lm(e1.1.cp.hs$energy_over_time~as.numeric(david1.1.cp.hs$normDS))
hs.lm.1.s.cp.hs<-summary(lm.hs.1.cp.hs)$coefficients
hs.1.slope.cp.hs<-hs.lm.1.s.cp.hs[2,1]
lm.hs.2.cp.hs<-lm(e2.1.cp.hs$energy_over_time~as.numeric(david2.1.cp.hs$normDS))
hs.lm.2.s.cp.hs<-summary(lm.hs.2.cp.hs)$coefficients
hs.2.slope.cp.hs<-hs.lm.2.s.cp.hs[2,1]
lm.hs.3.cp.hs<-lm(e3.1.cp.hs$energy_over_time~as.numeric(david3.1.cp.hs$normDS))
hs.lm.3.s.cp.hs<-summary(lm.hs.3.cp.hs)$coefficients
hs.3.slope.cp.hs<-hs.lm.3.s.cp.hs[2,1]
lm.hs.4.cp.hs<-lm(e4.1.cp.hs$energy_over_time~as.numeric(david4.1.cp.hs$normDS))
hs.lm.4.s.cp.hs<-summary(lm.hs.4.cp.hs)$coefficients
hs.4.slope.cp.hs<-hs.lm.4.s.cp.hs[2,1]
lm.hs.5.cp.hs<-lm(e5.1.cp.hs$energy_over_time~as.numeric(david5.1.cp.hs$normDS))
hs.lm.5.s.cp.hs<-summary(lm.hs.5.cp.hs)$coefficients
hs.5.slope.cp.hs<-hs.lm.5.s.cp.hs[2,1]
lm.hs.6.cp.hs<-lm(e6.1.cp.hs$energy_over_time~as.numeric(david6.1.cp.hs$normDS))
hs.lm.6.s.cp.hs<-summary(lm.hs.6.cp.hs)$coefficients
hs.6.slope.cp.hs<-hs.lm.6.s.cp.hs[2,1]
lm.hs.7.cp.hs<-lm(e7.1.cp.hs$energy_over_time~as.numeric(david7.1.cp.hs$normDS))
hs.lm.7.s.cp.hs<-summary(lm.hs.7.cp.hs)$coefficients
hs.7.slope.cp.hs<-hs.lm.7.s.cp.hs[2,1]
lm.hs.8.cp.hs<-lm(e8.1.cp.hs$energy_over_time~as.numeric(david8.1.cp.hs$normDS))
hs.lm.8.s.cp.hs<-summary(lm.hs.8.cp.hs)$coefficients
hs.8.slope.cp.hs<-hs.lm.8.s.cp.hs[2,1]
lm.hs.9.cp.hs<-lm(e9.1.cp.hs$energy_over_time~as.numeric(david9.1.cp.hs$normDS))
hs.lm.9.s.cp.hs<-summary(lm.hs.9.cp.hs)$coefficients
hs.9.slope.cp.hs<-hs.lm.9.s.cp.hs[2,1]
lm.hs.10.cp.hs<-lm(e10.1.cp.hs$energy_over_time~as.numeric(david10.1.cp.hs$normDS))
hs.lm.10.s.cp.hs<-summary(lm.hs.10.cp.hs)$coefficients
hs.10.slope.cp.hs<-hs.lm.10.s.cp.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.hs,tri2.cp.hs,tri3.cp.hs,tri4.cp.hs,tri5.cp.hs,tri6.cp.hs,tri7.cp.hs,tri8.cp.hs,tri9.cp.hs,tri10.cp.hs),escalation=c(ep1.cp.hs,ep2.cp.hs,ep3.cp.hs,ep4.cp.hs,ep5.cp.hs,ep6.cp.hs,ep7.cp.hs,ep8.cp.hs,ep9.cp.hs,ep10.cp.hs),dci=c(dci1.cp.hs,dci2.cp.hs,dci3.cp.hs,dci4.cp.hs,dci5.cp.hs,dci6.cp.hs,dci7.cp.hs,dci8.cp.hs,dci9.cp.hs,dci10.cp.hs),steepness=c(s1.cp.hs,s2.cp.hs,s3.cp.hs,s4.cp.hs,s5.cp.hs,s6.cp.hs,s7.cp.hs,s8.cp.hs,s9.cp.hs,s10.cp.hs),slope=c(hs.1.slope.cp.hs,hs.2.slope.cp.hs,hs.3.slope.cp.hs,hs.4.slope.cp.hs,hs.5.slope.cp.hs,hs.6.slope.cp.hs,hs.7.slope.cp.hs,hs.8.slope.cp.hs,hs.9.slope.cp.hs,hs.10.slope.cp.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the History Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ho<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.cp.ho<-data.frame(X1=avoid.cp.ho[[1]],X2=avoid.cp.ho[[2]],Avoids=avoid.cp.ho[[3]])
a2.cp.ho<-data.frame(X1=avoid.cp.ho[[4]],X2=avoid.cp.ho[[5]],Avoids=avoid.cp.ho[[6]])
a3.cp.ho<-data.frame(X1=avoid.cp.ho[[7]],X2=avoid.cp.ho[[8]],Avoids=avoid.cp.ho[[9]])
a4.cp.ho<-data.frame(X1=avoid.cp.ho[[10]],X2=avoid.cp.ho[[11]],Avoids=avoid.cp.ho[[12]])
a5.cp.ho<-data.frame(X1=avoid.cp.ho[[13]],X2=avoid.cp.ho[[14]],Avoids=avoid.cp.ho[[15]])
a6.cp.ho<-data.frame(X1=avoid.cp.ho[[16]],X2=avoid.cp.ho[[17]],Avoids=avoid.cp.ho[[18]])
a7.cp.ho<-data.frame(X1=avoid.cp.ho[[19]],X2=avoid.cp.ho[[20]],Avoids=avoid.cp.ho[[21]])
a8.cp.ho<-data.frame(X1=avoid.cp.ho[[22]],X2=avoid.cp.ho[[23]],Avoids=avoid.cp.ho[[24]])
a9.cp.ho<-data.frame(X1=avoid.cp.ho[[25]],X2=avoid.cp.ho[[26]],Avoids=avoid.cp.ho[[27]])
a10.cp.ho<-data.frame(X1=avoid.cp.ho[[28]],X2=avoid.cp.ho[[29]],Avoids=avoid.cp.ho[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ho.cp<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.cp.ho<-data.frame(X1=conflict.ho.cp[[1]],X2=conflict.ho.cp[[2]],Victories=conflict.ho.cp[[3]])
mat1.cp.ho<-inter.mat(mut1.cp.ho)
tri1.cp.ho<-tr.tri(mat1.cp.ho)
dci1.cp.ho<-DCindex(mat1.cp.ho)
mat1.cp.ho[is.na(mat1.cp.ho)] = 0
h1.cp.ho<-h.index(mat1.cp.ho)

ep1.cp.ho<-ep(mut1.cp.ho,a1.cp.ho)
david1.cp.ho<-DS(mat1.cp.ho) #David's Scores - for steepness use normDS output
ordrank.1.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.cp.ho<-cbind(ordrank.1.cp.ho,ds=david1.cp.ho$normDS)
lm1.cp.ho<-summary(lm(ordrank.1.cp.ho$ds~ordrank.1.cp.ho$ord.rank))
s1.cp.ho<-lm1.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.cp.ho<-data.frame(X1=conflict.ho.cp[[4]],X2=conflict.ho.cp[[5]],Victories=conflict.ho.cp[[6]])
mat2.cp.ho<-inter.mat(mut2.cp.ho)
tri2.cp.ho<-tr.tri(mat2.cp.ho)
dci2.cp.ho<-DCindex(mat2.cp.ho)
mat2.cp.ho[is.na(mat2.cp.ho)] = 0
h2.cp.ho<-h.index(mat2.cp.ho)

ep2.cp.ho<-ep(mut2.cp.ho,a2.cp.ho)
david2.cp.ho<-DS(mat2.cp.ho) #David's Scores - for steepness use normDS output
ordrank.2.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.cp.ho<-cbind(ordrank.2.cp.ho,ds=david2.cp.ho$normDS)
lm2.cp.ho<-summary(lm(ordrank.2.cp.ho$ds~ordrank.2.cp.ho$ord.rank))
s2.cp.ho<-lm2.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.cp.ho<-data.frame(X1=conflict.ho.cp[[7]],X2=conflict.ho.cp[[8]],Victories=conflict.ho.cp[[9]])
mat3.cp.ho<-inter.mat(mut3.cp.ho)
tri3.cp.ho<-tr.tri(mat3.cp.ho)
dci3.cp.ho<-DCindex(mat3.cp.ho)
mat3.cp.ho[is.na(mat3.cp.ho)] = 0
h3.cp.ho<-h.index(mat3.cp.ho)

ep3.cp.ho<-ep(mut3.cp.ho,a3.cp.ho)
david3.cp.ho<-DS(mat3.cp.ho) #David's Scores - for steepness use normDS output
ordrank.3.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.cp.ho<-cbind(ordrank.3.cp.ho,ds=david3.cp.ho$normDS)
lm3.cp.ho<-summary(lm(ordrank.3.cp.ho$ds~ordrank.3.cp.ho$ord.rank))
s3.cp.ho<-lm3.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.cp.ho<-data.frame(X1=conflict.ho.cp[[10]],X2=conflict.ho.cp[[11]],Victories=conflict.ho.cp[[12]])
mat4.cp.ho<-inter.mat(mut4.cp.ho)
tri4.cp.ho<-tr.tri(mat4.cp.ho)
dci4.cp.ho<-DCindex(mat4.cp.ho)
mat4.cp.ho[is.na(mat4.cp.ho)] = 0
h4.cp.ho<-h.index(mat4.cp.ho)

ep4.cp.ho<-ep(mut4.cp.ho,a4.cp.ho)
david4.cp.ho<-DS(mat4.cp.ho) #David's Scores - for steepness use normDS output
ordrank.4.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.cp.ho<-cbind(ordrank.4.cp.ho,ds=david4.cp.ho$normDS)
lm4.cp.ho<-summary(lm(ordrank.4.cp.ho$ds~ordrank.4.cp.ho$ord.rank))
s4.cp.ho<-lm4.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.cp.ho<-data.frame(X1=conflict.ho.cp[[13]],X2=conflict.ho.cp[[14]],Victories=conflict.ho.cp[[15]])
mat5.cp.ho<-inter.mat(mut5.cp.ho)
tri5.cp.ho<-tr.tri(mat5.cp.ho)
dci5.cp.ho<-DCindex(mat5.cp.ho)
mat5.cp.ho[is.na(mat5.cp.ho)] = 0
h5.cp.ho<-h.index(mat5.cp.ho)

ep5.cp.ho<-ep(mut5.cp.ho,a5.cp.ho)
david5.cp.ho<-DS(mat5.cp.ho) #David's Scores - for steepness use normDS output
ordrank.5.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.cp.ho<-cbind(ordrank.5.cp.ho,ds=david5.cp.ho$normDS)
lm5.cp.ho<-summary(lm(ordrank.5.cp.ho$ds~ordrank.5.cp.ho$ord.rank))
s5.cp.ho<-lm5.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.cp.ho<-data.frame(X1=conflict.ho.cp[[16]],X2=conflict.ho.cp[[17]],Victories=conflict.ho.cp[[18]])
mat6.cp.ho<-inter.mat(mut6.cp.ho)
tri6.cp.ho<-tr.tri(mat6.cp.ho)
dci6.cp.ho<-DCindex(mat6.cp.ho)
mat6.cp.ho[is.na(mat6.cp.ho)] = 0
h6.cp.ho<-h.index(mat6.cp.ho)

ep6.cp.ho<-ep(mut6.cp.ho,a6.cp.ho)
david6.cp.ho<-DS(mat6.cp.ho) #David's Scores - for steepness use normDS output
ordrank.6.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.cp.ho<-cbind(ordrank.6.cp.ho,ds=david6.cp.ho$normDS)
lm6.cp.ho<-summary(lm(ordrank.6.cp.ho$ds~ordrank.6.cp.ho$ord.rank))
s6.cp.ho<-lm6.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.cp.ho<-data.frame(X1=conflict.ho.cp[[19]],X2=conflict.ho.cp[[20]],Victories=conflict.ho.cp[[21]])
mat7.cp.ho<-inter.mat(mut7.cp.ho)
tri7.cp.ho<-tr.tri(mat7.cp.ho)
dci7.cp.ho<-DCindex(mat7.cp.ho)
mat7.cp.ho[is.na(mat7.cp.ho)] = 0
h7.cp.ho<-h.index(mat7.cp.ho)

ep7.cp.ho<-ep(mut7.cp.ho,a7.cp.ho)
david7.cp.ho<-DS(mat7.cp.ho) #David's Scores - for steepness use normDS output
ordrank.7.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.cp.ho<-cbind(ordrank.7.cp.ho,ds=david7.cp.ho$normDS)
lm7.cp.ho<-summary(lm(ordrank.7.cp.ho$ds~ordrank.7.cp.ho$ord.rank))
s7.cp.ho<-lm7.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.cp.ho<-data.frame(X1=conflict.ho.cp[[22]],X2=conflict.ho.cp[[23]],Victories=conflict.ho.cp[[24]])
mat8.cp.ho<-inter.mat(mut8.cp.ho)
tri8.cp.ho<-tr.tri(mat8.cp.ho)
dci8.cp.ho<-DCindex(mat8.cp.ho)
mat8.cp.ho[is.na(mat8.cp.ho)] = 0
h8.cp.ho<-h.index(mat8.cp.ho)

ep8.cp.ho<-ep(mut8.cp.ho,a8.cp.ho)
david8.cp.ho<-DS(mat8.cp.ho) #David's Scores - for steepness use normDS output
ordrank.8.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.cp.ho<-cbind(ordrank.8.cp.ho,ds=david8.cp.ho$normDS)
lm8.cp.ho<-summary(lm(ordrank.8.cp.ho$ds~ordrank.8.cp.ho$ord.rank))
s8.cp.ho<-lm8.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.cp.ho<-data.frame(X1=conflict.ho.cp[[25]],X2=conflict.ho.cp[[26]],Victories=conflict.ho.cp[[27]])
mat9.cp.ho<-inter.mat(mut9.cp.ho)
tri9.cp.ho<-tr.tri(mat9.cp.ho)
dci9.cp.ho<-DCindex(mat9.cp.ho)
mat9.cp.ho[is.na(mat9.cp.ho)] = 0
h9.cp.ho<-h.index(mat9.cp.ho)

ep9.cp.ho<-ep(mut9.cp.ho,a9.cp.ho)
david9.cp.ho<-DS(mat9.cp.ho) #David's Scores - for steepness use normDS output
ordrank.9.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.cp.ho<-cbind(ordrank.9.cp.ho,ds=david9.cp.ho$normDS)
lm9.cp.ho<-summary(lm(ordrank.9.cp.ho$ds~ordrank.9.cp.ho$ord.rank))
s9.cp.ho<-lm9.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.cp.ho<-data.frame(X1=conflict.ho.cp[[28]],X2=conflict.ho.cp[[29]],Victories=conflict.ho.cp[[30]])
mat10.cp.ho<-inter.mat(mut10.cp.ho)
tri10.cp.ho<-tr.tri(mat10.cp.ho)
dci10.cp.ho<-DCindex(mat10.cp.ho)
mat10.cp.ho[is.na(mat10.cp.ho)] = 0
h10.cp.ho<-h.index(mat10.cp.ho)

ep10.cp.ho<-ep(mut10.cp.ho,a10.cp.ho)
david10.cp.ho<-DS(mat10.cp.ho) #David's Scores - for steepness use normDS output
ordrank.10.cp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.cp.ho<-cbind(ordrank.10.cp.ho,ds=david10.cp.ho$normDS)
lm10.cp.ho<-summary(lm(ordrank.10.cp.ho$ds~ordrank.10.cp.ho$ord.rank))
s10.cp.ho<-lm10.cp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.cp.ho<-sum(mut1.cp.ho$Victories)
int2.cp.ho<-sum(mut2.cp.ho$Victories)
int3.cp.ho<-sum(mut3.cp.ho$Victories)
int4.cp.ho<-sum(mut4.cp.ho$Victories)
int5.cp.ho<-sum(mut5.cp.ho$Victories)
int6.cp.ho<-sum(mut6.cp.ho$Victories)
int7.cp.ho<-sum(mut7.cp.ho$Victories)
int8.cp.ho<-sum(mut8.cp.ho$Victories)
int9.cp.ho<-sum(mut9.cp.ho$Victories)
int10.cp.ho<-sum(mut10.cp.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ho<-sum(a1.cp.ho$Victories)
av2.cp.ho<-sum(a2.cp.ho$Victories)
av3.cp.ho<-sum(a3.cp.ho$Victories)
av4.cp.ho<-sum(a4.cp.ho$Victories)
av5.cp.ho<-sum(a5.cp.ho$Victories)
av6.cp.ho<-sum(a6.cp.ho$Victories)
av7.cp.ho<-sum(a7.cp.ho$Victories)
av8.cp.ho<-sum(a8.cp.ho$Victories)
av9.cp.ho<-sum(a9.cp.ho$Victories)
av10.cp.ho<-sum(a10.cp.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.pc<-(sum(av1.cp.ho, av2.cp.ho, av3.cp.ho, av4.cp.ho, av5.cp.ho, av6.cp.ho, av7.cp.ho, av8.cp.ho, av9.cp.ho, av10.cp.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.pc<-(sum(int1.cp.ho, int2.cp.ho, int3.cp.ho, int4.cp.ho, int5.cp.ho, int6.cp.ho, int7.cp.ho, int8.cp.ho, int9.cp.ho, int10.cp.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.cp.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.cp.ho<-e1.cp.ho[order(e1.cp.ho$ID),]
e1.cp.ho<-as.matrix(t(e1.1.cp.ho))

e2.cp.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.cp.ho<-e2.cp.ho[order(e2.cp.ho$ID),]
e2.cp.ho<-as.matrix(t(e2.1.cp.ho))

e3.cp.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.cp.ho<-e3.cp.ho[order(e3.cp.ho$ID),]
e3.cp.ho<-as.matrix(t(e3.1.cp.ho))

e4.cp.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.cp.ho<-e4.cp.ho[order(e4.cp.ho$ID),]
e4.cp.ho<-as.matrix(t(e4.1.cp.ho))

e5.cp.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.cp.ho<-e5.cp.ho[order(e5.cp.ho$ID),]
e5.cp.ho<-as.matrix(t(e5.1.cp.ho))

e6.cp.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.cp.ho<-e6.cp.ho[order(e6.cp.ho$ID),]
e6.cp.ho<-as.matrix(t(e6.1.cp.ho))

e7.cp.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.cp.ho<-e7.cp.ho[order(e7.cp.ho$ID),]
e7.cp.ho<-as.matrix(t(e7.1.cp.ho))

e8.cp.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.cp.ho<-e8.cp.ho[order(e8.cp.ho$ID),]
e8.cp.ho<-as.matrix(t(e8.1.cp.ho))

e9.cp.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.cp.ho<-e9.cp.ho[order(e9.cp.ho$ID),]
e9.cp.ho<-as.matrix(t(e9.1.cp.ho))

e10.cp.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.cp.ho<-e10.cp.ho[order(e10.cp.ho$ID),]
e10.cp.ho<-as.matrix(t(e10.1.cp.ho))

energy.ho.cp.ho<-as.data.frame(matrix(c(e1.cp.ho,e2.cp.ho,e3.cp.ho,e4.cp.ho,e5.cp.ho,e6.cp.ho,e7.cp.ho,e8.cp.ho,e9.cp.ho,e10.cp.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.cp.ho<-data.frame(ID=energy.ho.cp.ho$V1,energy_over_distance=energy.ho.cp.ho$V2,energy_over_time=energy.ho.cp.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.cp.ho<-david1.cp.ho[order(david1.cp.ho$ID),]
david1.cp.ho<-as.matrix(t(david1.1.cp.ho))

david2.1.cp.ho<-david2.cp.ho[order(david2.cp.ho$ID),]
david2.cp.ho<-as.matrix(t(david2.1.cp.ho))

david3.1.cp.ho<-david3.cp.ho[order(david3.cp.ho$ID),]
david3.cp.ho<-as.matrix(t(david3.1.cp.ho))

david4.1.cp.ho<-david4.cp.ho[order(david4.cp.ho$ID),]
david4.cp.ho<-as.matrix(t(david4.1.cp.ho))

david5.1.cp.ho<-david5.cp.ho[order(david5.cp.ho$ID),]
david5.cp.ho<-as.matrix(t(david5.1.cp.ho))

david6.1.cp.ho<-david6.cp.ho[order(david6.cp.ho$ID),]
david6.cp.ho<-as.matrix(t(david6.1.cp.ho))

david7.1.cp.ho<-david7.cp.ho[order(david7.cp.ho$ID),]
david7.cp.ho<-as.matrix(t(david7.1.cp.ho))

david8.1.cp.ho<-david8.cp.ho[order(david8.cp.ho$ID),]
david8.cp.ho<-as.matrix(t(david8.1.cp.ho))

david9.1.cp.ho<-david9.cp.ho[order(david9.cp.ho$ID),]
david9.cp.ho<-as.matrix(t(david9.1.cp.ho))

david10.1.cp.ho<-david10.cp.ho[order(david10.cp.ho$ID),]
david10.cp.ho<-as.matrix(t(david10.1.cp.ho))

david.ho.cp.ho<-as.data.frame(matrix(c(david1.cp.ho,david2.cp.ho,david3.cp.ho,david4.cp.ho,david5.cp.ho,david6.cp.ho,david7.cp.ho,david8.cp.ho,david9.cp.ho,david10.cp.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.cp.ho<-data.frame(ID=david.ho.cp.ho$V1,DS=david.ho.cp.ho$V2,normDS=david.ho.cp.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.cp.ho<-lm(e1.1.cp.ho$energy_over_time~as.numeric(david1.1.cp.ho$normDS))
ho.lm.1.s.cp.ho<-summary(lm.ho.1.cp.ho)$coefficients
ho.1.slope.cp.ho<-ho.lm.1.s.cp.ho[2,1]
lm.ho.2.cp.ho<-lm(e2.1.cp.ho$energy_over_time~as.numeric(david2.1.cp.ho$normDS))
ho.lm.2.s.cp.ho<-summary(lm.ho.2.cp.ho)$coefficients
ho.2.slope.cp.ho<-ho.lm.2.s.cp.ho[2,1]
lm.ho.3.cp.ho<-lm(e3.1.cp.ho$energy_over_time~as.numeric(david3.1.cp.ho$normDS))
ho.lm.3.s.cp.ho<-summary(lm.ho.3.cp.ho)$coefficients
ho.3.slope.cp.ho<-ho.lm.3.s.cp.ho[2,1]
lm.ho.4.cp.ho<-lm(e4.1.cp.ho$energy_over_time~as.numeric(david4.1.cp.ho$normDS))
ho.lm.4.s.cp.ho<-summary(lm.ho.4.cp.ho)$coefficients
ho.4.slope.cp.ho<-ho.lm.4.s.cp.ho[2,1]
lm.ho.5.cp.ho<-lm(e5.1.cp.ho$energy_over_time~as.numeric(david5.1.cp.ho$normDS))
ho.lm.5.s.cp.ho<-summary(lm.ho.5.cp.ho)$coefficients
ho.5.slope.cp.ho<-ho.lm.5.s.cp.ho[2,1]
lm.ho.6.cp.ho<-lm(e6.1.cp.ho$energy_over_time~as.numeric(david6.1.cp.ho$normDS))
ho.lm.6.s.cp.ho<-summary(lm.ho.6.cp.ho)$coefficients
ho.6.slope.cp.ho<-ho.lm.6.s.cp.ho[2,1]
lm.ho.7.cp.ho<-lm(e7.1.cp.ho$energy_over_time~as.numeric(david7.1.cp.ho$normDS))
ho.lm.7.s.cp.ho<-summary(lm.ho.7.cp.ho)$coefficients
ho.7.slope.cp.ho<-ho.lm.7.s.cp.ho[2,1]
lm.ho.8.cp.ho<-lm(e8.1.cp.ho$energy_over_time~as.numeric(david8.1.cp.ho$normDS))
ho.lm.8.s.cp.ho<-summary(lm.ho.8.cp.ho)$coefficients
ho.8.slope.cp.ho<-ho.lm.8.s.cp.ho[2,1]
lm.ho.9.cp.ho<-lm(e9.1.cp.ho$energy_over_time~as.numeric(david9.1.cp.ho$normDS))
ho.lm.9.s.cp.ho<-summary(lm.ho.9.cp.ho)$coefficients
ho.9.slope.cp.ho<-ho.lm.9.s.cp.ho[2,1]
lm.ho.10.cp.ho<-lm(e10.1.cp.ho$energy_over_time~as.numeric(david10.1.cp.ho$normDS))
ho.lm.10.s.cp.ho<-summary(lm.ho.10.cp.ho)$coefficients
ho.10.slope.cp.ho<-ho.lm.10.s.cp.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.cp.ss<-data.frame(triangle.transitivity=c(tri1.cp.ho,tri2.cp.ho,tri3.cp.ho,tri4.cp.ho,tri5.cp.ho,tri6.cp.ho,tri7.cp.ho,tri8.cp.ho,tri9.cp.ho,tri10.cp.ho),escalation=c(ep1.cp.ho,ep2.cp.ho,ep3.cp.ho,ep4.cp.ho,ep5.cp.ho,ep6.cp.ho,ep7.cp.ho,ep8.cp.ho,ep9.cp.ho,ep10.cp.ho),dci=c(dci1.cp.ho,dci2.cp.ho,dci3.cp.ho,dci4.cp.ho,dci5.cp.ho,dci6.cp.ho,dci7.cp.ho,dci8.cp.ho,dci9.cp.ho,dci10.cp.ho),steepness=c(s1.cp.ho,s2.cp.ho,s3.cp.ho,s4.cp.ho,s5.cp.ho,s6.cp.ho,s7.cp.ho,s8.cp.ho,s9.cp.ho,s10.cp.ho),slope=c(ho.1.slope.cp.ho,ho.2.slope.cp.ho,ho.3.slope.cp.ho,ho.4.slope.cp.ho,ho.5.slope.cp.ho,ho.6.slope.cp.ho,ho.7.slope.cp.ho,ho.8.slope.cp.ho,ho.9.slope.cp.ho,ho.10.slope.cp.ho))

#Overall linear models of each scenario
km.lm.pc<-lm((energy.km.df.cp.km$energy_over_time)~as.numeric(david.km.df.cp.km$normDS)) #knowledge mutual linear model
ks.lm.pc<-lm((energy.ks.df.cp.ks$energy_over_time)~as.numeric(david.ks.df.cp.ks$normDS)) #knowledge self linear model
ko.lm.pc<-lm((energy.ko.df.cp.ko$energy_over_time)~as.numeric(david.ko.df.cp.ko$normDS)) #knowledge opp linear model
hm.lm.pc<-lm((energy.hm.df.cp.hm$energy_over_time)~as.numeric(david.hm.df.cp.hm$normDS)) #history mutual linear model
hs.lm.pc<-lm((energy.hs.df.cp.hs$energy_over_time)~as.numeric(david.hs.df.cp.hs$normDS)) #history self linear model
ho.lm.pc<-lm((energy.ho.df.cp.ho$energy_over_time)~as.numeric(david.ho.df.cp.ho$normDS)) #history opp linear model
```
```{r Clumped Probabilistic Data Frame}
# Generate energy data frame:
total.energy.pc<-data.frame(energy.km.df.cp.km)
total.energy.pc<-rbind(total.energy.pc,energy.ks.df.cp.ks,energy.ko.df.cp.ko,energy.hm.df.cp.hm,energy.hs.df.cp.hs,energy.ho.df.cp.ho)

total.david.pc<-data.frame(david.km.df.cp.km)
total.david.pc<-rbind(total.david.pc,david.ks.df.cp.ks,david.ko.df.cp.ko,david.hm.df.cp.hm,david.hs.df.cp.hs,david.ho.df.cp.ho)

total.energy.pc<-cbind(total.energy.pc,normDS=total.david.pc$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.pc<-mean(km.cp.ss$triangle.transitivity)
  km.dci.pc<-mean(km.cp.ss$dci)
  km.esc.pc<-mean(km.cp.ss$escalation)
  km.steep.pc<-mean(km.cp.ss$steepness)
  km.slope.pc<-mean(km.cp.ss$slope)
  km.mean.pc<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.pc,dci=km.dci.pc,esc=km.esc.pc,steepness=km.steep.pc,slope=km.slope.pc,dist="clumped",calc="Probabilistic")

  # knowledge self
  ks.tt.pc<-mean(ks.cp.ss$triangle.transitivity)
  ks.dci.pc<-mean(ks.cp.ss$dci)
  ks.esc.pc<-mean(ks.cp.ss$escalation)
  ks.steep.pc<-mean(ks.cp.ss$steepness)
  ks.slope.pc<-mean(ks.cp.ss$slope)
  ks.mean.pc<-data.frame(scenario="Knowledge self",tt=ks.tt.pc,dci=ks.dci.pc,esc=ks.esc.pc,steepness=ks.steep.pc,slope=ks.slope.pc,dist="clumped",calc="Probabilistic")

  # knowledge opponent
  ko.tt.pc<-mean(ko.cp.ss$triangle.transitivity)
  ko.dci.pc<-mean(ko.cp.ss$dci)
  ko.esc.pc<-mean(ko.cp.ss$escalation)
  ko.steep.pc<-mean(ko.cp.ss$steepness)
  ko.slope.pc<-mean(ko.cp.ss$slope)
  ko.mean.pc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc,dci=ko.dci.pc,esc=ko.esc.pc,steepness=ko.steep.pc,slope=ko.slope.pc,dist="clumped",calc="Probabilistic")

  # history mutual
  hm.tt.pc<-mean(hm.cp.ss$triangle.transitivity)
  hm.dci.pc<-mean(hm.cp.ss$dci)
  hm.esc.pc<-mean(hm.cp.ss$escalation)
  hm.steep.pc<-mean(hm.cp.ss$steepness)
  hm.slope.pc<-mean(hm.cp.ss$slope)
  hm.mean.pc<-data.frame(scenario="History Mutual",tt=hm.tt.pc,dci=hm.dci.pc,esc=hm.esc.pc,steepness=hm.steep.pc,slope=hm.slope.pc,dist="clumped",calc="Probabilistic")

  # history self
  hs.tt.pc<-mean(hs.cp.ss$triangle.transitivity)
  hs.dci.pc<-mean(hs.cp.ss$dci)
  hs.esc.pc<-mean(hs.cp.ss$escalation)
  hs.steep.pc<-mean(hs.cp.ss$steepness)
  hs.slope.pc<-mean(hs.cp.ss$slope)
  hs.mean.pc<-data.frame(scenario="History self",tt=hs.tt.pc,dci=hs.dci.pc,esc=hs.esc.pc,steepness=hs.steep.pc,slope=hs.slope.pc,dist="clumped",calc="Probabilistic")

  # history opponent
  ho.tt.pc<-mean(ho.cp.ss$triangle.transitivity)
  ho.dci.pc<-mean(ho.cp.ss$dci)
  ho.esc.pc<-mean(ho.cp.ss$escalation)
  ho.steep.pc<-mean(ho.cp.ss$steepness)
  ho.slope.pc<-mean(ho.cp.ss$slope)
  ho.mean.pc<-data.frame(scenario="History opponent",tt=ho.tt.pc,dci=ho.dci.pc,esc=ho.esc.pc,steepness=ho.steep.pc,slope=ho.slope.pc,dist="clumped",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.pc,ks.mean.pc,ko.mean.pc,hm.mean.pc,hs.mean.pc,ho.mean.pc)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.pc<-mean(km.cp.ss$triangle.transitivity)
  km.dci.pc<-mean(km.cp.ss$dci)
  km.esc.pc<-mean(km.cp.ss$escalation)
  km.steep.pc<-mean(km.cp.ss$steepness)
  km.slope.pc<-mean(km.cp.ss$slope)
  km.mean.pc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc,dci=km.dci.pc,esc=km.esc.pc,steepness=km.steep.pc,slope=km.slope.pc,dist="clumped",calc="Probabilistic")
  
  #knowledge self
  ks.tt.pc<-mean(ks.cp.ss$triangle.transitivity)
  ks.dci.pc<-mean(ks.cp.ss$dci)
  ks.esc.pc<-mean(ks.cp.ss$escalation)
  ks.steep.pc<-mean(ks.cp.ss$steepness)
  ks.slope.pc<-mean(ks.cp.ss$slope)
  ks.mean.pc<-data.frame(scenario="Knowledge self",tt=ks.tt.pc,dci=ks.dci.pc,esc=ks.esc.pc,steepness=ks.steep.pc,slope=ks.slope.pc,dist="clumped",calc="Probabilistic")
  
  #knowledge opponent
  ko.tt.pc<-mean(ko.cp.ss$triangle.transitivity)
  ko.dci.pc<-mean(ko.cp.ss$dci)
  ko.esc.pc<-mean(ko.cp.ss$escalation)
  ko.steep.pc<-mean(ko.cp.ss$steepness)
  ko.slope.pc<-mean(ko.cp.ss$slope)
  ko.mean.pc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc,dci=ko.dci.pc,esc=ko.esc.pc,steepness=ko.steep.pc,slope=ko.slope.pc,dist="clumped",calc="Probabilistic")
  
  #history mutual
  hm.tt.pc<-mean(hm.cp.ss$triangle.transitivity)
  hm.dci.pc<-mean(hm.cp.ss$dci)
  hm.esc.pc<-mean(hm.cp.ss$escalation)
  hm.steep.pc<-mean(hm.cp.ss$steepness)
  hm.slope.pc<-mean(hm.cp.ss$slope)
  hm.mean.pc<-data.frame(scenario="History Mutual",tt=hm.tt.pc,dci=hm.dci.pc,esc=hm.esc.pc,steepness=hm.steep.pc,slope=hm.slope.pc,dist="clumped",calc="Probabilistic")
  
  #history self
  hs.tt.pc<-mean(hs.cp.ss$triangle.transitivity)
  hs.dci.pc<-mean(hs.cp.ss$dci)
  hs.esc.pc<-mean(hs.cp.ss$escalation)
  hs.steep.pc<-mean(hs.cp.ss$steepness)
  hs.slope.pc<-mean(hs.cp.ss$slope)
  hs.mean.pc<-data.frame(scenario="History self",tt=hs.tt.pc,dci=hs.dci.pc,esc=hs.esc.pc,steepness=hs.steep.pc,slope=hs.slope.pc,dist="clumped",calc="Probabilistic")
  
  #history opponent
  ho.tt.pc<-mean(ho.cp.ss$triangle.transitivity)
  ho.dci.pc<-mean(ho.cp.ss$dci)
  ho.esc.pc<-mean(ho.cp.ss$escalation)
  ho.steep.pc<-mean(ho.cp.ss$steepness)
  ho.slope.pc<-mean(ho.cp.ss$slope)
  ho.mean.pc<-data.frame(scenario="History opponent",tt=ho.tt.pc,dci=ho.dci.pc,esc=ho.esc.pc,steepness=ho.steep.pc,slope=ho.slope.pc,dist="clumped",calc="Probabilistic")

# Generate data frame for all averages:
dc.ave<-rbind(km.mean.pc,ks.mean.pc,ko.mean.pc,hm.mean.pc,hs.mean.pc,ho.mean.pc)

# Create overall dataframe of summary statistics:
overall.clump.prob<-data.frame(km.cp.ss)
overall.clump.prob<-rbind(overall.clump.prob,ks.cp.ss)
overall.clump.prob<-rbind(overall.clump.prob,ko.cp.ss)
overall.clump.prob<-rbind(overall.clump.prob,hm.cp.ss)
overall.clump.prob<-rbind(overall.clump.prob,hs.cp.ss)
overall.clump.prob<-rbind(overall.clump.prob,ho.cp.ss)

overall.clump.prob<-cbind(overall.clump.prob,variable=c(rep("rhp",30),rep("history",30)))
overall.clump.prob<-cbind(overall.clump.prob,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.cp.ss<-overall.clump.prob[overall.clump.prob$variable=="rhp",]
history.cp.ss<-overall.clump.prob[overall.clump.prob$variable=="history",]

overall.clump.prob$combo<-paste(overall.clump.prob$strategy,overall.clump.prob$variable,overall.clump.prob$distribution)
overall.clump.prob$combo2<-paste(overall.clump.prob$strategy,overall.clump.prob$variable) #final dataframe for Probabilistic clumped data
```

## Avoids Clumped Probabilistic Data
```{r Avoids Clumped Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.km<-sapply(files, read.csv)

# Generate avoid.cp.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.acp.km<-data.frame(X1=avoid.cp.km[[1]],X2=avoid.cp.km[[2]],Avoids=avoid.cp.km[[3]])
mat1.acp.km<-avoid.inter.mat(mut1.acp.km)
tri1.acp.km<-tr.tri(mat1.acp.km)
dci1.acp.km<-DCindex(mat1.acp.km)
mat1.acp.km[is.na(mat1.acp.km)] = 0
h1.acp.km<-h.index(mat1.acp.km)

ep1.acp.km<-ep(mut1.acp.km,a1.cp.km)
david1.acp.km<-DS(mat1.acp.km) #David's Scores - for steepness use normDS output
ordrank.1.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.km<-cbind(ordrank.1.acp.km,ds=david1.acp.km$normDS)
lm1.acp.km<-summary(lm(ordrank.1.acp.km$ds~ordrank.1.acp.km$ord.rank))
s1.acp.km<-lm1.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.km<-data.frame(X1=avoid.cp.km[[4]],X2=avoid.cp.km[[5]],Avoids=avoid.cp.km[[6]])
mat2.acp.km<-avoid.inter.mat(mut2.acp.km)
tri2.acp.km<-tr.tri(mat2.acp.km)
dci2.acp.km<-DCindex(mat2.acp.km)
mat2.acp.km[is.na(mat2.acp.km)] = 0
h2.acp.km<-h.index(mat2.acp.km)

ep2.acp.km<-ep(mut2.acp.km,a2.cp.km)
david2.acp.km<-DS(mat2.acp.km) #David's Scores - for steepness use normDS output
ordrank.2.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.km<-cbind(ordrank.2.acp.km,ds=david2.acp.km$normDS)
lm2.acp.km<-summary(lm(ordrank.2.acp.km$ds~ordrank.2.acp.km$ord.rank))
s2.acp.km<-lm2.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.km<-data.frame(X1=avoid.cp.km[[7]],X2=avoid.cp.km[[8]],Avoids=avoid.cp.km[[9]])
mat3.acp.km<-avoid.inter.mat(mut3.acp.km)
tri3.acp.km<-tr.tri(mat3.acp.km)
dci3.acp.km<-DCindex(mat3.acp.km)
mat3.acp.km[is.na(mat3.acp.km)] = 0
h3.acp.km<-h.index(mat3.acp.km)

ep3.acp.km<-ep(mut3.acp.km,a3.cp.km)
david3.acp.km<-DS(mat3.acp.km) #David's Scores - for steepness use normDS output
ordrank.3.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.km<-cbind(ordrank.3.acp.km,ds=david3.acp.km$normDS)
lm3.acp.km<-summary(lm(ordrank.3.acp.km$ds~ordrank.3.acp.km$ord.rank))
s3.acp.km<-lm3.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.km<-data.frame(X1=avoid.cp.km[[10]],X2=avoid.cp.km[[11]],Avoids=avoid.cp.km[[12]])
mat4.acp.km<-avoid.inter.mat(mut4.acp.km)
tri4.acp.km<-tr.tri(mat4.acp.km)
dci4.acp.km<-DCindex(mat4.acp.km)
mat4.acp.km[is.na(mat4.acp.km)] = 0
h4.acp.km<-h.index(mat4.acp.km)

ep4.acp.km<-ep(mut4.acp.km,a4.cp.km)
david4.acp.km<-DS(mat4.acp.km) #David's Scores - for steepness use normDS output
ordrank.4.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.km<-cbind(ordrank.4.acp.km,ds=david4.acp.km$normDS)
lm4.acp.km<-summary(lm(ordrank.4.acp.km$ds~ordrank.4.acp.km$ord.rank))
s4.acp.km<-lm4.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.km<-data.frame(X1=avoid.cp.km[[13]],X2=avoid.cp.km[[14]],Avoids=avoid.cp.km[[15]])
mat5.acp.km<-avoid.inter.mat(mut5.acp.km)
tri5.acp.km<-tr.tri(mat5.acp.km)
dci5.acp.km<-DCindex(mat5.acp.km)
mat5.acp.km[is.na(mat5.acp.km)] = 0
h5.acp.km<-h.index(mat5.acp.km)

ep5.acp.km<-ep(mut5.acp.km,a5.cp.km)
david5.acp.km<-DS(mat5.acp.km) #David's Scores - for steepness use normDS output
ordrank.5.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.km<-cbind(ordrank.5.acp.km,ds=david5.acp.km$normDS)
lm5.acp.km<-summary(lm(ordrank.5.acp.km$ds~ordrank.5.acp.km$ord.rank))
s5.acp.km<-lm5.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.km<-data.frame(X1=avoid.cp.km[[16]],X2=avoid.cp.km[[17]],Avoids=avoid.cp.km[[18]])
mat6.acp.km<-avoid.inter.mat(mut6.acp.km)
tri6.acp.km<-tr.tri(mat6.acp.km)
dci6.acp.km<-DCindex(mat6.acp.km)
mat6.acp.km[is.na(mat6.acp.km)] = 0
h6.acp.km<-h.index(mat6.acp.km)

ep6.acp.km<-ep(mut6.acp.km,a6.cp.km)
david6.acp.km<-DS(mat6.acp.km) #David's Scores - for steepness use normDS output
ordrank.6.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.km<-cbind(ordrank.6.acp.km,ds=david6.acp.km$normDS)
lm6.acp.km<-summary(lm(ordrank.6.acp.km$ds~ordrank.6.acp.km$ord.rank))
s6.acp.km<-lm6.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.km<-data.frame(X1=avoid.cp.km[[19]],X2=avoid.cp.km[[20]],Avoids=avoid.cp.km[[21]])
mat7.acp.km<-avoid.inter.mat(mut7.acp.km)
tri7.acp.km<-tr.tri(mat7.acp.km)
dci7.acp.km<-DCindex(mat7.acp.km)
mat7.acp.km[is.na(mat7.acp.km)] = 0
h7.acp.km<-h.index(mat7.acp.km)

ep7.acp.km<-ep(mut7.acp.km,a7.cp.km)
david7.acp.km<-DS(mat7.acp.km) #David's Scores - for steepness use normDS output
ordrank.7.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.km<-cbind(ordrank.7.acp.km,ds=david7.acp.km$normDS)
lm7.acp.km<-summary(lm(ordrank.7.acp.km$ds~ordrank.7.acp.km$ord.rank))
s7.acp.km<-lm7.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.km<-data.frame(X1=avoid.cp.km[[22]],X2=avoid.cp.km[[23]],Avoids=avoid.cp.km[[24]])
mat8.acp.km<-avoid.inter.mat(mut8.acp.km)
tri8.acp.km<-tr.tri(mat8.acp.km)
dci8.acp.km<-DCindex(mat8.acp.km)
mat8.acp.km[is.na(mat8.acp.km)] = 0
h8.acp.km<-h.index(mat8.acp.km)

ep8.acp.km<-ep(mut8.acp.km,a8.cp.km)
david8.acp.km<-DS(mat8.acp.km) #David's Scores - for steepness use normDS output
ordrank.8.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.km<-cbind(ordrank.8.acp.km,ds=david8.acp.km$normDS)
lm8.acp.km<-summary(lm(ordrank.8.acp.km$ds~ordrank.8.acp.km$ord.rank))
s8.acp.km<-lm8.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.km<-data.frame(X1=avoid.cp.km[[25]],X2=avoid.cp.km[[26]],Avoids=avoid.cp.km[[27]])
mat9.acp.km<-avoid.inter.mat(mut9.acp.km)
tri9.acp.km<-tr.tri(mat9.acp.km)
dci9.acp.km<-DCindex(mat9.acp.km)
mat9.acp.km[is.na(mat9.acp.km)] = 0
h9.acp.km<-h.index(mat9.acp.km)

ep9.acp.km<-ep(mut9.acp.km,a9.cp.km)
david9.acp.km<-DS(mat9.acp.km) #David's Scores - for steepness use normDS output
ordrank.9.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.km<-cbind(ordrank.9.acp.km,ds=david9.acp.km$normDS)
lm9.acp.km<-summary(lm(ordrank.9.acp.km$ds~ordrank.9.acp.km$ord.rank))
s9.acp.km<-lm9.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.km<-data.frame(X1=avoid.cp.km[[28]],X2=avoid.cp.km[[29]],Avoids=avoid.cp.km[[30]])
mat10.acp.km<-avoid.inter.mat(mut10.acp.km)
tri10.acp.km<-tr.tri(mat10.acp.km)
dci10.acp.km<-DCindex(mat10.acp.km)
mat10.acp.km[is.na(mat10.acp.km)] = 0
h10.acp.km<-h.index(mat10.acp.km)

ep10.acp.km<-ep(mut10.acp.km,a10.cp.km)
david10.acp.km<-DS(mat10.acp.km) #David's Scores - for steepness use normDS output
ordrank.10.acp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.km<-cbind(ordrank.10.acp.km,ds=david10.acp.km$normDS)
lm10.acp.km<-summary(lm(ordrank.10.acp.km$ds~ordrank.10.acp.km$ord.rank))
s10.acp.km<-lm10.acp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.km<-sum(mut1.acp.km$Victories)
int2.acp.km<-sum(mut2.acp.km$Victories)
int3.acp.km<-sum(mut3.acp.km$Victories)
int4.acp.km<-sum(mut4.acp.km$Victories)
int5.acp.km<-sum(mut5.acp.km$Victories)
int6.acp.km<-sum(mut6.acp.km$Victories)
int7.acp.km<-sum(mut7.acp.km$Victories)
int8.acp.km<-sum(mut8.acp.km$Victories)
int9.acp.km<-sum(mut9.acp.km$Victories)
int10.acp.km<-sum(mut10.acp.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.km<-sum(a1.cp.km$Victories)
av2.acp.km<-sum(a2.cp.km$Victories)
av3.acp.km<-sum(a3.cp.km$Victories)
av4.acp.km<-sum(a4.cp.km$Victories)
av5.acp.km<-sum(a5.cp.km$Victories)
av6.acp.km<-sum(a6.cp.km$Victories)
av7.acp.km<-sum(a7.cp.km$Victories)
av8.acp.km<-sum(a8.cp.km$Victories)
av9.acp.km<-sum(a9.cp.km$Victories)
av10.acp.km<-sum(a10.cp.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.acp<-(sum(av1.acp.km, av2.acp.km, av3.acp.km, av4.acp.km, av5.acp.km, av6.acp.km, av7.acp.km, av8.acp.km, av9.acp.km, av10.acp.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.acp<-(sum(int1.acp.km, int2.acp.km, int3.acp.km, int4.acp.km, int5.acp.km, int6.acp.km, int7.acp.km, int8.acp.km, int9.acp.km, int10.acp.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.km<-e1.acp.km[order(e1.acp.km$ID),]
e1.acp.km<-as.matrix(t(e1.1.acp.km))

e2.acp.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.km<-e2.acp.km[order(e2.acp.km$ID),]
e2.acp.km<-as.matrix(t(e2.1.acp.km))

e3.acp.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.km<-e3.acp.km[order(e3.acp.km$ID),]
e3.acp.km<-as.matrix(t(e3.1.acp.km))

e4.acp.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.km<-e4.acp.km[order(e4.acp.km$ID),]
e4.acp.km<-as.matrix(t(e4.1.acp.km))

e5.acp.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.km<-e5.acp.km[order(e5.acp.km$ID),]
e5.acp.km<-as.matrix(t(e5.1.acp.km))

e6.acp.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.km<-e6.acp.km[order(e6.acp.km$ID),]
e6.acp.km<-as.matrix(t(e6.1.acp.km))

e7.acp.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.km<-e7.acp.km[order(e7.acp.km$ID),]
e7.acp.km<-as.matrix(t(e7.1.acp.km))

e8.acp.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.km<-e8.acp.km[order(e8.acp.km$ID),]
e8.acp.km<-as.matrix(t(e8.1.acp.km))

e9.acp.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.km<-e9.acp.km[order(e9.acp.km$ID),]
e9.acp.km<-as.matrix(t(e9.1.acp.km))

e10.acp.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.km<-e10.acp.km[order(e10.acp.km$ID),]
e10.acp.km<-as.matrix(t(e10.1.acp.km))

energy.km.acp.km<-as.data.frame(matrix(c(e1.acp.km,e2.acp.km,e3.acp.km,e4.acp.km,e5.acp.km,e6.acp.km,e7.acp.km,e8.acp.km,e9.acp.km,e10.acp.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.acp.km<-data.frame(ID=energy.km.acp.km$V1,energy_over_distance=energy.km.acp.km$V2,energy_over_time=energy.km.acp.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.km<-david1.acp.km[order(david1.acp.km$ID),]
david1.acp.km<-as.matrix(t(david1.1.acp.km))

david2.1.acp.km<-david2.acp.km[order(david2.acp.km$ID),]
david2.acp.km<-as.matrix(t(david2.1.acp.km))

david3.1.acp.km<-david3.acp.km[order(david3.acp.km$ID),]
david3.acp.km<-as.matrix(t(david3.1.acp.km))

david4.1.acp.km<-david4.acp.km[order(david4.acp.km$ID),]
david4.acp.km<-as.matrix(t(david4.1.acp.km))

david5.1.acp.km<-david5.acp.km[order(david5.acp.km$ID),]
david5.acp.km<-as.matrix(t(david5.1.acp.km))

david6.1.acp.km<-david6.acp.km[order(david6.acp.km$ID),]
david6.acp.km<-as.matrix(t(david6.1.acp.km))

david7.1.acp.km<-david7.acp.km[order(david7.acp.km$ID),]
david7.acp.km<-as.matrix(t(david7.1.acp.km))

david8.1.acp.km<-david8.acp.km[order(david8.acp.km$ID),]
david8.acp.km<-as.matrix(t(david8.1.acp.km))

david9.1.acp.km<-david9.acp.km[order(david9.acp.km$ID),]
david9.acp.km<-as.matrix(t(david9.1.acp.km))

david10.1.acp.km<-david10.acp.km[order(david10.acp.km$ID),]
david10.acp.km<-as.matrix(t(david10.1.acp.km))

david.km.acp.km<-as.data.frame(matrix(c(david1.acp.km,david2.acp.km,david3.acp.km,david4.acp.km,david5.acp.km,david6.acp.km,david7.acp.km,david8.acp.km,david9.acp.km,david10.acp.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.acp.km<-data.frame(ID=david.km.acp.km$V1,DS=david.km.acp.km$V2,normDS=david.km.acp.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.acp.km<-lm(e1.1.acp.km$energy_over_time~as.numeric(david1.1.acp.km$normDS))
km.lm.1.s.acp.km<-summary(lm.km.1.acp.km)$coefficients
km.1.slope.acp.km<-km.lm.1.s.acp.km[2,1]
lm.km.2.acp.km<-lm(e2.1.acp.km$energy_over_time~as.numeric(david2.1.acp.km$normDS))
km.lm.2.s.acp.km<-summary(lm.km.2.acp.km)$coefficients
km.2.slope.acp.km<-km.lm.2.s.acp.km[2,1]
lm.km.3.acp.km<-lm(e3.1.acp.km$energy_over_time~as.numeric(david3.1.acp.km$normDS))
km.lm.3.s.acp.km<-summary(lm.km.3.acp.km)$coefficients
km.3.slope.acp.km<-km.lm.3.s.acp.km[2,1]
lm.km.4.acp.km<-lm(e4.1.acp.km$energy_over_time~as.numeric(david4.1.acp.km$normDS))
km.lm.4.s.acp.km<-summary(lm.km.4.acp.km)$coefficients
km.4.slope.acp.km<-km.lm.4.s.acp.km[2,1]
lm.km.5.acp.km<-lm(e5.1.acp.km$energy_over_time~as.numeric(david5.1.acp.km$normDS))
km.lm.5.s.acp.km<-summary(lm.km.5.acp.km)$coefficients
km.5.slope.acp.km<-km.lm.5.s.acp.km[2,1]
lm.km.6.acp.km<-lm(e6.1.acp.km$energy_over_time~as.numeric(david6.1.acp.km$normDS))
km.lm.6.s.acp.km<-summary(lm.km.6.acp.km)$coefficients
km.6.slope.acp.km<-km.lm.6.s.acp.km[2,1]
lm.km.7.acp.km<-lm(e7.1.acp.km$energy_over_time~as.numeric(david7.1.acp.km$normDS))
km.lm.7.s.acp.km<-summary(lm.km.7.acp.km)$coefficients
km.7.slope.acp.km<-km.lm.7.s.acp.km[2,1]
lm.km.8.acp.km<-lm(e8.1.acp.km$energy_over_time~as.numeric(david8.1.acp.km$normDS))
km.lm.8.s.acp.km<-summary(lm.km.8.acp.km)$coefficients
km.8.slope.acp.km<-km.lm.8.s.acp.km[2,1]
lm.km.9.acp.km<-lm(e9.1.acp.km$energy_over_time~as.numeric(david9.1.acp.km$normDS))
km.lm.9.s.acp.km<-summary(lm.km.9.acp.km)$coefficients
km.9.slope.acp.km<-km.lm.9.s.acp.km[2,1]
lm.km.10.acp.km<-lm(e10.1.acp.km$energy_over_time~as.numeric(david10.1.acp.km$normDS))
km.lm.10.s.acp.km<-summary(lm.km.10.acp.km)$coefficients
km.10.slope.acp.km<-km.lm.10.s.acp.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.acp.ss.avoid.cp.km<-data.frame(triangle.transitivity=c(tri1.acp.km,tri2.acp.km,tri3.acp.km,tri4.acp.km,tri5.acp.km,tri6.acp.km,tri7.acp.km,tri8.acp.km,tri9.acp.km,tri10.acp.km),escalation=c(ep1.acp.km,ep2.acp.km,ep3.acp.km,ep4.acp.km,ep5.acp.km,ep6.acp.km,ep7.acp.km,ep8.acp.km,ep9.acp.km,ep10.acp.km),dci=c(dci1.acp.km,dci2.acp.km,dci3.acp.km,dci4.acp.km,dci5.acp.km,dci6.acp.km,dci7.acp.km,dci8.acp.km,dci9.acp.km,dci10.acp.km),steepness=c(s1.acp.km,s2.acp.km,s3.acp.km,s4.acp.km,s5.acp.km,s6.acp.km,s7.acp.km,s8.acp.km,s9.acp.km,s10.acp.km),slope=c(km.1.slope.acp.km,km.2.slope.acp.km,km.3.slope.acp.km,km.4.slope.acp.km,km.5.slope.acp.km,km.6.slope.acp.km,km.7.slope.acp.km,km.8.slope.acp.km,km.9.slope.acp.km,km.10.slope.acp.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ks<-sapply(files, read.csv)

# Generate avoid.cp.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.ks<-data.frame(X1=avoid.cp.ks[[1]],X2=avoid.cp.ks[[2]],Avoids=avoid.cp.ks[[3]])
mat1.acp.ks<-avoid.inter.mat(mut1.acp.ks)
tri1.acp.ks<-tr.tri(mat1.acp.ks)
dci1.acp.ks<-DCindex(mat1.acp.ks)
mat1.acp.ks[is.na(mat1.acp.ks)] = 0
h1.acp.ks<-h.index(mat1.acp.ks)

ep1.acp.ks<-ep(mut1.acp.ks,a1.cp.ks)
david1.acp.ks<-DS(mat1.acp.ks) #David's Scores - for steepness use normDS output
ordrank.1.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.ks<-cbind(ordrank.1.acp.ks,ds=david1.acp.ks$normDS)
lm1.acp.ks<-summary(lm(ordrank.1.acp.ks$ds~ordrank.1.acp.ks$ord.rank))
s1.acp.ks<-lm1.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.ks<-data.frame(X1=avoid.cp.ks[[4]],X2=avoid.cp.ks[[5]],Avoids=avoid.cp.ks[[6]])
mat2.acp.ks<-avoid.inter.mat(mut2.acp.ks)
tri2.acp.ks<-tr.tri(mat2.acp.ks)
dci2.acp.ks<-DCindex(mat2.acp.ks)
mat2.acp.ks[is.na(mat2.acp.ks)] = 0
h2.acp.ks<-h.index(mat2.acp.ks)

ep2.acp.ks<-ep(mut2.acp.ks,a2.cp.ks)
david2.acp.ks<-DS(mat2.acp.ks) #David's Scores - for steepness use normDS output
ordrank.2.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.ks<-cbind(ordrank.2.acp.ks,ds=david2.acp.ks$normDS)
lm2.acp.ks<-summary(lm(ordrank.2.acp.ks$ds~ordrank.2.acp.ks$ord.rank))
s2.acp.ks<-lm2.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.ks<-data.frame(X1=avoid.cp.ks[[7]],X2=avoid.cp.ks[[8]],Avoids=avoid.cp.ks[[9]])
mat3.acp.ks<-avoid.inter.mat(mut3.acp.ks)
tri3.acp.ks<-tr.tri(mat3.acp.ks)
dci3.acp.ks<-DCindex(mat3.acp.ks)
mat3.acp.ks[is.na(mat3.acp.ks)] = 0
h3.acp.ks<-h.index(mat3.acp.ks)

ep3.acp.ks<-ep(mut3.acp.ks,a3.cp.ks)
david3.acp.ks<-DS(mat3.acp.ks) #David's Scores - for steepness use normDS output
ordrank.3.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.ks<-cbind(ordrank.3.acp.ks,ds=david3.acp.ks$normDS)
lm3.acp.ks<-summary(lm(ordrank.3.acp.ks$ds~ordrank.3.acp.ks$ord.rank))
s3.acp.ks<-lm3.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.ks<-data.frame(X1=avoid.cp.ks[[10]],X2=avoid.cp.ks[[11]],Avoids=avoid.cp.ks[[12]])
mat4.acp.ks<-avoid.inter.mat(mut4.acp.ks)
tri4.acp.ks<-tr.tri(mat4.acp.ks)
dci4.acp.ks<-DCindex(mat4.acp.ks)
mat4.acp.ks[is.na(mat4.acp.ks)] = 0
h4.acp.ks<-h.index(mat4.acp.ks)

ep4.acp.ks<-ep(mut4.acp.ks,a4.cp.ks)
david4.acp.ks<-DS(mat4.acp.ks) #David's Scores - for steepness use normDS output
ordrank.4.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.ks<-cbind(ordrank.4.acp.ks,ds=david4.acp.ks$normDS)
lm4.acp.ks<-summary(lm(ordrank.4.acp.ks$ds~ordrank.4.acp.ks$ord.rank))
s4.acp.ks<-lm4.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.ks<-data.frame(X1=avoid.cp.ks[[13]],X2=avoid.cp.ks[[14]],Avoids=avoid.cp.ks[[15]])
mat5.acp.ks<-avoid.inter.mat(mut5.acp.ks)
tri5.acp.ks<-tr.tri(mat5.acp.ks)
dci5.acp.ks<-DCindex(mat5.acp.ks)
mat5.acp.ks[is.na(mat5.acp.ks)] = 0
h5.acp.ks<-h.index(mat5.acp.ks)

ep5.acp.ks<-ep(mut5.acp.ks,a5.cp.ks)
david5.acp.ks<-DS(mat5.acp.ks) #David's Scores - for steepness use normDS output
ordrank.5.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.ks<-cbind(ordrank.5.acp.ks,ds=david5.acp.ks$normDS)
lm5.acp.ks<-summary(lm(ordrank.5.acp.ks$ds~ordrank.5.acp.ks$ord.rank))
s5.acp.ks<-lm5.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.ks<-data.frame(X1=avoid.cp.ks[[16]],X2=avoid.cp.ks[[17]],Avoids=avoid.cp.ks[[18]])
mat6.acp.ks<-avoid.inter.mat(mut6.acp.ks)
tri6.acp.ks<-tr.tri(mat6.acp.ks)
dci6.acp.ks<-DCindex(mat6.acp.ks)
mat6.acp.ks[is.na(mat6.acp.ks)] = 0
h6.acp.ks<-h.index(mat6.acp.ks)

ep6.acp.ks<-ep(mut6.acp.ks,a6.cp.ks)
david6.acp.ks<-DS(mat6.acp.ks) #David's Scores - for steepness use normDS output
ordrank.6.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.ks<-cbind(ordrank.6.acp.ks,ds=david6.acp.ks$normDS)
lm6.acp.ks<-summary(lm(ordrank.6.acp.ks$ds~ordrank.6.acp.ks$ord.rank))
s6.acp.ks<-lm6.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.ks<-data.frame(X1=avoid.cp.ks[[19]],X2=avoid.cp.ks[[20]],Avoids=avoid.cp.ks[[21]])
mat7.acp.ks<-avoid.inter.mat(mut7.acp.ks)
tri7.acp.ks<-tr.tri(mat7.acp.ks)
dci7.acp.ks<-DCindex(mat7.acp.ks)
mat7.acp.ks[is.na(mat7.acp.ks)] = 0
h7.acp.ks<-h.index(mat7.acp.ks)

ep7.acp.ks<-ep(mut7.acp.ks,a7.cp.ks)
david7.acp.ks<-DS(mat7.acp.ks) #David's Scores - for steepness use normDS output
ordrank.7.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.ks<-cbind(ordrank.7.acp.ks,ds=david7.acp.ks$normDS)
lm7.acp.ks<-summary(lm(ordrank.7.acp.ks$ds~ordrank.7.acp.ks$ord.rank))
s7.acp.ks<-lm7.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.ks<-data.frame(X1=avoid.cp.ks[[22]],X2=avoid.cp.ks[[23]],Avoids=avoid.cp.ks[[24]])
mat8.acp.ks<-avoid.inter.mat(mut8.acp.ks)
tri8.acp.ks<-tr.tri(mat8.acp.ks)
dci8.acp.ks<-DCindex(mat8.acp.ks)
mat8.acp.ks[is.na(mat8.acp.ks)] = 0
h8.acp.ks<-h.index(mat8.acp.ks)

ep8.acp.ks<-ep(mut8.acp.ks,a8.cp.ks)
david8.acp.ks<-DS(mat8.acp.ks) #David's Scores - for steepness use normDS output
ordrank.8.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.ks<-cbind(ordrank.8.acp.ks,ds=david8.acp.ks$normDS)
lm8.acp.ks<-summary(lm(ordrank.8.acp.ks$ds~ordrank.8.acp.ks$ord.rank))
s8.acp.ks<-lm8.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.ks<-data.frame(X1=avoid.cp.ks[[25]],X2=avoid.cp.ks[[26]],Avoids=avoid.cp.ks[[27]])
mat9.acp.ks<-avoid.inter.mat(mut9.acp.ks)
tri9.acp.ks<-tr.tri(mat9.acp.ks)
dci9.acp.ks<-DCindex(mat9.acp.ks)
mat9.acp.ks[is.na(mat9.acp.ks)] = 0
h9.acp.ks<-h.index(mat9.acp.ks)

ep9.acp.ks<-ep(mut9.acp.ks,a9.cp.ks)
david9.acp.ks<-DS(mat9.acp.ks) #David's Scores - for steepness use normDS output
ordrank.9.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.ks<-cbind(ordrank.9.acp.ks,ds=david9.acp.ks$normDS)
lm9.acp.ks<-summary(lm(ordrank.9.acp.ks$ds~ordrank.9.acp.ks$ord.rank))
s9.acp.ks<-lm9.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.ks<-data.frame(X1=avoid.cp.ks[[28]],X2=avoid.cp.ks[[29]],Avoids=avoid.cp.ks[[30]])
mat10.acp.ks<-avoid.inter.mat(mut10.acp.ks)
tri10.acp.ks<-tr.tri(mat10.acp.ks)
dci10.acp.ks<-DCindex(mat10.acp.ks)
mat10.acp.ks[is.na(mat10.acp.ks)] = 0
h10.acp.ks<-h.index(mat10.acp.ks)

ep10.acp.ks<-ep(mut10.acp.ks,a10.cp.ks)
david10.acp.ks<-DS(mat10.acp.ks) #David's Scores - for steepness use normDS output
ordrank.10.acp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.ks<-cbind(ordrank.10.acp.ks,ds=david10.acp.ks$normDS)
lm10.acp.ks<-summary(lm(ordrank.10.acp.ks$ds~ordrank.10.acp.ks$ord.rank))
s10.acp.ks<-lm10.acp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.ks<-sum(mut1.acp.ks$Victories)
int2.acp.ks<-sum(mut2.acp.ks$Victories)
int3.acp.ks<-sum(mut3.acp.ks$Victories)
int4.acp.ks<-sum(mut4.acp.ks$Victories)
int5.acp.ks<-sum(mut5.acp.ks$Victories)
int6.acp.ks<-sum(mut6.acp.ks$Victories)
int7.acp.ks<-sum(mut7.acp.ks$Victories)
int8.acp.ks<-sum(mut8.acp.ks$Victories)
int9.acp.ks<-sum(mut9.acp.ks$Victories)
int10.acp.ks<-sum(mut10.acp.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.ks<-sum(a1.cp.ks$Victories)
av2.acp.ks<-sum(a2.cp.ks$Victories)
av3.acp.ks<-sum(a3.cp.ks$Victories)
av4.acp.ks<-sum(a4.cp.ks$Victories)
av5.acp.ks<-sum(a5.cp.ks$Victories)
av6.acp.ks<-sum(a6.cp.ks$Victories)
av7.acp.ks<-sum(a7.cp.ks$Victories)
av8.acp.ks<-sum(a8.cp.ks$Victories)
av9.acp.ks<-sum(a9.cp.ks$Victories)
av10.acp.ks<-sum(a10.cp.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.acp<-(sum(av1.acp.ks, av2.acp.ks, av3.acp.ks, av4.acp.ks, av5.acp.ks, av6.acp.ks, av7.acp.ks, av8.acp.ks, av9.acp.ks, av10.acp.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.acp<-(sum(int1.acp.ks, int2.acp.ks, int3.acp.ks, int4.acp.ks, int5.acp.ks, int6.acp.ks, int7.acp.ks, int8.acp.ks, int9.acp.ks, int10.acp.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.ks<-e1.acp.ks[order(e1.acp.ks$ID),]
e1.acp.ks<-as.matrix(t(e1.1.acp.ks))

e2.acp.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.ks<-e2.acp.ks[order(e2.acp.ks$ID),]
e2.acp.ks<-as.matrix(t(e2.1.acp.ks))

e3.acp.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.ks<-e3.acp.ks[order(e3.acp.ks$ID),]
e3.acp.ks<-as.matrix(t(e3.1.acp.ks))

e4.acp.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.ks<-e4.acp.ks[order(e4.acp.ks$ID),]
e4.acp.ks<-as.matrix(t(e4.1.acp.ks))

e5.acp.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.ks<-e5.acp.ks[order(e5.acp.ks$ID),]
e5.acp.ks<-as.matrix(t(e5.1.acp.ks))

e6.acp.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.ks<-e6.acp.ks[order(e6.acp.ks$ID),]
e6.acp.ks<-as.matrix(t(e6.1.acp.ks))

e7.acp.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.ks<-e7.acp.ks[order(e7.acp.ks$ID),]
e7.acp.ks<-as.matrix(t(e7.1.acp.ks))

e8.acp.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.ks<-e8.acp.ks[order(e8.acp.ks$ID),]
e8.acp.ks<-as.matrix(t(e8.1.acp.ks))

e9.acp.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.ks<-e9.acp.ks[order(e9.acp.ks$ID),]
e9.acp.ks<-as.matrix(t(e9.1.acp.ks))

e10.acp.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.ks<-e10.acp.ks[order(e10.acp.ks$ID),]
e10.acp.ks<-as.matrix(t(e10.1.acp.ks))

energy.ks.acp.ks<-as.data.frame(matrix(c(e1.acp.ks,e2.acp.ks,e3.acp.ks,e4.acp.ks,e5.acp.ks,e6.acp.ks,e7.acp.ks,e8.acp.ks,e9.acp.ks,e10.acp.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.acp.ks<-data.frame(ID=energy.ks.acp.ks$V1,energy_over_distance=energy.ks.acp.ks$V2,energy_over_time=energy.ks.acp.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.ks<-david1.acp.ks[order(david1.acp.ks$ID),]
david1.acp.ks<-as.matrix(t(david1.1.acp.ks))

david2.1.acp.ks<-david2.acp.ks[order(david2.acp.ks$ID),]
david2.acp.ks<-as.matrix(t(david2.1.acp.ks))

david3.1.acp.ks<-david3.acp.ks[order(david3.acp.ks$ID),]
david3.acp.ks<-as.matrix(t(david3.1.acp.ks))

david4.1.acp.ks<-david4.acp.ks[order(david4.acp.ks$ID),]
david4.acp.ks<-as.matrix(t(david4.1.acp.ks))

david5.1.acp.ks<-david5.acp.ks[order(david5.acp.ks$ID),]
david5.acp.ks<-as.matrix(t(david5.1.acp.ks))

david6.1.acp.ks<-david6.acp.ks[order(david6.acp.ks$ID),]
david6.acp.ks<-as.matrix(t(david6.1.acp.ks))

david7.1.acp.ks<-david7.acp.ks[order(david7.acp.ks$ID),]
david7.acp.ks<-as.matrix(t(david7.1.acp.ks))

david8.1.acp.ks<-david8.acp.ks[order(david8.acp.ks$ID),]
david8.acp.ks<-as.matrix(t(david8.1.acp.ks))

david9.1.acp.ks<-david9.acp.ks[order(david9.acp.ks$ID),]
david9.acp.ks<-as.matrix(t(david9.1.acp.ks))

david10.1.acp.ks<-david10.acp.ks[order(david10.acp.ks$ID),]
david10.acp.ks<-as.matrix(t(david10.1.acp.ks))

david.ks.acp.ks<-as.data.frame(matrix(c(david1.acp.ks,david2.acp.ks,david3.acp.ks,david4.acp.ks,david5.acp.ks,david6.acp.ks,david7.acp.ks,david8.acp.ks,david9.acp.ks,david10.acp.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.acp.ks<-data.frame(ID=david.ks.acp.ks$V1,DS=david.ks.acp.ks$V2,normDS=david.ks.acp.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.acp.ks<-lm(e1.1.acp.ks$energy_over_time~as.numeric(david1.1.acp.ks$normDS))
ks.lm.1.s.acp.ks<-summary(lm.ks.1.acp.ks)$coefficients
ks.1.slope.acp.ks<-ks.lm.1.s.acp.ks[2,1]
lm.ks.2.acp.ks<-lm(e2.1.acp.ks$energy_over_time~as.numeric(david2.1.acp.ks$normDS))
ks.lm.2.s.acp.ks<-summary(lm.ks.2.acp.ks)$coefficients
ks.2.slope.acp.ks<-ks.lm.2.s.acp.ks[2,1]
lm.ks.3.acp.ks<-lm(e3.1.acp.ks$energy_over_time~as.numeric(david3.1.acp.ks$normDS))
ks.lm.3.s.acp.ks<-summary(lm.ks.3.acp.ks)$coefficients
ks.3.slope.acp.ks<-ks.lm.3.s.acp.ks[2,1]
lm.ks.4.acp.ks<-lm(e4.1.acp.ks$energy_over_time~as.numeric(david4.1.acp.ks$normDS))
ks.lm.4.s.acp.ks<-summary(lm.ks.4.acp.ks)$coefficients
ks.4.slope.acp.ks<-ks.lm.4.s.acp.ks[2,1]
lm.ks.5.acp.ks<-lm(e5.1.acp.ks$energy_over_time~as.numeric(david5.1.acp.ks$normDS))
ks.lm.5.s.acp.ks<-summary(lm.ks.5.acp.ks)$coefficients
ks.5.slope.acp.ks<-ks.lm.5.s.acp.ks[2,1]
lm.ks.6.acp.ks<-lm(e6.1.acp.ks$energy_over_time~as.numeric(david6.1.acp.ks$normDS))
ks.lm.6.s.acp.ks<-summary(lm.ks.6.acp.ks)$coefficients
ks.6.slope.acp.ks<-ks.lm.6.s.acp.ks[2,1]
lm.ks.7.acp.ks<-lm(e7.1.acp.ks$energy_over_time~as.numeric(david7.1.acp.ks$normDS))
ks.lm.7.s.acp.ks<-summary(lm.ks.7.acp.ks)$coefficients
ks.7.slope.acp.ks<-ks.lm.7.s.acp.ks[2,1]
lm.ks.8.acp.ks<-lm(e8.1.acp.ks$energy_over_time~as.numeric(david8.1.acp.ks$normDS))
ks.lm.8.s.acp.ks<-summary(lm.ks.8.acp.ks)$coefficients
ks.8.slope.acp.ks<-ks.lm.8.s.acp.ks[2,1]
lm.ks.9.acp.ks<-lm(e9.1.acp.ks$energy_over_time~as.numeric(david9.1.acp.ks$normDS))
ks.lm.9.s.acp.ks<-summary(lm.ks.9.acp.ks)$coefficients
ks.9.slope.acp.ks<-ks.lm.9.s.acp.ks[2,1]
lm.ks.10.acp.ks<-lm(e10.1.acp.ks$energy_over_time~as.numeric(david10.1.acp.ks$normDS))
ks.lm.10.s.acp.ks<-summary(lm.ks.10.acp.ks)$coefficients
ks.10.slope.acp.ks<-ks.lm.10.s.acp.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.acp.ss.avoid.cp.ks<-data.frame(triangle.transitivity=c(tri1.acp.ks,tri2.acp.ks,tri3.acp.ks,tri4.acp.ks,tri5.acp.ks,tri6.acp.ks,tri7.acp.ks,tri8.acp.ks,tri9.acp.ks,tri10.acp.ks),escalation=c(ep1.acp.ks,ep2.acp.ks,ep3.acp.ks,ep4.acp.ks,ep5.acp.ks,ep6.acp.ks,ep7.acp.ks,ep8.acp.ks,ep9.acp.ks,ep10.acp.ks),dci=c(dci1.acp.ks,dci2.acp.ks,dci3.acp.ks,dci4.acp.ks,dci5.acp.ks,dci6.acp.ks,dci7.acp.ks,dci8.acp.ks,dci9.acp.ks,dci10.acp.ks),steepness=c(s1.acp.ks,s2.acp.ks,s3.acp.ks,s4.acp.ks,s5.acp.ks,s6.acp.ks,s7.acp.ks,s8.acp.ks,s9.acp.ks,s10.acp.ks),slope=c(ks.1.slope.acp.ks,ks.2.slope.acp.ks,ks.3.slope.acp.ks,ks.4.slope.acp.ks,ks.5.slope.acp.ks,ks.6.slope.acp.ks,ks.7.slope.acp.ks,ks.8.slope.acp.ks,ks.9.slope.acp.ks,ks.10.slope.acp.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Clump

# Data organization for the Knowledge Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ko<-sapply(files, read.csv)

# Generate avoid.cp.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.ko<-data.frame(X1=avoid.cp.ko[[1]],X2=avoid.cp.ko[[2]],Avoids=avoid.cp.ko[[3]])
mat1.acp.ko<-avoid.inter.mat(mut1.acp.ko)
tri1.acp.ko<-tr.tri(mat1.acp.ko)
dci1.acp.ko<-DCindex(mat1.acp.ko)
mat1.acp.ko[is.na(mat1.acp.ko)] = 0
h1.acp.ko<-h.index(mat1.acp.ko)

ep1.acp.ko<-ep(mut1.acp.ko,a1.cp.ko)
david1.acp.ko<-DS(mat1.acp.ko) #David's Scores - for steepness use normDS output
ordrank.1.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.ko<-cbind(ordrank.1.acp.ko,ds=david1.acp.ko$normDS)
lm1.acp.ko<-summary(lm(ordrank.1.acp.ko$ds~ordrank.1.acp.ko$ord.rank))
s1.acp.ko<-lm1.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.ko<-data.frame(X1=avoid.cp.ko[[4]],X2=avoid.cp.ko[[5]],Avoids=avoid.cp.ko[[6]])
mat2.acp.ko<-avoid.inter.mat(mut2.acp.ko)
tri2.acp.ko<-tr.tri(mat2.acp.ko)
dci2.acp.ko<-DCindex(mat2.acp.ko)
mat2.acp.ko[is.na(mat2.acp.ko)] = 0
h2.acp.ko<-h.index(mat2.acp.ko)

ep2.acp.ko<-ep(mut2.acp.ko,a2.cp.ko)
david2.acp.ko<-DS(mat2.acp.ko) #David's Scores - for steepness use normDS output
ordrank.2.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.ko<-cbind(ordrank.2.acp.ko,ds=david2.acp.ko$normDS)
lm2.acp.ko<-summary(lm(ordrank.2.acp.ko$ds~ordrank.2.acp.ko$ord.rank))
s2.acp.ko<-lm2.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.ko<-data.frame(X1=avoid.cp.ko[[7]],X2=avoid.cp.ko[[8]],Avoids=avoid.cp.ko[[9]])
mat3.acp.ko<-avoid.inter.mat(mut3.acp.ko)
tri3.acp.ko<-tr.tri(mat3.acp.ko)
dci3.acp.ko<-DCindex(mat3.acp.ko)
mat3.acp.ko[is.na(mat3.acp.ko)] = 0
h3.acp.ko<-h.index(mat3.acp.ko)

ep3.acp.ko<-ep(mut3.acp.ko,a3.cp.ko)
david3.acp.ko<-DS(mat3.acp.ko) #David's Scores - for steepness use normDS output
ordrank.3.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.ko<-cbind(ordrank.3.acp.ko,ds=david3.acp.ko$normDS)
lm3.acp.ko<-summary(lm(ordrank.3.acp.ko$ds~ordrank.3.acp.ko$ord.rank))
s3.acp.ko<-lm3.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.ko<-data.frame(X1=avoid.cp.ko[[10]],X2=avoid.cp.ko[[11]],Avoids=avoid.cp.ko[[12]])
mat4.acp.ko<-avoid.inter.mat(mut4.acp.ko)
tri4.acp.ko<-tr.tri(mat4.acp.ko)
dci4.acp.ko<-DCindex(mat4.acp.ko)
mat4.acp.ko[is.na(mat4.acp.ko)] = 0
h4.acp.ko<-h.index(mat4.acp.ko)

ep4.acp.ko<-ep(mut4.acp.ko,a4.cp.ko)
david4.acp.ko<-DS(mat4.acp.ko) #David's Scores - for steepness use normDS output
ordrank.4.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.ko<-cbind(ordrank.4.acp.ko,ds=david4.acp.ko$normDS)
lm4.acp.ko<-summary(lm(ordrank.4.acp.ko$ds~ordrank.4.acp.ko$ord.rank))
s4.acp.ko<-lm4.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.ko<-data.frame(X1=avoid.cp.ko[[13]],X2=avoid.cp.ko[[14]],Avoids=avoid.cp.ko[[15]])
mat5.acp.ko<-avoid.inter.mat(mut5.acp.ko)
tri5.acp.ko<-tr.tri(mat5.acp.ko)
dci5.acp.ko<-DCindex(mat5.acp.ko)
mat5.acp.ko[is.na(mat5.acp.ko)] = 0
h5.acp.ko<-h.index(mat5.acp.ko)

ep5.acp.ko<-ep(mut5.acp.ko,a5.cp.ko)
david5.acp.ko<-DS(mat5.acp.ko) #David's Scores - for steepness use normDS output
ordrank.5.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.ko<-cbind(ordrank.5.acp.ko,ds=david5.acp.ko$normDS)
lm5.acp.ko<-summary(lm(ordrank.5.acp.ko$ds~ordrank.5.acp.ko$ord.rank))
s5.acp.ko<-lm5.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.ko<-data.frame(X1=avoid.cp.ko[[16]],X2=avoid.cp.ko[[17]],Avoids=avoid.cp.ko[[18]])
mat6.acp.ko<-avoid.inter.mat(mut6.acp.ko)
tri6.acp.ko<-tr.tri(mat6.acp.ko)
dci6.acp.ko<-DCindex(mat6.acp.ko)
mat6.acp.ko[is.na(mat6.acp.ko)] = 0
h6.acp.ko<-h.index(mat6.acp.ko)

ep6.acp.ko<-ep(mut6.acp.ko,a6.cp.ko)
david6.acp.ko<-DS(mat6.acp.ko) #David's Scores - for steepness use normDS output
ordrank.6.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.ko<-cbind(ordrank.6.acp.ko,ds=david6.acp.ko$normDS)
lm6.acp.ko<-summary(lm(ordrank.6.acp.ko$ds~ordrank.6.acp.ko$ord.rank))
s6.acp.ko<-lm6.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.ko<-data.frame(X1=avoid.cp.ko[[19]],X2=avoid.cp.ko[[20]],Avoids=avoid.cp.ko[[21]])
mat7.acp.ko<-avoid.inter.mat(mut7.acp.ko)
tri7.acp.ko<-tr.tri(mat7.acp.ko)
dci7.acp.ko<-DCindex(mat7.acp.ko)
mat7.acp.ko[is.na(mat7.acp.ko)] = 0
h7.acp.ko<-h.index(mat7.acp.ko)

ep7.acp.ko<-ep(mut7.acp.ko,a7.cp.ko)
david7.acp.ko<-DS(mat7.acp.ko) #David's Scores - for steepness use normDS output
ordrank.7.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.ko<-cbind(ordrank.7.acp.ko,ds=david7.acp.ko$normDS)
lm7.acp.ko<-summary(lm(ordrank.7.acp.ko$ds~ordrank.7.acp.ko$ord.rank))
s7.acp.ko<-lm7.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.ko<-data.frame(X1=avoid.cp.ko[[22]],X2=avoid.cp.ko[[23]],Avoids=avoid.cp.ko[[24]])
mat8.acp.ko<-avoid.inter.mat(mut8.acp.ko)
tri8.acp.ko<-tr.tri(mat8.acp.ko)
dci8.acp.ko<-DCindex(mat8.acp.ko)
mat8.acp.ko[is.na(mat8.acp.ko)] = 0
h8.acp.ko<-h.index(mat8.acp.ko)

ep8.acp.ko<-ep(mut8.acp.ko,a8.cp.ko)
david8.acp.ko<-DS(mat8.acp.ko) #David's Scores - for steepness use normDS output
ordrank.8.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.ko<-cbind(ordrank.8.acp.ko,ds=david8.acp.ko$normDS)
lm8.acp.ko<-summary(lm(ordrank.8.acp.ko$ds~ordrank.8.acp.ko$ord.rank))
s8.acp.ko<-lm8.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.ko<-data.frame(X1=avoid.cp.ko[[25]],X2=avoid.cp.ko[[26]],Avoids=avoid.cp.ko[[27]])
mat9.acp.ko<-avoid.inter.mat(mut9.acp.ko)
tri9.acp.ko<-tr.tri(mat9.acp.ko)
dci9.acp.ko<-DCindex(mat9.acp.ko)
mat9.acp.ko[is.na(mat9.acp.ko)] = 0
h9.acp.ko<-h.index(mat9.acp.ko)

ep9.acp.ko<-ep(mut9.acp.ko,a9.cp.ko)
david9.acp.ko<-DS(mat9.acp.ko) #David's Scores - for steepness use normDS output
ordrank.9.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.ko<-cbind(ordrank.9.acp.ko,ds=david9.acp.ko$normDS)
lm9.acp.ko<-summary(lm(ordrank.9.acp.ko$ds~ordrank.9.acp.ko$ord.rank))
s9.acp.ko<-lm9.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.ko<-data.frame(X1=avoid.cp.ko[[28]],X2=avoid.cp.ko[[29]],Avoids=avoid.cp.ko[[30]])
mat10.acp.ko<-avoid.inter.mat(mut10.acp.ko)
tri10.acp.ko<-tr.tri(mat10.acp.ko)
dci10.acp.ko<-DCindex(mat10.acp.ko)
mat10.acp.ko[is.na(mat10.acp.ko)] = 0
h10.acp.ko<-h.index(mat10.acp.ko)

ep10.acp.ko<-ep(mut10.acp.ko,a10.cp.ko)
david10.acp.ko<-DS(mat10.acp.ko) #David's Scores - for steepness use normDS output
ordrank.10.acp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.ko<-cbind(ordrank.10.acp.ko,ds=david10.acp.ko$normDS)
lm10.acp.ko<-summary(lm(ordrank.10.acp.ko$ds~ordrank.10.acp.ko$ord.rank))
s10.acp.ko<-lm10.acp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.ko<-sum(mut1.acp.ko$Victories)
int2.acp.ko<-sum(mut2.acp.ko$Victories)
int3.acp.ko<-sum(mut3.acp.ko$Victories)
int4.acp.ko<-sum(mut4.acp.ko$Victories)
int5.acp.ko<-sum(mut5.acp.ko$Victories)
int6.acp.ko<-sum(mut6.acp.ko$Victories)
int7.acp.ko<-sum(mut7.acp.ko$Victories)
int8.acp.ko<-sum(mut8.acp.ko$Victories)
int9.acp.ko<-sum(mut9.acp.ko$Victories)
int10.acp.ko<-sum(mut10.acp.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.ko<-sum(a1.cp.ko$Victories)
av2.acp.ko<-sum(a2.cp.ko$Victories)
av3.acp.ko<-sum(a3.cp.ko$Victories)
av4.acp.ko<-sum(a4.cp.ko$Victories)
av5.acp.ko<-sum(a5.cp.ko$Victories)
av6.acp.ko<-sum(a6.cp.ko$Victories)
av7.acp.ko<-sum(a7.cp.ko$Victories)
av8.acp.ko<-sum(a8.cp.ko$Victories)
av9.acp.ko<-sum(a9.cp.ko$Victories)
av10.acp.ko<-sum(a10.cp.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.acp<-(sum(av1.acp.ko, av2.acp.ko, av3.acp.ko, av4.acp.ko, av5.acp.ko, av6.acp.ko, av7.acp.ko, av8.acp.ko, av9.acp.ko, av10.acp.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.acp<-(sum(int1.acp.ko, int2.acp.ko, int3.acp.ko, int4.acp.ko, int5.acp.ko, int6.acp.ko, int7.acp.ko, int8.acp.ko, int9.acp.ko, int10.acp.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.ko<-e1.acp.ko[order(e1.acp.ko$ID),]
e1.acp.ko<-as.matrix(t(e1.1.acp.ko))

e2.acp.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.ko<-e2.acp.ko[order(e2.acp.ko$ID),]
e2.acp.ko<-as.matrix(t(e2.1.acp.ko))

e3.acp.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.ko<-e3.acp.ko[order(e3.acp.ko$ID),]
e3.acp.ko<-as.matrix(t(e3.1.acp.ko))

e4.acp.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.ko<-e4.acp.ko[order(e4.acp.ko$ID),]
e4.acp.ko<-as.matrix(t(e4.1.acp.ko))

e5.acp.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.ko<-e5.acp.ko[order(e5.acp.ko$ID),]
e5.acp.ko<-as.matrix(t(e5.1.acp.ko))

e6.acp.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.ko<-e6.acp.ko[order(e6.acp.ko$ID),]
e6.acp.ko<-as.matrix(t(e6.1.acp.ko))

e7.acp.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.ko<-e7.acp.ko[order(e7.acp.ko$ID),]
e7.acp.ko<-as.matrix(t(e7.1.acp.ko))

e8.acp.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.ko<-e8.acp.ko[order(e8.acp.ko$ID),]
e8.acp.ko<-as.matrix(t(e8.1.acp.ko))

e9.acp.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.ko<-e9.acp.ko[order(e9.acp.ko$ID),]
e9.acp.ko<-as.matrix(t(e9.1.acp.ko))

e10.acp.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.ko<-e10.acp.ko[order(e10.acp.ko$ID),]
e10.acp.ko<-as.matrix(t(e10.1.acp.ko))

energy.ko.acp.ko<-as.data.frame(matrix(c(e1.acp.ko,e2.acp.ko,e3.acp.ko,e4.acp.ko,e5.acp.ko,e6.acp.ko,e7.acp.ko,e8.acp.ko,e9.acp.ko,e10.acp.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.acp.ko<-data.frame(ID=energy.ko.acp.ko$V1,energy_over_distance=energy.ko.acp.ko$V2,energy_over_time=energy.ko.acp.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.ko<-david1.acp.ko[order(david1.acp.ko$ID),]
david1.acp.ko<-as.matrix(t(david1.1.acp.ko))

david2.1.acp.ko<-david2.acp.ko[order(david2.acp.ko$ID),]
david2.acp.ko<-as.matrix(t(david2.1.acp.ko))

david3.1.acp.ko<-david3.acp.ko[order(david3.acp.ko$ID),]
david3.acp.ko<-as.matrix(t(david3.1.acp.ko))

david4.1.acp.ko<-david4.acp.ko[order(david4.acp.ko$ID),]
david4.acp.ko<-as.matrix(t(david4.1.acp.ko))

david5.1.acp.ko<-david5.acp.ko[order(david5.acp.ko$ID),]
david5.acp.ko<-as.matrix(t(david5.1.acp.ko))

david6.1.acp.ko<-david6.acp.ko[order(david6.acp.ko$ID),]
david6.acp.ko<-as.matrix(t(david6.1.acp.ko))

david7.1.acp.ko<-david7.acp.ko[order(david7.acp.ko$ID),]
david7.acp.ko<-as.matrix(t(david7.1.acp.ko))

david8.1.acp.ko<-david8.acp.ko[order(david8.acp.ko$ID),]
david8.acp.ko<-as.matrix(t(david8.1.acp.ko))

david9.1.acp.ko<-david9.acp.ko[order(david9.acp.ko$ID),]
david9.acp.ko<-as.matrix(t(david9.1.acp.ko))

david10.1.acp.ko<-david10.acp.ko[order(david10.acp.ko$ID),]
david10.acp.ko<-as.matrix(t(david10.1.acp.ko))

david.ko.acp.ko<-as.data.frame(matrix(c(david1.acp.ko,david2.acp.ko,david3.acp.ko,david4.acp.ko,david5.acp.ko,david6.acp.ko,david7.acp.ko,david8.acp.ko,david9.acp.ko,david10.acp.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.acp.ko<-data.frame(ID=david.ko.acp.ko$V1,DS=david.ko.acp.ko$V2,normDS=david.ko.acp.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.acp.ko<-lm(e1.1.acp.ko$energy_over_time~as.numeric(david1.1.acp.ko$normDS))
ko.lm.1.s.acp.ko<-summary(lm.ko.1.acp.ko)$coefficients
ko.1.slope.acp.ko<-ko.lm.1.s.acp.ko[2,1]
lm.ko.2.acp.ko<-lm(e2.1.acp.ko$energy_over_time~as.numeric(david2.1.acp.ko$normDS))
ko.lm.2.s.acp.ko<-summary(lm.ko.2.acp.ko)$coefficients
ko.2.slope.acp.ko<-ko.lm.2.s.acp.ko[2,1]
lm.ko.3.acp.ko<-lm(e3.1.acp.ko$energy_over_time~as.numeric(david3.1.acp.ko$normDS))
ko.lm.3.s.acp.ko<-summary(lm.ko.3.acp.ko)$coefficients
ko.3.slope.acp.ko<-ko.lm.3.s.acp.ko[2,1]
lm.ko.4.acp.ko<-lm(e4.1.acp.ko$energy_over_time~as.numeric(david4.1.acp.ko$normDS))
ko.lm.4.s.acp.ko<-summary(lm.ko.4.acp.ko)$coefficients
ko.4.slope.acp.ko<-ko.lm.4.s.acp.ko[2,1]
lm.ko.5.acp.ko<-lm(e5.1.acp.ko$energy_over_time~as.numeric(david5.1.acp.ko$normDS))
ko.lm.5.s.acp.ko<-summary(lm.ko.5.acp.ko)$coefficients
ko.5.slope.acp.ko<-ko.lm.5.s.acp.ko[2,1]
lm.ko.6.acp.ko<-lm(e6.1.acp.ko$energy_over_time~as.numeric(david6.1.acp.ko$normDS))
ko.lm.6.s.acp.ko<-summary(lm.ko.6.acp.ko)$coefficients
ko.6.slope.acp.ko<-ko.lm.6.s.acp.ko[2,1]
lm.ko.7.acp.ko<-lm(e7.1.acp.ko$energy_over_time~as.numeric(david7.1.acp.ko$normDS))
ko.lm.7.s.acp.ko<-summary(lm.ko.7.acp.ko)$coefficients
ko.7.slope.acp.ko<-ko.lm.7.s.acp.ko[2,1]
lm.ko.8.acp.ko<-lm(e8.1.acp.ko$energy_over_time~as.numeric(david8.1.acp.ko$normDS))
ko.lm.8.s.acp.ko<-summary(lm.ko.8.acp.ko)$coefficients
ko.8.slope.acp.ko<-ko.lm.8.s.acp.ko[2,1]
lm.ko.9.acp.ko<-lm(e9.1.acp.ko$energy_over_time~as.numeric(david9.1.acp.ko$normDS))
ko.lm.9.s.acp.ko<-summary(lm.ko.9.acp.ko)$coefficients
ko.9.slope.acp.ko<-ko.lm.9.s.acp.ko[2,1]
lm.ko.10.acp.ko<-lm(e10.1.acp.ko$energy_over_time~as.numeric(david10.1.acp.ko$normDS))
ko.lm.10.s.acp.ko<-summary(lm.ko.10.acp.ko)$coefficients
ko.10.slope.acp.ko<-ko.lm.10.s.acp.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.acp.ss.avoid.cp.ko<-data.frame(triangle.transitivity=c(tri1.acp.ko,tri2.acp.ko,tri3.acp.ko,tri4.acp.ko,tri5.acp.ko,tri6.acp.ko,tri7.acp.ko,tri8.acp.ko,tri9.acp.ko,tri10.acp.ko),escalation=c(ep1.acp.ko,ep2.acp.ko,ep3.acp.ko,ep4.acp.ko,ep5.acp.ko,ep6.acp.ko,ep7.acp.ko,ep8.acp.ko,ep9.acp.ko,ep10.acp.ko),dci=c(dci1.acp.ko,dci2.acp.ko,dci3.acp.ko,dci4.acp.ko,dci5.acp.ko,dci6.acp.ko,dci7.acp.ko,dci8.acp.ko,dci9.acp.ko,dci10.acp.ko),steepness=c(s1.acp.ko,s2.acp.ko,s3.acp.ko,s4.acp.ko,s5.acp.ko,s6.acp.ko,s7.acp.ko,s8.acp.ko,s9.acp.ko,s10.acp.ko),slope=c(ko.1.slope.acp.ko,ko.2.slope.acp.ko,ko.3.slope.acp.ko,ko.4.slope.acp.ko,ko.5.slope.acp.ko,ko.6.slope.acp.ko,ko.7.slope.acp.ko,ko.8.slope.acp.ko,ko.9.slope.acp.ko,ko.10.slope.acp.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.hm<-sapply(files, read.csv)

# Generate avoid.cp.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.hm<-data.frame(X1=avoid.cp.hm[[1]],X2=avoid.cp.hm[[2]],Avoids=avoid.cp.hm[[3]])
mat1.acp.hm<-avoid.inter.mat(mut1.acp.hm)
tri1.acp.hm<-tr.tri(mat1.acp.hm)
dci1.acp.hm<-DCindex(mat1.acp.hm)
mat1.acp.hm[is.na(mat1.acp.hm)] = 0
h1.acp.hm<-h.index(mat1.acp.hm)

ep1.acp.hm<-ep(mut1.acp.hm,a1.cp.hm)
david1.acp.hm<-DS(mat1.acp.hm) #David's Scores - for steepness use normDS output
ordrank.1.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.hm<-cbind(ordrank.1.acp.hm,ds=david1.acp.hm$normDS)
lm1.acp.hm<-summary(lm(ordrank.1.acp.hm$ds~ordrank.1.acp.hm$ord.rank))
s1.acp.hm<-lm1.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.hm<-data.frame(X1=avoid.cp.hm[[4]],X2=avoid.cp.hm[[5]],Avoids=avoid.cp.hm[[6]])
mat2.acp.hm<-avoid.inter.mat(mut2.acp.hm)
tri2.acp.hm<-tr.tri(mat2.acp.hm)
dci2.acp.hm<-DCindex(mat2.acp.hm)
mat2.acp.hm[is.na(mat2.acp.hm)] = 0
h2.acp.hm<-h.index(mat2.acp.hm)

ep2.acp.hm<-ep(mut2.acp.hm,a2.cp.hm)
david2.acp.hm<-DS(mat2.acp.hm) #David's Scores - for steepness use normDS output
ordrank.2.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.hm<-cbind(ordrank.2.acp.hm,ds=david2.acp.hm$normDS)
lm2.acp.hm<-summary(lm(ordrank.2.acp.hm$ds~ordrank.2.acp.hm$ord.rank))
s2.acp.hm<-lm2.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.hm<-data.frame(X1=avoid.cp.hm[[7]],X2=avoid.cp.hm[[8]],Avoids=avoid.cp.hm[[9]])
mat3.acp.hm<-avoid.inter.mat(mut3.acp.hm)
tri3.acp.hm<-tr.tri(mat3.acp.hm)
dci3.acp.hm<-DCindex(mat3.acp.hm)
mat3.acp.hm[is.na(mat3.acp.hm)] = 0
h3.acp.hm<-h.index(mat3.acp.hm)

ep3.acp.hm<-ep(mut3.acp.hm,a3.cp.hm)
david3.acp.hm<-DS(mat3.acp.hm) #David's Scores - for steepness use normDS output
ordrank.3.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.hm<-cbind(ordrank.3.acp.hm,ds=david3.acp.hm$normDS)
lm3.acp.hm<-summary(lm(ordrank.3.acp.hm$ds~ordrank.3.acp.hm$ord.rank))
s3.acp.hm<-lm3.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.hm<-data.frame(X1=avoid.cp.hm[[10]],X2=avoid.cp.hm[[11]],Avoids=avoid.cp.hm[[12]])
mat4.acp.hm<-avoid.inter.mat(mut4.acp.hm)
tri4.acp.hm<-tr.tri(mat4.acp.hm)
dci4.acp.hm<-DCindex(mat4.acp.hm)
mat4.acp.hm[is.na(mat4.acp.hm)] = 0
h4.acp.hm<-h.index(mat4.acp.hm)

ep4.acp.hm<-ep(mut4.acp.hm,a4.cp.hm)
david4.acp.hm<-DS(mat4.acp.hm) #David's Scores - for steepness use normDS output
ordrank.4.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.hm<-cbind(ordrank.4.acp.hm,ds=david4.acp.hm$normDS)
lm4.acp.hm<-summary(lm(ordrank.4.acp.hm$ds~ordrank.4.acp.hm$ord.rank))
s4.acp.hm<-lm4.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.hm<-data.frame(X1=avoid.cp.hm[[13]],X2=avoid.cp.hm[[14]],Avoids=avoid.cp.hm[[15]])
mat5.acp.hm<-avoid.inter.mat(mut5.acp.hm)
tri5.acp.hm<-tr.tri(mat5.acp.hm)
dci5.acp.hm<-DCindex(mat5.acp.hm)
mat5.acp.hm[is.na(mat5.acp.hm)] = 0
h5.acp.hm<-h.index(mat5.acp.hm)

ep5.acp.hm<-ep(mut5.acp.hm,a5.cp.hm)
david5.acp.hm<-DS(mat5.acp.hm) #David's Scores - for steepness use normDS output
ordrank.5.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.hm<-cbind(ordrank.5.acp.hm,ds=david5.acp.hm$normDS)
lm5.acp.hm<-summary(lm(ordrank.5.acp.hm$ds~ordrank.5.acp.hm$ord.rank))
s5.acp.hm<-lm5.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.hm<-data.frame(X1=avoid.cp.hm[[16]],X2=avoid.cp.hm[[17]],Avoids=avoid.cp.hm[[18]])
mat6.acp.hm<-avoid.inter.mat(mut6.acp.hm)
tri6.acp.hm<-tr.tri(mat6.acp.hm)
dci6.acp.hm<-DCindex(mat6.acp.hm)
mat6.acp.hm[is.na(mat6.acp.hm)] = 0
h6.acp.hm<-h.index(mat6.acp.hm)

ep6.acp.hm<-ep(mut6.acp.hm,a6.cp.hm)
david6.acp.hm<-DS(mat6.acp.hm) #David's Scores - for steepness use normDS output
ordrank.6.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.hm<-cbind(ordrank.6.acp.hm,ds=david6.acp.hm$normDS)
lm6.acp.hm<-summary(lm(ordrank.6.acp.hm$ds~ordrank.6.acp.hm$ord.rank))
s6.acp.hm<-lm6.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.hm<-data.frame(X1=avoid.cp.hm[[19]],X2=avoid.cp.hm[[20]],Avoids=avoid.cp.hm[[21]])
mat7.acp.hm<-avoid.inter.mat(mut7.acp.hm)
tri7.acp.hm<-tr.tri(mat7.acp.hm)
dci7.acp.hm<-DCindex(mat7.acp.hm)
mat7.acp.hm[is.na(mat7.acp.hm)] = 0
h7.acp.hm<-h.index(mat7.acp.hm)

ep7.acp.hm<-ep(mut7.acp.hm,a7.cp.hm)
david7.acp.hm<-DS(mat7.acp.hm) #David's Scores - for steepness use normDS output
ordrank.7.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.hm<-cbind(ordrank.7.acp.hm,ds=david7.acp.hm$normDS)
lm7.acp.hm<-summary(lm(ordrank.7.acp.hm$ds~ordrank.7.acp.hm$ord.rank))
s7.acp.hm<-lm7.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.hm<-data.frame(X1=avoid.cp.hm[[22]],X2=avoid.cp.hm[[23]],Avoids=avoid.cp.hm[[24]])
mat8.acp.hm<-avoid.inter.mat(mut8.acp.hm)
tri8.acp.hm<-tr.tri(mat8.acp.hm)
dci8.acp.hm<-DCindex(mat8.acp.hm)
mat8.acp.hm[is.na(mat8.acp.hm)] = 0
h8.acp.hm<-h.index(mat8.acp.hm)

ep8.acp.hm<-ep(mut8.acp.hm,a8.cp.hm)
david8.acp.hm<-DS(mat8.acp.hm) #David's Scores - for steepness use normDS output
ordrank.8.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.hm<-cbind(ordrank.8.acp.hm,ds=david8.acp.hm$normDS)
lm8.acp.hm<-summary(lm(ordrank.8.acp.hm$ds~ordrank.8.acp.hm$ord.rank))
s8.acp.hm<-lm8.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.hm<-data.frame(X1=avoid.cp.hm[[25]],X2=avoid.cp.hm[[26]],Avoids=avoid.cp.hm[[27]])
mat9.acp.hm<-avoid.inter.mat(mut9.acp.hm)
tri9.acp.hm<-tr.tri(mat9.acp.hm)
dci9.acp.hm<-DCindex(mat9.acp.hm)
mat9.acp.hm[is.na(mat9.acp.hm)] = 0
h9.acp.hm<-h.index(mat9.acp.hm)

ep9.acp.hm<-ep(mut9.acp.hm,a9.cp.hm)
david9.acp.hm<-DS(mat9.acp.hm) #David's Scores - for steepness use normDS output
ordrank.9.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.hm<-cbind(ordrank.9.acp.hm,ds=david9.acp.hm$normDS)
lm9.acp.hm<-summary(lm(ordrank.9.acp.hm$ds~ordrank.9.acp.hm$ord.rank))
s9.acp.hm<-lm9.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.hm<-data.frame(X1=avoid.cp.hm[[28]],X2=avoid.cp.hm[[29]],Avoids=avoid.cp.hm[[30]])
mat10.acp.hm<-avoid.inter.mat(mut10.acp.hm)
tri10.acp.hm<-tr.tri(mat10.acp.hm)
dci10.acp.hm<-DCindex(mat10.acp.hm)
mat10.acp.hm[is.na(mat10.acp.hm)] = 0
h10.acp.hm<-h.index(mat10.acp.hm)

ep10.acp.hm<-ep(mut10.acp.hm,a10.cp.hm)
david10.acp.hm<-DS(mat10.acp.hm) #David's Scores - for steepness use normDS output
ordrank.10.acp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.hm<-cbind(ordrank.10.acp.hm,ds=david10.acp.hm$normDS)
lm10.acp.hm<-summary(lm(ordrank.10.acp.hm$ds~ordrank.10.acp.hm$ord.rank))
s10.acp.hm<-lm10.acp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.hm<-sum(mut1.acp.hm$Victories)
int2.acp.hm<-sum(mut2.acp.hm$Victories)
int3.acp.hm<-sum(mut3.acp.hm$Victories)
int4.acp.hm<-sum(mut4.acp.hm$Victories)
int5.acp.hm<-sum(mut5.acp.hm$Victories)
int6.acp.hm<-sum(mut6.acp.hm$Victories)
int7.acp.hm<-sum(mut7.acp.hm$Victories)
int8.acp.hm<-sum(mut8.acp.hm$Victories)
int9.acp.hm<-sum(mut9.acp.hm$Victories)
int10.acp.hm<-sum(mut10.acp.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.hm<-sum(a1.cp.hm$Victories)
av2.acp.hm<-sum(a2.cp.hm$Victories)
av3.acp.hm<-sum(a3.cp.hm$Victories)
av4.acp.hm<-sum(a4.cp.hm$Victories)
av5.acp.hm<-sum(a5.cp.hm$Victories)
av6.acp.hm<-sum(a6.cp.hm$Victories)
av7.acp.hm<-sum(a7.cp.hm$Victories)
av8.acp.hm<-sum(a8.cp.hm$Victories)
av9.acp.hm<-sum(a9.cp.hm$Victories)
av10.acp.hm<-sum(a10.cp.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.acp<-(sum(av1.acp.hm, av2.acp.hm, av3.acp.hm, av4.acp.hm, av5.acp.hm, av6.acp.hm, av7.acp.hm, av8.acp.hm, av9.acp.hm, av10.acp.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.acp<-(sum(int1.acp.hm, int2.acp.hm, int3.acp.hm, int4.acp.hm, int5.acp.hm, int6.acp.hm, int7.acp.hm, int8.acp.hm, int9.acp.hm, int10.acp.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.hm<-e1.acp.hm[order(e1.acp.hm$ID),]
e1.acp.hm<-as.matrix(t(e1.1.acp.hm))

e2.acp.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.hm<-e2.acp.hm[order(e2.acp.hm$ID),]
e2.acp.hm<-as.matrix(t(e2.1.acp.hm))

e3.acp.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.hm<-e3.acp.hm[order(e3.acp.hm$ID),]
e3.acp.hm<-as.matrix(t(e3.1.acp.hm))

e4.acp.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.hm<-e4.acp.hm[order(e4.acp.hm$ID),]
e4.acp.hm<-as.matrix(t(e4.1.acp.hm))

e5.acp.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.hm<-e5.acp.hm[order(e5.acp.hm$ID),]
e5.acp.hm<-as.matrix(t(e5.1.acp.hm))

e6.acp.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.hm<-e6.acp.hm[order(e6.acp.hm$ID),]
e6.acp.hm<-as.matrix(t(e6.1.acp.hm))

e7.acp.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.hm<-e7.acp.hm[order(e7.acp.hm$ID),]
e7.acp.hm<-as.matrix(t(e7.1.acp.hm))

e8.acp.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.hm<-e8.acp.hm[order(e8.acp.hm$ID),]
e8.acp.hm<-as.matrix(t(e8.1.acp.hm))

e9.acp.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.hm<-e9.acp.hm[order(e9.acp.hm$ID),]
e9.acp.hm<-as.matrix(t(e9.1.acp.hm))

e10.acp.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.hm<-e10.acp.hm[order(e10.acp.hm$ID),]
e10.acp.hm<-as.matrix(t(e10.1.acp.hm))

energy.hm.acp.hm<-as.data.frame(matrix(c(e1.acp.hm,e2.acp.hm,e3.acp.hm,e4.acp.hm,e5.acp.hm,e6.acp.hm,e7.acp.hm,e8.acp.hm,e9.acp.hm,e10.acp.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.acp.hm<-data.frame(ID=energy.hm.acp.hm$V1,energy_over_distance=energy.hm.acp.hm$V2,energy_over_time=energy.hm.acp.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.hm<-david1.acp.hm[order(david1.acp.hm$ID),]
david1.acp.hm<-as.matrix(t(david1.1.acp.hm))

david2.1.acp.hm<-david2.acp.hm[order(david2.acp.hm$ID),]
david2.acp.hm<-as.matrix(t(david2.1.acp.hm))

david3.1.acp.hm<-david3.acp.hm[order(david3.acp.hm$ID),]
david3.acp.hm<-as.matrix(t(david3.1.acp.hm))

david4.1.acp.hm<-david4.acp.hm[order(david4.acp.hm$ID),]
david4.acp.hm<-as.matrix(t(david4.1.acp.hm))

david5.1.acp.hm<-david5.acp.hm[order(david5.acp.hm$ID),]
david5.acp.hm<-as.matrix(t(david5.1.acp.hm))

david6.1.acp.hm<-david6.acp.hm[order(david6.acp.hm$ID),]
david6.acp.hm<-as.matrix(t(david6.1.acp.hm))

david7.1.acp.hm<-david7.acp.hm[order(david7.acp.hm$ID),]
david7.acp.hm<-as.matrix(t(david7.1.acp.hm))

david8.1.acp.hm<-david8.acp.hm[order(david8.acp.hm$ID),]
david8.acp.hm<-as.matrix(t(david8.1.acp.hm))

david9.1.acp.hm<-david9.acp.hm[order(david9.acp.hm$ID),]
david9.acp.hm<-as.matrix(t(david9.1.acp.hm))

david10.1.acp.hm<-david10.acp.hm[order(david10.acp.hm$ID),]
david10.acp.hm<-as.matrix(t(david10.1.acp.hm))

david.hm.acp.hm<-as.data.frame(matrix(c(david1.acp.hm,david2.acp.hm,david3.acp.hm,david4.acp.hm,david5.acp.hm,david6.acp.hm,david7.acp.hm,david8.acp.hm,david9.acp.hm,david10.acp.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.acp.hm<-data.frame(ID=david.hm.acp.hm$V1,DS=david.hm.acp.hm$V2,normDS=david.hm.acp.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.acp.hm<-lm(e1.1.acp.hm$energy_over_time~as.numeric(david1.1.acp.hm$normDS))
hm.lm.1.s.acp.hm<-summary(lm.hm.1.acp.hm)$coefficients
hm.1.slope.acp.hm<-hm.lm.1.s.acp.hm[2,1]
lm.hm.2.acp.hm<-lm(e2.1.acp.hm$energy_over_time~as.numeric(david2.1.acp.hm$normDS))
hm.lm.2.s.acp.hm<-summary(lm.hm.2.acp.hm)$coefficients
hm.2.slope.acp.hm<-hm.lm.2.s.acp.hm[2,1]
lm.hm.3.acp.hm<-lm(e3.1.acp.hm$energy_over_time~as.numeric(david3.1.acp.hm$normDS))
hm.lm.3.s.acp.hm<-summary(lm.hm.3.acp.hm)$coefficients
hm.3.slope.acp.hm<-hm.lm.3.s.acp.hm[2,1]
lm.hm.4.acp.hm<-lm(e4.1.acp.hm$energy_over_time~as.numeric(david4.1.acp.hm$normDS))
hm.lm.4.s.acp.hm<-summary(lm.hm.4.acp.hm)$coefficients
hm.4.slope.acp.hm<-hm.lm.4.s.acp.hm[2,1]
lm.hm.5.acp.hm<-lm(e5.1.acp.hm$energy_over_time~as.numeric(david5.1.acp.hm$normDS))
hm.lm.5.s.acp.hm<-summary(lm.hm.5.acp.hm)$coefficients
hm.5.slope.acp.hm<-hm.lm.5.s.acp.hm[2,1]
lm.hm.6.acp.hm<-lm(e6.1.acp.hm$energy_over_time~as.numeric(david6.1.acp.hm$normDS))
hm.lm.6.s.acp.hm<-summary(lm.hm.6.acp.hm)$coefficients
hm.6.slope.acp.hm<-hm.lm.6.s.acp.hm[2,1]
lm.hm.7.acp.hm<-lm(e7.1.acp.hm$energy_over_time~as.numeric(david7.1.acp.hm$normDS))
hm.lm.7.s.acp.hm<-summary(lm.hm.7.acp.hm)$coefficients
hm.7.slope.acp.hm<-hm.lm.7.s.acp.hm[2,1]
lm.hm.8.acp.hm<-lm(e8.1.acp.hm$energy_over_time~as.numeric(david8.1.acp.hm$normDS))
hm.lm.8.s.acp.hm<-summary(lm.hm.8.acp.hm)$coefficients
hm.8.slope.acp.hm<-hm.lm.8.s.acp.hm[2,1]
lm.hm.9.acp.hm<-lm(e9.1.acp.hm$energy_over_time~as.numeric(david9.1.acp.hm$normDS))
hm.lm.9.s.acp.hm<-summary(lm.hm.9.acp.hm)$coefficients
hm.9.slope.acp.hm<-hm.lm.9.s.acp.hm[2,1]
lm.hm.10.acp.hm<-lm(e10.1.acp.hm$energy_over_time~as.numeric(david10.1.acp.hm$normDS))
hm.lm.10.s.acp.hm<-summary(lm.hm.10.acp.hm)$coefficients
hm.10.slope.acp.hm<-hm.lm.10.s.acp.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.acp.ss.avoid.cp.hm<-data.frame(triangle.transitivity=c(tri1.acp.hm,tri2.acp.hm,tri3.acp.hm,tri4.acp.hm,tri5.acp.hm,tri6.acp.hm,tri7.acp.hm,tri8.acp.hm,tri9.acp.hm,tri10.acp.hm),escalation=c(ep1.acp.hm,ep2.acp.hm,ep3.acp.hm,ep4.acp.hm,ep5.acp.hm,ep6.acp.hm,ep7.acp.hm,ep8.acp.hm,ep9.acp.hm,ep10.acp.hm),dci=c(dci1.acp.hm,dci2.acp.hm,dci3.acp.hm,dci4.acp.hm,dci5.acp.hm,dci6.acp.hm,dci7.acp.hm,dci8.acp.hm,dci9.acp.hm,dci10.acp.hm),steepness=c(s1.acp.hm,s2.acp.hm,s3.acp.hm,s4.acp.hm,s5.acp.hm,s6.acp.hm,s7.acp.hm,s8.acp.hm,s9.acp.hm,s10.acp.hm),slope=c(hm.1.slope.acp.hm,hm.2.slope.acp.hm,hm.3.slope.acp.hm,hm.4.slope.acp.hm,hm.5.slope.acp.hm,hm.6.slope.acp.hm,hm.7.slope.acp.hm,hm.8.slope.acp.hm,hm.9.slope.acp.hm,hm.10.slope.acp.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the History Self Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.hs<-sapply(files, read.csv)

# Generate avoid.cp.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.hs<-data.frame(X1=avoid.cp.hs[[1]],X2=avoid.cp.hs[[2]],Avoids=avoid.cp.hs[[3]])
mat1.acp.hs<-avoid.inter.mat(mut1.acp.hs)
tri1.acp.hs<-tr.tri(mat1.acp.hs)
dci1.acp.hs<-DCindex(mat1.acp.hs)
mat1.acp.hs[is.na(mat1.acp.hs)] = 0
h1.acp.hs<-h.index(mat1.acp.hs)

ep1.acp.hs<-ep(mut1.acp.hs,a1.cp.hs)
david1.acp.hs<-DS(mat1.acp.hs) #David's Scores - for steepness use normDS output
ordrank.1.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.hs<-cbind(ordrank.1.acp.hs,ds=david1.acp.hs$normDS)
lm1.acp.hs<-summary(lm(ordrank.1.acp.hs$ds~ordrank.1.acp.hs$ord.rank))
s1.acp.hs<-lm1.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.hs<-data.frame(X1=avoid.cp.hs[[4]],X2=avoid.cp.hs[[5]],Avoids=avoid.cp.hs[[6]])
mat2.acp.hs<-avoid.inter.mat(mut2.acp.hs)
tri2.acp.hs<-tr.tri(mat2.acp.hs)
dci2.acp.hs<-DCindex(mat2.acp.hs)
mat2.acp.hs[is.na(mat2.acp.hs)] = 0
h2.acp.hs<-h.index(mat2.acp.hs)

ep2.acp.hs<-ep(mut2.acp.hs,a2.cp.hs)
david2.acp.hs<-DS(mat2.acp.hs) #David's Scores - for steepness use normDS output
ordrank.2.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.hs<-cbind(ordrank.2.acp.hs,ds=david2.acp.hs$normDS)
lm2.acp.hs<-summary(lm(ordrank.2.acp.hs$ds~ordrank.2.acp.hs$ord.rank))
s2.acp.hs<-lm2.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.hs<-data.frame(X1=avoid.cp.hs[[7]],X2=avoid.cp.hs[[8]],Avoids=avoid.cp.hs[[9]])
mat3.acp.hs<-avoid.inter.mat(mut3.acp.hs)
tri3.acp.hs<-tr.tri(mat3.acp.hs)
dci3.acp.hs<-DCindex(mat3.acp.hs)
mat3.acp.hs[is.na(mat3.acp.hs)] = 0
h3.acp.hs<-h.index(mat3.acp.hs)

ep3.acp.hs<-ep(mut3.acp.hs,a3.cp.hs)
david3.acp.hs<-DS(mat3.acp.hs) #David's Scores - for steepness use normDS output
ordrank.3.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.hs<-cbind(ordrank.3.acp.hs,ds=david3.acp.hs$normDS)
lm3.acp.hs<-summary(lm(ordrank.3.acp.hs$ds~ordrank.3.acp.hs$ord.rank))
s3.acp.hs<-lm3.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.hs<-data.frame(X1=avoid.cp.hs[[10]],X2=avoid.cp.hs[[11]],Avoids=avoid.cp.hs[[12]])
mat4.acp.hs<-avoid.inter.mat(mut4.acp.hs)
tri4.acp.hs<-tr.tri(mat4.acp.hs)
dci4.acp.hs<-DCindex(mat4.acp.hs)
mat4.acp.hs[is.na(mat4.acp.hs)] = 0
h4.acp.hs<-h.index(mat4.acp.hs)

ep4.acp.hs<-ep(mut4.acp.hs,a4.cp.hs)
david4.acp.hs<-DS(mat4.acp.hs) #David's Scores - for steepness use normDS output
ordrank.4.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.hs<-cbind(ordrank.4.acp.hs,ds=david4.acp.hs$normDS)
lm4.acp.hs<-summary(lm(ordrank.4.acp.hs$ds~ordrank.4.acp.hs$ord.rank))
s4.acp.hs<-lm4.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.hs<-data.frame(X1=avoid.cp.hs[[13]],X2=avoid.cp.hs[[14]],Avoids=avoid.cp.hs[[15]])
mat5.acp.hs<-avoid.inter.mat(mut5.acp.hs)
tri5.acp.hs<-tr.tri(mat5.acp.hs)
dci5.acp.hs<-DCindex(mat5.acp.hs)
mat5.acp.hs[is.na(mat5.acp.hs)] = 0
h5.acp.hs<-h.index(mat5.acp.hs)

ep5.acp.hs<-ep(mut5.acp.hs,a5.cp.hs)
david5.acp.hs<-DS(mat5.acp.hs) #David's Scores - for steepness use normDS output
ordrank.5.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.hs<-cbind(ordrank.5.acp.hs,ds=david5.acp.hs$normDS)
lm5.acp.hs<-summary(lm(ordrank.5.acp.hs$ds~ordrank.5.acp.hs$ord.rank))
s5.acp.hs<-lm5.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.hs<-data.frame(X1=avoid.cp.hs[[16]],X2=avoid.cp.hs[[17]],Avoids=avoid.cp.hs[[18]])
mat6.acp.hs<-avoid.inter.mat(mut6.acp.hs)
tri6.acp.hs<-tr.tri(mat6.acp.hs)
dci6.acp.hs<-DCindex(mat6.acp.hs)
mat6.acp.hs[is.na(mat6.acp.hs)] = 0
h6.acp.hs<-h.index(mat6.acp.hs)

ep6.acp.hs<-ep(mut6.acp.hs,a6.cp.hs)
david6.acp.hs<-DS(mat6.acp.hs) #David's Scores - for steepness use normDS output
ordrank.6.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.hs<-cbind(ordrank.6.acp.hs,ds=david6.acp.hs$normDS)
lm6.acp.hs<-summary(lm(ordrank.6.acp.hs$ds~ordrank.6.acp.hs$ord.rank))
s6.acp.hs<-lm6.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.hs<-data.frame(X1=avoid.cp.hs[[19]],X2=avoid.cp.hs[[20]],Avoids=avoid.cp.hs[[21]])
mat7.acp.hs<-avoid.inter.mat(mut7.acp.hs)
tri7.acp.hs<-tr.tri(mat7.acp.hs)
dci7.acp.hs<-DCindex(mat7.acp.hs)
mat7.acp.hs[is.na(mat7.acp.hs)] = 0
h7.acp.hs<-h.index(mat7.acp.hs)

ep7.acp.hs<-ep(mut7.acp.hs,a7.cp.hs)
david7.acp.hs<-DS(mat7.acp.hs) #David's Scores - for steepness use normDS output
ordrank.7.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.hs<-cbind(ordrank.7.acp.hs,ds=david7.acp.hs$normDS)
lm7.acp.hs<-summary(lm(ordrank.7.acp.hs$ds~ordrank.7.acp.hs$ord.rank))
s7.acp.hs<-lm7.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.hs<-data.frame(X1=avoid.cp.hs[[22]],X2=avoid.cp.hs[[23]],Avoids=avoid.cp.hs[[24]])
mat8.acp.hs<-avoid.inter.mat(mut8.acp.hs)
tri8.acp.hs<-tr.tri(mat8.acp.hs)
dci8.acp.hs<-DCindex(mat8.acp.hs)
mat8.acp.hs[is.na(mat8.acp.hs)] = 0
h8.acp.hs<-h.index(mat8.acp.hs)

ep8.acp.hs<-ep(mut8.acp.hs,a8.cp.hs)
david8.acp.hs<-DS(mat8.acp.hs) #David's Scores - for steepness use normDS output
ordrank.8.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.hs<-cbind(ordrank.8.acp.hs,ds=david8.acp.hs$normDS)
lm8.acp.hs<-summary(lm(ordrank.8.acp.hs$ds~ordrank.8.acp.hs$ord.rank))
s8.acp.hs<-lm8.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.hs<-data.frame(X1=avoid.cp.hs[[25]],X2=avoid.cp.hs[[26]],Avoids=avoid.cp.hs[[27]])
mat9.acp.hs<-avoid.inter.mat(mut9.acp.hs)
tri9.acp.hs<-tr.tri(mat9.acp.hs)
dci9.acp.hs<-DCindex(mat9.acp.hs)
mat9.acp.hs[is.na(mat9.acp.hs)] = 0
h9.acp.hs<-h.index(mat9.acp.hs)

ep9.acp.hs<-ep(mut9.acp.hs,a9.cp.hs)
david9.acp.hs<-DS(mat9.acp.hs) #David's Scores - for steepness use normDS output
ordrank.9.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.hs<-cbind(ordrank.9.acp.hs,ds=david9.acp.hs$normDS)
lm9.acp.hs<-summary(lm(ordrank.9.acp.hs$ds~ordrank.9.acp.hs$ord.rank))
s9.acp.hs<-lm9.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.hs<-data.frame(X1=avoid.cp.hs[[28]],X2=avoid.cp.hs[[29]],Avoids=avoid.cp.hs[[30]])
mat10.acp.hs<-avoid.inter.mat(mut10.acp.hs)
tri10.acp.hs<-tr.tri(mat10.acp.hs)
dci10.acp.hs<-DCindex(mat10.acp.hs)
mat10.acp.hs[is.na(mat10.acp.hs)] = 0
h10.acp.hs<-h.index(mat10.acp.hs)

ep10.acp.hs<-ep(mut10.acp.hs,a10.cp.hs)
david10.acp.hs<-DS(mat10.acp.hs) #David's Scores - for steepness use normDS output
ordrank.10.acp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.hs<-cbind(ordrank.10.acp.hs,ds=david10.acp.hs$normDS)
lm10.acp.hs<-summary(lm(ordrank.10.acp.hs$ds~ordrank.10.acp.hs$ord.rank))
s10.acp.hs<-lm10.acp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.hs<-sum(mut1.acp.hs$Victories)
int2.acp.hs<-sum(mut2.acp.hs$Victories)
int3.acp.hs<-sum(mut3.acp.hs$Victories)
int4.acp.hs<-sum(mut4.acp.hs$Victories)
int5.acp.hs<-sum(mut5.acp.hs$Victories)
int6.acp.hs<-sum(mut6.acp.hs$Victories)
int7.acp.hs<-sum(mut7.acp.hs$Victories)
int8.acp.hs<-sum(mut8.acp.hs$Victories)
int9.acp.hs<-sum(mut9.acp.hs$Victories)
int10.acp.hs<-sum(mut10.acp.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.hs<-sum(a1.cp.hs$Victories)
av2.acp.hs<-sum(a2.cp.hs$Victories)
av3.acp.hs<-sum(a3.cp.hs$Victories)
av4.acp.hs<-sum(a4.cp.hs$Victories)
av5.acp.hs<-sum(a5.cp.hs$Victories)
av6.acp.hs<-sum(a6.cp.hs$Victories)
av7.acp.hs<-sum(a7.cp.hs$Victories)
av8.acp.hs<-sum(a8.cp.hs$Victories)
av9.acp.hs<-sum(a9.cp.hs$Victories)
av10.acp.hs<-sum(a10.cp.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.acp<-(sum(av1.acp.hs, av2.acp.hs, av3.acp.hs, av4.acp.hs, av5.acp.hs, av6.acp.hs, av7.acp.hs, av8.acp.hs, av9.acp.hs, av10.acp.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.acp<-(sum(int1.acp.hs, int2.acp.hs, int3.acp.hs, int4.acp.hs, int5.acp.hs, int6.acp.hs, int7.acp.hs, int8.acp.hs, int9.acp.hs, int10.acp.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.hs<-e1.acp.hs[order(e1.acp.hs$ID),]
e1.acp.hs<-as.matrix(t(e1.1.acp.hs))

e2.acp.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.hs<-e2.acp.hs[order(e2.acp.hs$ID),]
e2.acp.hs<-as.matrix(t(e2.1.acp.hs))

e3.acp.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.hs<-e3.acp.hs[order(e3.acp.hs$ID),]
e3.acp.hs<-as.matrix(t(e3.1.acp.hs))

e4.acp.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.hs<-e4.acp.hs[order(e4.acp.hs$ID),]
e4.acp.hs<-as.matrix(t(e4.1.acp.hs))

e5.acp.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.hs<-e5.acp.hs[order(e5.acp.hs$ID),]
e5.acp.hs<-as.matrix(t(e5.1.acp.hs))

e6.acp.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.hs<-e6.acp.hs[order(e6.acp.hs$ID),]
e6.acp.hs<-as.matrix(t(e6.1.acp.hs))

e7.acp.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.hs<-e7.acp.hs[order(e7.acp.hs$ID),]
e7.acp.hs<-as.matrix(t(e7.1.acp.hs))

e8.acp.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.hs<-e8.acp.hs[order(e8.acp.hs$ID),]
e8.acp.hs<-as.matrix(t(e8.1.acp.hs))

e9.acp.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.hs<-e9.acp.hs[order(e9.acp.hs$ID),]
e9.acp.hs<-as.matrix(t(e9.1.acp.hs))

e10.acp.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.hs<-e10.acp.hs[order(e10.acp.hs$ID),]
e10.acp.hs<-as.matrix(t(e10.1.acp.hs))

energy.hs.acp.hs<-as.data.frame(matrix(c(e1.acp.hs,e2.acp.hs,e3.acp.hs,e4.acp.hs,e5.acp.hs,e6.acp.hs,e7.acp.hs,e8.acp.hs,e9.acp.hs,e10.acp.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.acp.hs<-data.frame(ID=energy.hs.acp.hs$V1,energy_over_distance=energy.hs.acp.hs$V2,energy_over_time=energy.hs.acp.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.hs<-david1.acp.hs[order(david1.acp.hs$ID),]
david1.acp.hs<-as.matrix(t(david1.1.acp.hs))

david2.1.acp.hs<-david2.acp.hs[order(david2.acp.hs$ID),]
david2.acp.hs<-as.matrix(t(david2.1.acp.hs))

david3.1.acp.hs<-david3.acp.hs[order(david3.acp.hs$ID),]
david3.acp.hs<-as.matrix(t(david3.1.acp.hs))

david4.1.acp.hs<-david4.acp.hs[order(david4.acp.hs$ID),]
david4.acp.hs<-as.matrix(t(david4.1.acp.hs))

david5.1.acp.hs<-david5.acp.hs[order(david5.acp.hs$ID),]
david5.acp.hs<-as.matrix(t(david5.1.acp.hs))

david6.1.acp.hs<-david6.acp.hs[order(david6.acp.hs$ID),]
david6.acp.hs<-as.matrix(t(david6.1.acp.hs))

david7.1.acp.hs<-david7.acp.hs[order(david7.acp.hs$ID),]
david7.acp.hs<-as.matrix(t(david7.1.acp.hs))

david8.1.acp.hs<-david8.acp.hs[order(david8.acp.hs$ID),]
david8.acp.hs<-as.matrix(t(david8.1.acp.hs))

david9.1.acp.hs<-david9.acp.hs[order(david9.acp.hs$ID),]
david9.acp.hs<-as.matrix(t(david9.1.acp.hs))

david10.1.acp.hs<-david10.acp.hs[order(david10.acp.hs$ID),]
david10.acp.hs<-as.matrix(t(david10.1.acp.hs))

david.hs.acp.hs<-as.data.frame(matrix(c(david1.acp.hs,david2.acp.hs,david3.acp.hs,david4.acp.hs,david5.acp.hs,david6.acp.hs,david7.acp.hs,david8.acp.hs,david9.acp.hs,david10.acp.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.acp.hs<-data.frame(ID=david.hs.acp.hs$V1,DS=david.hs.acp.hs$V2,normDS=david.hs.acp.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.acp.hs<-lm(e1.1.acp.hs$energy_over_time~as.numeric(david1.1.acp.hs$normDS))
hs.lm.1.s.acp.hs<-summary(lm.hs.1.acp.hs)$coefficients
hs.1.slope.acp.hs<-hs.lm.1.s.acp.hs[2,1]
lm.hs.2.acp.hs<-lm(e2.1.acp.hs$energy_over_time~as.numeric(david2.1.acp.hs$normDS))
hs.lm.2.s.acp.hs<-summary(lm.hs.2.acp.hs)$coefficients
hs.2.slope.acp.hs<-hs.lm.2.s.acp.hs[2,1]
lm.hs.3.acp.hs<-lm(e3.1.acp.hs$energy_over_time~as.numeric(david3.1.acp.hs$normDS))
hs.lm.3.s.acp.hs<-summary(lm.hs.3.acp.hs)$coefficients
hs.3.slope.acp.hs<-hs.lm.3.s.acp.hs[2,1]
lm.hs.4.acp.hs<-lm(e4.1.acp.hs$energy_over_time~as.numeric(david4.1.acp.hs$normDS))
hs.lm.4.s.acp.hs<-summary(lm.hs.4.acp.hs)$coefficients
hs.4.slope.acp.hs<-hs.lm.4.s.acp.hs[2,1]
lm.hs.5.acp.hs<-lm(e5.1.acp.hs$energy_over_time~as.numeric(david5.1.acp.hs$normDS))
hs.lm.5.s.acp.hs<-summary(lm.hs.5.acp.hs)$coefficients
hs.5.slope.acp.hs<-hs.lm.5.s.acp.hs[2,1]
lm.hs.6.acp.hs<-lm(e6.1.acp.hs$energy_over_time~as.numeric(david6.1.acp.hs$normDS))
hs.lm.6.s.acp.hs<-summary(lm.hs.6.acp.hs)$coefficients
hs.6.slope.acp.hs<-hs.lm.6.s.acp.hs[2,1]
lm.hs.7.acp.hs<-lm(e7.1.acp.hs$energy_over_time~as.numeric(david7.1.acp.hs$normDS))
hs.lm.7.s.acp.hs<-summary(lm.hs.7.acp.hs)$coefficients
hs.7.slope.acp.hs<-hs.lm.7.s.acp.hs[2,1]
lm.hs.8.acp.hs<-lm(e8.1.acp.hs$energy_over_time~as.numeric(david8.1.acp.hs$normDS))
hs.lm.8.s.acp.hs<-summary(lm.hs.8.acp.hs)$coefficients
hs.8.slope.acp.hs<-hs.lm.8.s.acp.hs[2,1]
lm.hs.9.acp.hs<-lm(e9.1.acp.hs$energy_over_time~as.numeric(david9.1.acp.hs$normDS))
hs.lm.9.s.acp.hs<-summary(lm.hs.9.acp.hs)$coefficients
hs.9.slope.acp.hs<-hs.lm.9.s.acp.hs[2,1]
lm.hs.10.acp.hs<-lm(e10.1.acp.hs$energy_over_time~as.numeric(david10.1.acp.hs$normDS))
hs.lm.10.s.acp.hs<-summary(lm.hs.10.acp.hs)$coefficients
hs.10.slope.acp.hs<-hs.lm.10.s.acp.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.acp.ss.avoid.cp.hs<-data.frame(triangle.transitivity=c(tri1.acp.hs,tri2.acp.hs,tri3.acp.hs,tri4.acp.hs,tri5.acp.hs,tri6.acp.hs,tri7.acp.hs,tri8.acp.hs,tri9.acp.hs,tri10.acp.hs),escalation=c(ep1.acp.hs,ep2.acp.hs,ep3.acp.hs,ep4.acp.hs,ep5.acp.hs,ep6.acp.hs,ep7.acp.hs,ep8.acp.hs,ep9.acp.hs,ep10.acp.hs),dci=c(dci1.acp.hs,dci2.acp.hs,dci3.acp.hs,dci4.acp.hs,dci5.acp.hs,dci6.acp.hs,dci7.acp.hs,dci8.acp.hs,dci9.acp.hs,dci10.acp.hs),steepness=c(s1.acp.hs,s2.acp.hs,s3.acp.hs,s4.acp.hs,s5.acp.hs,s6.acp.hs,s7.acp.hs,s8.acp.hs,s9.acp.hs,s10.acp.hs),slope=c(hs.1.slope.acp.hs,hs.2.slope.acp.hs,hs.3.slope.acp.hs,hs.4.slope.acp.hs,hs.5.slope.acp.hs,hs.6.slope.acp.hs,hs.7.slope.acp.hs,hs.8.slope.acp.hs,hs.9.slope.acp.hs,hs.10.slope.acp.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the History Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid.cp.ho<-sapply(files, read.csv)

# Generate avoid.cp.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.acp.ho<-data.frame(X1=avoid.cp.ho[[1]],X2=avoid.cp.ho[[2]],Avoids=avoid.cp.ho[[3]])
mat1.acp.ho<-avoid.inter.mat(mut1.acp.ho)
tri1.acp.ho<-tr.tri(mat1.acp.ho)
dci1.acp.ho<-DCindex(mat1.acp.ho)
mat1.acp.ho[is.na(mat1.acp.ho)] = 0
h1.acp.ho<-h.index(mat1.acp.ho)

ep1.acp.ho<-ep(mut1.acp.ho,a1.cp.ho)
david1.acp.ho<-DS(mat1.acp.ho) #David's Scores - for steepness use normDS output
ordrank.1.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.acp.ho<-cbind(ordrank.1.acp.ho,ds=david1.acp.ho$normDS)
lm1.acp.ho<-summary(lm(ordrank.1.acp.ho$ds~ordrank.1.acp.ho$ord.rank))
s1.acp.ho<-lm1.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.acp.ho<-data.frame(X1=avoid.cp.ho[[4]],X2=avoid.cp.ho[[5]],Avoids=avoid.cp.ho[[6]])
mat2.acp.ho<-avoid.inter.mat(mut2.acp.ho)
tri2.acp.ho<-tr.tri(mat2.acp.ho)
dci2.acp.ho<-DCindex(mat2.acp.ho)
mat2.acp.ho[is.na(mat2.acp.ho)] = 0
h2.acp.ho<-h.index(mat2.acp.ho)

ep2.acp.ho<-ep(mut2.acp.ho,a2.cp.ho)
david2.acp.ho<-DS(mat2.acp.ho) #David's Scores - for steepness use normDS output
ordrank.2.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.acp.ho<-cbind(ordrank.2.acp.ho,ds=david2.acp.ho$normDS)
lm2.acp.ho<-summary(lm(ordrank.2.acp.ho$ds~ordrank.2.acp.ho$ord.rank))
s2.acp.ho<-lm2.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.acp.ho<-data.frame(X1=avoid.cp.ho[[7]],X2=avoid.cp.ho[[8]],Avoids=avoid.cp.ho[[9]])
mat3.acp.ho<-avoid.inter.mat(mut3.acp.ho)
tri3.acp.ho<-tr.tri(mat3.acp.ho)
dci3.acp.ho<-DCindex(mat3.acp.ho)
mat3.acp.ho[is.na(mat3.acp.ho)] = 0
h3.acp.ho<-h.index(mat3.acp.ho)

ep3.acp.ho<-ep(mut3.acp.ho,a3.cp.ho)
david3.acp.ho<-DS(mat3.acp.ho) #David's Scores - for steepness use normDS output
ordrank.3.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.acp.ho<-cbind(ordrank.3.acp.ho,ds=david3.acp.ho$normDS)
lm3.acp.ho<-summary(lm(ordrank.3.acp.ho$ds~ordrank.3.acp.ho$ord.rank))
s3.acp.ho<-lm3.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.acp.ho<-data.frame(X1=avoid.cp.ho[[10]],X2=avoid.cp.ho[[11]],Avoids=avoid.cp.ho[[12]])
mat4.acp.ho<-avoid.inter.mat(mut4.acp.ho)
tri4.acp.ho<-tr.tri(mat4.acp.ho)
dci4.acp.ho<-DCindex(mat4.acp.ho)
mat4.acp.ho[is.na(mat4.acp.ho)] = 0
h4.acp.ho<-h.index(mat4.acp.ho)

ep4.acp.ho<-ep(mut4.acp.ho,a4.cp.ho)
david4.acp.ho<-DS(mat4.acp.ho) #David's Scores - for steepness use normDS output
ordrank.4.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.acp.ho<-cbind(ordrank.4.acp.ho,ds=david4.acp.ho$normDS)
lm4.acp.ho<-summary(lm(ordrank.4.acp.ho$ds~ordrank.4.acp.ho$ord.rank))
s4.acp.ho<-lm4.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.acp.ho<-data.frame(X1=avoid.cp.ho[[13]],X2=avoid.cp.ho[[14]],Avoids=avoid.cp.ho[[15]])
mat5.acp.ho<-avoid.inter.mat(mut5.acp.ho)
tri5.acp.ho<-tr.tri(mat5.acp.ho)
dci5.acp.ho<-DCindex(mat5.acp.ho)
mat5.acp.ho[is.na(mat5.acp.ho)] = 0
h5.acp.ho<-h.index(mat5.acp.ho)

ep5.acp.ho<-ep(mut5.acp.ho,a5.cp.ho)
david5.acp.ho<-DS(mat5.acp.ho) #David's Scores - for steepness use normDS output
ordrank.5.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.acp.ho<-cbind(ordrank.5.acp.ho,ds=david5.acp.ho$normDS)
lm5.acp.ho<-summary(lm(ordrank.5.acp.ho$ds~ordrank.5.acp.ho$ord.rank))
s5.acp.ho<-lm5.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.acp.ho<-data.frame(X1=avoid.cp.ho[[16]],X2=avoid.cp.ho[[17]],Avoids=avoid.cp.ho[[18]])
mat6.acp.ho<-avoid.inter.mat(mut6.acp.ho)
tri6.acp.ho<-tr.tri(mat6.acp.ho)
dci6.acp.ho<-DCindex(mat6.acp.ho)
mat6.acp.ho[is.na(mat6.acp.ho)] = 0
h6.acp.ho<-h.index(mat6.acp.ho)

ep6.acp.ho<-ep(mut6.acp.ho,a6.cp.ho)
david6.acp.ho<-DS(mat6.acp.ho) #David's Scores - for steepness use normDS output
ordrank.6.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.acp.ho<-cbind(ordrank.6.acp.ho,ds=david6.acp.ho$normDS)
lm6.acp.ho<-summary(lm(ordrank.6.acp.ho$ds~ordrank.6.acp.ho$ord.rank))
s6.acp.ho<-lm6.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.acp.ho<-data.frame(X1=avoid.cp.ho[[19]],X2=avoid.cp.ho[[20]],Avoids=avoid.cp.ho[[21]])
mat7.acp.ho<-avoid.inter.mat(mut7.acp.ho)
tri7.acp.ho<-tr.tri(mat7.acp.ho)
dci7.acp.ho<-DCindex(mat7.acp.ho)
mat7.acp.ho[is.na(mat7.acp.ho)] = 0
h7.acp.ho<-h.index(mat7.acp.ho)

ep7.acp.ho<-ep(mut7.acp.ho,a7.cp.ho)
david7.acp.ho<-DS(mat7.acp.ho) #David's Scores - for steepness use normDS output
ordrank.7.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.acp.ho<-cbind(ordrank.7.acp.ho,ds=david7.acp.ho$normDS)
lm7.acp.ho<-summary(lm(ordrank.7.acp.ho$ds~ordrank.7.acp.ho$ord.rank))
s7.acp.ho<-lm7.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.acp.ho<-data.frame(X1=avoid.cp.ho[[22]],X2=avoid.cp.ho[[23]],Avoids=avoid.cp.ho[[24]])
mat8.acp.ho<-avoid.inter.mat(mut8.acp.ho)
tri8.acp.ho<-tr.tri(mat8.acp.ho)
dci8.acp.ho<-DCindex(mat8.acp.ho)
mat8.acp.ho[is.na(mat8.acp.ho)] = 0
h8.acp.ho<-h.index(mat8.acp.ho)

ep8.acp.ho<-ep(mut8.acp.ho,a8.cp.ho)
david8.acp.ho<-DS(mat8.acp.ho) #David's Scores - for steepness use normDS output
ordrank.8.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.acp.ho<-cbind(ordrank.8.acp.ho,ds=david8.acp.ho$normDS)
lm8.acp.ho<-summary(lm(ordrank.8.acp.ho$ds~ordrank.8.acp.ho$ord.rank))
s8.acp.ho<-lm8.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.acp.ho<-data.frame(X1=avoid.cp.ho[[25]],X2=avoid.cp.ho[[26]],Avoids=avoid.cp.ho[[27]])
mat9.acp.ho<-avoid.inter.mat(mut9.acp.ho)
tri9.acp.ho<-tr.tri(mat9.acp.ho)
dci9.acp.ho<-DCindex(mat9.acp.ho)
mat9.acp.ho[is.na(mat9.acp.ho)] = 0
h9.acp.ho<-h.index(mat9.acp.ho)

ep9.acp.ho<-ep(mut9.acp.ho,a9.cp.ho)
david9.acp.ho<-DS(mat9.acp.ho) #David's Scores - for steepness use normDS output
ordrank.9.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.acp.ho<-cbind(ordrank.9.acp.ho,ds=david9.acp.ho$normDS)
lm9.acp.ho<-summary(lm(ordrank.9.acp.ho$ds~ordrank.9.acp.ho$ord.rank))
s9.acp.ho<-lm9.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.acp.ho<-data.frame(X1=avoid.cp.ho[[28]],X2=avoid.cp.ho[[29]],Avoids=avoid.cp.ho[[30]])
mat10.acp.ho<-avoid.inter.mat(mut10.acp.ho)
tri10.acp.ho<-tr.tri(mat10.acp.ho)
dci10.acp.ho<-DCindex(mat10.acp.ho)
mat10.acp.ho[is.na(mat10.acp.ho)] = 0
h10.acp.ho<-h.index(mat10.acp.ho)

ep10.acp.ho<-ep(mut10.acp.ho,a10.cp.ho)
david10.acp.ho<-DS(mat10.acp.ho) #David's Scores - for steepness use normDS output
ordrank.10.acp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.acp.ho<-cbind(ordrank.10.acp.ho,ds=david10.acp.ho$normDS)
lm10.acp.ho<-summary(lm(ordrank.10.acp.ho$ds~ordrank.10.acp.ho$ord.rank))
s10.acp.ho<-lm10.acp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.acp.ho<-sum(mut1.acp.ho$Victories)
int2.acp.ho<-sum(mut2.acp.ho$Victories)
int3.acp.ho<-sum(mut3.acp.ho$Victories)
int4.acp.ho<-sum(mut4.acp.ho$Victories)
int5.acp.ho<-sum(mut5.acp.ho$Victories)
int6.acp.ho<-sum(mut6.acp.ho$Victories)
int7.acp.ho<-sum(mut7.acp.ho$Victories)
int8.acp.ho<-sum(mut8.acp.ho$Victories)
int9.acp.ho<-sum(mut9.acp.ho$Victories)
int10.acp.ho<-sum(mut10.acp.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.acp.ho<-sum(a1.cp.ho$Victories)
av2.acp.ho<-sum(a2.cp.ho$Victories)
av3.acp.ho<-sum(a3.cp.ho$Victories)
av4.acp.ho<-sum(a4.cp.ho$Victories)
av5.acp.ho<-sum(a5.cp.ho$Victories)
av6.acp.ho<-sum(a6.cp.ho$Victories)
av7.acp.ho<-sum(a7.cp.ho$Victories)
av8.acp.ho<-sum(a8.cp.ho$Victories)
av9.acp.ho<-sum(a9.cp.ho$Victories)
av10.acp.ho<-sum(a10.cp.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.acp<-(sum(av1.acp.ho, av2.acp.ho, av3.acp.ho, av4.acp.ho, av5.acp.ho, av6.acp.ho, av7.acp.ho, av8.acp.ho, av9.acp.ho, av10.acp.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.acp<-(sum(int1.acp.ho, int2.acp.ho, int3.acp.ho, int4.acp.ho, int5.acp.ho, int6.acp.ho, int7.acp.ho, int8.acp.ho, int9.acp.ho, int10.acp.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.acp.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.acp.ho<-e1.acp.ho[order(e1.acp.ho$ID),]
e1.acp.ho<-as.matrix(t(e1.1.acp.ho))

e2.acp.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.acp.ho<-e2.acp.ho[order(e2.acp.ho$ID),]
e2.acp.ho<-as.matrix(t(e2.1.acp.ho))

e3.acp.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.acp.ho<-e3.acp.ho[order(e3.acp.ho$ID),]
e3.acp.ho<-as.matrix(t(e3.1.acp.ho))

e4.acp.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.acp.ho<-e4.acp.ho[order(e4.acp.ho$ID),]
e4.acp.ho<-as.matrix(t(e4.1.acp.ho))

e5.acp.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.acp.ho<-e5.acp.ho[order(e5.acp.ho$ID),]
e5.acp.ho<-as.matrix(t(e5.1.acp.ho))

e6.acp.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.acp.ho<-e6.acp.ho[order(e6.acp.ho$ID),]
e6.acp.ho<-as.matrix(t(e6.1.acp.ho))

e7.acp.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.acp.ho<-e7.acp.ho[order(e7.acp.ho$ID),]
e7.acp.ho<-as.matrix(t(e7.1.acp.ho))

e8.acp.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.acp.ho<-e8.acp.ho[order(e8.acp.ho$ID),]
e8.acp.ho<-as.matrix(t(e8.1.acp.ho))

e9.acp.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.acp.ho<-e9.acp.ho[order(e9.acp.ho$ID),]
e9.acp.ho<-as.matrix(t(e9.1.acp.ho))

e10.acp.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.acp.ho<-e10.acp.ho[order(e10.acp.ho$ID),]
e10.acp.ho<-as.matrix(t(e10.1.acp.ho))

energy.ho.acp.ho<-as.data.frame(matrix(c(e1.acp.ho,e2.acp.ho,e3.acp.ho,e4.acp.ho,e5.acp.ho,e6.acp.ho,e7.acp.ho,e8.acp.ho,e9.acp.ho,e10.acp.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.acp.ho<-data.frame(ID=energy.ho.acp.ho$V1,energy_over_distance=energy.ho.acp.ho$V2,energy_over_time=energy.ho.acp.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.acp.ho<-david1.acp.ho[order(david1.acp.ho$ID),]
david1.acp.ho<-as.matrix(t(david1.1.acp.ho))

david2.1.acp.ho<-david2.acp.ho[order(david2.acp.ho$ID),]
david2.acp.ho<-as.matrix(t(david2.1.acp.ho))

david3.1.acp.ho<-david3.acp.ho[order(david3.acp.ho$ID),]
david3.acp.ho<-as.matrix(t(david3.1.acp.ho))

david4.1.acp.ho<-david4.acp.ho[order(david4.acp.ho$ID),]
david4.acp.ho<-as.matrix(t(david4.1.acp.ho))

david5.1.acp.ho<-david5.acp.ho[order(david5.acp.ho$ID),]
david5.acp.ho<-as.matrix(t(david5.1.acp.ho))

david6.1.acp.ho<-david6.acp.ho[order(david6.acp.ho$ID),]
david6.acp.ho<-as.matrix(t(david6.1.acp.ho))

david7.1.acp.ho<-david7.acp.ho[order(david7.acp.ho$ID),]
david7.acp.ho<-as.matrix(t(david7.1.acp.ho))

david8.1.acp.ho<-david8.acp.ho[order(david8.acp.ho$ID),]
david8.acp.ho<-as.matrix(t(david8.1.acp.ho))

david9.1.acp.ho<-david9.acp.ho[order(david9.acp.ho$ID),]
david9.acp.ho<-as.matrix(t(david9.1.acp.ho))

david10.1.acp.ho<-david10.acp.ho[order(david10.acp.ho$ID),]
david10.acp.ho<-as.matrix(t(david10.1.acp.ho))

david.ho.acp.ho<-as.data.frame(matrix(c(david1.acp.ho,david2.acp.ho,david3.acp.ho,david4.acp.ho,david5.acp.ho,david6.acp.ho,david7.acp.ho,david8.acp.ho,david9.acp.ho,david10.acp.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.acp.ho<-data.frame(ID=david.ho.acp.ho$V1,DS=david.ho.acp.ho$V2,normDS=david.ho.acp.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.acp.ho<-lm(e1.1.acp.ho$energy_over_time~as.numeric(david1.1.acp.ho$normDS))
ho.lm.1.s.acp.ho<-summary(lm.ho.1.acp.ho)$coefficients
ho.1.slope.acp.ho<-ho.lm.1.s.acp.ho[2,1]
lm.ho.2.acp.ho<-lm(e2.1.acp.ho$energy_over_time~as.numeric(david2.1.acp.ho$normDS))
ho.lm.2.s.acp.ho<-summary(lm.ho.2.acp.ho)$coefficients
ho.2.slope.acp.ho<-ho.lm.2.s.acp.ho[2,1]
lm.ho.3.acp.ho<-lm(e3.1.acp.ho$energy_over_time~as.numeric(david3.1.acp.ho$normDS))
ho.lm.3.s.acp.ho<-summary(lm.ho.3.acp.ho)$coefficients
ho.3.slope.acp.ho<-ho.lm.3.s.acp.ho[2,1]
lm.ho.4.acp.ho<-lm(e4.1.acp.ho$energy_over_time~as.numeric(david4.1.acp.ho$normDS))
ho.lm.4.s.acp.ho<-summary(lm.ho.4.acp.ho)$coefficients
ho.4.slope.acp.ho<-ho.lm.4.s.acp.ho[2,1]
lm.ho.5.acp.ho<-lm(e5.1.acp.ho$energy_over_time~as.numeric(david5.1.acp.ho$normDS))
ho.lm.5.s.acp.ho<-summary(lm.ho.5.acp.ho)$coefficients
ho.5.slope.acp.ho<-ho.lm.5.s.acp.ho[2,1]
lm.ho.6.acp.ho<-lm(e6.1.acp.ho$energy_over_time~as.numeric(david6.1.acp.ho$normDS))
ho.lm.6.s.acp.ho<-summary(lm.ho.6.acp.ho)$coefficients
ho.6.slope.acp.ho<-ho.lm.6.s.acp.ho[2,1]
lm.ho.7.acp.ho<-lm(e7.1.acp.ho$energy_over_time~as.numeric(david7.1.acp.ho$normDS))
ho.lm.7.s.acp.ho<-summary(lm.ho.7.acp.ho)$coefficients
ho.7.slope.acp.ho<-ho.lm.7.s.acp.ho[2,1]
lm.ho.8.acp.ho<-lm(e8.1.acp.ho$energy_over_time~as.numeric(david8.1.acp.ho$normDS))
ho.lm.8.s.acp.ho<-summary(lm.ho.8.acp.ho)$coefficients
ho.8.slope.acp.ho<-ho.lm.8.s.acp.ho[2,1]
lm.ho.9.acp.ho<-lm(e9.1.acp.ho$energy_over_time~as.numeric(david9.1.acp.ho$normDS))
ho.lm.9.s.acp.ho<-summary(lm.ho.9.acp.ho)$coefficients
ho.9.slope.acp.ho<-ho.lm.9.s.acp.ho[2,1]
lm.ho.10.acp.ho<-lm(e10.1.acp.ho$energy_over_time~as.numeric(david10.1.acp.ho$normDS))
ho.lm.10.s.acp.ho<-summary(lm.ho.10.acp.ho)$coefficients
ho.10.slope.acp.ho<-ho.lm.10.s.acp.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.acp.ss.avoid.cp.ho<-data.frame(triangle.transitivity=c(tri1.acp.ho,tri2.acp.ho,tri3.acp.ho,tri4.acp.ho,tri5.acp.ho,tri6.acp.ho,tri7.acp.ho,tri8.acp.ho,tri9.acp.ho,tri10.acp.ho),escalation=c(ep1.acp.ho,ep2.acp.ho,ep3.acp.ho,ep4.acp.ho,ep5.acp.ho,ep6.acp.ho,ep7.acp.ho,ep8.acp.ho,ep9.acp.ho,ep10.acp.ho),dci=c(dci1.acp.ho,dci2.acp.ho,dci3.acp.ho,dci4.acp.ho,dci5.acp.ho,dci6.acp.ho,dci7.acp.ho,dci8.acp.ho,dci9.acp.ho,dci10.acp.ho),steepness=c(s1.acp.ho,s2.acp.ho,s3.acp.ho,s4.acp.ho,s5.acp.ho,s6.acp.ho,s7.acp.ho,s8.acp.ho,s9.acp.ho,s10.acp.ho),slope=c(ho.1.slope.acp.ho,ho.2.slope.acp.ho,ho.3.slope.acp.ho,ho.4.slope.acp.ho,ho.5.slope.acp.ho,ho.6.slope.acp.ho,ho.7.slope.acp.ho,ho.8.slope.acp.ho,ho.9.slope.acp.ho,ho.10.slope.acp.ho))
```
```{r Avoids Clumped Probabilistic Data Frame}
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$triangle.transitivity)
ks.acpi.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$dci)
ks.esc.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$escalation)
ks.steep.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$steepness)
ks.slope.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$slope)
ks.mean.acp.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.acp.avoid,dci=ks.acpi.acp.avoid,esc=ks.esc.acp.avoid,steepness=ks.steep.acp.avoid,slope=ks.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$triangle.transitivity)
ko.acpi.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$dci)
ko.esc.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$escalation)
ko.steep.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$steepness)
ko.slope.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$slope)
ko.mean.acp.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.acp.avoid,dci=ko.acpi.acp.avoid,esc=ko.esc.acp.avoid,steepness=ko.steep.acp.avoid,slope=ko.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$triangle.transitivity)
hs.acpi.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$dci)
hs.esc.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$escalation)
hs.steep.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$steepness)
hs.slope.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$slope)
hs.mean.acp.avoid<-data.frame(scenario="History self",tt=hs.tt.acp.avoid,dci=hs.acpi.acp.avoid,esc=hs.esc.acp.avoid,steepness=hs.steep.acp.avoid,slope=hs.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$triangle.transitivity)
ho.acpi.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$dci)
ho.esc.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$escalation)
ho.steep.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$steepness)
ho.slope.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$slope)
ho.mean.acp.avoid<-data.frame(scenario="History opponent",tt=ho.tt.acp.avoid,dci=ho.acpi.acp.avoid,esc=ho.esc.acp.avoid,steepness=ho.steep.acp.avoid,slope=ho.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,ks.mean.acp.avoid,ko.mean.acp.avoid,hm.mean.acp.avoid,hs.mean.acp.avoid,ho.mean.acp.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.acp.avoid<-mean(km.acp.ss.avoid.cp.km$triangle.transitivity)
km.acpi.acp.avoid<-mean(km.acp.ss.avoid.cp.km$dci)
km.esc.acp.avoid<-mean(km.acp.ss.avoid.cp.km$escalation)
km.steep.acp.avoid<-mean(km.acp.ss.avoid.cp.km$steepness)
km.slope.acp.avoid<-mean(km.acp.ss.avoid.cp.km$slope)
km.mean.acp.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.acp.avoid,dci=km.acpi.acp.avoid,esc=km.esc.acp.avoid,steepness=km.steep.acp.avoid,slope=km.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$triangle.transitivity)
ks.acpi.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$dci)
ks.esc.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$escalation)
ks.steep.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$steepness)
ks.slope.acp.avoid<-mean(ks.acp.ss.avoid.cp.ks$slope)
ks.mean.acp.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.acp.avoid,dci=ks.acpi.acp.avoid,esc=ks.esc.acp.avoid,steepness=ks.steep.acp.avoid,slope=ks.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$triangle.transitivity)
ko.acpi.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$dci)
ko.esc.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$escalation)
ko.steep.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$steepness)
ko.slope.acp.avoid<-mean(ko.acp.ss.avoid.cp.ko$slope)
ko.mean.acp.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.acp.avoid,dci=ko.acpi.acp.avoid,esc=ko.esc.acp.avoid,steepness=ko.steep.acp.avoid,slope=ko.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$triangle.transitivity)
hm.acpi.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$dci)
hm.esc.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$escalation)
hm.steep.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$steepness)
hm.slope.acp.avoid<-mean(hm.acp.ss.avoid.cp.hm$slope)
hm.mean.acp.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.acp.avoid,dci=hm.acpi.acp.avoid,esc=hm.esc.acp.avoid,steepness=hm.steep.acp.avoid,slope=hm.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$triangle.transitivity)
hs.acpi.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$dci)
hs.esc.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$escalation)
hs.steep.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$steepness)
hs.slope.acp.avoid<-mean(hs.acp.ss.avoid.cp.hs$slope)
hs.mean.acp.avoid<-data.frame(scenario="History self",tt=hs.tt.acp.avoid,dci=hs.acpi.acp.avoid,esc=hs.esc.acp.avoid,steepness=hs.steep.acp.avoid,slope=hs.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$triangle.transitivity)
ho.acpi.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$dci)
ho.esc.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$escalation)
ho.steep.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$steepness)
ho.slope.acp.avoid<-mean(ho.acp.ss.avoid.cp.ho$slope)
ho.mean.acp.avoid<-data.frame(scenario="History opponent",tt=ho.tt.acp.avoid,dci=ho.acpi.acp.avoid,esc=ho.esc.acp.avoid,steepness=ho.steep.acp.avoid,slope=ho.slope.acp.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.acp.avoid,ks.mean.acp.avoid,ko.mean.acp.avoid,hm.mean.acp.avoid,hs.mean.acp.avoid,ho.mean.acp.avoid)

#create overall dataframe of summary statistics
overall.prob.clumped.avoid<-data.frame(km.acp.ss.avoid.cp.km)
overall.prob.clumped.avoid<-rbind(overall.prob.clumped.avoid,ks.acp.ss.avoid.cp.ks)
overall.prob.clumped.avoid<-rbind(overall.prob.clumped.avoid,ko.acp.ss.avoid.cp.ko)
overall.prob.clumped.avoid<-rbind(overall.prob.clumped.avoid,hm.acp.ss.avoid.cp.hm)
overall.prob.clumped.avoid<-rbind(overall.prob.clumped.avoid,hs.acp.ss.avoid.cp.hs)
overall.prob.clumped.avoid<-rbind(overall.prob.clumped.avoid,ho.acp.ss.avoid.cp.ho)

overall.prob.clumped.avoid<-cbind(overall.prob.clumped.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.prob.clumped.avoid<-cbind(overall.prob.clumped.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ss.avoid<-overall.prob.clumped.avoid[overall.prob.clumped.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.clumped.avoid[overall.prob.clumped.avoid$variable=="history",]

overall.prob.clumped.avoid$combo<-paste(overall.prob.clumped.avoid$strategy,overall.prob.clumped.avoid$variable,overall.prob.clumped.avoid$distribution)
overall.prob.clumped.avoid$combo2<-paste(overall.prob.clumped.avoid$strategy,overall.prob.clumped.avoid$variable)
```

## Attacks Clumped Probabilistic Data
```{r Attacks Clumped Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.km<-sapply(files, read.csv)

# Generate attacks.atcp.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.km<-data.frame(X1=attacks.atcp.km[[1]],X2=attacks.atcp.km[[2]],Victories=attacks.atcp.km[[3]])
mat1.atcp.km<-inter.mat(mut1.atcp.km)
tri1.atcp.km<-tr.tri(mat1.atcp.km)
dci1.atcp.km<-DCindex(mat1.atcp.km)
mat1.atcp.km[is.na(mat1.atcp.km)] = 0
h1.atcp.km<-h.index(mat1.atcp.km)

ep1.atcp.km<-ep(mut1.atcp.km,a1.cp.km)
david1.atcp.km<-DS(mat1.atcp.km) #David's Scores - for steepness use normDS output
ordrank.1.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.km<-cbind(ordrank.1.atcp.km,ds=david1.atcp.km$normDS)
lm1.atcp.km<-summary(lm(ordrank.1.atcp.km$ds~ordrank.1.atcp.km$ord.rank))
s1.atcp.km<-lm1.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.km<-data.frame(X1=attacks.atcp.km[[4]],X2=attacks.atcp.km[[5]],Victories=attacks.atcp.km[[6]])
mat2.atcp.km<-inter.mat(mut2.atcp.km)
tri2.atcp.km<-tr.tri(mat2.atcp.km)
dci2.atcp.km<-DCindex(mat2.atcp.km)
mat2.atcp.km[is.na(mat2.atcp.km)] = 0
h2.atcp.km<-h.index(mat2.atcp.km)

ep2.atcp.km<-ep(mut2.atcp.km,a2.cp.km)
david2.atcp.km<-DS(mat2.atcp.km) #David's Scores - for steepness use normDS output
ordrank.2.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.km<-cbind(ordrank.2.atcp.km,ds=david2.atcp.km$normDS)
lm2.atcp.km<-summary(lm(ordrank.2.atcp.km$ds~ordrank.2.atcp.km$ord.rank))
s2.atcp.km<-lm2.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.km<-data.frame(X1=attacks.atcp.km[[7]],X2=attacks.atcp.km[[8]],Victories=attacks.atcp.km[[9]])
mat3.atcp.km<-inter.mat(mut3.atcp.km)
tri3.atcp.km<-tr.tri(mat3.atcp.km)
dci3.atcp.km<-DCindex(mat3.atcp.km)
mat3.atcp.km[is.na(mat3.atcp.km)] = 0
h3.atcp.km<-h.index(mat3.atcp.km)

ep3.atcp.km<-ep(mut3.atcp.km,a3.cp.km)
david3.atcp.km<-DS(mat3.atcp.km) #David's Scores - for steepness use normDS output
ordrank.3.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.km<-cbind(ordrank.3.atcp.km,ds=david3.atcp.km$normDS)
lm3.atcp.km<-summary(lm(ordrank.3.atcp.km$ds~ordrank.3.atcp.km$ord.rank))
s3.atcp.km<-lm3.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.km<-data.frame(X1=attacks.atcp.km[[10]],X2=attacks.atcp.km[[11]],Victories=attacks.atcp.km[[12]])
mat4.atcp.km<-inter.mat(mut4.atcp.km)
tri4.atcp.km<-tr.tri(mat4.atcp.km)
dci4.atcp.km<-DCindex(mat4.atcp.km)
mat4.atcp.km[is.na(mat4.atcp.km)] = 0
h4.atcp.km<-h.index(mat4.atcp.km)

ep4.atcp.km<-ep(mut4.atcp.km,a4.cp.km)
david4.atcp.km<-DS(mat4.atcp.km) #David's Scores - for steepness use normDS output
ordrank.4.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.km<-cbind(ordrank.4.atcp.km,ds=david4.atcp.km$normDS)
lm4.atcp.km<-summary(lm(ordrank.4.atcp.km$ds~ordrank.4.atcp.km$ord.rank))
s4.atcp.km<-lm4.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.km<-data.frame(X1=attacks.atcp.km[[13]],X2=attacks.atcp.km[[14]],Victories=attacks.atcp.km[[15]])
mat5.atcp.km<-inter.mat(mut5.atcp.km)
tri5.atcp.km<-tr.tri(mat5.atcp.km)
dci5.atcp.km<-DCindex(mat5.atcp.km)
mat5.atcp.km[is.na(mat5.atcp.km)] = 0
h5.atcp.km<-h.index(mat5.atcp.km)

ep5.atcp.km<-ep(mut5.atcp.km,a5.cp.km)
david5.atcp.km<-DS(mat5.atcp.km) #David's Scores - for steepness use normDS output
ordrank.5.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.km<-cbind(ordrank.5.atcp.km,ds=david5.atcp.km$normDS)
lm5.atcp.km<-summary(lm(ordrank.5.atcp.km$ds~ordrank.5.atcp.km$ord.rank))
s5.atcp.km<-lm5.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.km<-data.frame(X1=attacks.atcp.km[[16]],X2=attacks.atcp.km[[17]],Victories=attacks.atcp.km[[18]])
mat6.atcp.km<-inter.mat(mut6.atcp.km)
tri6.atcp.km<-tr.tri(mat6.atcp.km)
dci6.atcp.km<-DCindex(mat6.atcp.km)
mat6.atcp.km[is.na(mat6.atcp.km)] = 0
h6.atcp.km<-h.index(mat6.atcp.km)

ep6.atcp.km<-ep(mut6.atcp.km,a6.cp.km)
david6.atcp.km<-DS(mat6.atcp.km) #David's Scores - for steepness use normDS output
ordrank.6.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.km<-cbind(ordrank.6.atcp.km,ds=david6.atcp.km$normDS)
lm6.atcp.km<-summary(lm(ordrank.6.atcp.km$ds~ordrank.6.atcp.km$ord.rank))
s6.atcp.km<-lm6.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.km<-data.frame(X1=attacks.atcp.km[[19]],X2=attacks.atcp.km[[20]],Victories=attacks.atcp.km[[21]])
mat7.atcp.km<-inter.mat(mut7.atcp.km)
tri7.atcp.km<-tr.tri(mat7.atcp.km)
dci7.atcp.km<-DCindex(mat7.atcp.km)
mat7.atcp.km[is.na(mat7.atcp.km)] = 0
h7.atcp.km<-h.index(mat7.atcp.km)

ep7.atcp.km<-ep(mut7.atcp.km,a7.cp.km)
david7.atcp.km<-DS(mat7.atcp.km) #David's Scores - for steepness use normDS output
ordrank.7.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.km<-cbind(ordrank.7.atcp.km,ds=david7.atcp.km$normDS)
lm7.atcp.km<-summary(lm(ordrank.7.atcp.km$ds~ordrank.7.atcp.km$ord.rank))
s7.atcp.km<-lm7.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.km<-data.frame(X1=attacks.atcp.km[[22]],X2=attacks.atcp.km[[23]],Victories=attacks.atcp.km[[24]])
mat8.atcp.km<-inter.mat(mut8.atcp.km)
tri8.atcp.km<-tr.tri(mat8.atcp.km)
dci8.atcp.km<-DCindex(mat8.atcp.km)
mat8.atcp.km[is.na(mat8.atcp.km)] = 0
h8.atcp.km<-h.index(mat8.atcp.km)

ep8.atcp.km<-ep(mut8.atcp.km,a8.cp.km)
david8.atcp.km<-DS(mat8.atcp.km) #David's Scores - for steepness use normDS output
ordrank.8.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.km<-cbind(ordrank.8.atcp.km,ds=david8.atcp.km$normDS)
lm8.atcp.km<-summary(lm(ordrank.8.atcp.km$ds~ordrank.8.atcp.km$ord.rank))
s8.atcp.km<-lm8.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.km<-data.frame(X1=attacks.atcp.km[[25]],X2=attacks.atcp.km[[26]],Victories=attacks.atcp.km[[27]])
mat9.atcp.km<-inter.mat(mut9.atcp.km)
tri9.atcp.km<-tr.tri(mat9.atcp.km)
dci9.atcp.km<-DCindex(mat9.atcp.km)
mat9.atcp.km[is.na(mat9.atcp.km)] = 0
h9.atcp.km<-h.index(mat9.atcp.km)

ep9.atcp.km<-ep(mut9.atcp.km,a9.cp.km)
david9.atcp.km<-DS(mat9.atcp.km) #David's Scores - for steepness use normDS output
ordrank.9.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.km<-cbind(ordrank.9.atcp.km,ds=david9.atcp.km$normDS)
lm9.atcp.km<-summary(lm(ordrank.9.atcp.km$ds~ordrank.9.atcp.km$ord.rank))
s9.atcp.km<-lm9.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.km<-data.frame(X1=attacks.atcp.km[[28]],X2=attacks.atcp.km[[29]],Victories=attacks.atcp.km[[30]])
mat10.atcp.km<-inter.mat(mut10.atcp.km)
tri10.atcp.km<-tr.tri(mat10.atcp.km)
dci10.atcp.km<-DCindex(mat10.atcp.km)
mat10.atcp.km[is.na(mat10.atcp.km)] = 0
h10.atcp.km<-h.index(mat10.atcp.km)

ep10.atcp.km<-ep(mut10.atcp.km,a10.cp.km)
david10.atcp.km<-DS(mat10.atcp.km) #David's Scores - for steepness use normDS output
ordrank.10.atcp.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.km<-cbind(ordrank.10.atcp.km,ds=david10.atcp.km$normDS)
lm10.atcp.km<-summary(lm(ordrank.10.atcp.km$ds~ordrank.10.atcp.km$ord.rank))
s10.atcp.km<-lm10.atcp.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.km<-sum(mut1.atcp.km$Victories)
int2.atcp.km<-sum(mut2.atcp.km$Victories)
int3.atcp.km<-sum(mut3.atcp.km$Victories)
int4.atcp.km<-sum(mut4.atcp.km$Victories)
int5.atcp.km<-sum(mut5.atcp.km$Victories)
int6.atcp.km<-sum(mut6.atcp.km$Victories)
int7.atcp.km<-sum(mut7.atcp.km$Victories)
int8.atcp.km<-sum(mut8.atcp.km$Victories)
int9.atcp.km<-sum(mut9.atcp.km$Victories)
int10.atcp.km<-sum(mut10.atcp.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.km<-sum(a1.cp.km$Victories)
av2.cp.km<-sum(a2.cp.km$Victories)
av3.cp.km<-sum(a3.cp.km$Victories)
av4.cp.km<-sum(a4.cp.km$Victories)
av5.cp.km<-sum(a5.cp.km$Victories)
av6.cp.km<-sum(a6.cp.km$Victories)
av7.cp.km<-sum(a7.cp.km$Victories)
av8.cp.km<-sum(a8.cp.km$Victories)
av9.cp.km<-sum(a9.cp.km$Victories)
av10.cp.km<-sum(a10.cp.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.pc<-(sum(av1.cp.km, av2.cp.km, av3.cp.km, av4.cp.km, av5.cp.km, av6.cp.km, av7.cp.km, av8.cp.km, av9.cp.km, av10.cp.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.pc<-(sum(int1.atcp.km, int2.atcp.km, int3.atcp.km, int4.atcp.km, int5.atcp.km, int6.atcp.km, int7.atcp.km, int8.atcp.km, int9.atcp.km, int10.atcp.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.km<-e1.atcp.km[order(e1.atcp.km$ID),]
e1.atcp.km<-as.matrix(t(e1.1.atcp.km))

e2.atcp.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.km<-e2.atcp.km[order(e2.atcp.km$ID),]
e2.atcp.km<-as.matrix(t(e2.1.atcp.km))

e3.atcp.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.km<-e3.atcp.km[order(e3.atcp.km$ID),]
e3.atcp.km<-as.matrix(t(e3.1.atcp.km))

e4.atcp.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.km<-e4.atcp.km[order(e4.atcp.km$ID),]
e4.atcp.km<-as.matrix(t(e4.1.atcp.km))

e5.atcp.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.km<-e5.atcp.km[order(e5.atcp.km$ID),]
e5.atcp.km<-as.matrix(t(e5.1.atcp.km))

e6.atcp.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.km<-e6.atcp.km[order(e6.atcp.km$ID),]
e6.atcp.km<-as.matrix(t(e6.1.atcp.km))

e7.atcp.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.km<-e7.atcp.km[order(e7.atcp.km$ID),]
e7.atcp.km<-as.matrix(t(e7.1.atcp.km))

e8.atcp.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.km<-e8.atcp.km[order(e8.atcp.km$ID),]
e8.atcp.km<-as.matrix(t(e8.1.atcp.km))

e9.atcp.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.km<-e9.atcp.km[order(e9.atcp.km$ID),]
e9.atcp.km<-as.matrix(t(e9.1.atcp.km))

e10.atcp.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.km<-e10.atcp.km[order(e10.atcp.km$ID),]
e10.atcp.km<-as.matrix(t(e10.1.atcp.km))

energy.km.atcp.km<-as.data.frame(matrix(c(e1.atcp.km,e2.atcp.km,e3.atcp.km,e4.atcp.km,e5.atcp.km,e6.atcp.km,e7.atcp.km,e8.atcp.km,e9.atcp.km,e10.atcp.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atcp.km<-data.frame(ID=energy.km.atcp.km$V1,energy_over_distance=energy.km.atcp.km$V2,energy_over_time=energy.km.atcp.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.km<-david1.atcp.km[order(david1.atcp.km$ID),]
david1.atcp.km<-as.matrix(t(david1.1.atcp.km))

david2.1.atcp.km<-david2.atcp.km[order(david2.atcp.km$ID),]
david2.atcp.km<-as.matrix(t(david2.1.atcp.km))

david3.1.atcp.km<-david3.atcp.km[order(david3.atcp.km$ID),]
david3.atcp.km<-as.matrix(t(david3.1.atcp.km))

david4.1.atcp.km<-david4.atcp.km[order(david4.atcp.km$ID),]
david4.atcp.km<-as.matrix(t(david4.1.atcp.km))

david5.1.atcp.km<-david5.atcp.km[order(david5.atcp.km$ID),]
david5.atcp.km<-as.matrix(t(david5.1.atcp.km))

david6.1.atcp.km<-david6.atcp.km[order(david6.atcp.km$ID),]
david6.atcp.km<-as.matrix(t(david6.1.atcp.km))

david7.1.atcp.km<-david7.atcp.km[order(david7.atcp.km$ID),]
david7.atcp.km<-as.matrix(t(david7.1.atcp.km))

david8.1.atcp.km<-david8.atcp.km[order(david8.atcp.km$ID),]
david8.atcp.km<-as.matrix(t(david8.1.atcp.km))

david9.1.atcp.km<-david9.atcp.km[order(david9.atcp.km$ID),]
david9.atcp.km<-as.matrix(t(david9.1.atcp.km))

david10.1.atcp.km<-david10.atcp.km[order(david10.atcp.km$ID),]
david10.atcp.km<-as.matrix(t(david10.1.atcp.km))

david.km.atcp.km<-as.data.frame(matrix(c(david1.atcp.km,david2.atcp.km,david3.atcp.km,david4.atcp.km,david5.atcp.km,david6.atcp.km,david7.atcp.km,david8.atcp.km,david9.atcp.km,david10.atcp.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atcp.km<-data.frame(ID=david.km.atcp.km$V1,DS=david.km.atcp.km$V2,normDS=david.km.atcp.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atcp.km<-lm(e1.1.atcp.km$energy_over_time~as.numeric(david1.1.atcp.km$normDS))
km.lm.1.s.atcp.km<-summary(lm.km.1.atcp.km)$coefficients
km.1.slope.atcp.km<-km.lm.1.s.atcp.km[2,1]
lm.km.2.atcp.km<-lm(e2.1.atcp.km$energy_over_time~as.numeric(david2.1.atcp.km$normDS))
km.lm.2.s.atcp.km<-summary(lm.km.2.atcp.km)$coefficients
km.2.slope.atcp.km<-km.lm.2.s.atcp.km[2,1]
lm.km.3.atcp.km<-lm(e3.1.atcp.km$energy_over_time~as.numeric(david3.1.atcp.km$normDS))
km.lm.3.s.atcp.km<-summary(lm.km.3.atcp.km)$coefficients
km.3.slope.atcp.km<-km.lm.3.s.atcp.km[2,1]
lm.km.4.atcp.km<-lm(e4.1.atcp.km$energy_over_time~as.numeric(david4.1.atcp.km$normDS))
km.lm.4.s.atcp.km<-summary(lm.km.4.atcp.km)$coefficients
km.4.slope.atcp.km<-km.lm.4.s.atcp.km[2,1]
lm.km.5.atcp.km<-lm(e5.1.atcp.km$energy_over_time~as.numeric(david5.1.atcp.km$normDS))
km.lm.5.s.atcp.km<-summary(lm.km.5.atcp.km)$coefficients
km.5.slope.atcp.km<-km.lm.5.s.atcp.km[2,1]
lm.km.6.atcp.km<-lm(e6.1.atcp.km$energy_over_time~as.numeric(david6.1.atcp.km$normDS))
km.lm.6.s.atcp.km<-summary(lm.km.6.atcp.km)$coefficients
km.6.slope.atcp.km<-km.lm.6.s.atcp.km[2,1]
lm.km.7.atcp.km<-lm(e7.1.atcp.km$energy_over_time~as.numeric(david7.1.atcp.km$normDS))
km.lm.7.s.atcp.km<-summary(lm.km.7.atcp.km)$coefficients
km.7.slope.atcp.km<-km.lm.7.s.atcp.km[2,1]
lm.km.8.atcp.km<-lm(e8.1.atcp.km$energy_over_time~as.numeric(david8.1.atcp.km$normDS))
km.lm.8.s.atcp.km<-summary(lm.km.8.atcp.km)$coefficients
km.8.slope.atcp.km<-km.lm.8.s.atcp.km[2,1]
lm.km.9.atcp.km<-lm(e9.1.atcp.km$energy_over_time~as.numeric(david9.1.atcp.km$normDS))
km.lm.9.s.atcp.km<-summary(lm.km.9.atcp.km)$coefficients
km.9.slope.atcp.km<-km.lm.9.s.atcp.km[2,1]
lm.km.10.atcp.km<-lm(e10.1.atcp.km$energy_over_time~as.numeric(david10.1.atcp.km$normDS))
km.lm.10.s.atcp.km<-summary(lm.km.10.atcp.km)$coefficients
km.10.slope.atcp.km<-km.lm.10.s.atcp.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atcp.ss.attacks.atcp.km<-data.frame(triangle.transitivity=c(tri1.atcp.km,tri2.atcp.km,tri3.atcp.km,tri4.atcp.km,tri5.atcp.km,tri6.atcp.km,tri7.atcp.km,tri8.atcp.km,tri9.atcp.km,tri10.atcp.km),escalation=c(ep1.atcp.km,ep2.atcp.km,ep3.atcp.km,ep4.atcp.km,ep5.atcp.km,ep6.atcp.km,ep7.atcp.km,ep8.atcp.km,ep9.atcp.km,ep10.atcp.km),dci=c(dci1.atcp.km,dci2.atcp.km,dci3.atcp.km,dci4.atcp.km,dci5.atcp.km,dci6.atcp.km,dci7.atcp.km,dci8.atcp.km,dci9.atcp.km,dci10.atcp.km),steepness=c(s1.atcp.km,s2.atcp.km,s3.atcp.km,s4.atcp.km,s5.atcp.km,s6.atcp.km,s7.atcp.km,s8.atcp.km,s9.atcp.km,s10.atcp.km),slope=c(km.1.slope.atcp.km,km.2.slope.atcp.km,km.3.slope.atcp.km,km.4.slope.atcp.km,km.5.slope.atcp.km,km.6.slope.atcp.km,km.7.slope.atcp.km,km.8.slope.atcp.km,km.9.slope.atcp.km,km.10.slope.atcp.km))


#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.ks<-sapply(files, read.csv)

# Generate attacks.atcp.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.ks<-data.frame(X1=attacks.atcp.ks[[1]],X2=attacks.atcp.ks[[2]],Victories=attacks.atcp.ks[[3]])
mat1.atcp.ks<-inter.mat(mut1.atcp.ks)
tri1.atcp.ks<-tr.tri(mat1.atcp.ks)
dci1.atcp.ks<-DCindex(mat1.atcp.ks)
mat1.atcp.ks[is.na(mat1.atcp.ks)] = 0
h1.atcp.ks<-h.index(mat1.atcp.ks)

ep1.atcp.ks<-ep(mut1.atcp.ks,a1.cp.ks)
david1.atcp.ks<-DS(mat1.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.1.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.ks<-cbind(ordrank.1.atcp.ks,ds=david1.atcp.ks$normDS)
lm1.atcp.ks<-summary(lm(ordrank.1.atcp.ks$ds~ordrank.1.atcp.ks$ord.rank))
s1.atcp.ks<-lm1.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.ks<-data.frame(X1=attacks.atcp.ks[[4]],X2=attacks.atcp.ks[[5]],Victories=attacks.atcp.ks[[6]])
mat2.atcp.ks<-inter.mat(mut2.atcp.ks)
tri2.atcp.ks<-tr.tri(mat2.atcp.ks)
dci2.atcp.ks<-DCindex(mat2.atcp.ks)
mat2.atcp.ks[is.na(mat2.atcp.ks)] = 0
h2.atcp.ks<-h.index(mat2.atcp.ks)

ep2.atcp.ks<-ep(mut2.atcp.ks,a2.cp.ks)
david2.atcp.ks<-DS(mat2.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.2.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.ks<-cbind(ordrank.2.atcp.ks,ds=david2.atcp.ks$normDS)
lm2.atcp.ks<-summary(lm(ordrank.2.atcp.ks$ds~ordrank.2.atcp.ks$ord.rank))
s2.atcp.ks<-lm2.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.ks<-data.frame(X1=attacks.atcp.ks[[7]],X2=attacks.atcp.ks[[8]],Victories=attacks.atcp.ks[[9]])
mat3.atcp.ks<-inter.mat(mut3.atcp.ks)
tri3.atcp.ks<-tr.tri(mat3.atcp.ks)
dci3.atcp.ks<-DCindex(mat3.atcp.ks)
mat3.atcp.ks[is.na(mat3.atcp.ks)] = 0
h3.atcp.ks<-h.index(mat3.atcp.ks)

ep3.atcp.ks<-ep(mut3.atcp.ks,a3.cp.ks)
david3.atcp.ks<-DS(mat3.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.3.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.ks<-cbind(ordrank.3.atcp.ks,ds=david3.atcp.ks$normDS)
lm3.atcp.ks<-summary(lm(ordrank.3.atcp.ks$ds~ordrank.3.atcp.ks$ord.rank))
s3.atcp.ks<-lm3.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.ks<-data.frame(X1=attacks.atcp.ks[[10]],X2=attacks.atcp.ks[[11]],Victories=attacks.atcp.ks[[12]])
mat4.atcp.ks<-inter.mat(mut4.atcp.ks)
tri4.atcp.ks<-tr.tri(mat4.atcp.ks)
dci4.atcp.ks<-DCindex(mat4.atcp.ks)
mat4.atcp.ks[is.na(mat4.atcp.ks)] = 0
h4.atcp.ks<-h.index(mat4.atcp.ks)

ep4.atcp.ks<-ep(mut4.atcp.ks,a4.cp.ks)
david4.atcp.ks<-DS(mat4.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.4.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.ks<-cbind(ordrank.4.atcp.ks,ds=david4.atcp.ks$normDS)
lm4.atcp.ks<-summary(lm(ordrank.4.atcp.ks$ds~ordrank.4.atcp.ks$ord.rank))
s4.atcp.ks<-lm4.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.ks<-data.frame(X1=attacks.atcp.ks[[13]],X2=attacks.atcp.ks[[14]],Victories=attacks.atcp.ks[[15]])
mat5.atcp.ks<-inter.mat(mut5.atcp.ks)
tri5.atcp.ks<-tr.tri(mat5.atcp.ks)
dci5.atcp.ks<-DCindex(mat5.atcp.ks)
mat5.atcp.ks[is.na(mat5.atcp.ks)] = 0
h5.atcp.ks<-h.index(mat5.atcp.ks)

ep5.atcp.ks<-ep(mut5.atcp.ks,a5.cp.ks)
david5.atcp.ks<-DS(mat5.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.5.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.ks<-cbind(ordrank.5.atcp.ks,ds=david5.atcp.ks$normDS)
lm5.atcp.ks<-summary(lm(ordrank.5.atcp.ks$ds~ordrank.5.atcp.ks$ord.rank))
s5.atcp.ks<-lm5.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.ks<-data.frame(X1=attacks.atcp.ks[[16]],X2=attacks.atcp.ks[[17]],Victories=attacks.atcp.ks[[18]])
mat6.atcp.ks<-inter.mat(mut6.atcp.ks)
tri6.atcp.ks<-tr.tri(mat6.atcp.ks)
dci6.atcp.ks<-DCindex(mat6.atcp.ks)
mat6.atcp.ks[is.na(mat6.atcp.ks)] = 0
h6.atcp.ks<-h.index(mat6.atcp.ks)

ep6.atcp.ks<-ep(mut6.atcp.ks,a6.cp.ks)
david6.atcp.ks<-DS(mat6.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.6.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.ks<-cbind(ordrank.6.atcp.ks,ds=david6.atcp.ks$normDS)
lm6.atcp.ks<-summary(lm(ordrank.6.atcp.ks$ds~ordrank.6.atcp.ks$ord.rank))
s6.atcp.ks<-lm6.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.ks<-data.frame(X1=attacks.atcp.ks[[19]],X2=attacks.atcp.ks[[20]],Victories=attacks.atcp.ks[[21]])
mat7.atcp.ks<-inter.mat(mut7.atcp.ks)
tri7.atcp.ks<-tr.tri(mat7.atcp.ks)
dci7.atcp.ks<-DCindex(mat7.atcp.ks)
mat7.atcp.ks[is.na(mat7.atcp.ks)] = 0
h7.atcp.ks<-h.index(mat7.atcp.ks)

ep7.atcp.ks<-ep(mut7.atcp.ks,a7.cp.ks)
david7.atcp.ks<-DS(mat7.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.7.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.ks<-cbind(ordrank.7.atcp.ks,ds=david7.atcp.ks$normDS)
lm7.atcp.ks<-summary(lm(ordrank.7.atcp.ks$ds~ordrank.7.atcp.ks$ord.rank))
s7.atcp.ks<-lm7.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.ks<-data.frame(X1=attacks.atcp.ks[[22]],X2=attacks.atcp.ks[[23]],Victories=attacks.atcp.ks[[24]])
mat8.atcp.ks<-inter.mat(mut8.atcp.ks)
tri8.atcp.ks<-tr.tri(mat8.atcp.ks)
dci8.atcp.ks<-DCindex(mat8.atcp.ks)
mat8.atcp.ks[is.na(mat8.atcp.ks)] = 0
h8.atcp.ks<-h.index(mat8.atcp.ks)

ep8.atcp.ks<-ep(mut8.atcp.ks,a8.cp.ks)
david8.atcp.ks<-DS(mat8.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.8.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.ks<-cbind(ordrank.8.atcp.ks,ds=david8.atcp.ks$normDS)
lm8.atcp.ks<-summary(lm(ordrank.8.atcp.ks$ds~ordrank.8.atcp.ks$ord.rank))
s8.atcp.ks<-lm8.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.ks<-data.frame(X1=attacks.atcp.ks[[25]],X2=attacks.atcp.ks[[26]],Victories=attacks.atcp.ks[[27]])
mat9.atcp.ks<-inter.mat(mut9.atcp.ks)
tri9.atcp.ks<-tr.tri(mat9.atcp.ks)
dci9.atcp.ks<-DCindex(mat9.atcp.ks)
mat9.atcp.ks[is.na(mat9.atcp.ks)] = 0
h9.atcp.ks<-h.index(mat9.atcp.ks)

ep9.atcp.ks<-ep(mut9.atcp.ks,a9.cp.ks)
david9.atcp.ks<-DS(mat9.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.9.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.ks<-cbind(ordrank.9.atcp.ks,ds=david9.atcp.ks$normDS)
lm9.atcp.ks<-summary(lm(ordrank.9.atcp.ks$ds~ordrank.9.atcp.ks$ord.rank))
s9.atcp.ks<-lm9.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.ks<-data.frame(X1=attacks.atcp.ks[[28]],X2=attacks.atcp.ks[[29]],Victories=attacks.atcp.ks[[30]])
mat10.atcp.ks<-inter.mat(mut10.atcp.ks)
tri10.atcp.ks<-tr.tri(mat10.atcp.ks)
dci10.atcp.ks<-DCindex(mat10.atcp.ks)
mat10.atcp.ks[is.na(mat10.atcp.ks)] = 0
h10.atcp.ks<-h.index(mat10.atcp.ks)

ep10.atcp.ks<-ep(mut10.atcp.ks,a10.cp.ks)
david10.atcp.ks<-DS(mat10.atcp.ks) #David's Scores - for steepness use normDS output
ordrank.10.atcp.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.ks<-cbind(ordrank.10.atcp.ks,ds=david10.atcp.ks$normDS)
lm10.atcp.ks<-summary(lm(ordrank.10.atcp.ks$ds~ordrank.10.atcp.ks$ord.rank))
s10.atcp.ks<-lm10.atcp.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.ks<-sum(mut1.atcp.ks$Victories)
int2.atcp.ks<-sum(mut2.atcp.ks$Victories)
int3.atcp.ks<-sum(mut3.atcp.ks$Victories)
int4.atcp.ks<-sum(mut4.atcp.ks$Victories)
int5.atcp.ks<-sum(mut5.atcp.ks$Victories)
int6.atcp.ks<-sum(mut6.atcp.ks$Victories)
int7.atcp.ks<-sum(mut7.atcp.ks$Victories)
int8.atcp.ks<-sum(mut8.atcp.ks$Victories)
int9.atcp.ks<-sum(mut9.atcp.ks$Victories)
int10.atcp.ks<-sum(mut10.atcp.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ks<-sum(a1.cp.ks$Victories)
av2.cp.ks<-sum(a2.cp.ks$Victories)
av3.cp.ks<-sum(a3.cp.ks$Victories)
av4.cp.ks<-sum(a4.cp.ks$Victories)
av5.cp.ks<-sum(a5.cp.ks$Victories)
av6.cp.ks<-sum(a6.cp.ks$Victories)
av7.cp.ks<-sum(a7.cp.ks$Victories)
av8.cp.ks<-sum(a8.cp.ks$Victories)
av9.cp.ks<-sum(a9.cp.ks$Victories)
av10.cp.ks<-sum(a10.cp.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.pc<-(sum(av1.cp.ks, av2.cp.ks, av3.cp.ks, av4.cp.ks, av5.cp.ks, av6.cp.ks, av7.cp.ks, av8.cp.ks, av9.cp.ks, av10.cp.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.pc<-(sum(int1.atcp.ks, int2.atcp.ks, int3.atcp.ks, int4.atcp.ks, int5.atcp.ks, int6.atcp.ks, int7.atcp.ks, int8.atcp.ks, int9.atcp.ks, int10.atcp.ks))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.ks<-e1.atcp.ks[order(e1.atcp.ks$ID),]
e1.atcp.ks<-as.matrix(t(e1.1.atcp.ks))

e2.atcp.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.ks<-e2.atcp.ks[order(e2.atcp.ks$ID),]
e2.atcp.ks<-as.matrix(t(e2.1.atcp.ks))

e3.atcp.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.ks<-e3.atcp.ks[order(e3.atcp.ks$ID),]
e3.atcp.ks<-as.matrix(t(e3.1.atcp.ks))

e4.atcp.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.ks<-e4.atcp.ks[order(e4.atcp.ks$ID),]
e4.atcp.ks<-as.matrix(t(e4.1.atcp.ks))

e5.atcp.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.ks<-e5.atcp.ks[order(e5.atcp.ks$ID),]
e5.atcp.ks<-as.matrix(t(e5.1.atcp.ks))

e6.atcp.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.ks<-e6.atcp.ks[order(e6.atcp.ks$ID),]
e6.atcp.ks<-as.matrix(t(e6.1.atcp.ks))

e7.atcp.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.ks<-e7.atcp.ks[order(e7.atcp.ks$ID),]
e7.atcp.ks<-as.matrix(t(e7.1.atcp.ks))

e8.atcp.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.ks<-e8.atcp.ks[order(e8.atcp.ks$ID),]
e8.atcp.ks<-as.matrix(t(e8.1.atcp.ks))

e9.atcp.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.ks<-e9.atcp.ks[order(e9.atcp.ks$ID),]
e9.atcp.ks<-as.matrix(t(e9.1.atcp.ks))

e10.atcp.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.ks<-e10.atcp.ks[order(e10.atcp.ks$ID),]
e10.atcp.ks<-as.matrix(t(e10.1.atcp.ks))

energy.ks.atcp.ks<-as.data.frame(matrix(c(e1.atcp.ks,e2.atcp.ks,e3.atcp.ks,e4.atcp.ks,e5.atcp.ks,e6.atcp.ks,e7.atcp.ks,e8.atcp.ks,e9.atcp.ks,e10.atcp.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.atcp.ks<-data.frame(ID=energy.ks.atcp.ks$V1,energy_over_distance=energy.ks.atcp.ks$V2,energy_over_time=energy.ks.atcp.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.ks<-david1.atcp.ks[order(david1.atcp.ks$ID),]
david1.atcp.ks<-as.matrix(t(david1.1.atcp.ks))

david2.1.atcp.ks<-david2.atcp.ks[order(david2.atcp.ks$ID),]
david2.atcp.ks<-as.matrix(t(david2.1.atcp.ks))

david3.1.atcp.ks<-david3.atcp.ks[order(david3.atcp.ks$ID),]
david3.atcp.ks<-as.matrix(t(david3.1.atcp.ks))

david4.1.atcp.ks<-david4.atcp.ks[order(david4.atcp.ks$ID),]
david4.atcp.ks<-as.matrix(t(david4.1.atcp.ks))

david5.1.atcp.ks<-david5.atcp.ks[order(david5.atcp.ks$ID),]
david5.atcp.ks<-as.matrix(t(david5.1.atcp.ks))

david6.1.atcp.ks<-david6.atcp.ks[order(david6.atcp.ks$ID),]
david6.atcp.ks<-as.matrix(t(david6.1.atcp.ks))

david7.1.atcp.ks<-david7.atcp.ks[order(david7.atcp.ks$ID),]
david7.atcp.ks<-as.matrix(t(david7.1.atcp.ks))

david8.1.atcp.ks<-david8.atcp.ks[order(david8.atcp.ks$ID),]
david8.atcp.ks<-as.matrix(t(david8.1.atcp.ks))

david9.1.atcp.ks<-david9.atcp.ks[order(david9.atcp.ks$ID),]
david9.atcp.ks<-as.matrix(t(david9.1.atcp.ks))

david10.1.atcp.ks<-david10.atcp.ks[order(david10.atcp.ks$ID),]
david10.atcp.ks<-as.matrix(t(david10.1.atcp.ks))

david.ks.atcp.ks<-as.data.frame(matrix(c(david1.atcp.ks,david2.atcp.ks,david3.atcp.ks,david4.atcp.ks,david5.atcp.ks,david6.atcp.ks,david7.atcp.ks,david8.atcp.ks,david9.atcp.ks,david10.atcp.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.atcp.ks<-data.frame(ID=david.ks.atcp.ks$V1,DS=david.ks.atcp.ks$V2,normDS=david.ks.atcp.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.atcp.ks<-lm(e1.1.atcp.ks$energy_over_time~as.numeric(david1.1.atcp.ks$normDS))
ks.lm.1.s.atcp.ks<-summary(lm.ks.1.atcp.ks)$coefficients
ks.1.slope.atcp.ks<-ks.lm.1.s.atcp.ks[2,1]
lm.ks.2.atcp.ks<-lm(e2.1.atcp.ks$energy_over_time~as.numeric(david2.1.atcp.ks$normDS))
ks.lm.2.s.atcp.ks<-summary(lm.ks.2.atcp.ks)$coefficients
ks.2.slope.atcp.ks<-ks.lm.2.s.atcp.ks[2,1]
lm.ks.3.atcp.ks<-lm(e3.1.atcp.ks$energy_over_time~as.numeric(david3.1.atcp.ks$normDS))
ks.lm.3.s.atcp.ks<-summary(lm.ks.3.atcp.ks)$coefficients
ks.3.slope.atcp.ks<-ks.lm.3.s.atcp.ks[2,1]
lm.ks.4.atcp.ks<-lm(e4.1.atcp.ks$energy_over_time~as.numeric(david4.1.atcp.ks$normDS))
ks.lm.4.s.atcp.ks<-summary(lm.ks.4.atcp.ks)$coefficients
ks.4.slope.atcp.ks<-ks.lm.4.s.atcp.ks[2,1]
lm.ks.5.atcp.ks<-lm(e5.1.atcp.ks$energy_over_time~as.numeric(david5.1.atcp.ks$normDS))
ks.lm.5.s.atcp.ks<-summary(lm.ks.5.atcp.ks)$coefficients
ks.5.slope.atcp.ks<-ks.lm.5.s.atcp.ks[2,1]
lm.ks.6.atcp.ks<-lm(e6.1.atcp.ks$energy_over_time~as.numeric(david6.1.atcp.ks$normDS))
ks.lm.6.s.atcp.ks<-summary(lm.ks.6.atcp.ks)$coefficients
ks.6.slope.atcp.ks<-ks.lm.6.s.atcp.ks[2,1]
lm.ks.7.atcp.ks<-lm(e7.1.atcp.ks$energy_over_time~as.numeric(david7.1.atcp.ks$normDS))
ks.lm.7.s.atcp.ks<-summary(lm.ks.7.atcp.ks)$coefficients
ks.7.slope.atcp.ks<-ks.lm.7.s.atcp.ks[2,1]
lm.ks.8.atcp.ks<-lm(e8.1.atcp.ks$energy_over_time~as.numeric(david8.1.atcp.ks$normDS))
ks.lm.8.s.atcp.ks<-summary(lm.ks.8.atcp.ks)$coefficients
ks.8.slope.atcp.ks<-ks.lm.8.s.atcp.ks[2,1]
lm.ks.9.atcp.ks<-lm(e9.1.atcp.ks$energy_over_time~as.numeric(david9.1.atcp.ks$normDS))
ks.lm.9.s.atcp.ks<-summary(lm.ks.9.atcp.ks)$coefficients
ks.9.slope.atcp.ks<-ks.lm.9.s.atcp.ks[2,1]
lm.ks.10.atcp.ks<-lm(e10.1.atcp.ks$energy_over_time~as.numeric(david10.1.atcp.ks$normDS))
ks.lm.10.s.atcp.ks<-summary(lm.ks.10.atcp.ks)$coefficients
ks.10.slope.atcp.ks<-ks.lm.10.s.atcp.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.atcp.ss.attacks.atcp.ks<-data.frame(triangle.transitivity=c(tri1.atcp.ks,tri2.atcp.ks,tri3.atcp.ks,tri4.atcp.ks,tri5.atcp.ks,tri6.atcp.ks,tri7.atcp.ks,tri8.atcp.ks,tri9.atcp.ks,tri10.atcp.ks),escalation=c(ep1.atcp.ks,ep2.atcp.ks,ep3.atcp.ks,ep4.atcp.ks,ep5.atcp.ks,ep6.atcp.ks,ep7.atcp.ks,ep8.atcp.ks,ep9.atcp.ks,ep10.atcp.ks),dci=c(dci1.atcp.ks,dci2.atcp.ks,dci3.atcp.ks,dci4.atcp.ks,dci5.atcp.ks,dci6.atcp.ks,dci7.atcp.ks,dci8.atcp.ks,dci9.atcp.ks,dci10.atcp.ks),steepness=c(s1.atcp.ks,s2.atcp.ks,s3.atcp.ks,s4.atcp.ks,s5.atcp.ks,s6.atcp.ks,s7.atcp.ks,s8.atcp.ks,s9.atcp.ks,s10.atcp.ks),slope=c(ks.1.slope.atcp.ks,ks.2.slope.atcp.ks,ks.3.slope.atcp.ks,ks.4.slope.atcp.ks,ks.5.slope.atcp.ks,ks.6.slope.atcp.ks,ks.7.slope.atcp.ks,ks.8.slope.atcp.ks,ks.9.slope.atcp.ks,ks.10.slope.atcp.ks))


#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Opponent Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.ko<-sapply(files, read.csv)

# Generate attacks.atcp.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.ko<-data.frame(X1=attacks.atcp.ko[[1]],X2=attacks.atcp.ko[[2]],Victories=attacks.atcp.ko[[3]])
mat1.atcp.ko<-inter.mat(mut1.atcp.ko)
tri1.atcp.ko<-tr.tri(mat1.atcp.ko)
dci1.atcp.ko<-DCindex(mat1.atcp.ko)
mat1.atcp.ko[is.na(mat1.atcp.ko)] = 0
h1.atcp.ko<-h.index(mat1.atcp.ko)

ep1.atcp.ko<-ep(mut1.atcp.ko,a1.cp.ko)
david1.atcp.ko<-DS(mat1.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.1.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.ko<-cbind(ordrank.1.atcp.ko,ds=david1.atcp.ko$normDS)
lm1.atcp.ko<-summary(lm(ordrank.1.atcp.ko$ds~ordrank.1.atcp.ko$ord.rank))
s1.atcp.ko<-lm1.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.ko<-data.frame(X1=attacks.atcp.ko[[4]],X2=attacks.atcp.ko[[5]],Victories=attacks.atcp.ko[[6]])
mat2.atcp.ko<-inter.mat(mut2.atcp.ko)
tri2.atcp.ko<-tr.tri(mat2.atcp.ko)
dci2.atcp.ko<-DCindex(mat2.atcp.ko)
mat2.atcp.ko[is.na(mat2.atcp.ko)] = 0
h2.atcp.ko<-h.index(mat2.atcp.ko)

ep2.atcp.ko<-ep(mut2.atcp.ko,a2.cp.ko)
david2.atcp.ko<-DS(mat2.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.2.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.ko<-cbind(ordrank.2.atcp.ko,ds=david2.atcp.ko$normDS)
lm2.atcp.ko<-summary(lm(ordrank.2.atcp.ko$ds~ordrank.2.atcp.ko$ord.rank))
s2.atcp.ko<-lm2.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.ko<-data.frame(X1=attacks.atcp.ko[[7]],X2=attacks.atcp.ko[[8]],Victories=attacks.atcp.ko[[9]])
mat3.atcp.ko<-inter.mat(mut3.atcp.ko)
tri3.atcp.ko<-tr.tri(mat3.atcp.ko)
dci3.atcp.ko<-DCindex(mat3.atcp.ko)
mat3.atcp.ko[is.na(mat3.atcp.ko)] = 0
h3.atcp.ko<-h.index(mat3.atcp.ko)

ep3.atcp.ko<-ep(mut3.atcp.ko,a3.cp.ko)
david3.atcp.ko<-DS(mat3.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.3.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.ko<-cbind(ordrank.3.atcp.ko,ds=david3.atcp.ko$normDS)
lm3.atcp.ko<-summary(lm(ordrank.3.atcp.ko$ds~ordrank.3.atcp.ko$ord.rank))
s3.atcp.ko<-lm3.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.ko<-data.frame(X1=attacks.atcp.ko[[10]],X2=attacks.atcp.ko[[11]],Victories=attacks.atcp.ko[[12]])
mat4.atcp.ko<-inter.mat(mut4.atcp.ko)
tri4.atcp.ko<-tr.tri(mat4.atcp.ko)
dci4.atcp.ko<-DCindex(mat4.atcp.ko)
mat4.atcp.ko[is.na(mat4.atcp.ko)] = 0
h4.atcp.ko<-h.index(mat4.atcp.ko)

ep4.atcp.ko<-ep(mut4.atcp.ko,a4.cp.ko)
david4.atcp.ko<-DS(mat4.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.4.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.ko<-cbind(ordrank.4.atcp.ko,ds=david4.atcp.ko$normDS)
lm4.atcp.ko<-summary(lm(ordrank.4.atcp.ko$ds~ordrank.4.atcp.ko$ord.rank))
s4.atcp.ko<-lm4.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.ko<-data.frame(X1=attacks.atcp.ko[[13]],X2=attacks.atcp.ko[[14]],Victories=attacks.atcp.ko[[15]])
mat5.atcp.ko<-inter.mat(mut5.atcp.ko)
tri5.atcp.ko<-tr.tri(mat5.atcp.ko)
dci5.atcp.ko<-DCindex(mat5.atcp.ko)
mat5.atcp.ko[is.na(mat5.atcp.ko)] = 0
h5.atcp.ko<-h.index(mat5.atcp.ko)

ep5.atcp.ko<-ep(mut5.atcp.ko,a5.cp.ko)
david5.atcp.ko<-DS(mat5.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.5.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.ko<-cbind(ordrank.5.atcp.ko,ds=david5.atcp.ko$normDS)
lm5.atcp.ko<-summary(lm(ordrank.5.atcp.ko$ds~ordrank.5.atcp.ko$ord.rank))
s5.atcp.ko<-lm5.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.ko<-data.frame(X1=attacks.atcp.ko[[16]],X2=attacks.atcp.ko[[17]],Victories=attacks.atcp.ko[[18]])
mat6.atcp.ko<-inter.mat(mut6.atcp.ko)
tri6.atcp.ko<-tr.tri(mat6.atcp.ko)
dci6.atcp.ko<-DCindex(mat6.atcp.ko)
mat6.atcp.ko[is.na(mat6.atcp.ko)] = 0
h6.atcp.ko<-h.index(mat6.atcp.ko)

ep6.atcp.ko<-ep(mut6.atcp.ko,a6.cp.ko)
david6.atcp.ko<-DS(mat6.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.6.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.ko<-cbind(ordrank.6.atcp.ko,ds=david6.atcp.ko$normDS)
lm6.atcp.ko<-summary(lm(ordrank.6.atcp.ko$ds~ordrank.6.atcp.ko$ord.rank))
s6.atcp.ko<-lm6.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.ko<-data.frame(X1=attacks.atcp.ko[[19]],X2=attacks.atcp.ko[[20]],Victories=attacks.atcp.ko[[21]])
mat7.atcp.ko<-inter.mat(mut7.atcp.ko)
tri7.atcp.ko<-tr.tri(mat7.atcp.ko)
dci7.atcp.ko<-DCindex(mat7.atcp.ko)
mat7.atcp.ko[is.na(mat7.atcp.ko)] = 0
h7.atcp.ko<-h.index(mat7.atcp.ko)

ep7.atcp.ko<-ep(mut7.atcp.ko,a7.cp.ko)
david7.atcp.ko<-DS(mat7.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.7.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.ko<-cbind(ordrank.7.atcp.ko,ds=david7.atcp.ko$normDS)
lm7.atcp.ko<-summary(lm(ordrank.7.atcp.ko$ds~ordrank.7.atcp.ko$ord.rank))
s7.atcp.ko<-lm7.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.ko<-data.frame(X1=attacks.atcp.ko[[22]],X2=attacks.atcp.ko[[23]],Victories=attacks.atcp.ko[[24]])
mat8.atcp.ko<-inter.mat(mut8.atcp.ko)
tri8.atcp.ko<-tr.tri(mat8.atcp.ko)
dci8.atcp.ko<-DCindex(mat8.atcp.ko)
mat8.atcp.ko[is.na(mat8.atcp.ko)] = 0
h8.atcp.ko<-h.index(mat8.atcp.ko)

ep8.atcp.ko<-ep(mut8.atcp.ko,a8.cp.ko)
david8.atcp.ko<-DS(mat8.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.8.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.ko<-cbind(ordrank.8.atcp.ko,ds=david8.atcp.ko$normDS)
lm8.atcp.ko<-summary(lm(ordrank.8.atcp.ko$ds~ordrank.8.atcp.ko$ord.rank))
s8.atcp.ko<-lm8.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.ko<-data.frame(X1=attacks.atcp.ko[[25]],X2=attacks.atcp.ko[[26]],Victories=attacks.atcp.ko[[27]])
mat9.atcp.ko<-inter.mat(mut9.atcp.ko)
tri9.atcp.ko<-tr.tri(mat9.atcp.ko)
dci9.atcp.ko<-DCindex(mat9.atcp.ko)
mat9.atcp.ko[is.na(mat9.atcp.ko)] = 0
h9.atcp.ko<-h.index(mat9.atcp.ko)

ep9.atcp.ko<-ep(mut9.atcp.ko,a9.cp.ko)
david9.atcp.ko<-DS(mat9.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.9.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.ko<-cbind(ordrank.9.atcp.ko,ds=david9.atcp.ko$normDS)
lm9.atcp.ko<-summary(lm(ordrank.9.atcp.ko$ds~ordrank.9.atcp.ko$ord.rank))
s9.atcp.ko<-lm9.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.ko<-data.frame(X1=attacks.atcp.ko[[28]],X2=attacks.atcp.ko[[29]],Victories=attacks.atcp.ko[[30]])
mat10.atcp.ko<-inter.mat(mut10.atcp.ko)
tri10.atcp.ko<-tr.tri(mat10.atcp.ko)
dci10.atcp.ko<-DCindex(mat10.atcp.ko)
mat10.atcp.ko[is.na(mat10.atcp.ko)] = 0
h10.atcp.ko<-h.index(mat10.atcp.ko)

ep10.atcp.ko<-ep(mut10.atcp.ko,a10.cp.ko)
david10.atcp.ko<-DS(mat10.atcp.ko) #David's Scores - for steepness use normDS output
ordrank.10.atcp.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.ko<-cbind(ordrank.10.atcp.ko,ds=david10.atcp.ko$normDS)
lm10.atcp.ko<-summary(lm(ordrank.10.atcp.ko$ds~ordrank.10.atcp.ko$ord.rank))
s10.atcp.ko<-lm10.atcp.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.ko<-sum(mut1.atcp.ko$Victories)
int2.atcp.ko<-sum(mut2.atcp.ko$Victories)
int3.atcp.ko<-sum(mut3.atcp.ko$Victories)
int4.atcp.ko<-sum(mut4.atcp.ko$Victories)
int5.atcp.ko<-sum(mut5.atcp.ko$Victories)
int6.atcp.ko<-sum(mut6.atcp.ko$Victories)
int7.atcp.ko<-sum(mut7.atcp.ko$Victories)
int8.atcp.ko<-sum(mut8.atcp.ko$Victories)
int9.atcp.ko<-sum(mut9.atcp.ko$Victories)
int10.atcp.ko<-sum(mut10.atcp.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ko<-sum(a1.cp.ko$Victories)
av2.cp.ko<-sum(a2.cp.ko$Victories)
av3.cp.ko<-sum(a3.cp.ko$Victories)
av4.cp.ko<-sum(a4.cp.ko$Victories)
av5.cp.ko<-sum(a5.cp.ko$Victories)
av6.cp.ko<-sum(a6.cp.ko$Victories)
av7.cp.ko<-sum(a7.cp.ko$Victories)
av8.cp.ko<-sum(a8.cp.ko$Victories)
av9.cp.ko<-sum(a9.cp.ko$Victories)
av10.cp.ko<-sum(a10.cp.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.pc<-(sum(av1.cp.ko, av2.cp.ko, av3.cp.ko, av4.cp.ko, av5.cp.ko, av6.cp.ko, av7.cp.ko, av8.cp.ko, av9.cp.ko, av10.cp.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.pc<-(sum(int1.atcp.ko, int2.atcp.ko, int3.atcp.ko, int4.atcp.ko, int5.atcp.ko, int6.atcp.ko, int7.atcp.ko, int8.atcp.ko, int9.atcp.ko, int10.atcp.ko))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.ko<-e1.atcp.ko[order(e1.atcp.ko$ID),]
e1.atcp.ko<-as.matrix(t(e1.1.atcp.ko))

e2.atcp.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.ko<-e2.atcp.ko[order(e2.atcp.ko$ID),]
e2.atcp.ko<-as.matrix(t(e2.1.atcp.ko))

e3.atcp.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.ko<-e3.atcp.ko[order(e3.atcp.ko$ID),]
e3.atcp.ko<-as.matrix(t(e3.1.atcp.ko))

e4.atcp.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.ko<-e4.atcp.ko[order(e4.atcp.ko$ID),]
e4.atcp.ko<-as.matrix(t(e4.1.atcp.ko))

e5.atcp.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.ko<-e5.atcp.ko[order(e5.atcp.ko$ID),]
e5.atcp.ko<-as.matrix(t(e5.1.atcp.ko))

e6.atcp.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.ko<-e6.atcp.ko[order(e6.atcp.ko$ID),]
e6.atcp.ko<-as.matrix(t(e6.1.atcp.ko))

e7.atcp.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.ko<-e7.atcp.ko[order(e7.atcp.ko$ID),]
e7.atcp.ko<-as.matrix(t(e7.1.atcp.ko))

e8.atcp.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.ko<-e8.atcp.ko[order(e8.atcp.ko$ID),]
e8.atcp.ko<-as.matrix(t(e8.1.atcp.ko))

e9.atcp.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.ko<-e9.atcp.ko[order(e9.atcp.ko$ID),]
e9.atcp.ko<-as.matrix(t(e9.1.atcp.ko))

e10.atcp.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.ko<-e10.atcp.ko[order(e10.atcp.ko$ID),]
e10.atcp.ko<-as.matrix(t(e10.1.atcp.ko))

energy.ko.atcp.ko<-as.data.frame(matrix(c(e1.atcp.ko,e2.atcp.ko,e3.atcp.ko,e4.atcp.ko,e5.atcp.ko,e6.atcp.ko,e7.atcp.ko,e8.atcp.ko,e9.atcp.ko,e10.atcp.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.atcp.ko<-data.frame(ID=energy.ko.atcp.ko$V1,energy_over_distance=energy.ko.atcp.ko$V2,energy_over_time=energy.ko.atcp.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.ko<-david1.atcp.ko[order(david1.atcp.ko$ID),]
david1.atcp.ko<-as.matrix(t(david1.1.atcp.ko))

david2.1.atcp.ko<-david2.atcp.ko[order(david2.atcp.ko$ID),]
david2.atcp.ko<-as.matrix(t(david2.1.atcp.ko))

david3.1.atcp.ko<-david3.atcp.ko[order(david3.atcp.ko$ID),]
david3.atcp.ko<-as.matrix(t(david3.1.atcp.ko))

david4.1.atcp.ko<-david4.atcp.ko[order(david4.atcp.ko$ID),]
david4.atcp.ko<-as.matrix(t(david4.1.atcp.ko))

david5.1.atcp.ko<-david5.atcp.ko[order(david5.atcp.ko$ID),]
david5.atcp.ko<-as.matrix(t(david5.1.atcp.ko))

david6.1.atcp.ko<-david6.atcp.ko[order(david6.atcp.ko$ID),]
david6.atcp.ko<-as.matrix(t(david6.1.atcp.ko))

david7.1.atcp.ko<-david7.atcp.ko[order(david7.atcp.ko$ID),]
david7.atcp.ko<-as.matrix(t(david7.1.atcp.ko))

david8.1.atcp.ko<-david8.atcp.ko[order(david8.atcp.ko$ID),]
david8.atcp.ko<-as.matrix(t(david8.1.atcp.ko))

david9.1.atcp.ko<-david9.atcp.ko[order(david9.atcp.ko$ID),]
david9.atcp.ko<-as.matrix(t(david9.1.atcp.ko))

david10.1.atcp.ko<-david10.atcp.ko[order(david10.atcp.ko$ID),]
david10.atcp.ko<-as.matrix(t(david10.1.atcp.ko))

david.ko.atcp.ko<-as.data.frame(matrix(c(david1.atcp.ko,david2.atcp.ko,david3.atcp.ko,david4.atcp.ko,david5.atcp.ko,david6.atcp.ko,david7.atcp.ko,david8.atcp.ko,david9.atcp.ko,david10.atcp.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.atcp.ko<-data.frame(ID=david.ko.atcp.ko$V1,DS=david.ko.atcp.ko$V2,normDS=david.ko.atcp.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.atcp.ko<-lm(e1.1.atcp.ko$energy_over_time~as.numeric(david1.1.atcp.ko$normDS))
ko.lm.1.s.atcp.ko<-summary(lm.ko.1.atcp.ko)$coefficients
ko.1.slope.atcp.ko<-ko.lm.1.s.atcp.ko[2,1]
lm.ko.2.atcp.ko<-lm(e2.1.atcp.ko$energy_over_time~as.numeric(david2.1.atcp.ko$normDS))
ko.lm.2.s.atcp.ko<-summary(lm.ko.2.atcp.ko)$coefficients
ko.2.slope.atcp.ko<-ko.lm.2.s.atcp.ko[2,1]
lm.ko.3.atcp.ko<-lm(e3.1.atcp.ko$energy_over_time~as.numeric(david3.1.atcp.ko$normDS))
ko.lm.3.s.atcp.ko<-summary(lm.ko.3.atcp.ko)$coefficients
ko.3.slope.atcp.ko<-ko.lm.3.s.atcp.ko[2,1]
lm.ko.4.atcp.ko<-lm(e4.1.atcp.ko$energy_over_time~as.numeric(david4.1.atcp.ko$normDS))
ko.lm.4.s.atcp.ko<-summary(lm.ko.4.atcp.ko)$coefficients
ko.4.slope.atcp.ko<-ko.lm.4.s.atcp.ko[2,1]
lm.ko.5.atcp.ko<-lm(e5.1.atcp.ko$energy_over_time~as.numeric(david5.1.atcp.ko$normDS))
ko.lm.5.s.atcp.ko<-summary(lm.ko.5.atcp.ko)$coefficients
ko.5.slope.atcp.ko<-ko.lm.5.s.atcp.ko[2,1]
lm.ko.6.atcp.ko<-lm(e6.1.atcp.ko$energy_over_time~as.numeric(david6.1.atcp.ko$normDS))
ko.lm.6.s.atcp.ko<-summary(lm.ko.6.atcp.ko)$coefficients
ko.6.slope.atcp.ko<-ko.lm.6.s.atcp.ko[2,1]
lm.ko.7.atcp.ko<-lm(e7.1.atcp.ko$energy_over_time~as.numeric(david7.1.atcp.ko$normDS))
ko.lm.7.s.atcp.ko<-summary(lm.ko.7.atcp.ko)$coefficients
ko.7.slope.atcp.ko<-ko.lm.7.s.atcp.ko[2,1]
lm.ko.8.atcp.ko<-lm(e8.1.atcp.ko$energy_over_time~as.numeric(david8.1.atcp.ko$normDS))
ko.lm.8.s.atcp.ko<-summary(lm.ko.8.atcp.ko)$coefficients
ko.8.slope.atcp.ko<-ko.lm.8.s.atcp.ko[2,1]
lm.ko.9.atcp.ko<-lm(e9.1.atcp.ko$energy_over_time~as.numeric(david9.1.atcp.ko$normDS))
ko.lm.9.s.atcp.ko<-summary(lm.ko.9.atcp.ko)$coefficients
ko.9.slope.atcp.ko<-ko.lm.9.s.atcp.ko[2,1]
lm.ko.10.atcp.ko<-lm(e10.1.atcp.ko$energy_over_time~as.numeric(david10.1.atcp.ko$normDS))
ko.lm.10.s.atcp.ko<-summary(lm.ko.10.atcp.ko)$coefficients
ko.10.slope.atcp.ko<-ko.lm.10.s.atcp.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.atcp.ss.attacks.atcp.ko<-data.frame(triangle.transitivity=c(tri1.atcp.ko,tri2.atcp.ko,tri3.atcp.ko,tri4.atcp.ko,tri5.atcp.ko,tri6.atcp.ko,tri7.atcp.ko,tri8.atcp.ko,tri9.atcp.ko,tri10.atcp.ko),escalation=c(ep1.atcp.ko,ep2.atcp.ko,ep3.atcp.ko,ep4.atcp.ko,ep5.atcp.ko,ep6.atcp.ko,ep7.atcp.ko,ep8.atcp.ko,ep9.atcp.ko,ep10.atcp.ko),dci=c(dci1.atcp.ko,dci2.atcp.ko,dci3.atcp.ko,dci4.atcp.ko,dci5.atcp.ko,dci6.atcp.ko,dci7.atcp.ko,dci8.atcp.ko,dci9.atcp.ko,dci10.atcp.ko),steepness=c(s1.atcp.ko,s2.atcp.ko,s3.atcp.ko,s4.atcp.ko,s5.atcp.ko,s6.atcp.ko,s7.atcp.ko,s8.atcp.ko,s9.atcp.ko,s10.atcp.ko),slope=c(ko.1.slope.atcp.ko,ko.2.slope.atcp.ko,ko.3.slope.atcp.ko,ko.4.slope.atcp.ko,ko.5.slope.atcp.ko,ko.6.slope.atcp.ko,ko.7.slope.atcp.ko,ko.8.slope.atcp.ko,ko.9.slope.atcp.ko,ko.10.slope.atcp.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.hm<-sapply(files, read.csv)

# Generate attacks.atcp.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.hm<-data.frame(X1=attacks.atcp.hm[[1]],X2=attacks.atcp.hm[[2]],Victories=attacks.atcp.hm[[3]])
mat1.atcp.hm<-inter.mat(mut1.atcp.hm)
tri1.atcp.hm<-tr.tri(mat1.atcp.hm)
dci1.atcp.hm<-DCindex(mat1.atcp.hm)
mat1.atcp.hm[is.na(mat1.atcp.hm)] = 0
h1.atcp.hm<-h.index(mat1.atcp.hm)

ep1.atcp.hm<-ep(mut1.atcp.hm,a1.cp.hm)
david1.atcp.hm<-DS(mat1.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.1.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.hm<-cbind(ordrank.1.atcp.hm,ds=david1.atcp.hm$normDS)
lm1.atcp.hm<-summary(lm(ordrank.1.atcp.hm$ds~ordrank.1.atcp.hm$ord.rank))
s1.atcp.hm<-lm1.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.hm<-data.frame(X1=attacks.atcp.hm[[4]],X2=attacks.atcp.hm[[5]],Victories=attacks.atcp.hm[[6]])
mat2.atcp.hm<-inter.mat(mut2.atcp.hm)
tri2.atcp.hm<-tr.tri(mat2.atcp.hm)
dci2.atcp.hm<-DCindex(mat2.atcp.hm)
mat2.atcp.hm[is.na(mat2.atcp.hm)] = 0
h2.atcp.hm<-h.index(mat2.atcp.hm)

ep2.atcp.hm<-ep(mut2.atcp.hm,a2.cp.hm)
david2.atcp.hm<-DS(mat2.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.2.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.hm<-cbind(ordrank.2.atcp.hm,ds=david2.atcp.hm$normDS)
lm2.atcp.hm<-summary(lm(ordrank.2.atcp.hm$ds~ordrank.2.atcp.hm$ord.rank))
s2.atcp.hm<-lm2.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.hm<-data.frame(X1=attacks.atcp.hm[[7]],X2=attacks.atcp.hm[[8]],Victories=attacks.atcp.hm[[9]])
mat3.atcp.hm<-inter.mat(mut3.atcp.hm)
tri3.atcp.hm<-tr.tri(mat3.atcp.hm)
dci3.atcp.hm<-DCindex(mat3.atcp.hm)
mat3.atcp.hm[is.na(mat3.atcp.hm)] = 0
h3.atcp.hm<-h.index(mat3.atcp.hm)

ep3.atcp.hm<-ep(mut3.atcp.hm,a3.cp.hm)
david3.atcp.hm<-DS(mat3.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.3.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.hm<-cbind(ordrank.3.atcp.hm,ds=david3.atcp.hm$normDS)
lm3.atcp.hm<-summary(lm(ordrank.3.atcp.hm$ds~ordrank.3.atcp.hm$ord.rank))
s3.atcp.hm<-lm3.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.hm<-data.frame(X1=attacks.atcp.hm[[10]],X2=attacks.atcp.hm[[11]],Victories=attacks.atcp.hm[[12]])
mat4.atcp.hm<-inter.mat(mut4.atcp.hm)
tri4.atcp.hm<-tr.tri(mat4.atcp.hm)
dci4.atcp.hm<-DCindex(mat4.atcp.hm)
mat4.atcp.hm[is.na(mat4.atcp.hm)] = 0
h4.atcp.hm<-h.index(mat4.atcp.hm)

ep4.atcp.hm<-ep(mut4.atcp.hm,a4.cp.hm)
david4.atcp.hm<-DS(mat4.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.4.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.hm<-cbind(ordrank.4.atcp.hm,ds=david4.atcp.hm$normDS)
lm4.atcp.hm<-summary(lm(ordrank.4.atcp.hm$ds~ordrank.4.atcp.hm$ord.rank))
s4.atcp.hm<-lm4.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.hm<-data.frame(X1=attacks.atcp.hm[[13]],X2=attacks.atcp.hm[[14]],Victories=attacks.atcp.hm[[15]])
mat5.atcp.hm<-inter.mat(mut5.atcp.hm)
tri5.atcp.hm<-tr.tri(mat5.atcp.hm)
dci5.atcp.hm<-DCindex(mat5.atcp.hm)
mat5.atcp.hm[is.na(mat5.atcp.hm)] = 0
h5.atcp.hm<-h.index(mat5.atcp.hm)

ep5.atcp.hm<-ep(mut5.atcp.hm,a5.cp.hm)
david5.atcp.hm<-DS(mat5.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.5.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.hm<-cbind(ordrank.5.atcp.hm,ds=david5.atcp.hm$normDS)
lm5.atcp.hm<-summary(lm(ordrank.5.atcp.hm$ds~ordrank.5.atcp.hm$ord.rank))
s5.atcp.hm<-lm5.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.hm<-data.frame(X1=attacks.atcp.hm[[16]],X2=attacks.atcp.hm[[17]],Victories=attacks.atcp.hm[[18]])
mat6.atcp.hm<-inter.mat(mut6.atcp.hm)
tri6.atcp.hm<-tr.tri(mat6.atcp.hm)
dci6.atcp.hm<-DCindex(mat6.atcp.hm)
mat6.atcp.hm[is.na(mat6.atcp.hm)] = 0
h6.atcp.hm<-h.index(mat6.atcp.hm)

ep6.atcp.hm<-ep(mut6.atcp.hm,a6.cp.hm)
david6.atcp.hm<-DS(mat6.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.6.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.hm<-cbind(ordrank.6.atcp.hm,ds=david6.atcp.hm$normDS)
lm6.atcp.hm<-summary(lm(ordrank.6.atcp.hm$ds~ordrank.6.atcp.hm$ord.rank))
s6.atcp.hm<-lm6.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.hm<-data.frame(X1=attacks.atcp.hm[[19]],X2=attacks.atcp.hm[[20]],Victories=attacks.atcp.hm[[21]])
mat7.atcp.hm<-inter.mat(mut7.atcp.hm)
tri7.atcp.hm<-tr.tri(mat7.atcp.hm)
dci7.atcp.hm<-DCindex(mat7.atcp.hm)
mat7.atcp.hm[is.na(mat7.atcp.hm)] = 0
h7.atcp.hm<-h.index(mat7.atcp.hm)

ep7.atcp.hm<-ep(mut7.atcp.hm,a7.cp.hm)
david7.atcp.hm<-DS(mat7.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.7.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.hm<-cbind(ordrank.7.atcp.hm,ds=david7.atcp.hm$normDS)
lm7.atcp.hm<-summary(lm(ordrank.7.atcp.hm$ds~ordrank.7.atcp.hm$ord.rank))
s7.atcp.hm<-lm7.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.hm<-data.frame(X1=attacks.atcp.hm[[22]],X2=attacks.atcp.hm[[23]],Victories=attacks.atcp.hm[[24]])
mat8.atcp.hm<-inter.mat(mut8.atcp.hm)
tri8.atcp.hm<-tr.tri(mat8.atcp.hm)
dci8.atcp.hm<-DCindex(mat8.atcp.hm)
mat8.atcp.hm[is.na(mat8.atcp.hm)] = 0
h8.atcp.hm<-h.index(mat8.atcp.hm)

ep8.atcp.hm<-ep(mut8.atcp.hm,a8.cp.hm)
david8.atcp.hm<-DS(mat8.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.8.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.hm<-cbind(ordrank.8.atcp.hm,ds=david8.atcp.hm$normDS)
lm8.atcp.hm<-summary(lm(ordrank.8.atcp.hm$ds~ordrank.8.atcp.hm$ord.rank))
s8.atcp.hm<-lm8.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.hm<-data.frame(X1=attacks.atcp.hm[[25]],X2=attacks.atcp.hm[[26]],Victories=attacks.atcp.hm[[27]])
mat9.atcp.hm<-inter.mat(mut9.atcp.hm)
tri9.atcp.hm<-tr.tri(mat9.atcp.hm)
dci9.atcp.hm<-DCindex(mat9.atcp.hm)
mat9.atcp.hm[is.na(mat9.atcp.hm)] = 0
h9.atcp.hm<-h.index(mat9.atcp.hm)

ep9.atcp.hm<-ep(mut9.atcp.hm,a9.cp.hm)
david9.atcp.hm<-DS(mat9.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.9.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.hm<-cbind(ordrank.9.atcp.hm,ds=david9.atcp.hm$normDS)
lm9.atcp.hm<-summary(lm(ordrank.9.atcp.hm$ds~ordrank.9.atcp.hm$ord.rank))
s9.atcp.hm<-lm9.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.hm<-data.frame(X1=attacks.atcp.hm[[28]],X2=attacks.atcp.hm[[29]],Victories=attacks.atcp.hm[[30]])
mat10.atcp.hm<-inter.mat(mut10.atcp.hm)
tri10.atcp.hm<-tr.tri(mat10.atcp.hm)
dci10.atcp.hm<-DCindex(mat10.atcp.hm)
mat10.atcp.hm[is.na(mat10.atcp.hm)] = 0
h10.atcp.hm<-h.index(mat10.atcp.hm)

ep10.atcp.hm<-ep(mut10.atcp.hm,a10.cp.hm)
david10.atcp.hm<-DS(mat10.atcp.hm) #David's Scores - for steepness use normDS output
ordrank.10.atcp.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.hm<-cbind(ordrank.10.atcp.hm,ds=david10.atcp.hm$normDS)
lm10.atcp.hm<-summary(lm(ordrank.10.atcp.hm$ds~ordrank.10.atcp.hm$ord.rank))
s10.atcp.hm<-lm10.atcp.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.hm<-sum(mut1.atcp.hm$Victories)
int2.atcp.hm<-sum(mut2.atcp.hm$Victories)
int3.atcp.hm<-sum(mut3.atcp.hm$Victories)
int4.atcp.hm<-sum(mut4.atcp.hm$Victories)
int5.atcp.hm<-sum(mut5.atcp.hm$Victories)
int6.atcp.hm<-sum(mut6.atcp.hm$Victories)
int7.atcp.hm<-sum(mut7.atcp.hm$Victories)
int8.atcp.hm<-sum(mut8.atcp.hm$Victories)
int9.atcp.hm<-sum(mut9.atcp.hm$Victories)
int10.atcp.hm<-sum(mut10.atcp.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.hm<-sum(a1.cp.hm$Victories)
av2.cp.hm<-sum(a2.cp.hm$Victories)
av3.cp.hm<-sum(a3.cp.hm$Victories)
av4.cp.hm<-sum(a4.cp.hm$Victories)
av5.cp.hm<-sum(a5.cp.hm$Victories)
av6.cp.hm<-sum(a6.cp.hm$Victories)
av7.cp.hm<-sum(a7.cp.hm$Victories)
av8.cp.hm<-sum(a8.cp.hm$Victories)
av9.cp.hm<-sum(a9.cp.hm$Victories)
av10.cp.hm<-sum(a10.cp.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.pc<-(sum(av1.cp.hm, av2.cp.hm, av3.cp.hm, av4.cp.hm, av5.cp.hm, av6.cp.hm, av7.cp.hm, av8.cp.hm, av9.cp.hm, av10.cp.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.pc<-(sum(int1.atcp.hm, int2.atcp.hm, int3.atcp.hm, int4.atcp.hm, int5.atcp.hm, int6.atcp.hm, int7.atcp.hm, int8.atcp.hm, int9.atcp.hm, int10.atcp.hm))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.hm<-e1.atcp.hm[order(e1.atcp.hm$ID),]
e1.atcp.hm<-as.matrix(t(e1.1.atcp.hm))

e2.atcp.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.hm<-e2.atcp.hm[order(e2.atcp.hm$ID),]
e2.atcp.hm<-as.matrix(t(e2.1.atcp.hm))

e3.atcp.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.hm<-e3.atcp.hm[order(e3.atcp.hm$ID),]
e3.atcp.hm<-as.matrix(t(e3.1.atcp.hm))

e4.atcp.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.hm<-e4.atcp.hm[order(e4.atcp.hm$ID),]
e4.atcp.hm<-as.matrix(t(e4.1.atcp.hm))

e5.atcp.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.hm<-e5.atcp.hm[order(e5.atcp.hm$ID),]
e5.atcp.hm<-as.matrix(t(e5.1.atcp.hm))

e6.atcp.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.hm<-e6.atcp.hm[order(e6.atcp.hm$ID),]
e6.atcp.hm<-as.matrix(t(e6.1.atcp.hm))

e7.atcp.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.hm<-e7.atcp.hm[order(e7.atcp.hm$ID),]
e7.atcp.hm<-as.matrix(t(e7.1.atcp.hm))

e8.atcp.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.hm<-e8.atcp.hm[order(e8.atcp.hm$ID),]
e8.atcp.hm<-as.matrix(t(e8.1.atcp.hm))

e9.atcp.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.hm<-e9.atcp.hm[order(e9.atcp.hm$ID),]
e9.atcp.hm<-as.matrix(t(e9.1.atcp.hm))

e10.atcp.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.hm<-e10.atcp.hm[order(e10.atcp.hm$ID),]
e10.atcp.hm<-as.matrix(t(e10.1.atcp.hm))

energy.hm.atcp.hm<-as.data.frame(matrix(c(e1.atcp.hm,e2.atcp.hm,e3.atcp.hm,e4.atcp.hm,e5.atcp.hm,e6.atcp.hm,e7.atcp.hm,e8.atcp.hm,e9.atcp.hm,e10.atcp.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atcp.hm<-data.frame(ID=energy.hm.atcp.hm$V1,energy_over_distance=energy.hm.atcp.hm$V2,energy_over_time=energy.hm.atcp.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.hm<-david1.atcp.hm[order(david1.atcp.hm$ID),]
david1.atcp.hm<-as.matrix(t(david1.1.atcp.hm))

david2.1.atcp.hm<-david2.atcp.hm[order(david2.atcp.hm$ID),]
david2.atcp.hm<-as.matrix(t(david2.1.atcp.hm))

david3.1.atcp.hm<-david3.atcp.hm[order(david3.atcp.hm$ID),]
david3.atcp.hm<-as.matrix(t(david3.1.atcp.hm))

david4.1.atcp.hm<-david4.atcp.hm[order(david4.atcp.hm$ID),]
david4.atcp.hm<-as.matrix(t(david4.1.atcp.hm))

david5.1.atcp.hm<-david5.atcp.hm[order(david5.atcp.hm$ID),]
david5.atcp.hm<-as.matrix(t(david5.1.atcp.hm))

david6.1.atcp.hm<-david6.atcp.hm[order(david6.atcp.hm$ID),]
david6.atcp.hm<-as.matrix(t(david6.1.atcp.hm))

david7.1.atcp.hm<-david7.atcp.hm[order(david7.atcp.hm$ID),]
david7.atcp.hm<-as.matrix(t(david7.1.atcp.hm))

david8.1.atcp.hm<-david8.atcp.hm[order(david8.atcp.hm$ID),]
david8.atcp.hm<-as.matrix(t(david8.1.atcp.hm))

david9.1.atcp.hm<-david9.atcp.hm[order(david9.atcp.hm$ID),]
david9.atcp.hm<-as.matrix(t(david9.1.atcp.hm))

david10.1.atcp.hm<-david10.atcp.hm[order(david10.atcp.hm$ID),]
david10.atcp.hm<-as.matrix(t(david10.1.atcp.hm))

david.hm.atcp.hm<-as.data.frame(matrix(c(david1.atcp.hm,david2.atcp.hm,david3.atcp.hm,david4.atcp.hm,david5.atcp.hm,david6.atcp.hm,david7.atcp.hm,david8.atcp.hm,david9.atcp.hm,david10.atcp.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atcp.hm<-data.frame(ID=david.hm.atcp.hm$V1,DS=david.hm.atcp.hm$V2,normDS=david.hm.atcp.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atcp.hm<-lm(e1.1.atcp.hm$energy_over_time~as.numeric(david1.1.atcp.hm$normDS))
hm.lm.1.s.atcp.hm<-summary(lm.hm.1.atcp.hm)$coefficients
hm.1.slope.atcp.hm<-hm.lm.1.s.atcp.hm[2,1]
lm.hm.2.atcp.hm<-lm(e2.1.atcp.hm$energy_over_time~as.numeric(david2.1.atcp.hm$normDS))
hm.lm.2.s.atcp.hm<-summary(lm.hm.2.atcp.hm)$coefficients
hm.2.slope.atcp.hm<-hm.lm.2.s.atcp.hm[2,1]
lm.hm.3.atcp.hm<-lm(e3.1.atcp.hm$energy_over_time~as.numeric(david3.1.atcp.hm$normDS))
hm.lm.3.s.atcp.hm<-summary(lm.hm.3.atcp.hm)$coefficients
hm.3.slope.atcp.hm<-hm.lm.3.s.atcp.hm[2,1]
lm.hm.4.atcp.hm<-lm(e4.1.atcp.hm$energy_over_time~as.numeric(david4.1.atcp.hm$normDS))
hm.lm.4.s.atcp.hm<-summary(lm.hm.4.atcp.hm)$coefficients
hm.4.slope.atcp.hm<-hm.lm.4.s.atcp.hm[2,1]
lm.hm.5.atcp.hm<-lm(e5.1.atcp.hm$energy_over_time~as.numeric(david5.1.atcp.hm$normDS))
hm.lm.5.s.atcp.hm<-summary(lm.hm.5.atcp.hm)$coefficients
hm.5.slope.atcp.hm<-hm.lm.5.s.atcp.hm[2,1]
lm.hm.6.atcp.hm<-lm(e6.1.atcp.hm$energy_over_time~as.numeric(david6.1.atcp.hm$normDS))
hm.lm.6.s.atcp.hm<-summary(lm.hm.6.atcp.hm)$coefficients
hm.6.slope.atcp.hm<-hm.lm.6.s.atcp.hm[2,1]
lm.hm.7.atcp.hm<-lm(e7.1.atcp.hm$energy_over_time~as.numeric(david7.1.atcp.hm$normDS))
hm.lm.7.s.atcp.hm<-summary(lm.hm.7.atcp.hm)$coefficients
hm.7.slope.atcp.hm<-hm.lm.7.s.atcp.hm[2,1]
lm.hm.8.atcp.hm<-lm(e8.1.atcp.hm$energy_over_time~as.numeric(david8.1.atcp.hm$normDS))
hm.lm.8.s.atcp.hm<-summary(lm.hm.8.atcp.hm)$coefficients
hm.8.slope.atcp.hm<-hm.lm.8.s.atcp.hm[2,1]
lm.hm.9.atcp.hm<-lm(e9.1.atcp.hm$energy_over_time~as.numeric(david9.1.atcp.hm$normDS))
hm.lm.9.s.atcp.hm<-summary(lm.hm.9.atcp.hm)$coefficients
hm.9.slope.atcp.hm<-hm.lm.9.s.atcp.hm[2,1]
lm.hm.10.atcp.hm<-lm(e10.1.atcp.hm$energy_over_time~as.numeric(david10.1.atcp.hm$normDS))
hm.lm.10.s.atcp.hm<-summary(lm.hm.10.atcp.hm)$coefficients
hm.10.slope.atcp.hm<-hm.lm.10.s.atcp.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atcp.ss.attacks.atcp.hm<-data.frame(triangle.transitivity=c(tri1.atcp.hm,tri2.atcp.hm,tri3.atcp.hm,tri4.atcp.hm,tri5.atcp.hm,tri6.atcp.hm,tri7.atcp.hm,tri8.atcp.hm,tri9.atcp.hm,tri10.atcp.hm),escalation=c(ep1.atcp.hm,ep2.atcp.hm,ep3.atcp.hm,ep4.atcp.hm,ep5.atcp.hm,ep6.atcp.hm,ep7.atcp.hm,ep8.atcp.hm,ep9.atcp.hm,ep10.atcp.hm),dci=c(dci1.atcp.hm,dci2.atcp.hm,dci3.atcp.hm,dci4.atcp.hm,dci5.atcp.hm,dci6.atcp.hm,dci7.atcp.hm,dci8.atcp.hm,dci9.atcp.hm,dci10.atcp.hm),steepness=c(s1.atcp.hm,s2.atcp.hm,s3.atcp.hm,s4.atcp.hm,s5.atcp.hm,s6.atcp.hm,s7.atcp.hm,s8.atcp.hm,s9.atcp.hm,s10.atcp.hm),slope=c(hm.1.slope.atcp.hm,hm.2.slope.atcp.hm,hm.3.slope.atcp.hm,hm.4.slope.atcp.hm,hm.5.slope.atcp.hm,hm.6.slope.atcp.hm,hm.7.slope.atcp.hm,hm.8.slope.atcp.hm,hm.9.slope.atcp.hm,hm.10.slope.atcp.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.hs<-sapply(files, read.csv)

# Generate attacks.atcp.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.hs<-data.frame(X1=attacks.atcp.hs[[1]],X2=attacks.atcp.hs[[2]],Victories=attacks.atcp.hs[[3]])
mat1.atcp.hs<-inter.mat(mut1.atcp.hs)
tri1.atcp.hs<-tr.tri(mat1.atcp.hs)
dci1.atcp.hs<-DCindex(mat1.atcp.hs)
mat1.atcp.hs[is.na(mat1.atcp.hs)] = 0
h1.atcp.hs<-h.index(mat1.atcp.hs)

ep1.atcp.hs<-ep(mut1.atcp.hs,a1.cp.hs)
david1.atcp.hs<-DS(mat1.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.1.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.hs<-cbind(ordrank.1.atcp.hs,ds=david1.atcp.hs$normDS)
lm1.atcp.hs<-summary(lm(ordrank.1.atcp.hs$ds~ordrank.1.atcp.hs$ord.rank))
s1.atcp.hs<-lm1.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.hs<-data.frame(X1=attacks.atcp.hs[[4]],X2=attacks.atcp.hs[[5]],Victories=attacks.atcp.hs[[6]])
mat2.atcp.hs<-inter.mat(mut2.atcp.hs)
tri2.atcp.hs<-tr.tri(mat2.atcp.hs)
dci2.atcp.hs<-DCindex(mat2.atcp.hs)
mat2.atcp.hs[is.na(mat2.atcp.hs)] = 0
h2.atcp.hs<-h.index(mat2.atcp.hs)

ep2.atcp.hs<-ep(mut2.atcp.hs,a2.cp.hs)
david2.atcp.hs<-DS(mat2.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.2.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.hs<-cbind(ordrank.2.atcp.hs,ds=david2.atcp.hs$normDS)
lm2.atcp.hs<-summary(lm(ordrank.2.atcp.hs$ds~ordrank.2.atcp.hs$ord.rank))
s2.atcp.hs<-lm2.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.hs<-data.frame(X1=attacks.atcp.hs[[7]],X2=attacks.atcp.hs[[8]],Victories=attacks.atcp.hs[[9]])
mat3.atcp.hs<-inter.mat(mut3.atcp.hs)
tri3.atcp.hs<-tr.tri(mat3.atcp.hs)
dci3.atcp.hs<-DCindex(mat3.atcp.hs)
mat3.atcp.hs[is.na(mat3.atcp.hs)] = 0
h3.atcp.hs<-h.index(mat3.atcp.hs)

ep3.atcp.hs<-ep(mut3.atcp.hs,a3.cp.hs)
david3.atcp.hs<-DS(mat3.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.3.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.hs<-cbind(ordrank.3.atcp.hs,ds=david3.atcp.hs$normDS)
lm3.atcp.hs<-summary(lm(ordrank.3.atcp.hs$ds~ordrank.3.atcp.hs$ord.rank))
s3.atcp.hs<-lm3.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.hs<-data.frame(X1=attacks.atcp.hs[[10]],X2=attacks.atcp.hs[[11]],Victories=attacks.atcp.hs[[12]])
mat4.atcp.hs<-inter.mat(mut4.atcp.hs)
tri4.atcp.hs<-tr.tri(mat4.atcp.hs)
dci4.atcp.hs<-DCindex(mat4.atcp.hs)
mat4.atcp.hs[is.na(mat4.atcp.hs)] = 0
h4.atcp.hs<-h.index(mat4.atcp.hs)

ep4.atcp.hs<-ep(mut4.atcp.hs,a4.cp.hs)
david4.atcp.hs<-DS(mat4.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.4.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.hs<-cbind(ordrank.4.atcp.hs,ds=david4.atcp.hs$normDS)
lm4.atcp.hs<-summary(lm(ordrank.4.atcp.hs$ds~ordrank.4.atcp.hs$ord.rank))
s4.atcp.hs<-lm4.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.hs<-data.frame(X1=attacks.atcp.hs[[13]],X2=attacks.atcp.hs[[14]],Victories=attacks.atcp.hs[[15]])
mat5.atcp.hs<-inter.mat(mut5.atcp.hs)
tri5.atcp.hs<-tr.tri(mat5.atcp.hs)
dci5.atcp.hs<-DCindex(mat5.atcp.hs)
mat5.atcp.hs[is.na(mat5.atcp.hs)] = 0
h5.atcp.hs<-h.index(mat5.atcp.hs)

ep5.atcp.hs<-ep(mut5.atcp.hs,a5.cp.hs)
david5.atcp.hs<-DS(mat5.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.5.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.hs<-cbind(ordrank.5.atcp.hs,ds=david5.atcp.hs$normDS)
lm5.atcp.hs<-summary(lm(ordrank.5.atcp.hs$ds~ordrank.5.atcp.hs$ord.rank))
s5.atcp.hs<-lm5.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.hs<-data.frame(X1=attacks.atcp.hs[[16]],X2=attacks.atcp.hs[[17]],Victories=attacks.atcp.hs[[18]])
mat6.atcp.hs<-inter.mat(mut6.atcp.hs)
tri6.atcp.hs<-tr.tri(mat6.atcp.hs)
dci6.atcp.hs<-DCindex(mat6.atcp.hs)
mat6.atcp.hs[is.na(mat6.atcp.hs)] = 0
h6.atcp.hs<-h.index(mat6.atcp.hs)

ep6.atcp.hs<-ep(mut6.atcp.hs,a6.cp.hs)
david6.atcp.hs<-DS(mat6.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.6.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.hs<-cbind(ordrank.6.atcp.hs,ds=david6.atcp.hs$normDS)
lm6.atcp.hs<-summary(lm(ordrank.6.atcp.hs$ds~ordrank.6.atcp.hs$ord.rank))
s6.atcp.hs<-lm6.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.hs<-data.frame(X1=attacks.atcp.hs[[19]],X2=attacks.atcp.hs[[20]],Victories=attacks.atcp.hs[[21]])
mat7.atcp.hs<-inter.mat(mut7.atcp.hs)
tri7.atcp.hs<-tr.tri(mat7.atcp.hs)
dci7.atcp.hs<-DCindex(mat7.atcp.hs)
mat7.atcp.hs[is.na(mat7.atcp.hs)] = 0
h7.atcp.hs<-h.index(mat7.atcp.hs)

ep7.atcp.hs<-ep(mut7.atcp.hs,a7.cp.hs)
david7.atcp.hs<-DS(mat7.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.7.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.hs<-cbind(ordrank.7.atcp.hs,ds=david7.atcp.hs$normDS)
lm7.atcp.hs<-summary(lm(ordrank.7.atcp.hs$ds~ordrank.7.atcp.hs$ord.rank))
s7.atcp.hs<-lm7.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.hs<-data.frame(X1=attacks.atcp.hs[[22]],X2=attacks.atcp.hs[[23]],Victories=attacks.atcp.hs[[24]])
mat8.atcp.hs<-inter.mat(mut8.atcp.hs)
tri8.atcp.hs<-tr.tri(mat8.atcp.hs)
dci8.atcp.hs<-DCindex(mat8.atcp.hs)
mat8.atcp.hs[is.na(mat8.atcp.hs)] = 0
h8.atcp.hs<-h.index(mat8.atcp.hs)

ep8.atcp.hs<-ep(mut8.atcp.hs,a8.cp.hs)
david8.atcp.hs<-DS(mat8.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.8.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.hs<-cbind(ordrank.8.atcp.hs,ds=david8.atcp.hs$normDS)
lm8.atcp.hs<-summary(lm(ordrank.8.atcp.hs$ds~ordrank.8.atcp.hs$ord.rank))
s8.atcp.hs<-lm8.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.hs<-data.frame(X1=attacks.atcp.hs[[25]],X2=attacks.atcp.hs[[26]],Victories=attacks.atcp.hs[[27]])
mat9.atcp.hs<-inter.mat(mut9.atcp.hs)
tri9.atcp.hs<-tr.tri(mat9.atcp.hs)
dci9.atcp.hs<-DCindex(mat9.atcp.hs)
mat9.atcp.hs[is.na(mat9.atcp.hs)] = 0
h9.atcp.hs<-h.index(mat9.atcp.hs)

ep9.atcp.hs<-ep(mut9.atcp.hs,a9.cp.hs)
david9.atcp.hs<-DS(mat9.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.9.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.hs<-cbind(ordrank.9.atcp.hs,ds=david9.atcp.hs$normDS)
lm9.atcp.hs<-summary(lm(ordrank.9.atcp.hs$ds~ordrank.9.atcp.hs$ord.rank))
s9.atcp.hs<-lm9.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.hs<-data.frame(X1=attacks.atcp.hs[[28]],X2=attacks.atcp.hs[[29]],Victories=attacks.atcp.hs[[30]])
mat10.atcp.hs<-inter.mat(mut10.atcp.hs)
tri10.atcp.hs<-tr.tri(mat10.atcp.hs)
dci10.atcp.hs<-DCindex(mat10.atcp.hs)
mat10.atcp.hs[is.na(mat10.atcp.hs)] = 0
h10.atcp.hs<-h.index(mat10.atcp.hs)

ep10.atcp.hs<-ep(mut10.atcp.hs,a10.cp.hs)
david10.atcp.hs<-DS(mat10.atcp.hs) #David's Scores - for steepness use normDS output
ordrank.10.atcp.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.hs<-cbind(ordrank.10.atcp.hs,ds=david10.atcp.hs$normDS)
lm10.atcp.hs<-summary(lm(ordrank.10.atcp.hs$ds~ordrank.10.atcp.hs$ord.rank))
s10.atcp.hs<-lm10.atcp.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.hs<-sum(mut1.atcp.hs$Victories)
int2.atcp.hs<-sum(mut2.atcp.hs$Victories)
int3.atcp.hs<-sum(mut3.atcp.hs$Victories)
int4.atcp.hs<-sum(mut4.atcp.hs$Victories)
int5.atcp.hs<-sum(mut5.atcp.hs$Victories)
int6.atcp.hs<-sum(mut6.atcp.hs$Victories)
int7.atcp.hs<-sum(mut7.atcp.hs$Victories)
int8.atcp.hs<-sum(mut8.atcp.hs$Victories)
int9.atcp.hs<-sum(mut9.atcp.hs$Victories)
int10.atcp.hs<-sum(mut10.atcp.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.hs<-sum(a1.cp.hs$Victories)
av2.cp.hs<-sum(a2.cp.hs$Victories)
av3.cp.hs<-sum(a3.cp.hs$Victories)
av4.cp.hs<-sum(a4.cp.hs$Victories)
av5.cp.hs<-sum(a5.cp.hs$Victories)
av6.cp.hs<-sum(a6.cp.hs$Victories)
av7.cp.hs<-sum(a7.cp.hs$Victories)
av8.cp.hs<-sum(a8.cp.hs$Victories)
av9.cp.hs<-sum(a9.cp.hs$Victories)
av10.cp.hs<-sum(a10.cp.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.pc<-(sum(av1.cp.hs, av2.cp.hs, av3.cp.hs, av4.cp.hs, av5.cp.hs, av6.cp.hs, av7.cp.hs, av8.cp.hs, av9.cp.hs, av10.cp.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.pc<-(sum(int1.atcp.hs, int2.atcp.hs, int3.atcp.hs, int4.atcp.hs, int5.atcp.hs, int6.atcp.hs, int7.atcp.hs, int8.atcp.hs, int9.atcp.hs, int10.atcp.hs))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.hs<-e1.atcp.hs[order(e1.atcp.hs$ID),]
e1.atcp.hs<-as.matrix(t(e1.1.atcp.hs))

e2.atcp.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.hs<-e2.atcp.hs[order(e2.atcp.hs$ID),]
e2.atcp.hs<-as.matrix(t(e2.1.atcp.hs))

e3.atcp.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.hs<-e3.atcp.hs[order(e3.atcp.hs$ID),]
e3.atcp.hs<-as.matrix(t(e3.1.atcp.hs))

e4.atcp.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.hs<-e4.atcp.hs[order(e4.atcp.hs$ID),]
e4.atcp.hs<-as.matrix(t(e4.1.atcp.hs))

e5.atcp.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.hs<-e5.atcp.hs[order(e5.atcp.hs$ID),]
e5.atcp.hs<-as.matrix(t(e5.1.atcp.hs))

e6.atcp.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.hs<-e6.atcp.hs[order(e6.atcp.hs$ID),]
e6.atcp.hs<-as.matrix(t(e6.1.atcp.hs))

e7.atcp.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.hs<-e7.atcp.hs[order(e7.atcp.hs$ID),]
e7.atcp.hs<-as.matrix(t(e7.1.atcp.hs))

e8.atcp.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.hs<-e8.atcp.hs[order(e8.atcp.hs$ID),]
e8.atcp.hs<-as.matrix(t(e8.1.atcp.hs))

e9.atcp.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.hs<-e9.atcp.hs[order(e9.atcp.hs$ID),]
e9.atcp.hs<-as.matrix(t(e9.1.atcp.hs))

e10.atcp.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.hs<-e10.atcp.hs[order(e10.atcp.hs$ID),]
e10.atcp.hs<-as.matrix(t(e10.1.atcp.hs))

energy.hs.atcp.hs<-as.data.frame(matrix(c(e1.atcp.hs,e2.atcp.hs,e3.atcp.hs,e4.atcp.hs,e5.atcp.hs,e6.atcp.hs,e7.atcp.hs,e8.atcp.hs,e9.atcp.hs,e10.atcp.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.atcp.hs<-data.frame(ID=energy.hs.atcp.hs$V1,energy_over_distance=energy.hs.atcp.hs$V2,energy_over_time=energy.hs.atcp.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.hs<-david1.atcp.hs[order(david1.atcp.hs$ID),]
david1.atcp.hs<-as.matrix(t(david1.1.atcp.hs))

david2.1.atcp.hs<-david2.atcp.hs[order(david2.atcp.hs$ID),]
david2.atcp.hs<-as.matrix(t(david2.1.atcp.hs))

david3.1.atcp.hs<-david3.atcp.hs[order(david3.atcp.hs$ID),]
david3.atcp.hs<-as.matrix(t(david3.1.atcp.hs))

david4.1.atcp.hs<-david4.atcp.hs[order(david4.atcp.hs$ID),]
david4.atcp.hs<-as.matrix(t(david4.1.atcp.hs))

david5.1.atcp.hs<-david5.atcp.hs[order(david5.atcp.hs$ID),]
david5.atcp.hs<-as.matrix(t(david5.1.atcp.hs))

david6.1.atcp.hs<-david6.atcp.hs[order(david6.atcp.hs$ID),]
david6.atcp.hs<-as.matrix(t(david6.1.atcp.hs))

david7.1.atcp.hs<-david7.atcp.hs[order(david7.atcp.hs$ID),]
david7.atcp.hs<-as.matrix(t(david7.1.atcp.hs))

david8.1.atcp.hs<-david8.atcp.hs[order(david8.atcp.hs$ID),]
david8.atcp.hs<-as.matrix(t(david8.1.atcp.hs))

david9.1.atcp.hs<-david9.atcp.hs[order(david9.atcp.hs$ID),]
david9.atcp.hs<-as.matrix(t(david9.1.atcp.hs))

david10.1.atcp.hs<-david10.atcp.hs[order(david10.atcp.hs$ID),]
david10.atcp.hs<-as.matrix(t(david10.1.atcp.hs))

david.hs.atcp.hs<-as.data.frame(matrix(c(david1.atcp.hs,david2.atcp.hs,david3.atcp.hs,david4.atcp.hs,david5.atcp.hs,david6.atcp.hs,david7.atcp.hs,david8.atcp.hs,david9.atcp.hs,david10.atcp.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.atcp.hs<-data.frame(ID=david.hs.atcp.hs$V1,DS=david.hs.atcp.hs$V2,normDS=david.hs.atcp.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.atcp.hs<-lm(e1.1.atcp.hs$energy_over_time~as.numeric(david1.1.atcp.hs$normDS))
hs.lm.1.s.atcp.hs<-summary(lm.hs.1.atcp.hs)$coefficients
hs.1.slope.atcp.hs<-hs.lm.1.s.atcp.hs[2,1]
lm.hs.2.atcp.hs<-lm(e2.1.atcp.hs$energy_over_time~as.numeric(david2.1.atcp.hs$normDS))
hs.lm.2.s.atcp.hs<-summary(lm.hs.2.atcp.hs)$coefficients
hs.2.slope.atcp.hs<-hs.lm.2.s.atcp.hs[2,1]
lm.hs.3.atcp.hs<-lm(e3.1.atcp.hs$energy_over_time~as.numeric(david3.1.atcp.hs$normDS))
hs.lm.3.s.atcp.hs<-summary(lm.hs.3.atcp.hs)$coefficients
hs.3.slope.atcp.hs<-hs.lm.3.s.atcp.hs[2,1]
lm.hs.4.atcp.hs<-lm(e4.1.atcp.hs$energy_over_time~as.numeric(david4.1.atcp.hs$normDS))
hs.lm.4.s.atcp.hs<-summary(lm.hs.4.atcp.hs)$coefficients
hs.4.slope.atcp.hs<-hs.lm.4.s.atcp.hs[2,1]
lm.hs.5.atcp.hs<-lm(e5.1.atcp.hs$energy_over_time~as.numeric(david5.1.atcp.hs$normDS))
hs.lm.5.s.atcp.hs<-summary(lm.hs.5.atcp.hs)$coefficients
hs.5.slope.atcp.hs<-hs.lm.5.s.atcp.hs[2,1]
lm.hs.6.atcp.hs<-lm(e6.1.atcp.hs$energy_over_time~as.numeric(david6.1.atcp.hs$normDS))
hs.lm.6.s.atcp.hs<-summary(lm.hs.6.atcp.hs)$coefficients
hs.6.slope.atcp.hs<-hs.lm.6.s.atcp.hs[2,1]
lm.hs.7.atcp.hs<-lm(e7.1.atcp.hs$energy_over_time~as.numeric(david7.1.atcp.hs$normDS))
hs.lm.7.s.atcp.hs<-summary(lm.hs.7.atcp.hs)$coefficients
hs.7.slope.atcp.hs<-hs.lm.7.s.atcp.hs[2,1]
lm.hs.8.atcp.hs<-lm(e8.1.atcp.hs$energy_over_time~as.numeric(david8.1.atcp.hs$normDS))
hs.lm.8.s.atcp.hs<-summary(lm.hs.8.atcp.hs)$coefficients
hs.8.slope.atcp.hs<-hs.lm.8.s.atcp.hs[2,1]
lm.hs.9.atcp.hs<-lm(e9.1.atcp.hs$energy_over_time~as.numeric(david9.1.atcp.hs$normDS))
hs.lm.9.s.atcp.hs<-summary(lm.hs.9.atcp.hs)$coefficients
hs.9.slope.atcp.hs<-hs.lm.9.s.atcp.hs[2,1]
lm.hs.10.atcp.hs<-lm(e10.1.atcp.hs$energy_over_time~as.numeric(david10.1.atcp.hs$normDS))
hs.lm.10.s.atcp.hs<-summary(lm.hs.10.atcp.hs)$coefficients
hs.10.slope.atcp.hs<-hs.lm.10.s.atcp.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.atcp.ss.attacks.atcp.hs<-data.frame(triangle.transitivity=c(tri1.atcp.hs,tri2.atcp.hs,tri3.atcp.hs,tri4.atcp.hs,tri5.atcp.hs,tri6.atcp.hs,tri7.atcp.hs,tri8.atcp.hs,tri9.atcp.hs,tri10.atcp.hs),escalation=c(ep1.atcp.hs,ep2.atcp.hs,ep3.atcp.hs,ep4.atcp.hs,ep5.atcp.hs,ep6.atcp.hs,ep7.atcp.hs,ep8.atcp.hs,ep9.atcp.hs,ep10.atcp.hs),dci=c(dci1.atcp.hs,dci2.atcp.hs,dci3.atcp.hs,dci4.atcp.hs,dci5.atcp.hs,dci6.atcp.hs,dci7.atcp.hs,dci8.atcp.hs,dci9.atcp.hs,dci10.atcp.hs),steepness=c(s1.atcp.hs,s2.atcp.hs,s3.atcp.hs,s4.atcp.hs,s5.atcp.hs,s6.atcp.hs,s7.atcp.hs,s8.atcp.hs,s9.atcp.hs,s10.atcp.hs),slope=c(hs.1.slope.atcp.hs,hs.2.slope.atcp.hs,hs.3.slope.atcp.hs,hs.4.slope.atcp.hs,hs.5.slope.atcp.hs,hs.6.slope.atcp.hs,hs.7.slope.atcp.hs,hs.8.slope.atcp.hs,hs.9.slope.atcp.hs,hs.10.slope.atcp.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atcp.ho<-sapply(files, read.csv)

# Generate attacks.atcp.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atcp.ho<-data.frame(X1=attacks.atcp.ho[[1]],X2=attacks.atcp.ho[[2]],Victories=attacks.atcp.ho[[3]])
mat1.atcp.ho<-inter.mat(mut1.atcp.ho)
tri1.atcp.ho<-tr.tri(mat1.atcp.ho)
dci1.atcp.ho<-DCindex(mat1.atcp.ho)
mat1.atcp.ho[is.na(mat1.atcp.ho)] = 0
h1.atcp.ho<-h.index(mat1.atcp.ho)

ep1.atcp.ho<-ep(mut1.atcp.ho,a1.cp.ho)
david1.atcp.ho<-DS(mat1.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.1.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atcp.ho<-cbind(ordrank.1.atcp.ho,ds=david1.atcp.ho$normDS)
lm1.atcp.ho<-summary(lm(ordrank.1.atcp.ho$ds~ordrank.1.atcp.ho$ord.rank))
s1.atcp.ho<-lm1.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atcp.ho<-data.frame(X1=attacks.atcp.ho[[4]],X2=attacks.atcp.ho[[5]],Victories=attacks.atcp.ho[[6]])
mat2.atcp.ho<-inter.mat(mut2.atcp.ho)
tri2.atcp.ho<-tr.tri(mat2.atcp.ho)
dci2.atcp.ho<-DCindex(mat2.atcp.ho)
mat2.atcp.ho[is.na(mat2.atcp.ho)] = 0
h2.atcp.ho<-h.index(mat2.atcp.ho)

ep2.atcp.ho<-ep(mut2.atcp.ho,a2.cp.ho)
david2.atcp.ho<-DS(mat2.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.2.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atcp.ho<-cbind(ordrank.2.atcp.ho,ds=david2.atcp.ho$normDS)
lm2.atcp.ho<-summary(lm(ordrank.2.atcp.ho$ds~ordrank.2.atcp.ho$ord.rank))
s2.atcp.ho<-lm2.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atcp.ho<-data.frame(X1=attacks.atcp.ho[[7]],X2=attacks.atcp.ho[[8]],Victories=attacks.atcp.ho[[9]])
mat3.atcp.ho<-inter.mat(mut3.atcp.ho)
tri3.atcp.ho<-tr.tri(mat3.atcp.ho)
dci3.atcp.ho<-DCindex(mat3.atcp.ho)
mat3.atcp.ho[is.na(mat3.atcp.ho)] = 0
h3.atcp.ho<-h.index(mat3.atcp.ho)

ep3.atcp.ho<-ep(mut3.atcp.ho,a3.cp.ho)
david3.atcp.ho<-DS(mat3.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.3.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atcp.ho<-cbind(ordrank.3.atcp.ho,ds=david3.atcp.ho$normDS)
lm3.atcp.ho<-summary(lm(ordrank.3.atcp.ho$ds~ordrank.3.atcp.ho$ord.rank))
s3.atcp.ho<-lm3.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atcp.ho<-data.frame(X1=attacks.atcp.ho[[10]],X2=attacks.atcp.ho[[11]],Victories=attacks.atcp.ho[[12]])
mat4.atcp.ho<-inter.mat(mut4.atcp.ho)
tri4.atcp.ho<-tr.tri(mat4.atcp.ho)
dci4.atcp.ho<-DCindex(mat4.atcp.ho)
mat4.atcp.ho[is.na(mat4.atcp.ho)] = 0
h4.atcp.ho<-h.index(mat4.atcp.ho)

ep4.atcp.ho<-ep(mut4.atcp.ho,a4.cp.ho)
david4.atcp.ho<-DS(mat4.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.4.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atcp.ho<-cbind(ordrank.4.atcp.ho,ds=david4.atcp.ho$normDS)
lm4.atcp.ho<-summary(lm(ordrank.4.atcp.ho$ds~ordrank.4.atcp.ho$ord.rank))
s4.atcp.ho<-lm4.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atcp.ho<-data.frame(X1=attacks.atcp.ho[[13]],X2=attacks.atcp.ho[[14]],Victories=attacks.atcp.ho[[15]])
mat5.atcp.ho<-inter.mat(mut5.atcp.ho)
tri5.atcp.ho<-tr.tri(mat5.atcp.ho)
dci5.atcp.ho<-DCindex(mat5.atcp.ho)
mat5.atcp.ho[is.na(mat5.atcp.ho)] = 0
h5.atcp.ho<-h.index(mat5.atcp.ho)

ep5.atcp.ho<-ep(mut5.atcp.ho,a5.cp.ho)
david5.atcp.ho<-DS(mat5.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.5.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atcp.ho<-cbind(ordrank.5.atcp.ho,ds=david5.atcp.ho$normDS)
lm5.atcp.ho<-summary(lm(ordrank.5.atcp.ho$ds~ordrank.5.atcp.ho$ord.rank))
s5.atcp.ho<-lm5.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atcp.ho<-data.frame(X1=attacks.atcp.ho[[16]],X2=attacks.atcp.ho[[17]],Victories=attacks.atcp.ho[[18]])
mat6.atcp.ho<-inter.mat(mut6.atcp.ho)
tri6.atcp.ho<-tr.tri(mat6.atcp.ho)
dci6.atcp.ho<-DCindex(mat6.atcp.ho)
mat6.atcp.ho[is.na(mat6.atcp.ho)] = 0
h6.atcp.ho<-h.index(mat6.atcp.ho)

ep6.atcp.ho<-ep(mut6.atcp.ho,a6.cp.ho)
david6.atcp.ho<-DS(mat6.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.6.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atcp.ho<-cbind(ordrank.6.atcp.ho,ds=david6.atcp.ho$normDS)
lm6.atcp.ho<-summary(lm(ordrank.6.atcp.ho$ds~ordrank.6.atcp.ho$ord.rank))
s6.atcp.ho<-lm6.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atcp.ho<-data.frame(X1=attacks.atcp.ho[[19]],X2=attacks.atcp.ho[[20]],Victories=attacks.atcp.ho[[21]])
mat7.atcp.ho<-inter.mat(mut7.atcp.ho)
tri7.atcp.ho<-tr.tri(mat7.atcp.ho)
dci7.atcp.ho<-DCindex(mat7.atcp.ho)
mat7.atcp.ho[is.na(mat7.atcp.ho)] = 0
h7.atcp.ho<-h.index(mat7.atcp.ho)

ep7.atcp.ho<-ep(mut7.atcp.ho,a7.cp.ho)
david7.atcp.ho<-DS(mat7.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.7.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atcp.ho<-cbind(ordrank.7.atcp.ho,ds=david7.atcp.ho$normDS)
lm7.atcp.ho<-summary(lm(ordrank.7.atcp.ho$ds~ordrank.7.atcp.ho$ord.rank))
s7.atcp.ho<-lm7.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atcp.ho<-data.frame(X1=attacks.atcp.ho[[22]],X2=attacks.atcp.ho[[23]],Victories=attacks.atcp.ho[[24]])
mat8.atcp.ho<-inter.mat(mut8.atcp.ho)
tri8.atcp.ho<-tr.tri(mat8.atcp.ho)
dci8.atcp.ho<-DCindex(mat8.atcp.ho)
mat8.atcp.ho[is.na(mat8.atcp.ho)] = 0
h8.atcp.ho<-h.index(mat8.atcp.ho)

ep8.atcp.ho<-ep(mut8.atcp.ho,a8.cp.ho)
david8.atcp.ho<-DS(mat8.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.8.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atcp.ho<-cbind(ordrank.8.atcp.ho,ds=david8.atcp.ho$normDS)
lm8.atcp.ho<-summary(lm(ordrank.8.atcp.ho$ds~ordrank.8.atcp.ho$ord.rank))
s8.atcp.ho<-lm8.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atcp.ho<-data.frame(X1=attacks.atcp.ho[[25]],X2=attacks.atcp.ho[[26]],Victories=attacks.atcp.ho[[27]])
mat9.atcp.ho<-inter.mat(mut9.atcp.ho)
tri9.atcp.ho<-tr.tri(mat9.atcp.ho)
dci9.atcp.ho<-DCindex(mat9.atcp.ho)
mat9.atcp.ho[is.na(mat9.atcp.ho)] = 0
h9.atcp.ho<-h.index(mat9.atcp.ho)

ep9.atcp.ho<-ep(mut9.atcp.ho,a9.cp.ho)
david9.atcp.ho<-DS(mat9.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.9.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atcp.ho<-cbind(ordrank.9.atcp.ho,ds=david9.atcp.ho$normDS)
lm9.atcp.ho<-summary(lm(ordrank.9.atcp.ho$ds~ordrank.9.atcp.ho$ord.rank))
s9.atcp.ho<-lm9.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atcp.ho<-data.frame(X1=attacks.atcp.ho[[28]],X2=attacks.atcp.ho[[29]],Victories=attacks.atcp.ho[[30]])
mat10.atcp.ho<-inter.mat(mut10.atcp.ho)
tri10.atcp.ho<-tr.tri(mat10.atcp.ho)
dci10.atcp.ho<-DCindex(mat10.atcp.ho)
mat10.atcp.ho[is.na(mat10.atcp.ho)] = 0
h10.atcp.ho<-h.index(mat10.atcp.ho)

ep10.atcp.ho<-ep(mut10.atcp.ho,a10.cp.ho)
david10.atcp.ho<-DS(mat10.atcp.ho) #David's Scores - for steepness use normDS output
ordrank.10.atcp.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atcp.ho<-cbind(ordrank.10.atcp.ho,ds=david10.atcp.ho$normDS)
lm10.atcp.ho<-summary(lm(ordrank.10.atcp.ho$ds~ordrank.10.atcp.ho$ord.rank))
s10.atcp.ho<-lm10.atcp.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atcp.ho<-sum(mut1.atcp.ho$Victories)
int2.atcp.ho<-sum(mut2.atcp.ho$Victories)
int3.atcp.ho<-sum(mut3.atcp.ho$Victories)
int4.atcp.ho<-sum(mut4.atcp.ho$Victories)
int5.atcp.ho<-sum(mut5.atcp.ho$Victories)
int6.atcp.ho<-sum(mut6.atcp.ho$Victories)
int7.atcp.ho<-sum(mut7.atcp.ho$Victories)
int8.atcp.ho<-sum(mut8.atcp.ho$Victories)
int9.atcp.ho<-sum(mut9.atcp.ho$Victories)
int10.atcp.ho<-sum(mut10.atcp.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.cp.ho<-sum(a1.cp.ho$Victories)
av2.cp.ho<-sum(a2.cp.ho$Victories)
av3.cp.ho<-sum(a3.cp.ho$Victories)
av4.cp.ho<-sum(a4.cp.ho$Victories)
av5.cp.ho<-sum(a5.cp.ho$Victories)
av6.cp.ho<-sum(a6.cp.ho$Victories)
av7.cp.ho<-sum(a7.cp.ho$Victories)
av8.cp.ho<-sum(a8.cp.ho$Victories)
av9.cp.ho<-sum(a9.cp.ho$Victories)
av10.cp.ho<-sum(a10.cp.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.pc<-(sum(av1.cp.ho, av2.cp.ho, av3.cp.ho, av4.cp.ho, av5.cp.ho, av6.cp.ho, av7.cp.ho, av8.cp.ho, av9.cp.ho, av10.cp.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.pc<-(sum(int1.atcp.ho, int2.atcp.ho, int3.atcp.ho, int4.atcp.ho, int5.atcp.ho, int6.atcp.ho, int7.atcp.ho, int8.atcp.ho, int9.atcp.ho, int10.atcp.ho))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atcp.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atcp.ho<-e1.atcp.ho[order(e1.atcp.ho$ID),]
e1.atcp.ho<-as.matrix(t(e1.1.atcp.ho))

e2.atcp.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atcp.ho<-e2.atcp.ho[order(e2.atcp.ho$ID),]
e2.atcp.ho<-as.matrix(t(e2.1.atcp.ho))

e3.atcp.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atcp.ho<-e3.atcp.ho[order(e3.atcp.ho$ID),]
e3.atcp.ho<-as.matrix(t(e3.1.atcp.ho))

e4.atcp.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atcp.ho<-e4.atcp.ho[order(e4.atcp.ho$ID),]
e4.atcp.ho<-as.matrix(t(e4.1.atcp.ho))

e5.atcp.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atcp.ho<-e5.atcp.ho[order(e5.atcp.ho$ID),]
e5.atcp.ho<-as.matrix(t(e5.1.atcp.ho))

e6.atcp.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atcp.ho<-e6.atcp.ho[order(e6.atcp.ho$ID),]
e6.atcp.ho<-as.matrix(t(e6.1.atcp.ho))

e7.atcp.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atcp.ho<-e7.atcp.ho[order(e7.atcp.ho$ID),]
e7.atcp.ho<-as.matrix(t(e7.1.atcp.ho))

e8.atcp.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atcp.ho<-e8.atcp.ho[order(e8.atcp.ho$ID),]
e8.atcp.ho<-as.matrix(t(e8.1.atcp.ho))

e9.atcp.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atcp.ho<-e9.atcp.ho[order(e9.atcp.ho$ID),]
e9.atcp.ho<-as.matrix(t(e9.1.atcp.ho))

e10.atcp.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atcp.ho<-e10.atcp.ho[order(e10.atcp.ho$ID),]
e10.atcp.ho<-as.matrix(t(e10.1.atcp.ho))

energy.ho.atcp.ho<-as.data.frame(matrix(c(e1.atcp.ho,e2.atcp.ho,e3.atcp.ho,e4.atcp.ho,e5.atcp.ho,e6.atcp.ho,e7.atcp.ho,e8.atcp.ho,e9.atcp.ho,e10.atcp.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.atcp.ho<-data.frame(ID=energy.ho.atcp.ho$V1,energy_over_distance=energy.ho.atcp.ho$V2,energy_over_time=energy.ho.atcp.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atcp.ho<-david1.atcp.ho[order(david1.atcp.ho$ID),]
david1.atcp.ho<-as.matrix(t(david1.1.atcp.ho))

david2.1.atcp.ho<-david2.atcp.ho[order(david2.atcp.ho$ID),]
david2.atcp.ho<-as.matrix(t(david2.1.atcp.ho))

david3.1.atcp.ho<-david3.atcp.ho[order(david3.atcp.ho$ID),]
david3.atcp.ho<-as.matrix(t(david3.1.atcp.ho))

david4.1.atcp.ho<-david4.atcp.ho[order(david4.atcp.ho$ID),]
david4.atcp.ho<-as.matrix(t(david4.1.atcp.ho))

david5.1.atcp.ho<-david5.atcp.ho[order(david5.atcp.ho$ID),]
david5.atcp.ho<-as.matrix(t(david5.1.atcp.ho))

david6.1.atcp.ho<-david6.atcp.ho[order(david6.atcp.ho$ID),]
david6.atcp.ho<-as.matrix(t(david6.1.atcp.ho))

david7.1.atcp.ho<-david7.atcp.ho[order(david7.atcp.ho$ID),]
david7.atcp.ho<-as.matrix(t(david7.1.atcp.ho))

david8.1.atcp.ho<-david8.atcp.ho[order(david8.atcp.ho$ID),]
david8.atcp.ho<-as.matrix(t(david8.1.atcp.ho))

david9.1.atcp.ho<-david9.atcp.ho[order(david9.atcp.ho$ID),]
david9.atcp.ho<-as.matrix(t(david9.1.atcp.ho))

david10.1.atcp.ho<-david10.atcp.ho[order(david10.atcp.ho$ID),]
david10.atcp.ho<-as.matrix(t(david10.1.atcp.ho))

david.ho.atcp.ho<-as.data.frame(matrix(c(david1.atcp.ho,david2.atcp.ho,david3.atcp.ho,david4.atcp.ho,david5.atcp.ho,david6.atcp.ho,david7.atcp.ho,david8.atcp.ho,david9.atcp.ho,david10.atcp.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.atcp.ho<-data.frame(ID=david.ho.atcp.ho$V1,DS=david.ho.atcp.ho$V2,normDS=david.ho.atcp.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.atcp.ho<-lm(e1.1.atcp.ho$energy_over_time~as.numeric(david1.1.atcp.ho$normDS))
ho.lm.1.s.atcp.ho<-summary(lm.ho.1.atcp.ho)$coefficients
ho.1.slope.atcp.ho<-ho.lm.1.s.atcp.ho[2,1]
lm.ho.2.atcp.ho<-lm(e2.1.atcp.ho$energy_over_time~as.numeric(david2.1.atcp.ho$normDS))
ho.lm.2.s.atcp.ho<-summary(lm.ho.2.atcp.ho)$coefficients
ho.2.slope.atcp.ho<-ho.lm.2.s.atcp.ho[2,1]
lm.ho.3.atcp.ho<-lm(e3.1.atcp.ho$energy_over_time~as.numeric(david3.1.atcp.ho$normDS))
ho.lm.3.s.atcp.ho<-summary(lm.ho.3.atcp.ho)$coefficients
ho.3.slope.atcp.ho<-ho.lm.3.s.atcp.ho[2,1]
lm.ho.4.atcp.ho<-lm(e4.1.atcp.ho$energy_over_time~as.numeric(david4.1.atcp.ho$normDS))
ho.lm.4.s.atcp.ho<-summary(lm.ho.4.atcp.ho)$coefficients
ho.4.slope.atcp.ho<-ho.lm.4.s.atcp.ho[2,1]
lm.ho.5.atcp.ho<-lm(e5.1.atcp.ho$energy_over_time~as.numeric(david5.1.atcp.ho$normDS))
ho.lm.5.s.atcp.ho<-summary(lm.ho.5.atcp.ho)$coefficients
ho.5.slope.atcp.ho<-ho.lm.5.s.atcp.ho[2,1]
lm.ho.6.atcp.ho<-lm(e6.1.atcp.ho$energy_over_time~as.numeric(david6.1.atcp.ho$normDS))
ho.lm.6.s.atcp.ho<-summary(lm.ho.6.atcp.ho)$coefficients
ho.6.slope.atcp.ho<-ho.lm.6.s.atcp.ho[2,1]
lm.ho.7.atcp.ho<-lm(e7.1.atcp.ho$energy_over_time~as.numeric(david7.1.atcp.ho$normDS))
ho.lm.7.s.atcp.ho<-summary(lm.ho.7.atcp.ho)$coefficients
ho.7.slope.atcp.ho<-ho.lm.7.s.atcp.ho[2,1]
lm.ho.8.atcp.ho<-lm(e8.1.atcp.ho$energy_over_time~as.numeric(david8.1.atcp.ho$normDS))
ho.lm.8.s.atcp.ho<-summary(lm.ho.8.atcp.ho)$coefficients
ho.8.slope.atcp.ho<-ho.lm.8.s.atcp.ho[2,1]
lm.ho.9.atcp.ho<-lm(e9.1.atcp.ho$energy_over_time~as.numeric(david9.1.atcp.ho$normDS))
ho.lm.9.s.atcp.ho<-summary(lm.ho.9.atcp.ho)$coefficients
ho.9.slope.atcp.ho<-ho.lm.9.s.atcp.ho[2,1]
lm.ho.10.atcp.ho<-lm(e10.1.atcp.ho$energy_over_time~as.numeric(david10.1.atcp.ho$normDS))
ho.lm.10.s.atcp.ho<-summary(lm.ho.10.atcp.ho)$coefficients
ho.10.slope.atcp.ho<-ho.lm.10.s.atcp.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.atcp.ss.attacks.atcp.ho<-data.frame(triangle.transitivity=c(tri1.atcp.ho,tri2.atcp.ho,tri3.atcp.ho,tri4.atcp.ho,tri5.atcp.ho,tri6.atcp.ho,tri7.atcp.ho,tri8.atcp.ho,tri9.atcp.ho,tri10.atcp.ho),escalation=c(ep1.atcp.ho,ep2.atcp.ho,ep3.atcp.ho,ep4.atcp.ho,ep5.atcp.ho,ep6.atcp.ho,ep7.atcp.ho,ep8.atcp.ho,ep9.atcp.ho,ep10.atcp.ho),dci=c(dci1.atcp.ho,dci2.atcp.ho,dci3.atcp.ho,dci4.atcp.ho,dci5.atcp.ho,dci6.atcp.ho,dci7.atcp.ho,dci8.atcp.ho,dci9.atcp.ho,dci10.atcp.ho),steepness=c(s1.atcp.ho,s2.atcp.ho,s3.atcp.ho,s4.atcp.ho,s5.atcp.ho,s6.atcp.ho,s7.atcp.ho,s8.atcp.ho,s9.atcp.ho,s10.atcp.ho),slope=c(ho.1.slope.atcp.ho,ho.2.slope.atcp.ho,ho.3.slope.atcp.ho,ho.4.slope.atcp.ho,ho.5.slope.atcp.ho,ho.6.slope.atcp.ho,ho.7.slope.atcp.ho,ho.8.slope.atcp.ho,ho.9.slope.atcp.ho,ho.10.slope.atcp.ho))
```
```{r Attacks Clumped Probabilistic Data Frame}
#knowledge mutual
km.tt.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$triangle.transitivity)
km.dci.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$dci)
km.esc.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$escalation)
km.steep.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$steepness)
km.slope.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$slope)
km.mean.pc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.attacks,dci=km.dci.pc.attacks,esc=km.esc.pc.attacks,steepness=km.steep.pc.attacks,slope=km.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$triangle.transitivity)
ks.dci.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$dci)
ks.esc.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$escalation)
ks.steep.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$steepness)
ks.slope.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$slope)
ks.mean.pc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.attacks,dci=ks.dci.pc.attacks,esc=ks.esc.pc.attacks,steepness=ks.steep.pc.attacks,slope=ks.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$triangle.transitivity)
ko.dci.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$dci)
ko.esc.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$escalation)
ko.steep.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$steepness)
ko.slope.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$slope)
ko.mean.pc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.attacks,dci=ko.dci.pc.attacks,esc=ko.esc.pc.attacks,steepness=ko.steep.pc.attacks,slope=ko.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$triangle.transitivity)
hm.dci.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$dci)
hm.esc.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$escalation)
hm.steep.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$steepness)
hm.slope.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$slope)
hm.mean.pc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.pc.attacks,dci=hm.dci.pc.attacks,esc=hm.esc.pc.attacks,steepness=hm.steep.pc.attacks,slope=hm.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$triangle.transitivity)
hs.dci.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$dci)
hs.esc.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$escalation)
hs.steep.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$steepness)
hs.slope.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$slope)
hs.mean.pc.attacks<-data.frame(scenario="History self",tt=hs.tt.pc.attacks,dci=hs.dci.pc.attacks,esc=hs.esc.pc.attacks,steepness=hs.steep.pc.attacks,slope=hs.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$triangle.transitivity)
ho.dci.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$dci)
ho.esc.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$escalation)
ho.steep.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$steepness)
ho.slope.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$slope)
ho.mean.pc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.pc.attacks,dci=ho.dci.pc.attacks,esc=ho.esc.pc.attacks,steepness=ho.steep.pc.attacks,slope=ho.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.pc.attacks,ks.mean.pc.attacks,ko.mean.pc.attacks,hm.mean.pc.attacks,hs.mean.pc.attacks,ho.mean.pc.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$triangle.transitivity)
km.dci.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$dci)
km.esc.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$escalation)
km.steep.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$steepness)
km.slope.pc.attacks<-mean(km.atcp.ss.attacks.atcp.km$slope)
km.mean.pc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.attacks,dci=km.dci.pc.attacks,esc=km.esc.pc.attacks,steepness=km.steep.pc.attacks,slope=km.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$triangle.transitivity)
ks.dci.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$dci)
ks.esc.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$escalation)
ks.steep.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$steepness)
ks.slope.pc.attacks<-mean(ks.atcp.ss.attacks.atcp.ks$slope)
ks.mean.pc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.attacks,dci=ks.dci.pc.attacks,esc=ks.esc.pc.attacks,steepness=ks.steep.pc.attacks,slope=ks.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$triangle.transitivity)
ko.dci.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$dci)
ko.esc.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$escalation)
ko.steep.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$steepness)
ko.slope.pc.attacks<-mean(ko.atcp.ss.attacks.atcp.ko$slope)
ko.mean.pc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.attacks,dci=ko.dci.pc.attacks,esc=ko.esc.pc.attacks,steepness=ko.steep.pc.attacks,slope=ko.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$triangle.transitivity)
hm.dci.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$dci)
hm.esc.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$escalation)
hm.steep.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$steepness)
hm.slope.pc.attacks<-mean(hm.atcp.ss.attacks.atcp.hm$slope)
hm.mean.pc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.pc.attacks,dci=hm.dci.pc.attacks,esc=hm.esc.pc.attacks,steepness=hm.steep.pc.attacks,slope=hm.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$triangle.transitivity)
hs.dci.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$dci)
hs.esc.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$escalation)
hs.steep.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$steepness)
hs.slope.pc.attacks<-mean(hs.atcp.ss.attacks.atcp.hs$slope)
hs.mean.pc.attacks<-data.frame(scenario="History self",tt=hs.tt.pc.attacks,dci=hs.dci.pc.attacks,esc=hs.esc.pc.attacks,steepness=hs.steep.pc.attacks,slope=hs.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$triangle.transitivity)
ho.dci.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$dci)
ho.esc.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$escalation)
ho.steep.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$steepness)
ho.slope.pc.attacks<-mean(ho.atcp.ss.attacks.atcp.ho$slope)
ho.mean.pc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.pc.attacks,dci=ho.dci.pc.attacks,esc=ho.esc.pc.attacks,steepness=ho.steep.pc.attacks,slope=ho.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.pc.attacks,ks.mean.pc.attacks,ko.mean.pc.attacks,hm.mean.pc.attacks,hs.mean.pc.attacks,ho.mean.pc.attacks)

#create overall dataframe of summary statistics
overall.prob.clumped.attacks<-data.frame(km.atcp.ss.attacks.atcp.km)
overall.prob.clumped.attacks<-rbind(overall.prob.clumped.attacks,ks.atcp.ss.attacks.atcp.ks)
overall.prob.clumped.attacks<-rbind(overall.prob.clumped.attacks,ko.atcp.ss.attacks.atcp.ko)
overall.prob.clumped.attacks<-rbind(overall.prob.clumped.attacks,hm.atcp.ss.attacks.atcp.hm)
overall.prob.clumped.attacks<-rbind(overall.prob.clumped.attacks,hs.atcp.ss.attacks.atcp.hs)
overall.prob.clumped.attacks<-rbind(overall.prob.clumped.attacks,ho.atcp.ss.attacks.atcp.ho)

overall.prob.clumped.attacks<-cbind(overall.prob.clumped.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.prob.clumped.attacks<-cbind(overall.prob.clumped.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ss.attacks<-overall.prob.clumped.attacks[overall.prob.clumped.attacks$variable=="rhp",]
history.ss.attacks<-overall.prob.clumped.attacks[overall.prob.clumped.attacks$variable=="history",]

overall.prob.clumped.attacks$combo<-paste(overall.prob.clumped.attacks$strategy,overall.prob.clumped.attacks$variable,overall.prob.clumped.attacks$distribution)
overall.prob.clumped.attacks$combo2<-paste(overall.prob.clumped.attacks$strategy,overall.prob.clumped.attacks$variable)
```

## Uniform Probabilistic Data
```{r Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.km<-data.frame(X1=avoid.up.km[[1]],X2=avoid.up.km[[2]],Avoids=avoid.up.km[[3]])
a2.up.km<-data.frame(X1=avoid.up.km[[4]],X2=avoid.up.km[[5]],Avoids=avoid.up.km[[6]])
a3.up.km<-data.frame(X1=avoid.up.km[[7]],X2=avoid.up.km[[8]],Avoids=avoid.up.km[[9]])
a4.up.km<-data.frame(X1=avoid.up.km[[10]],X2=avoid.up.km[[11]],Avoids=avoid.up.km[[12]])
a5.up.km<-data.frame(X1=avoid.up.km[[13]],X2=avoid.up.km[[14]],Avoids=avoid.up.km[[15]])
a6.up.km<-data.frame(X1=avoid.up.km[[16]],X2=avoid.up.km[[17]],Avoids=avoid.up.km[[18]])
a7.up.km<-data.frame(X1=avoid.up.km[[19]],X2=avoid.up.km[[20]],Avoids=avoid.up.km[[21]])
a8.up.km<-data.frame(X1=avoid.up.km[[22]],X2=avoid.up.km[[23]],Avoids=avoid.up.km[[24]])
a9.up.km<-data.frame(X1=avoid.up.km[[25]],X2=avoid.up.km[[26]],Avoids=avoid.up.km[[27]])
a10.up.km<-data.frame(X1=avoid.up.km[[28]],X2=avoid.up.km[[29]],Avoids=avoid.up.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.km.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.km<-data.frame(X1=conflict.km.up[[1]],X2=conflict.km.up[[2]],Victories=conflict.km.up[[3]])
mat1.up.km<-inter.mat(mut1.up.km)
tri1.up.km<-tr.tri(mat1.up.km)
dci1.up.km<-DCindex(mat1.up.km)
mat1.up.km[is.na(mat1.up.km)] = 0
h1.up.km<-h.index(mat1.up.km)

ep1.up.km<-ep(mut1.up.km,a1.up.km)
david1.up.km<-DS(mat1.up.km) #David's Scores - for steepness use normDS output
ordrank.1.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.km<-cbind(ordrank.1.up.km,ds=david1.up.km$normDS)
lm1.up.km<-summary(lm(ordrank.1.up.km$ds~ordrank.1.up.km$ord.rank))
s1.up.km<-lm1.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.km<-data.frame(X1=conflict.km.up[[4]],X2=conflict.km.up[[5]],Victories=conflict.km.up[[6]])
mat2.up.km<-inter.mat(mut2.up.km)
tri2.up.km<-tr.tri(mat2.up.km)
dci2.up.km<-DCindex(mat2.up.km)
mat2.up.km[is.na(mat2.up.km)] = 0
h2.up.km<-h.index(mat2.up.km)

ep2.up.km<-ep(mut2.up.km,a2.up.km)
david2.up.km<-DS(mat2.up.km) #David's Scores - for steepness use normDS output
ordrank.2.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.km<-cbind(ordrank.2.up.km,ds=david2.up.km$normDS)
lm2.up.km<-summary(lm(ordrank.2.up.km$ds~ordrank.2.up.km$ord.rank))
s2.up.km<-lm2.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.km<-data.frame(X1=conflict.km.up[[7]],X2=conflict.km.up[[8]],Victories=conflict.km.up[[9]])
mat3.up.km<-inter.mat(mut3.up.km)
tri3.up.km<-tr.tri(mat3.up.km)
dci3.up.km<-DCindex(mat3.up.km)
mat3.up.km[is.na(mat3.up.km)] = 0
h3.up.km<-h.index(mat3.up.km)

ep3.up.km<-ep(mut3.up.km,a3.up.km)
david3.up.km<-DS(mat3.up.km) #David's Scores - for steepness use normDS output
ordrank.3.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.km<-cbind(ordrank.3.up.km,ds=david3.up.km$normDS)
lm3.up.km<-summary(lm(ordrank.3.up.km$ds~ordrank.3.up.km$ord.rank))
s3.up.km<-lm3.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.km<-data.frame(X1=conflict.km.up[[10]],X2=conflict.km.up[[11]],Victories=conflict.km.up[[12]])
mat4.up.km<-inter.mat(mut4.up.km)
tri4.up.km<-tr.tri(mat4.up.km)
dci4.up.km<-DCindex(mat4.up.km)
mat4.up.km[is.na(mat4.up.km)] = 0
h4.up.km<-h.index(mat4.up.km)

ep4.up.km<-ep(mut4.up.km,a4.up.km)
david4.up.km<-DS(mat4.up.km) #David's Scores - for steepness use normDS output
ordrank.4.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.km<-cbind(ordrank.4.up.km,ds=david4.up.km$normDS)
lm4.up.km<-summary(lm(ordrank.4.up.km$ds~ordrank.4.up.km$ord.rank))
s4.up.km<-lm4.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.km<-data.frame(X1=conflict.km.up[[13]],X2=conflict.km.up[[14]],Victories=conflict.km.up[[15]])
mat5.up.km<-inter.mat(mut5.up.km)
tri5.up.km<-tr.tri(mat5.up.km)
dci5.up.km<-DCindex(mat5.up.km)
mat5.up.km[is.na(mat5.up.km)] = 0
h5.up.km<-h.index(mat5.up.km)

ep5.up.km<-ep(mut5.up.km,a5.up.km)
david5.up.km<-DS(mat5.up.km) #David's Scores - for steepness use normDS output
ordrank.5.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.km<-cbind(ordrank.5.up.km,ds=david5.up.km$normDS)
lm5.up.km<-summary(lm(ordrank.5.up.km$ds~ordrank.5.up.km$ord.rank))
s5.up.km<-lm5.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.km<-data.frame(X1=conflict.km.up[[16]],X2=conflict.km.up[[17]],Victories=conflict.km.up[[18]])
mat6.up.km<-inter.mat(mut6.up.km)
tri6.up.km<-tr.tri(mat6.up.km)
dci6.up.km<-DCindex(mat6.up.km)
mat6.up.km[is.na(mat6.up.km)] = 0
h6.up.km<-h.index(mat6.up.km)

ep6.up.km<-ep(mut6.up.km,a6.up.km)
david6.up.km<-DS(mat6.up.km) #David's Scores - for steepness use normDS output
ordrank.6.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.km<-cbind(ordrank.6.up.km,ds=david6.up.km$normDS)
lm6.up.km<-summary(lm(ordrank.6.up.km$ds~ordrank.6.up.km$ord.rank))
s6.up.km<-lm6.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.km<-data.frame(X1=conflict.km.up[[19]],X2=conflict.km.up[[20]],Victories=conflict.km.up[[21]])
mat7.up.km<-inter.mat(mut7.up.km)
tri7.up.km<-tr.tri(mat7.up.km)
dci7.up.km<-DCindex(mat7.up.km)
mat7.up.km[is.na(mat7.up.km)] = 0
h7.up.km<-h.index(mat7.up.km)

ep7.up.km<-ep(mut7.up.km,a7.up.km)
david7.up.km<-DS(mat7.up.km) #David's Scores - for steepness use normDS output
ordrank.7.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.km<-cbind(ordrank.7.up.km,ds=david7.up.km$normDS)
lm7.up.km<-summary(lm(ordrank.7.up.km$ds~ordrank.7.up.km$ord.rank))
s7.up.km<-lm7.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.km<-data.frame(X1=conflict.km.up[[22]],X2=conflict.km.up[[23]],Victories=conflict.km.up[[24]])
mat8.up.km<-inter.mat(mut8.up.km)
tri8.up.km<-tr.tri(mat8.up.km)
dci8.up.km<-DCindex(mat8.up.km)
mat8.up.km[is.na(mat8.up.km)] = 0
h8.up.km<-h.index(mat8.up.km)

ep8.up.km<-ep(mut8.up.km,a8.up.km)
david8.up.km<-DS(mat8.up.km) #David's Scores - for steepness use normDS output
ordrank.8.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.km<-cbind(ordrank.8.up.km,ds=david8.up.km$normDS)
lm8.up.km<-summary(lm(ordrank.8.up.km$ds~ordrank.8.up.km$ord.rank))
s8.up.km<-lm8.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.km<-data.frame(X1=conflict.km.up[[25]],X2=conflict.km.up[[26]],Victories=conflict.km.up[[27]])
mat9.up.km<-inter.mat(mut9.up.km)
tri9.up.km<-tr.tri(mat9.up.km)
dci9.up.km<-DCindex(mat9.up.km)
mat9.up.km[is.na(mat9.up.km)] = 0
h9.up.km<-h.index(mat9.up.km)

ep9.up.km<-ep(mut9.up.km,a9.up.km)
david9.up.km<-DS(mat9.up.km) #David's Scores - for steepness use normDS output
ordrank.9.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.km<-cbind(ordrank.9.up.km,ds=david9.up.km$normDS)
lm9.up.km<-summary(lm(ordrank.9.up.km$ds~ordrank.9.up.km$ord.rank))
s9.up.km<-lm9.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.km<-data.frame(X1=conflict.km.up[[28]],X2=conflict.km.up[[29]],Victories=conflict.km.up[[30]])
mat10.up.km<-inter.mat(mut10.up.km)
tri10.up.km<-tr.tri(mat10.up.km)
dci10.up.km<-DCindex(mat10.up.km)
mat10.up.km[is.na(mat10.up.km)] = 0
h10.up.km<-h.index(mat10.up.km)

ep10.up.km<-ep(mut10.up.km,a10.up.km)
david10.up.km<-DS(mat10.up.km) #David's Scores - for steepness use normDS output
ordrank.10.up.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.km<-cbind(ordrank.10.up.km,ds=david10.up.km$normDS)
lm10.up.km<-summary(lm(ordrank.10.up.km$ds~ordrank.10.up.km$ord.rank))
s10.up.km<-lm10.up.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.km<-sum(mut1.up.km$Victories)
int2.up.km<-sum(mut2.up.km$Victories)
int3.up.km<-sum(mut3.up.km$Victories)
int4.up.km<-sum(mut4.up.km$Victories)
int5.up.km<-sum(mut5.up.km$Victories)
int6.up.km<-sum(mut6.up.km$Victories)
int7.up.km<-sum(mut7.up.km$Victories)
int8.up.km<-sum(mut8.up.km$Victories)
int9.up.km<-sum(mut9.up.km$Victories)
int10.up.km<-sum(mut10.up.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.km<-sum(a1.up.km$Victories)
av2.up.km<-sum(a2.up.km$Victories)
av3.up.km<-sum(a3.up.km$Victories)
av4.up.km<-sum(a4.up.km$Victories)
av5.up.km<-sum(a5.up.km$Victories)
av6.up.km<-sum(a6.up.km$Victories)
av7.up.km<-sum(a7.up.km$Victories)
av8.up.km<-sum(a8.up.km$Victories)
av9.up.km<-sum(a9.up.km$Victories)
av10.up.km<-sum(a10.up.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.pu<-(sum(av1.up.km, av2.up.km, av3.up.km, av4.up.km, av5.up.km, av6.up.km, av7.up.km, av8.up.km, av9.up.km, av10.up.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.pu<-(sum(int1.up.km, int2.up.km, int3.up.km, int4.up.km, int5.up.km, int6.up.km, int7.up.km, int8.up.km, int9.up.km, int10.up.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.km<-e1.up.km[order(e1.up.km$ID),]
e1.up.km<-as.matrix(t(e1.1.up.km))

e2.up.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.km<-e2.up.km[order(e2.up.km$ID),]
e2.up.km<-as.matrix(t(e2.1.up.km))

e3.up.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.km<-e3.up.km[order(e3.up.km$ID),]
e3.up.km<-as.matrix(t(e3.1.up.km))

e4.up.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.km<-e4.up.km[order(e4.up.km$ID),]
e4.up.km<-as.matrix(t(e4.1.up.km))

e5.up.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.km<-e5.up.km[order(e5.up.km$ID),]
e5.up.km<-as.matrix(t(e5.1.up.km))

e6.up.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.km<-e6.up.km[order(e6.up.km$ID),]
e6.up.km<-as.matrix(t(e6.1.up.km))

e7.up.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.km<-e7.up.km[order(e7.up.km$ID),]
e7.up.km<-as.matrix(t(e7.1.up.km))

e8.up.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.km<-e8.up.km[order(e8.up.km$ID),]
e8.up.km<-as.matrix(t(e8.1.up.km))

e9.up.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.km<-e9.up.km[order(e9.up.km$ID),]
e9.up.km<-as.matrix(t(e9.1.up.km))

e10.up.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.km<-e10.up.km[order(e10.up.km$ID),]
e10.up.km<-as.matrix(t(e10.1.up.km))

energy.km.up.km<-as.data.frame(matrix(c(e1.up.km,e2.up.km,e3.up.km,e4.up.km,e5.up.km,e6.up.km,e7.up.km,e8.up.km,e9.up.km,e10.up.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.up.km<-data.frame(ID=energy.km.up.km$V1,energy_over_distance=energy.km.up.km$V2,energy_over_time=energy.km.up.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.km<-david1.up.km[order(david1.up.km$ID),]
david1.up.km<-as.matrix(t(david1.1.up.km))

david2.1.up.km<-david2.up.km[order(david2.up.km$ID),]
david2.up.km<-as.matrix(t(david2.1.up.km))

david3.1.up.km<-david3.up.km[order(david3.up.km$ID),]
david3.up.km<-as.matrix(t(david3.1.up.km))

david4.1.up.km<-david4.up.km[order(david4.up.km$ID),]
david4.up.km<-as.matrix(t(david4.1.up.km))

david5.1.up.km<-david5.up.km[order(david5.up.km$ID),]
david5.up.km<-as.matrix(t(david5.1.up.km))

david6.1.up.km<-david6.up.km[order(david6.up.km$ID),]
david6.up.km<-as.matrix(t(david6.1.up.km))

david7.1.up.km<-david7.up.km[order(david7.up.km$ID),]
david7.up.km<-as.matrix(t(david7.1.up.km))

david8.1.up.km<-david8.up.km[order(david8.up.km$ID),]
david8.up.km<-as.matrix(t(david8.1.up.km))

david9.1.up.km<-david9.up.km[order(david9.up.km$ID),]
david9.up.km<-as.matrix(t(david9.1.up.km))

david10.1.up.km<-david10.up.km[order(david10.up.km$ID),]
david10.up.km<-as.matrix(t(david10.1.up.km))

david.km.up.km<-as.data.frame(matrix(c(david1.up.km,david2.up.km,david3.up.km,david4.up.km,david5.up.km,david6.up.km,david7.up.km,david8.up.km,david9.up.km,david10.up.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.up.km<-data.frame(ID=david.km.up.km$V1,DS=david.km.up.km$V2,normDS=david.km.up.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.up.km<-lm(e1.1.up.km$energy_over_time~as.numeric(david1.1.up.km$normDS))
km.lm.1.s.up.km<-summary(lm.km.1.up.km)$coefficients
km.1.slope.up.km<-km.lm.1.s.up.km[2,1]
lm.km.2.up.km<-lm(e2.1.up.km$energy_over_time~as.numeric(david2.1.up.km$normDS))
km.lm.2.s.up.km<-summary(lm.km.2.up.km)$coefficients
km.2.slope.up.km<-km.lm.2.s.up.km[2,1]
lm.km.3.up.km<-lm(e3.1.up.km$energy_over_time~as.numeric(david3.1.up.km$normDS))
km.lm.3.s.up.km<-summary(lm.km.3.up.km)$coefficients
km.3.slope.up.km<-km.lm.3.s.up.km[2,1]
lm.km.4.up.km<-lm(e4.1.up.km$energy_over_time~as.numeric(david4.1.up.km$normDS))
km.lm.4.s.up.km<-summary(lm.km.4.up.km)$coefficients
km.4.slope.up.km<-km.lm.4.s.up.km[2,1]
lm.km.5.up.km<-lm(e5.1.up.km$energy_over_time~as.numeric(david5.1.up.km$normDS))
km.lm.5.s.up.km<-summary(lm.km.5.up.km)$coefficients
km.5.slope.up.km<-km.lm.5.s.up.km[2,1]
lm.km.6.up.km<-lm(e6.1.up.km$energy_over_time~as.numeric(david6.1.up.km$normDS))
km.lm.6.s.up.km<-summary(lm.km.6.up.km)$coefficients
km.6.slope.up.km<-km.lm.6.s.up.km[2,1]
lm.km.7.up.km<-lm(e7.1.up.km$energy_over_time~as.numeric(david7.1.up.km$normDS))
km.lm.7.s.up.km<-summary(lm.km.7.up.km)$coefficients
km.7.slope.up.km<-km.lm.7.s.up.km[2,1]
lm.km.8.up.km<-lm(e8.1.up.km$energy_over_time~as.numeric(david8.1.up.km$normDS))
km.lm.8.s.up.km<-summary(lm.km.8.up.km)$coefficients
km.8.slope.up.km<-km.lm.8.s.up.km[2,1]
lm.km.9.up.km<-lm(e9.1.up.km$energy_over_time~as.numeric(david9.1.up.km$normDS))
km.lm.9.s.up.km<-summary(lm.km.9.up.km)$coefficients
km.9.slope.up.km<-km.lm.9.s.up.km[2,1]
lm.km.10.up.km<-lm(e10.1.up.km$energy_over_time~as.numeric(david10.1.up.km$normDS))
km.lm.10.s.up.km<-summary(lm.km.10.up.km)$coefficients
km.10.slope.up.km<-km.lm.10.s.up.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.up.ss<-data.frame(triangle.transitivity=c(tri1.up.km,tri2.up.km,tri3.up.km,tri4.up.km,tri5.up.km,tri6.up.km,tri7.up.km,tri8.up.km,tri9.up.km,tri10.up.km),escalation=c(ep1.up.km,ep2.up.km,ep3.up.km,ep4.up.km,ep5.up.km,ep6.up.km,ep7.up.km,ep8.up.km,ep9.up.km,ep10.up.km),dci=c(dci1.up.km,dci2.up.km,dci3.up.km,dci4.up.km,dci5.up.km,dci6.up.km,dci7.up.km,dci8.up.km,dci9.up.km,dci10.up.km),steepness=c(s1.up.km,s2.up.km,s3.up.km,s4.up.km,s5.up.km,s6.up.km,s7.up.km,s8.up.km,s9.up.km,s10.up.km),slope=c(km.1.slope.up.km,km.2.slope.up.km,km.3.slope.up.km,km.4.slope.up.km,km.5.slope.up.km,km.6.slope.up.km,km.7.slope.up.km,km.8.slope.up.km,km.9.slope.up.km,km.10.slope.up.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.ks<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.ks<-data.frame(X1=avoid.up.ks[[1]],X2=avoid.up.ks[[2]],Avoids=avoid.up.ks[[3]])
a2.up.ks<-data.frame(X1=avoid.up.ks[[4]],X2=avoid.up.ks[[5]],Avoids=avoid.up.ks[[6]])
a3.up.ks<-data.frame(X1=avoid.up.ks[[7]],X2=avoid.up.ks[[8]],Avoids=avoid.up.ks[[9]])
a4.up.ks<-data.frame(X1=avoid.up.ks[[10]],X2=avoid.up.ks[[11]],Avoids=avoid.up.ks[[12]])
a5.up.ks<-data.frame(X1=avoid.up.ks[[13]],X2=avoid.up.ks[[14]],Avoids=avoid.up.ks[[15]])
a6.up.ks<-data.frame(X1=avoid.up.ks[[16]],X2=avoid.up.ks[[17]],Avoids=avoid.up.ks[[18]])
a7.up.ks<-data.frame(X1=avoid.up.ks[[19]],X2=avoid.up.ks[[20]],Avoids=avoid.up.ks[[21]])
a8.up.ks<-data.frame(X1=avoid.up.ks[[22]],X2=avoid.up.ks[[23]],Avoids=avoid.up.ks[[24]])
a9.up.ks<-data.frame(X1=avoid.up.ks[[25]],X2=avoid.up.ks[[26]],Avoids=avoid.up.ks[[27]])
a10.up.ks<-data.frame(X1=avoid.up.ks[[28]],X2=avoid.up.ks[[29]],Avoids=avoid.up.ks[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ks.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.ks<-data.frame(X1=conflict.ks.up[[1]],X2=conflict.ks.up[[2]],Victories=conflict.ks.up[[3]])
mat1.up.ks<-inter.mat(mut1.up.ks)
tri1.up.ks<-tr.tri(mat1.up.ks)
dci1.up.ks<-DCindex(mat1.up.ks)
mat1.up.ks[is.na(mat1.up.ks)] = 0
h1.up.ks<-h.index(mat1.up.ks)

ep1.up.ks<-ep(mut1.up.ks,a1.up.ks)
david1.up.ks<-DS(mat1.up.ks) #David's Scores - for steepness use normDS output
ordrank.1.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.ks<-cbind(ordrank.1.up.ks,ds=david1.up.ks$normDS)
lm1.up.ks<-summary(lm(ordrank.1.up.ks$ds~ordrank.1.up.ks$ord.rank))
s1.up.ks<-lm1.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.ks<-data.frame(X1=conflict.ks.up[[4]],X2=conflict.ks.up[[5]],Victories=conflict.ks.up[[6]])
mat2.up.ks<-inter.mat(mut2.up.ks)
tri2.up.ks<-tr.tri(mat2.up.ks)
dci2.up.ks<-DCindex(mat2.up.ks)
mat2.up.ks[is.na(mat2.up.ks)] = 0
h2.up.ks<-h.index(mat2.up.ks)

ep2.up.ks<-ep(mut2.up.ks,a2.up.ks)
david2.up.ks<-DS(mat2.up.ks) #David's Scores - for steepness use normDS output
ordrank.2.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.ks<-cbind(ordrank.2.up.ks,ds=david2.up.ks$normDS)
lm2.up.ks<-summary(lm(ordrank.2.up.ks$ds~ordrank.2.up.ks$ord.rank))
s2.up.ks<-lm2.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.ks<-data.frame(X1=conflict.ks.up[[7]],X2=conflict.ks.up[[8]],Victories=conflict.ks.up[[9]])
mat3.up.ks<-inter.mat(mut3.up.ks)
tri3.up.ks<-tr.tri(mat3.up.ks)
dci3.up.ks<-DCindex(mat3.up.ks)
mat3.up.ks[is.na(mat3.up.ks)] = 0
h3.up.ks<-h.index(mat3.up.ks)

ep3.up.ks<-ep(mut3.up.ks,a3.up.ks)
david3.up.ks<-DS(mat3.up.ks) #David's Scores - for steepness use normDS output
ordrank.3.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.ks<-cbind(ordrank.3.up.ks,ds=david3.up.ks$normDS)
lm3.up.ks<-summary(lm(ordrank.3.up.ks$ds~ordrank.3.up.ks$ord.rank))
s3.up.ks<-lm3.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.ks<-data.frame(X1=conflict.ks.up[[10]],X2=conflict.ks.up[[11]],Victories=conflict.ks.up[[12]])
mat4.up.ks<-inter.mat(mut4.up.ks)
tri4.up.ks<-tr.tri(mat4.up.ks)
dci4.up.ks<-DCindex(mat4.up.ks)
mat4.up.ks[is.na(mat4.up.ks)] = 0
h4.up.ks<-h.index(mat4.up.ks)

ep4.up.ks<-ep(mut4.up.ks,a4.up.ks)
david4.up.ks<-DS(mat4.up.ks) #David's Scores - for steepness use normDS output
ordrank.4.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.ks<-cbind(ordrank.4.up.ks,ds=david4.up.ks$normDS)
lm4.up.ks<-summary(lm(ordrank.4.up.ks$ds~ordrank.4.up.ks$ord.rank))
s4.up.ks<-lm4.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.ks<-data.frame(X1=conflict.ks.up[[13]],X2=conflict.ks.up[[14]],Victories=conflict.ks.up[[15]])
mat5.up.ks<-inter.mat(mut5.up.ks)
tri5.up.ks<-tr.tri(mat5.up.ks)
dci5.up.ks<-DCindex(mat5.up.ks)
mat5.up.ks[is.na(mat5.up.ks)] = 0
h5.up.ks<-h.index(mat5.up.ks)

ep5.up.ks<-ep(mut5.up.ks,a5.up.ks)
david5.up.ks<-DS(mat5.up.ks) #David's Scores - for steepness use normDS output
ordrank.5.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.ks<-cbind(ordrank.5.up.ks,ds=david5.up.ks$normDS)
lm5.up.ks<-summary(lm(ordrank.5.up.ks$ds~ordrank.5.up.ks$ord.rank))
s5.up.ks<-lm5.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.ks<-data.frame(X1=conflict.ks.up[[16]],X2=conflict.ks.up[[17]],Victories=conflict.ks.up[[18]])
mat6.up.ks<-inter.mat(mut6.up.ks)
tri6.up.ks<-tr.tri(mat6.up.ks)
dci6.up.ks<-DCindex(mat6.up.ks)
mat6.up.ks[is.na(mat6.up.ks)] = 0
h6.up.ks<-h.index(mat6.up.ks)

ep6.up.ks<-ep(mut6.up.ks,a6.up.ks)
david6.up.ks<-DS(mat6.up.ks) #David's Scores - for steepness use normDS output
ordrank.6.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.ks<-cbind(ordrank.6.up.ks,ds=david6.up.ks$normDS)
lm6.up.ks<-summary(lm(ordrank.6.up.ks$ds~ordrank.6.up.ks$ord.rank))
s6.up.ks<-lm6.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.ks<-data.frame(X1=conflict.ks.up[[19]],X2=conflict.ks.up[[20]],Victories=conflict.ks.up[[21]])
mat7.up.ks<-inter.mat(mut7.up.ks)
tri7.up.ks<-tr.tri(mat7.up.ks)
dci7.up.ks<-DCindex(mat7.up.ks)
mat7.up.ks[is.na(mat7.up.ks)] = 0
h7.up.ks<-h.index(mat7.up.ks)

ep7.up.ks<-ep(mut7.up.ks,a7.up.ks)
david7.up.ks<-DS(mat7.up.ks) #David's Scores - for steepness use normDS output
ordrank.7.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.ks<-cbind(ordrank.7.up.ks,ds=david7.up.ks$normDS)
lm7.up.ks<-summary(lm(ordrank.7.up.ks$ds~ordrank.7.up.ks$ord.rank))
s7.up.ks<-lm7.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.ks<-data.frame(X1=conflict.ks.up[[22]],X2=conflict.ks.up[[23]],Victories=conflict.ks.up[[24]])
mat8.up.ks<-inter.mat(mut8.up.ks)
tri8.up.ks<-tr.tri(mat8.up.ks)
dci8.up.ks<-DCindex(mat8.up.ks)
mat8.up.ks[is.na(mat8.up.ks)] = 0
h8.up.ks<-h.index(mat8.up.ks)

ep8.up.ks<-ep(mut8.up.ks,a8.up.ks)
david8.up.ks<-DS(mat8.up.ks) #David's Scores - for steepness use normDS output
ordrank.8.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.ks<-cbind(ordrank.8.up.ks,ds=david8.up.ks$normDS)
lm8.up.ks<-summary(lm(ordrank.8.up.ks$ds~ordrank.8.up.ks$ord.rank))
s8.up.ks<-lm8.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.ks<-data.frame(X1=conflict.ks.up[[25]],X2=conflict.ks.up[[26]],Victories=conflict.ks.up[[27]])
mat9.up.ks<-inter.mat(mut9.up.ks)
tri9.up.ks<-tr.tri(mat9.up.ks)
dci9.up.ks<-DCindex(mat9.up.ks)
mat9.up.ks[is.na(mat9.up.ks)] = 0
h9.up.ks<-h.index(mat9.up.ks)

ep9.up.ks<-ep(mut9.up.ks,a9.up.ks)
david9.up.ks<-DS(mat9.up.ks) #David's Scores - for steepness use normDS output
ordrank.9.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.ks<-cbind(ordrank.9.up.ks,ds=david9.up.ks$normDS)
lm9.up.ks<-summary(lm(ordrank.9.up.ks$ds~ordrank.9.up.ks$ord.rank))
s9.up.ks<-lm9.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.ks<-data.frame(X1=conflict.ks.up[[28]],X2=conflict.ks.up[[29]],Victories=conflict.ks.up[[30]])
mat10.up.ks<-inter.mat(mut10.up.ks)
tri10.up.ks<-tr.tri(mat10.up.ks)
dci10.up.ks<-DCindex(mat10.up.ks)
mat10.up.ks[is.na(mat10.up.ks)] = 0
h10.up.ks<-h.index(mat10.up.ks)

ep10.up.ks<-ep(mut10.up.ks,a10.up.ks)
david10.up.ks<-DS(mat10.up.ks) #David's Scores - for steepness use normDS output
ordrank.10.up.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.ks<-cbind(ordrank.10.up.ks,ds=david10.up.ks$normDS)
lm10.up.ks<-summary(lm(ordrank.10.up.ks$ds~ordrank.10.up.ks$ord.rank))
s10.up.ks<-lm10.up.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.ks<-sum(mut1.up.ks$Victories)
int2.up.ks<-sum(mut2.up.ks$Victories)
int3.up.ks<-sum(mut3.up.ks$Victories)
int4.up.ks<-sum(mut4.up.ks$Victories)
int5.up.ks<-sum(mut5.up.ks$Victories)
int6.up.ks<-sum(mut6.up.ks$Victories)
int7.up.ks<-sum(mut7.up.ks$Victories)
int8.up.ks<-sum(mut8.up.ks$Victories)
int9.up.ks<-sum(mut9.up.ks$Victories)
int10.up.ks<-sum(mut10.up.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.ks<-sum(a1.up.ks$Victories)
av2.up.ks<-sum(a2.up.ks$Victories)
av3.up.ks<-sum(a3.up.ks$Victories)
av4.up.ks<-sum(a4.up.ks$Victories)
av5.up.ks<-sum(a5.up.ks$Victories)
av6.up.ks<-sum(a6.up.ks$Victories)
av7.up.ks<-sum(a7.up.ks$Victories)
av8.up.ks<-sum(a8.up.ks$Victories)
av9.up.ks<-sum(a9.up.ks$Victories)
av10.up.ks<-sum(a10.up.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.pu<-(sum(av1.up.ks, av2.up.ks, av3.up.ks, av4.up.ks, av5.up.ks, av6.up.ks, av7.up.ks, av8.up.ks, av9.up.ks, av10.up.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.pu<-(sum(int1.up.ks, int2.up.ks, int3.up.ks, int4.up.ks, int5.up.ks, int6.up.ks, int7.up.ks, int8.up.ks, int9.up.ks, int10.up.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.ks<-e1.up.ks[order(e1.up.ks$ID),]
e1.up.ks<-as.matrix(t(e1.1.up.ks))

e2.up.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.ks<-e2.up.ks[order(e2.up.ks$ID),]
e2.up.ks<-as.matrix(t(e2.1.up.ks))

e3.up.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.ks<-e3.up.ks[order(e3.up.ks$ID),]
e3.up.ks<-as.matrix(t(e3.1.up.ks))

e4.up.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.ks<-e4.up.ks[order(e4.up.ks$ID),]
e4.up.ks<-as.matrix(t(e4.1.up.ks))

e5.up.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.ks<-e5.up.ks[order(e5.up.ks$ID),]
e5.up.ks<-as.matrix(t(e5.1.up.ks))

e6.up.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.ks<-e6.up.ks[order(e6.up.ks$ID),]
e6.up.ks<-as.matrix(t(e6.1.up.ks))

e7.up.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.ks<-e7.up.ks[order(e7.up.ks$ID),]
e7.up.ks<-as.matrix(t(e7.1.up.ks))

e8.up.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.ks<-e8.up.ks[order(e8.up.ks$ID),]
e8.up.ks<-as.matrix(t(e8.1.up.ks))

e9.up.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.ks<-e9.up.ks[order(e9.up.ks$ID),]
e9.up.ks<-as.matrix(t(e9.1.up.ks))

e10.up.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.ks<-e10.up.ks[order(e10.up.ks$ID),]
e10.up.ks<-as.matrix(t(e10.1.up.ks))

energy.ks.up.ks<-as.data.frame(matrix(c(e1.up.ks,e2.up.ks,e3.up.ks,e4.up.ks,e5.up.ks,e6.up.ks,e7.up.ks,e8.up.ks,e9.up.ks,e10.up.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.up.ks<-data.frame(ID=energy.ks.up.ks$V1,energy_over_distance=energy.ks.up.ks$V2,energy_over_time=energy.ks.up.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.ks<-david1.up.ks[order(david1.up.ks$ID),]
david1.up.ks<-as.matrix(t(david1.1.up.ks))

david2.1.up.ks<-david2.up.ks[order(david2.up.ks$ID),]
david2.up.ks<-as.matrix(t(david2.1.up.ks))

david3.1.up.ks<-david3.up.ks[order(david3.up.ks$ID),]
david3.up.ks<-as.matrix(t(david3.1.up.ks))

david4.1.up.ks<-david4.up.ks[order(david4.up.ks$ID),]
david4.up.ks<-as.matrix(t(david4.1.up.ks))

david5.1.up.ks<-david5.up.ks[order(david5.up.ks$ID),]
david5.up.ks<-as.matrix(t(david5.1.up.ks))

david6.1.up.ks<-david6.up.ks[order(david6.up.ks$ID),]
david6.up.ks<-as.matrix(t(david6.1.up.ks))

david7.1.up.ks<-david7.up.ks[order(david7.up.ks$ID),]
david7.up.ks<-as.matrix(t(david7.1.up.ks))

david8.1.up.ks<-david8.up.ks[order(david8.up.ks$ID),]
david8.up.ks<-as.matrix(t(david8.1.up.ks))

david9.1.up.ks<-david9.up.ks[order(david9.up.ks$ID),]
david9.up.ks<-as.matrix(t(david9.1.up.ks))

david10.1.up.ks<-david10.up.ks[order(david10.up.ks$ID),]
david10.up.ks<-as.matrix(t(david10.1.up.ks))

david.ks.up.ks<-as.data.frame(matrix(c(david1.up.ks,david2.up.ks,david3.up.ks,david4.up.ks,david5.up.ks,david6.up.ks,david7.up.ks,david8.up.ks,david9.up.ks,david10.up.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.up.ks<-data.frame(ID=david.ks.up.ks$V1,DS=david.ks.up.ks$V2,normDS=david.ks.up.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.up.ks<-lm(e1.1.up.ks$energy_over_time~as.numeric(david1.1.up.ks$normDS))
ks.lm.1.s.up.ks<-summary(lm.ks.1.up.ks)$coefficients
ks.1.slope.up.ks<-ks.lm.1.s.up.ks[2,1]
lm.ks.2.up.ks<-lm(e2.1.up.ks$energy_over_time~as.numeric(david2.1.up.ks$normDS))
ks.lm.2.s.up.ks<-summary(lm.ks.2.up.ks)$coefficients
ks.2.slope.up.ks<-ks.lm.2.s.up.ks[2,1]
lm.ks.3.up.ks<-lm(e3.1.up.ks$energy_over_time~as.numeric(david3.1.up.ks$normDS))
ks.lm.3.s.up.ks<-summary(lm.ks.3.up.ks)$coefficients
ks.3.slope.up.ks<-ks.lm.3.s.up.ks[2,1]
lm.ks.4.up.ks<-lm(e4.1.up.ks$energy_over_time~as.numeric(david4.1.up.ks$normDS))
ks.lm.4.s.up.ks<-summary(lm.ks.4.up.ks)$coefficients
ks.4.slope.up.ks<-ks.lm.4.s.up.ks[2,1]
lm.ks.5.up.ks<-lm(e5.1.up.ks$energy_over_time~as.numeric(david5.1.up.ks$normDS))
ks.lm.5.s.up.ks<-summary(lm.ks.5.up.ks)$coefficients
ks.5.slope.up.ks<-ks.lm.5.s.up.ks[2,1]
lm.ks.6.up.ks<-lm(e6.1.up.ks$energy_over_time~as.numeric(david6.1.up.ks$normDS))
ks.lm.6.s.up.ks<-summary(lm.ks.6.up.ks)$coefficients
ks.6.slope.up.ks<-ks.lm.6.s.up.ks[2,1]
lm.ks.7.up.ks<-lm(e7.1.up.ks$energy_over_time~as.numeric(david7.1.up.ks$normDS))
ks.lm.7.s.up.ks<-summary(lm.ks.7.up.ks)$coefficients
ks.7.slope.up.ks<-ks.lm.7.s.up.ks[2,1]
lm.ks.8.up.ks<-lm(e8.1.up.ks$energy_over_time~as.numeric(david8.1.up.ks$normDS))
ks.lm.8.s.up.ks<-summary(lm.ks.8.up.ks)$coefficients
ks.8.slope.up.ks<-ks.lm.8.s.up.ks[2,1]
lm.ks.9.up.ks<-lm(e9.1.up.ks$energy_over_time~as.numeric(david9.1.up.ks$normDS))
ks.lm.9.s.up.ks<-summary(lm.ks.9.up.ks)$coefficients
ks.9.slope.up.ks<-ks.lm.9.s.up.ks[2,1]
lm.ks.10.up.ks<-lm(e10.1.up.ks$energy_over_time~as.numeric(david10.1.up.ks$normDS))
ks.lm.10.s.up.ks<-summary(lm.ks.10.up.ks)$coefficients
ks.10.slope.up.ks<-ks.lm.10.s.up.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.up.ss<-data.frame(triangle.transitivity=c(tri1.up.ks,tri2.up.ks,tri3.up.ks,tri4.up.ks,tri5.up.ks,tri6.up.ks,tri7.up.ks,tri8.up.ks,tri9.up.ks,tri10.up.ks),escalation=c(ep1.up.ks,ep2.up.ks,ep3.up.ks,ep4.up.ks,ep5.up.ks,ep6.up.ks,ep7.up.ks,ep8.up.ks,ep9.up.ks,ep10.up.ks),dci=c(dci1.up.ks,dci2.up.ks,dci3.up.ks,dci4.up.ks,dci5.up.ks,dci6.up.ks,dci7.up.ks,dci8.up.ks,dci9.up.ks,dci10.up.ks),steepness=c(s1.up.ks,s2.up.ks,s3.up.ks,s4.up.ks,s5.up.ks,s6.up.ks,s7.up.ks,s8.up.ks,s9.up.ks,s10.up.ks),slope=c(ks.1.slope.up.ks,ks.2.slope.up.ks,ks.3.slope.up.ks,ks.4.slope.up.ks,ks.5.slope.up.ks,ks.6.slope.up.ks,ks.7.slope.up.ks,ks.8.slope.up.ks,ks.9.slope.up.ks,ks.10.slope.up.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.ko<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.ko<-data.frame(X1=avoid.up.ko[[1]],X2=avoid.up.ko[[2]],Avoids=avoid.up.ko[[3]])
a2.up.ko<-data.frame(X1=avoid.up.ko[[4]],X2=avoid.up.ko[[5]],Avoids=avoid.up.ko[[6]])
a3.up.ko<-data.frame(X1=avoid.up.ko[[7]],X2=avoid.up.ko[[8]],Avoids=avoid.up.ko[[9]])
a4.up.ko<-data.frame(X1=avoid.up.ko[[10]],X2=avoid.up.ko[[11]],Avoids=avoid.up.ko[[12]])
a5.up.ko<-data.frame(X1=avoid.up.ko[[13]],X2=avoid.up.ko[[14]],Avoids=avoid.up.ko[[15]])
a6.up.ko<-data.frame(X1=avoid.up.ko[[16]],X2=avoid.up.ko[[17]],Avoids=avoid.up.ko[[18]])
a7.up.ko<-data.frame(X1=avoid.up.ko[[19]],X2=avoid.up.ko[[20]],Avoids=avoid.up.ko[[21]])
a8.up.ko<-data.frame(X1=avoid.up.ko[[22]],X2=avoid.up.ko[[23]],Avoids=avoid.up.ko[[24]])
a9.up.ko<-data.frame(X1=avoid.up.ko[[25]],X2=avoid.up.ko[[26]],Avoids=avoid.up.ko[[27]])
a10.up.ko<-data.frame(X1=avoid.up.ko[[28]],X2=avoid.up.ko[[29]],Avoids=avoid.up.ko[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ko.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.ko<-data.frame(X1=conflict.ko.up[[1]],X2=conflict.ko.up[[2]],Victories=conflict.ko.up[[3]])
mat1.up.ko<-inter.mat(mut1.up.ko)
tri1.up.ko<-tr.tri(mat1.up.ko)
dci1.up.ko<-DCindex(mat1.up.ko)
mat1.up.ko[is.na(mat1.up.ko)] = 0
h1.up.ko<-h.index(mat1.up.ko)

ep1.up.ko<-ep(mut1.up.ko,a1.up.ko)
david1.up.ko<-DS(mat1.up.ko) #David's Scores - for steepness use normDS output
ordrank.1.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.ko<-cbind(ordrank.1.up.ko,ds=david1.up.ko$normDS)
lm1.up.ko<-summary(lm(ordrank.1.up.ko$ds~ordrank.1.up.ko$ord.rank))
s1.up.ko<-lm1.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.ko<-data.frame(X1=conflict.ko.up[[4]],X2=conflict.ko.up[[5]],Victories=conflict.ko.up[[6]])
mat2.up.ko<-inter.mat(mut2.up.ko)
tri2.up.ko<-tr.tri(mat2.up.ko)
dci2.up.ko<-DCindex(mat2.up.ko)
mat2.up.ko[is.na(mat2.up.ko)] = 0
h2.up.ko<-h.index(mat2.up.ko)

ep2.up.ko<-ep(mut2.up.ko,a2.up.ko)
david2.up.ko<-DS(mat2.up.ko) #David's Scores - for steepness use normDS output
ordrank.2.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.ko<-cbind(ordrank.2.up.ko,ds=david2.up.ko$normDS)
lm2.up.ko<-summary(lm(ordrank.2.up.ko$ds~ordrank.2.up.ko$ord.rank))
s2.up.ko<-lm2.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.ko<-data.frame(X1=conflict.ko.up[[7]],X2=conflict.ko.up[[8]],Victories=conflict.ko.up[[9]])
mat3.up.ko<-inter.mat(mut3.up.ko)
tri3.up.ko<-tr.tri(mat3.up.ko)
dci3.up.ko<-DCindex(mat3.up.ko)
mat3.up.ko[is.na(mat3.up.ko)] = 0
h3.up.ko<-h.index(mat3.up.ko)

ep3.up.ko<-ep(mut3.up.ko,a3.up.ko)
david3.up.ko<-DS(mat3.up.ko) #David's Scores - for steepness use normDS output
ordrank.3.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.ko<-cbind(ordrank.3.up.ko,ds=david3.up.ko$normDS)
lm3.up.ko<-summary(lm(ordrank.3.up.ko$ds~ordrank.3.up.ko$ord.rank))
s3.up.ko<-lm3.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.ko<-data.frame(X1=conflict.ko.up[[10]],X2=conflict.ko.up[[11]],Victories=conflict.ko.up[[12]])
mat4.up.ko<-inter.mat(mut4.up.ko)
tri4.up.ko<-tr.tri(mat4.up.ko)
dci4.up.ko<-DCindex(mat4.up.ko)
mat4.up.ko[is.na(mat4.up.ko)] = 0
h4.up.ko<-h.index(mat4.up.ko)

ep4.up.ko<-ep(mut4.up.ko,a4.up.ko)
david4.up.ko<-DS(mat4.up.ko) #David's Scores - for steepness use normDS output
ordrank.4.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.ko<-cbind(ordrank.4.up.ko,ds=david4.up.ko$normDS)
lm4.up.ko<-summary(lm(ordrank.4.up.ko$ds~ordrank.4.up.ko$ord.rank))
s4.up.ko<-lm4.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.ko<-data.frame(X1=conflict.ko.up[[13]],X2=conflict.ko.up[[14]],Victories=conflict.ko.up[[15]])
mat5.up.ko<-inter.mat(mut5.up.ko)
tri5.up.ko<-tr.tri(mat5.up.ko)
dci5.up.ko<-DCindex(mat5.up.ko)
mat5.up.ko[is.na(mat5.up.ko)] = 0
h5.up.ko<-h.index(mat5.up.ko)

ep5.up.ko<-ep(mut5.up.ko,a5.up.ko)
david5.up.ko<-DS(mat5.up.ko) #David's Scores - for steepness use normDS output
ordrank.5.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.ko<-cbind(ordrank.5.up.ko,ds=david5.up.ko$normDS)
lm5.up.ko<-summary(lm(ordrank.5.up.ko$ds~ordrank.5.up.ko$ord.rank))
s5.up.ko<-lm5.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.ko<-data.frame(X1=conflict.ko.up[[16]],X2=conflict.ko.up[[17]],Victories=conflict.ko.up[[18]])
mat6.up.ko<-inter.mat(mut6.up.ko)
tri6.up.ko<-tr.tri(mat6.up.ko)
dci6.up.ko<-DCindex(mat6.up.ko)
mat6.up.ko[is.na(mat6.up.ko)] = 0
h6.up.ko<-h.index(mat6.up.ko)

ep6.up.ko<-ep(mut6.up.ko,a6.up.ko)
david6.up.ko<-DS(mat6.up.ko) #David's Scores - for steepness use normDS output
ordrank.6.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.ko<-cbind(ordrank.6.up.ko,ds=david6.up.ko$normDS)
lm6.up.ko<-summary(lm(ordrank.6.up.ko$ds~ordrank.6.up.ko$ord.rank))
s6.up.ko<-lm6.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.ko<-data.frame(X1=conflict.ko.up[[19]],X2=conflict.ko.up[[20]],Victories=conflict.ko.up[[21]])
mat7.up.ko<-inter.mat(mut7.up.ko)
tri7.up.ko<-tr.tri(mat7.up.ko)
dci7.up.ko<-DCindex(mat7.up.ko)
mat7.up.ko[is.na(mat7.up.ko)] = 0
h7.up.ko<-h.index(mat7.up.ko)

ep7.up.ko<-ep(mut7.up.ko,a7.up.ko)
david7.up.ko<-DS(mat7.up.ko) #David's Scores - for steepness use normDS output
ordrank.7.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.ko<-cbind(ordrank.7.up.ko,ds=david7.up.ko$normDS)
lm7.up.ko<-summary(lm(ordrank.7.up.ko$ds~ordrank.7.up.ko$ord.rank))
s7.up.ko<-lm7.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.ko<-data.frame(X1=conflict.ko.up[[22]],X2=conflict.ko.up[[23]],Victories=conflict.ko.up[[24]])
mat8.up.ko<-inter.mat(mut8.up.ko)
tri8.up.ko<-tr.tri(mat8.up.ko)
dci8.up.ko<-DCindex(mat8.up.ko)
mat8.up.ko[is.na(mat8.up.ko)] = 0
h8.up.ko<-h.index(mat8.up.ko)

ep8.up.ko<-ep(mut8.up.ko,a8.up.ko)
david8.up.ko<-DS(mat8.up.ko) #David's Scores - for steepness use normDS output
ordrank.8.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.ko<-cbind(ordrank.8.up.ko,ds=david8.up.ko$normDS)
lm8.up.ko<-summary(lm(ordrank.8.up.ko$ds~ordrank.8.up.ko$ord.rank))
s8.up.ko<-lm8.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.ko<-data.frame(X1=conflict.ko.up[[25]],X2=conflict.ko.up[[26]],Victories=conflict.ko.up[[27]])
mat9.up.ko<-inter.mat(mut9.up.ko)
tri9.up.ko<-tr.tri(mat9.up.ko)
dci9.up.ko<-DCindex(mat9.up.ko)
mat9.up.ko[is.na(mat9.up.ko)] = 0
h9.up.ko<-h.index(mat9.up.ko)

ep9.up.ko<-ep(mut9.up.ko,a9.up.ko)
david9.up.ko<-DS(mat9.up.ko) #David's Scores - for steepness use normDS output
ordrank.9.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.ko<-cbind(ordrank.9.up.ko,ds=david9.up.ko$normDS)
lm9.up.ko<-summary(lm(ordrank.9.up.ko$ds~ordrank.9.up.ko$ord.rank))
s9.up.ko<-lm9.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.ko<-data.frame(X1=conflict.ko.up[[28]],X2=conflict.ko.up[[29]],Victories=conflict.ko.up[[30]])
mat10.up.ko<-inter.mat(mut10.up.ko)
tri10.up.ko<-tr.tri(mat10.up.ko)
dci10.up.ko<-DCindex(mat10.up.ko)
mat10.up.ko[is.na(mat10.up.ko)] = 0
h10.up.ko<-h.index(mat10.up.ko)

ep10.up.ko<-ep(mut10.up.ko,a10.up.ko)
david10.up.ko<-DS(mat10.up.ko) #David's Scores - for steepness use normDS output
ordrank.10.up.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.ko<-cbind(ordrank.10.up.ko,ds=david10.up.ko$normDS)
lm10.up.ko<-summary(lm(ordrank.10.up.ko$ds~ordrank.10.up.ko$ord.rank))
s10.up.ko<-lm10.up.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.ko<-sum(mut1.up.ko$Victories)
int2.up.ko<-sum(mut2.up.ko$Victories)
int3.up.ko<-sum(mut3.up.ko$Victories)
int4.up.ko<-sum(mut4.up.ko$Victories)
int5.up.ko<-sum(mut5.up.ko$Victories)
int6.up.ko<-sum(mut6.up.ko$Victories)
int7.up.ko<-sum(mut7.up.ko$Victories)
int8.up.ko<-sum(mut8.up.ko$Victories)
int9.up.ko<-sum(mut9.up.ko$Victories)
int10.up.ko<-sum(mut10.up.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.ko<-sum(a1.up.ko$Victories)
av2.up.ko<-sum(a2.up.ko$Victories)
av3.up.ko<-sum(a3.up.ko$Victories)
av4.up.ko<-sum(a4.up.ko$Victories)
av5.up.ko<-sum(a5.up.ko$Victories)
av6.up.ko<-sum(a6.up.ko$Victories)
av7.up.ko<-sum(a7.up.ko$Victories)
av8.up.ko<-sum(a8.up.ko$Victories)
av9.up.ko<-sum(a9.up.ko$Victories)
av10.up.ko<-sum(a10.up.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.pu<-(sum(av1.up.ko, av2.up.ko, av3.up.ko, av4.up.ko, av5.up.ko, av6.up.ko, av7.up.ko, av8.up.ko, av9.up.ko, av10.up.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.pu<-(sum(int1.up.ko, int2.up.ko, int3.up.ko, int4.up.ko, int5.up.ko, int6.up.ko, int7.up.ko, int8.up.ko, int9.up.ko, int10.up.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.ko<-e1.up.ko[order(e1.up.ko$ID),]
e1.up.ko<-as.matrix(t(e1.1.up.ko))

e2.up.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.ko<-e2.up.ko[order(e2.up.ko$ID),]
e2.up.ko<-as.matrix(t(e2.1.up.ko))

e3.up.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.ko<-e3.up.ko[order(e3.up.ko$ID),]
e3.up.ko<-as.matrix(t(e3.1.up.ko))

e4.up.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.ko<-e4.up.ko[order(e4.up.ko$ID),]
e4.up.ko<-as.matrix(t(e4.1.up.ko))

e5.up.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.ko<-e5.up.ko[order(e5.up.ko$ID),]
e5.up.ko<-as.matrix(t(e5.1.up.ko))

e6.up.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.ko<-e6.up.ko[order(e6.up.ko$ID),]
e6.up.ko<-as.matrix(t(e6.1.up.ko))

e7.up.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.ko<-e7.up.ko[order(e7.up.ko$ID),]
e7.up.ko<-as.matrix(t(e7.1.up.ko))

e8.up.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.ko<-e8.up.ko[order(e8.up.ko$ID),]
e8.up.ko<-as.matrix(t(e8.1.up.ko))

e9.up.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.ko<-e9.up.ko[order(e9.up.ko$ID),]
e9.up.ko<-as.matrix(t(e9.1.up.ko))

e10.up.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.ko<-e10.up.ko[order(e10.up.ko$ID),]
e10.up.ko<-as.matrix(t(e10.1.up.ko))

energy.ko.up.ko<-as.data.frame(matrix(c(e1.up.ko,e2.up.ko,e3.up.ko,e4.up.ko,e5.up.ko,e6.up.ko,e7.up.ko,e8.up.ko,e9.up.ko,e10.up.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.up.ko<-data.frame(ID=energy.ko.up.ko$V1,energy_over_distance=energy.ko.up.ko$V2,energy_over_time=energy.ko.up.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.ko<-david1.up.ko[order(david1.up.ko$ID),]
david1.up.ko<-as.matrix(t(david1.1.up.ko))

david2.1.up.ko<-david2.up.ko[order(david2.up.ko$ID),]
david2.up.ko<-as.matrix(t(david2.1.up.ko))

david3.1.up.ko<-david3.up.ko[order(david3.up.ko$ID),]
david3.up.ko<-as.matrix(t(david3.1.up.ko))

david4.1.up.ko<-david4.up.ko[order(david4.up.ko$ID),]
david4.up.ko<-as.matrix(t(david4.1.up.ko))

david5.1.up.ko<-david5.up.ko[order(david5.up.ko$ID),]
david5.up.ko<-as.matrix(t(david5.1.up.ko))

david6.1.up.ko<-david6.up.ko[order(david6.up.ko$ID),]
david6.up.ko<-as.matrix(t(david6.1.up.ko))

david7.1.up.ko<-david7.up.ko[order(david7.up.ko$ID),]
david7.up.ko<-as.matrix(t(david7.1.up.ko))

david8.1.up.ko<-david8.up.ko[order(david8.up.ko$ID),]
david8.up.ko<-as.matrix(t(david8.1.up.ko))

david9.1.up.ko<-david9.up.ko[order(david9.up.ko$ID),]
david9.up.ko<-as.matrix(t(david9.1.up.ko))

david10.1.up.ko<-david10.up.ko[order(david10.up.ko$ID),]
david10.up.ko<-as.matrix(t(david10.1.up.ko))

david.ko.up.ko<-as.data.frame(matrix(c(david1.up.ko,david2.up.ko,david3.up.ko,david4.up.ko,david5.up.ko,david6.up.ko,david7.up.ko,david8.up.ko,david9.up.ko,david10.up.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.up.ko<-data.frame(ID=david.ko.up.ko$V1,DS=david.ko.up.ko$V2,normDS=david.ko.up.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.up.ko<-lm(e1.1.up.ko$energy_over_time~as.numeric(david1.1.up.ko$normDS))
ko.lm.1.s.up.ko<-summary(lm.ko.1.up.ko)$coefficients
ko.1.slope.up.ko<-ko.lm.1.s.up.ko[2,1]
lm.ko.2.up.ko<-lm(e2.1.up.ko$energy_over_time~as.numeric(david2.1.up.ko$normDS))
ko.lm.2.s.up.ko<-summary(lm.ko.2.up.ko)$coefficients
ko.2.slope.up.ko<-ko.lm.2.s.up.ko[2,1]
lm.ko.3.up.ko<-lm(e3.1.up.ko$energy_over_time~as.numeric(david3.1.up.ko$normDS))
ko.lm.3.s.up.ko<-summary(lm.ko.3.up.ko)$coefficients
ko.3.slope.up.ko<-ko.lm.3.s.up.ko[2,1]
lm.ko.4.up.ko<-lm(e4.1.up.ko$energy_over_time~as.numeric(david4.1.up.ko$normDS))
ko.lm.4.s.up.ko<-summary(lm.ko.4.up.ko)$coefficients
ko.4.slope.up.ko<-ko.lm.4.s.up.ko[2,1]
lm.ko.5.up.ko<-lm(e5.1.up.ko$energy_over_time~as.numeric(david5.1.up.ko$normDS))
ko.lm.5.s.up.ko<-summary(lm.ko.5.up.ko)$coefficients
ko.5.slope.up.ko<-ko.lm.5.s.up.ko[2,1]
lm.ko.6.up.ko<-lm(e6.1.up.ko$energy_over_time~as.numeric(david6.1.up.ko$normDS))
ko.lm.6.s.up.ko<-summary(lm.ko.6.up.ko)$coefficients
ko.6.slope.up.ko<-ko.lm.6.s.up.ko[2,1]
lm.ko.7.up.ko<-lm(e7.1.up.ko$energy_over_time~as.numeric(david7.1.up.ko$normDS))
ko.lm.7.s.up.ko<-summary(lm.ko.7.up.ko)$coefficients
ko.7.slope.up.ko<-ko.lm.7.s.up.ko[2,1]
lm.ko.8.up.ko<-lm(e8.1.up.ko$energy_over_time~as.numeric(david8.1.up.ko$normDS))
ko.lm.8.s.up.ko<-summary(lm.ko.8.up.ko)$coefficients
ko.8.slope.up.ko<-ko.lm.8.s.up.ko[2,1]
lm.ko.9.up.ko<-lm(e9.1.up.ko$energy_over_time~as.numeric(david9.1.up.ko$normDS))
ko.lm.9.s.up.ko<-summary(lm.ko.9.up.ko)$coefficients
ko.9.slope.up.ko<-ko.lm.9.s.up.ko[2,1]
lm.ko.10.up.ko<-lm(e10.1.up.ko$energy_over_time~as.numeric(david10.1.up.ko$normDS))
ko.lm.10.s.up.ko<-summary(lm.ko.10.up.ko)$coefficients
ko.10.slope.up.ko<-ko.lm.10.s.up.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.up.ss<-data.frame(triangle.transitivity=c(tri1.up.ko,tri2.up.ko,tri3.up.ko,tri4.up.ko,tri5.up.ko,tri6.up.ko,tri7.up.ko,tri8.up.ko,tri9.up.ko,tri10.up.ko),escalation=c(ep1.up.ko,ep2.up.ko,ep3.up.ko,ep4.up.ko,ep5.up.ko,ep6.up.ko,ep7.up.ko,ep8.up.ko,ep9.up.ko,ep10.up.ko),dci=c(dci1.up.ko,dci2.up.ko,dci3.up.ko,dci4.up.ko,dci5.up.ko,dci6.up.ko,dci7.up.ko,dci8.up.ko,dci9.up.ko,dci10.up.ko),steepness=c(s1.up.ko,s2.up.ko,s3.up.ko,s4.up.ko,s5.up.ko,s6.up.ko,s7.up.ko,s8.up.ko,s9.up.ko,s10.up.ko),slope=c(ko.1.slope.up.ko,ko.2.slope.up.ko,ko.3.slope.up.ko,ko.4.slope.up.ko,ko.5.slope.up.ko,ko.6.slope.up.ko,ko.7.slope.up.ko,ko.8.slope.up.ko,ko.9.slope.up.ko,ko.10.slope.up.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.hm<-data.frame(X1=avoid.up.hm[[1]],X2=avoid.up.hm[[2]],Avoids=avoid.up.hm[[3]])
a2.up.hm<-data.frame(X1=avoid.up.hm[[4]],X2=avoid.up.hm[[5]],Avoids=avoid.up.hm[[6]])
a3.up.hm<-data.frame(X1=avoid.up.hm[[7]],X2=avoid.up.hm[[8]],Avoids=avoid.up.hm[[9]])
a4.up.hm<-data.frame(X1=avoid.up.hm[[10]],X2=avoid.up.hm[[11]],Avoids=avoid.up.hm[[12]])
a5.up.hm<-data.frame(X1=avoid.up.hm[[13]],X2=avoid.up.hm[[14]],Avoids=avoid.up.hm[[15]])
a6.up.hm<-data.frame(X1=avoid.up.hm[[16]],X2=avoid.up.hm[[17]],Avoids=avoid.up.hm[[18]])
a7.up.hm<-data.frame(X1=avoid.up.hm[[19]],X2=avoid.up.hm[[20]],Avoids=avoid.up.hm[[21]])
a8.up.hm<-data.frame(X1=avoid.up.hm[[22]],X2=avoid.up.hm[[23]],Avoids=avoid.up.hm[[24]])
a9.up.hm<-data.frame(X1=avoid.up.hm[[25]],X2=avoid.up.hm[[26]],Avoids=avoid.up.hm[[27]])
a10.up.hm<-data.frame(X1=avoid.up.hm[[28]],X2=avoid.up.hm[[29]],Avoids=avoid.up.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.hm<-data.frame(X1=conflict.hm.up[[1]],X2=conflict.hm.up[[2]],Victories=conflict.hm.up[[3]])
mat1.up.hm<-inter.mat(mut1.up.hm)
tri1.up.hm<-tr.tri(mat1.up.hm)
dci1.up.hm<-DCindex(mat1.up.hm)
mat1.up.hm[is.na(mat1.up.hm)] = 0
h1.up.hm<-h.index(mat1.up.hm)

ep1.up.hm<-ep(mut1.up.hm,a1.up.hm)
david1.up.hm<-DS(mat1.up.hm) #David's Scores - for steepness use normDS output
ordrank.1.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.hm<-cbind(ordrank.1.up.hm,ds=david1.up.hm$normDS)
lm1.up.hm<-summary(lm(ordrank.1.up.hm$ds~ordrank.1.up.hm$ord.rank))
s1.up.hm<-lm1.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.hm<-data.frame(X1=conflict.hm.up[[4]],X2=conflict.hm.up[[5]],Victories=conflict.hm.up[[6]])
mat2.up.hm<-inter.mat(mut2.up.hm)
tri2.up.hm<-tr.tri(mat2.up.hm)
dci2.up.hm<-DCindex(mat2.up.hm)
mat2.up.hm[is.na(mat2.up.hm)] = 0
h2.up.hm<-h.index(mat2.up.hm)

ep2.up.hm<-ep(mut2.up.hm,a2.up.hm)
david2.up.hm<-DS(mat2.up.hm) #David's Scores - for steepness use normDS output
ordrank.2.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.hm<-cbind(ordrank.2.up.hm,ds=david2.up.hm$normDS)
lm2.up.hm<-summary(lm(ordrank.2.up.hm$ds~ordrank.2.up.hm$ord.rank))
s2.up.hm<-lm2.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.hm<-data.frame(X1=conflict.hm.up[[7]],X2=conflict.hm.up[[8]],Victories=conflict.hm.up[[9]])
mat3.up.hm<-inter.mat(mut3.up.hm)
tri3.up.hm<-tr.tri(mat3.up.hm)
dci3.up.hm<-DCindex(mat3.up.hm)
mat3.up.hm[is.na(mat3.up.hm)] = 0
h3.up.hm<-h.index(mat3.up.hm)

ep3.up.hm<-ep(mut3.up.hm,a3.up.hm)
david3.up.hm<-DS(mat3.up.hm) #David's Scores - for steepness use normDS output
ordrank.3.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.hm<-cbind(ordrank.3.up.hm,ds=david3.up.hm$normDS)
lm3.up.hm<-summary(lm(ordrank.3.up.hm$ds~ordrank.3.up.hm$ord.rank))
s3.up.hm<-lm3.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.hm<-data.frame(X1=conflict.hm.up[[10]],X2=conflict.hm.up[[11]],Victories=conflict.hm.up[[12]])
mat4.up.hm<-inter.mat(mut4.up.hm)
tri4.up.hm<-tr.tri(mat4.up.hm)
dci4.up.hm<-DCindex(mat4.up.hm)
mat4.up.hm[is.na(mat4.up.hm)] = 0
h4.up.hm<-h.index(mat4.up.hm)

ep4.up.hm<-ep(mut4.up.hm,a4.up.hm)
david4.up.hm<-DS(mat4.up.hm) #David's Scores - for steepness use normDS output
ordrank.4.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.hm<-cbind(ordrank.4.up.hm,ds=david4.up.hm$normDS)
lm4.up.hm<-summary(lm(ordrank.4.up.hm$ds~ordrank.4.up.hm$ord.rank))
s4.up.hm<-lm4.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.hm<-data.frame(X1=conflict.hm.up[[13]],X2=conflict.hm.up[[14]],Victories=conflict.hm.up[[15]])
mat5.up.hm<-inter.mat(mut5.up.hm)
tri5.up.hm<-tr.tri(mat5.up.hm)
dci5.up.hm<-DCindex(mat5.up.hm)
mat5.up.hm[is.na(mat5.up.hm)] = 0
h5.up.hm<-h.index(mat5.up.hm)

ep5.up.hm<-ep(mut5.up.hm,a5.up.hm)
david5.up.hm<-DS(mat5.up.hm) #David's Scores - for steepness use normDS output
ordrank.5.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.hm<-cbind(ordrank.5.up.hm,ds=david5.up.hm$normDS)
lm5.up.hm<-summary(lm(ordrank.5.up.hm$ds~ordrank.5.up.hm$ord.rank))
s5.up.hm<-lm5.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.hm<-data.frame(X1=conflict.hm.up[[16]],X2=conflict.hm.up[[17]],Victories=conflict.hm.up[[18]])
mat6.up.hm<-inter.mat(mut6.up.hm)
tri6.up.hm<-tr.tri(mat6.up.hm)
dci6.up.hm<-DCindex(mat6.up.hm)
mat6.up.hm[is.na(mat6.up.hm)] = 0
h6.up.hm<-h.index(mat6.up.hm)

ep6.up.hm<-ep(mut6.up.hm,a6.up.hm)
david6.up.hm<-DS(mat6.up.hm) #David's Scores - for steepness use normDS output
ordrank.6.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.hm<-cbind(ordrank.6.up.hm,ds=david6.up.hm$normDS)
lm6.up.hm<-summary(lm(ordrank.6.up.hm$ds~ordrank.6.up.hm$ord.rank))
s6.up.hm<-lm6.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.hm<-data.frame(X1=conflict.hm.up[[19]],X2=conflict.hm.up[[20]],Victories=conflict.hm.up[[21]])
mat7.up.hm<-inter.mat(mut7.up.hm)
tri7.up.hm<-tr.tri(mat7.up.hm)
dci7.up.hm<-DCindex(mat7.up.hm)
mat7.up.hm[is.na(mat7.up.hm)] = 0
h7.up.hm<-h.index(mat7.up.hm)

ep7.up.hm<-ep(mut7.up.hm,a7.up.hm)
david7.up.hm<-DS(mat7.up.hm) #David's Scores - for steepness use normDS output
ordrank.7.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.hm<-cbind(ordrank.7.up.hm,ds=david7.up.hm$normDS)
lm7.up.hm<-summary(lm(ordrank.7.up.hm$ds~ordrank.7.up.hm$ord.rank))
s7.up.hm<-lm7.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.hm<-data.frame(X1=conflict.hm.up[[22]],X2=conflict.hm.up[[23]],Victories=conflict.hm.up[[24]])
mat8.up.hm<-inter.mat(mut8.up.hm)
tri8.up.hm<-tr.tri(mat8.up.hm)
dci8.up.hm<-DCindex(mat8.up.hm)
mat8.up.hm[is.na(mat8.up.hm)] = 0
h8.up.hm<-h.index(mat8.up.hm)

ep8.up.hm<-ep(mut8.up.hm,a8.up.hm)
david8.up.hm<-DS(mat8.up.hm) #David's Scores - for steepness use normDS output
ordrank.8.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.hm<-cbind(ordrank.8.up.hm,ds=david8.up.hm$normDS)
lm8.up.hm<-summary(lm(ordrank.8.up.hm$ds~ordrank.8.up.hm$ord.rank))
s8.up.hm<-lm8.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.hm<-data.frame(X1=conflict.hm.up[[25]],X2=conflict.hm.up[[26]],Victories=conflict.hm.up[[27]])
mat9.up.hm<-inter.mat(mut9.up.hm)
tri9.up.hm<-tr.tri(mat9.up.hm)
dci9.up.hm<-DCindex(mat9.up.hm)
mat9.up.hm[is.na(mat9.up.hm)] = 0
h9.up.hm<-h.index(mat9.up.hm)

ep9.up.hm<-ep(mut9.up.hm,a9.up.hm)
david9.up.hm<-DS(mat9.up.hm) #David's Scores - for steepness use normDS output
ordrank.9.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.hm<-cbind(ordrank.9.up.hm,ds=david9.up.hm$normDS)
lm9.up.hm<-summary(lm(ordrank.9.up.hm$ds~ordrank.9.up.hm$ord.rank))
s9.up.hm<-lm9.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.hm<-data.frame(X1=conflict.hm.up[[28]],X2=conflict.hm.up[[29]],Victories=conflict.hm.up[[30]])
mat10.up.hm<-inter.mat(mut10.up.hm)
tri10.up.hm<-tr.tri(mat10.up.hm)
dci10.up.hm<-DCindex(mat10.up.hm)
mat10.up.hm[is.na(mat10.up.hm)] = 0
h10.up.hm<-h.index(mat10.up.hm)

ep10.up.hm<-ep(mut10.up.hm,a10.up.hm)
david10.up.hm<-DS(mat10.up.hm) #David's Scores - for steepness use normDS output
ordrank.10.up.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.hm<-cbind(ordrank.10.up.hm,ds=david10.up.hm$normDS)
lm10.up.hm<-summary(lm(ordrank.10.up.hm$ds~ordrank.10.up.hm$ord.rank))
s10.up.hm<-lm10.up.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.hm<-sum(mut1.up.hm$Victories)
int2.up.hm<-sum(mut2.up.hm$Victories)
int3.up.hm<-sum(mut3.up.hm$Victories)
int4.up.hm<-sum(mut4.up.hm$Victories)
int5.up.hm<-sum(mut5.up.hm$Victories)
int6.up.hm<-sum(mut6.up.hm$Victories)
int7.up.hm<-sum(mut7.up.hm$Victories)
int8.up.hm<-sum(mut8.up.hm$Victories)
int9.up.hm<-sum(mut9.up.hm$Victories)
int10.up.hm<-sum(mut10.up.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.hm<-sum(a1.up.hm$Victories)
av2.up.hm<-sum(a2.up.hm$Victories)
av3.up.hm<-sum(a3.up.hm$Victories)
av4.up.hm<-sum(a4.up.hm$Victories)
av5.up.hm<-sum(a5.up.hm$Victories)
av6.up.hm<-sum(a6.up.hm$Victories)
av7.up.hm<-sum(a7.up.hm$Victories)
av8.up.hm<-sum(a8.up.hm$Victories)
av9.up.hm<-sum(a9.up.hm$Victories)
av10.up.hm<-sum(a10.up.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.pu<-(sum(av1.up.hm, av2.up.hm, av3.up.hm, av4.up.hm, av5.up.hm, av6.up.hm, av7.up.hm, av8.up.hm, av9.up.hm, av10.up.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.pu<-(sum(int1.up.hm, int2.up.hm, int3.up.hm, int4.up.hm, int5.up.hm, int6.up.hm, int7.up.hm, int8.up.hm, int9.up.hm, int10.up.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.hm<-e1.up.hm[order(e1.up.hm$ID),]
e1.up.hm<-as.matrix(t(e1.1.up.hm))

e2.up.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.hm<-e2.up.hm[order(e2.up.hm$ID),]
e2.up.hm<-as.matrix(t(e2.1.up.hm))

e3.up.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.hm<-e3.up.hm[order(e3.up.hm$ID),]
e3.up.hm<-as.matrix(t(e3.1.up.hm))

e4.up.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.hm<-e4.up.hm[order(e4.up.hm$ID),]
e4.up.hm<-as.matrix(t(e4.1.up.hm))

e5.up.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.hm<-e5.up.hm[order(e5.up.hm$ID),]
e5.up.hm<-as.matrix(t(e5.1.up.hm))

e6.up.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.hm<-e6.up.hm[order(e6.up.hm$ID),]
e6.up.hm<-as.matrix(t(e6.1.up.hm))

e7.up.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.hm<-e7.up.hm[order(e7.up.hm$ID),]
e7.up.hm<-as.matrix(t(e7.1.up.hm))

e8.up.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.hm<-e8.up.hm[order(e8.up.hm$ID),]
e8.up.hm<-as.matrix(t(e8.1.up.hm))

e9.up.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.hm<-e9.up.hm[order(e9.up.hm$ID),]
e9.up.hm<-as.matrix(t(e9.1.up.hm))

e10.up.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.hm<-e10.up.hm[order(e10.up.hm$ID),]
e10.up.hm<-as.matrix(t(e10.1.up.hm))

energy.hm.up.hm<-as.data.frame(matrix(c(e1.up.hm,e2.up.hm,e3.up.hm,e4.up.hm,e5.up.hm,e6.up.hm,e7.up.hm,e8.up.hm,e9.up.hm,e10.up.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.up.hm<-data.frame(ID=energy.hm.up.hm$V1,energy_over_distance=energy.hm.up.hm$V2,energy_over_time=energy.hm.up.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.hm<-david1.up.hm[order(david1.up.hm$ID),]
david1.up.hm<-as.matrix(t(david1.1.up.hm))

david2.1.up.hm<-david2.up.hm[order(david2.up.hm$ID),]
david2.up.hm<-as.matrix(t(david2.1.up.hm))

david3.1.up.hm<-david3.up.hm[order(david3.up.hm$ID),]
david3.up.hm<-as.matrix(t(david3.1.up.hm))

david4.1.up.hm<-david4.up.hm[order(david4.up.hm$ID),]
david4.up.hm<-as.matrix(t(david4.1.up.hm))

david5.1.up.hm<-david5.up.hm[order(david5.up.hm$ID),]
david5.up.hm<-as.matrix(t(david5.1.up.hm))

david6.1.up.hm<-david6.up.hm[order(david6.up.hm$ID),]
david6.up.hm<-as.matrix(t(david6.1.up.hm))

david7.1.up.hm<-david7.up.hm[order(david7.up.hm$ID),]
david7.up.hm<-as.matrix(t(david7.1.up.hm))

david8.1.up.hm<-david8.up.hm[order(david8.up.hm$ID),]
david8.up.hm<-as.matrix(t(david8.1.up.hm))

david9.1.up.hm<-david9.up.hm[order(david9.up.hm$ID),]
david9.up.hm<-as.matrix(t(david9.1.up.hm))

david10.1.up.hm<-david10.up.hm[order(david10.up.hm$ID),]
david10.up.hm<-as.matrix(t(david10.1.up.hm))

david.hm.up.hm<-as.data.frame(matrix(c(david1.up.hm,david2.up.hm,david3.up.hm,david4.up.hm,david5.up.hm,david6.up.hm,david7.up.hm,david8.up.hm,david9.up.hm,david10.up.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.up.hm<-data.frame(ID=david.hm.up.hm$V1,DS=david.hm.up.hm$V2,normDS=david.hm.up.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.up.hm<-lm(e1.1.up.hm$energy_over_time~as.numeric(david1.1.up.hm$normDS))
hm.lm.1.s.up.hm<-summary(lm.hm.1.up.hm)$coefficients
hm.1.slope.up.hm<-hm.lm.1.s.up.hm[2,1]
lm.hm.2.up.hm<-lm(e2.1.up.hm$energy_over_time~as.numeric(david2.1.up.hm$normDS))
hm.lm.2.s.up.hm<-summary(lm.hm.2.up.hm)$coefficients
hm.2.slope.up.hm<-hm.lm.2.s.up.hm[2,1]
lm.hm.3.up.hm<-lm(e3.1.up.hm$energy_over_time~as.numeric(david3.1.up.hm$normDS))
hm.lm.3.s.up.hm<-summary(lm.hm.3.up.hm)$coefficients
hm.3.slope.up.hm<-hm.lm.3.s.up.hm[2,1]
lm.hm.4.up.hm<-lm(e4.1.up.hm$energy_over_time~as.numeric(david4.1.up.hm$normDS))
hm.lm.4.s.up.hm<-summary(lm.hm.4.up.hm)$coefficients
hm.4.slope.up.hm<-hm.lm.4.s.up.hm[2,1]
lm.hm.5.up.hm<-lm(e5.1.up.hm$energy_over_time~as.numeric(david5.1.up.hm$normDS))
hm.lm.5.s.up.hm<-summary(lm.hm.5.up.hm)$coefficients
hm.5.slope.up.hm<-hm.lm.5.s.up.hm[2,1]
lm.hm.6.up.hm<-lm(e6.1.up.hm$energy_over_time~as.numeric(david6.1.up.hm$normDS))
hm.lm.6.s.up.hm<-summary(lm.hm.6.up.hm)$coefficients
hm.6.slope.up.hm<-hm.lm.6.s.up.hm[2,1]
lm.hm.7.up.hm<-lm(e7.1.up.hm$energy_over_time~as.numeric(david7.1.up.hm$normDS))
hm.lm.7.s.up.hm<-summary(lm.hm.7.up.hm)$coefficients
hm.7.slope.up.hm<-hm.lm.7.s.up.hm[2,1]
lm.hm.8.up.hm<-lm(e8.1.up.hm$energy_over_time~as.numeric(david8.1.up.hm$normDS))
hm.lm.8.s.up.hm<-summary(lm.hm.8.up.hm)$coefficients
hm.8.slope.up.hm<-hm.lm.8.s.up.hm[2,1]
lm.hm.9.up.hm<-lm(e9.1.up.hm$energy_over_time~as.numeric(david9.1.up.hm$normDS))
hm.lm.9.s.up.hm<-summary(lm.hm.9.up.hm)$coefficients
hm.9.slope.up.hm<-hm.lm.9.s.up.hm[2,1]
lm.hm.10.up.hm<-lm(e10.1.up.hm$energy_over_time~as.numeric(david10.1.up.hm$normDS))
hm.lm.10.s.up.hm<-summary(lm.hm.10.up.hm)$coefficients
hm.10.slope.up.hm<-hm.lm.10.s.up.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.up.ss<-data.frame(triangle.transitivity=c(tri1.up.hm,tri2.up.hm,tri3.up.hm,tri4.up.hm,tri5.up.hm,tri6.up.hm,tri7.up.hm,tri8.up.hm,tri9.up.hm,tri10.up.hm),escalation=c(ep1.up.hm,ep2.up.hm,ep3.up.hm,ep4.up.hm,ep5.up.hm,ep6.up.hm,ep7.up.hm,ep8.up.hm,ep9.up.hm,ep10.up.hm),dci=c(dci1.up.hm,dci2.up.hm,dci3.up.hm,dci4.up.hm,dci5.up.hm,dci6.up.hm,dci7.up.hm,dci8.up.hm,dci9.up.hm,dci10.up.hm),steepness=c(s1.up.hm,s2.up.hm,s3.up.hm,s4.up.hm,s5.up.hm,s6.up.hm,s7.up.hm,s8.up.hm,s9.up.hm,s10.up.hm),slope=c(hm.1.slope.up.hm,hm.2.slope.up.hm,hm.3.slope.up.hm,hm.4.slope.up.hm,hm.5.slope.up.hm,hm.6.slope.up.hm,hm.7.slope.up.hm,hm.8.slope.up.hm,hm.9.slope.up.hm,hm.10.slope.up.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.hs<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.hs<-data.frame(X1=avoid.up.hs[[1]],X2=avoid.up.hs[[2]],Avoids=avoid.up.hs[[3]])
a2.up.hs<-data.frame(X1=avoid.up.hs[[4]],X2=avoid.up.hs[[5]],Avoids=avoid.up.hs[[6]])
a3.up.hs<-data.frame(X1=avoid.up.hs[[7]],X2=avoid.up.hs[[8]],Avoids=avoid.up.hs[[9]])
a4.up.hs<-data.frame(X1=avoid.up.hs[[10]],X2=avoid.up.hs[[11]],Avoids=avoid.up.hs[[12]])
a5.up.hs<-data.frame(X1=avoid.up.hs[[13]],X2=avoid.up.hs[[14]],Avoids=avoid.up.hs[[15]])
a6.up.hs<-data.frame(X1=avoid.up.hs[[16]],X2=avoid.up.hs[[17]],Avoids=avoid.up.hs[[18]])
a7.up.hs<-data.frame(X1=avoid.up.hs[[19]],X2=avoid.up.hs[[20]],Avoids=avoid.up.hs[[21]])
a8.up.hs<-data.frame(X1=avoid.up.hs[[22]],X2=avoid.up.hs[[23]],Avoids=avoid.up.hs[[24]])
a9.up.hs<-data.frame(X1=avoid.up.hs[[25]],X2=avoid.up.hs[[26]],Avoids=avoid.up.hs[[27]])
a10.up.hs<-data.frame(X1=avoid.up.hs[[28]],X2=avoid.up.hs[[29]],Avoids=avoid.up.hs[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.hs.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.hs<-data.frame(X1=conflict.hs.up[[1]],X2=conflict.hs.up[[2]],Victories=conflict.hs.up[[3]])
mat1.up.hs<-inter.mat(mut1.up.hs)
tri1.up.hs<-tr.tri(mat1.up.hs)
dci1.up.hs<-DCindex(mat1.up.hs)
mat1.up.hs[is.na(mat1.up.hs)] = 0
h1.up.hs<-h.index(mat1.up.hs)

ep1.up.hs<-ep(mut1.up.hs,a1.up.hs)
david1.up.hs<-DS(mat1.up.hs) #David's Scores - for steepness use normDS output
ordrank.1.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.hs<-cbind(ordrank.1.up.hs,ds=david1.up.hs$normDS)
lm1.up.hs<-summary(lm(ordrank.1.up.hs$ds~ordrank.1.up.hs$ord.rank))
s1.up.hs<-lm1.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.hs<-data.frame(X1=conflict.hs.up[[4]],X2=conflict.hs.up[[5]],Victories=conflict.hs.up[[6]])
mat2.up.hs<-inter.mat(mut2.up.hs)
tri2.up.hs<-tr.tri(mat2.up.hs)
dci2.up.hs<-DCindex(mat2.up.hs)
mat2.up.hs[is.na(mat2.up.hs)] = 0
h2.up.hs<-h.index(mat2.up.hs)

ep2.up.hs<-ep(mut2.up.hs,a2.up.hs)
david2.up.hs<-DS(mat2.up.hs) #David's Scores - for steepness use normDS output
ordrank.2.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.hs<-cbind(ordrank.2.up.hs,ds=david2.up.hs$normDS)
lm2.up.hs<-summary(lm(ordrank.2.up.hs$ds~ordrank.2.up.hs$ord.rank))
s2.up.hs<-lm2.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.hs<-data.frame(X1=conflict.hs.up[[7]],X2=conflict.hs.up[[8]],Victories=conflict.hs.up[[9]])
mat3.up.hs<-inter.mat(mut3.up.hs)
tri3.up.hs<-tr.tri(mat3.up.hs)
dci3.up.hs<-DCindex(mat3.up.hs)
mat3.up.hs[is.na(mat3.up.hs)] = 0
h3.up.hs<-h.index(mat3.up.hs)

ep3.up.hs<-ep(mut3.up.hs,a3.up.hs)
david3.up.hs<-DS(mat3.up.hs) #David's Scores - for steepness use normDS output
ordrank.3.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.hs<-cbind(ordrank.3.up.hs,ds=david3.up.hs$normDS)
lm3.up.hs<-summary(lm(ordrank.3.up.hs$ds~ordrank.3.up.hs$ord.rank))
s3.up.hs<-lm3.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.hs<-data.frame(X1=conflict.hs.up[[10]],X2=conflict.hs.up[[11]],Victories=conflict.hs.up[[12]])
mat4.up.hs<-inter.mat(mut4.up.hs)
tri4.up.hs<-tr.tri(mat4.up.hs)
dci4.up.hs<-DCindex(mat4.up.hs)
mat4.up.hs[is.na(mat4.up.hs)] = 0
h4.up.hs<-h.index(mat4.up.hs)

ep4.up.hs<-ep(mut4.up.hs,a4.up.hs)
david4.up.hs<-DS(mat4.up.hs) #David's Scores - for steepness use normDS output
ordrank.4.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.hs<-cbind(ordrank.4.up.hs,ds=david4.up.hs$normDS)
lm4.up.hs<-summary(lm(ordrank.4.up.hs$ds~ordrank.4.up.hs$ord.rank))
s4.up.hs<-lm4.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.hs<-data.frame(X1=conflict.hs.up[[13]],X2=conflict.hs.up[[14]],Victories=conflict.hs.up[[15]])
mat5.up.hs<-inter.mat(mut5.up.hs)
tri5.up.hs<-tr.tri(mat5.up.hs)
dci5.up.hs<-DCindex(mat5.up.hs)
mat5.up.hs[is.na(mat5.up.hs)] = 0
h5.up.hs<-h.index(mat5.up.hs)

ep5.up.hs<-ep(mut5.up.hs,a5.up.hs)
david5.up.hs<-DS(mat5.up.hs) #David's Scores - for steepness use normDS output
ordrank.5.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.hs<-cbind(ordrank.5.up.hs,ds=david5.up.hs$normDS)
lm5.up.hs<-summary(lm(ordrank.5.up.hs$ds~ordrank.5.up.hs$ord.rank))
s5.up.hs<-lm5.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.hs<-data.frame(X1=conflict.hs.up[[16]],X2=conflict.hs.up[[17]],Victories=conflict.hs.up[[18]])
mat6.up.hs<-inter.mat(mut6.up.hs)
tri6.up.hs<-tr.tri(mat6.up.hs)
dci6.up.hs<-DCindex(mat6.up.hs)
mat6.up.hs[is.na(mat6.up.hs)] = 0
h6.up.hs<-h.index(mat6.up.hs)

ep6.up.hs<-ep(mut6.up.hs,a6.up.hs)
david6.up.hs<-DS(mat6.up.hs) #David's Scores - for steepness use normDS output
ordrank.6.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.hs<-cbind(ordrank.6.up.hs,ds=david6.up.hs$normDS)
lm6.up.hs<-summary(lm(ordrank.6.up.hs$ds~ordrank.6.up.hs$ord.rank))
s6.up.hs<-lm6.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.hs<-data.frame(X1=conflict.hs.up[[19]],X2=conflict.hs.up[[20]],Victories=conflict.hs.up[[21]])
mat7.up.hs<-inter.mat(mut7.up.hs)
tri7.up.hs<-tr.tri(mat7.up.hs)
dci7.up.hs<-DCindex(mat7.up.hs)
mat7.up.hs[is.na(mat7.up.hs)] = 0
h7.up.hs<-h.index(mat7.up.hs)

ep7.up.hs<-ep(mut7.up.hs,a7.up.hs)
david7.up.hs<-DS(mat7.up.hs) #David's Scores - for steepness use normDS output
ordrank.7.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.hs<-cbind(ordrank.7.up.hs,ds=david7.up.hs$normDS)
lm7.up.hs<-summary(lm(ordrank.7.up.hs$ds~ordrank.7.up.hs$ord.rank))
s7.up.hs<-lm7.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.hs<-data.frame(X1=conflict.hs.up[[22]],X2=conflict.hs.up[[23]],Victories=conflict.hs.up[[24]])
mat8.up.hs<-inter.mat(mut8.up.hs)
tri8.up.hs<-tr.tri(mat8.up.hs)
dci8.up.hs<-DCindex(mat8.up.hs)
mat8.up.hs[is.na(mat8.up.hs)] = 0
h8.up.hs<-h.index(mat8.up.hs)

ep8.up.hs<-ep(mut8.up.hs,a8.up.hs)
david8.up.hs<-DS(mat8.up.hs) #David's Scores - for steepness use normDS output
ordrank.8.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.hs<-cbind(ordrank.8.up.hs,ds=david8.up.hs$normDS)
lm8.up.hs<-summary(lm(ordrank.8.up.hs$ds~ordrank.8.up.hs$ord.rank))
s8.up.hs<-lm8.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.hs<-data.frame(X1=conflict.hs.up[[25]],X2=conflict.hs.up[[26]],Victories=conflict.hs.up[[27]])
mat9.up.hs<-inter.mat(mut9.up.hs)
tri9.up.hs<-tr.tri(mat9.up.hs)
dci9.up.hs<-DCindex(mat9.up.hs)
mat9.up.hs[is.na(mat9.up.hs)] = 0
h9.up.hs<-h.index(mat9.up.hs)

ep9.up.hs<-ep(mut9.up.hs,a9.up.hs)
david9.up.hs<-DS(mat9.up.hs) #David's Scores - for steepness use normDS output
ordrank.9.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.hs<-cbind(ordrank.9.up.hs,ds=david9.up.hs$normDS)
lm9.up.hs<-summary(lm(ordrank.9.up.hs$ds~ordrank.9.up.hs$ord.rank))
s9.up.hs<-lm9.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.hs<-data.frame(X1=conflict.hs.up[[28]],X2=conflict.hs.up[[29]],Victories=conflict.hs.up[[30]])
mat10.up.hs<-inter.mat(mut10.up.hs)
tri10.up.hs<-tr.tri(mat10.up.hs)
dci10.up.hs<-DCindex(mat10.up.hs)
mat10.up.hs[is.na(mat10.up.hs)] = 0
h10.up.hs<-h.index(mat10.up.hs)

ep10.up.hs<-ep(mut10.up.hs,a10.up.hs)
david10.up.hs<-DS(mat10.up.hs) #David's Scores - for steepness use normDS output
ordrank.10.up.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.hs<-cbind(ordrank.10.up.hs,ds=david10.up.hs$normDS)
lm10.up.hs<-summary(lm(ordrank.10.up.hs$ds~ordrank.10.up.hs$ord.rank))
s10.up.hs<-lm10.up.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.hs<-sum(mut1.up.hs$Victories)
int2.up.hs<-sum(mut2.up.hs$Victories)
int3.up.hs<-sum(mut3.up.hs$Victories)
int4.up.hs<-sum(mut4.up.hs$Victories)
int5.up.hs<-sum(mut5.up.hs$Victories)
int6.up.hs<-sum(mut6.up.hs$Victories)
int7.up.hs<-sum(mut7.up.hs$Victories)
int8.up.hs<-sum(mut8.up.hs$Victories)
int9.up.hs<-sum(mut9.up.hs$Victories)
int10.up.hs<-sum(mut10.up.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.hs<-sum(a1.up.hs$Victories)
av2.up.hs<-sum(a2.up.hs$Victories)
av3.up.hs<-sum(a3.up.hs$Victories)
av4.up.hs<-sum(a4.up.hs$Victories)
av5.up.hs<-sum(a5.up.hs$Victories)
av6.up.hs<-sum(a6.up.hs$Victories)
av7.up.hs<-sum(a7.up.hs$Victories)
av8.up.hs<-sum(a8.up.hs$Victories)
av9.up.hs<-sum(a9.up.hs$Victories)
av10.up.hs<-sum(a10.up.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.pu<-(sum(av1.up.hs, av2.up.hs, av3.up.hs, av4.up.hs, av5.up.hs, av6.up.hs, av7.up.hs, av8.up.hs, av9.up.hs, av10.up.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.pu<-(sum(int1.up.hs, int2.up.hs, int3.up.hs, int4.up.hs, int5.up.hs, int6.up.hs, int7.up.hs, int8.up.hs, int9.up.hs, int10.up.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.hs<-e1.up.hs[order(e1.up.hs$ID),]
e1.up.hs<-as.matrix(t(e1.1.up.hs))

e2.up.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.hs<-e2.up.hs[order(e2.up.hs$ID),]
e2.up.hs<-as.matrix(t(e2.1.up.hs))

e3.up.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.hs<-e3.up.hs[order(e3.up.hs$ID),]
e3.up.hs<-as.matrix(t(e3.1.up.hs))

e4.up.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.hs<-e4.up.hs[order(e4.up.hs$ID),]
e4.up.hs<-as.matrix(t(e4.1.up.hs))

e5.up.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.hs<-e5.up.hs[order(e5.up.hs$ID),]
e5.up.hs<-as.matrix(t(e5.1.up.hs))

e6.up.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.hs<-e6.up.hs[order(e6.up.hs$ID),]
e6.up.hs<-as.matrix(t(e6.1.up.hs))

e7.up.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.hs<-e7.up.hs[order(e7.up.hs$ID),]
e7.up.hs<-as.matrix(t(e7.1.up.hs))

e8.up.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.hs<-e8.up.hs[order(e8.up.hs$ID),]
e8.up.hs<-as.matrix(t(e8.1.up.hs))

e9.up.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.hs<-e9.up.hs[order(e9.up.hs$ID),]
e9.up.hs<-as.matrix(t(e9.1.up.hs))

e10.up.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.hs<-e10.up.hs[order(e10.up.hs$ID),]
e10.up.hs<-as.matrix(t(e10.1.up.hs))

energy.hs.up.hs<-as.data.frame(matrix(c(e1.up.hs,e2.up.hs,e3.up.hs,e4.up.hs,e5.up.hs,e6.up.hs,e7.up.hs,e8.up.hs,e9.up.hs,e10.up.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.up.hs<-data.frame(ID=energy.hs.up.hs$V1,energy_over_distance=energy.hs.up.hs$V2,energy_over_time=energy.hs.up.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.hs<-david1.up.hs[order(david1.up.hs$ID),]
david1.up.hs<-as.matrix(t(david1.1.up.hs))

david2.1.up.hs<-david2.up.hs[order(david2.up.hs$ID),]
david2.up.hs<-as.matrix(t(david2.1.up.hs))

david3.1.up.hs<-david3.up.hs[order(david3.up.hs$ID),]
david3.up.hs<-as.matrix(t(david3.1.up.hs))

david4.1.up.hs<-david4.up.hs[order(david4.up.hs$ID),]
david4.up.hs<-as.matrix(t(david4.1.up.hs))

david5.1.up.hs<-david5.up.hs[order(david5.up.hs$ID),]
david5.up.hs<-as.matrix(t(david5.1.up.hs))

david6.1.up.hs<-david6.up.hs[order(david6.up.hs$ID),]
david6.up.hs<-as.matrix(t(david6.1.up.hs))

david7.1.up.hs<-david7.up.hs[order(david7.up.hs$ID),]
david7.up.hs<-as.matrix(t(david7.1.up.hs))

david8.1.up.hs<-david8.up.hs[order(david8.up.hs$ID),]
david8.up.hs<-as.matrix(t(david8.1.up.hs))

david9.1.up.hs<-david9.up.hs[order(david9.up.hs$ID),]
david9.up.hs<-as.matrix(t(david9.1.up.hs))

david10.1.up.hs<-david10.up.hs[order(david10.up.hs$ID),]
david10.up.hs<-as.matrix(t(david10.1.up.hs))

david.hs.up.hs<-as.data.frame(matrix(c(david1.up.hs,david2.up.hs,david3.up.hs,david4.up.hs,david5.up.hs,david6.up.hs,david7.up.hs,david8.up.hs,david9.up.hs,david10.up.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.up.hs<-data.frame(ID=david.hs.up.hs$V1,DS=david.hs.up.hs$V2,normDS=david.hs.up.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.up.hs<-lm(e1.1.up.hs$energy_over_time~as.numeric(david1.1.up.hs$normDS))
hs.lm.1.s.up.hs<-summary(lm.hs.1.up.hs)$coefficients
hs.1.slope.up.hs<-hs.lm.1.s.up.hs[2,1]
lm.hs.2.up.hs<-lm(e2.1.up.hs$energy_over_time~as.numeric(david2.1.up.hs$normDS))
hs.lm.2.s.up.hs<-summary(lm.hs.2.up.hs)$coefficients
hs.2.slope.up.hs<-hs.lm.2.s.up.hs[2,1]
lm.hs.3.up.hs<-lm(e3.1.up.hs$energy_over_time~as.numeric(david3.1.up.hs$normDS))
hs.lm.3.s.up.hs<-summary(lm.hs.3.up.hs)$coefficients
hs.3.slope.up.hs<-hs.lm.3.s.up.hs[2,1]
lm.hs.4.up.hs<-lm(e4.1.up.hs$energy_over_time~as.numeric(david4.1.up.hs$normDS))
hs.lm.4.s.up.hs<-summary(lm.hs.4.up.hs)$coefficients
hs.4.slope.up.hs<-hs.lm.4.s.up.hs[2,1]
lm.hs.5.up.hs<-lm(e5.1.up.hs$energy_over_time~as.numeric(david5.1.up.hs$normDS))
hs.lm.5.s.up.hs<-summary(lm.hs.5.up.hs)$coefficients
hs.5.slope.up.hs<-hs.lm.5.s.up.hs[2,1]
lm.hs.6.up.hs<-lm(e6.1.up.hs$energy_over_time~as.numeric(david6.1.up.hs$normDS))
hs.lm.6.s.up.hs<-summary(lm.hs.6.up.hs)$coefficients
hs.6.slope.up.hs<-hs.lm.6.s.up.hs[2,1]
lm.hs.7.up.hs<-lm(e7.1.up.hs$energy_over_time~as.numeric(david7.1.up.hs$normDS))
hs.lm.7.s.up.hs<-summary(lm.hs.7.up.hs)$coefficients
hs.7.slope.up.hs<-hs.lm.7.s.up.hs[2,1]
lm.hs.8.up.hs<-lm(e8.1.up.hs$energy_over_time~as.numeric(david8.1.up.hs$normDS))
hs.lm.8.s.up.hs<-summary(lm.hs.8.up.hs)$coefficients
hs.8.slope.up.hs<-hs.lm.8.s.up.hs[2,1]
lm.hs.9.up.hs<-lm(e9.1.up.hs$energy_over_time~as.numeric(david9.1.up.hs$normDS))
hs.lm.9.s.up.hs<-summary(lm.hs.9.up.hs)$coefficients
hs.9.slope.up.hs<-hs.lm.9.s.up.hs[2,1]
lm.hs.10.up.hs<-lm(e10.1.up.hs$energy_over_time~as.numeric(david10.1.up.hs$normDS))
hs.lm.10.s.up.hs<-summary(lm.hs.10.up.hs)$coefficients
hs.10.slope.up.hs<-hs.lm.10.s.up.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.up.ss<-data.frame(triangle.transitivity=c(tri1.up.hs,tri2.up.hs,tri3.up.hs,tri4.up.hs,tri5.up.hs,tri6.up.hs,tri7.up.hs,tri8.up.hs,tri9.up.hs,tri10.up.hs),escalation=c(ep1.up.hs,ep2.up.hs,ep3.up.hs,ep4.up.hs,ep5.up.hs,ep6.up.hs,ep7.up.hs,ep8.up.hs,ep9.up.hs,ep10.up.hs),dci=c(dci1.up.hs,dci2.up.hs,dci3.up.hs,dci4.up.hs,dci5.up.hs,dci6.up.hs,dci7.up.hs,dci8.up.hs,dci9.up.hs,dci10.up.hs),steepness=c(s1.up.hs,s2.up.hs,s3.up.hs,s4.up.hs,s5.up.hs,s6.up.hs,s7.up.hs,s8.up.hs,s9.up.hs,s10.up.hs),slope=c(hs.1.slope.up.hs,hs.2.slope.up.hs,hs.3.slope.up.hs,hs.4.slope.up.hs,hs.5.slope.up.hs,hs.6.slope.up.hs,hs.7.slope.up.hs,hs.8.slope.up.hs,hs.9.slope.up.hs,hs.10.slope.up.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid.up.ho<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.up.ho<-data.frame(X1=avoid.up.ho[[1]],X2=avoid.up.ho[[2]],Avoids=avoid.up.ho[[3]])
a2.up.ho<-data.frame(X1=avoid.up.ho[[4]],X2=avoid.up.ho[[5]],Avoids=avoid.up.ho[[6]])
a3.up.ho<-data.frame(X1=avoid.up.ho[[7]],X2=avoid.up.ho[[8]],Avoids=avoid.up.ho[[9]])
a4.up.ho<-data.frame(X1=avoid.up.ho[[10]],X2=avoid.up.ho[[11]],Avoids=avoid.up.ho[[12]])
a5.up.ho<-data.frame(X1=avoid.up.ho[[13]],X2=avoid.up.ho[[14]],Avoids=avoid.up.ho[[15]])
a6.up.ho<-data.frame(X1=avoid.up.ho[[16]],X2=avoid.up.ho[[17]],Avoids=avoid.up.ho[[18]])
a7.up.ho<-data.frame(X1=avoid.up.ho[[19]],X2=avoid.up.ho[[20]],Avoids=avoid.up.ho[[21]])
a8.up.ho<-data.frame(X1=avoid.up.ho[[22]],X2=avoid.up.ho[[23]],Avoids=avoid.up.ho[[24]])
a9.up.ho<-data.frame(X1=avoid.up.ho[[25]],X2=avoid.up.ho[[26]],Avoids=avoid.up.ho[[27]])
a10.up.ho<-data.frame(X1=avoid.up.ho[[28]],X2=avoid.up.ho[[29]],Avoids=avoid.up.ho[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.p/conflict")

files<-list.files(pattern="*.csv")
conflict.ho.up<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.up.ho<-data.frame(X1=conflict.ho.up[[1]],X2=conflict.ho.up[[2]],Victories=conflict.ho.up[[3]])
mat1.up.ho<-inter.mat(mut1.up.ho)
tri1.up.ho<-tr.tri(mat1.up.ho)
dci1.up.ho<-DCindex(mat1.up.ho)
mat1.up.ho[is.na(mat1.up.ho)] = 0
h1.up.ho<-h.index(mat1.up.ho)

ep1.up.ho<-ep(mut1.up.ho,a1.up.ho)
david1.up.ho<-DS(mat1.up.ho) #David's Scores - for steepness use normDS output
ordrank.1.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.up.ho<-cbind(ordrank.1.up.ho,ds=david1.up.ho$normDS)
lm1.up.ho<-summary(lm(ordrank.1.up.ho$ds~ordrank.1.up.ho$ord.rank))
s1.up.ho<-lm1.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.up.ho<-data.frame(X1=conflict.ho.up[[4]],X2=conflict.ho.up[[5]],Victories=conflict.ho.up[[6]])
mat2.up.ho<-inter.mat(mut2.up.ho)
tri2.up.ho<-tr.tri(mat2.up.ho)
dci2.up.ho<-DCindex(mat2.up.ho)
mat2.up.ho[is.na(mat2.up.ho)] = 0
h2.up.ho<-h.index(mat2.up.ho)

ep2.up.ho<-ep(mut2.up.ho,a2.up.ho)
david2.up.ho<-DS(mat2.up.ho) #David's Scores - for steepness use normDS output
ordrank.2.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.up.ho<-cbind(ordrank.2.up.ho,ds=david2.up.ho$normDS)
lm2.up.ho<-summary(lm(ordrank.2.up.ho$ds~ordrank.2.up.ho$ord.rank))
s2.up.ho<-lm2.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.up.ho<-data.frame(X1=conflict.ho.up[[7]],X2=conflict.ho.up[[8]],Victories=conflict.ho.up[[9]])
mat3.up.ho<-inter.mat(mut3.up.ho)
tri3.up.ho<-tr.tri(mat3.up.ho)
dci3.up.ho<-DCindex(mat3.up.ho)
mat3.up.ho[is.na(mat3.up.ho)] = 0
h3.up.ho<-h.index(mat3.up.ho)

ep3.up.ho<-ep(mut3.up.ho,a3.up.ho)
david3.up.ho<-DS(mat3.up.ho) #David's Scores - for steepness use normDS output
ordrank.3.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.up.ho<-cbind(ordrank.3.up.ho,ds=david3.up.ho$normDS)
lm3.up.ho<-summary(lm(ordrank.3.up.ho$ds~ordrank.3.up.ho$ord.rank))
s3.up.ho<-lm3.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.up.ho<-data.frame(X1=conflict.ho.up[[10]],X2=conflict.ho.up[[11]],Victories=conflict.ho.up[[12]])
mat4.up.ho<-inter.mat(mut4.up.ho)
tri4.up.ho<-tr.tri(mat4.up.ho)
dci4.up.ho<-DCindex(mat4.up.ho)
mat4.up.ho[is.na(mat4.up.ho)] = 0
h4.up.ho<-h.index(mat4.up.ho)

ep4.up.ho<-ep(mut4.up.ho,a4.up.ho)
david4.up.ho<-DS(mat4.up.ho) #David's Scores - for steepness use normDS output
ordrank.4.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.up.ho<-cbind(ordrank.4.up.ho,ds=david4.up.ho$normDS)
lm4.up.ho<-summary(lm(ordrank.4.up.ho$ds~ordrank.4.up.ho$ord.rank))
s4.up.ho<-lm4.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.up.ho<-data.frame(X1=conflict.ho.up[[13]],X2=conflict.ho.up[[14]],Victories=conflict.ho.up[[15]])
mat5.up.ho<-inter.mat(mut5.up.ho)
tri5.up.ho<-tr.tri(mat5.up.ho)
dci5.up.ho<-DCindex(mat5.up.ho)
mat5.up.ho[is.na(mat5.up.ho)] = 0
h5.up.ho<-h.index(mat5.up.ho)

ep5.up.ho<-ep(mut5.up.ho,a5.up.ho)
david5.up.ho<-DS(mat5.up.ho) #David's Scores - for steepness use normDS output
ordrank.5.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.up.ho<-cbind(ordrank.5.up.ho,ds=david5.up.ho$normDS)
lm5.up.ho<-summary(lm(ordrank.5.up.ho$ds~ordrank.5.up.ho$ord.rank))
s5.up.ho<-lm5.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.up.ho<-data.frame(X1=conflict.ho.up[[16]],X2=conflict.ho.up[[17]],Victories=conflict.ho.up[[18]])
mat6.up.ho<-inter.mat(mut6.up.ho)
tri6.up.ho<-tr.tri(mat6.up.ho)
dci6.up.ho<-DCindex(mat6.up.ho)
mat6.up.ho[is.na(mat6.up.ho)] = 0
h6.up.ho<-h.index(mat6.up.ho)

ep6.up.ho<-ep(mut6.up.ho,a6.up.ho)
david6.up.ho<-DS(mat6.up.ho) #David's Scores - for steepness use normDS output
ordrank.6.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.up.ho<-cbind(ordrank.6.up.ho,ds=david6.up.ho$normDS)
lm6.up.ho<-summary(lm(ordrank.6.up.ho$ds~ordrank.6.up.ho$ord.rank))
s6.up.ho<-lm6.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.up.ho<-data.frame(X1=conflict.ho.up[[19]],X2=conflict.ho.up[[20]],Victories=conflict.ho.up[[21]])
mat7.up.ho<-inter.mat(mut7.up.ho)
tri7.up.ho<-tr.tri(mat7.up.ho)
dci7.up.ho<-DCindex(mat7.up.ho)
mat7.up.ho[is.na(mat7.up.ho)] = 0
h7.up.ho<-h.index(mat7.up.ho)

ep7.up.ho<-ep(mut7.up.ho,a7.up.ho)
david7.up.ho<-DS(mat7.up.ho) #David's Scores - for steepness use normDS output
ordrank.7.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.up.ho<-cbind(ordrank.7.up.ho,ds=david7.up.ho$normDS)
lm7.up.ho<-summary(lm(ordrank.7.up.ho$ds~ordrank.7.up.ho$ord.rank))
s7.up.ho<-lm7.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.up.ho<-data.frame(X1=conflict.ho.up[[22]],X2=conflict.ho.up[[23]],Victories=conflict.ho.up[[24]])
mat8.up.ho<-inter.mat(mut8.up.ho)
tri8.up.ho<-tr.tri(mat8.up.ho)
dci8.up.ho<-DCindex(mat8.up.ho)
mat8.up.ho[is.na(mat8.up.ho)] = 0
h8.up.ho<-h.index(mat8.up.ho)

ep8.up.ho<-ep(mut8.up.ho,a8.up.ho)
david8.up.ho<-DS(mat8.up.ho) #David's Scores - for steepness use normDS output
ordrank.8.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.up.ho<-cbind(ordrank.8.up.ho,ds=david8.up.ho$normDS)
lm8.up.ho<-summary(lm(ordrank.8.up.ho$ds~ordrank.8.up.ho$ord.rank))
s8.up.ho<-lm8.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.up.ho<-data.frame(X1=conflict.ho.up[[25]],X2=conflict.ho.up[[26]],Victories=conflict.ho.up[[27]])
mat9.up.ho<-inter.mat(mut9.up.ho)
tri9.up.ho<-tr.tri(mat9.up.ho)
dci9.up.ho<-DCindex(mat9.up.ho)
mat9.up.ho[is.na(mat9.up.ho)] = 0
h9.up.ho<-h.index(mat9.up.ho)

ep9.up.ho<-ep(mut9.up.ho,a9.up.ho)
david9.up.ho<-DS(mat9.up.ho) #David's Scores - for steepness use normDS output
ordrank.9.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.up.ho<-cbind(ordrank.9.up.ho,ds=david9.up.ho$normDS)
lm9.up.ho<-summary(lm(ordrank.9.up.ho$ds~ordrank.9.up.ho$ord.rank))
s9.up.ho<-lm9.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.up.ho<-data.frame(X1=conflict.ho.up[[28]],X2=conflict.ho.up[[29]],Victories=conflict.ho.up[[30]])
mat10.up.ho<-inter.mat(mut10.up.ho)
tri10.up.ho<-tr.tri(mat10.up.ho)
dci10.up.ho<-DCindex(mat10.up.ho)
mat10.up.ho[is.na(mat10.up.ho)] = 0
h10.up.ho<-h.index(mat10.up.ho)

ep10.up.ho<-ep(mut10.up.ho,a10.up.ho)
david10.up.ho<-DS(mat10.up.ho) #David's Scores - for steepness use normDS output
ordrank.10.up.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.up.ho<-cbind(ordrank.10.up.ho,ds=david10.up.ho$normDS)
lm10.up.ho<-summary(lm(ordrank.10.up.ho$ds~ordrank.10.up.ho$ord.rank))
s10.up.ho<-lm10.up.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.up.ho<-sum(mut1.up.ho$Victories)
int2.up.ho<-sum(mut2.up.ho$Victories)
int3.up.ho<-sum(mut3.up.ho$Victories)
int4.up.ho<-sum(mut4.up.ho$Victories)
int5.up.ho<-sum(mut5.up.ho$Victories)
int6.up.ho<-sum(mut6.up.ho$Victories)
int7.up.ho<-sum(mut7.up.ho$Victories)
int8.up.ho<-sum(mut8.up.ho$Victories)
int9.up.ho<-sum(mut9.up.ho$Victories)
int10.up.ho<-sum(mut10.up.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.up.ho<-sum(a1.up.ho$Victories)
av2.up.ho<-sum(a2.up.ho$Victories)
av3.up.ho<-sum(a3.up.ho$Victories)
av4.up.ho<-sum(a4.up.ho$Victories)
av5.up.ho<-sum(a5.up.ho$Victories)
av6.up.ho<-sum(a6.up.ho$Victories)
av7.up.ho<-sum(a7.up.ho$Victories)
av8.up.ho<-sum(a8.up.ho$Victories)
av9.up.ho<-sum(a9.up.ho$Victories)
av10.up.ho<-sum(a10.up.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.pu<-(sum(av1.up.ho, av2.up.ho, av3.up.ho, av4.up.ho, av5.up.ho, av6.up.ho, av7.up.ho, av8.up.ho, av9.up.ho, av10.up.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.pu<-(sum(int1.up.ho, int2.up.ho, int3.up.ho, int4.up.ho, int5.up.ho, int6.up.ho, int7.up.ho, int8.up.ho, int9.up.ho, int10.up.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.up.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.up.ho<-e1.up.ho[order(e1.up.ho$ID),]
e1.up.ho<-as.matrix(t(e1.1.up.ho))

e2.up.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.up.ho<-e2.up.ho[order(e2.up.ho$ID),]
e2.up.ho<-as.matrix(t(e2.1.up.ho))

e3.up.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.up.ho<-e3.up.ho[order(e3.up.ho$ID),]
e3.up.ho<-as.matrix(t(e3.1.up.ho))

e4.up.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.up.ho<-e4.up.ho[order(e4.up.ho$ID),]
e4.up.ho<-as.matrix(t(e4.1.up.ho))

e5.up.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.up.ho<-e5.up.ho[order(e5.up.ho$ID),]
e5.up.ho<-as.matrix(t(e5.1.up.ho))

e6.up.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.up.ho<-e6.up.ho[order(e6.up.ho$ID),]
e6.up.ho<-as.matrix(t(e6.1.up.ho))

e7.up.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.up.ho<-e7.up.ho[order(e7.up.ho$ID),]
e7.up.ho<-as.matrix(t(e7.1.up.ho))

e8.up.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.up.ho<-e8.up.ho[order(e8.up.ho$ID),]
e8.up.ho<-as.matrix(t(e8.1.up.ho))

e9.up.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.up.ho<-e9.up.ho[order(e9.up.ho$ID),]
e9.up.ho<-as.matrix(t(e9.1.up.ho))

e10.up.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.up.ho<-e10.up.ho[order(e10.up.ho$ID),]
e10.up.ho<-as.matrix(t(e10.1.up.ho))

energy.ho.up.ho<-as.data.frame(matrix(c(e1.up.ho,e2.up.ho,e3.up.ho,e4.up.ho,e5.up.ho,e6.up.ho,e7.up.ho,e8.up.ho,e9.up.ho,e10.up.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.up.ho<-data.frame(ID=energy.ho.up.ho$V1,energy_over_distance=energy.ho.up.ho$V2,energy_over_time=energy.ho.up.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.up.ho<-david1.up.ho[order(david1.up.ho$ID),]
david1.up.ho<-as.matrix(t(david1.1.up.ho))

david2.1.up.ho<-david2.up.ho[order(david2.up.ho$ID),]
david2.up.ho<-as.matrix(t(david2.1.up.ho))

david3.1.up.ho<-david3.up.ho[order(david3.up.ho$ID),]
david3.up.ho<-as.matrix(t(david3.1.up.ho))

david4.1.up.ho<-david4.up.ho[order(david4.up.ho$ID),]
david4.up.ho<-as.matrix(t(david4.1.up.ho))

david5.1.up.ho<-david5.up.ho[order(david5.up.ho$ID),]
david5.up.ho<-as.matrix(t(david5.1.up.ho))

david6.1.up.ho<-david6.up.ho[order(david6.up.ho$ID),]
david6.up.ho<-as.matrix(t(david6.1.up.ho))

david7.1.up.ho<-david7.up.ho[order(david7.up.ho$ID),]
david7.up.ho<-as.matrix(t(david7.1.up.ho))

david8.1.up.ho<-david8.up.ho[order(david8.up.ho$ID),]
david8.up.ho<-as.matrix(t(david8.1.up.ho))

david9.1.up.ho<-david9.up.ho[order(david9.up.ho$ID),]
david9.up.ho<-as.matrix(t(david9.1.up.ho))

david10.1.up.ho<-david10.up.ho[order(david10.up.ho$ID),]
david10.up.ho<-as.matrix(t(david10.1.up.ho))

david.ho.up.ho<-as.data.frame(matrix(c(david1.up.ho,david2.up.ho,david3.up.ho,david4.up.ho,david5.up.ho,david6.up.ho,david7.up.ho,david8.up.ho,david9.up.ho,david10.up.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.up.ho<-data.frame(ID=david.ho.up.ho$V1,DS=david.ho.up.ho$V2,normDS=david.ho.up.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.up.ho<-lm(e1.1.up.ho$energy_over_time~as.numeric(david1.1.up.ho$normDS))
ho.lm.1.s.up.ho<-summary(lm.ho.1.up.ho)$coefficients
ho.1.slope.up.ho<-ho.lm.1.s.up.ho[2,1]
lm.ho.2.up.ho<-lm(e2.1.up.ho$energy_over_time~as.numeric(david2.1.up.ho$normDS))
ho.lm.2.s.up.ho<-summary(lm.ho.2.up.ho)$coefficients
ho.2.slope.up.ho<-ho.lm.2.s.up.ho[2,1]
lm.ho.3.up.ho<-lm(e3.1.up.ho$energy_over_time~as.numeric(david3.1.up.ho$normDS))
ho.lm.3.s.up.ho<-summary(lm.ho.3.up.ho)$coefficients
ho.3.slope.up.ho<-ho.lm.3.s.up.ho[2,1]
lm.ho.4.up.ho<-lm(e4.1.up.ho$energy_over_time~as.numeric(david4.1.up.ho$normDS))
ho.lm.4.s.up.ho<-summary(lm.ho.4.up.ho)$coefficients
ho.4.slope.up.ho<-ho.lm.4.s.up.ho[2,1]
lm.ho.5.up.ho<-lm(e5.1.up.ho$energy_over_time~as.numeric(david5.1.up.ho$normDS))
ho.lm.5.s.up.ho<-summary(lm.ho.5.up.ho)$coefficients
ho.5.slope.up.ho<-ho.lm.5.s.up.ho[2,1]
lm.ho.6.up.ho<-lm(e6.1.up.ho$energy_over_time~as.numeric(david6.1.up.ho$normDS))
ho.lm.6.s.up.ho<-summary(lm.ho.6.up.ho)$coefficients
ho.6.slope.up.ho<-ho.lm.6.s.up.ho[2,1]
lm.ho.7.up.ho<-lm(e7.1.up.ho$energy_over_time~as.numeric(david7.1.up.ho$normDS))
ho.lm.7.s.up.ho<-summary(lm.ho.7.up.ho)$coefficients
ho.7.slope.up.ho<-ho.lm.7.s.up.ho[2,1]
lm.ho.8.up.ho<-lm(e8.1.up.ho$energy_over_time~as.numeric(david8.1.up.ho$normDS))
ho.lm.8.s.up.ho<-summary(lm.ho.8.up.ho)$coefficients
ho.8.slope.up.ho<-ho.lm.8.s.up.ho[2,1]
lm.ho.9.up.ho<-lm(e9.1.up.ho$energy_over_time~as.numeric(david9.1.up.ho$normDS))
ho.lm.9.s.up.ho<-summary(lm.ho.9.up.ho)$coefficients
ho.9.slope.up.ho<-ho.lm.9.s.up.ho[2,1]
lm.ho.10.up.ho<-lm(e10.1.up.ho$energy_over_time~as.numeric(david10.1.up.ho$normDS))
ho.lm.10.s.up.ho<-summary(lm.ho.10.up.ho)$coefficients
ho.10.slope.up.ho<-ho.lm.10.s.up.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.up.ss<-data.frame(triangle.transitivity=c(tri1.up.ho,tri2.up.ho,tri3.up.ho,tri4.up.ho,tri5.up.ho,tri6.up.ho,tri7.up.ho,tri8.up.ho,tri9.up.ho,tri10.up.ho),escalation=c(ep1.up.ho,ep2.up.ho,ep3.up.ho,ep4.up.ho,ep5.up.ho,ep6.up.ho,ep7.up.ho,ep8.up.ho,ep9.up.ho,ep10.up.ho),dci=c(dci1.up.ho,dci2.up.ho,dci3.up.ho,dci4.up.ho,dci5.up.ho,dci6.up.ho,dci7.up.ho,dci8.up.ho,dci9.up.ho,dci10.up.ho),steepness=c(s1.up.ho,s2.up.ho,s3.up.ho,s4.up.ho,s5.up.ho,s6.up.ho,s7.up.ho,s8.up.ho,s9.up.ho,s10.up.ho),slope=c(ho.1.slope.up.ho,ho.2.slope.up.ho,ho.3.slope.up.ho,ho.4.slope.up.ho,ho.5.slope.up.ho,ho.6.slope.up.ho,ho.7.slope.up.ho,ho.8.slope.up.ho,ho.9.slope.up.ho,ho.10.slope.up.ho))

#Overall linear models of each scenario
km.lm.pu<-lm((energy.km.df.up.km$energy_over_time)~as.numeric(david.km.df.up.km$normDS)) #knowledge mutual linear model
ks.lm.pu<-lm((energy.ks.df.up.ks$energy_over_time)~as.numeric(david.ks.df.up.ks$normDS)) #knowledge self linear model
ko.lm.pu<-lm((energy.ko.df.up.ko$energy_over_time)~as.numeric(david.ko.df.up.ko$normDS)) #knowledge opp linear model
hm.lm.pu<-lm((energy.hm.df.up.hm$energy_over_time)~as.numeric(david.hm.df.up.hm$normDS)) #history mutual linear model
hs.lm.pu<-lm((energy.hs.df.up.hs$energy_over_time)~as.numeric(david.hs.df.up.hs$normDS)) #history self linear model
ho.lm.pu<-lm((energy.ho.df.up.ho$energy_over_time)~as.numeric(david.ho.df.up.ho$normDS)) #history opp linear model
```
```{r Uniform Probabilistic Data Frame}
# Generate energy data frame:
total.energy.pu<-data.frame(energy.km.df.up.km)
total.energy.pu<-rbind(total.energy.pu,energy.ks.df.up.ks,energy.ko.df.up.ko,energy.hm.df.up.hm,energy.hs.df.up.hs,energy.ho.df.up.ho)

total.david.pu<-data.frame(david.km.df.up.km)
total.david.pu<-rbind(total.david.pu,david.ks.df.up.ks,david.ko.df.up.ko,david.hm.df.up.hm,david.hs.df.up.hs,david.ho.df.up.ho)

total.energy.pu<-cbind(total.energy.pu,normDS=total.david.pu$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.pu<-mean(km.up.ss$triangle.transitivity)
  km.pui.pu<-mean(km.up.ss$dci)
  km.esc.pu<-mean(km.up.ss$escalation)
  km.steep.pu<-mean(km.up.ss$steepness)
  km.slope.pu<-mean(km.up.ss$slope)
  km.mean.pu<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.pu,dci=km.pui.pu,esc=km.esc.pu,steepness=km.steep.pu,slope=km.slope.pu,dist="Uniform",calc="Probabilistic")

  # knowledge self
  ks.tt.pu<-mean(ks.up.ss$triangle.transitivity)
  ks.pui.pu<-mean(ks.up.ss$dci)
  ks.esc.pu<-mean(ks.up.ss$escalation)
  ks.steep.pu<-mean(ks.up.ss$steepness)
  ks.slope.pu<-mean(ks.up.ss$slope)
  ks.mean.pu<-data.frame(scenario="Knowledge self",tt=ks.tt.pu,dci=ks.pui.pu,esc=ks.esc.pu,steepness=ks.steep.pu,slope=ks.slope.pu,dist="Uniform",calc="Probabilistic")

  # knowledge opponent
  ko.tt.pu<-mean(ko.up.ss$triangle.transitivity)
  ko.pui.pu<-mean(ko.up.ss$dci)
  ko.esc.pu<-mean(ko.up.ss$escalation)
  ko.steep.pu<-mean(ko.up.ss$steepness)
  ko.slope.pu<-mean(ko.up.ss$slope)
  ko.mean.pu<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu,dci=ko.pui.pu,esc=ko.esc.pu,steepness=ko.steep.pu,slope=ko.slope.pu,dist="Uniform",calc="Probabilistic")

  # history mutual
  hm.tt.pu<-mean(hm.up.ss$triangle.transitivity)
  hm.pui.pu<-mean(hm.up.ss$dci)
  hm.esc.pu<-mean(hm.up.ss$escalation)
  hm.steep.pu<-mean(hm.up.ss$steepness)
  hm.slope.pu<-mean(hm.up.ss$slope)
  hm.mean.pu<-data.frame(scenario="History Mutual",tt=hm.tt.pu,dci=hm.pui.pu,esc=hm.esc.pu,steepness=hm.steep.pu,slope=hm.slope.pu,dist="Uniform",calc="Probabilistic")

  # history self
  hs.tt.pu<-mean(hs.up.ss$triangle.transitivity)
  hs.pui.pu<-mean(hs.up.ss$dci)
  hs.esc.pu<-mean(hs.up.ss$escalation)
  hs.steep.pu<-mean(hs.up.ss$steepness)
  hs.slope.pu<-mean(hs.up.ss$slope)
  hs.mean.pu<-data.frame(scenario="History self",tt=hs.tt.pu,dci=hs.pui.pu,esc=hs.esc.pu,steepness=hs.steep.pu,slope=hs.slope.pu,dist="Uniform",calc="Probabilistic")

  # history opponent
  ho.tt.pu<-mean(ho.up.ss$triangle.transitivity)
  ho.pui.pu<-mean(ho.up.ss$dci)
  ho.esc.pu<-mean(ho.up.ss$escalation)
  ho.steep.pu<-mean(ho.up.ss$steepness)
  ho.slope.pu<-mean(ho.up.ss$slope)
  ho.mean.pu<-data.frame(scenario="History opponent",tt=ho.tt.pu,dci=ho.pui.pu,esc=ho.esc.pu,steepness=ho.steep.pu,slope=ho.slope.pu,dist="Uniform",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.pu,ks.mean.pu,ko.mean.pu,hm.mean.pu,hs.mean.pu,ho.mean.pu)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.pu<-mean(km.up.ss$triangle.transitivity)
  km.pui.pu<-mean(km.up.ss$dci)
  km.esc.pu<-mean(km.up.ss$escalation)
  km.steep.pu<-mean(km.up.ss$steepness)
  km.slope.pu<-mean(km.up.ss$slope)
  km.mean.pu<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu,dci=km.pui.pu,esc=km.esc.pu,steepness=km.steep.pu,slope=km.slope.pu,dist="Uniform",calc="Probabilistic")
  
  #knowledge self
  ks.tt.pu<-mean(ks.up.ss$triangle.transitivity)
  ks.pui.pu<-mean(ks.up.ss$dci)
  ks.esc.pu<-mean(ks.up.ss$escalation)
  ks.steep.pu<-mean(ks.up.ss$steepness)
  ks.slope.pu<-mean(ks.up.ss$slope)
  ks.mean.pu<-data.frame(scenario="Knowledge self",tt=ks.tt.pu,dci=ks.pui.pu,esc=ks.esc.pu,steepness=ks.steep.pu,slope=ks.slope.pu,dist="Uniform",calc="Probabilistic")
  
  #knowledge opponent
  ko.tt.pu<-mean(ko.up.ss$triangle.transitivity)
  ko.pui.pu<-mean(ko.up.ss$dci)
  ko.esc.pu<-mean(ko.up.ss$escalation)
  ko.steep.pu<-mean(ko.up.ss$steepness)
  ko.slope.pu<-mean(ko.up.ss$slope)
  ko.mean.pu<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu,dci=ko.pui.pu,esc=ko.esc.pu,steepness=ko.steep.pu,slope=ko.slope.pu,dist="Uniform",calc="Probabilistic")
  
  #history mutual
  hm.tt.pu<-mean(hm.up.ss$triangle.transitivity)
  hm.pui.pu<-mean(hm.up.ss$dci)
  hm.esc.pu<-mean(hm.up.ss$escalation)
  hm.steep.pu<-mean(hm.up.ss$steepness)
  hm.slope.pu<-mean(hm.up.ss$slope)
  hm.mean.pu<-data.frame(scenario="History Mutual",tt=hm.tt.pu,dci=hm.pui.pu,esc=hm.esc.pu,steepness=hm.steep.pu,slope=hm.slope.pu,dist="Uniform",calc="Probabilistic")
  
  #history self
  hs.tt.pu<-mean(hs.up.ss$triangle.transitivity)
  hs.pui.pu<-mean(hs.up.ss$dci)
  hs.esc.pu<-mean(hs.up.ss$escalation)
  hs.steep.pu<-mean(hs.up.ss$steepness)
  hs.slope.pu<-mean(hs.up.ss$slope)
  hs.mean.pu<-data.frame(scenario="History self",tt=hs.tt.pu,dci=hs.pui.pu,esc=hs.esc.pu,steepness=hs.steep.pu,slope=hs.slope.pu,dist="Uniform",calc="Probabilistic")
  
  #history opponent
  ho.tt.pu<-mean(ho.up.ss$triangle.transitivity)
  ho.pui.pu<-mean(ho.up.ss$dci)
  ho.esc.pu<-mean(ho.up.ss$escalation)
  ho.steep.pu<-mean(ho.up.ss$steepness)
  ho.slope.pu<-mean(ho.up.ss$slope)
  ho.mean.pu<-data.frame(scenario="History opponent",tt=ho.tt.pu,dci=ho.pui.pu,esc=ho.esc.pu,steepness=ho.steep.pu,slope=ho.slope.pu,dist="Uniform",calc="Probabilistic")

# Generate data frame for all averages:
dc.ave<-rbind(km.mean.pu,ks.mean.pu,ko.mean.pu,hm.mean.pu,hs.mean.pu,ho.mean.pu)

# Create overall dataframe of summary statistics:
overall.unif.prob<-data.frame(km.up.ss)
overall.unif.prob<-rbind(overall.unif.prob,ks.up.ss)
overall.unif.prob<-rbind(overall.unif.prob,ko.up.ss)
overall.unif.prob<-rbind(overall.unif.prob,hm.up.ss)
overall.unif.prob<-rbind(overall.unif.prob,hs.up.ss)
overall.unif.prob<-rbind(overall.unif.prob,ho.up.ss)

overall.unif.prob<-cbind(overall.unif.prob,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.prob<-cbind(overall.unif.prob,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.up.ss<-overall.unif.prob[overall.unif.prob$variable=="rhp",]
history.up.ss<-overall.unif.prob[overall.unif.prob$variable=="history",]

overall.unif.prob$combo<-paste(overall.unif.prob$strategy,overall.unif.prob$variable,overall.unif.prob$distribution)
overall.unif.prob$combo2<-paste(overall.unif.prob$strategy,overall.unif.prob$variable) #final dataframe for Probabilistic Uniform data
```

## Avoids Uniform Probabilistic Data
```{r Avoids Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aup.km<-data.frame(X1=avoid.up.km[[1]],X2=avoid.up.km[[2]],Avoids=avoid.up.km[[3]])
mat1.aup.km<-avoid.inter.mat(mut1.aup.km)
tri1.aup.km<-tr.tri(mat1.aup.km)
dci1.aup.km<-DCindex(mat1.aup.km)
mat1.aup.km[is.na(mat1.aup.km)] = 0
h1.aup.km<-h.index(mat1.aup.km)

ep1.aup.km<-ep(mut1.aup.km,a1.up.km)
david1.aup.km<-DS(mat1.aup.km) #David's Scores - for steepness use normDS output
ordrank.1.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.km<-cbind(ordrank.1.aup.km,ds=david1.aup.km$normDS)
lm1.aup.km<-summary(lm(ordrank.1.aup.km$ds~ordrank.1.aup.km$ord.rank))
s1.aup.km<-lm1.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.km<-data.frame(X1=avoid.up.km[[4]],X2=avoid.up.km[[5]],Avoids=avoid.up.km[[6]])
mat2.aup.km<-avoid.inter.mat(mut2.aup.km)
tri2.aup.km<-tr.tri(mat2.aup.km)
dci2.aup.km<-DCindex(mat2.aup.km)
mat2.aup.km[is.na(mat2.aup.km)] = 0
h2.aup.km<-h.index(mat2.aup.km)

ep2.aup.km<-ep(mut2.aup.km,a2.up.km)
david2.aup.km<-DS(mat2.aup.km) #David's Scores - for steepness use normDS output
ordrank.2.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.km<-cbind(ordrank.2.aup.km,ds=david2.aup.km$normDS)
lm2.aup.km<-summary(lm(ordrank.2.aup.km$ds~ordrank.2.aup.km$ord.rank))
s2.aup.km<-lm2.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.km<-data.frame(X1=avoid.up.km[[7]],X2=avoid.up.km[[8]],Avoids=avoid.up.km[[9]])
mat3.aup.km<-avoid.inter.mat(mut3.aup.km)
tri3.aup.km<-tr.tri(mat3.aup.km)
dci3.aup.km<-DCindex(mat3.aup.km)
mat3.aup.km[is.na(mat3.aup.km)] = 0
h3.aup.km<-h.index(mat3.aup.km)

ep3.aup.km<-ep(mut3.aup.km,a3.up.km)
david3.aup.km<-DS(mat3.aup.km) #David's Scores - for steepness use normDS output
ordrank.3.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.km<-cbind(ordrank.3.aup.km,ds=david3.aup.km$normDS)
lm3.aup.km<-summary(lm(ordrank.3.aup.km$ds~ordrank.3.aup.km$ord.rank))
s3.aup.km<-lm3.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.km<-data.frame(X1=avoid.up.km[[10]],X2=avoid.up.km[[11]],Avoids=avoid.up.km[[12]])
mat4.aup.km<-avoid.inter.mat(mut4.aup.km)
tri4.aup.km<-tr.tri(mat4.aup.km)
dci4.aup.km<-DCindex(mat4.aup.km)
mat4.aup.km[is.na(mat4.aup.km)] = 0
h4.aup.km<-h.index(mat4.aup.km)

ep4.aup.km<-ep(mut4.aup.km,a4.up.km)
david4.aup.km<-DS(mat4.aup.km) #David's Scores - for steepness use normDS output
ordrank.4.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.km<-cbind(ordrank.4.aup.km,ds=david4.aup.km$normDS)
lm4.aup.km<-summary(lm(ordrank.4.aup.km$ds~ordrank.4.aup.km$ord.rank))
s4.aup.km<-lm4.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.km<-data.frame(X1=avoid.up.km[[13]],X2=avoid.up.km[[14]],Avoids=avoid.up.km[[15]])
mat5.aup.km<-avoid.inter.mat(mut5.aup.km)
tri5.aup.km<-tr.tri(mat5.aup.km)
dci5.aup.km<-DCindex(mat5.aup.km)
mat5.aup.km[is.na(mat5.aup.km)] = 0
h5.aup.km<-h.index(mat5.aup.km)

ep5.aup.km<-ep(mut5.aup.km,a5.up.km)
david5.aup.km<-DS(mat5.aup.km) #David's Scores - for steepness use normDS output
ordrank.5.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.km<-cbind(ordrank.5.aup.km,ds=david5.aup.km$normDS)
lm5.aup.km<-summary(lm(ordrank.5.aup.km$ds~ordrank.5.aup.km$ord.rank))
s5.aup.km<-lm5.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.km<-data.frame(X1=avoid.up.km[[16]],X2=avoid.up.km[[17]],Avoids=avoid.up.km[[18]])
mat6.aup.km<-avoid.inter.mat(mut6.aup.km)
tri6.aup.km<-tr.tri(mat6.aup.km)
dci6.aup.km<-DCindex(mat6.aup.km)
mat6.aup.km[is.na(mat6.aup.km)] = 0
h6.aup.km<-h.index(mat6.aup.km)

ep6.aup.km<-ep(mut6.aup.km,a6.up.km)
david6.aup.km<-DS(mat6.aup.km) #David's Scores - for steepness use normDS output
ordrank.6.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.km<-cbind(ordrank.6.aup.km,ds=david6.aup.km$normDS)
lm6.aup.km<-summary(lm(ordrank.6.aup.km$ds~ordrank.6.aup.km$ord.rank))
s6.aup.km<-lm6.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.km<-data.frame(X1=avoid.up.km[[19]],X2=avoid.up.km[[20]],Avoids=avoid.up.km[[21]])
mat7.aup.km<-avoid.inter.mat(mut7.aup.km)
tri7.aup.km<-tr.tri(mat7.aup.km)
dci7.aup.km<-DCindex(mat7.aup.km)
mat7.aup.km[is.na(mat7.aup.km)] = 0
h7.aup.km<-h.index(mat7.aup.km)

ep7.aup.km<-ep(mut7.aup.km,a7.up.km)
david7.aup.km<-DS(mat7.aup.km) #David's Scores - for steepness use normDS output
ordrank.7.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.km<-cbind(ordrank.7.aup.km,ds=david7.aup.km$normDS)
lm7.aup.km<-summary(lm(ordrank.7.aup.km$ds~ordrank.7.aup.km$ord.rank))
s7.aup.km<-lm7.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.km<-data.frame(X1=avoid.up.km[[22]],X2=avoid.up.km[[23]],Avoids=avoid.up.km[[24]])
mat8.aup.km<-avoid.inter.mat(mut8.aup.km)
tri8.aup.km<-tr.tri(mat8.aup.km)
dci8.aup.km<-DCindex(mat8.aup.km)
mat8.aup.km[is.na(mat8.aup.km)] = 0
h8.aup.km<-h.index(mat8.aup.km)

ep8.aup.km<-ep(mut8.aup.km,a8.up.km)
david8.aup.km<-DS(mat8.aup.km) #David's Scores - for steepness use normDS output
ordrank.8.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.km<-cbind(ordrank.8.aup.km,ds=david8.aup.km$normDS)
lm8.aup.km<-summary(lm(ordrank.8.aup.km$ds~ordrank.8.aup.km$ord.rank))
s8.aup.km<-lm8.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.km<-data.frame(X1=avoid.up.km[[25]],X2=avoid.up.km[[26]],Avoids=avoid.up.km[[27]])
mat9.aup.km<-avoid.inter.mat(mut9.aup.km)
tri9.aup.km<-tr.tri(mat9.aup.km)
dci9.aup.km<-DCindex(mat9.aup.km)
mat9.aup.km[is.na(mat9.aup.km)] = 0
h9.aup.km<-h.index(mat9.aup.km)

ep9.aup.km<-ep(mut9.aup.km,a9.up.km)
david9.aup.km<-DS(mat9.aup.km) #David's Scores - for steepness use normDS output
ordrank.9.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.km<-cbind(ordrank.9.aup.km,ds=david9.aup.km$normDS)
lm9.aup.km<-summary(lm(ordrank.9.aup.km$ds~ordrank.9.aup.km$ord.rank))
s9.aup.km<-lm9.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.km<-data.frame(X1=avoid.up.km[[28]],X2=avoid.up.km[[29]],Avoids=avoid.up.km[[30]])
mat10.aup.km<-avoid.inter.mat(mut10.aup.km)
tri10.aup.km<-tr.tri(mat10.aup.km)
dci10.aup.km<-DCindex(mat10.aup.km)
mat10.aup.km[is.na(mat10.aup.km)] = 0
h10.aup.km<-h.index(mat10.aup.km)

ep10.aup.km<-ep(mut10.aup.km,a10.up.km)
david10.aup.km<-DS(mat10.aup.km) #David's Scores - for steepness use normDS output
ordrank.10.aup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.km<-cbind(ordrank.10.aup.km,ds=david10.aup.km$normDS)
lm10.aup.km<-summary(lm(ordrank.10.aup.km$ds~ordrank.10.aup.km$ord.rank))
s10.aup.km<-lm10.aup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.km<-sum(mut1.aup.km$Victories)
int2.aup.km<-sum(mut2.aup.km$Victories)
int3.aup.km<-sum(mut3.aup.km$Victories)
int4.aup.km<-sum(mut4.aup.km$Victories)
int5.aup.km<-sum(mut5.aup.km$Victories)
int6.aup.km<-sum(mut6.aup.km$Victories)
int7.aup.km<-sum(mut7.aup.km$Victories)
int8.aup.km<-sum(mut8.aup.km$Victories)
int9.aup.km<-sum(mut9.aup.km$Victories)
int10.aup.km<-sum(mut10.aup.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.km<-sum(a1.up.km$Victories)
av2.aup.km<-sum(a2.up.km$Victories)
av3.aup.km<-sum(a3.up.km$Victories)
av4.aup.km<-sum(a4.up.km$Victories)
av5.aup.km<-sum(a5.up.km$Victories)
av6.aup.km<-sum(a6.up.km$Victories)
av7.aup.km<-sum(a7.up.km$Victories)
av8.aup.km<-sum(a8.up.km$Victories)
av9.aup.km<-sum(a9.up.km$Victories)
av10.aup.km<-sum(a10.up.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.adu<-(sum(av1.aup.km, av2.aup.km, av3.aup.km, av4.aup.km, av5.aup.km, av6.aup.km, av7.aup.km, av8.aup.km, av9.aup.km, av10.aup.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.adu<-(sum(int1.aup.km, int2.aup.km, int3.aup.km, int4.aup.km, int5.aup.km, int6.aup.km, int7.aup.km, int8.aup.km, int9.aup.km, int10.aup.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.km<-e1.aup.km[order(e1.aup.km$ID),]
e1.aup.km<-as.matrix(t(e1.1.aup.km))

e2.aup.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.km<-e2.aup.km[order(e2.aup.km$ID),]
e2.aup.km<-as.matrix(t(e2.1.aup.km))

e3.aup.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.km<-e3.aup.km[order(e3.aup.km$ID),]
e3.aup.km<-as.matrix(t(e3.1.aup.km))

e4.aup.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.km<-e4.aup.km[order(e4.aup.km$ID),]
e4.aup.km<-as.matrix(t(e4.1.aup.km))

e5.aup.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.km<-e5.aup.km[order(e5.aup.km$ID),]
e5.aup.km<-as.matrix(t(e5.1.aup.km))

e6.aup.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.km<-e6.aup.km[order(e6.aup.km$ID),]
e6.aup.km<-as.matrix(t(e6.1.aup.km))

e7.aup.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.km<-e7.aup.km[order(e7.aup.km$ID),]
e7.aup.km<-as.matrix(t(e7.1.aup.km))

e8.aup.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.km<-e8.aup.km[order(e8.aup.km$ID),]
e8.aup.km<-as.matrix(t(e8.1.aup.km))

e9.aup.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.km<-e9.aup.km[order(e9.aup.km$ID),]
e9.aup.km<-as.matrix(t(e9.1.aup.km))

e10.aup.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.km<-e10.aup.km[order(e10.aup.km$ID),]
e10.aup.km<-as.matrix(t(e10.1.aup.km))

energy.km.aup.km<-as.data.frame(matrix(c(e1.aup.km,e2.aup.km,e3.aup.km,e4.aup.km,e5.aup.km,e6.aup.km,e7.aup.km,e8.aup.km,e9.aup.km,e10.aup.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aup.km<-data.frame(ID=energy.km.aup.km$V1,energy_over_distance=energy.km.aup.km$V2,energy_over_time=energy.km.aup.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.km<-david1.aup.km[order(david1.aup.km$ID),]
david1.aup.km<-as.matrix(t(david1.1.aup.km))

david2.1.aup.km<-david2.aup.km[order(david2.aup.km$ID),]
david2.aup.km<-as.matrix(t(david2.1.aup.km))

david3.1.aup.km<-david3.aup.km[order(david3.aup.km$ID),]
david3.aup.km<-as.matrix(t(david3.1.aup.km))

david4.1.aup.km<-david4.aup.km[order(david4.aup.km$ID),]
david4.aup.km<-as.matrix(t(david4.1.aup.km))

david5.1.aup.km<-david5.aup.km[order(david5.aup.km$ID),]
david5.aup.km<-as.matrix(t(david5.1.aup.km))

david6.1.aup.km<-david6.aup.km[order(david6.aup.km$ID),]
david6.aup.km<-as.matrix(t(david6.1.aup.km))

david7.1.aup.km<-david7.aup.km[order(david7.aup.km$ID),]
david7.aup.km<-as.matrix(t(david7.1.aup.km))

david8.1.aup.km<-david8.aup.km[order(david8.aup.km$ID),]
david8.aup.km<-as.matrix(t(david8.1.aup.km))

david9.1.aup.km<-david9.aup.km[order(david9.aup.km$ID),]
david9.aup.km<-as.matrix(t(david9.1.aup.km))

david10.1.aup.km<-david10.aup.km[order(david10.aup.km$ID),]
david10.aup.km<-as.matrix(t(david10.1.aup.km))

david.km.aup.km<-as.data.frame(matrix(c(david1.aup.km,david2.aup.km,david3.aup.km,david4.aup.km,david5.aup.km,david6.aup.km,david7.aup.km,david8.aup.km,david9.aup.km,david10.aup.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aup.km<-data.frame(ID=david.km.aup.km$V1,DS=david.km.aup.km$V2,normDS=david.km.aup.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aup.km<-lm(e1.1.aup.km$energy_over_time~as.numeric(david1.1.aup.km$normDS))
km.lm.1.s.aup.km<-summary(lm.km.1.aup.km)$coefficients
km.1.slope.aup.km<-km.lm.1.s.aup.km[2,1]
lm.km.2.aup.km<-lm(e2.1.aup.km$energy_over_time~as.numeric(david2.1.aup.km$normDS))
km.lm.2.s.aup.km<-summary(lm.km.2.aup.km)$coefficients
km.2.slope.aup.km<-km.lm.2.s.aup.km[2,1]
lm.km.3.aup.km<-lm(e3.1.aup.km$energy_over_time~as.numeric(david3.1.aup.km$normDS))
km.lm.3.s.aup.km<-summary(lm.km.3.aup.km)$coefficients
km.3.slope.aup.km<-km.lm.3.s.aup.km[2,1]
lm.km.4.aup.km<-lm(e4.1.aup.km$energy_over_time~as.numeric(david4.1.aup.km$normDS))
km.lm.4.s.aup.km<-summary(lm.km.4.aup.km)$coefficients
km.4.slope.aup.km<-km.lm.4.s.aup.km[2,1]
lm.km.5.aup.km<-lm(e5.1.aup.km$energy_over_time~as.numeric(david5.1.aup.km$normDS))
km.lm.5.s.aup.km<-summary(lm.km.5.aup.km)$coefficients
km.5.slope.aup.km<-km.lm.5.s.aup.km[2,1]
lm.km.6.aup.km<-lm(e6.1.aup.km$energy_over_time~as.numeric(david6.1.aup.km$normDS))
km.lm.6.s.aup.km<-summary(lm.km.6.aup.km)$coefficients
km.6.slope.aup.km<-km.lm.6.s.aup.km[2,1]
lm.km.7.aup.km<-lm(e7.1.aup.km$energy_over_time~as.numeric(david7.1.aup.km$normDS))
km.lm.7.s.aup.km<-summary(lm.km.7.aup.km)$coefficients
km.7.slope.aup.km<-km.lm.7.s.aup.km[2,1]
lm.km.8.aup.km<-lm(e8.1.aup.km$energy_over_time~as.numeric(david8.1.aup.km$normDS))
km.lm.8.s.aup.km<-summary(lm.km.8.aup.km)$coefficients
km.8.slope.aup.km<-km.lm.8.s.aup.km[2,1]
lm.km.9.aup.km<-lm(e9.1.aup.km$energy_over_time~as.numeric(david9.1.aup.km$normDS))
km.lm.9.s.aup.km<-summary(lm.km.9.aup.km)$coefficients
km.9.slope.aup.km<-km.lm.9.s.aup.km[2,1]
lm.km.10.aup.km<-lm(e10.1.aup.km$energy_over_time~as.numeric(david10.1.aup.km$normDS))
km.lm.10.s.aup.km<-summary(lm.km.10.aup.km)$coefficients
km.10.slope.aup.km<-km.lm.10.s.aup.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aup.ss.avoid.up.km<-data.frame(triangle.transitivity=c(tri1.aup.km,tri2.aup.km,tri3.aup.km,tri4.aup.km,tri5.aup.km,tri6.aup.km,tri7.aup.km,tri8.aup.km,tri9.aup.km,tri10.aup.km),escalation=c(ep1.aup.km,ep2.aup.km,ep3.aup.km,ep4.aup.km,ep5.aup.km,ep6.aup.km,ep7.aup.km,ep8.aup.km,ep9.aup.km,ep10.aup.km),dci=c(dci1.aup.km,dci2.aup.km,dci3.aup.km,dci4.aup.km,dci5.aup.km,dci6.aup.km,dci7.aup.km,dci8.aup.km,dci9.aup.km,dci10.aup.km),steepness=c(s1.aup.km,s2.aup.km,s3.aup.km,s4.aup.km,s5.aup.km,s6.aup.km,s7.aup.km,s8.aup.km,s9.aup.km,s10.aup.km),slope=c(km.1.slope.aup.km,km.2.slope.aup.km,km.3.slope.aup.km,km.4.slope.aup.km,km.5.slope.aup.km,km.6.slope.aup.km,km.7.slope.aup.km,km.8.slope.aup.km,km.9.slope.aup.km,km.10.slope.aup.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.ks<-data.frame(X1=avoid.up.ks[[1]],X2=avoid.up.ks[[2]],Avoids=avoid.up.ks[[3]])
mat1.aup.ks<-avoid.inter.mat(mut1.aup.ks)
tri1.aup.ks<-tr.tri(mat1.aup.ks)
dci1.aup.ks<-DCindex(mat1.aup.ks)
mat1.aup.ks[is.na(mat1.aup.ks)] = 0
h1.aup.ks<-h.index(mat1.aup.ks)

ep1.aup.ks<-ep(mut1.aup.ks,a1.up.ks)
david1.aup.ks<-DS(mat1.aup.ks) #David's Scores - for steepness use normDS output
ordrank.1.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.ks<-cbind(ordrank.1.aup.ks,ds=david1.aup.ks$normDS)
lm1.aup.ks<-summary(lm(ordrank.1.aup.ks$ds~ordrank.1.aup.ks$ord.rank))
s1.aup.ks<-lm1.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.ks<-data.frame(X1=avoid.up.ks[[4]],X2=avoid.up.ks[[5]],Avoids=avoid.up.ks[[6]])
mat2.aup.ks<-avoid.inter.mat(mut2.aup.ks)
tri2.aup.ks<-tr.tri(mat2.aup.ks)
dci2.aup.ks<-DCindex(mat2.aup.ks)
mat2.aup.ks[is.na(mat2.aup.ks)] = 0
h2.aup.ks<-h.index(mat2.aup.ks)

ep2.aup.ks<-ep(mut2.aup.ks,a2.up.ks)
david2.aup.ks<-DS(mat2.aup.ks) #David's Scores - for steepness use normDS output
ordrank.2.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.ks<-cbind(ordrank.2.aup.ks,ds=david2.aup.ks$normDS)
lm2.aup.ks<-summary(lm(ordrank.2.aup.ks$ds~ordrank.2.aup.ks$ord.rank))
s2.aup.ks<-lm2.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.ks<-data.frame(X1=avoid.up.ks[[7]],X2=avoid.up.ks[[8]],Avoids=avoid.up.ks[[9]])
mat3.aup.ks<-avoid.inter.mat(mut3.aup.ks)
tri3.aup.ks<-tr.tri(mat3.aup.ks)
dci3.aup.ks<-DCindex(mat3.aup.ks)
mat3.aup.ks[is.na(mat3.aup.ks)] = 0
h3.aup.ks<-h.index(mat3.aup.ks)

ep3.aup.ks<-ep(mut3.aup.ks,a3.up.ks)
david3.aup.ks<-DS(mat3.aup.ks) #David's Scores - for steepness use normDS output
ordrank.3.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.ks<-cbind(ordrank.3.aup.ks,ds=david3.aup.ks$normDS)
lm3.aup.ks<-summary(lm(ordrank.3.aup.ks$ds~ordrank.3.aup.ks$ord.rank))
s3.aup.ks<-lm3.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.ks<-data.frame(X1=avoid.up.ks[[10]],X2=avoid.up.ks[[11]],Avoids=avoid.up.ks[[12]])
mat4.aup.ks<-avoid.inter.mat(mut4.aup.ks)
tri4.aup.ks<-tr.tri(mat4.aup.ks)
dci4.aup.ks<-DCindex(mat4.aup.ks)
mat4.aup.ks[is.na(mat4.aup.ks)] = 0
h4.aup.ks<-h.index(mat4.aup.ks)

ep4.aup.ks<-ep(mut4.aup.ks,a4.up.ks)
david4.aup.ks<-DS(mat4.aup.ks) #David's Scores - for steepness use normDS output
ordrank.4.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.ks<-cbind(ordrank.4.aup.ks,ds=david4.aup.ks$normDS)
lm4.aup.ks<-summary(lm(ordrank.4.aup.ks$ds~ordrank.4.aup.ks$ord.rank))
s4.aup.ks<-lm4.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.ks<-data.frame(X1=avoid.up.ks[[13]],X2=avoid.up.ks[[14]],Avoids=avoid.up.ks[[15]])
mat5.aup.ks<-avoid.inter.mat(mut5.aup.ks)
tri5.aup.ks<-tr.tri(mat5.aup.ks)
dci5.aup.ks<-DCindex(mat5.aup.ks)
mat5.aup.ks[is.na(mat5.aup.ks)] = 0
h5.aup.ks<-h.index(mat5.aup.ks)

ep5.aup.ks<-ep(mut5.aup.ks,a5.up.ks)
david5.aup.ks<-DS(mat5.aup.ks) #David's Scores - for steepness use normDS output
ordrank.5.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.ks<-cbind(ordrank.5.aup.ks,ds=david5.aup.ks$normDS)
lm5.aup.ks<-summary(lm(ordrank.5.aup.ks$ds~ordrank.5.aup.ks$ord.rank))
s5.aup.ks<-lm5.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.ks<-data.frame(X1=avoid.up.ks[[16]],X2=avoid.up.ks[[17]],Avoids=avoid.up.ks[[18]])
mat6.aup.ks<-avoid.inter.mat(mut6.aup.ks)
tri6.aup.ks<-tr.tri(mat6.aup.ks)
dci6.aup.ks<-DCindex(mat6.aup.ks)
mat6.aup.ks[is.na(mat6.aup.ks)] = 0
h6.aup.ks<-h.index(mat6.aup.ks)

ep6.aup.ks<-ep(mut6.aup.ks,a6.up.ks)
david6.aup.ks<-DS(mat6.aup.ks) #David's Scores - for steepness use normDS output
ordrank.6.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.ks<-cbind(ordrank.6.aup.ks,ds=david6.aup.ks$normDS)
lm6.aup.ks<-summary(lm(ordrank.6.aup.ks$ds~ordrank.6.aup.ks$ord.rank))
s6.aup.ks<-lm6.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.ks<-data.frame(X1=avoid.up.ks[[19]],X2=avoid.up.ks[[20]],Avoids=avoid.up.ks[[21]])
mat7.aup.ks<-avoid.inter.mat(mut7.aup.ks)
tri7.aup.ks<-tr.tri(mat7.aup.ks)
dci7.aup.ks<-DCindex(mat7.aup.ks)
mat7.aup.ks[is.na(mat7.aup.ks)] = 0
h7.aup.ks<-h.index(mat7.aup.ks)

ep7.aup.ks<-ep(mut7.aup.ks,a7.up.ks)
david7.aup.ks<-DS(mat7.aup.ks) #David's Scores - for steepness use normDS output
ordrank.7.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.ks<-cbind(ordrank.7.aup.ks,ds=david7.aup.ks$normDS)
lm7.aup.ks<-summary(lm(ordrank.7.aup.ks$ds~ordrank.7.aup.ks$ord.rank))
s7.aup.ks<-lm7.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.ks<-data.frame(X1=avoid.up.ks[[22]],X2=avoid.up.ks[[23]],Avoids=avoid.up.ks[[24]])
mat8.aup.ks<-avoid.inter.mat(mut8.aup.ks)
tri8.aup.ks<-tr.tri(mat8.aup.ks)
dci8.aup.ks<-DCindex(mat8.aup.ks)
mat8.aup.ks[is.na(mat8.aup.ks)] = 0
h8.aup.ks<-h.index(mat8.aup.ks)

ep8.aup.ks<-ep(mut8.aup.ks,a8.up.ks)
david8.aup.ks<-DS(mat8.aup.ks) #David's Scores - for steepness use normDS output
ordrank.8.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.ks<-cbind(ordrank.8.aup.ks,ds=david8.aup.ks$normDS)
lm8.aup.ks<-summary(lm(ordrank.8.aup.ks$ds~ordrank.8.aup.ks$ord.rank))
s8.aup.ks<-lm8.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.ks<-data.frame(X1=avoid.up.ks[[25]],X2=avoid.up.ks[[26]],Avoids=avoid.up.ks[[27]])
mat9.aup.ks<-avoid.inter.mat(mut9.aup.ks)
tri9.aup.ks<-tr.tri(mat9.aup.ks)
dci9.aup.ks<-DCindex(mat9.aup.ks)
mat9.aup.ks[is.na(mat9.aup.ks)] = 0
h9.aup.ks<-h.index(mat9.aup.ks)

ep9.aup.ks<-ep(mut9.aup.ks,a9.up.ks)
david9.aup.ks<-DS(mat9.aup.ks) #David's Scores - for steepness use normDS output
ordrank.9.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.ks<-cbind(ordrank.9.aup.ks,ds=david9.aup.ks$normDS)
lm9.aup.ks<-summary(lm(ordrank.9.aup.ks$ds~ordrank.9.aup.ks$ord.rank))
s9.aup.ks<-lm9.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.ks<-data.frame(X1=avoid.up.ks[[28]],X2=avoid.up.ks[[29]],Avoids=avoid.up.ks[[30]])
mat10.aup.ks<-avoid.inter.mat(mut10.aup.ks)
tri10.aup.ks<-tr.tri(mat10.aup.ks)
dci10.aup.ks<-DCindex(mat10.aup.ks)
mat10.aup.ks[is.na(mat10.aup.ks)] = 0
h10.aup.ks<-h.index(mat10.aup.ks)

ep10.aup.ks<-ep(mut10.aup.ks,a10.up.ks)
david10.aup.ks<-DS(mat10.aup.ks) #David's Scores - for steepness use normDS output
ordrank.10.aup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.ks<-cbind(ordrank.10.aup.ks,ds=david10.aup.ks$normDS)
lm10.aup.ks<-summary(lm(ordrank.10.aup.ks$ds~ordrank.10.aup.ks$ord.rank))
s10.aup.ks<-lm10.aup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.ks<-sum(mut1.aup.ks$Victories)
int2.aup.ks<-sum(mut2.aup.ks$Victories)
int3.aup.ks<-sum(mut3.aup.ks$Victories)
int4.aup.ks<-sum(mut4.aup.ks$Victories)
int5.aup.ks<-sum(mut5.aup.ks$Victories)
int6.aup.ks<-sum(mut6.aup.ks$Victories)
int7.aup.ks<-sum(mut7.aup.ks$Victories)
int8.aup.ks<-sum(mut8.aup.ks$Victories)
int9.aup.ks<-sum(mut9.aup.ks$Victories)
int10.aup.ks<-sum(mut10.aup.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.ks<-sum(a1.up.ks$Victories)
av2.aup.ks<-sum(a2.up.ks$Victories)
av3.aup.ks<-sum(a3.up.ks$Victories)
av4.aup.ks<-sum(a4.up.ks$Victories)
av5.aup.ks<-sum(a5.up.ks$Victories)
av6.aup.ks<-sum(a6.up.ks$Victories)
av7.aup.ks<-sum(a7.up.ks$Victories)
av8.aup.ks<-sum(a8.up.ks$Victories)
av9.aup.ks<-sum(a9.up.ks$Victories)
av10.aup.ks<-sum(a10.up.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.adu<-(sum(av1.aup.ks, av2.aup.ks, av3.aup.ks, av4.aup.ks, av5.aup.ks, av6.aup.ks, av7.aup.ks, av8.aup.ks, av9.aup.ks, av10.aup.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.adu<-(sum(int1.aup.ks, int2.aup.ks, int3.aup.ks, int4.aup.ks, int5.aup.ks, int6.aup.ks, int7.aup.ks, int8.aup.ks, int9.aup.ks, int10.aup.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.ks<-e1.aup.ks[order(e1.aup.ks$ID),]
e1.aup.ks<-as.matrix(t(e1.1.aup.ks))

e2.aup.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.ks<-e2.aup.ks[order(e2.aup.ks$ID),]
e2.aup.ks<-as.matrix(t(e2.1.aup.ks))

e3.aup.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.ks<-e3.aup.ks[order(e3.aup.ks$ID),]
e3.aup.ks<-as.matrix(t(e3.1.aup.ks))

e4.aup.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.ks<-e4.aup.ks[order(e4.aup.ks$ID),]
e4.aup.ks<-as.matrix(t(e4.1.aup.ks))

e5.aup.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.ks<-e5.aup.ks[order(e5.aup.ks$ID),]
e5.aup.ks<-as.matrix(t(e5.1.aup.ks))

e6.aup.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.ks<-e6.aup.ks[order(e6.aup.ks$ID),]
e6.aup.ks<-as.matrix(t(e6.1.aup.ks))

e7.aup.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.ks<-e7.aup.ks[order(e7.aup.ks$ID),]
e7.aup.ks<-as.matrix(t(e7.1.aup.ks))

e8.aup.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.ks<-e8.aup.ks[order(e8.aup.ks$ID),]
e8.aup.ks<-as.matrix(t(e8.1.aup.ks))

e9.aup.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.ks<-e9.aup.ks[order(e9.aup.ks$ID),]
e9.aup.ks<-as.matrix(t(e9.1.aup.ks))

e10.aup.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.ks<-e10.aup.ks[order(e10.aup.ks$ID),]
e10.aup.ks<-as.matrix(t(e10.1.aup.ks))

energy.ks.aup.ks<-as.data.frame(matrix(c(e1.aup.ks,e2.aup.ks,e3.aup.ks,e4.aup.ks,e5.aup.ks,e6.aup.ks,e7.aup.ks,e8.aup.ks,e9.aup.ks,e10.aup.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.aup.ks<-data.frame(ID=energy.ks.aup.ks$V1,energy_over_distance=energy.ks.aup.ks$V2,energy_over_time=energy.ks.aup.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.ks<-david1.aup.ks[order(david1.aup.ks$ID),]
david1.aup.ks<-as.matrix(t(david1.1.aup.ks))

david2.1.aup.ks<-david2.aup.ks[order(david2.aup.ks$ID),]
david2.aup.ks<-as.matrix(t(david2.1.aup.ks))

david3.1.aup.ks<-david3.aup.ks[order(david3.aup.ks$ID),]
david3.aup.ks<-as.matrix(t(david3.1.aup.ks))

david4.1.aup.ks<-david4.aup.ks[order(david4.aup.ks$ID),]
david4.aup.ks<-as.matrix(t(david4.1.aup.ks))

david5.1.aup.ks<-david5.aup.ks[order(david5.aup.ks$ID),]
david5.aup.ks<-as.matrix(t(david5.1.aup.ks))

david6.1.aup.ks<-david6.aup.ks[order(david6.aup.ks$ID),]
david6.aup.ks<-as.matrix(t(david6.1.aup.ks))

david7.1.aup.ks<-david7.aup.ks[order(david7.aup.ks$ID),]
david7.aup.ks<-as.matrix(t(david7.1.aup.ks))

david8.1.aup.ks<-david8.aup.ks[order(david8.aup.ks$ID),]
david8.aup.ks<-as.matrix(t(david8.1.aup.ks))

david9.1.aup.ks<-david9.aup.ks[order(david9.aup.ks$ID),]
david9.aup.ks<-as.matrix(t(david9.1.aup.ks))

david10.1.aup.ks<-david10.aup.ks[order(david10.aup.ks$ID),]
david10.aup.ks<-as.matrix(t(david10.1.aup.ks))

david.ks.aup.ks<-as.data.frame(matrix(c(david1.aup.ks,david2.aup.ks,david3.aup.ks,david4.aup.ks,david5.aup.ks,david6.aup.ks,david7.aup.ks,david8.aup.ks,david9.aup.ks,david10.aup.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.aup.ks<-data.frame(ID=david.ks.aup.ks$V1,DS=david.ks.aup.ks$V2,normDS=david.ks.aup.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.aup.ks<-lm(e1.1.aup.ks$energy_over_time~as.numeric(david1.1.aup.ks$normDS))
ks.lm.1.s.aup.ks<-summary(lm.ks.1.aup.ks)$coefficients
ks.1.slope.aup.ks<-ks.lm.1.s.aup.ks[2,1]
lm.ks.2.aup.ks<-lm(e2.1.aup.ks$energy_over_time~as.numeric(david2.1.aup.ks$normDS))
ks.lm.2.s.aup.ks<-summary(lm.ks.2.aup.ks)$coefficients
ks.2.slope.aup.ks<-ks.lm.2.s.aup.ks[2,1]
lm.ks.3.aup.ks<-lm(e3.1.aup.ks$energy_over_time~as.numeric(david3.1.aup.ks$normDS))
ks.lm.3.s.aup.ks<-summary(lm.ks.3.aup.ks)$coefficients
ks.3.slope.aup.ks<-ks.lm.3.s.aup.ks[2,1]
lm.ks.4.aup.ks<-lm(e4.1.aup.ks$energy_over_time~as.numeric(david4.1.aup.ks$normDS))
ks.lm.4.s.aup.ks<-summary(lm.ks.4.aup.ks)$coefficients
ks.4.slope.aup.ks<-ks.lm.4.s.aup.ks[2,1]
lm.ks.5.aup.ks<-lm(e5.1.aup.ks$energy_over_time~as.numeric(david5.1.aup.ks$normDS))
ks.lm.5.s.aup.ks<-summary(lm.ks.5.aup.ks)$coefficients
ks.5.slope.aup.ks<-ks.lm.5.s.aup.ks[2,1]
lm.ks.6.aup.ks<-lm(e6.1.aup.ks$energy_over_time~as.numeric(david6.1.aup.ks$normDS))
ks.lm.6.s.aup.ks<-summary(lm.ks.6.aup.ks)$coefficients
ks.6.slope.aup.ks<-ks.lm.6.s.aup.ks[2,1]
lm.ks.7.aup.ks<-lm(e7.1.aup.ks$energy_over_time~as.numeric(david7.1.aup.ks$normDS))
ks.lm.7.s.aup.ks<-summary(lm.ks.7.aup.ks)$coefficients
ks.7.slope.aup.ks<-ks.lm.7.s.aup.ks[2,1]
lm.ks.8.aup.ks<-lm(e8.1.aup.ks$energy_over_time~as.numeric(david8.1.aup.ks$normDS))
ks.lm.8.s.aup.ks<-summary(lm.ks.8.aup.ks)$coefficients
ks.8.slope.aup.ks<-ks.lm.8.s.aup.ks[2,1]
lm.ks.9.aup.ks<-lm(e9.1.aup.ks$energy_over_time~as.numeric(david9.1.aup.ks$normDS))
ks.lm.9.s.aup.ks<-summary(lm.ks.9.aup.ks)$coefficients
ks.9.slope.aup.ks<-ks.lm.9.s.aup.ks[2,1]
lm.ks.10.aup.ks<-lm(e10.1.aup.ks$energy_over_time~as.numeric(david10.1.aup.ks$normDS))
ks.lm.10.s.aup.ks<-summary(lm.ks.10.aup.ks)$coefficients
ks.10.slope.aup.ks<-ks.lm.10.s.aup.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.aup.ss.avoid.up.ks<-data.frame(triangle.transitivity=c(tri1.aup.ks,tri2.aup.ks,tri3.aup.ks,tri4.aup.ks,tri5.aup.ks,tri6.aup.ks,tri7.aup.ks,tri8.aup.ks,tri9.aup.ks,tri10.aup.ks),escalation=c(ep1.aup.ks,ep2.aup.ks,ep3.aup.ks,ep4.aup.ks,ep5.aup.ks,ep6.aup.ks,ep7.aup.ks,ep8.aup.ks,ep9.aup.ks,ep10.aup.ks),dci=c(dci1.aup.ks,dci2.aup.ks,dci3.aup.ks,dci4.aup.ks,dci5.aup.ks,dci6.aup.ks,dci7.aup.ks,dci8.aup.ks,dci9.aup.ks,dci10.aup.ks),steepness=c(s1.aup.ks,s2.aup.ks,s3.aup.ks,s4.aup.ks,s5.aup.ks,s6.aup.ks,s7.aup.ks,s8.aup.ks,s9.aup.ks,s10.aup.ks),slope=c(ks.1.slope.aup.ks,ks.2.slope.aup.ks,ks.3.slope.aup.ks,ks.4.slope.aup.ks,ks.5.slope.aup.ks,ks.6.slope.aup.ks,ks.7.slope.aup.ks,ks.8.slope.aup.ks,ks.9.slope.aup.ks,ks.10.slope.aup.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.ko<-data.frame(X1=avoid.up.ko[[1]],X2=avoid.up.ko[[2]],Avoids=avoid.up.ko[[3]])
mat1.aup.ko<-avoid.inter.mat(mut1.aup.ko)
tri1.aup.ko<-tr.tri(mat1.aup.ko)
dci1.aup.ko<-DCindex(mat1.aup.ko)
mat1.aup.ko[is.na(mat1.aup.ko)] = 0
h1.aup.ko<-h.index(mat1.aup.ko)

ep1.aup.ko<-ep(mut1.aup.ko,a1.up.ko)
david1.aup.ko<-DS(mat1.aup.ko) #David's Scores - for steepness use normDS output
ordrank.1.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.ko<-cbind(ordrank.1.aup.ko,ds=david1.aup.ko$normDS)
lm1.aup.ko<-summary(lm(ordrank.1.aup.ko$ds~ordrank.1.aup.ko$ord.rank))
s1.aup.ko<-lm1.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.ko<-data.frame(X1=avoid.up.ko[[4]],X2=avoid.up.ko[[5]],Avoids=avoid.up.ko[[6]])
mat2.aup.ko<-avoid.inter.mat(mut2.aup.ko)
tri2.aup.ko<-tr.tri(mat2.aup.ko)
dci2.aup.ko<-DCindex(mat2.aup.ko)
mat2.aup.ko[is.na(mat2.aup.ko)] = 0
h2.aup.ko<-h.index(mat2.aup.ko)

ep2.aup.ko<-ep(mut2.aup.ko,a2.up.ko)
david2.aup.ko<-DS(mat2.aup.ko) #David's Scores - for steepness use normDS output
ordrank.2.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.ko<-cbind(ordrank.2.aup.ko,ds=david2.aup.ko$normDS)
lm2.aup.ko<-summary(lm(ordrank.2.aup.ko$ds~ordrank.2.aup.ko$ord.rank))
s2.aup.ko<-lm2.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.ko<-data.frame(X1=avoid.up.ko[[7]],X2=avoid.up.ko[[8]],Avoids=avoid.up.ko[[9]])
mat3.aup.ko<-avoid.inter.mat(mut3.aup.ko)
tri3.aup.ko<-tr.tri(mat3.aup.ko)
dci3.aup.ko<-DCindex(mat3.aup.ko)
mat3.aup.ko[is.na(mat3.aup.ko)] = 0
h3.aup.ko<-h.index(mat3.aup.ko)

ep3.aup.ko<-ep(mut3.aup.ko,a3.up.ko)
david3.aup.ko<-DS(mat3.aup.ko) #David's Scores - for steepness use normDS output
ordrank.3.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.ko<-cbind(ordrank.3.aup.ko,ds=david3.aup.ko$normDS)
lm3.aup.ko<-summary(lm(ordrank.3.aup.ko$ds~ordrank.3.aup.ko$ord.rank))
s3.aup.ko<-lm3.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.ko<-data.frame(X1=avoid.up.ko[[10]],X2=avoid.up.ko[[11]],Avoids=avoid.up.ko[[12]])
mat4.aup.ko<-avoid.inter.mat(mut4.aup.ko)
tri4.aup.ko<-tr.tri(mat4.aup.ko)
dci4.aup.ko<-DCindex(mat4.aup.ko)
mat4.aup.ko[is.na(mat4.aup.ko)] = 0
h4.aup.ko<-h.index(mat4.aup.ko)

ep4.aup.ko<-ep(mut4.aup.ko,a4.up.ko)
david4.aup.ko<-DS(mat4.aup.ko) #David's Scores - for steepness use normDS output
ordrank.4.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.ko<-cbind(ordrank.4.aup.ko,ds=david4.aup.ko$normDS)
lm4.aup.ko<-summary(lm(ordrank.4.aup.ko$ds~ordrank.4.aup.ko$ord.rank))
s4.aup.ko<-lm4.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.ko<-data.frame(X1=avoid.up.ko[[13]],X2=avoid.up.ko[[14]],Avoids=avoid.up.ko[[15]])
mat5.aup.ko<-avoid.inter.mat(mut5.aup.ko)
tri5.aup.ko<-tr.tri(mat5.aup.ko)
dci5.aup.ko<-DCindex(mat5.aup.ko)
mat5.aup.ko[is.na(mat5.aup.ko)] = 0
h5.aup.ko<-h.index(mat5.aup.ko)

ep5.aup.ko<-ep(mut5.aup.ko,a5.up.ko)
david5.aup.ko<-DS(mat5.aup.ko) #David's Scores - for steepness use normDS output
ordrank.5.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.ko<-cbind(ordrank.5.aup.ko,ds=david5.aup.ko$normDS)
lm5.aup.ko<-summary(lm(ordrank.5.aup.ko$ds~ordrank.5.aup.ko$ord.rank))
s5.aup.ko<-lm5.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.ko<-data.frame(X1=avoid.up.ko[[16]],X2=avoid.up.ko[[17]],Avoids=avoid.up.ko[[18]])
mat6.aup.ko<-avoid.inter.mat(mut6.aup.ko)
tri6.aup.ko<-tr.tri(mat6.aup.ko)
dci6.aup.ko<-DCindex(mat6.aup.ko)
mat6.aup.ko[is.na(mat6.aup.ko)] = 0
h6.aup.ko<-h.index(mat6.aup.ko)

ep6.aup.ko<-ep(mut6.aup.ko,a6.up.ko)
david6.aup.ko<-DS(mat6.aup.ko) #David's Scores - for steepness use normDS output
ordrank.6.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.ko<-cbind(ordrank.6.aup.ko,ds=david6.aup.ko$normDS)
lm6.aup.ko<-summary(lm(ordrank.6.aup.ko$ds~ordrank.6.aup.ko$ord.rank))
s6.aup.ko<-lm6.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.ko<-data.frame(X1=avoid.up.ko[[19]],X2=avoid.up.ko[[20]],Avoids=avoid.up.ko[[21]])
mat7.aup.ko<-avoid.inter.mat(mut7.aup.ko)
tri7.aup.ko<-tr.tri(mat7.aup.ko)
dci7.aup.ko<-DCindex(mat7.aup.ko)
mat7.aup.ko[is.na(mat7.aup.ko)] = 0
h7.aup.ko<-h.index(mat7.aup.ko)

ep7.aup.ko<-ep(mut7.aup.ko,a7.up.ko)
david7.aup.ko<-DS(mat7.aup.ko) #David's Scores - for steepness use normDS output
ordrank.7.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.ko<-cbind(ordrank.7.aup.ko,ds=david7.aup.ko$normDS)
lm7.aup.ko<-summary(lm(ordrank.7.aup.ko$ds~ordrank.7.aup.ko$ord.rank))
s7.aup.ko<-lm7.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.ko<-data.frame(X1=avoid.up.ko[[22]],X2=avoid.up.ko[[23]],Avoids=avoid.up.ko[[24]])
mat8.aup.ko<-avoid.inter.mat(mut8.aup.ko)
tri8.aup.ko<-tr.tri(mat8.aup.ko)
dci8.aup.ko<-DCindex(mat8.aup.ko)
mat8.aup.ko[is.na(mat8.aup.ko)] = 0
h8.aup.ko<-h.index(mat8.aup.ko)

ep8.aup.ko<-ep(mut8.aup.ko,a8.up.ko)
david8.aup.ko<-DS(mat8.aup.ko) #David's Scores - for steepness use normDS output
ordrank.8.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.ko<-cbind(ordrank.8.aup.ko,ds=david8.aup.ko$normDS)
lm8.aup.ko<-summary(lm(ordrank.8.aup.ko$ds~ordrank.8.aup.ko$ord.rank))
s8.aup.ko<-lm8.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.ko<-data.frame(X1=avoid.up.ko[[25]],X2=avoid.up.ko[[26]],Avoids=avoid.up.ko[[27]])
mat9.aup.ko<-avoid.inter.mat(mut9.aup.ko)
tri9.aup.ko<-tr.tri(mat9.aup.ko)
dci9.aup.ko<-DCindex(mat9.aup.ko)
mat9.aup.ko[is.na(mat9.aup.ko)] = 0
h9.aup.ko<-h.index(mat9.aup.ko)

ep9.aup.ko<-ep(mut9.aup.ko,a9.up.ko)
david9.aup.ko<-DS(mat9.aup.ko) #David's Scores - for steepness use normDS output
ordrank.9.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.ko<-cbind(ordrank.9.aup.ko,ds=david9.aup.ko$normDS)
lm9.aup.ko<-summary(lm(ordrank.9.aup.ko$ds~ordrank.9.aup.ko$ord.rank))
s9.aup.ko<-lm9.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.ko<-data.frame(X1=avoid.up.ko[[28]],X2=avoid.up.ko[[29]],Avoids=avoid.up.ko[[30]])
mat10.aup.ko<-avoid.inter.mat(mut10.aup.ko)
tri10.aup.ko<-tr.tri(mat10.aup.ko)
dci10.aup.ko<-DCindex(mat10.aup.ko)
mat10.aup.ko[is.na(mat10.aup.ko)] = 0
h10.aup.ko<-h.index(mat10.aup.ko)

ep10.aup.ko<-ep(mut10.aup.ko,a10.up.ko)
david10.aup.ko<-DS(mat10.aup.ko) #David's Scores - for steepness use normDS output
ordrank.10.aup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.ko<-cbind(ordrank.10.aup.ko,ds=david10.aup.ko$normDS)
lm10.aup.ko<-summary(lm(ordrank.10.aup.ko$ds~ordrank.10.aup.ko$ord.rank))
s10.aup.ko<-lm10.aup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.ko<-sum(mut1.aup.ko$Victories)
int2.aup.ko<-sum(mut2.aup.ko$Victories)
int3.aup.ko<-sum(mut3.aup.ko$Victories)
int4.aup.ko<-sum(mut4.aup.ko$Victories)
int5.aup.ko<-sum(mut5.aup.ko$Victories)
int6.aup.ko<-sum(mut6.aup.ko$Victories)
int7.aup.ko<-sum(mut7.aup.ko$Victories)
int8.aup.ko<-sum(mut8.aup.ko$Victories)
int9.aup.ko<-sum(mut9.aup.ko$Victories)
int10.aup.ko<-sum(mut10.aup.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.ko<-sum(a1.up.ko$Victories)
av2.aup.ko<-sum(a2.up.ko$Victories)
av3.aup.ko<-sum(a3.up.ko$Victories)
av4.aup.ko<-sum(a4.up.ko$Victories)
av5.aup.ko<-sum(a5.up.ko$Victories)
av6.aup.ko<-sum(a6.up.ko$Victories)
av7.aup.ko<-sum(a7.up.ko$Victories)
av8.aup.ko<-sum(a8.up.ko$Victories)
av9.aup.ko<-sum(a9.up.ko$Victories)
av10.aup.ko<-sum(a10.up.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.adu<-(sum(av1.aup.ko, av2.aup.ko, av3.aup.ko, av4.aup.ko, av5.aup.ko, av6.aup.ko, av7.aup.ko, av8.aup.ko, av9.aup.ko, av10.aup.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.adu<-(sum(int1.aup.ko, int2.aup.ko, int3.aup.ko, int4.aup.ko, int5.aup.ko, int6.aup.ko, int7.aup.ko, int8.aup.ko, int9.aup.ko, int10.aup.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.ko<-e1.aup.ko[order(e1.aup.ko$ID),]
e1.aup.ko<-as.matrix(t(e1.1.aup.ko))

e2.aup.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.ko<-e2.aup.ko[order(e2.aup.ko$ID),]
e2.aup.ko<-as.matrix(t(e2.1.aup.ko))

e3.aup.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.ko<-e3.aup.ko[order(e3.aup.ko$ID),]
e3.aup.ko<-as.matrix(t(e3.1.aup.ko))

e4.aup.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.ko<-e4.aup.ko[order(e4.aup.ko$ID),]
e4.aup.ko<-as.matrix(t(e4.1.aup.ko))

e5.aup.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.ko<-e5.aup.ko[order(e5.aup.ko$ID),]
e5.aup.ko<-as.matrix(t(e5.1.aup.ko))

e6.aup.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.ko<-e6.aup.ko[order(e6.aup.ko$ID),]
e6.aup.ko<-as.matrix(t(e6.1.aup.ko))

e7.aup.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.ko<-e7.aup.ko[order(e7.aup.ko$ID),]
e7.aup.ko<-as.matrix(t(e7.1.aup.ko))

e8.aup.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.ko<-e8.aup.ko[order(e8.aup.ko$ID),]
e8.aup.ko<-as.matrix(t(e8.1.aup.ko))

e9.aup.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.ko<-e9.aup.ko[order(e9.aup.ko$ID),]
e9.aup.ko<-as.matrix(t(e9.1.aup.ko))

e10.aup.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.ko<-e10.aup.ko[order(e10.aup.ko$ID),]
e10.aup.ko<-as.matrix(t(e10.1.aup.ko))

energy.ko.aup.ko<-as.data.frame(matrix(c(e1.aup.ko,e2.aup.ko,e3.aup.ko,e4.aup.ko,e5.aup.ko,e6.aup.ko,e7.aup.ko,e8.aup.ko,e9.aup.ko,e10.aup.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.aup.ko<-data.frame(ID=energy.ko.aup.ko$V1,energy_over_distance=energy.ko.aup.ko$V2,energy_over_time=energy.ko.aup.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.ko<-david1.aup.ko[order(david1.aup.ko$ID),]
david1.aup.ko<-as.matrix(t(david1.1.aup.ko))

david2.1.aup.ko<-david2.aup.ko[order(david2.aup.ko$ID),]
david2.aup.ko<-as.matrix(t(david2.1.aup.ko))

david3.1.aup.ko<-david3.aup.ko[order(david3.aup.ko$ID),]
david3.aup.ko<-as.matrix(t(david3.1.aup.ko))

david4.1.aup.ko<-david4.aup.ko[order(david4.aup.ko$ID),]
david4.aup.ko<-as.matrix(t(david4.1.aup.ko))

david5.1.aup.ko<-david5.aup.ko[order(david5.aup.ko$ID),]
david5.aup.ko<-as.matrix(t(david5.1.aup.ko))

david6.1.aup.ko<-david6.aup.ko[order(david6.aup.ko$ID),]
david6.aup.ko<-as.matrix(t(david6.1.aup.ko))

david7.1.aup.ko<-david7.aup.ko[order(david7.aup.ko$ID),]
david7.aup.ko<-as.matrix(t(david7.1.aup.ko))

david8.1.aup.ko<-david8.aup.ko[order(david8.aup.ko$ID),]
david8.aup.ko<-as.matrix(t(david8.1.aup.ko))

david9.1.aup.ko<-david9.aup.ko[order(david9.aup.ko$ID),]
david9.aup.ko<-as.matrix(t(david9.1.aup.ko))

david10.1.aup.ko<-david10.aup.ko[order(david10.aup.ko$ID),]
david10.aup.ko<-as.matrix(t(david10.1.aup.ko))

david.ko.aup.ko<-as.data.frame(matrix(c(david1.aup.ko,david2.aup.ko,david3.aup.ko,david4.aup.ko,david5.aup.ko,david6.aup.ko,david7.aup.ko,david8.aup.ko,david9.aup.ko,david10.aup.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.aup.ko<-data.frame(ID=david.ko.aup.ko$V1,DS=david.ko.aup.ko$V2,normDS=david.ko.aup.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.aup.ko<-lm(e1.1.aup.ko$energy_over_time~as.numeric(david1.1.aup.ko$normDS))
ko.lm.1.s.aup.ko<-summary(lm.ko.1.aup.ko)$coefficients
ko.1.slope.aup.ko<-ko.lm.1.s.aup.ko[2,1]
lm.ko.2.aup.ko<-lm(e2.1.aup.ko$energy_over_time~as.numeric(david2.1.aup.ko$normDS))
ko.lm.2.s.aup.ko<-summary(lm.ko.2.aup.ko)$coefficients
ko.2.slope.aup.ko<-ko.lm.2.s.aup.ko[2,1]
lm.ko.3.aup.ko<-lm(e3.1.aup.ko$energy_over_time~as.numeric(david3.1.aup.ko$normDS))
ko.lm.3.s.aup.ko<-summary(lm.ko.3.aup.ko)$coefficients
ko.3.slope.aup.ko<-ko.lm.3.s.aup.ko[2,1]
lm.ko.4.aup.ko<-lm(e4.1.aup.ko$energy_over_time~as.numeric(david4.1.aup.ko$normDS))
ko.lm.4.s.aup.ko<-summary(lm.ko.4.aup.ko)$coefficients
ko.4.slope.aup.ko<-ko.lm.4.s.aup.ko[2,1]
lm.ko.5.aup.ko<-lm(e5.1.aup.ko$energy_over_time~as.numeric(david5.1.aup.ko$normDS))
ko.lm.5.s.aup.ko<-summary(lm.ko.5.aup.ko)$coefficients
ko.5.slope.aup.ko<-ko.lm.5.s.aup.ko[2,1]
lm.ko.6.aup.ko<-lm(e6.1.aup.ko$energy_over_time~as.numeric(david6.1.aup.ko$normDS))
ko.lm.6.s.aup.ko<-summary(lm.ko.6.aup.ko)$coefficients
ko.6.slope.aup.ko<-ko.lm.6.s.aup.ko[2,1]
lm.ko.7.aup.ko<-lm(e7.1.aup.ko$energy_over_time~as.numeric(david7.1.aup.ko$normDS))
ko.lm.7.s.aup.ko<-summary(lm.ko.7.aup.ko)$coefficients
ko.7.slope.aup.ko<-ko.lm.7.s.aup.ko[2,1]
lm.ko.8.aup.ko<-lm(e8.1.aup.ko$energy_over_time~as.numeric(david8.1.aup.ko$normDS))
ko.lm.8.s.aup.ko<-summary(lm.ko.8.aup.ko)$coefficients
ko.8.slope.aup.ko<-ko.lm.8.s.aup.ko[2,1]
lm.ko.9.aup.ko<-lm(e9.1.aup.ko$energy_over_time~as.numeric(david9.1.aup.ko$normDS))
ko.lm.9.s.aup.ko<-summary(lm.ko.9.aup.ko)$coefficients
ko.9.slope.aup.ko<-ko.lm.9.s.aup.ko[2,1]
lm.ko.10.aup.ko<-lm(e10.1.aup.ko$energy_over_time~as.numeric(david10.1.aup.ko$normDS))
ko.lm.10.s.aup.ko<-summary(lm.ko.10.aup.ko)$coefficients
ko.10.slope.aup.ko<-ko.lm.10.s.aup.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.aup.ss.avoid.up.ko<-data.frame(triangle.transitivity=c(tri1.aup.ko,tri2.aup.ko,tri3.aup.ko,tri4.aup.ko,tri5.aup.ko,tri6.aup.ko,tri7.aup.ko,tri8.aup.ko,tri9.aup.ko,tri10.aup.ko),escalation=c(ep1.aup.ko,ep2.aup.ko,ep3.aup.ko,ep4.aup.ko,ep5.aup.ko,ep6.aup.ko,ep7.aup.ko,ep8.aup.ko,ep9.aup.ko,ep10.aup.ko),dci=c(dci1.aup.ko,dci2.aup.ko,dci3.aup.ko,dci4.aup.ko,dci5.aup.ko,dci6.aup.ko,dci7.aup.ko,dci8.aup.ko,dci9.aup.ko,dci10.aup.ko),steepness=c(s1.aup.ko,s2.aup.ko,s3.aup.ko,s4.aup.ko,s5.aup.ko,s6.aup.ko,s7.aup.ko,s8.aup.ko,s9.aup.ko,s10.aup.ko),slope=c(ko.1.slope.aup.ko,ko.2.slope.aup.ko,ko.3.slope.aup.ko,ko.4.slope.aup.ko,ko.5.slope.aup.ko,ko.6.slope.aup.ko,ko.7.slope.aup.ko,ko.8.slope.aup.ko,ko.9.slope.aup.ko,ko.10.slope.aup.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.hm<-data.frame(X1=avoid.up.hm[[1]],X2=avoid.up.hm[[2]],Avoids=avoid.up.hm[[3]])
mat1.aup.hm<-avoid.inter.mat(mut1.aup.hm)
tri1.aup.hm<-tr.tri(mat1.aup.hm)
dci1.aup.hm<-DCindex(mat1.aup.hm)
mat1.aup.hm[is.na(mat1.aup.hm)] = 0
h1.aup.hm<-h.index(mat1.aup.hm)

ep1.aup.hm<-ep(mut1.aup.hm,a1.up.hm)
david1.aup.hm<-DS(mat1.aup.hm) #David's Scores - for steepness use normDS output
ordrank.1.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.hm<-cbind(ordrank.1.aup.hm,ds=david1.aup.hm$normDS)
lm1.aup.hm<-summary(lm(ordrank.1.aup.hm$ds~ordrank.1.aup.hm$ord.rank))
s1.aup.hm<-lm1.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.hm<-data.frame(X1=avoid.up.hm[[4]],X2=avoid.up.hm[[5]],Avoids=avoid.up.hm[[6]])
mat2.aup.hm<-avoid.inter.mat(mut2.aup.hm)
tri2.aup.hm<-tr.tri(mat2.aup.hm)
dci2.aup.hm<-DCindex(mat2.aup.hm)
mat2.aup.hm[is.na(mat2.aup.hm)] = 0
h2.aup.hm<-h.index(mat2.aup.hm)

ep2.aup.hm<-ep(mut2.aup.hm,a2.up.hm)
david2.aup.hm<-DS(mat2.aup.hm) #David's Scores - for steepness use normDS output
ordrank.2.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.hm<-cbind(ordrank.2.aup.hm,ds=david2.aup.hm$normDS)
lm2.aup.hm<-summary(lm(ordrank.2.aup.hm$ds~ordrank.2.aup.hm$ord.rank))
s2.aup.hm<-lm2.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.hm<-data.frame(X1=avoid.up.hm[[7]],X2=avoid.up.hm[[8]],Avoids=avoid.up.hm[[9]])
mat3.aup.hm<-avoid.inter.mat(mut3.aup.hm)
tri3.aup.hm<-tr.tri(mat3.aup.hm)
dci3.aup.hm<-DCindex(mat3.aup.hm)
mat3.aup.hm[is.na(mat3.aup.hm)] = 0
h3.aup.hm<-h.index(mat3.aup.hm)

ep3.aup.hm<-ep(mut3.aup.hm,a3.up.hm)
david3.aup.hm<-DS(mat3.aup.hm) #David's Scores - for steepness use normDS output
ordrank.3.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.hm<-cbind(ordrank.3.aup.hm,ds=david3.aup.hm$normDS)
lm3.aup.hm<-summary(lm(ordrank.3.aup.hm$ds~ordrank.3.aup.hm$ord.rank))
s3.aup.hm<-lm3.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.hm<-data.frame(X1=avoid.up.hm[[10]],X2=avoid.up.hm[[11]],Avoids=avoid.up.hm[[12]])
mat4.aup.hm<-avoid.inter.mat(mut4.aup.hm)
tri4.aup.hm<-tr.tri(mat4.aup.hm)
dci4.aup.hm<-DCindex(mat4.aup.hm)
mat4.aup.hm[is.na(mat4.aup.hm)] = 0
h4.aup.hm<-h.index(mat4.aup.hm)

ep4.aup.hm<-ep(mut4.aup.hm,a4.up.hm)
david4.aup.hm<-DS(mat4.aup.hm) #David's Scores - for steepness use normDS output
ordrank.4.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.hm<-cbind(ordrank.4.aup.hm,ds=david4.aup.hm$normDS)
lm4.aup.hm<-summary(lm(ordrank.4.aup.hm$ds~ordrank.4.aup.hm$ord.rank))
s4.aup.hm<-lm4.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.hm<-data.frame(X1=avoid.up.hm[[13]],X2=avoid.up.hm[[14]],Avoids=avoid.up.hm[[15]])
mat5.aup.hm<-avoid.inter.mat(mut5.aup.hm)
tri5.aup.hm<-tr.tri(mat5.aup.hm)
dci5.aup.hm<-DCindex(mat5.aup.hm)
mat5.aup.hm[is.na(mat5.aup.hm)] = 0
h5.aup.hm<-h.index(mat5.aup.hm)

ep5.aup.hm<-ep(mut5.aup.hm,a5.up.hm)
david5.aup.hm<-DS(mat5.aup.hm) #David's Scores - for steepness use normDS output
ordrank.5.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.hm<-cbind(ordrank.5.aup.hm,ds=david5.aup.hm$normDS)
lm5.aup.hm<-summary(lm(ordrank.5.aup.hm$ds~ordrank.5.aup.hm$ord.rank))
s5.aup.hm<-lm5.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.hm<-data.frame(X1=avoid.up.hm[[16]],X2=avoid.up.hm[[17]],Avoids=avoid.up.hm[[18]])
mat6.aup.hm<-avoid.inter.mat(mut6.aup.hm)
tri6.aup.hm<-tr.tri(mat6.aup.hm)
dci6.aup.hm<-DCindex(mat6.aup.hm)
mat6.aup.hm[is.na(mat6.aup.hm)] = 0
h6.aup.hm<-h.index(mat6.aup.hm)

ep6.aup.hm<-ep(mut6.aup.hm,a6.up.hm)
david6.aup.hm<-DS(mat6.aup.hm) #David's Scores - for steepness use normDS output
ordrank.6.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.hm<-cbind(ordrank.6.aup.hm,ds=david6.aup.hm$normDS)
lm6.aup.hm<-summary(lm(ordrank.6.aup.hm$ds~ordrank.6.aup.hm$ord.rank))
s6.aup.hm<-lm6.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.hm<-data.frame(X1=avoid.up.hm[[19]],X2=avoid.up.hm[[20]],Avoids=avoid.up.hm[[21]])
mat7.aup.hm<-avoid.inter.mat(mut7.aup.hm)
tri7.aup.hm<-tr.tri(mat7.aup.hm)
dci7.aup.hm<-DCindex(mat7.aup.hm)
mat7.aup.hm[is.na(mat7.aup.hm)] = 0
h7.aup.hm<-h.index(mat7.aup.hm)

ep7.aup.hm<-ep(mut7.aup.hm,a7.up.hm)
david7.aup.hm<-DS(mat7.aup.hm) #David's Scores - for steepness use normDS output
ordrank.7.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.hm<-cbind(ordrank.7.aup.hm,ds=david7.aup.hm$normDS)
lm7.aup.hm<-summary(lm(ordrank.7.aup.hm$ds~ordrank.7.aup.hm$ord.rank))
s7.aup.hm<-lm7.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.hm<-data.frame(X1=avoid.up.hm[[22]],X2=avoid.up.hm[[23]],Avoids=avoid.up.hm[[24]])
mat8.aup.hm<-avoid.inter.mat(mut8.aup.hm)
tri8.aup.hm<-tr.tri(mat8.aup.hm)
dci8.aup.hm<-DCindex(mat8.aup.hm)
mat8.aup.hm[is.na(mat8.aup.hm)] = 0
h8.aup.hm<-h.index(mat8.aup.hm)

ep8.aup.hm<-ep(mut8.aup.hm,a8.up.hm)
david8.aup.hm<-DS(mat8.aup.hm) #David's Scores - for steepness use normDS output
ordrank.8.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.hm<-cbind(ordrank.8.aup.hm,ds=david8.aup.hm$normDS)
lm8.aup.hm<-summary(lm(ordrank.8.aup.hm$ds~ordrank.8.aup.hm$ord.rank))
s8.aup.hm<-lm8.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.hm<-data.frame(X1=avoid.up.hm[[25]],X2=avoid.up.hm[[26]],Avoids=avoid.up.hm[[27]])
mat9.aup.hm<-avoid.inter.mat(mut9.aup.hm)
tri9.aup.hm<-tr.tri(mat9.aup.hm)
dci9.aup.hm<-DCindex(mat9.aup.hm)
mat9.aup.hm[is.na(mat9.aup.hm)] = 0
h9.aup.hm<-h.index(mat9.aup.hm)

ep9.aup.hm<-ep(mut9.aup.hm,a9.up.hm)
david9.aup.hm<-DS(mat9.aup.hm) #David's Scores - for steepness use normDS output
ordrank.9.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.hm<-cbind(ordrank.9.aup.hm,ds=david9.aup.hm$normDS)
lm9.aup.hm<-summary(lm(ordrank.9.aup.hm$ds~ordrank.9.aup.hm$ord.rank))
s9.aup.hm<-lm9.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.hm<-data.frame(X1=avoid.up.hm[[28]],X2=avoid.up.hm[[29]],Avoids=avoid.up.hm[[30]])
mat10.aup.hm<-avoid.inter.mat(mut10.aup.hm)
tri10.aup.hm<-tr.tri(mat10.aup.hm)
dci10.aup.hm<-DCindex(mat10.aup.hm)
mat10.aup.hm[is.na(mat10.aup.hm)] = 0
h10.aup.hm<-h.index(mat10.aup.hm)

ep10.aup.hm<-ep(mut10.aup.hm,a10.up.hm)
david10.aup.hm<-DS(mat10.aup.hm) #David's Scores - for steepness use normDS output
ordrank.10.aup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.hm<-cbind(ordrank.10.aup.hm,ds=david10.aup.hm$normDS)
lm10.aup.hm<-summary(lm(ordrank.10.aup.hm$ds~ordrank.10.aup.hm$ord.rank))
s10.aup.hm<-lm10.aup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.hm<-sum(mut1.aup.hm$Victories)
int2.aup.hm<-sum(mut2.aup.hm$Victories)
int3.aup.hm<-sum(mut3.aup.hm$Victories)
int4.aup.hm<-sum(mut4.aup.hm$Victories)
int5.aup.hm<-sum(mut5.aup.hm$Victories)
int6.aup.hm<-sum(mut6.aup.hm$Victories)
int7.aup.hm<-sum(mut7.aup.hm$Victories)
int8.aup.hm<-sum(mut8.aup.hm$Victories)
int9.aup.hm<-sum(mut9.aup.hm$Victories)
int10.aup.hm<-sum(mut10.aup.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.hm<-sum(a1.up.hm$Victories)
av2.aup.hm<-sum(a2.up.hm$Victories)
av3.aup.hm<-sum(a3.up.hm$Victories)
av4.aup.hm<-sum(a4.up.hm$Victories)
av5.aup.hm<-sum(a5.up.hm$Victories)
av6.aup.hm<-sum(a6.up.hm$Victories)
av7.aup.hm<-sum(a7.up.hm$Victories)
av8.aup.hm<-sum(a8.up.hm$Victories)
av9.aup.hm<-sum(a9.up.hm$Victories)
av10.aup.hm<-sum(a10.up.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.adu<-(sum(av1.aup.hm, av2.aup.hm, av3.aup.hm, av4.aup.hm, av5.aup.hm, av6.aup.hm, av7.aup.hm, av8.aup.hm, av9.aup.hm, av10.aup.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.adu<-(sum(int1.aup.hm, int2.aup.hm, int3.aup.hm, int4.aup.hm, int5.aup.hm, int6.aup.hm, int7.aup.hm, int8.aup.hm, int9.aup.hm, int10.aup.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.hm<-e1.aup.hm[order(e1.aup.hm$ID),]
e1.aup.hm<-as.matrix(t(e1.1.aup.hm))

e2.aup.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.hm<-e2.aup.hm[order(e2.aup.hm$ID),]
e2.aup.hm<-as.matrix(t(e2.1.aup.hm))

e3.aup.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.hm<-e3.aup.hm[order(e3.aup.hm$ID),]
e3.aup.hm<-as.matrix(t(e3.1.aup.hm))

e4.aup.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.hm<-e4.aup.hm[order(e4.aup.hm$ID),]
e4.aup.hm<-as.matrix(t(e4.1.aup.hm))

e5.aup.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.hm<-e5.aup.hm[order(e5.aup.hm$ID),]
e5.aup.hm<-as.matrix(t(e5.1.aup.hm))

e6.aup.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.hm<-e6.aup.hm[order(e6.aup.hm$ID),]
e6.aup.hm<-as.matrix(t(e6.1.aup.hm))

e7.aup.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.hm<-e7.aup.hm[order(e7.aup.hm$ID),]
e7.aup.hm<-as.matrix(t(e7.1.aup.hm))

e8.aup.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.hm<-e8.aup.hm[order(e8.aup.hm$ID),]
e8.aup.hm<-as.matrix(t(e8.1.aup.hm))

e9.aup.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.hm<-e9.aup.hm[order(e9.aup.hm$ID),]
e9.aup.hm<-as.matrix(t(e9.1.aup.hm))

e10.aup.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.hm<-e10.aup.hm[order(e10.aup.hm$ID),]
e10.aup.hm<-as.matrix(t(e10.1.aup.hm))

energy.hm.aup.hm<-as.data.frame(matrix(c(e1.aup.hm,e2.aup.hm,e3.aup.hm,e4.aup.hm,e5.aup.hm,e6.aup.hm,e7.aup.hm,e8.aup.hm,e9.aup.hm,e10.aup.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aup.hm<-data.frame(ID=energy.hm.aup.hm$V1,energy_over_distance=energy.hm.aup.hm$V2,energy_over_time=energy.hm.aup.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.hm<-david1.aup.hm[order(david1.aup.hm$ID),]
david1.aup.hm<-as.matrix(t(david1.1.aup.hm))

david2.1.aup.hm<-david2.aup.hm[order(david2.aup.hm$ID),]
david2.aup.hm<-as.matrix(t(david2.1.aup.hm))

david3.1.aup.hm<-david3.aup.hm[order(david3.aup.hm$ID),]
david3.aup.hm<-as.matrix(t(david3.1.aup.hm))

david4.1.aup.hm<-david4.aup.hm[order(david4.aup.hm$ID),]
david4.aup.hm<-as.matrix(t(david4.1.aup.hm))

david5.1.aup.hm<-david5.aup.hm[order(david5.aup.hm$ID),]
david5.aup.hm<-as.matrix(t(david5.1.aup.hm))

david6.1.aup.hm<-david6.aup.hm[order(david6.aup.hm$ID),]
david6.aup.hm<-as.matrix(t(david6.1.aup.hm))

david7.1.aup.hm<-david7.aup.hm[order(david7.aup.hm$ID),]
david7.aup.hm<-as.matrix(t(david7.1.aup.hm))

david8.1.aup.hm<-david8.aup.hm[order(david8.aup.hm$ID),]
david8.aup.hm<-as.matrix(t(david8.1.aup.hm))

david9.1.aup.hm<-david9.aup.hm[order(david9.aup.hm$ID),]
david9.aup.hm<-as.matrix(t(david9.1.aup.hm))

david10.1.aup.hm<-david10.aup.hm[order(david10.aup.hm$ID),]
david10.aup.hm<-as.matrix(t(david10.1.aup.hm))

david.hm.aup.hm<-as.data.frame(matrix(c(david1.aup.hm,david2.aup.hm,david3.aup.hm,david4.aup.hm,david5.aup.hm,david6.aup.hm,david7.aup.hm,david8.aup.hm,david9.aup.hm,david10.aup.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aup.hm<-data.frame(ID=david.hm.aup.hm$V1,DS=david.hm.aup.hm$V2,normDS=david.hm.aup.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aup.hm<-lm(e1.1.aup.hm$energy_over_time~as.numeric(david1.1.aup.hm$normDS))
hm.lm.1.s.aup.hm<-summary(lm.hm.1.aup.hm)$coefficients
hm.1.slope.aup.hm<-hm.lm.1.s.aup.hm[2,1]
lm.hm.2.aup.hm<-lm(e2.1.aup.hm$energy_over_time~as.numeric(david2.1.aup.hm$normDS))
hm.lm.2.s.aup.hm<-summary(lm.hm.2.aup.hm)$coefficients
hm.2.slope.aup.hm<-hm.lm.2.s.aup.hm[2,1]
lm.hm.3.aup.hm<-lm(e3.1.aup.hm$energy_over_time~as.numeric(david3.1.aup.hm$normDS))
hm.lm.3.s.aup.hm<-summary(lm.hm.3.aup.hm)$coefficients
hm.3.slope.aup.hm<-hm.lm.3.s.aup.hm[2,1]
lm.hm.4.aup.hm<-lm(e4.1.aup.hm$energy_over_time~as.numeric(david4.1.aup.hm$normDS))
hm.lm.4.s.aup.hm<-summary(lm.hm.4.aup.hm)$coefficients
hm.4.slope.aup.hm<-hm.lm.4.s.aup.hm[2,1]
lm.hm.5.aup.hm<-lm(e5.1.aup.hm$energy_over_time~as.numeric(david5.1.aup.hm$normDS))
hm.lm.5.s.aup.hm<-summary(lm.hm.5.aup.hm)$coefficients
hm.5.slope.aup.hm<-hm.lm.5.s.aup.hm[2,1]
lm.hm.6.aup.hm<-lm(e6.1.aup.hm$energy_over_time~as.numeric(david6.1.aup.hm$normDS))
hm.lm.6.s.aup.hm<-summary(lm.hm.6.aup.hm)$coefficients
hm.6.slope.aup.hm<-hm.lm.6.s.aup.hm[2,1]
lm.hm.7.aup.hm<-lm(e7.1.aup.hm$energy_over_time~as.numeric(david7.1.aup.hm$normDS))
hm.lm.7.s.aup.hm<-summary(lm.hm.7.aup.hm)$coefficients
hm.7.slope.aup.hm<-hm.lm.7.s.aup.hm[2,1]
lm.hm.8.aup.hm<-lm(e8.1.aup.hm$energy_over_time~as.numeric(david8.1.aup.hm$normDS))
hm.lm.8.s.aup.hm<-summary(lm.hm.8.aup.hm)$coefficients
hm.8.slope.aup.hm<-hm.lm.8.s.aup.hm[2,1]
lm.hm.9.aup.hm<-lm(e9.1.aup.hm$energy_over_time~as.numeric(david9.1.aup.hm$normDS))
hm.lm.9.s.aup.hm<-summary(lm.hm.9.aup.hm)$coefficients
hm.9.slope.aup.hm<-hm.lm.9.s.aup.hm[2,1]
lm.hm.10.aup.hm<-lm(e10.1.aup.hm$energy_over_time~as.numeric(david10.1.aup.hm$normDS))
hm.lm.10.s.aup.hm<-summary(lm.hm.10.aup.hm)$coefficients
hm.10.slope.aup.hm<-hm.lm.10.s.aup.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aup.ss.avoid.up.hm<-data.frame(triangle.transitivity=c(tri1.aup.hm,tri2.aup.hm,tri3.aup.hm,tri4.aup.hm,tri5.aup.hm,tri6.aup.hm,tri7.aup.hm,tri8.aup.hm,tri9.aup.hm,tri10.aup.hm),escalation=c(ep1.aup.hm,ep2.aup.hm,ep3.aup.hm,ep4.aup.hm,ep5.aup.hm,ep6.aup.hm,ep7.aup.hm,ep8.aup.hm,ep9.aup.hm,ep10.aup.hm),dci=c(dci1.aup.hm,dci2.aup.hm,dci3.aup.hm,dci4.aup.hm,dci5.aup.hm,dci6.aup.hm,dci7.aup.hm,dci8.aup.hm,dci9.aup.hm,dci10.aup.hm),steepness=c(s1.aup.hm,s2.aup.hm,s3.aup.hm,s4.aup.hm,s5.aup.hm,s6.aup.hm,s7.aup.hm,s8.aup.hm,s9.aup.hm,s10.aup.hm),slope=c(hm.1.slope.aup.hm,hm.2.slope.aup.hm,hm.3.slope.aup.hm,hm.4.slope.aup.hm,hm.5.slope.aup.hm,hm.6.slope.aup.hm,hm.7.slope.aup.hm,hm.8.slope.aup.hm,hm.9.slope.aup.hm,hm.10.slope.aup.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.hs<-data.frame(X1=avoid.up.hs[[1]],X2=avoid.up.hs[[2]],Avoids=avoid.up.hs[[3]])
mat1.aup.hs<-avoid.inter.mat(mut1.aup.hs)
tri1.aup.hs<-tr.tri(mat1.aup.hs)
dci1.aup.hs<-DCindex(mat1.aup.hs)
mat1.aup.hs[is.na(mat1.aup.hs)] = 0
h1.aup.hs<-h.index(mat1.aup.hs)

ep1.aup.hs<-ep(mut1.aup.hs,a1.up.hs)
david1.aup.hs<-DS(mat1.aup.hs) #David's Scores - for steepness use normDS output
ordrank.1.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.hs<-cbind(ordrank.1.aup.hs,ds=david1.aup.hs$normDS)
lm1.aup.hs<-summary(lm(ordrank.1.aup.hs$ds~ordrank.1.aup.hs$ord.rank))
s1.aup.hs<-lm1.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.hs<-data.frame(X1=avoid.up.hs[[4]],X2=avoid.up.hs[[5]],Avoids=avoid.up.hs[[6]])
mat2.aup.hs<-avoid.inter.mat(mut2.aup.hs)
tri2.aup.hs<-tr.tri(mat2.aup.hs)
dci2.aup.hs<-DCindex(mat2.aup.hs)
mat2.aup.hs[is.na(mat2.aup.hs)] = 0
h2.aup.hs<-h.index(mat2.aup.hs)

ep2.aup.hs<-ep(mut2.aup.hs,a2.up.hs)
david2.aup.hs<-DS(mat2.aup.hs) #David's Scores - for steepness use normDS output
ordrank.2.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.hs<-cbind(ordrank.2.aup.hs,ds=david2.aup.hs$normDS)
lm2.aup.hs<-summary(lm(ordrank.2.aup.hs$ds~ordrank.2.aup.hs$ord.rank))
s2.aup.hs<-lm2.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.hs<-data.frame(X1=avoid.up.hs[[7]],X2=avoid.up.hs[[8]],Avoids=avoid.up.hs[[9]])
mat3.aup.hs<-avoid.inter.mat(mut3.aup.hs)
tri3.aup.hs<-tr.tri(mat3.aup.hs)
dci3.aup.hs<-DCindex(mat3.aup.hs)
mat3.aup.hs[is.na(mat3.aup.hs)] = 0
h3.aup.hs<-h.index(mat3.aup.hs)

ep3.aup.hs<-ep(mut3.aup.hs,a3.up.hs)
david3.aup.hs<-DS(mat3.aup.hs) #David's Scores - for steepness use normDS output
ordrank.3.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.hs<-cbind(ordrank.3.aup.hs,ds=david3.aup.hs$normDS)
lm3.aup.hs<-summary(lm(ordrank.3.aup.hs$ds~ordrank.3.aup.hs$ord.rank))
s3.aup.hs<-lm3.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.hs<-data.frame(X1=avoid.up.hs[[10]],X2=avoid.up.hs[[11]],Avoids=avoid.up.hs[[12]])
mat4.aup.hs<-avoid.inter.mat(mut4.aup.hs)
tri4.aup.hs<-tr.tri(mat4.aup.hs)
dci4.aup.hs<-DCindex(mat4.aup.hs)
mat4.aup.hs[is.na(mat4.aup.hs)] = 0
h4.aup.hs<-h.index(mat4.aup.hs)

ep4.aup.hs<-ep(mut4.aup.hs,a4.up.hs)
david4.aup.hs<-DS(mat4.aup.hs) #David's Scores - for steepness use normDS output
ordrank.4.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.hs<-cbind(ordrank.4.aup.hs,ds=david4.aup.hs$normDS)
lm4.aup.hs<-summary(lm(ordrank.4.aup.hs$ds~ordrank.4.aup.hs$ord.rank))
s4.aup.hs<-lm4.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.hs<-data.frame(X1=avoid.up.hs[[13]],X2=avoid.up.hs[[14]],Avoids=avoid.up.hs[[15]])
mat5.aup.hs<-avoid.inter.mat(mut5.aup.hs)
tri5.aup.hs<-tr.tri(mat5.aup.hs)
dci5.aup.hs<-DCindex(mat5.aup.hs)
mat5.aup.hs[is.na(mat5.aup.hs)] = 0
h5.aup.hs<-h.index(mat5.aup.hs)

ep5.aup.hs<-ep(mut5.aup.hs,a5.up.hs)
david5.aup.hs<-DS(mat5.aup.hs) #David's Scores - for steepness use normDS output
ordrank.5.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.hs<-cbind(ordrank.5.aup.hs,ds=david5.aup.hs$normDS)
lm5.aup.hs<-summary(lm(ordrank.5.aup.hs$ds~ordrank.5.aup.hs$ord.rank))
s5.aup.hs<-lm5.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.hs<-data.frame(X1=avoid.up.hs[[16]],X2=avoid.up.hs[[17]],Avoids=avoid.up.hs[[18]])
mat6.aup.hs<-avoid.inter.mat(mut6.aup.hs)
tri6.aup.hs<-tr.tri(mat6.aup.hs)
dci6.aup.hs<-DCindex(mat6.aup.hs)
mat6.aup.hs[is.na(mat6.aup.hs)] = 0
h6.aup.hs<-h.index(mat6.aup.hs)

ep6.aup.hs<-ep(mut6.aup.hs,a6.up.hs)
david6.aup.hs<-DS(mat6.aup.hs) #David's Scores - for steepness use normDS output
ordrank.6.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.hs<-cbind(ordrank.6.aup.hs,ds=david6.aup.hs$normDS)
lm6.aup.hs<-summary(lm(ordrank.6.aup.hs$ds~ordrank.6.aup.hs$ord.rank))
s6.aup.hs<-lm6.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.hs<-data.frame(X1=avoid.up.hs[[19]],X2=avoid.up.hs[[20]],Avoids=avoid.up.hs[[21]])
mat7.aup.hs<-avoid.inter.mat(mut7.aup.hs)
tri7.aup.hs<-tr.tri(mat7.aup.hs)
dci7.aup.hs<-DCindex(mat7.aup.hs)
mat7.aup.hs[is.na(mat7.aup.hs)] = 0
h7.aup.hs<-h.index(mat7.aup.hs)

ep7.aup.hs<-ep(mut7.aup.hs,a7.up.hs)
david7.aup.hs<-DS(mat7.aup.hs) #David's Scores - for steepness use normDS output
ordrank.7.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.hs<-cbind(ordrank.7.aup.hs,ds=david7.aup.hs$normDS)
lm7.aup.hs<-summary(lm(ordrank.7.aup.hs$ds~ordrank.7.aup.hs$ord.rank))
s7.aup.hs<-lm7.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.hs<-data.frame(X1=avoid.up.hs[[22]],X2=avoid.up.hs[[23]],Avoids=avoid.up.hs[[24]])
mat8.aup.hs<-avoid.inter.mat(mut8.aup.hs)
tri8.aup.hs<-tr.tri(mat8.aup.hs)
dci8.aup.hs<-DCindex(mat8.aup.hs)
mat8.aup.hs[is.na(mat8.aup.hs)] = 0
h8.aup.hs<-h.index(mat8.aup.hs)

ep8.aup.hs<-ep(mut8.aup.hs,a8.up.hs)
david8.aup.hs<-DS(mat8.aup.hs) #David's Scores - for steepness use normDS output
ordrank.8.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.hs<-cbind(ordrank.8.aup.hs,ds=david8.aup.hs$normDS)
lm8.aup.hs<-summary(lm(ordrank.8.aup.hs$ds~ordrank.8.aup.hs$ord.rank))
s8.aup.hs<-lm8.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.hs<-data.frame(X1=avoid.up.hs[[25]],X2=avoid.up.hs[[26]],Avoids=avoid.up.hs[[27]])
mat9.aup.hs<-avoid.inter.mat(mut9.aup.hs)
tri9.aup.hs<-tr.tri(mat9.aup.hs)
dci9.aup.hs<-DCindex(mat9.aup.hs)
mat9.aup.hs[is.na(mat9.aup.hs)] = 0
h9.aup.hs<-h.index(mat9.aup.hs)

ep9.aup.hs<-ep(mut9.aup.hs,a9.up.hs)
david9.aup.hs<-DS(mat9.aup.hs) #David's Scores - for steepness use normDS output
ordrank.9.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.hs<-cbind(ordrank.9.aup.hs,ds=david9.aup.hs$normDS)
lm9.aup.hs<-summary(lm(ordrank.9.aup.hs$ds~ordrank.9.aup.hs$ord.rank))
s9.aup.hs<-lm9.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.hs<-data.frame(X1=avoid.up.hs[[28]],X2=avoid.up.hs[[29]],Avoids=avoid.up.hs[[30]])
mat10.aup.hs<-avoid.inter.mat(mut10.aup.hs)
tri10.aup.hs<-tr.tri(mat10.aup.hs)
dci10.aup.hs<-DCindex(mat10.aup.hs)
mat10.aup.hs[is.na(mat10.aup.hs)] = 0
h10.aup.hs<-h.index(mat10.aup.hs)

ep10.aup.hs<-ep(mut10.aup.hs,a10.up.hs)
david10.aup.hs<-DS(mat10.aup.hs) #David's Scores - for steepness use normDS output
ordrank.10.aup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.hs<-cbind(ordrank.10.aup.hs,ds=david10.aup.hs$normDS)
lm10.aup.hs<-summary(lm(ordrank.10.aup.hs$ds~ordrank.10.aup.hs$ord.rank))
s10.aup.hs<-lm10.aup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.hs<-sum(mut1.aup.hs$Victories)
int2.aup.hs<-sum(mut2.aup.hs$Victories)
int3.aup.hs<-sum(mut3.aup.hs$Victories)
int4.aup.hs<-sum(mut4.aup.hs$Victories)
int5.aup.hs<-sum(mut5.aup.hs$Victories)
int6.aup.hs<-sum(mut6.aup.hs$Victories)
int7.aup.hs<-sum(mut7.aup.hs$Victories)
int8.aup.hs<-sum(mut8.aup.hs$Victories)
int9.aup.hs<-sum(mut9.aup.hs$Victories)
int10.aup.hs<-sum(mut10.aup.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.hs<-sum(a1.up.hs$Victories)
av2.aup.hs<-sum(a2.up.hs$Victories)
av3.aup.hs<-sum(a3.up.hs$Victories)
av4.aup.hs<-sum(a4.up.hs$Victories)
av5.aup.hs<-sum(a5.up.hs$Victories)
av6.aup.hs<-sum(a6.up.hs$Victories)
av7.aup.hs<-sum(a7.up.hs$Victories)
av8.aup.hs<-sum(a8.up.hs$Victories)
av9.aup.hs<-sum(a9.up.hs$Victories)
av10.aup.hs<-sum(a10.up.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.adu<-(sum(av1.aup.hs, av2.aup.hs, av3.aup.hs, av4.aup.hs, av5.aup.hs, av6.aup.hs, av7.aup.hs, av8.aup.hs, av9.aup.hs, av10.aup.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.adu<-(sum(int1.aup.hs, int2.aup.hs, int3.aup.hs, int4.aup.hs, int5.aup.hs, int6.aup.hs, int7.aup.hs, int8.aup.hs, int9.aup.hs, int10.aup.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.hs<-e1.aup.hs[order(e1.aup.hs$ID),]
e1.aup.hs<-as.matrix(t(e1.1.aup.hs))

e2.aup.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.hs<-e2.aup.hs[order(e2.aup.hs$ID),]
e2.aup.hs<-as.matrix(t(e2.1.aup.hs))

e3.aup.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.hs<-e3.aup.hs[order(e3.aup.hs$ID),]
e3.aup.hs<-as.matrix(t(e3.1.aup.hs))

e4.aup.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.hs<-e4.aup.hs[order(e4.aup.hs$ID),]
e4.aup.hs<-as.matrix(t(e4.1.aup.hs))

e5.aup.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.hs<-e5.aup.hs[order(e5.aup.hs$ID),]
e5.aup.hs<-as.matrix(t(e5.1.aup.hs))

e6.aup.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.hs<-e6.aup.hs[order(e6.aup.hs$ID),]
e6.aup.hs<-as.matrix(t(e6.1.aup.hs))

e7.aup.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.hs<-e7.aup.hs[order(e7.aup.hs$ID),]
e7.aup.hs<-as.matrix(t(e7.1.aup.hs))

e8.aup.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.hs<-e8.aup.hs[order(e8.aup.hs$ID),]
e8.aup.hs<-as.matrix(t(e8.1.aup.hs))

e9.aup.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.hs<-e9.aup.hs[order(e9.aup.hs$ID),]
e9.aup.hs<-as.matrix(t(e9.1.aup.hs))

e10.aup.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.hs<-e10.aup.hs[order(e10.aup.hs$ID),]
e10.aup.hs<-as.matrix(t(e10.1.aup.hs))

energy.hs.aup.hs<-as.data.frame(matrix(c(e1.aup.hs,e2.aup.hs,e3.aup.hs,e4.aup.hs,e5.aup.hs,e6.aup.hs,e7.aup.hs,e8.aup.hs,e9.aup.hs,e10.aup.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.aup.hs<-data.frame(ID=energy.hs.aup.hs$V1,energy_over_distance=energy.hs.aup.hs$V2,energy_over_time=energy.hs.aup.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.hs<-david1.aup.hs[order(david1.aup.hs$ID),]
david1.aup.hs<-as.matrix(t(david1.1.aup.hs))

david2.1.aup.hs<-david2.aup.hs[order(david2.aup.hs$ID),]
david2.aup.hs<-as.matrix(t(david2.1.aup.hs))

david3.1.aup.hs<-david3.aup.hs[order(david3.aup.hs$ID),]
david3.aup.hs<-as.matrix(t(david3.1.aup.hs))

david4.1.aup.hs<-david4.aup.hs[order(david4.aup.hs$ID),]
david4.aup.hs<-as.matrix(t(david4.1.aup.hs))

david5.1.aup.hs<-david5.aup.hs[order(david5.aup.hs$ID),]
david5.aup.hs<-as.matrix(t(david5.1.aup.hs))

david6.1.aup.hs<-david6.aup.hs[order(david6.aup.hs$ID),]
david6.aup.hs<-as.matrix(t(david6.1.aup.hs))

david7.1.aup.hs<-david7.aup.hs[order(david7.aup.hs$ID),]
david7.aup.hs<-as.matrix(t(david7.1.aup.hs))

david8.1.aup.hs<-david8.aup.hs[order(david8.aup.hs$ID),]
david8.aup.hs<-as.matrix(t(david8.1.aup.hs))

david9.1.aup.hs<-david9.aup.hs[order(david9.aup.hs$ID),]
david9.aup.hs<-as.matrix(t(david9.1.aup.hs))

david10.1.aup.hs<-david10.aup.hs[order(david10.aup.hs$ID),]
david10.aup.hs<-as.matrix(t(david10.1.aup.hs))

david.hs.aup.hs<-as.data.frame(matrix(c(david1.aup.hs,david2.aup.hs,david3.aup.hs,david4.aup.hs,david5.aup.hs,david6.aup.hs,david7.aup.hs,david8.aup.hs,david9.aup.hs,david10.aup.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.aup.hs<-data.frame(ID=david.hs.aup.hs$V1,DS=david.hs.aup.hs$V2,normDS=david.hs.aup.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.aup.hs<-lm(e1.1.aup.hs$energy_over_time~as.numeric(david1.1.aup.hs$normDS))
hs.lm.1.s.aup.hs<-summary(lm.hs.1.aup.hs)$coefficients
hs.1.slope.aup.hs<-hs.lm.1.s.aup.hs[2,1]
lm.hs.2.aup.hs<-lm(e2.1.aup.hs$energy_over_time~as.numeric(david2.1.aup.hs$normDS))
hs.lm.2.s.aup.hs<-summary(lm.hs.2.aup.hs)$coefficients
hs.2.slope.aup.hs<-hs.lm.2.s.aup.hs[2,1]
lm.hs.3.aup.hs<-lm(e3.1.aup.hs$energy_over_time~as.numeric(david3.1.aup.hs$normDS))
hs.lm.3.s.aup.hs<-summary(lm.hs.3.aup.hs)$coefficients
hs.3.slope.aup.hs<-hs.lm.3.s.aup.hs[2,1]
lm.hs.4.aup.hs<-lm(e4.1.aup.hs$energy_over_time~as.numeric(david4.1.aup.hs$normDS))
hs.lm.4.s.aup.hs<-summary(lm.hs.4.aup.hs)$coefficients
hs.4.slope.aup.hs<-hs.lm.4.s.aup.hs[2,1]
lm.hs.5.aup.hs<-lm(e5.1.aup.hs$energy_over_time~as.numeric(david5.1.aup.hs$normDS))
hs.lm.5.s.aup.hs<-summary(lm.hs.5.aup.hs)$coefficients
hs.5.slope.aup.hs<-hs.lm.5.s.aup.hs[2,1]
lm.hs.6.aup.hs<-lm(e6.1.aup.hs$energy_over_time~as.numeric(david6.1.aup.hs$normDS))
hs.lm.6.s.aup.hs<-summary(lm.hs.6.aup.hs)$coefficients
hs.6.slope.aup.hs<-hs.lm.6.s.aup.hs[2,1]
lm.hs.7.aup.hs<-lm(e7.1.aup.hs$energy_over_time~as.numeric(david7.1.aup.hs$normDS))
hs.lm.7.s.aup.hs<-summary(lm.hs.7.aup.hs)$coefficients
hs.7.slope.aup.hs<-hs.lm.7.s.aup.hs[2,1]
lm.hs.8.aup.hs<-lm(e8.1.aup.hs$energy_over_time~as.numeric(david8.1.aup.hs$normDS))
hs.lm.8.s.aup.hs<-summary(lm.hs.8.aup.hs)$coefficients
hs.8.slope.aup.hs<-hs.lm.8.s.aup.hs[2,1]
lm.hs.9.aup.hs<-lm(e9.1.aup.hs$energy_over_time~as.numeric(david9.1.aup.hs$normDS))
hs.lm.9.s.aup.hs<-summary(lm.hs.9.aup.hs)$coefficients
hs.9.slope.aup.hs<-hs.lm.9.s.aup.hs[2,1]
lm.hs.10.aup.hs<-lm(e10.1.aup.hs$energy_over_time~as.numeric(david10.1.aup.hs$normDS))
hs.lm.10.s.aup.hs<-summary(lm.hs.10.aup.hs)$coefficients
hs.10.slope.aup.hs<-hs.lm.10.s.aup.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.aup.ss.avoid.up.hs<-data.frame(triangle.transitivity=c(tri1.aup.hs,tri2.aup.hs,tri3.aup.hs,tri4.aup.hs,tri5.aup.hs,tri6.aup.hs,tri7.aup.hs,tri8.aup.hs,tri9.aup.hs,tri10.aup.hs),escalation=c(ep1.aup.hs,ep2.aup.hs,ep3.aup.hs,ep4.aup.hs,ep5.aup.hs,ep6.aup.hs,ep7.aup.hs,ep8.aup.hs,ep9.aup.hs,ep10.aup.hs),dci=c(dci1.aup.hs,dci2.aup.hs,dci3.aup.hs,dci4.aup.hs,dci5.aup.hs,dci6.aup.hs,dci7.aup.hs,dci8.aup.hs,dci9.aup.hs,dci10.aup.hs),steepness=c(s1.aup.hs,s2.aup.hs,s3.aup.hs,s4.aup.hs,s5.aup.hs,s6.aup.hs,s7.aup.hs,s8.aup.hs,s9.aup.hs,s10.aup.hs),slope=c(hs.1.slope.aup.hs,hs.2.slope.aup.hs,hs.3.slope.aup.hs,hs.4.slope.aup.hs,hs.5.slope.aup.hs,hs.6.slope.aup.hs,hs.7.slope.aup.hs,hs.8.slope.aup.hs,hs.9.slope.aup.hs,hs.10.slope.aup.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.up.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aup.ho<-data.frame(X1=avoid.up.ho[[1]],X2=avoid.up.ho[[2]],Avoids=avoid.up.ho[[3]])
mat1.aup.ho<-avoid.inter.mat(mut1.aup.ho)
tri1.aup.ho<-tr.tri(mat1.aup.ho)
dci1.aup.ho<-DCindex(mat1.aup.ho)
mat1.aup.ho[is.na(mat1.aup.ho)] = 0
h1.aup.ho<-h.index(mat1.aup.ho)

ep1.aup.ho<-ep(mut1.aup.ho,a1.up.ho)
david1.aup.ho<-DS(mat1.aup.ho) #David's Scores - for steepness use normDS output
ordrank.1.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aup.ho<-cbind(ordrank.1.aup.ho,ds=david1.aup.ho$normDS)
lm1.aup.ho<-summary(lm(ordrank.1.aup.ho$ds~ordrank.1.aup.ho$ord.rank))
s1.aup.ho<-lm1.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aup.ho<-data.frame(X1=avoid.up.ho[[4]],X2=avoid.up.ho[[5]],Avoids=avoid.up.ho[[6]])
mat2.aup.ho<-avoid.inter.mat(mut2.aup.ho)
tri2.aup.ho<-tr.tri(mat2.aup.ho)
dci2.aup.ho<-DCindex(mat2.aup.ho)
mat2.aup.ho[is.na(mat2.aup.ho)] = 0
h2.aup.ho<-h.index(mat2.aup.ho)

ep2.aup.ho<-ep(mut2.aup.ho,a2.up.ho)
david2.aup.ho<-DS(mat2.aup.ho) #David's Scores - for steepness use normDS output
ordrank.2.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aup.ho<-cbind(ordrank.2.aup.ho,ds=david2.aup.ho$normDS)
lm2.aup.ho<-summary(lm(ordrank.2.aup.ho$ds~ordrank.2.aup.ho$ord.rank))
s2.aup.ho<-lm2.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aup.ho<-data.frame(X1=avoid.up.ho[[7]],X2=avoid.up.ho[[8]],Avoids=avoid.up.ho[[9]])
mat3.aup.ho<-avoid.inter.mat(mut3.aup.ho)
tri3.aup.ho<-tr.tri(mat3.aup.ho)
dci3.aup.ho<-DCindex(mat3.aup.ho)
mat3.aup.ho[is.na(mat3.aup.ho)] = 0
h3.aup.ho<-h.index(mat3.aup.ho)

ep3.aup.ho<-ep(mut3.aup.ho,a3.up.ho)
david3.aup.ho<-DS(mat3.aup.ho) #David's Scores - for steepness use normDS output
ordrank.3.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aup.ho<-cbind(ordrank.3.aup.ho,ds=david3.aup.ho$normDS)
lm3.aup.ho<-summary(lm(ordrank.3.aup.ho$ds~ordrank.3.aup.ho$ord.rank))
s3.aup.ho<-lm3.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aup.ho<-data.frame(X1=avoid.up.ho[[10]],X2=avoid.up.ho[[11]],Avoids=avoid.up.ho[[12]])
mat4.aup.ho<-avoid.inter.mat(mut4.aup.ho)
tri4.aup.ho<-tr.tri(mat4.aup.ho)
dci4.aup.ho<-DCindex(mat4.aup.ho)
mat4.aup.ho[is.na(mat4.aup.ho)] = 0
h4.aup.ho<-h.index(mat4.aup.ho)

ep4.aup.ho<-ep(mut4.aup.ho,a4.up.ho)
david4.aup.ho<-DS(mat4.aup.ho) #David's Scores - for steepness use normDS output
ordrank.4.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aup.ho<-cbind(ordrank.4.aup.ho,ds=david4.aup.ho$normDS)
lm4.aup.ho<-summary(lm(ordrank.4.aup.ho$ds~ordrank.4.aup.ho$ord.rank))
s4.aup.ho<-lm4.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aup.ho<-data.frame(X1=avoid.up.ho[[13]],X2=avoid.up.ho[[14]],Avoids=avoid.up.ho[[15]])
mat5.aup.ho<-avoid.inter.mat(mut5.aup.ho)
tri5.aup.ho<-tr.tri(mat5.aup.ho)
dci5.aup.ho<-DCindex(mat5.aup.ho)
mat5.aup.ho[is.na(mat5.aup.ho)] = 0
h5.aup.ho<-h.index(mat5.aup.ho)

ep5.aup.ho<-ep(mut5.aup.ho,a5.up.ho)
david5.aup.ho<-DS(mat5.aup.ho) #David's Scores - for steepness use normDS output
ordrank.5.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aup.ho<-cbind(ordrank.5.aup.ho,ds=david5.aup.ho$normDS)
lm5.aup.ho<-summary(lm(ordrank.5.aup.ho$ds~ordrank.5.aup.ho$ord.rank))
s5.aup.ho<-lm5.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aup.ho<-data.frame(X1=avoid.up.ho[[16]],X2=avoid.up.ho[[17]],Avoids=avoid.up.ho[[18]])
mat6.aup.ho<-avoid.inter.mat(mut6.aup.ho)
tri6.aup.ho<-tr.tri(mat6.aup.ho)
dci6.aup.ho<-DCindex(mat6.aup.ho)
mat6.aup.ho[is.na(mat6.aup.ho)] = 0
h6.aup.ho<-h.index(mat6.aup.ho)

ep6.aup.ho<-ep(mut6.aup.ho,a6.up.ho)
david6.aup.ho<-DS(mat6.aup.ho) #David's Scores - for steepness use normDS output
ordrank.6.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aup.ho<-cbind(ordrank.6.aup.ho,ds=david6.aup.ho$normDS)
lm6.aup.ho<-summary(lm(ordrank.6.aup.ho$ds~ordrank.6.aup.ho$ord.rank))
s6.aup.ho<-lm6.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aup.ho<-data.frame(X1=avoid.up.ho[[19]],X2=avoid.up.ho[[20]],Avoids=avoid.up.ho[[21]])
mat7.aup.ho<-avoid.inter.mat(mut7.aup.ho)
tri7.aup.ho<-tr.tri(mat7.aup.ho)
dci7.aup.ho<-DCindex(mat7.aup.ho)
mat7.aup.ho[is.na(mat7.aup.ho)] = 0
h7.aup.ho<-h.index(mat7.aup.ho)

ep7.aup.ho<-ep(mut7.aup.ho,a7.up.ho)
david7.aup.ho<-DS(mat7.aup.ho) #David's Scores - for steepness use normDS output
ordrank.7.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aup.ho<-cbind(ordrank.7.aup.ho,ds=david7.aup.ho$normDS)
lm7.aup.ho<-summary(lm(ordrank.7.aup.ho$ds~ordrank.7.aup.ho$ord.rank))
s7.aup.ho<-lm7.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aup.ho<-data.frame(X1=avoid.up.ho[[22]],X2=avoid.up.ho[[23]],Avoids=avoid.up.ho[[24]])
mat8.aup.ho<-avoid.inter.mat(mut8.aup.ho)
tri8.aup.ho<-tr.tri(mat8.aup.ho)
dci8.aup.ho<-DCindex(mat8.aup.ho)
mat8.aup.ho[is.na(mat8.aup.ho)] = 0
h8.aup.ho<-h.index(mat8.aup.ho)

ep8.aup.ho<-ep(mut8.aup.ho,a8.up.ho)
david8.aup.ho<-DS(mat8.aup.ho) #David's Scores - for steepness use normDS output
ordrank.8.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aup.ho<-cbind(ordrank.8.aup.ho,ds=david8.aup.ho$normDS)
lm8.aup.ho<-summary(lm(ordrank.8.aup.ho$ds~ordrank.8.aup.ho$ord.rank))
s8.aup.ho<-lm8.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aup.ho<-data.frame(X1=avoid.up.ho[[25]],X2=avoid.up.ho[[26]],Avoids=avoid.up.ho[[27]])
mat9.aup.ho<-avoid.inter.mat(mut9.aup.ho)
tri9.aup.ho<-tr.tri(mat9.aup.ho)
dci9.aup.ho<-DCindex(mat9.aup.ho)
mat9.aup.ho[is.na(mat9.aup.ho)] = 0
h9.aup.ho<-h.index(mat9.aup.ho)

ep9.aup.ho<-ep(mut9.aup.ho,a9.up.ho)
david9.aup.ho<-DS(mat9.aup.ho) #David's Scores - for steepness use normDS output
ordrank.9.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aup.ho<-cbind(ordrank.9.aup.ho,ds=david9.aup.ho$normDS)
lm9.aup.ho<-summary(lm(ordrank.9.aup.ho$ds~ordrank.9.aup.ho$ord.rank))
s9.aup.ho<-lm9.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aup.ho<-data.frame(X1=avoid.up.ho[[28]],X2=avoid.up.ho[[29]],Avoids=avoid.up.ho[[30]])
mat10.aup.ho<-avoid.inter.mat(mut10.aup.ho)
tri10.aup.ho<-tr.tri(mat10.aup.ho)
dci10.aup.ho<-DCindex(mat10.aup.ho)
mat10.aup.ho[is.na(mat10.aup.ho)] = 0
h10.aup.ho<-h.index(mat10.aup.ho)

ep10.aup.ho<-ep(mut10.aup.ho,a10.up.ho)
david10.aup.ho<-DS(mat10.aup.ho) #David's Scores - for steepness use normDS output
ordrank.10.aup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aup.ho<-cbind(ordrank.10.aup.ho,ds=david10.aup.ho$normDS)
lm10.aup.ho<-summary(lm(ordrank.10.aup.ho$ds~ordrank.10.aup.ho$ord.rank))
s10.aup.ho<-lm10.aup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aup.ho<-sum(mut1.aup.ho$Victories)
int2.aup.ho<-sum(mut2.aup.ho$Victories)
int3.aup.ho<-sum(mut3.aup.ho$Victories)
int4.aup.ho<-sum(mut4.aup.ho$Victories)
int5.aup.ho<-sum(mut5.aup.ho$Victories)
int6.aup.ho<-sum(mut6.aup.ho$Victories)
int7.aup.ho<-sum(mut7.aup.ho$Victories)
int8.aup.ho<-sum(mut8.aup.ho$Victories)
int9.aup.ho<-sum(mut9.aup.ho$Victories)
int10.aup.ho<-sum(mut10.aup.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aup.ho<-sum(a1.up.ho$Victories)
av2.aup.ho<-sum(a2.up.ho$Victories)
av3.aup.ho<-sum(a3.up.ho$Victories)
av4.aup.ho<-sum(a4.up.ho$Victories)
av5.aup.ho<-sum(a5.up.ho$Victories)
av6.aup.ho<-sum(a6.up.ho$Victories)
av7.aup.ho<-sum(a7.up.ho$Victories)
av8.aup.ho<-sum(a8.up.ho$Victories)
av9.aup.ho<-sum(a9.up.ho$Victories)
av10.aup.ho<-sum(a10.up.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.adu<-(sum(av1.aup.ho, av2.aup.ho, av3.aup.ho, av4.aup.ho, av5.aup.ho, av6.aup.ho, av7.aup.ho, av8.aup.ho, av9.aup.ho, av10.aup.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.adu<-(sum(int1.aup.ho, int2.aup.ho, int3.aup.ho, int4.aup.ho, int5.aup.ho, int6.aup.ho, int7.aup.ho, int8.aup.ho, int9.aup.ho, int10.aup.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aup.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aup.ho<-e1.aup.ho[order(e1.aup.ho$ID),]
e1.aup.ho<-as.matrix(t(e1.1.aup.ho))

e2.aup.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aup.ho<-e2.aup.ho[order(e2.aup.ho$ID),]
e2.aup.ho<-as.matrix(t(e2.1.aup.ho))

e3.aup.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aup.ho<-e3.aup.ho[order(e3.aup.ho$ID),]
e3.aup.ho<-as.matrix(t(e3.1.aup.ho))

e4.aup.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aup.ho<-e4.aup.ho[order(e4.aup.ho$ID),]
e4.aup.ho<-as.matrix(t(e4.1.aup.ho))

e5.aup.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aup.ho<-e5.aup.ho[order(e5.aup.ho$ID),]
e5.aup.ho<-as.matrix(t(e5.1.aup.ho))

e6.aup.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aup.ho<-e6.aup.ho[order(e6.aup.ho$ID),]
e6.aup.ho<-as.matrix(t(e6.1.aup.ho))

e7.aup.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aup.ho<-e7.aup.ho[order(e7.aup.ho$ID),]
e7.aup.ho<-as.matrix(t(e7.1.aup.ho))

e8.aup.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aup.ho<-e8.aup.ho[order(e8.aup.ho$ID),]
e8.aup.ho<-as.matrix(t(e8.1.aup.ho))

e9.aup.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aup.ho<-e9.aup.ho[order(e9.aup.ho$ID),]
e9.aup.ho<-as.matrix(t(e9.1.aup.ho))

e10.aup.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aup.ho<-e10.aup.ho[order(e10.aup.ho$ID),]
e10.aup.ho<-as.matrix(t(e10.1.aup.ho))

energy.ho.aup.ho<-as.data.frame(matrix(c(e1.aup.ho,e2.aup.ho,e3.aup.ho,e4.aup.ho,e5.aup.ho,e6.aup.ho,e7.aup.ho,e8.aup.ho,e9.aup.ho,e10.aup.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.aup.ho<-data.frame(ID=energy.ho.aup.ho$V1,energy_over_distance=energy.ho.aup.ho$V2,energy_over_time=energy.ho.aup.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aup.ho<-david1.aup.ho[order(david1.aup.ho$ID),]
david1.aup.ho<-as.matrix(t(david1.1.aup.ho))

david2.1.aup.ho<-david2.aup.ho[order(david2.aup.ho$ID),]
david2.aup.ho<-as.matrix(t(david2.1.aup.ho))

david3.1.aup.ho<-david3.aup.ho[order(david3.aup.ho$ID),]
david3.aup.ho<-as.matrix(t(david3.1.aup.ho))

david4.1.aup.ho<-david4.aup.ho[order(david4.aup.ho$ID),]
david4.aup.ho<-as.matrix(t(david4.1.aup.ho))

david5.1.aup.ho<-david5.aup.ho[order(david5.aup.ho$ID),]
david5.aup.ho<-as.matrix(t(david5.1.aup.ho))

david6.1.aup.ho<-david6.aup.ho[order(david6.aup.ho$ID),]
david6.aup.ho<-as.matrix(t(david6.1.aup.ho))

david7.1.aup.ho<-david7.aup.ho[order(david7.aup.ho$ID),]
david7.aup.ho<-as.matrix(t(david7.1.aup.ho))

david8.1.aup.ho<-david8.aup.ho[order(david8.aup.ho$ID),]
david8.aup.ho<-as.matrix(t(david8.1.aup.ho))

david9.1.aup.ho<-david9.aup.ho[order(david9.aup.ho$ID),]
david9.aup.ho<-as.matrix(t(david9.1.aup.ho))

david10.1.aup.ho<-david10.aup.ho[order(david10.aup.ho$ID),]
david10.aup.ho<-as.matrix(t(david10.1.aup.ho))

david.ho.aup.ho<-as.data.frame(matrix(c(david1.aup.ho,david2.aup.ho,david3.aup.ho,david4.aup.ho,david5.aup.ho,david6.aup.ho,david7.aup.ho,david8.aup.ho,david9.aup.ho,david10.aup.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.aup.ho<-data.frame(ID=david.ho.aup.ho$V1,DS=david.ho.aup.ho$V2,normDS=david.ho.aup.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.aup.ho<-lm(e1.1.aup.ho$energy_over_time~as.numeric(david1.1.aup.ho$normDS))
ho.lm.1.s.aup.ho<-summary(lm.ho.1.aup.ho)$coefficients
ho.1.slope.aup.ho<-ho.lm.1.s.aup.ho[2,1]
lm.ho.2.aup.ho<-lm(e2.1.aup.ho$energy_over_time~as.numeric(david2.1.aup.ho$normDS))
ho.lm.2.s.aup.ho<-summary(lm.ho.2.aup.ho)$coefficients
ho.2.slope.aup.ho<-ho.lm.2.s.aup.ho[2,1]
lm.ho.3.aup.ho<-lm(e3.1.aup.ho$energy_over_time~as.numeric(david3.1.aup.ho$normDS))
ho.lm.3.s.aup.ho<-summary(lm.ho.3.aup.ho)$coefficients
ho.3.slope.aup.ho<-ho.lm.3.s.aup.ho[2,1]
lm.ho.4.aup.ho<-lm(e4.1.aup.ho$energy_over_time~as.numeric(david4.1.aup.ho$normDS))
ho.lm.4.s.aup.ho<-summary(lm.ho.4.aup.ho)$coefficients
ho.4.slope.aup.ho<-ho.lm.4.s.aup.ho[2,1]
lm.ho.5.aup.ho<-lm(e5.1.aup.ho$energy_over_time~as.numeric(david5.1.aup.ho$normDS))
ho.lm.5.s.aup.ho<-summary(lm.ho.5.aup.ho)$coefficients
ho.5.slope.aup.ho<-ho.lm.5.s.aup.ho[2,1]
lm.ho.6.aup.ho<-lm(e6.1.aup.ho$energy_over_time~as.numeric(david6.1.aup.ho$normDS))
ho.lm.6.s.aup.ho<-summary(lm.ho.6.aup.ho)$coefficients
ho.6.slope.aup.ho<-ho.lm.6.s.aup.ho[2,1]
lm.ho.7.aup.ho<-lm(e7.1.aup.ho$energy_over_time~as.numeric(david7.1.aup.ho$normDS))
ho.lm.7.s.aup.ho<-summary(lm.ho.7.aup.ho)$coefficients
ho.7.slope.aup.ho<-ho.lm.7.s.aup.ho[2,1]
lm.ho.8.aup.ho<-lm(e8.1.aup.ho$energy_over_time~as.numeric(david8.1.aup.ho$normDS))
ho.lm.8.s.aup.ho<-summary(lm.ho.8.aup.ho)$coefficients
ho.8.slope.aup.ho<-ho.lm.8.s.aup.ho[2,1]
lm.ho.9.aup.ho<-lm(e9.1.aup.ho$energy_over_time~as.numeric(david9.1.aup.ho$normDS))
ho.lm.9.s.aup.ho<-summary(lm.ho.9.aup.ho)$coefficients
ho.9.slope.aup.ho<-ho.lm.9.s.aup.ho[2,1]
lm.ho.10.aup.ho<-lm(e10.1.aup.ho$energy_over_time~as.numeric(david10.1.aup.ho$normDS))
ho.lm.10.s.aup.ho<-summary(lm.ho.10.aup.ho)$coefficients
ho.10.slope.aup.ho<-ho.lm.10.s.aup.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.aup.ss.avoid.up.ho<-data.frame(triangle.transitivity=c(tri1.aup.ho,tri2.aup.ho,tri3.aup.ho,tri4.aup.ho,tri5.aup.ho,tri6.aup.ho,tri7.aup.ho,tri8.aup.ho,tri9.aup.ho,tri10.aup.ho),escalation=c(ep1.aup.ho,ep2.aup.ho,ep3.aup.ho,ep4.aup.ho,ep5.aup.ho,ep6.aup.ho,ep7.aup.ho,ep8.aup.ho,ep9.aup.ho,ep10.aup.ho),dci=c(dci1.aup.ho,dci2.aup.ho,dci3.aup.ho,dci4.aup.ho,dci5.aup.ho,dci6.aup.ho,dci7.aup.ho,dci8.aup.ho,dci9.aup.ho,dci10.aup.ho),steepness=c(s1.aup.ho,s2.aup.ho,s3.aup.ho,s4.aup.ho,s5.aup.ho,s6.aup.ho,s7.aup.ho,s8.aup.ho,s9.aup.ho,s10.aup.ho),slope=c(ho.1.slope.aup.ho,ho.2.slope.aup.ho,ho.3.slope.aup.ho,ho.4.slope.aup.ho,ho.5.slope.aup.ho,ho.6.slope.aup.ho,ho.7.slope.aup.ho,ho.8.slope.aup.ho,ho.9.slope.aup.ho,ho.10.slope.aup.ho))
```
```{r Avoids Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.adu.avoid<-mean(km.aup.ss.avoid.up.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aup.ss.avoid.up.km$dci)
km.esc.adu.avoid<-mean(km.aup.ss.avoid.up.km$escalation)
km.steep.adu.avoid<-mean(km.aup.ss.avoid.up.km$steepness)
km.slope.adu.avoid<-mean(km.aup.ss.avoid.up.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$triangle.transitivity)
ks.adui.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$dci)
ks.esc.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$escalation)
ks.steep.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$steepness)
ks.slope.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$slope)
ks.mean.adu.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.adu.avoid,dci=ks.adui.adu.avoid,esc=ks.esc.adu.avoid,steepness=ks.steep.adu.avoid,slope=ks.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$triangle.transitivity)
ko.adui.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$dci)
ko.esc.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$escalation)
ko.steep.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$steepness)
ko.slope.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$slope)
ko.mean.adu.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.adu.avoid,dci=ko.adui.adu.avoid,esc=ko.esc.adu.avoid,steepness=ko.steep.adu.avoid,slope=ko.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$dci)
hm.esc.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$triangle.transitivity)
hs.adui.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$dci)
hs.esc.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$escalation)
hs.steep.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$steepness)
hs.slope.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$slope)
hs.mean.adu.avoid<-data.frame(scenario="History self",tt=hs.tt.adu.avoid,dci=hs.adui.adu.avoid,esc=hs.esc.adu.avoid,steepness=hs.steep.adu.avoid,slope=hs.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$triangle.transitivity)
ho.adui.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$dci)
ho.esc.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$escalation)
ho.steep.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$steepness)
ho.slope.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$slope)
ho.mean.adu.avoid<-data.frame(scenario="History opponent",tt=ho.tt.adu.avoid,dci=ho.adui.adu.avoid,esc=ho.esc.adu.avoid,steepness=ho.steep.adu.avoid,slope=ho.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,ks.mean.adu.avoid,ko.mean.adu.avoid,hm.mean.adu.avoid,hs.mean.adu.avoid,ho.mean.adu.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.adu.avoid<-mean(km.aup.ss.avoid.up.km$triangle.transitivity)
km.adui.adu.avoid<-mean(km.aup.ss.avoid.up.km$dci)
km.esc.adu.avoid<-mean(km.aup.ss.avoid.up.km$escalation)
km.steep.adu.avoid<-mean(km.aup.ss.avoid.up.km$steepness)
km.slope.adu.avoid<-mean(km.aup.ss.avoid.up.km$slope)
km.mean.adu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.adu.avoid,dci=km.adui.adu.avoid,esc=km.esc.adu.avoid,steepness=km.steep.adu.avoid,slope=km.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$triangle.transitivity)
ks.adui.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$dci)
ks.esc.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$escalation)
ks.steep.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$steepness)
ks.slope.adu.avoid<-mean(ks.aup.ss.avoid.up.ks$slope)
ks.mean.adu.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.adu.avoid,dci=ks.adui.adu.avoid,esc=ks.esc.adu.avoid,steepness=ks.steep.adu.avoid,slope=ks.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$triangle.transitivity)
ko.adui.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$dci)
ko.esc.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$escalation)
ko.steep.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$steepness)
ko.slope.adu.avoid<-mean(ko.aup.ss.avoid.up.ko$slope)
ko.mean.adu.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.adu.avoid,dci=ko.adui.adu.avoid,esc=ko.esc.adu.avoid,steepness=ko.steep.adu.avoid,slope=ko.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$triangle.transitivity)
hm.adui.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$dci)
hm.esc.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$escalation)
hm.steep.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$steepness)
hm.slope.adu.avoid<-mean(hm.aup.ss.avoid.up.hm$slope)
hm.mean.adu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.adu.avoid,dci=hm.adui.adu.avoid,esc=hm.esc.adu.avoid,steepness=hm.steep.adu.avoid,slope=hm.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$triangle.transitivity)
hs.adui.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$dci)
hs.esc.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$escalation)
hs.steep.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$steepness)
hs.slope.adu.avoid<-mean(hs.aup.ss.avoid.up.hs$slope)
hs.mean.adu.avoid<-data.frame(scenario="History self",tt=hs.tt.adu.avoid,dci=hs.adui.adu.avoid,esc=hs.esc.adu.avoid,steepness=hs.steep.adu.avoid,slope=hs.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$triangle.transitivity)
ho.adui.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$dci)
ho.esc.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$escalation)
ho.steep.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$steepness)
ho.slope.adu.avoid<-mean(ho.aup.ss.avoid.up.ho$slope)
ho.mean.adu.avoid<-data.frame(scenario="History opponent",tt=ho.tt.adu.avoid,dci=ho.adui.adu.avoid,esc=ho.esc.adu.avoid,steepness=ho.steep.adu.avoid,slope=ho.slope.adu.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.adu.avoid,ks.mean.adu.avoid,ko.mean.adu.avoid,hm.mean.adu.avoid,hs.mean.adu.avoid,ho.mean.adu.avoid)

#create overall dataframe of summary statistics
overall.prob.unif.avoid<-data.frame(km.aup.ss.avoid.up.km)
overall.prob.unif.avoid<-rbind(overall.prob.unif.avoid,ks.aup.ss.avoid.up.ks)
overall.prob.unif.avoid<-rbind(overall.prob.unif.avoid,ko.aup.ss.avoid.up.ko)
overall.prob.unif.avoid<-rbind(overall.prob.unif.avoid,hm.aup.ss.avoid.up.hm)
overall.prob.unif.avoid<-rbind(overall.prob.unif.avoid,hs.aup.ss.avoid.up.hs)
overall.prob.unif.avoid<-rbind(overall.prob.unif.avoid,ho.aup.ss.avoid.up.ho)

overall.prob.unif.avoid<-cbind(overall.prob.unif.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.prob.unif.avoid<-cbind(overall.prob.unif.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.ss.avoid<-overall.prob.unif.avoid[overall.prob.unif.avoid$variable=="rhp",]
history.ss.avoid<-overall.prob.unif.avoid[overall.prob.unif.avoid$variable=="history",]

overall.prob.unif.avoid$combo<-paste(overall.prob.unif.avoid$strategy,overall.prob.unif.avoid$variable,overall.prob.unif.avoid$distribution)
overall.prob.unif.avoid$combo2<-paste(overall.prob.unif.avoid$strategy,overall.prob.unif.avoid$variable)
```

## Attacks Uniform Probabilistic Data
```{r Attacks Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.km<-sapply(files, read.csv)

# Generate attacks.atup.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atup.km<-data.frame(X1=attacks.atup.km[[1]],X2=attacks.atup.km[[2]],Victories=attacks.atup.km[[3]])
mat1.atup.km<-inter.mat(mut1.atup.km)
tri1.atup.km<-tr.tri(mat1.atup.km)
dci1.atup.km<-DCindex(mat1.atup.km)
mat1.atup.km[is.na(mat1.atup.km)] = 0
h1.atup.km<-h.index(mat1.atup.km)

ep1.atup.km<-ep(mut1.atup.km,a1.up.km)
david1.atup.km<-DS(mat1.atup.km) #David's Scores - for steepness use normDS output
ordrank.1.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.km<-cbind(ordrank.1.atup.km,ds=david1.atup.km$normDS)
lm1.atup.km<-summary(lm(ordrank.1.atup.km$ds~ordrank.1.atup.km$ord.rank))
s1.atup.km<-lm1.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.km<-data.frame(X1=attacks.atup.km[[4]],X2=attacks.atup.km[[5]],Victories=attacks.atup.km[[6]])
mat2.atup.km<-inter.mat(mut2.atup.km)
tri2.atup.km<-tr.tri(mat2.atup.km)
dci2.atup.km<-DCindex(mat2.atup.km)
mat2.atup.km[is.na(mat2.atup.km)] = 0
h2.atup.km<-h.index(mat2.atup.km)

ep2.atup.km<-ep(mut2.atup.km,a2.up.km)
david2.atup.km<-DS(mat2.atup.km) #David's Scores - for steepness use normDS output
ordrank.2.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.km<-cbind(ordrank.2.atup.km,ds=david2.atup.km$normDS)
lm2.atup.km<-summary(lm(ordrank.2.atup.km$ds~ordrank.2.atup.km$ord.rank))
s2.atup.km<-lm2.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.km<-data.frame(X1=attacks.atup.km[[7]],X2=attacks.atup.km[[8]],Victories=attacks.atup.km[[9]])
mat3.atup.km<-inter.mat(mut3.atup.km)
tri3.atup.km<-tr.tri(mat3.atup.km)
dci3.atup.km<-DCindex(mat3.atup.km)
mat3.atup.km[is.na(mat3.atup.km)] = 0
h3.atup.km<-h.index(mat3.atup.km)

ep3.atup.km<-ep(mut3.atup.km,a3.up.km)
david3.atup.km<-DS(mat3.atup.km) #David's Scores - for steepness use normDS output
ordrank.3.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.km<-cbind(ordrank.3.atup.km,ds=david3.atup.km$normDS)
lm3.atup.km<-summary(lm(ordrank.3.atup.km$ds~ordrank.3.atup.km$ord.rank))
s3.atup.km<-lm3.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.km<-data.frame(X1=attacks.atup.km[[10]],X2=attacks.atup.km[[11]],Victories=attacks.atup.km[[12]])
mat4.atup.km<-inter.mat(mut4.atup.km)
tri4.atup.km<-tr.tri(mat4.atup.km)
dci4.atup.km<-DCindex(mat4.atup.km)
mat4.atup.km[is.na(mat4.atup.km)] = 0
h4.atup.km<-h.index(mat4.atup.km)

ep4.atup.km<-ep(mut4.atup.km,a4.up.km)
david4.atup.km<-DS(mat4.atup.km) #David's Scores - for steepness use normDS output
ordrank.4.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.km<-cbind(ordrank.4.atup.km,ds=david4.atup.km$normDS)
lm4.atup.km<-summary(lm(ordrank.4.atup.km$ds~ordrank.4.atup.km$ord.rank))
s4.atup.km<-lm4.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.km<-data.frame(X1=attacks.atup.km[[13]],X2=attacks.atup.km[[14]],Victories=attacks.atup.km[[15]])
mat5.atup.km<-inter.mat(mut5.atup.km)
tri5.atup.km<-tr.tri(mat5.atup.km)
dci5.atup.km<-DCindex(mat5.atup.km)
mat5.atup.km[is.na(mat5.atup.km)] = 0
h5.atup.km<-h.index(mat5.atup.km)

ep5.atup.km<-ep(mut5.atup.km,a5.up.km)
david5.atup.km<-DS(mat5.atup.km) #David's Scores - for steepness use normDS output
ordrank.5.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.km<-cbind(ordrank.5.atup.km,ds=david5.atup.km$normDS)
lm5.atup.km<-summary(lm(ordrank.5.atup.km$ds~ordrank.5.atup.km$ord.rank))
s5.atup.km<-lm5.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.km<-data.frame(X1=attacks.atup.km[[16]],X2=attacks.atup.km[[17]],Victories=attacks.atup.km[[18]])
mat6.atup.km<-inter.mat(mut6.atup.km)
tri6.atup.km<-tr.tri(mat6.atup.km)
dci6.atup.km<-DCindex(mat6.atup.km)
mat6.atup.km[is.na(mat6.atup.km)] = 0
h6.atup.km<-h.index(mat6.atup.km)

ep6.atup.km<-ep(mut6.atup.km,a6.up.km)
david6.atup.km<-DS(mat6.atup.km) #David's Scores - for steepness use normDS output
ordrank.6.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.km<-cbind(ordrank.6.atup.km,ds=david6.atup.km$normDS)
lm6.atup.km<-summary(lm(ordrank.6.atup.km$ds~ordrank.6.atup.km$ord.rank))
s6.atup.km<-lm6.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.km<-data.frame(X1=attacks.atup.km[[19]],X2=attacks.atup.km[[20]],Victories=attacks.atup.km[[21]])
mat7.atup.km<-inter.mat(mut7.atup.km)
tri7.atup.km<-tr.tri(mat7.atup.km)
dci7.atup.km<-DCindex(mat7.atup.km)
mat7.atup.km[is.na(mat7.atup.km)] = 0
h7.atup.km<-h.index(mat7.atup.km)

ep7.atup.km<-ep(mut7.atup.km,a7.up.km)
david7.atup.km<-DS(mat7.atup.km) #David's Scores - for steepness use normDS output
ordrank.7.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.km<-cbind(ordrank.7.atup.km,ds=david7.atup.km$normDS)
lm7.atup.km<-summary(lm(ordrank.7.atup.km$ds~ordrank.7.atup.km$ord.rank))
s7.atup.km<-lm7.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.km<-data.frame(X1=attacks.atup.km[[22]],X2=attacks.atup.km[[23]],Victories=attacks.atup.km[[24]])
mat8.atup.km<-inter.mat(mut8.atup.km)
tri8.atup.km<-tr.tri(mat8.atup.km)
dci8.atup.km<-DCindex(mat8.atup.km)
mat8.atup.km[is.na(mat8.atup.km)] = 0
h8.atup.km<-h.index(mat8.atup.km)

ep8.atup.km<-ep(mut8.atup.km,a8.up.km)
david8.atup.km<-DS(mat8.atup.km) #David's Scores - for steepness use normDS output
ordrank.8.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.km<-cbind(ordrank.8.atup.km,ds=david8.atup.km$normDS)
lm8.atup.km<-summary(lm(ordrank.8.atup.km$ds~ordrank.8.atup.km$ord.rank))
s8.atup.km<-lm8.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.km<-data.frame(X1=attacks.atup.km[[25]],X2=attacks.atup.km[[26]],Victories=attacks.atup.km[[27]])
mat9.atup.km<-inter.mat(mut9.atup.km)
tri9.atup.km<-tr.tri(mat9.atup.km)
dci9.atup.km<-DCindex(mat9.atup.km)
mat9.atup.km[is.na(mat9.atup.km)] = 0
h9.atup.km<-h.index(mat9.atup.km)

ep9.atup.km<-ep(mut9.atup.km,a9.up.km)
david9.atup.km<-DS(mat9.atup.km) #David's Scores - for steepness use normDS output
ordrank.9.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.km<-cbind(ordrank.9.atup.km,ds=david9.atup.km$normDS)
lm9.atup.km<-summary(lm(ordrank.9.atup.km$ds~ordrank.9.atup.km$ord.rank))
s9.atup.km<-lm9.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.km<-data.frame(X1=attacks.atup.km[[28]],X2=attacks.atup.km[[29]],Victories=attacks.atup.km[[30]])
mat10.atup.km<-inter.mat(mut10.atup.km)
tri10.atup.km<-tr.tri(mat10.atup.km)
dci10.atup.km<-DCindex(mat10.atup.km)
mat10.atup.km[is.na(mat10.atup.km)] = 0
h10.atup.km<-h.index(mat10.atup.km)

ep10.atup.km<-ep(mut10.atup.km,a10.up.km)
david10.atup.km<-DS(mat10.atup.km) #David's Scores - for steepness use normDS output
ordrank.10.atup.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.km<-cbind(ordrank.10.atup.km,ds=david10.atup.km$normDS)
lm10.atup.km<-summary(lm(ordrank.10.atup.km$ds~ordrank.10.atup.km$ord.rank))
s10.atup.km<-lm10.atup.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.km<-sum(mut1.atup.km$Victories)
int2.atup.km<-sum(mut2.atup.km$Victories)
int3.atup.km<-sum(mut3.atup.km$Victories)
int4.atup.km<-sum(mut4.atup.km$Victories)
int5.atup.km<-sum(mut5.atup.km$Victories)
int6.atup.km<-sum(mut6.atup.km$Victories)
int7.atup.km<-sum(mut7.atup.km$Victories)
int8.atup.km<-sum(mut8.atup.km$Victories)
int9.atup.km<-sum(mut9.atup.km$Victories)
int10.atup.km<-sum(mut10.atup.km$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.km<-sum(a1.up.km$Victories)
av2.atup.km<-sum(a2.up.km$Victories)
av3.atup.km<-sum(a3.up.km$Victories)
av4.atup.km<-sum(a4.up.km$Victories)
av5.atup.km<-sum(a5.up.km$Victories)
av6.atup.km<-sum(a6.up.km$Victories)
av7.atup.km<-sum(a7.up.km$Victories)
av8.atup.km<-sum(a8.up.km$Victories)
av9.atup.km<-sum(a9.up.km$Victories)
av10.atup.km<-sum(a10.up.km$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.km.atdu<-(sum(av1.atup.km, av2.atup.km, av3.atup.km, av4.atup.km, av5.atup.km, av6.atup.km, av7.atup.km, av8.atup.km, av9.atup.km, av10.atup.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.atdu<-(sum(int1.atup.km, int2.atup.km, int3.atup.km, int4.atup.km, int5.atup.km, int6.atup.km, int7.atup.km, int8.atup.km, int9.atup.km, int10.atup.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.km<-e1.atup.km[order(e1.atup.km$ID),]
e1.atup.km<-as.matrix(t(e1.1.atup.km))

e2.atup.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.km<-e2.atup.km[order(e2.atup.km$ID),]
e2.atup.km<-as.matrix(t(e2.1.atup.km))

e3.atup.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.km<-e3.atup.km[order(e3.atup.km$ID),]
e3.atup.km<-as.matrix(t(e3.1.atup.km))

e4.atup.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.km<-e4.atup.km[order(e4.atup.km$ID),]
e4.atup.km<-as.matrix(t(e4.1.atup.km))

e5.atup.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.km<-e5.atup.km[order(e5.atup.km$ID),]
e5.atup.km<-as.matrix(t(e5.1.atup.km))

e6.atup.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.km<-e6.atup.km[order(e6.atup.km$ID),]
e6.atup.km<-as.matrix(t(e6.1.atup.km))

e7.atup.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.km<-e7.atup.km[order(e7.atup.km$ID),]
e7.atup.km<-as.matrix(t(e7.1.atup.km))

e8.atup.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.km<-e8.atup.km[order(e8.atup.km$ID),]
e8.atup.km<-as.matrix(t(e8.1.atup.km))

e9.atup.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.km<-e9.atup.km[order(e9.atup.km$ID),]
e9.atup.km<-as.matrix(t(e9.1.atup.km))

e10.atup.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.km<-e10.atup.km[order(e10.atup.km$ID),]
e10.atup.km<-as.matrix(t(e10.1.atup.km))

energy.km.atup.km<-as.data.frame(matrix(c(e1.atup.km,e2.atup.km,e3.atup.km,e4.atup.km,e5.atup.km,e6.atup.km,e7.atup.km,e8.atup.km,e9.atup.km,e10.atup.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atup.km<-data.frame(ID=energy.km.atup.km$V1,energy_over_distance=energy.km.atup.km$V2,energy_over_time=energy.km.atup.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.km<-david1.atup.km[order(david1.atup.km$ID),]
david1.atup.km<-as.matrix(t(david1.1.atup.km))

david2.1.atup.km<-david2.atup.km[order(david2.atup.km$ID),]
david2.atup.km<-as.matrix(t(david2.1.atup.km))

david3.1.atup.km<-david3.atup.km[order(david3.atup.km$ID),]
david3.atup.km<-as.matrix(t(david3.1.atup.km))

david4.1.atup.km<-david4.atup.km[order(david4.atup.km$ID),]
david4.atup.km<-as.matrix(t(david4.1.atup.km))

david5.1.atup.km<-david5.atup.km[order(david5.atup.km$ID),]
david5.atup.km<-as.matrix(t(david5.1.atup.km))

david6.1.atup.km<-david6.atup.km[order(david6.atup.km$ID),]
david6.atup.km<-as.matrix(t(david6.1.atup.km))

david7.1.atup.km<-david7.atup.km[order(david7.atup.km$ID),]
david7.atup.km<-as.matrix(t(david7.1.atup.km))

david8.1.atup.km<-david8.atup.km[order(david8.atup.km$ID),]
david8.atup.km<-as.matrix(t(david8.1.atup.km))

david9.1.atup.km<-david9.atup.km[order(david9.atup.km$ID),]
david9.atup.km<-as.matrix(t(david9.1.atup.km))

david10.1.atup.km<-david10.atup.km[order(david10.atup.km$ID),]
david10.atup.km<-as.matrix(t(david10.1.atup.km))

david.km.atup.km<-as.data.frame(matrix(c(david1.atup.km,david2.atup.km,david3.atup.km,david4.atup.km,david5.atup.km,david6.atup.km,david7.atup.km,david8.atup.km,david9.atup.km,david10.atup.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atup.km<-data.frame(ID=david.km.atup.km$V1,DS=david.km.atup.km$V2,normDS=david.km.atup.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atup.km<-lm(e1.1.atup.km$energy_over_time~as.numeric(david1.1.atup.km$normDS))
km.lm.1.s.atup.km<-summary(lm.km.1.atup.km)$coefficients
km.1.slope.atup.km<-km.lm.1.s.atup.km[2,1]
lm.km.2.atup.km<-lm(e2.1.atup.km$energy_over_time~as.numeric(david2.1.atup.km$normDS))
km.lm.2.s.atup.km<-summary(lm.km.2.atup.km)$coefficients
km.2.slope.atup.km<-km.lm.2.s.atup.km[2,1]
lm.km.3.atup.km<-lm(e3.1.atup.km$energy_over_time~as.numeric(david3.1.atup.km$normDS))
km.lm.3.s.atup.km<-summary(lm.km.3.atup.km)$coefficients
km.3.slope.atup.km<-km.lm.3.s.atup.km[2,1]
lm.km.4.atup.km<-lm(e4.1.atup.km$energy_over_time~as.numeric(david4.1.atup.km$normDS))
km.lm.4.s.atup.km<-summary(lm.km.4.atup.km)$coefficients
km.4.slope.atup.km<-km.lm.4.s.atup.km[2,1]
lm.km.5.atup.km<-lm(e5.1.atup.km$energy_over_time~as.numeric(david5.1.atup.km$normDS))
km.lm.5.s.atup.km<-summary(lm.km.5.atup.km)$coefficients
km.5.slope.atup.km<-km.lm.5.s.atup.km[2,1]
lm.km.6.atup.km<-lm(e6.1.atup.km$energy_over_time~as.numeric(david6.1.atup.km$normDS))
km.lm.6.s.atup.km<-summary(lm.km.6.atup.km)$coefficients
km.6.slope.atup.km<-km.lm.6.s.atup.km[2,1]
lm.km.7.atup.km<-lm(e7.1.atup.km$energy_over_time~as.numeric(david7.1.atup.km$normDS))
km.lm.7.s.atup.km<-summary(lm.km.7.atup.km)$coefficients
km.7.slope.atup.km<-km.lm.7.s.atup.km[2,1]
lm.km.8.atup.km<-lm(e8.1.atup.km$energy_over_time~as.numeric(david8.1.atup.km$normDS))
km.lm.8.s.atup.km<-summary(lm.km.8.atup.km)$coefficients
km.8.slope.atup.km<-km.lm.8.s.atup.km[2,1]
lm.km.9.atup.km<-lm(e9.1.atup.km$energy_over_time~as.numeric(david9.1.atup.km$normDS))
km.lm.9.s.atup.km<-summary(lm.km.9.atup.km)$coefficients
km.9.slope.atup.km<-km.lm.9.s.atup.km[2,1]
lm.km.10.atup.km<-lm(e10.1.atup.km$energy_over_time~as.numeric(david10.1.atup.km$normDS))
km.lm.10.s.atup.km<-summary(lm.km.10.atup.km)$coefficients
km.10.slope.atup.km<-km.lm.10.s.atup.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atup.ss.attacks.atup.km<-data.frame(triangle.transitivity=c(tri1.atup.km,tri2.atup.km,tri3.atup.km,tri4.atup.km,tri5.atup.km,tri6.atup.km,tri7.atup.km,tri8.atup.km,tri9.atup.km,tri10.atup.km),escalation=c(ep1.atup.km,ep2.atup.km,ep3.atup.km,ep4.atup.km,ep5.atup.km,ep6.atup.km,ep7.atup.km,ep8.atup.km,ep9.atup.km,ep10.atup.km),dci=c(dci1.atup.km,dci2.atup.km,dci3.atup.km,dci4.atup.km,dci5.atup.km,dci6.atup.km,dci7.atup.km,dci8.atup.km,dci9.atup.km,dci10.atup.km),steepness=c(s1.atup.km,s2.atup.km,s3.atup.km,s4.atup.km,s5.atup.km,s6.atup.km,s7.atup.km,s8.atup.km,s9.atup.km,s10.atup.km),slope=c(km.1.slope.atup.km,km.2.slope.atup.km,km.3.slope.atup.km,km.4.slope.atup.km,km.5.slope.atup.km,km.6.slope.atup.km,km.7.slope.atup.km,km.8.slope.atup.km,km.9.slope.atup.km,km.10.slope.atup.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.ks<-sapply(files, read.csv)

# Generate attacks.atup.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.ks<-data.frame(X1=attacks.atup.ks[[1]],X2=attacks.atup.ks[[2]],Victories=attacks.atup.ks[[3]])
mat1.atup.ks<-inter.mat(mut1.atup.ks)
tri1.atup.ks<-tr.tri(mat1.atup.ks)
dci1.atup.ks<-DCindex(mat1.atup.ks)
mat1.atup.ks[is.na(mat1.atup.ks)] = 0
h1.atup.ks<-h.index(mat1.atup.ks)

ep1.atup.ks<-ep(mut1.atup.ks,a1.up.ks)
david1.atup.ks<-DS(mat1.atup.ks) #David's Scores - for steepness use normDS output
ordrank.1.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.ks<-cbind(ordrank.1.atup.ks,ds=david1.atup.ks$normDS)
lm1.atup.ks<-summary(lm(ordrank.1.atup.ks$ds~ordrank.1.atup.ks$ord.rank))
s1.atup.ks<-lm1.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.ks<-data.frame(X1=attacks.atup.ks[[4]],X2=attacks.atup.ks[[5]],Victories=attacks.atup.ks[[6]])
mat2.atup.ks<-inter.mat(mut2.atup.ks)
tri2.atup.ks<-tr.tri(mat2.atup.ks)
dci2.atup.ks<-DCindex(mat2.atup.ks)
mat2.atup.ks[is.na(mat2.atup.ks)] = 0
h2.atup.ks<-h.index(mat2.atup.ks)

ep2.atup.ks<-ep(mut2.atup.ks,a2.up.ks)
david2.atup.ks<-DS(mat2.atup.ks) #David's Scores - for steepness use normDS output
ordrank.2.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.ks<-cbind(ordrank.2.atup.ks,ds=david2.atup.ks$normDS)
lm2.atup.ks<-summary(lm(ordrank.2.atup.ks$ds~ordrank.2.atup.ks$ord.rank))
s2.atup.ks<-lm2.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.ks<-data.frame(X1=attacks.atup.ks[[7]],X2=attacks.atup.ks[[8]],Victories=attacks.atup.ks[[9]])
mat3.atup.ks<-inter.mat(mut3.atup.ks)
tri3.atup.ks<-tr.tri(mat3.atup.ks)
dci3.atup.ks<-DCindex(mat3.atup.ks)
mat3.atup.ks[is.na(mat3.atup.ks)] = 0
h3.atup.ks<-h.index(mat3.atup.ks)

ep3.atup.ks<-ep(mut3.atup.ks,a3.up.ks)
david3.atup.ks<-DS(mat3.atup.ks) #David's Scores - for steepness use normDS output
ordrank.3.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.ks<-cbind(ordrank.3.atup.ks,ds=david3.atup.ks$normDS)
lm3.atup.ks<-summary(lm(ordrank.3.atup.ks$ds~ordrank.3.atup.ks$ord.rank))
s3.atup.ks<-lm3.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.ks<-data.frame(X1=attacks.atup.ks[[10]],X2=attacks.atup.ks[[11]],Victories=attacks.atup.ks[[12]])
mat4.atup.ks<-inter.mat(mut4.atup.ks)
tri4.atup.ks<-tr.tri(mat4.atup.ks)
dci4.atup.ks<-DCindex(mat4.atup.ks)
mat4.atup.ks[is.na(mat4.atup.ks)] = 0
h4.atup.ks<-h.index(mat4.atup.ks)

ep4.atup.ks<-ep(mut4.atup.ks,a4.up.ks)
david4.atup.ks<-DS(mat4.atup.ks) #David's Scores - for steepness use normDS output
ordrank.4.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.ks<-cbind(ordrank.4.atup.ks,ds=david4.atup.ks$normDS)
lm4.atup.ks<-summary(lm(ordrank.4.atup.ks$ds~ordrank.4.atup.ks$ord.rank))
s4.atup.ks<-lm4.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.ks<-data.frame(X1=attacks.atup.ks[[13]],X2=attacks.atup.ks[[14]],Victories=attacks.atup.ks[[15]])
mat5.atup.ks<-inter.mat(mut5.atup.ks)
tri5.atup.ks<-tr.tri(mat5.atup.ks)
dci5.atup.ks<-DCindex(mat5.atup.ks)
mat5.atup.ks[is.na(mat5.atup.ks)] = 0
h5.atup.ks<-h.index(mat5.atup.ks)

ep5.atup.ks<-ep(mut5.atup.ks,a5.up.ks)
david5.atup.ks<-DS(mat5.atup.ks) #David's Scores - for steepness use normDS output
ordrank.5.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.ks<-cbind(ordrank.5.atup.ks,ds=david5.atup.ks$normDS)
lm5.atup.ks<-summary(lm(ordrank.5.atup.ks$ds~ordrank.5.atup.ks$ord.rank))
s5.atup.ks<-lm5.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.ks<-data.frame(X1=attacks.atup.ks[[16]],X2=attacks.atup.ks[[17]],Victories=attacks.atup.ks[[18]])
mat6.atup.ks<-inter.mat(mut6.atup.ks)
tri6.atup.ks<-tr.tri(mat6.atup.ks)
dci6.atup.ks<-DCindex(mat6.atup.ks)
mat6.atup.ks[is.na(mat6.atup.ks)] = 0
h6.atup.ks<-h.index(mat6.atup.ks)

ep6.atup.ks<-ep(mut6.atup.ks,a6.up.ks)
david6.atup.ks<-DS(mat6.atup.ks) #David's Scores - for steepness use normDS output
ordrank.6.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.ks<-cbind(ordrank.6.atup.ks,ds=david6.atup.ks$normDS)
lm6.atup.ks<-summary(lm(ordrank.6.atup.ks$ds~ordrank.6.atup.ks$ord.rank))
s6.atup.ks<-lm6.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.ks<-data.frame(X1=attacks.atup.ks[[19]],X2=attacks.atup.ks[[20]],Victories=attacks.atup.ks[[21]])
mat7.atup.ks<-inter.mat(mut7.atup.ks)
tri7.atup.ks<-tr.tri(mat7.atup.ks)
dci7.atup.ks<-DCindex(mat7.atup.ks)
mat7.atup.ks[is.na(mat7.atup.ks)] = 0
h7.atup.ks<-h.index(mat7.atup.ks)

ep7.atup.ks<-ep(mut7.atup.ks,a7.up.ks)
david7.atup.ks<-DS(mat7.atup.ks) #David's Scores - for steepness use normDS output
ordrank.7.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.ks<-cbind(ordrank.7.atup.ks,ds=david7.atup.ks$normDS)
lm7.atup.ks<-summary(lm(ordrank.7.atup.ks$ds~ordrank.7.atup.ks$ord.rank))
s7.atup.ks<-lm7.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.ks<-data.frame(X1=attacks.atup.ks[[22]],X2=attacks.atup.ks[[23]],Victories=attacks.atup.ks[[24]])
mat8.atup.ks<-inter.mat(mut8.atup.ks)
tri8.atup.ks<-tr.tri(mat8.atup.ks)
dci8.atup.ks<-DCindex(mat8.atup.ks)
mat8.atup.ks[is.na(mat8.atup.ks)] = 0
h8.atup.ks<-h.index(mat8.atup.ks)

ep8.atup.ks<-ep(mut8.atup.ks,a8.up.ks)
david8.atup.ks<-DS(mat8.atup.ks) #David's Scores - for steepness use normDS output
ordrank.8.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.ks<-cbind(ordrank.8.atup.ks,ds=david8.atup.ks$normDS)
lm8.atup.ks<-summary(lm(ordrank.8.atup.ks$ds~ordrank.8.atup.ks$ord.rank))
s8.atup.ks<-lm8.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.ks<-data.frame(X1=attacks.atup.ks[[25]],X2=attacks.atup.ks[[26]],Victories=attacks.atup.ks[[27]])
mat9.atup.ks<-inter.mat(mut9.atup.ks)
tri9.atup.ks<-tr.tri(mat9.atup.ks)
dci9.atup.ks<-DCindex(mat9.atup.ks)
mat9.atup.ks[is.na(mat9.atup.ks)] = 0
h9.atup.ks<-h.index(mat9.atup.ks)

ep9.atup.ks<-ep(mut9.atup.ks,a9.up.ks)
david9.atup.ks<-DS(mat9.atup.ks) #David's Scores - for steepness use normDS output
ordrank.9.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.ks<-cbind(ordrank.9.atup.ks,ds=david9.atup.ks$normDS)
lm9.atup.ks<-summary(lm(ordrank.9.atup.ks$ds~ordrank.9.atup.ks$ord.rank))
s9.atup.ks<-lm9.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.ks<-data.frame(X1=attacks.atup.ks[[28]],X2=attacks.atup.ks[[29]],Victories=attacks.atup.ks[[30]])
mat10.atup.ks<-inter.mat(mut10.atup.ks)
tri10.atup.ks<-tr.tri(mat10.atup.ks)
dci10.atup.ks<-DCindex(mat10.atup.ks)
mat10.atup.ks[is.na(mat10.atup.ks)] = 0
h10.atup.ks<-h.index(mat10.atup.ks)

ep10.atup.ks<-ep(mut10.atup.ks,a10.up.ks)
david10.atup.ks<-DS(mat10.atup.ks) #David's Scores - for steepness use normDS output
ordrank.10.atup.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.ks<-cbind(ordrank.10.atup.ks,ds=david10.atup.ks$normDS)
lm10.atup.ks<-summary(lm(ordrank.10.atup.ks$ds~ordrank.10.atup.ks$ord.rank))
s10.atup.ks<-lm10.atup.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.ks<-sum(mut1.atup.ks$Victories)
int2.atup.ks<-sum(mut2.atup.ks$Victories)
int3.atup.ks<-sum(mut3.atup.ks$Victories)
int4.atup.ks<-sum(mut4.atup.ks$Victories)
int5.atup.ks<-sum(mut5.atup.ks$Victories)
int6.atup.ks<-sum(mut6.atup.ks$Victories)
int7.atup.ks<-sum(mut7.atup.ks$Victories)
int8.atup.ks<-sum(mut8.atup.ks$Victories)
int9.atup.ks<-sum(mut9.atup.ks$Victories)
int10.atup.ks<-sum(mut10.atup.ks$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.ks<-sum(a1.up.ks$Victories)
av2.atup.ks<-sum(a2.up.ks$Victories)
av3.atup.ks<-sum(a3.up.ks$Victories)
av4.atup.ks<-sum(a4.up.ks$Victories)
av5.atup.ks<-sum(a5.up.ks$Victories)
av6.atup.ks<-sum(a6.up.ks$Victories)
av7.atup.ks<-sum(a7.up.ks$Victories)
av8.atup.ks<-sum(a8.up.ks$Victories)
av9.atup.ks<-sum(a9.up.ks$Victories)
av10.atup.ks<-sum(a10.up.ks$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ks.atdu<-(sum(av1.atup.ks, av2.atup.ks, av3.atup.ks, av4.atup.ks, av5.atup.ks, av6.atup.ks, av7.atup.ks, av8.atup.ks, av9.atup.ks, av10.atup.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.atdu<-(sum(int1.atup.ks, int2.atup.ks, int3.atup.ks, int4.atup.ks, int5.atup.ks, int6.atup.ks, int7.atup.ks, int8.atup.ks, int9.atup.ks, int10.atup.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.ks<-e1.atup.ks[order(e1.atup.ks$ID),]
e1.atup.ks<-as.matrix(t(e1.1.atup.ks))

e2.atup.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.ks<-e2.atup.ks[order(e2.atup.ks$ID),]
e2.atup.ks<-as.matrix(t(e2.1.atup.ks))

e3.atup.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.ks<-e3.atup.ks[order(e3.atup.ks$ID),]
e3.atup.ks<-as.matrix(t(e3.1.atup.ks))

e4.atup.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.ks<-e4.atup.ks[order(e4.atup.ks$ID),]
e4.atup.ks<-as.matrix(t(e4.1.atup.ks))

e5.atup.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.ks<-e5.atup.ks[order(e5.atup.ks$ID),]
e5.atup.ks<-as.matrix(t(e5.1.atup.ks))

e6.atup.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.ks<-e6.atup.ks[order(e6.atup.ks$ID),]
e6.atup.ks<-as.matrix(t(e6.1.atup.ks))

e7.atup.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.ks<-e7.atup.ks[order(e7.atup.ks$ID),]
e7.atup.ks<-as.matrix(t(e7.1.atup.ks))

e8.atup.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.ks<-e8.atup.ks[order(e8.atup.ks$ID),]
e8.atup.ks<-as.matrix(t(e8.1.atup.ks))

e9.atup.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.ks<-e9.atup.ks[order(e9.atup.ks$ID),]
e9.atup.ks<-as.matrix(t(e9.1.atup.ks))

e10.atup.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.ks<-e10.atup.ks[order(e10.atup.ks$ID),]
e10.atup.ks<-as.matrix(t(e10.1.atup.ks))

energy.ks.atup.ks<-as.data.frame(matrix(c(e1.atup.ks,e2.atup.ks,e3.atup.ks,e4.atup.ks,e5.atup.ks,e6.atup.ks,e7.atup.ks,e8.atup.ks,e9.atup.ks,e10.atup.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.atup.ks<-data.frame(ID=energy.ks.atup.ks$V1,energy_over_distance=energy.ks.atup.ks$V2,energy_over_time=energy.ks.atup.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.ks<-david1.atup.ks[order(david1.atup.ks$ID),]
david1.atup.ks<-as.matrix(t(david1.1.atup.ks))

david2.1.atup.ks<-david2.atup.ks[order(david2.atup.ks$ID),]
david2.atup.ks<-as.matrix(t(david2.1.atup.ks))

david3.1.atup.ks<-david3.atup.ks[order(david3.atup.ks$ID),]
david3.atup.ks<-as.matrix(t(david3.1.atup.ks))

david4.1.atup.ks<-david4.atup.ks[order(david4.atup.ks$ID),]
david4.atup.ks<-as.matrix(t(david4.1.atup.ks))

david5.1.atup.ks<-david5.atup.ks[order(david5.atup.ks$ID),]
david5.atup.ks<-as.matrix(t(david5.1.atup.ks))

david6.1.atup.ks<-david6.atup.ks[order(david6.atup.ks$ID),]
david6.atup.ks<-as.matrix(t(david6.1.atup.ks))

david7.1.atup.ks<-david7.atup.ks[order(david7.atup.ks$ID),]
david7.atup.ks<-as.matrix(t(david7.1.atup.ks))

david8.1.atup.ks<-david8.atup.ks[order(david8.atup.ks$ID),]
david8.atup.ks<-as.matrix(t(david8.1.atup.ks))

david9.1.atup.ks<-david9.atup.ks[order(david9.atup.ks$ID),]
david9.atup.ks<-as.matrix(t(david9.1.atup.ks))

david10.1.atup.ks<-david10.atup.ks[order(david10.atup.ks$ID),]
david10.atup.ks<-as.matrix(t(david10.1.atup.ks))

david.ks.atup.ks<-as.data.frame(matrix(c(david1.atup.ks,david2.atup.ks,david3.atup.ks,david4.atup.ks,david5.atup.ks,david6.atup.ks,david7.atup.ks,david8.atup.ks,david9.atup.ks,david10.atup.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.atup.ks<-data.frame(ID=david.ks.atup.ks$V1,DS=david.ks.atup.ks$V2,normDS=david.ks.atup.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.atup.ks<-lm(e1.1.atup.ks$energy_over_time~as.numeric(david1.1.atup.ks$normDS))
ks.lm.1.s.atup.ks<-summary(lm.ks.1.atup.ks)$coefficients
ks.1.slope.atup.ks<-ks.lm.1.s.atup.ks[2,1]
lm.ks.2.atup.ks<-lm(e2.1.atup.ks$energy_over_time~as.numeric(david2.1.atup.ks$normDS))
ks.lm.2.s.atup.ks<-summary(lm.ks.2.atup.ks)$coefficients
ks.2.slope.atup.ks<-ks.lm.2.s.atup.ks[2,1]
lm.ks.3.atup.ks<-lm(e3.1.atup.ks$energy_over_time~as.numeric(david3.1.atup.ks$normDS))
ks.lm.3.s.atup.ks<-summary(lm.ks.3.atup.ks)$coefficients
ks.3.slope.atup.ks<-ks.lm.3.s.atup.ks[2,1]
lm.ks.4.atup.ks<-lm(e4.1.atup.ks$energy_over_time~as.numeric(david4.1.atup.ks$normDS))
ks.lm.4.s.atup.ks<-summary(lm.ks.4.atup.ks)$coefficients
ks.4.slope.atup.ks<-ks.lm.4.s.atup.ks[2,1]
lm.ks.5.atup.ks<-lm(e5.1.atup.ks$energy_over_time~as.numeric(david5.1.atup.ks$normDS))
ks.lm.5.s.atup.ks<-summary(lm.ks.5.atup.ks)$coefficients
ks.5.slope.atup.ks<-ks.lm.5.s.atup.ks[2,1]
lm.ks.6.atup.ks<-lm(e6.1.atup.ks$energy_over_time~as.numeric(david6.1.atup.ks$normDS))
ks.lm.6.s.atup.ks<-summary(lm.ks.6.atup.ks)$coefficients
ks.6.slope.atup.ks<-ks.lm.6.s.atup.ks[2,1]
lm.ks.7.atup.ks<-lm(e7.1.atup.ks$energy_over_time~as.numeric(david7.1.atup.ks$normDS))
ks.lm.7.s.atup.ks<-summary(lm.ks.7.atup.ks)$coefficients
ks.7.slope.atup.ks<-ks.lm.7.s.atup.ks[2,1]
lm.ks.8.atup.ks<-lm(e8.1.atup.ks$energy_over_time~as.numeric(david8.1.atup.ks$normDS))
ks.lm.8.s.atup.ks<-summary(lm.ks.8.atup.ks)$coefficients
ks.8.slope.atup.ks<-ks.lm.8.s.atup.ks[2,1]
lm.ks.9.atup.ks<-lm(e9.1.atup.ks$energy_over_time~as.numeric(david9.1.atup.ks$normDS))
ks.lm.9.s.atup.ks<-summary(lm.ks.9.atup.ks)$coefficients
ks.9.slope.atup.ks<-ks.lm.9.s.atup.ks[2,1]
lm.ks.10.atup.ks<-lm(e10.1.atup.ks$energy_over_time~as.numeric(david10.1.atup.ks$normDS))
ks.lm.10.s.atup.ks<-summary(lm.ks.10.atup.ks)$coefficients
ks.10.slope.atup.ks<-ks.lm.10.s.atup.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.atup.ss.attacks.atup.ks<-data.frame(triangle.transitivity=c(tri1.atup.ks,tri2.atup.ks,tri3.atup.ks,tri4.atup.ks,tri5.atup.ks,tri6.atup.ks,tri7.atup.ks,tri8.atup.ks,tri9.atup.ks,tri10.atup.ks),escalation=c(ep1.atup.ks,ep2.atup.ks,ep3.atup.ks,ep4.atup.ks,ep5.atup.ks,ep6.atup.ks,ep7.atup.ks,ep8.atup.ks,ep9.atup.ks,ep10.atup.ks),dci=c(dci1.atup.ks,dci2.atup.ks,dci3.atup.ks,dci4.atup.ks,dci5.atup.ks,dci6.atup.ks,dci7.atup.ks,dci8.atup.ks,dci9.atup.ks,dci10.atup.ks),steepness=c(s1.atup.ks,s2.atup.ks,s3.atup.ks,s4.atup.ks,s5.atup.ks,s6.atup.ks,s7.atup.ks,s8.atup.ks,s9.atup.ks,s10.atup.ks),slope=c(ks.1.slope.atup.ks,ks.2.slope.atup.ks,ks.3.slope.atup.ks,ks.4.slope.atup.ks,ks.5.slope.atup.ks,ks.6.slope.atup.ks,ks.7.slope.atup.ks,ks.8.slope.atup.ks,ks.9.slope.atup.ks,ks.10.slope.atup.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.ko<-sapply(files, read.csv)

# Generate attacks.atup.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.ko<-data.frame(X1=attacks.atup.ko[[1]],X2=attacks.atup.ko[[2]],Victories=attacks.atup.ko[[3]])
mat1.atup.ko<-inter.mat(mut1.atup.ko)
tri1.atup.ko<-tr.tri(mat1.atup.ko)
dci1.atup.ko<-DCindex(mat1.atup.ko)
mat1.atup.ko[is.na(mat1.atup.ko)] = 0
h1.atup.ko<-h.index(mat1.atup.ko)

ep1.atup.ko<-ep(mut1.atup.ko,a1.up.ko)
david1.atup.ko<-DS(mat1.atup.ko) #David's Scores - for steepness use normDS output
ordrank.1.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.ko<-cbind(ordrank.1.atup.ko,ds=david1.atup.ko$normDS)
lm1.atup.ko<-summary(lm(ordrank.1.atup.ko$ds~ordrank.1.atup.ko$ord.rank))
s1.atup.ko<-lm1.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.ko<-data.frame(X1=attacks.atup.ko[[4]],X2=attacks.atup.ko[[5]],Victories=attacks.atup.ko[[6]])
mat2.atup.ko<-inter.mat(mut2.atup.ko)
tri2.atup.ko<-tr.tri(mat2.atup.ko)
dci2.atup.ko<-DCindex(mat2.atup.ko)
mat2.atup.ko[is.na(mat2.atup.ko)] = 0
h2.atup.ko<-h.index(mat2.atup.ko)

ep2.atup.ko<-ep(mut2.atup.ko,a2.up.ko)
david2.atup.ko<-DS(mat2.atup.ko) #David's Scores - for steepness use normDS output
ordrank.2.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.ko<-cbind(ordrank.2.atup.ko,ds=david2.atup.ko$normDS)
lm2.atup.ko<-summary(lm(ordrank.2.atup.ko$ds~ordrank.2.atup.ko$ord.rank))
s2.atup.ko<-lm2.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.ko<-data.frame(X1=attacks.atup.ko[[7]],X2=attacks.atup.ko[[8]],Victories=attacks.atup.ko[[9]])
mat3.atup.ko<-inter.mat(mut3.atup.ko)
tri3.atup.ko<-tr.tri(mat3.atup.ko)
dci3.atup.ko<-DCindex(mat3.atup.ko)
mat3.atup.ko[is.na(mat3.atup.ko)] = 0
h3.atup.ko<-h.index(mat3.atup.ko)

ep3.atup.ko<-ep(mut3.atup.ko,a3.up.ko)
david3.atup.ko<-DS(mat3.atup.ko) #David's Scores - for steepness use normDS output
ordrank.3.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.ko<-cbind(ordrank.3.atup.ko,ds=david3.atup.ko$normDS)
lm3.atup.ko<-summary(lm(ordrank.3.atup.ko$ds~ordrank.3.atup.ko$ord.rank))
s3.atup.ko<-lm3.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.ko<-data.frame(X1=attacks.atup.ko[[10]],X2=attacks.atup.ko[[11]],Victories=attacks.atup.ko[[12]])
mat4.atup.ko<-inter.mat(mut4.atup.ko)
tri4.atup.ko<-tr.tri(mat4.atup.ko)
dci4.atup.ko<-DCindex(mat4.atup.ko)
mat4.atup.ko[is.na(mat4.atup.ko)] = 0
h4.atup.ko<-h.index(mat4.atup.ko)

ep4.atup.ko<-ep(mut4.atup.ko,a4.up.ko)
david4.atup.ko<-DS(mat4.atup.ko) #David's Scores - for steepness use normDS output
ordrank.4.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.ko<-cbind(ordrank.4.atup.ko,ds=david4.atup.ko$normDS)
lm4.atup.ko<-summary(lm(ordrank.4.atup.ko$ds~ordrank.4.atup.ko$ord.rank))
s4.atup.ko<-lm4.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.ko<-data.frame(X1=attacks.atup.ko[[13]],X2=attacks.atup.ko[[14]],Victories=attacks.atup.ko[[15]])
mat5.atup.ko<-inter.mat(mut5.atup.ko)
tri5.atup.ko<-tr.tri(mat5.atup.ko)
dci5.atup.ko<-DCindex(mat5.atup.ko)
mat5.atup.ko[is.na(mat5.atup.ko)] = 0
h5.atup.ko<-h.index(mat5.atup.ko)

ep5.atup.ko<-ep(mut5.atup.ko,a5.up.ko)
david5.atup.ko<-DS(mat5.atup.ko) #David's Scores - for steepness use normDS output
ordrank.5.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.ko<-cbind(ordrank.5.atup.ko,ds=david5.atup.ko$normDS)
lm5.atup.ko<-summary(lm(ordrank.5.atup.ko$ds~ordrank.5.atup.ko$ord.rank))
s5.atup.ko<-lm5.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.ko<-data.frame(X1=attacks.atup.ko[[16]],X2=attacks.atup.ko[[17]],Victories=attacks.atup.ko[[18]])
mat6.atup.ko<-inter.mat(mut6.atup.ko)
tri6.atup.ko<-tr.tri(mat6.atup.ko)
dci6.atup.ko<-DCindex(mat6.atup.ko)
mat6.atup.ko[is.na(mat6.atup.ko)] = 0
h6.atup.ko<-h.index(mat6.atup.ko)

ep6.atup.ko<-ep(mut6.atup.ko,a6.up.ko)
david6.atup.ko<-DS(mat6.atup.ko) #David's Scores - for steepness use normDS output
ordrank.6.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.ko<-cbind(ordrank.6.atup.ko,ds=david6.atup.ko$normDS)
lm6.atup.ko<-summary(lm(ordrank.6.atup.ko$ds~ordrank.6.atup.ko$ord.rank))
s6.atup.ko<-lm6.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.ko<-data.frame(X1=attacks.atup.ko[[19]],X2=attacks.atup.ko[[20]],Victories=attacks.atup.ko[[21]])
mat7.atup.ko<-inter.mat(mut7.atup.ko)
tri7.atup.ko<-tr.tri(mat7.atup.ko)
dci7.atup.ko<-DCindex(mat7.atup.ko)
mat7.atup.ko[is.na(mat7.atup.ko)] = 0
h7.atup.ko<-h.index(mat7.atup.ko)

ep7.atup.ko<-ep(mut7.atup.ko,a7.up.ko)
david7.atup.ko<-DS(mat7.atup.ko) #David's Scores - for steepness use normDS output
ordrank.7.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.ko<-cbind(ordrank.7.atup.ko,ds=david7.atup.ko$normDS)
lm7.atup.ko<-summary(lm(ordrank.7.atup.ko$ds~ordrank.7.atup.ko$ord.rank))
s7.atup.ko<-lm7.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.ko<-data.frame(X1=attacks.atup.ko[[22]],X2=attacks.atup.ko[[23]],Victories=attacks.atup.ko[[24]])
mat8.atup.ko<-inter.mat(mut8.atup.ko)
tri8.atup.ko<-tr.tri(mat8.atup.ko)
dci8.atup.ko<-DCindex(mat8.atup.ko)
mat8.atup.ko[is.na(mat8.atup.ko)] = 0
h8.atup.ko<-h.index(mat8.atup.ko)

ep8.atup.ko<-ep(mut8.atup.ko,a8.up.ko)
david8.atup.ko<-DS(mat8.atup.ko) #David's Scores - for steepness use normDS output
ordrank.8.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.ko<-cbind(ordrank.8.atup.ko,ds=david8.atup.ko$normDS)
lm8.atup.ko<-summary(lm(ordrank.8.atup.ko$ds~ordrank.8.atup.ko$ord.rank))
s8.atup.ko<-lm8.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.ko<-data.frame(X1=attacks.atup.ko[[25]],X2=attacks.atup.ko[[26]],Victories=attacks.atup.ko[[27]])
mat9.atup.ko<-inter.mat(mut9.atup.ko)
tri9.atup.ko<-tr.tri(mat9.atup.ko)
dci9.atup.ko<-DCindex(mat9.atup.ko)
mat9.atup.ko[is.na(mat9.atup.ko)] = 0
h9.atup.ko<-h.index(mat9.atup.ko)

ep9.atup.ko<-ep(mut9.atup.ko,a9.up.ko)
david9.atup.ko<-DS(mat9.atup.ko) #David's Scores - for steepness use normDS output
ordrank.9.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.ko<-cbind(ordrank.9.atup.ko,ds=david9.atup.ko$normDS)
lm9.atup.ko<-summary(lm(ordrank.9.atup.ko$ds~ordrank.9.atup.ko$ord.rank))
s9.atup.ko<-lm9.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.ko<-data.frame(X1=attacks.atup.ko[[28]],X2=attacks.atup.ko[[29]],Victories=attacks.atup.ko[[30]])
mat10.atup.ko<-inter.mat(mut10.atup.ko)
tri10.atup.ko<-tr.tri(mat10.atup.ko)
dci10.atup.ko<-DCindex(mat10.atup.ko)
mat10.atup.ko[is.na(mat10.atup.ko)] = 0
h10.atup.ko<-h.index(mat10.atup.ko)

ep10.atup.ko<-ep(mut10.atup.ko,a10.up.ko)
david10.atup.ko<-DS(mat10.atup.ko) #David's Scores - for steepness use normDS output
ordrank.10.atup.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.ko<-cbind(ordrank.10.atup.ko,ds=david10.atup.ko$normDS)
lm10.atup.ko<-summary(lm(ordrank.10.atup.ko$ds~ordrank.10.atup.ko$ord.rank))
s10.atup.ko<-lm10.atup.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.ko<-sum(mut1.atup.ko$Victories)
int2.atup.ko<-sum(mut2.atup.ko$Victories)
int3.atup.ko<-sum(mut3.atup.ko$Victories)
int4.atup.ko<-sum(mut4.atup.ko$Victories)
int5.atup.ko<-sum(mut5.atup.ko$Victories)
int6.atup.ko<-sum(mut6.atup.ko$Victories)
int7.atup.ko<-sum(mut7.atup.ko$Victories)
int8.atup.ko<-sum(mut8.atup.ko$Victories)
int9.atup.ko<-sum(mut9.atup.ko$Victories)
int10.atup.ko<-sum(mut10.atup.ko$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.ko<-sum(a1.up.ko$Victories)
av2.atup.ko<-sum(a2.up.ko$Victories)
av3.atup.ko<-sum(a3.up.ko$Victories)
av4.atup.ko<-sum(a4.up.ko$Victories)
av5.atup.ko<-sum(a5.up.ko$Victories)
av6.atup.ko<-sum(a6.up.ko$Victories)
av7.atup.ko<-sum(a7.up.ko$Victories)
av8.atup.ko<-sum(a8.up.ko$Victories)
av9.atup.ko<-sum(a9.up.ko$Victories)
av10.atup.ko<-sum(a10.up.ko$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ko.atdu<-(sum(av1.atup.ko, av2.atup.ko, av3.atup.ko, av4.atup.ko, av5.atup.ko, av6.atup.ko, av7.atup.ko, av8.atup.ko, av9.atup.ko, av10.atup.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.atdu<-(sum(int1.atup.ko, int2.atup.ko, int3.atup.ko, int4.atup.ko, int5.atup.ko, int6.atup.ko, int7.atup.ko, int8.atup.ko, int9.atup.ko, int10.atup.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.ko<-e1.atup.ko[order(e1.atup.ko$ID),]
e1.atup.ko<-as.matrix(t(e1.1.atup.ko))

e2.atup.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.ko<-e2.atup.ko[order(e2.atup.ko$ID),]
e2.atup.ko<-as.matrix(t(e2.1.atup.ko))

e3.atup.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.ko<-e3.atup.ko[order(e3.atup.ko$ID),]
e3.atup.ko<-as.matrix(t(e3.1.atup.ko))

e4.atup.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.ko<-e4.atup.ko[order(e4.atup.ko$ID),]
e4.atup.ko<-as.matrix(t(e4.1.atup.ko))

e5.atup.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.ko<-e5.atup.ko[order(e5.atup.ko$ID),]
e5.atup.ko<-as.matrix(t(e5.1.atup.ko))

e6.atup.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.ko<-e6.atup.ko[order(e6.atup.ko$ID),]
e6.atup.ko<-as.matrix(t(e6.1.atup.ko))

e7.atup.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.ko<-e7.atup.ko[order(e7.atup.ko$ID),]
e7.atup.ko<-as.matrix(t(e7.1.atup.ko))

e8.atup.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.ko<-e8.atup.ko[order(e8.atup.ko$ID),]
e8.atup.ko<-as.matrix(t(e8.1.atup.ko))

e9.atup.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.ko<-e9.atup.ko[order(e9.atup.ko$ID),]
e9.atup.ko<-as.matrix(t(e9.1.atup.ko))

e10.atup.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.ko<-e10.atup.ko[order(e10.atup.ko$ID),]
e10.atup.ko<-as.matrix(t(e10.1.atup.ko))

energy.ko.atup.ko<-as.data.frame(matrix(c(e1.atup.ko,e2.atup.ko,e3.atup.ko,e4.atup.ko,e5.atup.ko,e6.atup.ko,e7.atup.ko,e8.atup.ko,e9.atup.ko,e10.atup.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.atup.ko<-data.frame(ID=energy.ko.atup.ko$V1,energy_over_distance=energy.ko.atup.ko$V2,energy_over_time=energy.ko.atup.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.ko<-david1.atup.ko[order(david1.atup.ko$ID),]
david1.atup.ko<-as.matrix(t(david1.1.atup.ko))

david2.1.atup.ko<-david2.atup.ko[order(david2.atup.ko$ID),]
david2.atup.ko<-as.matrix(t(david2.1.atup.ko))

david3.1.atup.ko<-david3.atup.ko[order(david3.atup.ko$ID),]
david3.atup.ko<-as.matrix(t(david3.1.atup.ko))

david4.1.atup.ko<-david4.atup.ko[order(david4.atup.ko$ID),]
david4.atup.ko<-as.matrix(t(david4.1.atup.ko))

david5.1.atup.ko<-david5.atup.ko[order(david5.atup.ko$ID),]
david5.atup.ko<-as.matrix(t(david5.1.atup.ko))

david6.1.atup.ko<-david6.atup.ko[order(david6.atup.ko$ID),]
david6.atup.ko<-as.matrix(t(david6.1.atup.ko))

david7.1.atup.ko<-david7.atup.ko[order(david7.atup.ko$ID),]
david7.atup.ko<-as.matrix(t(david7.1.atup.ko))

david8.1.atup.ko<-david8.atup.ko[order(david8.atup.ko$ID),]
david8.atup.ko<-as.matrix(t(david8.1.atup.ko))

david9.1.atup.ko<-david9.atup.ko[order(david9.atup.ko$ID),]
david9.atup.ko<-as.matrix(t(david9.1.atup.ko))

david10.1.atup.ko<-david10.atup.ko[order(david10.atup.ko$ID),]
david10.atup.ko<-as.matrix(t(david10.1.atup.ko))

david.ko.atup.ko<-as.data.frame(matrix(c(david1.atup.ko,david2.atup.ko,david3.atup.ko,david4.atup.ko,david5.atup.ko,david6.atup.ko,david7.atup.ko,david8.atup.ko,david9.atup.ko,david10.atup.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.atup.ko<-data.frame(ID=david.ko.atup.ko$V1,DS=david.ko.atup.ko$V2,normDS=david.ko.atup.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.atup.ko<-lm(e1.1.atup.ko$energy_over_time~as.numeric(david1.1.atup.ko$normDS))
ko.lm.1.s.atup.ko<-summary(lm.ko.1.atup.ko)$coefficients
ko.1.slope.atup.ko<-ko.lm.1.s.atup.ko[2,1]
lm.ko.2.atup.ko<-lm(e2.1.atup.ko$energy_over_time~as.numeric(david2.1.atup.ko$normDS))
ko.lm.2.s.atup.ko<-summary(lm.ko.2.atup.ko)$coefficients
ko.2.slope.atup.ko<-ko.lm.2.s.atup.ko[2,1]
lm.ko.3.atup.ko<-lm(e3.1.atup.ko$energy_over_time~as.numeric(david3.1.atup.ko$normDS))
ko.lm.3.s.atup.ko<-summary(lm.ko.3.atup.ko)$coefficients
ko.3.slope.atup.ko<-ko.lm.3.s.atup.ko[2,1]
lm.ko.4.atup.ko<-lm(e4.1.atup.ko$energy_over_time~as.numeric(david4.1.atup.ko$normDS))
ko.lm.4.s.atup.ko<-summary(lm.ko.4.atup.ko)$coefficients
ko.4.slope.atup.ko<-ko.lm.4.s.atup.ko[2,1]
lm.ko.5.atup.ko<-lm(e5.1.atup.ko$energy_over_time~as.numeric(david5.1.atup.ko$normDS))
ko.lm.5.s.atup.ko<-summary(lm.ko.5.atup.ko)$coefficients
ko.5.slope.atup.ko<-ko.lm.5.s.atup.ko[2,1]
lm.ko.6.atup.ko<-lm(e6.1.atup.ko$energy_over_time~as.numeric(david6.1.atup.ko$normDS))
ko.lm.6.s.atup.ko<-summary(lm.ko.6.atup.ko)$coefficients
ko.6.slope.atup.ko<-ko.lm.6.s.atup.ko[2,1]
lm.ko.7.atup.ko<-lm(e7.1.atup.ko$energy_over_time~as.numeric(david7.1.atup.ko$normDS))
ko.lm.7.s.atup.ko<-summary(lm.ko.7.atup.ko)$coefficients
ko.7.slope.atup.ko<-ko.lm.7.s.atup.ko[2,1]
lm.ko.8.atup.ko<-lm(e8.1.atup.ko$energy_over_time~as.numeric(david8.1.atup.ko$normDS))
ko.lm.8.s.atup.ko<-summary(lm.ko.8.atup.ko)$coefficients
ko.8.slope.atup.ko<-ko.lm.8.s.atup.ko[2,1]
lm.ko.9.atup.ko<-lm(e9.1.atup.ko$energy_over_time~as.numeric(david9.1.atup.ko$normDS))
ko.lm.9.s.atup.ko<-summary(lm.ko.9.atup.ko)$coefficients
ko.9.slope.atup.ko<-ko.lm.9.s.atup.ko[2,1]
lm.ko.10.atup.ko<-lm(e10.1.atup.ko$energy_over_time~as.numeric(david10.1.atup.ko$normDS))
ko.lm.10.s.atup.ko<-summary(lm.ko.10.atup.ko)$coefficients
ko.10.slope.atup.ko<-ko.lm.10.s.atup.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.atup.ss.attacks.atup.ko<-data.frame(triangle.transitivity=c(tri1.atup.ko,tri2.atup.ko,tri3.atup.ko,tri4.atup.ko,tri5.atup.ko,tri6.atup.ko,tri7.atup.ko,tri8.atup.ko,tri9.atup.ko,tri10.atup.ko),escalation=c(ep1.atup.ko,ep2.atup.ko,ep3.atup.ko,ep4.atup.ko,ep5.atup.ko,ep6.atup.ko,ep7.atup.ko,ep8.atup.ko,ep9.atup.ko,ep10.atup.ko),dci=c(dci1.atup.ko,dci2.atup.ko,dci3.atup.ko,dci4.atup.ko,dci5.atup.ko,dci6.atup.ko,dci7.atup.ko,dci8.atup.ko,dci9.atup.ko,dci10.atup.ko),steepness=c(s1.atup.ko,s2.atup.ko,s3.atup.ko,s4.atup.ko,s5.atup.ko,s6.atup.ko,s7.atup.ko,s8.atup.ko,s9.atup.ko,s10.atup.ko),slope=c(ko.1.slope.atup.ko,ko.2.slope.atup.ko,ko.3.slope.atup.ko,ko.4.slope.atup.ko,ko.5.slope.atup.ko,ko.6.slope.atup.ko,ko.7.slope.atup.ko,ko.8.slope.atup.ko,ko.9.slope.atup.ko,ko.10.slope.atup.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.hm<-sapply(files, read.csv)

# Generate attacks.atup.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.hm<-data.frame(X1=attacks.atup.hm[[1]],X2=attacks.atup.hm[[2]],Victories=attacks.atup.hm[[3]])
mat1.atup.hm<-inter.mat(mut1.atup.hm)
tri1.atup.hm<-tr.tri(mat1.atup.hm)
dci1.atup.hm<-DCindex(mat1.atup.hm)
mat1.atup.hm[is.na(mat1.atup.hm)] = 0
h1.atup.hm<-h.index(mat1.atup.hm)

ep1.atup.hm<-ep(mut1.atup.hm,a1.up.hm)
david1.atup.hm<-DS(mat1.atup.hm) #David's Scores - for steepness use normDS output
ordrank.1.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.hm<-cbind(ordrank.1.atup.hm,ds=david1.atup.hm$normDS)
lm1.atup.hm<-summary(lm(ordrank.1.atup.hm$ds~ordrank.1.atup.hm$ord.rank))
s1.atup.hm<-lm1.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.hm<-data.frame(X1=attacks.atup.hm[[4]],X2=attacks.atup.hm[[5]],Victories=attacks.atup.hm[[6]])
mat2.atup.hm<-inter.mat(mut2.atup.hm)
tri2.atup.hm<-tr.tri(mat2.atup.hm)
dci2.atup.hm<-DCindex(mat2.atup.hm)
mat2.atup.hm[is.na(mat2.atup.hm)] = 0
h2.atup.hm<-h.index(mat2.atup.hm)

ep2.atup.hm<-ep(mut2.atup.hm,a2.up.hm)
david2.atup.hm<-DS(mat2.atup.hm) #David's Scores - for steepness use normDS output
ordrank.2.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.hm<-cbind(ordrank.2.atup.hm,ds=david2.atup.hm$normDS)
lm2.atup.hm<-summary(lm(ordrank.2.atup.hm$ds~ordrank.2.atup.hm$ord.rank))
s2.atup.hm<-lm2.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.hm<-data.frame(X1=attacks.atup.hm[[7]],X2=attacks.atup.hm[[8]],Victories=attacks.atup.hm[[9]])
mat3.atup.hm<-inter.mat(mut3.atup.hm)
tri3.atup.hm<-tr.tri(mat3.atup.hm)
dci3.atup.hm<-DCindex(mat3.atup.hm)
mat3.atup.hm[is.na(mat3.atup.hm)] = 0
h3.atup.hm<-h.index(mat3.atup.hm)

ep3.atup.hm<-ep(mut3.atup.hm,a3.up.hm)
david3.atup.hm<-DS(mat3.atup.hm) #David's Scores - for steepness use normDS output
ordrank.3.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.hm<-cbind(ordrank.3.atup.hm,ds=david3.atup.hm$normDS)
lm3.atup.hm<-summary(lm(ordrank.3.atup.hm$ds~ordrank.3.atup.hm$ord.rank))
s3.atup.hm<-lm3.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.hm<-data.frame(X1=attacks.atup.hm[[10]],X2=attacks.atup.hm[[11]],Victories=attacks.atup.hm[[12]])
mat4.atup.hm<-inter.mat(mut4.atup.hm)
tri4.atup.hm<-tr.tri(mat4.atup.hm)
dci4.atup.hm<-DCindex(mat4.atup.hm)
mat4.atup.hm[is.na(mat4.atup.hm)] = 0
h4.atup.hm<-h.index(mat4.atup.hm)

ep4.atup.hm<-ep(mut4.atup.hm,a4.up.hm)
david4.atup.hm<-DS(mat4.atup.hm) #David's Scores - for steepness use normDS output
ordrank.4.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.hm<-cbind(ordrank.4.atup.hm,ds=david4.atup.hm$normDS)
lm4.atup.hm<-summary(lm(ordrank.4.atup.hm$ds~ordrank.4.atup.hm$ord.rank))
s4.atup.hm<-lm4.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.hm<-data.frame(X1=attacks.atup.hm[[13]],X2=attacks.atup.hm[[14]],Victories=attacks.atup.hm[[15]])
mat5.atup.hm<-inter.mat(mut5.atup.hm)
tri5.atup.hm<-tr.tri(mat5.atup.hm)
dci5.atup.hm<-DCindex(mat5.atup.hm)
mat5.atup.hm[is.na(mat5.atup.hm)] = 0
h5.atup.hm<-h.index(mat5.atup.hm)

ep5.atup.hm<-ep(mut5.atup.hm,a5.up.hm)
david5.atup.hm<-DS(mat5.atup.hm) #David's Scores - for steepness use normDS output
ordrank.5.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.hm<-cbind(ordrank.5.atup.hm,ds=david5.atup.hm$normDS)
lm5.atup.hm<-summary(lm(ordrank.5.atup.hm$ds~ordrank.5.atup.hm$ord.rank))
s5.atup.hm<-lm5.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.hm<-data.frame(X1=attacks.atup.hm[[16]],X2=attacks.atup.hm[[17]],Victories=attacks.atup.hm[[18]])
mat6.atup.hm<-inter.mat(mut6.atup.hm)
tri6.atup.hm<-tr.tri(mat6.atup.hm)
dci6.atup.hm<-DCindex(mat6.atup.hm)
mat6.atup.hm[is.na(mat6.atup.hm)] = 0
h6.atup.hm<-h.index(mat6.atup.hm)

ep6.atup.hm<-ep(mut6.atup.hm,a6.up.hm)
david6.atup.hm<-DS(mat6.atup.hm) #David's Scores - for steepness use normDS output
ordrank.6.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.hm<-cbind(ordrank.6.atup.hm,ds=david6.atup.hm$normDS)
lm6.atup.hm<-summary(lm(ordrank.6.atup.hm$ds~ordrank.6.atup.hm$ord.rank))
s6.atup.hm<-lm6.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.hm<-data.frame(X1=attacks.atup.hm[[19]],X2=attacks.atup.hm[[20]],Victories=attacks.atup.hm[[21]])
mat7.atup.hm<-inter.mat(mut7.atup.hm)
tri7.atup.hm<-tr.tri(mat7.atup.hm)
dci7.atup.hm<-DCindex(mat7.atup.hm)
mat7.atup.hm[is.na(mat7.atup.hm)] = 0
h7.atup.hm<-h.index(mat7.atup.hm)

ep7.atup.hm<-ep(mut7.atup.hm,a7.up.hm)
david7.atup.hm<-DS(mat7.atup.hm) #David's Scores - for steepness use normDS output
ordrank.7.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.hm<-cbind(ordrank.7.atup.hm,ds=david7.atup.hm$normDS)
lm7.atup.hm<-summary(lm(ordrank.7.atup.hm$ds~ordrank.7.atup.hm$ord.rank))
s7.atup.hm<-lm7.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.hm<-data.frame(X1=attacks.atup.hm[[22]],X2=attacks.atup.hm[[23]],Victories=attacks.atup.hm[[24]])
mat8.atup.hm<-inter.mat(mut8.atup.hm)
tri8.atup.hm<-tr.tri(mat8.atup.hm)
dci8.atup.hm<-DCindex(mat8.atup.hm)
mat8.atup.hm[is.na(mat8.atup.hm)] = 0
h8.atup.hm<-h.index(mat8.atup.hm)

ep8.atup.hm<-ep(mut8.atup.hm,a8.up.hm)
david8.atup.hm<-DS(mat8.atup.hm) #David's Scores - for steepness use normDS output
ordrank.8.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.hm<-cbind(ordrank.8.atup.hm,ds=david8.atup.hm$normDS)
lm8.atup.hm<-summary(lm(ordrank.8.atup.hm$ds~ordrank.8.atup.hm$ord.rank))
s8.atup.hm<-lm8.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.hm<-data.frame(X1=attacks.atup.hm[[25]],X2=attacks.atup.hm[[26]],Victories=attacks.atup.hm[[27]])
mat9.atup.hm<-inter.mat(mut9.atup.hm)
tri9.atup.hm<-tr.tri(mat9.atup.hm)
dci9.atup.hm<-DCindex(mat9.atup.hm)
mat9.atup.hm[is.na(mat9.atup.hm)] = 0
h9.atup.hm<-h.index(mat9.atup.hm)

ep9.atup.hm<-ep(mut9.atup.hm,a9.up.hm)
david9.atup.hm<-DS(mat9.atup.hm) #David's Scores - for steepness use normDS output
ordrank.9.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.hm<-cbind(ordrank.9.atup.hm,ds=david9.atup.hm$normDS)
lm9.atup.hm<-summary(lm(ordrank.9.atup.hm$ds~ordrank.9.atup.hm$ord.rank))
s9.atup.hm<-lm9.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.hm<-data.frame(X1=attacks.atup.hm[[28]],X2=attacks.atup.hm[[29]],Victories=attacks.atup.hm[[30]])
mat10.atup.hm<-inter.mat(mut10.atup.hm)
tri10.atup.hm<-tr.tri(mat10.atup.hm)
dci10.atup.hm<-DCindex(mat10.atup.hm)
mat10.atup.hm[is.na(mat10.atup.hm)] = 0
h10.atup.hm<-h.index(mat10.atup.hm)

ep10.atup.hm<-ep(mut10.atup.hm,a10.up.hm)
david10.atup.hm<-DS(mat10.atup.hm) #David's Scores - for steepness use normDS output
ordrank.10.atup.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.hm<-cbind(ordrank.10.atup.hm,ds=david10.atup.hm$normDS)
lm10.atup.hm<-summary(lm(ordrank.10.atup.hm$ds~ordrank.10.atup.hm$ord.rank))
s10.atup.hm<-lm10.atup.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.hm<-sum(mut1.atup.hm$Victories)
int2.atup.hm<-sum(mut2.atup.hm$Victories)
int3.atup.hm<-sum(mut3.atup.hm$Victories)
int4.atup.hm<-sum(mut4.atup.hm$Victories)
int5.atup.hm<-sum(mut5.atup.hm$Victories)
int6.atup.hm<-sum(mut6.atup.hm$Victories)
int7.atup.hm<-sum(mut7.atup.hm$Victories)
int8.atup.hm<-sum(mut8.atup.hm$Victories)
int9.atup.hm<-sum(mut9.atup.hm$Victories)
int10.atup.hm<-sum(mut10.atup.hm$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.hm<-sum(a1.up.hm$Victories)
av2.atup.hm<-sum(a2.up.hm$Victories)
av3.atup.hm<-sum(a3.up.hm$Victories)
av4.atup.hm<-sum(a4.up.hm$Victories)
av5.atup.hm<-sum(a5.up.hm$Victories)
av6.atup.hm<-sum(a6.up.hm$Victories)
av7.atup.hm<-sum(a7.up.hm$Victories)
av8.atup.hm<-sum(a8.up.hm$Victories)
av9.atup.hm<-sum(a9.up.hm$Victories)
av10.atup.hm<-sum(a10.up.hm$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.hm.atdu<-(sum(av1.atup.hm, av2.atup.hm, av3.atup.hm, av4.atup.hm, av5.atup.hm, av6.atup.hm, av7.atup.hm, av8.atup.hm, av9.atup.hm, av10.atup.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.atdu<-(sum(int1.atup.hm, int2.atup.hm, int3.atup.hm, int4.atup.hm, int5.atup.hm, int6.atup.hm, int7.atup.hm, int8.atup.hm, int9.atup.hm, int10.atup.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.hm<-e1.atup.hm[order(e1.atup.hm$ID),]
e1.atup.hm<-as.matrix(t(e1.1.atup.hm))

e2.atup.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.hm<-e2.atup.hm[order(e2.atup.hm$ID),]
e2.atup.hm<-as.matrix(t(e2.1.atup.hm))

e3.atup.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.hm<-e3.atup.hm[order(e3.atup.hm$ID),]
e3.atup.hm<-as.matrix(t(e3.1.atup.hm))

e4.atup.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.hm<-e4.atup.hm[order(e4.atup.hm$ID),]
e4.atup.hm<-as.matrix(t(e4.1.atup.hm))

e5.atup.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.hm<-e5.atup.hm[order(e5.atup.hm$ID),]
e5.atup.hm<-as.matrix(t(e5.1.atup.hm))

e6.atup.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.hm<-e6.atup.hm[order(e6.atup.hm$ID),]
e6.atup.hm<-as.matrix(t(e6.1.atup.hm))

e7.atup.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.hm<-e7.atup.hm[order(e7.atup.hm$ID),]
e7.atup.hm<-as.matrix(t(e7.1.atup.hm))

e8.atup.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.hm<-e8.atup.hm[order(e8.atup.hm$ID),]
e8.atup.hm<-as.matrix(t(e8.1.atup.hm))

e9.atup.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.hm<-e9.atup.hm[order(e9.atup.hm$ID),]
e9.atup.hm<-as.matrix(t(e9.1.atup.hm))

e10.atup.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.hm<-e10.atup.hm[order(e10.atup.hm$ID),]
e10.atup.hm<-as.matrix(t(e10.1.atup.hm))

energy.hm.atup.hm<-as.data.frame(matrix(c(e1.atup.hm,e2.atup.hm,e3.atup.hm,e4.atup.hm,e5.atup.hm,e6.atup.hm,e7.atup.hm,e8.atup.hm,e9.atup.hm,e10.atup.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atup.hm<-data.frame(ID=energy.hm.atup.hm$V1,energy_over_distance=energy.hm.atup.hm$V2,energy_over_time=energy.hm.atup.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.hm<-david1.atup.hm[order(david1.atup.hm$ID),]
david1.atup.hm<-as.matrix(t(david1.1.atup.hm))

david2.1.atup.hm<-david2.atup.hm[order(david2.atup.hm$ID),]
david2.atup.hm<-as.matrix(t(david2.1.atup.hm))

david3.1.atup.hm<-david3.atup.hm[order(david3.atup.hm$ID),]
david3.atup.hm<-as.matrix(t(david3.1.atup.hm))

david4.1.atup.hm<-david4.atup.hm[order(david4.atup.hm$ID),]
david4.atup.hm<-as.matrix(t(david4.1.atup.hm))

david5.1.atup.hm<-david5.atup.hm[order(david5.atup.hm$ID),]
david5.atup.hm<-as.matrix(t(david5.1.atup.hm))

david6.1.atup.hm<-david6.atup.hm[order(david6.atup.hm$ID),]
david6.atup.hm<-as.matrix(t(david6.1.atup.hm))

david7.1.atup.hm<-david7.atup.hm[order(david7.atup.hm$ID),]
david7.atup.hm<-as.matrix(t(david7.1.atup.hm))

david8.1.atup.hm<-david8.atup.hm[order(david8.atup.hm$ID),]
david8.atup.hm<-as.matrix(t(david8.1.atup.hm))

david9.1.atup.hm<-david9.atup.hm[order(david9.atup.hm$ID),]
david9.atup.hm<-as.matrix(t(david9.1.atup.hm))

david10.1.atup.hm<-david10.atup.hm[order(david10.atup.hm$ID),]
david10.atup.hm<-as.matrix(t(david10.1.atup.hm))

david.hm.atup.hm<-as.data.frame(matrix(c(david1.atup.hm,david2.atup.hm,david3.atup.hm,david4.atup.hm,david5.atup.hm,david6.atup.hm,david7.atup.hm,david8.atup.hm,david9.atup.hm,david10.atup.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atup.hm<-data.frame(ID=david.hm.atup.hm$V1,DS=david.hm.atup.hm$V2,normDS=david.hm.atup.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atup.hm<-lm(e1.1.atup.hm$energy_over_time~as.numeric(david1.1.atup.hm$normDS))
hm.lm.1.s.atup.hm<-summary(lm.hm.1.atup.hm)$coefficients
hm.1.slope.atup.hm<-hm.lm.1.s.atup.hm[2,1]
lm.hm.2.atup.hm<-lm(e2.1.atup.hm$energy_over_time~as.numeric(david2.1.atup.hm$normDS))
hm.lm.2.s.atup.hm<-summary(lm.hm.2.atup.hm)$coefficients
hm.2.slope.atup.hm<-hm.lm.2.s.atup.hm[2,1]
lm.hm.3.atup.hm<-lm(e3.1.atup.hm$energy_over_time~as.numeric(david3.1.atup.hm$normDS))
hm.lm.3.s.atup.hm<-summary(lm.hm.3.atup.hm)$coefficients
hm.3.slope.atup.hm<-hm.lm.3.s.atup.hm[2,1]
lm.hm.4.atup.hm<-lm(e4.1.atup.hm$energy_over_time~as.numeric(david4.1.atup.hm$normDS))
hm.lm.4.s.atup.hm<-summary(lm.hm.4.atup.hm)$coefficients
hm.4.slope.atup.hm<-hm.lm.4.s.atup.hm[2,1]
lm.hm.5.atup.hm<-lm(e5.1.atup.hm$energy_over_time~as.numeric(david5.1.atup.hm$normDS))
hm.lm.5.s.atup.hm<-summary(lm.hm.5.atup.hm)$coefficients
hm.5.slope.atup.hm<-hm.lm.5.s.atup.hm[2,1]
lm.hm.6.atup.hm<-lm(e6.1.atup.hm$energy_over_time~as.numeric(david6.1.atup.hm$normDS))
hm.lm.6.s.atup.hm<-summary(lm.hm.6.atup.hm)$coefficients
hm.6.slope.atup.hm<-hm.lm.6.s.atup.hm[2,1]
lm.hm.7.atup.hm<-lm(e7.1.atup.hm$energy_over_time~as.numeric(david7.1.atup.hm$normDS))
hm.lm.7.s.atup.hm<-summary(lm.hm.7.atup.hm)$coefficients
hm.7.slope.atup.hm<-hm.lm.7.s.atup.hm[2,1]
lm.hm.8.atup.hm<-lm(e8.1.atup.hm$energy_over_time~as.numeric(david8.1.atup.hm$normDS))
hm.lm.8.s.atup.hm<-summary(lm.hm.8.atup.hm)$coefficients
hm.8.slope.atup.hm<-hm.lm.8.s.atup.hm[2,1]
lm.hm.9.atup.hm<-lm(e9.1.atup.hm$energy_over_time~as.numeric(david9.1.atup.hm$normDS))
hm.lm.9.s.atup.hm<-summary(lm.hm.9.atup.hm)$coefficients
hm.9.slope.atup.hm<-hm.lm.9.s.atup.hm[2,1]
lm.hm.10.atup.hm<-lm(e10.1.atup.hm$energy_over_time~as.numeric(david10.1.atup.hm$normDS))
hm.lm.10.s.atup.hm<-summary(lm.hm.10.atup.hm)$coefficients
hm.10.slope.atup.hm<-hm.lm.10.s.atup.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atup.ss.attacks.atup.hm<-data.frame(triangle.transitivity=c(tri1.atup.hm,tri2.atup.hm,tri3.atup.hm,tri4.atup.hm,tri5.atup.hm,tri6.atup.hm,tri7.atup.hm,tri8.atup.hm,tri9.atup.hm,tri10.atup.hm),escalation=c(ep1.atup.hm,ep2.atup.hm,ep3.atup.hm,ep4.atup.hm,ep5.atup.hm,ep6.atup.hm,ep7.atup.hm,ep8.atup.hm,ep9.atup.hm,ep10.atup.hm),dci=c(dci1.atup.hm,dci2.atup.hm,dci3.atup.hm,dci4.atup.hm,dci5.atup.hm,dci6.atup.hm,dci7.atup.hm,dci8.atup.hm,dci9.atup.hm,dci10.atup.hm),steepness=c(s1.atup.hm,s2.atup.hm,s3.atup.hm,s4.atup.hm,s5.atup.hm,s6.atup.hm,s7.atup.hm,s8.atup.hm,s9.atup.hm,s10.atup.hm),slope=c(hm.1.slope.atup.hm,hm.2.slope.atup.hm,hm.3.slope.atup.hm,hm.4.slope.atup.hm,hm.5.slope.atup.hm,hm.6.slope.atup.hm,hm.7.slope.atup.hm,hm.8.slope.atup.hm,hm.9.slope.atup.hm,hm.10.slope.atup.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.hs<-sapply(files, read.csv)

# Generate attacks.atup.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.hs<-data.frame(X1=attacks.atup.hs[[1]],X2=attacks.atup.hs[[2]],Victories=attacks.atup.hs[[3]])
mat1.atup.hs<-inter.mat(mut1.atup.hs)
tri1.atup.hs<-tr.tri(mat1.atup.hs)
dci1.atup.hs<-DCindex(mat1.atup.hs)
mat1.atup.hs[is.na(mat1.atup.hs)] = 0
h1.atup.hs<-h.index(mat1.atup.hs)

ep1.atup.hs<-ep(mut1.atup.hs,a1.up.hs)
david1.atup.hs<-DS(mat1.atup.hs) #David's Scores - for steepness use normDS output
ordrank.1.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.hs<-cbind(ordrank.1.atup.hs,ds=david1.atup.hs$normDS)
lm1.atup.hs<-summary(lm(ordrank.1.atup.hs$ds~ordrank.1.atup.hs$ord.rank))
s1.atup.hs<-lm1.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.hs<-data.frame(X1=attacks.atup.hs[[4]],X2=attacks.atup.hs[[5]],Victories=attacks.atup.hs[[6]])
mat2.atup.hs<-inter.mat(mut2.atup.hs)
tri2.atup.hs<-tr.tri(mat2.atup.hs)
dci2.atup.hs<-DCindex(mat2.atup.hs)
mat2.atup.hs[is.na(mat2.atup.hs)] = 0
h2.atup.hs<-h.index(mat2.atup.hs)

ep2.atup.hs<-ep(mut2.atup.hs,a2.up.hs)
david2.atup.hs<-DS(mat2.atup.hs) #David's Scores - for steepness use normDS output
ordrank.2.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.hs<-cbind(ordrank.2.atup.hs,ds=david2.atup.hs$normDS)
lm2.atup.hs<-summary(lm(ordrank.2.atup.hs$ds~ordrank.2.atup.hs$ord.rank))
s2.atup.hs<-lm2.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.hs<-data.frame(X1=attacks.atup.hs[[7]],X2=attacks.atup.hs[[8]],Victories=attacks.atup.hs[[9]])
mat3.atup.hs<-inter.mat(mut3.atup.hs)
tri3.atup.hs<-tr.tri(mat3.atup.hs)
dci3.atup.hs<-DCindex(mat3.atup.hs)
mat3.atup.hs[is.na(mat3.atup.hs)] = 0
h3.atup.hs<-h.index(mat3.atup.hs)

ep3.atup.hs<-ep(mut3.atup.hs,a3.up.hs)
david3.atup.hs<-DS(mat3.atup.hs) #David's Scores - for steepness use normDS output
ordrank.3.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.hs<-cbind(ordrank.3.atup.hs,ds=david3.atup.hs$normDS)
lm3.atup.hs<-summary(lm(ordrank.3.atup.hs$ds~ordrank.3.atup.hs$ord.rank))
s3.atup.hs<-lm3.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.hs<-data.frame(X1=attacks.atup.hs[[10]],X2=attacks.atup.hs[[11]],Victories=attacks.atup.hs[[12]])
mat4.atup.hs<-inter.mat(mut4.atup.hs)
tri4.atup.hs<-tr.tri(mat4.atup.hs)
dci4.atup.hs<-DCindex(mat4.atup.hs)
mat4.atup.hs[is.na(mat4.atup.hs)] = 0
h4.atup.hs<-h.index(mat4.atup.hs)

ep4.atup.hs<-ep(mut4.atup.hs,a4.up.hs)
david4.atup.hs<-DS(mat4.atup.hs) #David's Scores - for steepness use normDS output
ordrank.4.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.hs<-cbind(ordrank.4.atup.hs,ds=david4.atup.hs$normDS)
lm4.atup.hs<-summary(lm(ordrank.4.atup.hs$ds~ordrank.4.atup.hs$ord.rank))
s4.atup.hs<-lm4.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.hs<-data.frame(X1=attacks.atup.hs[[13]],X2=attacks.atup.hs[[14]],Victories=attacks.atup.hs[[15]])
mat5.atup.hs<-inter.mat(mut5.atup.hs)
tri5.atup.hs<-tr.tri(mat5.atup.hs)
dci5.atup.hs<-DCindex(mat5.atup.hs)
mat5.atup.hs[is.na(mat5.atup.hs)] = 0
h5.atup.hs<-h.index(mat5.atup.hs)

ep5.atup.hs<-ep(mut5.atup.hs,a5.up.hs)
david5.atup.hs<-DS(mat5.atup.hs) #David's Scores - for steepness use normDS output
ordrank.5.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.hs<-cbind(ordrank.5.atup.hs,ds=david5.atup.hs$normDS)
lm5.atup.hs<-summary(lm(ordrank.5.atup.hs$ds~ordrank.5.atup.hs$ord.rank))
s5.atup.hs<-lm5.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.hs<-data.frame(X1=attacks.atup.hs[[16]],X2=attacks.atup.hs[[17]],Victories=attacks.atup.hs[[18]])
mat6.atup.hs<-inter.mat(mut6.atup.hs)
tri6.atup.hs<-tr.tri(mat6.atup.hs)
dci6.atup.hs<-DCindex(mat6.atup.hs)
mat6.atup.hs[is.na(mat6.atup.hs)] = 0
h6.atup.hs<-h.index(mat6.atup.hs)

ep6.atup.hs<-ep(mut6.atup.hs,a6.up.hs)
david6.atup.hs<-DS(mat6.atup.hs) #David's Scores - for steepness use normDS output
ordrank.6.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.hs<-cbind(ordrank.6.atup.hs,ds=david6.atup.hs$normDS)
lm6.atup.hs<-summary(lm(ordrank.6.atup.hs$ds~ordrank.6.atup.hs$ord.rank))
s6.atup.hs<-lm6.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.hs<-data.frame(X1=attacks.atup.hs[[19]],X2=attacks.atup.hs[[20]],Victories=attacks.atup.hs[[21]])
mat7.atup.hs<-inter.mat(mut7.atup.hs)
tri7.atup.hs<-tr.tri(mat7.atup.hs)
dci7.atup.hs<-DCindex(mat7.atup.hs)
mat7.atup.hs[is.na(mat7.atup.hs)] = 0
h7.atup.hs<-h.index(mat7.atup.hs)

ep7.atup.hs<-ep(mut7.atup.hs,a7.up.hs)
david7.atup.hs<-DS(mat7.atup.hs) #David's Scores - for steepness use normDS output
ordrank.7.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.hs<-cbind(ordrank.7.atup.hs,ds=david7.atup.hs$normDS)
lm7.atup.hs<-summary(lm(ordrank.7.atup.hs$ds~ordrank.7.atup.hs$ord.rank))
s7.atup.hs<-lm7.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.hs<-data.frame(X1=attacks.atup.hs[[22]],X2=attacks.atup.hs[[23]],Victories=attacks.atup.hs[[24]])
mat8.atup.hs<-inter.mat(mut8.atup.hs)
tri8.atup.hs<-tr.tri(mat8.atup.hs)
dci8.atup.hs<-DCindex(mat8.atup.hs)
mat8.atup.hs[is.na(mat8.atup.hs)] = 0
h8.atup.hs<-h.index(mat8.atup.hs)

ep8.atup.hs<-ep(mut8.atup.hs,a8.up.hs)
david8.atup.hs<-DS(mat8.atup.hs) #David's Scores - for steepness use normDS output
ordrank.8.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.hs<-cbind(ordrank.8.atup.hs,ds=david8.atup.hs$normDS)
lm8.atup.hs<-summary(lm(ordrank.8.atup.hs$ds~ordrank.8.atup.hs$ord.rank))
s8.atup.hs<-lm8.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.hs<-data.frame(X1=attacks.atup.hs[[25]],X2=attacks.atup.hs[[26]],Victories=attacks.atup.hs[[27]])
mat9.atup.hs<-inter.mat(mut9.atup.hs)
tri9.atup.hs<-tr.tri(mat9.atup.hs)
dci9.atup.hs<-DCindex(mat9.atup.hs)
mat9.atup.hs[is.na(mat9.atup.hs)] = 0
h9.atup.hs<-h.index(mat9.atup.hs)

ep9.atup.hs<-ep(mut9.atup.hs,a9.up.hs)
david9.atup.hs<-DS(mat9.atup.hs) #David's Scores - for steepness use normDS output
ordrank.9.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.hs<-cbind(ordrank.9.atup.hs,ds=david9.atup.hs$normDS)
lm9.atup.hs<-summary(lm(ordrank.9.atup.hs$ds~ordrank.9.atup.hs$ord.rank))
s9.atup.hs<-lm9.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.hs<-data.frame(X1=attacks.atup.hs[[28]],X2=attacks.atup.hs[[29]],Victories=attacks.atup.hs[[30]])
mat10.atup.hs<-inter.mat(mut10.atup.hs)
tri10.atup.hs<-tr.tri(mat10.atup.hs)
dci10.atup.hs<-DCindex(mat10.atup.hs)
mat10.atup.hs[is.na(mat10.atup.hs)] = 0
h10.atup.hs<-h.index(mat10.atup.hs)

ep10.atup.hs<-ep(mut10.atup.hs,a10.up.hs)
david10.atup.hs<-DS(mat10.atup.hs) #David's Scores - for steepness use normDS output
ordrank.10.atup.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.hs<-cbind(ordrank.10.atup.hs,ds=david10.atup.hs$normDS)
lm10.atup.hs<-summary(lm(ordrank.10.atup.hs$ds~ordrank.10.atup.hs$ord.rank))
s10.atup.hs<-lm10.atup.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.hs<-sum(mut1.atup.hs$Victories)
int2.atup.hs<-sum(mut2.atup.hs$Victories)
int3.atup.hs<-sum(mut3.atup.hs$Victories)
int4.atup.hs<-sum(mut4.atup.hs$Victories)
int5.atup.hs<-sum(mut5.atup.hs$Victories)
int6.atup.hs<-sum(mut6.atup.hs$Victories)
int7.atup.hs<-sum(mut7.atup.hs$Victories)
int8.atup.hs<-sum(mut8.atup.hs$Victories)
int9.atup.hs<-sum(mut9.atup.hs$Victories)
int10.atup.hs<-sum(mut10.atup.hs$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.hs<-sum(a1.up.hs$Victories)
av2.atup.hs<-sum(a2.up.hs$Victories)
av3.atup.hs<-sum(a3.up.hs$Victories)
av4.atup.hs<-sum(a4.up.hs$Victories)
av5.atup.hs<-sum(a5.up.hs$Victories)
av6.atup.hs<-sum(a6.up.hs$Victories)
av7.atup.hs<-sum(a7.up.hs$Victories)
av8.atup.hs<-sum(a8.up.hs$Victories)
av9.atup.hs<-sum(a9.up.hs$Victories)
av10.atup.hs<-sum(a10.up.hs$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.hs.atdu<-(sum(av1.atup.hs, av2.atup.hs, av3.atup.hs, av4.atup.hs, av5.atup.hs, av6.atup.hs, av7.atup.hs, av8.atup.hs, av9.atup.hs, av10.atup.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.atdu<-(sum(int1.atup.hs, int2.atup.hs, int3.atup.hs, int4.atup.hs, int5.atup.hs, int6.atup.hs, int7.atup.hs, int8.atup.hs, int9.atup.hs, int10.atup.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.hs<-e1.atup.hs[order(e1.atup.hs$ID),]
e1.atup.hs<-as.matrix(t(e1.1.atup.hs))

e2.atup.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.hs<-e2.atup.hs[order(e2.atup.hs$ID),]
e2.atup.hs<-as.matrix(t(e2.1.atup.hs))

e3.atup.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.hs<-e3.atup.hs[order(e3.atup.hs$ID),]
e3.atup.hs<-as.matrix(t(e3.1.atup.hs))

e4.atup.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.hs<-e4.atup.hs[order(e4.atup.hs$ID),]
e4.atup.hs<-as.matrix(t(e4.1.atup.hs))

e5.atup.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.hs<-e5.atup.hs[order(e5.atup.hs$ID),]
e5.atup.hs<-as.matrix(t(e5.1.atup.hs))

e6.atup.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.hs<-e6.atup.hs[order(e6.atup.hs$ID),]
e6.atup.hs<-as.matrix(t(e6.1.atup.hs))

e7.atup.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.hs<-e7.atup.hs[order(e7.atup.hs$ID),]
e7.atup.hs<-as.matrix(t(e7.1.atup.hs))

e8.atup.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.hs<-e8.atup.hs[order(e8.atup.hs$ID),]
e8.atup.hs<-as.matrix(t(e8.1.atup.hs))

e9.atup.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.hs<-e9.atup.hs[order(e9.atup.hs$ID),]
e9.atup.hs<-as.matrix(t(e9.1.atup.hs))

e10.atup.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.hs<-e10.atup.hs[order(e10.atup.hs$ID),]
e10.atup.hs<-as.matrix(t(e10.1.atup.hs))

energy.hs.atup.hs<-as.data.frame(matrix(c(e1.atup.hs,e2.atup.hs,e3.atup.hs,e4.atup.hs,e5.atup.hs,e6.atup.hs,e7.atup.hs,e8.atup.hs,e9.atup.hs,e10.atup.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.atup.hs<-data.frame(ID=energy.hs.atup.hs$V1,energy_over_distance=energy.hs.atup.hs$V2,energy_over_time=energy.hs.atup.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.hs<-david1.atup.hs[order(david1.atup.hs$ID),]
david1.atup.hs<-as.matrix(t(david1.1.atup.hs))

david2.1.atup.hs<-david2.atup.hs[order(david2.atup.hs$ID),]
david2.atup.hs<-as.matrix(t(david2.1.atup.hs))

david3.1.atup.hs<-david3.atup.hs[order(david3.atup.hs$ID),]
david3.atup.hs<-as.matrix(t(david3.1.atup.hs))

david4.1.atup.hs<-david4.atup.hs[order(david4.atup.hs$ID),]
david4.atup.hs<-as.matrix(t(david4.1.atup.hs))

david5.1.atup.hs<-david5.atup.hs[order(david5.atup.hs$ID),]
david5.atup.hs<-as.matrix(t(david5.1.atup.hs))

david6.1.atup.hs<-david6.atup.hs[order(david6.atup.hs$ID),]
david6.atup.hs<-as.matrix(t(david6.1.atup.hs))

david7.1.atup.hs<-david7.atup.hs[order(david7.atup.hs$ID),]
david7.atup.hs<-as.matrix(t(david7.1.atup.hs))

david8.1.atup.hs<-david8.atup.hs[order(david8.atup.hs$ID),]
david8.atup.hs<-as.matrix(t(david8.1.atup.hs))

david9.1.atup.hs<-david9.atup.hs[order(david9.atup.hs$ID),]
david9.atup.hs<-as.matrix(t(david9.1.atup.hs))

david10.1.atup.hs<-david10.atup.hs[order(david10.atup.hs$ID),]
david10.atup.hs<-as.matrix(t(david10.1.atup.hs))

david.hs.atup.hs<-as.data.frame(matrix(c(david1.atup.hs,david2.atup.hs,david3.atup.hs,david4.atup.hs,david5.atup.hs,david6.atup.hs,david7.atup.hs,david8.atup.hs,david9.atup.hs,david10.atup.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.atup.hs<-data.frame(ID=david.hs.atup.hs$V1,DS=david.hs.atup.hs$V2,normDS=david.hs.atup.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.atup.hs<-lm(e1.1.atup.hs$energy_over_time~as.numeric(david1.1.atup.hs$normDS))
hs.lm.1.s.atup.hs<-summary(lm.hs.1.atup.hs)$coefficients
hs.1.slope.atup.hs<-hs.lm.1.s.atup.hs[2,1]
lm.hs.2.atup.hs<-lm(e2.1.atup.hs$energy_over_time~as.numeric(david2.1.atup.hs$normDS))
hs.lm.2.s.atup.hs<-summary(lm.hs.2.atup.hs)$coefficients
hs.2.slope.atup.hs<-hs.lm.2.s.atup.hs[2,1]
lm.hs.3.atup.hs<-lm(e3.1.atup.hs$energy_over_time~as.numeric(david3.1.atup.hs$normDS))
hs.lm.3.s.atup.hs<-summary(lm.hs.3.atup.hs)$coefficients
hs.3.slope.atup.hs<-hs.lm.3.s.atup.hs[2,1]
lm.hs.4.atup.hs<-lm(e4.1.atup.hs$energy_over_time~as.numeric(david4.1.atup.hs$normDS))
hs.lm.4.s.atup.hs<-summary(lm.hs.4.atup.hs)$coefficients
hs.4.slope.atup.hs<-hs.lm.4.s.atup.hs[2,1]
lm.hs.5.atup.hs<-lm(e5.1.atup.hs$energy_over_time~as.numeric(david5.1.atup.hs$normDS))
hs.lm.5.s.atup.hs<-summary(lm.hs.5.atup.hs)$coefficients
hs.5.slope.atup.hs<-hs.lm.5.s.atup.hs[2,1]
lm.hs.6.atup.hs<-lm(e6.1.atup.hs$energy_over_time~as.numeric(david6.1.atup.hs$normDS))
hs.lm.6.s.atup.hs<-summary(lm.hs.6.atup.hs)$coefficients
hs.6.slope.atup.hs<-hs.lm.6.s.atup.hs[2,1]
lm.hs.7.atup.hs<-lm(e7.1.atup.hs$energy_over_time~as.numeric(david7.1.atup.hs$normDS))
hs.lm.7.s.atup.hs<-summary(lm.hs.7.atup.hs)$coefficients
hs.7.slope.atup.hs<-hs.lm.7.s.atup.hs[2,1]
lm.hs.8.atup.hs<-lm(e8.1.atup.hs$energy_over_time~as.numeric(david8.1.atup.hs$normDS))
hs.lm.8.s.atup.hs<-summary(lm.hs.8.atup.hs)$coefficients
hs.8.slope.atup.hs<-hs.lm.8.s.atup.hs[2,1]
lm.hs.9.atup.hs<-lm(e9.1.atup.hs$energy_over_time~as.numeric(david9.1.atup.hs$normDS))
hs.lm.9.s.atup.hs<-summary(lm.hs.9.atup.hs)$coefficients
hs.9.slope.atup.hs<-hs.lm.9.s.atup.hs[2,1]
lm.hs.10.atup.hs<-lm(e10.1.atup.hs$energy_over_time~as.numeric(david10.1.atup.hs$normDS))
hs.lm.10.s.atup.hs<-summary(lm.hs.10.atup.hs)$coefficients
hs.10.slope.atup.hs<-hs.lm.10.s.atup.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.atup.ss.attacks.atup.hs<-data.frame(triangle.transitivity=c(tri1.atup.hs,tri2.atup.hs,tri3.atup.hs,tri4.atup.hs,tri5.atup.hs,tri6.atup.hs,tri7.atup.hs,tri8.atup.hs,tri9.atup.hs,tri10.atup.hs),escalation=c(ep1.atup.hs,ep2.atup.hs,ep3.atup.hs,ep4.atup.hs,ep5.atup.hs,ep6.atup.hs,ep7.atup.hs,ep8.atup.hs,ep9.atup.hs,ep10.atup.hs),dci=c(dci1.atup.hs,dci2.atup.hs,dci3.atup.hs,dci4.atup.hs,dci5.atup.hs,dci6.atup.hs,dci7.atup.hs,dci8.atup.hs,dci9.atup.hs,dci10.atup.hs),steepness=c(s1.atup.hs,s2.atup.hs,s3.atup.hs,s4.atup.hs,s5.atup.hs,s6.atup.hs,s7.atup.hs,s8.atup.hs,s9.atup.hs,s10.atup.hs),slope=c(hs.1.slope.atup.hs,hs.2.slope.atup.hs,hs.3.slope.atup.hs,hs.4.slope.atup.hs,hs.5.slope.atup.hs,hs.6.slope.atup.hs,hs.7.slope.atup.hs,hs.8.slope.atup.hs,hs.9.slope.atup.hs,hs.10.slope.atup.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks.atup.ho<-sapply(files, read.csv)

# Generate attacks.atup.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atup.ho<-data.frame(X1=attacks.atup.ho[[1]],X2=attacks.atup.ho[[2]],Victories=attacks.atup.ho[[3]])
mat1.atup.ho<-inter.mat(mut1.atup.ho)
tri1.atup.ho<-tr.tri(mat1.atup.ho)
dci1.atup.ho<-DCindex(mat1.atup.ho)
mat1.atup.ho[is.na(mat1.atup.ho)] = 0
h1.atup.ho<-h.index(mat1.atup.ho)

ep1.atup.ho<-ep(mut1.atup.ho,a1.up.ho)
david1.atup.ho<-DS(mat1.atup.ho) #David's Scores - for steepness use normDS output
ordrank.1.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atup.ho<-cbind(ordrank.1.atup.ho,ds=david1.atup.ho$normDS)
lm1.atup.ho<-summary(lm(ordrank.1.atup.ho$ds~ordrank.1.atup.ho$ord.rank))
s1.atup.ho<-lm1.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atup.ho<-data.frame(X1=attacks.atup.ho[[4]],X2=attacks.atup.ho[[5]],Victories=attacks.atup.ho[[6]])
mat2.atup.ho<-inter.mat(mut2.atup.ho)
tri2.atup.ho<-tr.tri(mat2.atup.ho)
dci2.atup.ho<-DCindex(mat2.atup.ho)
mat2.atup.ho[is.na(mat2.atup.ho)] = 0
h2.atup.ho<-h.index(mat2.atup.ho)

ep2.atup.ho<-ep(mut2.atup.ho,a2.up.ho)
david2.atup.ho<-DS(mat2.atup.ho) #David's Scores - for steepness use normDS output
ordrank.2.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atup.ho<-cbind(ordrank.2.atup.ho,ds=david2.atup.ho$normDS)
lm2.atup.ho<-summary(lm(ordrank.2.atup.ho$ds~ordrank.2.atup.ho$ord.rank))
s2.atup.ho<-lm2.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atup.ho<-data.frame(X1=attacks.atup.ho[[7]],X2=attacks.atup.ho[[8]],Victories=attacks.atup.ho[[9]])
mat3.atup.ho<-inter.mat(mut3.atup.ho)
tri3.atup.ho<-tr.tri(mat3.atup.ho)
dci3.atup.ho<-DCindex(mat3.atup.ho)
mat3.atup.ho[is.na(mat3.atup.ho)] = 0
h3.atup.ho<-h.index(mat3.atup.ho)

ep3.atup.ho<-ep(mut3.atup.ho,a3.up.ho)
david3.atup.ho<-DS(mat3.atup.ho) #David's Scores - for steepness use normDS output
ordrank.3.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atup.ho<-cbind(ordrank.3.atup.ho,ds=david3.atup.ho$normDS)
lm3.atup.ho<-summary(lm(ordrank.3.atup.ho$ds~ordrank.3.atup.ho$ord.rank))
s3.atup.ho<-lm3.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atup.ho<-data.frame(X1=attacks.atup.ho[[10]],X2=attacks.atup.ho[[11]],Victories=attacks.atup.ho[[12]])
mat4.atup.ho<-inter.mat(mut4.atup.ho)
tri4.atup.ho<-tr.tri(mat4.atup.ho)
dci4.atup.ho<-DCindex(mat4.atup.ho)
mat4.atup.ho[is.na(mat4.atup.ho)] = 0
h4.atup.ho<-h.index(mat4.atup.ho)

ep4.atup.ho<-ep(mut4.atup.ho,a4.up.ho)
david4.atup.ho<-DS(mat4.atup.ho) #David's Scores - for steepness use normDS output
ordrank.4.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atup.ho<-cbind(ordrank.4.atup.ho,ds=david4.atup.ho$normDS)
lm4.atup.ho<-summary(lm(ordrank.4.atup.ho$ds~ordrank.4.atup.ho$ord.rank))
s4.atup.ho<-lm4.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atup.ho<-data.frame(X1=attacks.atup.ho[[13]],X2=attacks.atup.ho[[14]],Victories=attacks.atup.ho[[15]])
mat5.atup.ho<-inter.mat(mut5.atup.ho)
tri5.atup.ho<-tr.tri(mat5.atup.ho)
dci5.atup.ho<-DCindex(mat5.atup.ho)
mat5.atup.ho[is.na(mat5.atup.ho)] = 0
h5.atup.ho<-h.index(mat5.atup.ho)

ep5.atup.ho<-ep(mut5.atup.ho,a5.up.ho)
david5.atup.ho<-DS(mat5.atup.ho) #David's Scores - for steepness use normDS output
ordrank.5.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atup.ho<-cbind(ordrank.5.atup.ho,ds=david5.atup.ho$normDS)
lm5.atup.ho<-summary(lm(ordrank.5.atup.ho$ds~ordrank.5.atup.ho$ord.rank))
s5.atup.ho<-lm5.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atup.ho<-data.frame(X1=attacks.atup.ho[[16]],X2=attacks.atup.ho[[17]],Victories=attacks.atup.ho[[18]])
mat6.atup.ho<-inter.mat(mut6.atup.ho)
tri6.atup.ho<-tr.tri(mat6.atup.ho)
dci6.atup.ho<-DCindex(mat6.atup.ho)
mat6.atup.ho[is.na(mat6.atup.ho)] = 0
h6.atup.ho<-h.index(mat6.atup.ho)

ep6.atup.ho<-ep(mut6.atup.ho,a6.up.ho)
david6.atup.ho<-DS(mat6.atup.ho) #David's Scores - for steepness use normDS output
ordrank.6.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atup.ho<-cbind(ordrank.6.atup.ho,ds=david6.atup.ho$normDS)
lm6.atup.ho<-summary(lm(ordrank.6.atup.ho$ds~ordrank.6.atup.ho$ord.rank))
s6.atup.ho<-lm6.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atup.ho<-data.frame(X1=attacks.atup.ho[[19]],X2=attacks.atup.ho[[20]],Victories=attacks.atup.ho[[21]])
mat7.atup.ho<-inter.mat(mut7.atup.ho)
tri7.atup.ho<-tr.tri(mat7.atup.ho)
dci7.atup.ho<-DCindex(mat7.atup.ho)
mat7.atup.ho[is.na(mat7.atup.ho)] = 0
h7.atup.ho<-h.index(mat7.atup.ho)

ep7.atup.ho<-ep(mut7.atup.ho,a7.up.ho)
david7.atup.ho<-DS(mat7.atup.ho) #David's Scores - for steepness use normDS output
ordrank.7.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atup.ho<-cbind(ordrank.7.atup.ho,ds=david7.atup.ho$normDS)
lm7.atup.ho<-summary(lm(ordrank.7.atup.ho$ds~ordrank.7.atup.ho$ord.rank))
s7.atup.ho<-lm7.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atup.ho<-data.frame(X1=attacks.atup.ho[[22]],X2=attacks.atup.ho[[23]],Victories=attacks.atup.ho[[24]])
mat8.atup.ho<-inter.mat(mut8.atup.ho)
tri8.atup.ho<-tr.tri(mat8.atup.ho)
dci8.atup.ho<-DCindex(mat8.atup.ho)
mat8.atup.ho[is.na(mat8.atup.ho)] = 0
h8.atup.ho<-h.index(mat8.atup.ho)

ep8.atup.ho<-ep(mut8.atup.ho,a8.up.ho)
david8.atup.ho<-DS(mat8.atup.ho) #David's Scores - for steepness use normDS output
ordrank.8.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atup.ho<-cbind(ordrank.8.atup.ho,ds=david8.atup.ho$normDS)
lm8.atup.ho<-summary(lm(ordrank.8.atup.ho$ds~ordrank.8.atup.ho$ord.rank))
s8.atup.ho<-lm8.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atup.ho<-data.frame(X1=attacks.atup.ho[[25]],X2=attacks.atup.ho[[26]],Victories=attacks.atup.ho[[27]])
mat9.atup.ho<-inter.mat(mut9.atup.ho)
tri9.atup.ho<-tr.tri(mat9.atup.ho)
dci9.atup.ho<-DCindex(mat9.atup.ho)
mat9.atup.ho[is.na(mat9.atup.ho)] = 0
h9.atup.ho<-h.index(mat9.atup.ho)

ep9.atup.ho<-ep(mut9.atup.ho,a9.up.ho)
david9.atup.ho<-DS(mat9.atup.ho) #David's Scores - for steepness use normDS output
ordrank.9.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atup.ho<-cbind(ordrank.9.atup.ho,ds=david9.atup.ho$normDS)
lm9.atup.ho<-summary(lm(ordrank.9.atup.ho$ds~ordrank.9.atup.ho$ord.rank))
s9.atup.ho<-lm9.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atup.ho<-data.frame(X1=attacks.atup.ho[[28]],X2=attacks.atup.ho[[29]],Victories=attacks.atup.ho[[30]])
mat10.atup.ho<-inter.mat(mut10.atup.ho)
tri10.atup.ho<-tr.tri(mat10.atup.ho)
dci10.atup.ho<-DCindex(mat10.atup.ho)
mat10.atup.ho[is.na(mat10.atup.ho)] = 0
h10.atup.ho<-h.index(mat10.atup.ho)

ep10.atup.ho<-ep(mut10.atup.ho,a10.up.ho)
david10.atup.ho<-DS(mat10.atup.ho) #David's Scores - for steepness use normDS output
ordrank.10.atup.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atup.ho<-cbind(ordrank.10.atup.ho,ds=david10.atup.ho$normDS)
lm10.atup.ho<-summary(lm(ordrank.10.atup.ho$ds~ordrank.10.atup.ho$ord.rank))
s10.atup.ho<-lm10.atup.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atup.ho<-sum(mut1.atup.ho$Victories)
int2.atup.ho<-sum(mut2.atup.ho$Victories)
int3.atup.ho<-sum(mut3.atup.ho$Victories)
int4.atup.ho<-sum(mut4.atup.ho$Victories)
int5.atup.ho<-sum(mut5.atup.ho$Victories)
int6.atup.ho<-sum(mut6.atup.ho$Victories)
int7.atup.ho<-sum(mut7.atup.ho$Victories)
int8.atup.ho<-sum(mut8.atup.ho$Victories)
int9.atup.ho<-sum(mut9.atup.ho$Victories)
int10.atup.ho<-sum(mut10.atup.ho$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atup.ho<-sum(a1.up.ho$Victories)
av2.atup.ho<-sum(a2.up.ho$Victories)
av3.atup.ho<-sum(a3.up.ho$Victories)
av4.atup.ho<-sum(a4.up.ho$Victories)
av5.atup.ho<-sum(a5.up.ho$Victories)
av6.atup.ho<-sum(a6.up.ho$Victories)
av7.atup.ho<-sum(a7.up.ho$Victories)
av8.atup.ho<-sum(a8.up.ho$Victories)
av9.atup.ho<-sum(a9.up.ho$Victories)
av10.atup.ho<-sum(a10.up.ho$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ho.atdu<-(sum(av1.atup.ho, av2.atup.ho, av3.atup.ho, av4.atup.ho, av5.atup.ho, av6.atup.ho, av7.atup.ho, av8.atup.ho, av9.atup.ho, av10.atup.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.atdu<-(sum(int1.atup.ho, int2.atup.ho, int3.atup.ho, int4.atup.ho, int5.atup.ho, int6.atup.ho, int7.atup.ho, int8.atup.ho, int9.atup.ho, int10.atup.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atup.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atup.ho<-e1.atup.ho[order(e1.atup.ho$ID),]
e1.atup.ho<-as.matrix(t(e1.1.atup.ho))

e2.atup.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atup.ho<-e2.atup.ho[order(e2.atup.ho$ID),]
e2.atup.ho<-as.matrix(t(e2.1.atup.ho))

e3.atup.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atup.ho<-e3.atup.ho[order(e3.atup.ho$ID),]
e3.atup.ho<-as.matrix(t(e3.1.atup.ho))

e4.atup.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atup.ho<-e4.atup.ho[order(e4.atup.ho$ID),]
e4.atup.ho<-as.matrix(t(e4.1.atup.ho))

e5.atup.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atup.ho<-e5.atup.ho[order(e5.atup.ho$ID),]
e5.atup.ho<-as.matrix(t(e5.1.atup.ho))

e6.atup.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atup.ho<-e6.atup.ho[order(e6.atup.ho$ID),]
e6.atup.ho<-as.matrix(t(e6.1.atup.ho))

e7.atup.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atup.ho<-e7.atup.ho[order(e7.atup.ho$ID),]
e7.atup.ho<-as.matrix(t(e7.1.atup.ho))

e8.atup.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atup.ho<-e8.atup.ho[order(e8.atup.ho$ID),]
e8.atup.ho<-as.matrix(t(e8.1.atup.ho))

e9.atup.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atup.ho<-e9.atup.ho[order(e9.atup.ho$ID),]
e9.atup.ho<-as.matrix(t(e9.1.atup.ho))

e10.atup.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atup.ho<-e10.atup.ho[order(e10.atup.ho$ID),]
e10.atup.ho<-as.matrix(t(e10.1.atup.ho))

energy.ho.atup.ho<-as.data.frame(matrix(c(e1.atup.ho,e2.atup.ho,e3.atup.ho,e4.atup.ho,e5.atup.ho,e6.atup.ho,e7.atup.ho,e8.atup.ho,e9.atup.ho,e10.atup.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.atup.ho<-data.frame(ID=energy.ho.atup.ho$V1,energy_over_distance=energy.ho.atup.ho$V2,energy_over_time=energy.ho.atup.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atup.ho<-david1.atup.ho[order(david1.atup.ho$ID),]
david1.atup.ho<-as.matrix(t(david1.1.atup.ho))

david2.1.atup.ho<-david2.atup.ho[order(david2.atup.ho$ID),]
david2.atup.ho<-as.matrix(t(david2.1.atup.ho))

david3.1.atup.ho<-david3.atup.ho[order(david3.atup.ho$ID),]
david3.atup.ho<-as.matrix(t(david3.1.atup.ho))

david4.1.atup.ho<-david4.atup.ho[order(david4.atup.ho$ID),]
david4.atup.ho<-as.matrix(t(david4.1.atup.ho))

david5.1.atup.ho<-david5.atup.ho[order(david5.atup.ho$ID),]
david5.atup.ho<-as.matrix(t(david5.1.atup.ho))

david6.1.atup.ho<-david6.atup.ho[order(david6.atup.ho$ID),]
david6.atup.ho<-as.matrix(t(david6.1.atup.ho))

david7.1.atup.ho<-david7.atup.ho[order(david7.atup.ho$ID),]
david7.atup.ho<-as.matrix(t(david7.1.atup.ho))

david8.1.atup.ho<-david8.atup.ho[order(david8.atup.ho$ID),]
david8.atup.ho<-as.matrix(t(david8.1.atup.ho))

david9.1.atup.ho<-david9.atup.ho[order(david9.atup.ho$ID),]
david9.atup.ho<-as.matrix(t(david9.1.atup.ho))

david10.1.atup.ho<-david10.atup.ho[order(david10.atup.ho$ID),]
david10.atup.ho<-as.matrix(t(david10.1.atup.ho))

david.ho.atup.ho<-as.data.frame(matrix(c(david1.atup.ho,david2.atup.ho,david3.atup.ho,david4.atup.ho,david5.atup.ho,david6.atup.ho,david7.atup.ho,david8.atup.ho,david9.atup.ho,david10.atup.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.atup.ho<-data.frame(ID=david.ho.atup.ho$V1,DS=david.ho.atup.ho$V2,normDS=david.ho.atup.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.atup.ho<-lm(e1.1.atup.ho$energy_over_time~as.numeric(david1.1.atup.ho$normDS))
ho.lm.1.s.atup.ho<-summary(lm.ho.1.atup.ho)$coefficients
ho.1.slope.atup.ho<-ho.lm.1.s.atup.ho[2,1]
lm.ho.2.atup.ho<-lm(e2.1.atup.ho$energy_over_time~as.numeric(david2.1.atup.ho$normDS))
ho.lm.2.s.atup.ho<-summary(lm.ho.2.atup.ho)$coefficients
ho.2.slope.atup.ho<-ho.lm.2.s.atup.ho[2,1]
lm.ho.3.atup.ho<-lm(e3.1.atup.ho$energy_over_time~as.numeric(david3.1.atup.ho$normDS))
ho.lm.3.s.atup.ho<-summary(lm.ho.3.atup.ho)$coefficients
ho.3.slope.atup.ho<-ho.lm.3.s.atup.ho[2,1]
lm.ho.4.atup.ho<-lm(e4.1.atup.ho$energy_over_time~as.numeric(david4.1.atup.ho$normDS))
ho.lm.4.s.atup.ho<-summary(lm.ho.4.atup.ho)$coefficients
ho.4.slope.atup.ho<-ho.lm.4.s.atup.ho[2,1]
lm.ho.5.atup.ho<-lm(e5.1.atup.ho$energy_over_time~as.numeric(david5.1.atup.ho$normDS))
ho.lm.5.s.atup.ho<-summary(lm.ho.5.atup.ho)$coefficients
ho.5.slope.atup.ho<-ho.lm.5.s.atup.ho[2,1]
lm.ho.6.atup.ho<-lm(e6.1.atup.ho$energy_over_time~as.numeric(david6.1.atup.ho$normDS))
ho.lm.6.s.atup.ho<-summary(lm.ho.6.atup.ho)$coefficients
ho.6.slope.atup.ho<-ho.lm.6.s.atup.ho[2,1]
lm.ho.7.atup.ho<-lm(e7.1.atup.ho$energy_over_time~as.numeric(david7.1.atup.ho$normDS))
ho.lm.7.s.atup.ho<-summary(lm.ho.7.atup.ho)$coefficients
ho.7.slope.atup.ho<-ho.lm.7.s.atup.ho[2,1]
lm.ho.8.atup.ho<-lm(e8.1.atup.ho$energy_over_time~as.numeric(david8.1.atup.ho$normDS))
ho.lm.8.s.atup.ho<-summary(lm.ho.8.atup.ho)$coefficients
ho.8.slope.atup.ho<-ho.lm.8.s.atup.ho[2,1]
lm.ho.9.atup.ho<-lm(e9.1.atup.ho$energy_over_time~as.numeric(david9.1.atup.ho$normDS))
ho.lm.9.s.atup.ho<-summary(lm.ho.9.atup.ho)$coefficients
ho.9.slope.atup.ho<-ho.lm.9.s.atup.ho[2,1]
lm.ho.10.atup.ho<-lm(e10.1.atup.ho$energy_over_time~as.numeric(david10.1.atup.ho$normDS))
ho.lm.10.s.atup.ho<-summary(lm.ho.10.atup.ho)$coefficients
ho.10.slope.atup.ho<-ho.lm.10.s.atup.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.atup.ss.attacks.atup.ho<-data.frame(triangle.transitivity=c(tri1.atup.ho,tri2.atup.ho,tri3.atup.ho,tri4.atup.ho,tri5.atup.ho,tri6.atup.ho,tri7.atup.ho,tri8.atup.ho,tri9.atup.ho,tri10.atup.ho),escalation=c(ep1.atup.ho,ep2.atup.ho,ep3.atup.ho,ep4.atup.ho,ep5.atup.ho,ep6.atup.ho,ep7.atup.ho,ep8.atup.ho,ep9.atup.ho,ep10.atup.ho),dci=c(dci1.atup.ho,dci2.atup.ho,dci3.atup.ho,dci4.atup.ho,dci5.atup.ho,dci6.atup.ho,dci7.atup.ho,dci8.atup.ho,dci9.atup.ho,dci10.atup.ho),steepness=c(s1.atup.ho,s2.atup.ho,s3.atup.ho,s4.atup.ho,s5.atup.ho,s6.atup.ho,s7.atup.ho,s8.atup.ho,s9.atup.ho,s10.atup.ho),slope=c(ho.1.slope.atup.ho,ho.2.slope.atup.ho,ho.3.slope.atup.ho,ho.4.slope.atup.ho,ho.5.slope.atup.ho,ho.6.slope.atup.ho,ho.7.slope.atup.ho,ho.8.slope.atup.ho,ho.9.slope.atup.ho,ho.10.slope.atup.ho))
```
```{r attacks Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$dci)
km.esc.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$escalation)
km.steep.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$steepness)
km.slope.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$triangle.transitivity)
ks.atdui.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$dci)
ks.esc.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$escalation)
ks.steep.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$steepness)
ks.slope.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$slope)
ks.mean.atdu.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.atdu.attacks,dci=ks.atdui.atdu.attacks,esc=ks.esc.atdu.attacks,steepness=ks.steep.atdu.attacks,slope=ks.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$triangle.transitivity)
ko.atdui.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$dci)
ko.esc.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$escalation)
ko.steep.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$steepness)
ko.slope.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$slope)
ko.mean.atdu.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.atdu.attacks,dci=ko.atdui.atdu.attacks,esc=ko.esc.atdu.attacks,steepness=ko.steep.atdu.attacks,slope=ko.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$triangle.transitivity)
hs.atdui.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$dci)
hs.esc.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$escalation)
hs.steep.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$steepness)
hs.slope.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$slope)
hs.mean.atdu.attacks<-data.frame(scenario="History self",tt=hs.tt.atdu.attacks,dci=hs.atdui.atdu.attacks,esc=hs.esc.atdu.attacks,steepness=hs.steep.atdu.attacks,slope=hs.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$triangle.transitivity)
ho.atdui.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$dci)
ho.esc.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$escalation)
ho.steep.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$steepness)
ho.slope.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$slope)
ho.mean.atdu.attacks<-data.frame(scenario="History opponent",tt=ho.tt.atdu.attacks,dci=ho.atdui.atdu.attacks,esc=ho.esc.atdu.attacks,steepness=ho.steep.atdu.attacks,slope=ho.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,ks.mean.atdu.attacks,ko.mean.atdu.attacks,hm.mean.atdu.attacks,hs.mean.atdu.attacks,ho.mean.atdu.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$triangle.transitivity)
km.atdui.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$dci)
km.esc.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$escalation)
km.steep.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$steepness)
km.slope.atdu.attacks<-mean(km.atup.ss.attacks.atup.km$slope)
km.mean.atdu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atdu.attacks,dci=km.atdui.atdu.attacks,esc=km.esc.atdu.attacks,steepness=km.steep.atdu.attacks,slope=km.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$triangle.transitivity)
ks.atdui.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$dci)
ks.esc.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$escalation)
ks.steep.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$steepness)
ks.slope.atdu.attacks<-mean(ks.atup.ss.attacks.atup.ks$slope)
ks.mean.atdu.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.atdu.attacks,dci=ks.atdui.atdu.attacks,esc=ks.esc.atdu.attacks,steepness=ks.steep.atdu.attacks,slope=ks.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$triangle.transitivity)
ko.atdui.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$dci)
ko.esc.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$escalation)
ko.steep.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$steepness)
ko.slope.atdu.attacks<-mean(ko.atup.ss.attacks.atup.ko$slope)
ko.mean.atdu.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.atdu.attacks,dci=ko.atdui.atdu.attacks,esc=ko.esc.atdu.attacks,steepness=ko.steep.atdu.attacks,slope=ko.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$triangle.transitivity)
hm.atdui.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$dci)
hm.esc.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$escalation)
hm.steep.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$steepness)
hm.slope.atdu.attacks<-mean(hm.atup.ss.attacks.atup.hm$slope)
hm.mean.atdu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atdu.attacks,dci=hm.atdui.atdu.attacks,esc=hm.esc.atdu.attacks,steepness=hm.steep.atdu.attacks,slope=hm.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$triangle.transitivity)
hs.atdui.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$dci)
hs.esc.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$escalation)
hs.steep.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$steepness)
hs.slope.atdu.attacks<-mean(hs.atup.ss.attacks.atup.hs$slope)
hs.mean.atdu.attacks<-data.frame(scenario="History self",tt=hs.tt.atdu.attacks,dci=hs.atdui.atdu.attacks,esc=hs.esc.atdu.attacks,steepness=hs.steep.atdu.attacks,slope=hs.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$triangle.transitivity)
ho.atdui.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$dci)
ho.esc.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$escalation)
ho.steep.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$steepness)
ho.slope.atdu.attacks<-mean(ho.atup.ss.attacks.atup.ho$slope)
ho.mean.atdu.attacks<-data.frame(scenario="History opponent",tt=ho.tt.atdu.attacks,dci=ho.atdui.atdu.attacks,esc=ho.esc.atdu.attacks,steepness=ho.steep.atdu.attacks,slope=ho.slope.atdu.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atdu.attacks,ks.mean.atdu.attacks,ko.mean.atdu.attacks,hm.mean.atdu.attacks,hs.mean.atdu.attacks,ho.mean.atdu.attacks)

#create overall dataframe of summary statistics
overall.prob.unif.attacks<-data.frame(km.atup.ss.attacks.atup.km)
overall.prob.unif.attacks<-rbind(overall.prob.unif.attacks,ks.atup.ss.attacks.atup.ks)
overall.prob.unif.attacks<-rbind(overall.prob.unif.attacks,ko.atup.ss.attacks.atup.ko)
overall.prob.unif.attacks<-rbind(overall.prob.unif.attacks,hm.atup.ss.attacks.atup.hm)
overall.prob.unif.attacks<-rbind(overall.prob.unif.attacks,hs.atup.ss.attacks.atup.hs)
overall.prob.unif.attacks<-rbind(overall.prob.unif.attacks,ho.atup.ss.attacks.atup.ho)

overall.prob.unif.attacks<-cbind(overall.prob.unif.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.prob.unif.attacks<-cbind(overall.prob.unif.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.ss.attacks<-overall.prob.unif.attacks[overall.prob.unif.attacks$variable=="rhp",]
history.ss.attacks<-overall.prob.unif.attacks[overall.prob.unif.attacks$variable=="history",]

overall.prob.unif.attacks$combo<-paste(overall.prob.unif.attacks$strategy,overall.prob.unif.attacks$variable,overall.prob.unif.attacks$distribution)
overall.prob.unif.attacks$combo2<-paste(overall.prob.unif.attacks$strategy,overall.prob.unif.attacks$variable)
```

## Overall Data Frames
```{r Full Overall Probabilistic Data Frame}
# Generate single data frame for all of the Probabilistic data calculated in the previous chunks:

overall.ss.prob=rbind(overall.clump.prob,overall.unif.prob) #final overall data frame for all Probabilistic data

overall.prob.data<-overall.ss.prob[,1:8]

total.energy.pc<-cbind(total.energy.pc, distribution=(rep("clumped",600)))
total.energy.pu<-cbind(total.energy.pu, distribution=(rep("uniform",600)))
overall.energy<-rbind(total.energy.pc, total.energy.pu)

write.csv(overall.prob.data,"~/Desktop/Probabilistic_data_frame.csv",row.names=F) #.csv document of overall Probabilistic data frame for publication
```
```{r Full Clumped Probabilistic Avoid Data Frame}
# Generate single data frame for the clumped avoid data calculated in the previous chunks:

overall.ss.prob.clumped.avoid=rbind(overall.prob.clumped.avoid,overall.prob.unif.avoid)

overall.prob.clumped.avoid.data<-overall.ss.prob.clumped.avoid[,1:8]

write.csv(overall.prob.clumped.avoid.data,"~/Desktop/avoid_Probabilistic_data_frame.csv",row.names=F) #.csv document of avoids Probabilistic data frame for publication
```
```{r Full Clumped Probabilistic Attacks Data Frame}
# Generate single data frame for the clumped attacks data calculated in the previous chunks:

overall.ss.prob.clumped.attacks=rbind(overall.prob.clumped.attacks,overall.prob.unif.attacks)

overall.prob.clumped.attacks.data<-overall.ss.prob.clumped.attacks[,1:8]

write.csv(overall.prob.clumped.attacks.data,"~/Desktop/attacks_Probabilistic_data_frame.csv",row.names=F) #.csv document of attacks Probabilistic data frame for publication
```
```{r Full Uniform Probabilistic Avoid Data Frame}
# Generate single data frame for the uniform avoids data calculated in the previous chunks:

overall.ss.prob.uniform.avoid=rbind(overall.prob.clumped.avoid,overall.prob.unif.avoid)

overall.prob.uniform.avoid.data<-overall.ss.prob.uniform.avoid[,1:8]

write.csv(overall.prob.uniform.avoid.data,"~/Desktop/avoid_Probabilistic_data_frame.csv",row.names=F) #.csv document of avoid Probabilistic data frame for publication
```
```{r Full Uniform Probabilistic Attacks Data Frame}
# Generate single data frame for the uniform avoids data calculated in the previous chunks:

overall.ss.prob.uniform.attacks=rbind(overall.prob.clumped.attacks,overall.prob.unif.attacks)

overall.prob.uniform.attacks.data<-overall.ss.prob.uniform.attacks[,1:8]

write.csv(overall.prob.uniform.attacks.data,"~/Desktop/attacks_Probabilistic_data_frame.csv",row.names=F) #.csv document of attacks Probabilistic data frame for publication
```

## Energy Averages Summary Table For Publication
````{r Energy Averages Data Frame}
library(zoo)
library(dplyr)
n <- 100

# Generate data frame for all energy data from clumped scenarios:
sums.energy.pc<-rollapply(total.energy.pc$energy_over_time, width = n, mean, by = n)

# Generate data frame for all energy data from uniform scendarios:
sums.energy.pu<-rollapply(total.energy.pu$energy_over_time, width = n, mean, by = n)

# Generate data frame for averages of the energy data from the above 2 data frames:
energy.averages<-data.frame(Heterogenous=rollapply(total.energy.pc$energy_over_time, width = n, mean, by = n),Homogenous=rollapply(total.energy.pu$energy_over_time, width = n, mean, by = n))
energy.averages<-cbind(energy.averages,Scenario=c("Mutual Knowledge","Self Knowledge","Opponent Knowledge","Mutual History","Self History","Opponent History"))

order<-c("Self Knowledge","Self History","Opponent Knowledge","Opponent History","Mutual Knowledge","Mutual History")
energy.averages.final<-energy.averages %>%
                          slice(match(order, Scenario))

# Write a .csv file for the above averages data frame:
write.csv(energy.averages.final,"~/Desktop/energy.averages.p.csv")
```

## Attack Proportions Data
```{r Attack Proportions}
# The original attack proportion (escalation) data needed to be collected and uploaded from NetLogo. The below code organizes and analyses these data.

library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

# Read in the attack proportion data:
setwd("~/Documents/GitHub/primate-social-groups-model")
attack.prop.p<-read.csv("dominance_despotism_energy new results dec 22-table.csv")

attack.prop.2.p<-attack.prop.p[attack.prop.p$X=="probabilistic",]
attack.prop.2.p<-cbind(attack.prop.2.p, run.number=as.numeric(attack.prop.2.p$BehaviorSpace.results..NetLogo.6.2.2.))

attack.prop.2.p<-attack.prop.2.p[order(attack.prop.2.p$run.number),]
attack.prop.2.p<-attack.prop.2.p[,c(15,3:10,12)]
attack.prop.2.p<-cbind(attack.prop.2.p, rate.avoids=((as.numeric(attack.prop.2.p$X.7)/as.numeric(attack.prop.2.p$X.5))), rate.attacks=((as.numeric(attack.prop.2.p$X.6)/as.numeric(attack.prop.2.p$X.5))))


# Label each set of 10 trials by the Who variable (mutual, opponent, self) and the What variable (History, RHP):
attack.prop.2.p<-cbind(attack.prop.2.p,combo2=c(rep("mutual history",10),rep("self history",10),rep("opponent history",10),rep("mutual rhp",10),rep("self rhp",10),rep("opponent rhp",10)))
```

## Summary Tables For Publication
```{r}
#Subset attack proportions data into individual data frames based on the distribution type and assessment information.

dist.split.p <- split(attack.prop.2.p, attack.prop.2.p$X.1) #Splits attack proportions into separate data frames for "clumped" and "uniform" distributions (line 17)
new.pist <- c("clumped.attack.prop.p", "uniform.attack.prop.p")
for (i in 1:length(dist.split.p)) { #Variable "i" represents data by distribution
  assign(new.pist[i], dist.split.p[[i]]) #Assigns data to the named dataframes above (line 17)
}


clump.attack.prop.split.p <- split(clumped.attack.prop.p, clumped.attack.prop.p$combo2) #Splits attack proportions into separate data frames that occurred the "clumped" distribution based on assessment information (lines 21:26)
new.names.c.p <- c("hm.attack.prop.c.p",
                   "km.attack.prop.c.p",
                   "ho.attack.prop.c.p",
                   "ko.attack.prop.c.p",
                   "hs.attack.prop.c.p",
                   "ks.attack.prop.c.p")
uni.attack.prop.split.p <- split(uniform.attack.prop.p, uniform.attack.prop.p$combo2) #Splits attack proportions into separate data frames that occurred the "uniform" distribution based on assessment information (lines 28:33)
new.names.u.p <- c("hm.attack.prop.u.p", 
                   "km.attack.prop.u.p", 
                   "ho.attack.prop.u.p", 
                   "ko.attack.prop.u.p", 
                   "hs.attack.prop.u.p", 
                   "ks.attack.prop.u.p")
for (j in 1:length(clump.attack.prop.split.p)) { #Variable "j" represents data in the clumped distribution by assessment information
  for (k in 1:length(uni.attack.prop.split.p)) { #Variable "k" represents data in the uniform distribution by assessment information
        assign(new.names.c.p[j], clump.attack.prop.split.p[[j]]) #Assigns data to the named dataframes above (lines 21:26)
        assign(new.names.u.p[k], uni.attack.prop.split.p[[k]]) #Assigns data to the named dataframes above (lines 28:33)
  }
}
```

```{r Probabilistic Clumped Summary Table}
# Generate summary tables of the Probabilistic clumped data for publication:

# Knowledge mutual
km.st<-overall.ss.prob[overall.ss.prob$combo=="mutual rhp clumped",]
  km.tt<-mean(km.st$triangle.transitivity)
  km.dci<-mean(km.st$dci)
  
  km.poa<-mean(km.attack.prop.c.p$X.10)
  
  km.steep<-abs(mean(km.st$steepness))
  km.ov<-data.frame(Knowledge.Mutual = c(km.poa,km.dci,km.tt,km.steep,avg.int.km.pc,avg.av.km.pc))

# Knowledge self
ks.st<-overall.ss.prob[overall.ss.prob$combo=="self rhp clumped",]
  ks.tt<-mean(ks.st$triangle.transitivity)
  ks.dci<-mean(ks.st$dci)
  ks.poa<-mean(ks.attack.prop.c.p$X.10)
  ks.steep<-abs(mean(ks.st$steepness))
  ks.ov<-data.frame(Knowledge.Self = c(ks.poa,ks.dci,ks.tt,ks.steep,avg.int.ks.pc,avg.av.ks.pc))

# Knowledge opponent
ko.st<-overall.ss.prob[overall.ss.prob$combo=="opponent rhp clumped",]
  ko.tt<-mean(ko.st$triangle.transitivity)
  ko.dci<-mean(ko.st$dci)
  ko.poa<-mean(ko.attack.prop.c.p$X.10)
  ko.steep<-abs(mean(ko.st$steepness))
  ko.ov<-data.frame(Knowledge.Opponent = c(ko.poa,ko.dci,ko.tt,ko.steep,avg.int.ko.pc,avg.av.ko.pc))

# history mutual
hm.st<-overall.ss.prob[overall.ss.prob$combo=="mutual history clumped",]
  hm.tt<-mean(hm.st$triangle.transitivity)
  hm.dci<-mean(hm.st$dci)
  hm.poa<-mean(hm.attack.prop.c.p$X.10)
  hm.steep<-abs(mean(hm.st$steepness))
  hm.ov<-data.frame(History.Mutual = c(hm.poa,hm.dci,hm.tt,hm.steep,avg.int.hm.pc,avg.av.hm.pc))

# history self
hs.st<-overall.ss.prob[overall.ss.prob$combo=="self history clumped",]
  hs.tt<-mean(hs.st$triangle.transitivity)
  hs.dci<-mean(hs.st$dci)
  hs.poa<-mean(hs.attack.prop.c.p$X.10)
  hs.steep<-abs(mean(hs.st$steepness))
  hs.ov<-data.frame(History.Self = c(hs.poa,hs.dci,hs.tt,hs.steep,avg.int.hs.pc,avg.av.hs.pc))

# history opponent
ho.st<-overall.ss.prob[overall.ss.prob$combo=="opponent history clumped",]
  ho.tt<-mean(ho.st$triangle.transitivity)
  ho.dci<-mean(ho.st$dci)
  ho.poa<-mean(ho.attack.prop.c.p$X.10)
  ho.steep<-abs(mean(ho.st$steepness))
  ho.ov<-data.frame(History.Opponent = c(ho.poa,ho.dci,ho.tt,ho.steep,avg.int.ho.pc,avg.av.ho.pc))

# Generate overall data frame of the summary tables above:
overall.c.st<-data.frame(kno.mut=km.ov,hist.mut=hm.ov,kno.self=ks.ov,hist.self=hs.ov,kno.opp=ko.ov,hist.opp=ho.ov)
row.names(overall.c.st)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st,"~/Desktop/overall_summary_table_pc.csv")
```

```{r Probabilistic Uniform Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# Knowledge mutual
km.st.u<-overall.ss.prob[overall.ss.prob$combo=="mutual rhp Uniform",]
  km.tt.u<-mean(km.st.u$triangle.transitivity)
  km.dci.u<-mean(km.st.u$dci)
  km.poa.u<-mean(km.attack.prop.u.p$X.10)
  km.steep.u<-abs(mean(km.st.u$steepness))
  km.ov.u<-data.frame(Knowledge.Mutual = c(km.poa.u,km.dci.u,km.tt.u,km.steep.u,avg.int.km.pu,avg.av.km.pu))

# Knowledge self  
ks.st.u<-overall.ss.prob[overall.ss.prob$combo=="self rhp Uniform",]
  ks.tt.u<-mean(ks.st.u$triangle.transitivity)
  ks.dci.u<-mean(ks.st.u$dci)
  ks.poa.u<-mean(ks.attack.prop.u.p$X.10)
  ks.steep.u<-abs(mean(ks.st.u$steepness))
  ks.ov.u<-data.frame(Knowledge.Self = c(ks.poa.u,ks.dci.u,ks.tt.u,ks.steep.u,avg.int.ks.pu,avg.av.ks.pu))

# Knowledge opponent
ko.st.u<-overall.ss.prob[overall.ss.prob$combo=="opponent rhp Uniform",]
  ko.tt.u<-mean(ko.st.u$triangle.transitivity)
  ko.dci.u<-mean(ko.st.u$dci)
  ko.poa.u<-mean(ko.attack.prop.u.p$X.10)
  ko.steep.u<-abs(mean(ko.st.u$steepness))
  ko.ov.u<-data.frame(Knowledge.Opponent = c(ko.poa.u,ko.dci.u,ko.tt.u,ko.steep.u,avg.int.ko.pu,avg.av.ko.pu))

# History mutual
hm.st.u<-overall.ss.prob[overall.ss.prob$combo=="mutual history Uniform",]
  hm.tt.u<-mean(hm.st.u$triangle.transitivity)
  hm.dci.u<-mean(hm.st.u$dci)
  hm.poa.u<-mean(hm.attack.prop.u.p$X.10)
  hm.steep.u<-abs(mean(hm.st.u$steepness))
  hm.ov.u<-data.frame(History.Mutual = c(hm.poa.u,hm.dci.u,hm.tt.u,hm.steep.u,avg.int.hm.pu,avg.av.hm.pu))

# History self
hs.st.u<-overall.ss.prob[overall.ss.prob$combo=="self history Uniform",]
  hs.tt.u<-mean(hs.st.u$triangle.transitivity)
  hs.dci.u<-mean(hs.st.u$dci)
  hs.poa.u<-mean(hs.attack.prop.u.p$X.10)
  hs.steep.u<-abs(mean(hs.st.u$steepness))
  hs.ov.u<-data.frame(History.Self = c(hs.poa.u,hs.dci.u,hs.tt.u,hs.steep.u,avg.int.hs.pu,avg.av.hs.pu))

# History opponent
ho.st.u<-overall.ss.prob[overall.ss.prob$combo=="opponent history Uniform",]
  ho.tt.u<-mean(ho.st.u$triangle.transitivity)
  ho.dci.u<-mean(ho.st.u$dci)
  ho.poa.u<-mean(ho.attack.prop.u.p$X.10)
  ho.steep.u<-abs(mean(ho.st.u$steepness))
  ho.ov.u<-data.frame(History.Opponent = c(ho.poa.u,ho.dci.u,ho.tt.u,ho.steep.u,avg.int.ho.pu,avg.av.ho.pu))

# Generate overall data frame of the summary tables above:
overall.c.st.u<-data.frame(kno.mut=km.ov.u,hist.mut=hm.ov.u,kno.self=ks.ov.u,hist.self=hs.ov.u,kno.opp=ko.ov.u,hist.opp=ho.ov.u)
row.names(overall.c.st.u)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.u,"~/Desktop/overall_summary_table_pu.csv")
```

```{r Probabilistic Clumped Avoid Summary Table}
# Generate summary tables of the Probabilistic clumped avoid data for publication:

# Knowledge mutual
km.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="mutual rhp clumped",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.dci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.attack.prop.c.p$rate.avoids)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.dci.avoid,km.tt.avoid,km..steep.avoid,avg.int.km.acp,avg.av.km.acp))

# Knowledge self  
ks.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="self rhp clumped",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.dci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.attack.prop.c.p$rate.avoids)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.dci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.ks.acp,avg.av.ks.acp))

# Knowledge opponent
ko.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="opponent rhp clumped",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.dci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.attack.prop.c.p$rate.avoids)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.dci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.ko.acp,avg.av.ko.acp))

# History mutual
hm.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="mutual history clumped",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.dci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.attack.prop.c.p$rate.avoids)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.dci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.hm.acp,avg.av.km.acp))

# History self
hs.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="self history clumped",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.dci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.attack.prop.c.p$rate.avoids)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.dci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.hs.acp,avg.av.hs.acp))

# History opponent
ho.st.avoid<-overall.ss.prob.clumped.avoid[overall.ss.prob.clumped.avoid$combo=="opponent history clumped",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.dci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.attack.prop.c.p$rate.avoids)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.dci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.ho.acp,avg.av.ho.acp))

# Generate overall data frame of the summary tables above:
overall.c.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.c.st.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.avoid,"~/Desktop/overall_clump_avoid_summary_table_pc.csv")
```

```{r Probabilistic Clumped Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# Knowledge mutual
km.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="mutual rhp clumped",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.dci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.attack.prop.c.p$rate.attacks)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.dci.attacks,km.tt.attacks,km..steep.attacks,avg.int.km.acp,avg.av.km.acp))

# Knowledge self  
ks.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="self rhp clumped",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.dci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.attack.prop.c.p$rate.attacks)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.dci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.ks.acp,avg.av.ks.acp))

# Knowledge opponent
ko.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="opponent rhp clumped",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.dci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.attack.prop.c.p$rate.attacks)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.dci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.ko.acp,avg.av.ko.acp))

# History mutual
hm.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="mutual history clumped",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.dci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.attack.prop.c.p$rate.attacks)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.dci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.hm.acp,avg.av.hm.acp))

# History self
hs.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="self history clumped",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.dci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.attack.prop.c.p$rate.attacks)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.dci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.hs.acp,avg.av.hs.acp))

# History opponent
ho.st.attacks<-overall.ss.prob.clumped.attacks[overall.ss.prob.clumped.attacks$combo=="opponent history clumped",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.dci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.attack.prop.c.p$rate.attacks)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.dci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.ho.acp,avg.av.ho.acp))

# Generate overall data frame of the summary tables above:
overall.c.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.c.st.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks","Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.attacks,"~/Desktop/overall_clump_attacks_summary_table_pc.csv")
```

```{r Probabilistic Uniform Avoid Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

#Knowledge mutual
km.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="mutual rhp Uniform",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.dci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.attack.prop.u.p$rate.avoids)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.dci.avoid,km.tt.avoid,km..steep.avoid,avg.int.km.adu,avg.av.km.adu))

# Knowledge self 
ks.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="self rhp Uniform",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.dci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.attack.prop.u.p$rate.avoids)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.dci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.ks.adu,avg.av.ks.adu))

# Knowledge opponent
ko.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="opponent rhp Uniform",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.dci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.attack.prop.u.p$rate.avoids)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.dci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.ko.adu,avg.av.ko.adu))

# History mutual
hm.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="mutual history Uniform",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.dci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.attack.prop.u.p$rate.avoids)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.dci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.hm.adu,avg.av.hm.adu))

# History self
hs.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="self history Uniform",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.dci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.attack.prop.u.p$rate.avoids)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.dci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.hs.adu,avg.av.hs.adu))

# History opponent
ho.st.avoid<-overall.ss.prob.uniform.avoid[overall.ss.prob.uniform.avoid$combo=="opponent history Uniform",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.dci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.attack.prop.u.p$rate.avoids)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.dci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.ho.adu,avg.av.ho.adu))

# Generate overall data frame of the summary tables above:
overall.u.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.u.st.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.avoid,"~/Desktop/overall_uniform_avoid_summary_table_pc.csv")
```

```{r Probabilistic Uniform Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

#knowledge mutual
km.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="mutual rhp Uniform",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.dci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.attack.prop.u.p$rate.attacks)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.dci.attacks,km.tt.attacks,km..steep.attacks,avg.int.km.atdu,avg.av.km.atdu))

# Knowledge self  
ks.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="self rhp Uniform",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.dci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.attack.prop.u.p$rate.attacks)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.dci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.ks.atdu,avg.av.ks.atdu))

# Knowledge opponent
ko.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="opponent rhp Uniform",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.dci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.attack.prop.u.p$rate.attacks)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.dci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.ko.atdu,avg.av.ko.atdu))

# History mutual
hm.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="mutual history Uniform",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.dci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.attack.prop.u.p$rate.attacks)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.dci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.hm.atdu,avg.av.hm.atdu))

# History self
hs.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="self history Uniform",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.dci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.attack.prop.u.p$rate.attacks)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.dci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.hs.atdu,avg.av.hs.atdu))

# History opponent
ho.st.attacks<-overall.ss.prob.uniform.attacks[overall.ss.prob.uniform.attacks$combo=="opponent history Uniform",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.dci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.attack.prop.u.p$rate.attacks)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.dci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.ho.atdu,avg.av.ho.atdu))

# Generate overall data frame of the summary tables above:
overall.u.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.u.st.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.attacks,"~/Desktop/overall_uniform_attacks_summary_table_pc.csv")
```


## Clumped Initiator Wins Probabilistic Data
```{r Clumped Initiator Wins Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.km<-data.frame(X1=avoid.ci.p.km[[1]],X2=avoid.ci.p.km[[2]],Avoids=avoid.ci.p.km[[3]])
a2.ci.p.km<-data.frame(X1=avoid.ci.p.km[[4]],X2=avoid.ci.p.km[[5]],Avoids=avoid.ci.p.km[[6]])
a3.ci.p.km<-data.frame(X1=avoid.ci.p.km[[7]],X2=avoid.ci.p.km[[8]],Avoids=avoid.ci.p.km[[9]])
a4.ci.p.km<-data.frame(X1=avoid.ci.p.km[[10]],X2=avoid.ci.p.km[[11]],Avoids=avoid.ci.p.km[[12]])
a5.ci.p.km<-data.frame(X1=avoid.ci.p.km[[13]],X2=avoid.ci.p.km[[14]],Avoids=avoid.ci.p.km[[15]])
a6.ci.p.km<-data.frame(X1=avoid.ci.p.km[[16]],X2=avoid.ci.p.km[[17]],Avoids=avoid.ci.p.km[[18]])
a7.ci.p.km<-data.frame(X1=avoid.ci.p.km[[19]],X2=avoid.ci.p.km[[20]],Avoids=avoid.ci.p.km[[21]])
a8.ci.p.km<-data.frame(X1=avoid.ci.p.km[[22]],X2=avoid.ci.p.km[[23]],Avoids=avoid.ci.p.km[[24]])
a9.ci.p.km<-data.frame(X1=avoid.ci.p.km[[25]],X2=avoid.ci.p.km[[26]],Avoids=avoid.ci.p.km[[27]])
a10.ci.p.km<-data.frame(X1=avoid.ci.p.km[[28]],X2=avoid.ci.p.km[[29]],Avoids=avoid.ci.p.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.km.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.km<-data.frame(X1=conflict.km.ci.p[[1]],X2=conflict.km.ci.p[[2]],Victories=conflict.km.ci.p[[3]])
mat1.ci.p.km<-inter.mat(mut1.ci.p.km)
tri1.ci.p.km<-tr.tri(mat1.ci.p.km)
dci1.ci.p.km<-DCindex(mat1.ci.p.km)
mat1.ci.p.km[is.na(mat1.ci.p.km)] = 0
h1.ci.p.km<-h.index(mat1.ci.p.km)

ep1.ci.p.km<-ep(mut1.ci.p.km,a1.ci.p.km)
david1.ci.p.km<-DS(mat1.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.km<-cbind(ordrank.1.ci.p.km,ds=david1.ci.p.km$normDS)
lm1.ci.p.km<-summary(lm(ordrank.1.ci.p.km$ds~ordrank.1.ci.p.km$ord.rank))
s1.ci.p.km<-lm1.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.km<-data.frame(X1=conflict.km.ci.p[[4]],X2=conflict.km.ci.p[[5]],Victories=conflict.km.ci.p[[6]])
mat2.ci.p.km<-inter.mat(mut2.ci.p.km)
tri2.ci.p.km<-tr.tri(mat2.ci.p.km)
dci2.ci.p.km<-DCindex(mat2.ci.p.km)
mat2.ci.p.km[is.na(mat2.ci.p.km)] = 0
h2.ci.p.km<-h.index(mat2.ci.p.km)

ep2.ci.p.km<-ep(mut2.ci.p.km,a2.ci.p.km)
david2.ci.p.km<-DS(mat2.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.km<-cbind(ordrank.2.ci.p.km,ds=david2.ci.p.km$normDS)
lm2.ci.p.km<-summary(lm(ordrank.2.ci.p.km$ds~ordrank.2.ci.p.km$ord.rank))
s2.ci.p.km<-lm2.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.km<-data.frame(X1=conflict.km.ci.p[[7]],X2=conflict.km.ci.p[[8]],Victories=conflict.km.ci.p[[9]])
mat3.ci.p.km<-inter.mat(mut3.ci.p.km)
tri3.ci.p.km<-tr.tri(mat3.ci.p.km)
dci3.ci.p.km<-DCindex(mat3.ci.p.km)
mat3.ci.p.km[is.na(mat3.ci.p.km)] = 0
h3.ci.p.km<-h.index(mat3.ci.p.km)

ep3.ci.p.km<-ep(mut3.ci.p.km,a3.ci.p.km)
david3.ci.p.km<-DS(mat3.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.km<-cbind(ordrank.3.ci.p.km,ds=david3.ci.p.km$normDS)
lm3.ci.p.km<-summary(lm(ordrank.3.ci.p.km$ds~ordrank.3.ci.p.km$ord.rank))
s3.ci.p.km<-lm3.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.km<-data.frame(X1=conflict.km.ci.p[[10]],X2=conflict.km.ci.p[[11]],Victories=conflict.km.ci.p[[12]])
mat4.ci.p.km<-inter.mat(mut4.ci.p.km)
tri4.ci.p.km<-tr.tri(mat4.ci.p.km)
dci4.ci.p.km<-DCindex(mat4.ci.p.km)
mat4.ci.p.km[is.na(mat4.ci.p.km)] = 0
h4.ci.p.km<-h.index(mat4.ci.p.km)

ep4.ci.p.km<-ep(mut4.ci.p.km,a4.ci.p.km)
david4.ci.p.km<-DS(mat4.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.km<-cbind(ordrank.4.ci.p.km,ds=david4.ci.p.km$normDS)
lm4.ci.p.km<-summary(lm(ordrank.4.ci.p.km$ds~ordrank.4.ci.p.km$ord.rank))
s4.ci.p.km<-lm4.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.km<-data.frame(X1=conflict.km.ci.p[[13]],X2=conflict.km.ci.p[[14]],Victories=conflict.km.ci.p[[15]])
mat5.ci.p.km<-inter.mat(mut5.ci.p.km)
tri5.ci.p.km<-tr.tri(mat5.ci.p.km)
dci5.ci.p.km<-DCindex(mat5.ci.p.km)
mat5.ci.p.km[is.na(mat5.ci.p.km)] = 0
h5.ci.p.km<-h.index(mat5.ci.p.km)

ep5.ci.p.km<-ep(mut5.ci.p.km,a5.ci.p.km)
david5.ci.p.km<-DS(mat5.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.km<-cbind(ordrank.5.ci.p.km,ds=david5.ci.p.km$normDS)
lm5.ci.p.km<-summary(lm(ordrank.5.ci.p.km$ds~ordrank.5.ci.p.km$ord.rank))
s5.ci.p.km<-lm5.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.km<-data.frame(X1=conflict.km.ci.p[[16]],X2=conflict.km.ci.p[[17]],Victories=conflict.km.ci.p[[18]])
mat6.ci.p.km<-inter.mat(mut6.ci.p.km)
tri6.ci.p.km<-tr.tri(mat6.ci.p.km)
dci6.ci.p.km<-DCindex(mat6.ci.p.km)
mat6.ci.p.km[is.na(mat6.ci.p.km)] = 0
h6.ci.p.km<-h.index(mat6.ci.p.km)

ep6.ci.p.km<-ep(mut6.ci.p.km,a6.ci.p.km)
david6.ci.p.km<-DS(mat6.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.km<-cbind(ordrank.6.ci.p.km,ds=david6.ci.p.km$normDS)
lm6.ci.p.km<-summary(lm(ordrank.6.ci.p.km$ds~ordrank.6.ci.p.km$ord.rank))
s6.ci.p.km<-lm6.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.km<-data.frame(X1=conflict.km.ci.p[[19]],X2=conflict.km.ci.p[[20]],Victories=conflict.km.ci.p[[21]])
mat7.ci.p.km<-inter.mat(mut7.ci.p.km)
tri7.ci.p.km<-tr.tri(mat7.ci.p.km)
dci7.ci.p.km<-DCindex(mat7.ci.p.km)
mat7.ci.p.km[is.na(mat7.ci.p.km)] = 0
h7.ci.p.km<-h.index(mat7.ci.p.km)

ep7.ci.p.km<-ep(mut7.ci.p.km,a7.ci.p.km)
david7.ci.p.km<-DS(mat7.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.km<-cbind(ordrank.7.ci.p.km,ds=david7.ci.p.km$normDS)
lm7.ci.p.km<-summary(lm(ordrank.7.ci.p.km$ds~ordrank.7.ci.p.km$ord.rank))
s7.ci.p.km<-lm7.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.km<-data.frame(X1=conflict.km.ci.p[[22]],X2=conflict.km.ci.p[[23]],Victories=conflict.km.ci.p[[24]])
mat8.ci.p.km<-inter.mat(mut8.ci.p.km)
tri8.ci.p.km<-tr.tri(mat8.ci.p.km)
dci8.ci.p.km<-DCindex(mat8.ci.p.km)
mat8.ci.p.km[is.na(mat8.ci.p.km)] = 0
h8.ci.p.km<-h.index(mat8.ci.p.km)

ep8.ci.p.km<-ep(mut8.ci.p.km,a8.ci.p.km)
david8.ci.p.km<-DS(mat8.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.km<-cbind(ordrank.8.ci.p.km,ds=david8.ci.p.km$normDS)
lm8.ci.p.km<-summary(lm(ordrank.8.ci.p.km$ds~ordrank.8.ci.p.km$ord.rank))
s8.ci.p.km<-lm8.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.km<-data.frame(X1=conflict.km.ci.p[[25]],X2=conflict.km.ci.p[[26]],Victories=conflict.km.ci.p[[27]])
mat9.ci.p.km<-inter.mat(mut9.ci.p.km)
tri9.ci.p.km<-tr.tri(mat9.ci.p.km)
dci9.ci.p.km<-DCindex(mat9.ci.p.km)
mat9.ci.p.km[is.na(mat9.ci.p.km)] = 0
h9.ci.p.km<-h.index(mat9.ci.p.km)

ep9.ci.p.km<-ep(mut9.ci.p.km,a9.ci.p.km)
david9.ci.p.km<-DS(mat9.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.km<-cbind(ordrank.9.ci.p.km,ds=david9.ci.p.km$normDS)
lm9.ci.p.km<-summary(lm(ordrank.9.ci.p.km$ds~ordrank.9.ci.p.km$ord.rank))
s9.ci.p.km<-lm9.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.km<-data.frame(X1=conflict.km.ci.p[[28]],X2=conflict.km.ci.p[[29]],Victories=conflict.km.ci.p[[30]])
mat10.ci.p.km<-inter.mat(mut10.ci.p.km)
tri10.ci.p.km<-tr.tri(mat10.ci.p.km)
dci10.ci.p.km<-DCindex(mat10.ci.p.km)
mat10.ci.p.km[is.na(mat10.ci.p.km)] = 0
h10.ci.p.km<-h.index(mat10.ci.p.km)

ep10.ci.p.km<-ep(mut10.ci.p.km,a10.ci.p.km)
david10.ci.p.km<-DS(mat10.ci.p.km) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.km<-cbind(ordrank.10.ci.p.km,ds=david10.ci.p.km$normDS)
lm10.ci.p.km<-summary(lm(ordrank.10.ci.p.km$ds~ordrank.10.ci.p.km$ord.rank))
s10.ci.p.km<-lm10.ci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.km<-sum(mut1.ci.p.km$Victories)
int2.ci.p.km<-sum(mut2.ci.p.km$Victories)
int3.ci.p.km<-sum(mut3.ci.p.km$Victories)
int4.ci.p.km<-sum(mut4.ci.p.km$Victories)
int5.ci.p.km<-sum(mut5.ci.p.km$Victories)
int6.ci.p.km<-sum(mut6.ci.p.km$Victories)
int7.ci.p.km<-sum(mut7.ci.p.km$Victories)
int8.ci.p.km<-sum(mut8.ci.p.km$Victories)
int9.ci.p.km<-sum(mut9.ci.p.km$Victories)
int10.ci.p.km<-sum(mut10.ci.p.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.km<-sum(a1.ci.p.km$Victories)
av2.ci.p.km<-sum(a2.ci.p.km$Victories)
av3.ci.p.km<-sum(a3.ci.p.km$Victories)
av4.ci.p.km<-sum(a4.ci.p.km$Victories)
av5.ci.p.km<-sum(a5.ci.p.km$Victories)
av6.ci.p.km<-sum(a6.ci.p.km$Victories)
av7.ci.p.km<-sum(a7.ci.p.km$Victories)
av8.ci.p.km<-sum(a8.ci.p.km$Victories)
av9.ci.p.km<-sum(a9.ci.p.km$Victories)
av10.ci.p.km<-sum(a10.ci.p.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.ic.p<-(sum(av1.ci.p.km, av2.ci.p.km, av3.ci.p.km, av4.ci.p.km, av5.ci.p.km, av6.ci.p.km, av7.ci.p.km, av8.ci.p.km, av9.ci.p.km, av10.ci.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.ic.p<-(sum(int1.ci.p.km, int2.ci.p.km, int3.ci.p.km, int4.ci.p.km, int5.ci.p.km, int6.ci.p.km, int7.ci.p.km, int8.ci.p.km, int9.ci.p.km, int10.ci.p.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.km<-e1.ci.p.km[order(e1.ci.p.km$ID),]
e1.ci.p.km<-as.matrix(t(e1.1.ci.p.km))

e2.ci.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.km<-e2.ci.p.km[order(e2.ci.p.km$ID),]
e2.ci.p.km<-as.matrix(t(e2.1.ci.p.km))

e3.ci.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.km<-e3.ci.p.km[order(e3.ci.p.km$ID),]
e3.ci.p.km<-as.matrix(t(e3.1.ci.p.km))

e4.ci.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.km<-e4.ci.p.km[order(e4.ci.p.km$ID),]
e4.ci.p.km<-as.matrix(t(e4.1.ci.p.km))

e5.ci.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.km<-e5.ci.p.km[order(e5.ci.p.km$ID),]
e5.ci.p.km<-as.matrix(t(e5.1.ci.p.km))

e6.ci.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.km<-e6.ci.p.km[order(e6.ci.p.km$ID),]
e6.ci.p.km<-as.matrix(t(e6.1.ci.p.km))

e7.ci.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.km<-e7.ci.p.km[order(e7.ci.p.km$ID),]
e7.ci.p.km<-as.matrix(t(e7.1.ci.p.km))

e8.ci.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.km<-e8.ci.p.km[order(e8.ci.p.km$ID),]
e8.ci.p.km<-as.matrix(t(e8.1.ci.p.km))

e9.ci.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.km<-e9.ci.p.km[order(e9.ci.p.km$ID),]
e9.ci.p.km<-as.matrix(t(e9.1.ci.p.km))

e10.ci.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.km<-e10.ci.p.km[order(e10.ci.p.km$ID),]
e10.ci.p.km<-as.matrix(t(e10.1.ci.p.km))

energy.km.ci.p.km<-as.data.frame(matrix(c(e1.ci.p.km,e2.ci.p.km,e3.ci.p.km,e4.ci.p.km,e5.ci.p.km,e6.ci.p.km,e7.ci.p.km,e8.ci.p.km,e9.ci.p.km,e10.ci.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.ci.p.km<-data.frame(ID=energy.km.ci.p.km$V1,energy_over_distance=energy.km.ci.p.km$V2,energy_over_time=energy.km.ci.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.km<-david1.ci.p.km[order(david1.ci.p.km$ID),]
david1.ci.p.km<-as.matrix(t(david1.1.ci.p.km))

david2.1.ci.p.km<-david2.ci.p.km[order(david2.ci.p.km$ID),]
david2.ci.p.km<-as.matrix(t(david2.1.ci.p.km))

david3.1.ci.p.km<-david3.ci.p.km[order(david3.ci.p.km$ID),]
david3.ci.p.km<-as.matrix(t(david3.1.ci.p.km))

david4.1.ci.p.km<-david4.ci.p.km[order(david4.ci.p.km$ID),]
david4.ci.p.km<-as.matrix(t(david4.1.ci.p.km))

david5.1.ci.p.km<-david5.ci.p.km[order(david5.ci.p.km$ID),]
david5.ci.p.km<-as.matrix(t(david5.1.ci.p.km))

david6.1.ci.p.km<-david6.ci.p.km[order(david6.ci.p.km$ID),]
david6.ci.p.km<-as.matrix(t(david6.1.ci.p.km))

david7.1.ci.p.km<-david7.ci.p.km[order(david7.ci.p.km$ID),]
david7.ci.p.km<-as.matrix(t(david7.1.ci.p.km))

david8.1.ci.p.km<-david8.ci.p.km[order(david8.ci.p.km$ID),]
david8.ci.p.km<-as.matrix(t(david8.1.ci.p.km))

david9.1.ci.p.km<-david9.ci.p.km[order(david9.ci.p.km$ID),]
david9.ci.p.km<-as.matrix(t(david9.1.ci.p.km))

david10.1.ci.p.km<-david10.ci.p.km[order(david10.ci.p.km$ID),]
david10.ci.p.km<-as.matrix(t(david10.1.ci.p.km))

david.km.ci.p.km<-as.data.frame(matrix(c(david1.ci.p.km,david2.ci.p.km,david3.ci.p.km,david4.ci.p.km,david5.ci.p.km,david6.ci.p.km,david7.ci.p.km,david8.ci.p.km,david9.ci.p.km,david10.ci.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.ci.p.km<-data.frame(ID=david.km.ci.p.km$V1,DS=david.km.ci.p.km$V2,normDS=david.km.ci.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.ci.p.km<-lm(e1.1.ci.p.km$energy_over_time~as.numeric(david1.1.ci.p.km$normDS))
km.lm.1.s.ci.p.km<-summary(lm.km.1.ci.p.km)$coefficients
km.1.slope.ci.p.km<-km.lm.1.s.ci.p.km[2,1]
lm.km.2.ci.p.km<-lm(e2.1.ci.p.km$energy_over_time~as.numeric(david2.1.ci.p.km$normDS))
km.lm.2.s.ci.p.km<-summary(lm.km.2.ci.p.km)$coefficients
km.2.slope.ci.p.km<-km.lm.2.s.ci.p.km[2,1]
lm.km.3.ci.p.km<-lm(e3.1.ci.p.km$energy_over_time~as.numeric(david3.1.ci.p.km$normDS))
km.lm.3.s.ci.p.km<-summary(lm.km.3.ci.p.km)$coefficients
km.3.slope.ci.p.km<-km.lm.3.s.ci.p.km[2,1]
lm.km.4.ci.p.km<-lm(e4.1.ci.p.km$energy_over_time~as.numeric(david4.1.ci.p.km$normDS))
km.lm.4.s.ci.p.km<-summary(lm.km.4.ci.p.km)$coefficients
km.4.slope.ci.p.km<-km.lm.4.s.ci.p.km[2,1]
lm.km.5.ci.p.km<-lm(e5.1.ci.p.km$energy_over_time~as.numeric(david5.1.ci.p.km$normDS))
km.lm.5.s.ci.p.km<-summary(lm.km.5.ci.p.km)$coefficients
km.5.slope.ci.p.km<-km.lm.5.s.ci.p.km[2,1]
lm.km.6.ci.p.km<-lm(e6.1.ci.p.km$energy_over_time~as.numeric(david6.1.ci.p.km$normDS))
km.lm.6.s.ci.p.km<-summary(lm.km.6.ci.p.km)$coefficients
km.6.slope.ci.p.km<-km.lm.6.s.ci.p.km[2,1]
lm.km.7.ci.p.km<-lm(e7.1.ci.p.km$energy_over_time~as.numeric(david7.1.ci.p.km$normDS))
km.lm.7.s.ci.p.km<-summary(lm.km.7.ci.p.km)$coefficients
km.7.slope.ci.p.km<-km.lm.7.s.ci.p.km[2,1]
lm.km.8.ci.p.km<-lm(e8.1.ci.p.km$energy_over_time~as.numeric(david8.1.ci.p.km$normDS))
km.lm.8.s.ci.p.km<-summary(lm.km.8.ci.p.km)$coefficients
km.8.slope.ci.p.km<-km.lm.8.s.ci.p.km[2,1]
lm.km.9.ci.p.km<-lm(e9.1.ci.p.km$energy_over_time~as.numeric(david9.1.ci.p.km$normDS))
km.lm.9.s.ci.p.km<-summary(lm.km.9.ci.p.km)$coefficients
km.9.slope.ci.p.km<-km.lm.9.s.ci.p.km[2,1]
lm.km.10.ci.p.km<-lm(e10.1.ci.p.km$energy_over_time~as.numeric(david10.1.ci.p.km$normDS))
km.lm.10.s.ci.p.km<-summary(lm.km.10.ci.p.km)$coefficients
km.10.slope.ci.p.km<-km.lm.10.s.ci.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.km,tri2.ci.p.km,tri3.ci.p.km,tri4.ci.p.km,tri5.ci.p.km,tri6.ci.p.km,tri7.ci.p.km,tri8.ci.p.km,tri9.ci.p.km,tri10.ci.p.km),escalation=c(ep1.ci.p.km,ep2.ci.p.km,ep3.ci.p.km,ep4.ci.p.km,ep5.ci.p.km,ep6.ci.p.km,ep7.ci.p.km,ep8.ci.p.km,ep9.ci.p.km,ep10.ci.p.km),dci=c(dci1.ci.p.km,dci2.ci.p.km,dci3.ci.p.km,dci4.ci.p.km,dci5.ci.p.km,dci6.ci.p.km,dci7.ci.p.km,dci8.ci.p.km,dci9.ci.p.km,dci10.ci.p.km),steepness=c(s1.ci.p.km,s2.ci.p.km,s3.ci.p.km,s4.ci.p.km,s5.ci.p.km,s6.ci.p.km,s7.ci.p.km,s8.ci.p.km,s9.ci.p.km,s10.ci.p.km),slope=c(km.1.slope.ci.p.km,km.2.slope.ci.p.km,km.3.slope.ci.p.km,km.4.slope.ci.p.km,km.5.slope.ci.p.km,km.6.slope.ci.p.km,km.7.slope.ci.p.km,km.8.slope.ci.p.km,km.9.slope.ci.p.km,km.10.slope.ci.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ks<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[1]],X2=avoid.ci.p.ks[[2]],Avoids=avoid.ci.p.ks[[3]])
a2.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[4]],X2=avoid.ci.p.ks[[5]],Avoids=avoid.ci.p.ks[[6]])
a3.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[7]],X2=avoid.ci.p.ks[[8]],Avoids=avoid.ci.p.ks[[9]])
a4.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[10]],X2=avoid.ci.p.ks[[11]],Avoids=avoid.ci.p.ks[[12]])
a5.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[13]],X2=avoid.ci.p.ks[[14]],Avoids=avoid.ci.p.ks[[15]])
a6.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[16]],X2=avoid.ci.p.ks[[17]],Avoids=avoid.ci.p.ks[[18]])
a7.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[19]],X2=avoid.ci.p.ks[[20]],Avoids=avoid.ci.p.ks[[21]])
a8.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[22]],X2=avoid.ci.p.ks[[23]],Avoids=avoid.ci.p.ks[[24]])
a9.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[25]],X2=avoid.ci.p.ks[[26]],Avoids=avoid.ci.p.ks[[27]])
a10.ci.p.ks<-data.frame(X1=avoid.ci.p.ks[[28]],X2=avoid.ci.p.ks[[29]],Avoids=avoid.ci.p.ks[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ks.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[1]],X2=conflict.ks.ci.p[[2]],Victories=conflict.ks.ci.p[[3]])
mat1.ci.p.ks<-inter.mat(mut1.ci.p.ks)
tri1.ci.p.ks<-tr.tri(mat1.ci.p.ks)
dci1.ci.p.ks<-DCindex(mat1.ci.p.ks)
mat1.ci.p.ks[is.na(mat1.ci.p.ks)] = 0
h1.ci.p.ks<-h.index(mat1.ci.p.ks)

ep1.ci.p.ks<-ep(mut1.ci.p.ks,a1.ci.p.ks)
david1.ci.p.ks<-DS(mat1.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.ks<-cbind(ordrank.1.ci.p.ks,ds=david1.ci.p.ks$normDS)
lm1.ci.p.ks<-summary(lm(ordrank.1.ci.p.ks$ds~ordrank.1.ci.p.ks$ord.rank))
s1.ci.p.ks<-lm1.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[4]],X2=conflict.ks.ci.p[[5]],Victories=conflict.ks.ci.p[[6]])
mat2.ci.p.ks<-inter.mat(mut2.ci.p.ks)
tri2.ci.p.ks<-tr.tri(mat2.ci.p.ks)
dci2.ci.p.ks<-DCindex(mat2.ci.p.ks)
mat2.ci.p.ks[is.na(mat2.ci.p.ks)] = 0
h2.ci.p.ks<-h.index(mat2.ci.p.ks)

ep2.ci.p.ks<-ep(mut2.ci.p.ks,a2.ci.p.ks)
david2.ci.p.ks<-DS(mat2.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.ks<-cbind(ordrank.2.ci.p.ks,ds=david2.ci.p.ks$normDS)
lm2.ci.p.ks<-summary(lm(ordrank.2.ci.p.ks$ds~ordrank.2.ci.p.ks$ord.rank))
s2.ci.p.ks<-lm2.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[7]],X2=conflict.ks.ci.p[[8]],Victories=conflict.ks.ci.p[[9]])
mat3.ci.p.ks<-inter.mat(mut3.ci.p.ks)
tri3.ci.p.ks<-tr.tri(mat3.ci.p.ks)
dci3.ci.p.ks<-DCindex(mat3.ci.p.ks)
mat3.ci.p.ks[is.na(mat3.ci.p.ks)] = 0
h3.ci.p.ks<-h.index(mat3.ci.p.ks)

ep3.ci.p.ks<-ep(mut3.ci.p.ks,a3.ci.p.ks)
david3.ci.p.ks<-DS(mat3.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.ks<-cbind(ordrank.3.ci.p.ks,ds=david3.ci.p.ks$normDS)
lm3.ci.p.ks<-summary(lm(ordrank.3.ci.p.ks$ds~ordrank.3.ci.p.ks$ord.rank))
s3.ci.p.ks<-lm3.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[10]],X2=conflict.ks.ci.p[[11]],Victories=conflict.ks.ci.p[[12]])
mat4.ci.p.ks<-inter.mat(mut4.ci.p.ks)
tri4.ci.p.ks<-tr.tri(mat4.ci.p.ks)
dci4.ci.p.ks<-DCindex(mat4.ci.p.ks)
mat4.ci.p.ks[is.na(mat4.ci.p.ks)] = 0
h4.ci.p.ks<-h.index(mat4.ci.p.ks)

ep4.ci.p.ks<-ep(mut4.ci.p.ks,a4.ci.p.ks)
david4.ci.p.ks<-DS(mat4.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.ks<-cbind(ordrank.4.ci.p.ks,ds=david4.ci.p.ks$normDS)
lm4.ci.p.ks<-summary(lm(ordrank.4.ci.p.ks$ds~ordrank.4.ci.p.ks$ord.rank))
s4.ci.p.ks<-lm4.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[13]],X2=conflict.ks.ci.p[[14]],Victories=conflict.ks.ci.p[[15]])
mat5.ci.p.ks<-inter.mat(mut5.ci.p.ks)
tri5.ci.p.ks<-tr.tri(mat5.ci.p.ks)
dci5.ci.p.ks<-DCindex(mat5.ci.p.ks)
mat5.ci.p.ks[is.na(mat5.ci.p.ks)] = 0
h5.ci.p.ks<-h.index(mat5.ci.p.ks)

ep5.ci.p.ks<-ep(mut5.ci.p.ks,a5.ci.p.ks)
david5.ci.p.ks<-DS(mat5.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.ks<-cbind(ordrank.5.ci.p.ks,ds=david5.ci.p.ks$normDS)
lm5.ci.p.ks<-summary(lm(ordrank.5.ci.p.ks$ds~ordrank.5.ci.p.ks$ord.rank))
s5.ci.p.ks<-lm5.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[16]],X2=conflict.ks.ci.p[[17]],Victories=conflict.ks.ci.p[[18]])
mat6.ci.p.ks<-inter.mat(mut6.ci.p.ks)
tri6.ci.p.ks<-tr.tri(mat6.ci.p.ks)
dci6.ci.p.ks<-DCindex(mat6.ci.p.ks)
mat6.ci.p.ks[is.na(mat6.ci.p.ks)] = 0
h6.ci.p.ks<-h.index(mat6.ci.p.ks)

ep6.ci.p.ks<-ep(mut6.ci.p.ks,a6.ci.p.ks)
david6.ci.p.ks<-DS(mat6.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.ks<-cbind(ordrank.6.ci.p.ks,ds=david6.ci.p.ks$normDS)
lm6.ci.p.ks<-summary(lm(ordrank.6.ci.p.ks$ds~ordrank.6.ci.p.ks$ord.rank))
s6.ci.p.ks<-lm6.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[19]],X2=conflict.ks.ci.p[[20]],Victories=conflict.ks.ci.p[[21]])
mat7.ci.p.ks<-inter.mat(mut7.ci.p.ks)
tri7.ci.p.ks<-tr.tri(mat7.ci.p.ks)
dci7.ci.p.ks<-DCindex(mat7.ci.p.ks)
mat7.ci.p.ks[is.na(mat7.ci.p.ks)] = 0
h7.ci.p.ks<-h.index(mat7.ci.p.ks)

ep7.ci.p.ks<-ep(mut7.ci.p.ks,a7.ci.p.ks)
david7.ci.p.ks<-DS(mat7.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.ks<-cbind(ordrank.7.ci.p.ks,ds=david7.ci.p.ks$normDS)
lm7.ci.p.ks<-summary(lm(ordrank.7.ci.p.ks$ds~ordrank.7.ci.p.ks$ord.rank))
s7.ci.p.ks<-lm7.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[22]],X2=conflict.ks.ci.p[[23]],Victories=conflict.ks.ci.p[[24]])
mat8.ci.p.ks<-inter.mat(mut8.ci.p.ks)
tri8.ci.p.ks<-tr.tri(mat8.ci.p.ks)
dci8.ci.p.ks<-DCindex(mat8.ci.p.ks)
mat8.ci.p.ks[is.na(mat8.ci.p.ks)] = 0
h8.ci.p.ks<-h.index(mat8.ci.p.ks)

ep8.ci.p.ks<-ep(mut8.ci.p.ks,a8.ci.p.ks)
david8.ci.p.ks<-DS(mat8.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.ks<-cbind(ordrank.8.ci.p.ks,ds=david8.ci.p.ks$normDS)
lm8.ci.p.ks<-summary(lm(ordrank.8.ci.p.ks$ds~ordrank.8.ci.p.ks$ord.rank))
s8.ci.p.ks<-lm8.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[25]],X2=conflict.ks.ci.p[[26]],Victories=conflict.ks.ci.p[[27]])
mat9.ci.p.ks<-inter.mat(mut9.ci.p.ks)
tri9.ci.p.ks<-tr.tri(mat9.ci.p.ks)
dci9.ci.p.ks<-DCindex(mat9.ci.p.ks)
mat9.ci.p.ks[is.na(mat9.ci.p.ks)] = 0
h9.ci.p.ks<-h.index(mat9.ci.p.ks)

ep9.ci.p.ks<-ep(mut9.ci.p.ks,a9.ci.p.ks)
david9.ci.p.ks<-DS(mat9.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.ks<-cbind(ordrank.9.ci.p.ks,ds=david9.ci.p.ks$normDS)
lm9.ci.p.ks<-summary(lm(ordrank.9.ci.p.ks$ds~ordrank.9.ci.p.ks$ord.rank))
s9.ci.p.ks<-lm9.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.ks<-data.frame(X1=conflict.ks.ci.p[[28]],X2=conflict.ks.ci.p[[29]],Victories=conflict.ks.ci.p[[30]])
mat10.ci.p.ks<-inter.mat(mut10.ci.p.ks)
tri10.ci.p.ks<-tr.tri(mat10.ci.p.ks)
dci10.ci.p.ks<-DCindex(mat10.ci.p.ks)
mat10.ci.p.ks[is.na(mat10.ci.p.ks)] = 0
h10.ci.p.ks<-h.index(mat10.ci.p.ks)

ep10.ci.p.ks<-ep(mut10.ci.p.ks,a10.ci.p.ks)
david10.ci.p.ks<-DS(mat10.ci.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.ks<-cbind(ordrank.10.ci.p.ks,ds=david10.ci.p.ks$normDS)
lm10.ci.p.ks<-summary(lm(ordrank.10.ci.p.ks$ds~ordrank.10.ci.p.ks$ord.rank))
s10.ci.p.ks<-lm10.ci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.ks<-sum(mut1.ci.p.ks$Victories)
int2.ci.p.ks<-sum(mut2.ci.p.ks$Victories)
int3.ci.p.ks<-sum(mut3.ci.p.ks$Victories)
int4.ci.p.ks<-sum(mut4.ci.p.ks$Victories)
int5.ci.p.ks<-sum(mut5.ci.p.ks$Victories)
int6.ci.p.ks<-sum(mut6.ci.p.ks$Victories)
int7.ci.p.ks<-sum(mut7.ci.p.ks$Victories)
int8.ci.p.ks<-sum(mut8.ci.p.ks$Victories)
int9.ci.p.ks<-sum(mut9.ci.p.ks$Victories)
int10.ci.p.ks<-sum(mut10.ci.p.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ks<-sum(a1.ci.p.ks$Victories)
av2.ci.p.ks<-sum(a2.ci.p.ks$Victories)
av3.ci.p.ks<-sum(a3.ci.p.ks$Victories)
av4.ci.p.ks<-sum(a4.ci.p.ks$Victories)
av5.ci.p.ks<-sum(a5.ci.p.ks$Victories)
av6.ci.p.ks<-sum(a6.ci.p.ks$Victories)
av7.ci.p.ks<-sum(a7.ci.p.ks$Victories)
av8.ci.p.ks<-sum(a8.ci.p.ks$Victories)
av9.ci.p.ks<-sum(a9.ci.p.ks$Victories)
av10.ci.p.ks<-sum(a10.ci.p.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.ic.p<-(sum(av1.ci.p.ks, av2.ci.p.ks, av3.ci.p.ks, av4.ci.p.ks, av5.ci.p.ks, av6.ci.p.ks, av7.ci.p.ks, av8.ci.p.ks, av9.ci.p.ks, av10.ci.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.ic.p<-(sum(int1.ci.p.ks, int2.ci.p.ks, int3.ci.p.ks, int4.ci.p.ks, int5.ci.p.ks, int6.ci.p.ks, int7.ci.p.ks, int8.ci.p.ks, int9.ci.p.ks, int10.ci.p.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.ks<-e1.ci.p.ks[order(e1.ci.p.ks$ID),]
e1.ci.p.ks<-as.matrix(t(e1.1.ci.p.ks))

e2.ci.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.ks<-e2.ci.p.ks[order(e2.ci.p.ks$ID),]
e2.ci.p.ks<-as.matrix(t(e2.1.ci.p.ks))

e3.ci.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.ks<-e3.ci.p.ks[order(e3.ci.p.ks$ID),]
e3.ci.p.ks<-as.matrix(t(e3.1.ci.p.ks))

e4.ci.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.ks<-e4.ci.p.ks[order(e4.ci.p.ks$ID),]
e4.ci.p.ks<-as.matrix(t(e4.1.ci.p.ks))

e5.ci.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.ks<-e5.ci.p.ks[order(e5.ci.p.ks$ID),]
e5.ci.p.ks<-as.matrix(t(e5.1.ci.p.ks))

e6.ci.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.ks<-e6.ci.p.ks[order(e6.ci.p.ks$ID),]
e6.ci.p.ks<-as.matrix(t(e6.1.ci.p.ks))

e7.ci.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.ks<-e7.ci.p.ks[order(e7.ci.p.ks$ID),]
e7.ci.p.ks<-as.matrix(t(e7.1.ci.p.ks))

e8.ci.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.ks<-e8.ci.p.ks[order(e8.ci.p.ks$ID),]
e8.ci.p.ks<-as.matrix(t(e8.1.ci.p.ks))

e9.ci.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.ks<-e9.ci.p.ks[order(e9.ci.p.ks$ID),]
e9.ci.p.ks<-as.matrix(t(e9.1.ci.p.ks))

e10.ci.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.ks<-e10.ci.p.ks[order(e10.ci.p.ks$ID),]
e10.ci.p.ks<-as.matrix(t(e10.1.ci.p.ks))

energy.ks.ci.p.ks<-as.data.frame(matrix(c(e1.ci.p.ks,e2.ci.p.ks,e3.ci.p.ks,e4.ci.p.ks,e5.ci.p.ks,e6.ci.p.ks,e7.ci.p.ks,e8.ci.p.ks,e9.ci.p.ks,e10.ci.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.ci.p.ks<-data.frame(ID=energy.ks.ci.p.ks$V1,energy_over_distance=energy.ks.ci.p.ks$V2,energy_over_time=energy.ks.ci.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.ks<-david1.ci.p.ks[order(david1.ci.p.ks$ID),]
david1.ci.p.ks<-as.matrix(t(david1.1.ci.p.ks))

david2.1.ci.p.ks<-david2.ci.p.ks[order(david2.ci.p.ks$ID),]
david2.ci.p.ks<-as.matrix(t(david2.1.ci.p.ks))

david3.1.ci.p.ks<-david3.ci.p.ks[order(david3.ci.p.ks$ID),]
david3.ci.p.ks<-as.matrix(t(david3.1.ci.p.ks))

david4.1.ci.p.ks<-david4.ci.p.ks[order(david4.ci.p.ks$ID),]
david4.ci.p.ks<-as.matrix(t(david4.1.ci.p.ks))

david5.1.ci.p.ks<-david5.ci.p.ks[order(david5.ci.p.ks$ID),]
david5.ci.p.ks<-as.matrix(t(david5.1.ci.p.ks))

david6.1.ci.p.ks<-david6.ci.p.ks[order(david6.ci.p.ks$ID),]
david6.ci.p.ks<-as.matrix(t(david6.1.ci.p.ks))

david7.1.ci.p.ks<-david7.ci.p.ks[order(david7.ci.p.ks$ID),]
david7.ci.p.ks<-as.matrix(t(david7.1.ci.p.ks))

david8.1.ci.p.ks<-david8.ci.p.ks[order(david8.ci.p.ks$ID),]
david8.ci.p.ks<-as.matrix(t(david8.1.ci.p.ks))

david9.1.ci.p.ks<-david9.ci.p.ks[order(david9.ci.p.ks$ID),]
david9.ci.p.ks<-as.matrix(t(david9.1.ci.p.ks))

david10.1.ci.p.ks<-david10.ci.p.ks[order(david10.ci.p.ks$ID),]
david10.ci.p.ks<-as.matrix(t(david10.1.ci.p.ks))

david.ks.ci.p.ks<-as.data.frame(matrix(c(david1.ci.p.ks,david2.ci.p.ks,david3.ci.p.ks,david4.ci.p.ks,david5.ci.p.ks,david6.ci.p.ks,david7.ci.p.ks,david8.ci.p.ks,david9.ci.p.ks,david10.ci.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.ci.p.ks<-data.frame(ID=david.ks.ci.p.ks$V1,DS=david.ks.ci.p.ks$V2,normDS=david.ks.ci.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.ci.p.ks<-lm(e1.1.ci.p.ks$energy_over_time~as.numeric(david1.1.ci.p.ks$normDS))
ks.lm.1.s.ci.p.ks<-summary(lm.ks.1.ci.p.ks)$coefficients
ks.1.slope.ci.p.ks<-ks.lm.1.s.ci.p.ks[2,1]
lm.ks.2.ci.p.ks<-lm(e2.1.ci.p.ks$energy_over_time~as.numeric(david2.1.ci.p.ks$normDS))
ks.lm.2.s.ci.p.ks<-summary(lm.ks.2.ci.p.ks)$coefficients
ks.2.slope.ci.p.ks<-ks.lm.2.s.ci.p.ks[2,1]
lm.ks.3.ci.p.ks<-lm(e3.1.ci.p.ks$energy_over_time~as.numeric(david3.1.ci.p.ks$normDS))
ks.lm.3.s.ci.p.ks<-summary(lm.ks.3.ci.p.ks)$coefficients
ks.3.slope.ci.p.ks<-ks.lm.3.s.ci.p.ks[2,1]
lm.ks.4.ci.p.ks<-lm(e4.1.ci.p.ks$energy_over_time~as.numeric(david4.1.ci.p.ks$normDS))
ks.lm.4.s.ci.p.ks<-summary(lm.ks.4.ci.p.ks)$coefficients
ks.4.slope.ci.p.ks<-ks.lm.4.s.ci.p.ks[2,1]
lm.ks.5.ci.p.ks<-lm(e5.1.ci.p.ks$energy_over_time~as.numeric(david5.1.ci.p.ks$normDS))
ks.lm.5.s.ci.p.ks<-summary(lm.ks.5.ci.p.ks)$coefficients
ks.5.slope.ci.p.ks<-ks.lm.5.s.ci.p.ks[2,1]
lm.ks.6.ci.p.ks<-lm(e6.1.ci.p.ks$energy_over_time~as.numeric(david6.1.ci.p.ks$normDS))
ks.lm.6.s.ci.p.ks<-summary(lm.ks.6.ci.p.ks)$coefficients
ks.6.slope.ci.p.ks<-ks.lm.6.s.ci.p.ks[2,1]
lm.ks.7.ci.p.ks<-lm(e7.1.ci.p.ks$energy_over_time~as.numeric(david7.1.ci.p.ks$normDS))
ks.lm.7.s.ci.p.ks<-summary(lm.ks.7.ci.p.ks)$coefficients
ks.7.slope.ci.p.ks<-ks.lm.7.s.ci.p.ks[2,1]
lm.ks.8.ci.p.ks<-lm(e8.1.ci.p.ks$energy_over_time~as.numeric(david8.1.ci.p.ks$normDS))
ks.lm.8.s.ci.p.ks<-summary(lm.ks.8.ci.p.ks)$coefficients
ks.8.slope.ci.p.ks<-ks.lm.8.s.ci.p.ks[2,1]
lm.ks.9.ci.p.ks<-lm(e9.1.ci.p.ks$energy_over_time~as.numeric(david9.1.ci.p.ks$normDS))
ks.lm.9.s.ci.p.ks<-summary(lm.ks.9.ci.p.ks)$coefficients
ks.9.slope.ci.p.ks<-ks.lm.9.s.ci.p.ks[2,1]
lm.ks.10.ci.p.ks<-lm(e10.1.ci.p.ks$energy_over_time~as.numeric(david10.1.ci.p.ks$normDS))
ks.lm.10.s.ci.p.ks<-summary(lm.ks.10.ci.p.ks)$coefficients
ks.10.slope.ci.p.ks<-ks.lm.10.s.ci.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.ks,tri2.ci.p.ks,tri3.ci.p.ks,tri4.ci.p.ks,tri5.ci.p.ks,tri6.ci.p.ks,tri7.ci.p.ks,tri8.ci.p.ks,tri9.ci.p.ks,tri10.ci.p.ks),escalation=c(ep1.ci.p.ks,ep2.ci.p.ks,ep3.ci.p.ks,ep4.ci.p.ks,ep5.ci.p.ks,ep6.ci.p.ks,ep7.ci.p.ks,ep8.ci.p.ks,ep9.ci.p.ks,ep10.ci.p.ks),dci=c(dci1.ci.p.ks,dci2.ci.p.ks,dci3.ci.p.ks,dci4.ci.p.ks,dci5.ci.p.ks,dci6.ci.p.ks,dci7.ci.p.ks,dci8.ci.p.ks,dci9.ci.p.ks,dci10.ci.p.ks),steepness=c(s1.ci.p.ks,s2.ci.p.ks,s3.ci.p.ks,s4.ci.p.ks,s5.ci.p.ks,s6.ci.p.ks,s7.ci.p.ks,s8.ci.p.ks,s9.ci.p.ks,s10.ci.p.ks),slope=c(ks.1.slope.ci.p.ks,ks.2.slope.ci.p.ks,ks.3.slope.ci.p.ks,ks.4.slope.ci.p.ks,ks.5.slope.ci.p.ks,ks.6.slope.ci.p.ks,ks.7.slope.ci.p.ks,ks.8.slope.ci.p.ks,ks.9.slope.ci.p.ks,ks.10.slope.ci.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Clump

# Data organization for the Knowledge Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ko<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[1]],X2=avoid.ci.p.ko[[2]],Avoids=avoid.ci.p.ko[[3]])
a2.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[4]],X2=avoid.ci.p.ko[[5]],Avoids=avoid.ci.p.ko[[6]])
a3.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[7]],X2=avoid.ci.p.ko[[8]],Avoids=avoid.ci.p.ko[[9]])
a4.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[10]],X2=avoid.ci.p.ko[[11]],Avoids=avoid.ci.p.ko[[12]])
a5.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[13]],X2=avoid.ci.p.ko[[14]],Avoids=avoid.ci.p.ko[[15]])
a6.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[16]],X2=avoid.ci.p.ko[[17]],Avoids=avoid.ci.p.ko[[18]])
a7.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[19]],X2=avoid.ci.p.ko[[20]],Avoids=avoid.ci.p.ko[[21]])
a8.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[22]],X2=avoid.ci.p.ko[[23]],Avoids=avoid.ci.p.ko[[24]])
a9.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[25]],X2=avoid.ci.p.ko[[26]],Avoids=avoid.ci.p.ko[[27]])
a10.ci.p.ko<-data.frame(X1=avoid.ci.p.ko[[28]],X2=avoid.ci.p.ko[[29]],Avoids=avoid.ci.p.ko[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ko.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[1]],X2=conflict.ko.ci.p[[2]],Victories=conflict.ko.ci.p[[3]])
mat1.ci.p.ko<-inter.mat(mut1.ci.p.ko)
tri1.ci.p.ko<-tr.tri(mat1.ci.p.ko)
dci1.ci.p.ko<-DCindex(mat1.ci.p.ko)
mat1.ci.p.ko[is.na(mat1.ci.p.ko)] = 0
h1.ci.p.ko<-h.index(mat1.ci.p.ko)

ep1.ci.p.ko<-ep(mut1.ci.p.ko,a1.ci.p.ko)
david1.ci.p.ko<-DS(mat1.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.ko<-cbind(ordrank.1.ci.p.ko,ds=david1.ci.p.ko$normDS)
lm1.ci.p.ko<-summary(lm(ordrank.1.ci.p.ko$ds~ordrank.1.ci.p.ko$ord.rank))
s1.ci.p.ko<-lm1.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[4]],X2=conflict.ko.ci.p[[5]],Victories=conflict.ko.ci.p[[6]])
mat2.ci.p.ko<-inter.mat(mut2.ci.p.ko)
tri2.ci.p.ko<-tr.tri(mat2.ci.p.ko)
dci2.ci.p.ko<-DCindex(mat2.ci.p.ko)
mat2.ci.p.ko[is.na(mat2.ci.p.ko)] = 0
h2.ci.p.ko<-h.index(mat2.ci.p.ko)

ep2.ci.p.ko<-ep(mut2.ci.p.ko,a2.ci.p.ko)
david2.ci.p.ko<-DS(mat2.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.ko<-cbind(ordrank.2.ci.p.ko,ds=david2.ci.p.ko$normDS)
lm2.ci.p.ko<-summary(lm(ordrank.2.ci.p.ko$ds~ordrank.2.ci.p.ko$ord.rank))
s2.ci.p.ko<-lm2.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[7]],X2=conflict.ko.ci.p[[8]],Victories=conflict.ko.ci.p[[9]])
mat3.ci.p.ko<-inter.mat(mut3.ci.p.ko)
tri3.ci.p.ko<-tr.tri(mat3.ci.p.ko)
dci3.ci.p.ko<-DCindex(mat3.ci.p.ko)
mat3.ci.p.ko[is.na(mat3.ci.p.ko)] = 0
h3.ci.p.ko<-h.index(mat3.ci.p.ko)

ep3.ci.p.ko<-ep(mut3.ci.p.ko,a3.ci.p.ko)
david3.ci.p.ko<-DS(mat3.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.ko<-cbind(ordrank.3.ci.p.ko,ds=david3.ci.p.ko$normDS)
lm3.ci.p.ko<-summary(lm(ordrank.3.ci.p.ko$ds~ordrank.3.ci.p.ko$ord.rank))
s3.ci.p.ko<-lm3.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[10]],X2=conflict.ko.ci.p[[11]],Victories=conflict.ko.ci.p[[12]])
mat4.ci.p.ko<-inter.mat(mut4.ci.p.ko)
tri4.ci.p.ko<-tr.tri(mat4.ci.p.ko)
dci4.ci.p.ko<-DCindex(mat4.ci.p.ko)
mat4.ci.p.ko[is.na(mat4.ci.p.ko)] = 0
h4.ci.p.ko<-h.index(mat4.ci.p.ko)

ep4.ci.p.ko<-ep(mut4.ci.p.ko,a4.ci.p.ko)
david4.ci.p.ko<-DS(mat4.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.ko<-cbind(ordrank.4.ci.p.ko,ds=david4.ci.p.ko$normDS)
lm4.ci.p.ko<-summary(lm(ordrank.4.ci.p.ko$ds~ordrank.4.ci.p.ko$ord.rank))
s4.ci.p.ko<-lm4.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[13]],X2=conflict.ko.ci.p[[14]],Victories=conflict.ko.ci.p[[15]])
mat5.ci.p.ko<-inter.mat(mut5.ci.p.ko)
tri5.ci.p.ko<-tr.tri(mat5.ci.p.ko)
dci5.ci.p.ko<-DCindex(mat5.ci.p.ko)
mat5.ci.p.ko[is.na(mat5.ci.p.ko)] = 0
h5.ci.p.ko<-h.index(mat5.ci.p.ko)

ep5.ci.p.ko<-ep(mut5.ci.p.ko,a5.ci.p.ko)
david5.ci.p.ko<-DS(mat5.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.ko<-cbind(ordrank.5.ci.p.ko,ds=david5.ci.p.ko$normDS)
lm5.ci.p.ko<-summary(lm(ordrank.5.ci.p.ko$ds~ordrank.5.ci.p.ko$ord.rank))
s5.ci.p.ko<-lm5.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[16]],X2=conflict.ko.ci.p[[17]],Victories=conflict.ko.ci.p[[18]])
mat6.ci.p.ko<-inter.mat(mut6.ci.p.ko)
tri6.ci.p.ko<-tr.tri(mat6.ci.p.ko)
dci6.ci.p.ko<-DCindex(mat6.ci.p.ko)
mat6.ci.p.ko[is.na(mat6.ci.p.ko)] = 0
h6.ci.p.ko<-h.index(mat6.ci.p.ko)

ep6.ci.p.ko<-ep(mut6.ci.p.ko,a6.ci.p.ko)
david6.ci.p.ko<-DS(mat6.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.ko<-cbind(ordrank.6.ci.p.ko,ds=david6.ci.p.ko$normDS)
lm6.ci.p.ko<-summary(lm(ordrank.6.ci.p.ko$ds~ordrank.6.ci.p.ko$ord.rank))
s6.ci.p.ko<-lm6.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[19]],X2=conflict.ko.ci.p[[20]],Victories=conflict.ko.ci.p[[21]])
mat7.ci.p.ko<-inter.mat(mut7.ci.p.ko)
tri7.ci.p.ko<-tr.tri(mat7.ci.p.ko)
dci7.ci.p.ko<-DCindex(mat7.ci.p.ko)
mat7.ci.p.ko[is.na(mat7.ci.p.ko)] = 0
h7.ci.p.ko<-h.index(mat7.ci.p.ko)

ep7.ci.p.ko<-ep(mut7.ci.p.ko,a7.ci.p.ko)
david7.ci.p.ko<-DS(mat7.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.ko<-cbind(ordrank.7.ci.p.ko,ds=david7.ci.p.ko$normDS)
lm7.ci.p.ko<-summary(lm(ordrank.7.ci.p.ko$ds~ordrank.7.ci.p.ko$ord.rank))
s7.ci.p.ko<-lm7.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[22]],X2=conflict.ko.ci.p[[23]],Victories=conflict.ko.ci.p[[24]])
mat8.ci.p.ko<-inter.mat(mut8.ci.p.ko)
tri8.ci.p.ko<-tr.tri(mat8.ci.p.ko)
dci8.ci.p.ko<-DCindex(mat8.ci.p.ko)
mat8.ci.p.ko[is.na(mat8.ci.p.ko)] = 0
h8.ci.p.ko<-h.index(mat8.ci.p.ko)

ep8.ci.p.ko<-ep(mut8.ci.p.ko,a8.ci.p.ko)
david8.ci.p.ko<-DS(mat8.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.ko<-cbind(ordrank.8.ci.p.ko,ds=david8.ci.p.ko$normDS)
lm8.ci.p.ko<-summary(lm(ordrank.8.ci.p.ko$ds~ordrank.8.ci.p.ko$ord.rank))
s8.ci.p.ko<-lm8.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[25]],X2=conflict.ko.ci.p[[26]],Victories=conflict.ko.ci.p[[27]])
mat9.ci.p.ko<-inter.mat(mut9.ci.p.ko)
tri9.ci.p.ko<-tr.tri(mat9.ci.p.ko)
dci9.ci.p.ko<-DCindex(mat9.ci.p.ko)
mat9.ci.p.ko[is.na(mat9.ci.p.ko)] = 0
h9.ci.p.ko<-h.index(mat9.ci.p.ko)

ep9.ci.p.ko<-ep(mut9.ci.p.ko,a9.ci.p.ko)
david9.ci.p.ko<-DS(mat9.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.ko<-cbind(ordrank.9.ci.p.ko,ds=david9.ci.p.ko$normDS)
lm9.ci.p.ko<-summary(lm(ordrank.9.ci.p.ko$ds~ordrank.9.ci.p.ko$ord.rank))
s9.ci.p.ko<-lm9.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.ko<-data.frame(X1=conflict.ko.ci.p[[28]],X2=conflict.ko.ci.p[[29]],Victories=conflict.ko.ci.p[[30]])
mat10.ci.p.ko<-inter.mat(mut10.ci.p.ko)
tri10.ci.p.ko<-tr.tri(mat10.ci.p.ko)
dci10.ci.p.ko<-DCindex(mat10.ci.p.ko)
mat10.ci.p.ko[is.na(mat10.ci.p.ko)] = 0
h10.ci.p.ko<-h.index(mat10.ci.p.ko)

ep10.ci.p.ko<-ep(mut10.ci.p.ko,a10.ci.p.ko)
david10.ci.p.ko<-DS(mat10.ci.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.ko<-cbind(ordrank.10.ci.p.ko,ds=david10.ci.p.ko$normDS)
lm10.ci.p.ko<-summary(lm(ordrank.10.ci.p.ko$ds~ordrank.10.ci.p.ko$ord.rank))
s10.ci.p.ko<-lm10.ci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.ko<-sum(mut1.ci.p.ko$Victories)
int2.ci.p.ko<-sum(mut2.ci.p.ko$Victories)
int3.ci.p.ko<-sum(mut3.ci.p.ko$Victories)
int4.ci.p.ko<-sum(mut4.ci.p.ko$Victories)
int5.ci.p.ko<-sum(mut5.ci.p.ko$Victories)
int6.ci.p.ko<-sum(mut6.ci.p.ko$Victories)
int7.ci.p.ko<-sum(mut7.ci.p.ko$Victories)
int8.ci.p.ko<-sum(mut8.ci.p.ko$Victories)
int9.ci.p.ko<-sum(mut9.ci.p.ko$Victories)
int10.ci.p.ko<-sum(mut10.ci.p.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ko<-sum(a1.ci.p.ko$Victories)
av2.ci.p.ko<-sum(a2.ci.p.ko$Victories)
av3.ci.p.ko<-sum(a3.ci.p.ko$Victories)
av4.ci.p.ko<-sum(a4.ci.p.ko$Victories)
av5.ci.p.ko<-sum(a5.ci.p.ko$Victories)
av6.ci.p.ko<-sum(a6.ci.p.ko$Victories)
av7.ci.p.ko<-sum(a7.ci.p.ko$Victories)
av8.ci.p.ko<-sum(a8.ci.p.ko$Victories)
av9.ci.p.ko<-sum(a9.ci.p.ko$Victories)
av10.ci.p.ko<-sum(a10.ci.p.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.ic.p<-(sum(av1.ci.p.ko, av2.ci.p.ko, av3.ci.p.ko, av4.ci.p.ko, av5.ci.p.ko, av6.ci.p.ko, av7.ci.p.ko, av8.ci.p.ko, av9.ci.p.ko, av10.ci.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.ic.p<-(sum(int1.ci.p.ko, int2.ci.p.ko, int3.ci.p.ko, int4.ci.p.ko, int5.ci.p.ko, int6.ci.p.ko, int7.ci.p.ko, int8.ci.p.ko, int9.ci.p.ko, int10.ci.p.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.ko<-e1.ci.p.ko[order(e1.ci.p.ko$ID),]
e1.ci.p.ko<-as.matrix(t(e1.1.ci.p.ko))

e2.ci.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.ko<-e2.ci.p.ko[order(e2.ci.p.ko$ID),]
e2.ci.p.ko<-as.matrix(t(e2.1.ci.p.ko))

e3.ci.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.ko<-e3.ci.p.ko[order(e3.ci.p.ko$ID),]
e3.ci.p.ko<-as.matrix(t(e3.1.ci.p.ko))

e4.ci.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.ko<-e4.ci.p.ko[order(e4.ci.p.ko$ID),]
e4.ci.p.ko<-as.matrix(t(e4.1.ci.p.ko))

e5.ci.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.ko<-e5.ci.p.ko[order(e5.ci.p.ko$ID),]
e5.ci.p.ko<-as.matrix(t(e5.1.ci.p.ko))

e6.ci.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.ko<-e6.ci.p.ko[order(e6.ci.p.ko$ID),]
e6.ci.p.ko<-as.matrix(t(e6.1.ci.p.ko))

e7.ci.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.ko<-e7.ci.p.ko[order(e7.ci.p.ko$ID),]
e7.ci.p.ko<-as.matrix(t(e7.1.ci.p.ko))

e8.ci.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.ko<-e8.ci.p.ko[order(e8.ci.p.ko$ID),]
e8.ci.p.ko<-as.matrix(t(e8.1.ci.p.ko))

e9.ci.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.ko<-e9.ci.p.ko[order(e9.ci.p.ko$ID),]
e9.ci.p.ko<-as.matrix(t(e9.1.ci.p.ko))

e10.ci.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.ko<-e10.ci.p.ko[order(e10.ci.p.ko$ID),]
e10.ci.p.ko<-as.matrix(t(e10.1.ci.p.ko))

energy.ko.ci.p.ko<-as.data.frame(matrix(c(e1.ci.p.ko,e2.ci.p.ko,e3.ci.p.ko,e4.ci.p.ko,e5.ci.p.ko,e6.ci.p.ko,e7.ci.p.ko,e8.ci.p.ko,e9.ci.p.ko,e10.ci.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.ci.p.ko<-data.frame(ID=energy.ko.ci.p.ko$V1,energy_over_distance=energy.ko.ci.p.ko$V2,energy_over_time=energy.ko.ci.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.ko<-david1.ci.p.ko[order(david1.ci.p.ko$ID),]
david1.ci.p.ko<-as.matrix(t(david1.1.ci.p.ko))

david2.1.ci.p.ko<-david2.ci.p.ko[order(david2.ci.p.ko$ID),]
david2.ci.p.ko<-as.matrix(t(david2.1.ci.p.ko))

david3.1.ci.p.ko<-david3.ci.p.ko[order(david3.ci.p.ko$ID),]
david3.ci.p.ko<-as.matrix(t(david3.1.ci.p.ko))

david4.1.ci.p.ko<-david4.ci.p.ko[order(david4.ci.p.ko$ID),]
david4.ci.p.ko<-as.matrix(t(david4.1.ci.p.ko))

david5.1.ci.p.ko<-david5.ci.p.ko[order(david5.ci.p.ko$ID),]
david5.ci.p.ko<-as.matrix(t(david5.1.ci.p.ko))

david6.1.ci.p.ko<-david6.ci.p.ko[order(david6.ci.p.ko$ID),]
david6.ci.p.ko<-as.matrix(t(david6.1.ci.p.ko))

david7.1.ci.p.ko<-david7.ci.p.ko[order(david7.ci.p.ko$ID),]
david7.ci.p.ko<-as.matrix(t(david7.1.ci.p.ko))

david8.1.ci.p.ko<-david8.ci.p.ko[order(david8.ci.p.ko$ID),]
david8.ci.p.ko<-as.matrix(t(david8.1.ci.p.ko))

david9.1.ci.p.ko<-david9.ci.p.ko[order(david9.ci.p.ko$ID),]
david9.ci.p.ko<-as.matrix(t(david9.1.ci.p.ko))

david10.1.ci.p.ko<-david10.ci.p.ko[order(david10.ci.p.ko$ID),]
david10.ci.p.ko<-as.matrix(t(david10.1.ci.p.ko))

david.ko.ci.p.ko<-as.data.frame(matrix(c(david1.ci.p.ko,david2.ci.p.ko,david3.ci.p.ko,david4.ci.p.ko,david5.ci.p.ko,david6.ci.p.ko,david7.ci.p.ko,david8.ci.p.ko,david9.ci.p.ko,david10.ci.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.ci.p.ko<-data.frame(ID=david.ko.ci.p.ko$V1,DS=david.ko.ci.p.ko$V2,normDS=david.ko.ci.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.ci.p.ko<-lm(e1.1.ci.p.ko$energy_over_time~as.numeric(david1.1.ci.p.ko$normDS))
ko.lm.1.s.ci.p.ko<-summary(lm.ko.1.ci.p.ko)$coefficients
ko.1.slope.ci.p.ko<-ko.lm.1.s.ci.p.ko[2,1]
lm.ko.2.ci.p.ko<-lm(e2.1.ci.p.ko$energy_over_time~as.numeric(david2.1.ci.p.ko$normDS))
ko.lm.2.s.ci.p.ko<-summary(lm.ko.2.ci.p.ko)$coefficients
ko.2.slope.ci.p.ko<-ko.lm.2.s.ci.p.ko[2,1]
lm.ko.3.ci.p.ko<-lm(e3.1.ci.p.ko$energy_over_time~as.numeric(david3.1.ci.p.ko$normDS))
ko.lm.3.s.ci.p.ko<-summary(lm.ko.3.ci.p.ko)$coefficients
ko.3.slope.ci.p.ko<-ko.lm.3.s.ci.p.ko[2,1]
lm.ko.4.ci.p.ko<-lm(e4.1.ci.p.ko$energy_over_time~as.numeric(david4.1.ci.p.ko$normDS))
ko.lm.4.s.ci.p.ko<-summary(lm.ko.4.ci.p.ko)$coefficients
ko.4.slope.ci.p.ko<-ko.lm.4.s.ci.p.ko[2,1]
lm.ko.5.ci.p.ko<-lm(e5.1.ci.p.ko$energy_over_time~as.numeric(david5.1.ci.p.ko$normDS))
ko.lm.5.s.ci.p.ko<-summary(lm.ko.5.ci.p.ko)$coefficients
ko.5.slope.ci.p.ko<-ko.lm.5.s.ci.p.ko[2,1]
lm.ko.6.ci.p.ko<-lm(e6.1.ci.p.ko$energy_over_time~as.numeric(david6.1.ci.p.ko$normDS))
ko.lm.6.s.ci.p.ko<-summary(lm.ko.6.ci.p.ko)$coefficients
ko.6.slope.ci.p.ko<-ko.lm.6.s.ci.p.ko[2,1]
lm.ko.7.ci.p.ko<-lm(e7.1.ci.p.ko$energy_over_time~as.numeric(david7.1.ci.p.ko$normDS))
ko.lm.7.s.ci.p.ko<-summary(lm.ko.7.ci.p.ko)$coefficients
ko.7.slope.ci.p.ko<-ko.lm.7.s.ci.p.ko[2,1]
lm.ko.8.ci.p.ko<-lm(e8.1.ci.p.ko$energy_over_time~as.numeric(david8.1.ci.p.ko$normDS))
ko.lm.8.s.ci.p.ko<-summary(lm.ko.8.ci.p.ko)$coefficients
ko.8.slope.ci.p.ko<-ko.lm.8.s.ci.p.ko[2,1]
lm.ko.9.ci.p.ko<-lm(e9.1.ci.p.ko$energy_over_time~as.numeric(david9.1.ci.p.ko$normDS))
ko.lm.9.s.ci.p.ko<-summary(lm.ko.9.ci.p.ko)$coefficients
ko.9.slope.ci.p.ko<-ko.lm.9.s.ci.p.ko[2,1]
lm.ko.10.ci.p.ko<-lm(e10.1.ci.p.ko$energy_over_time~as.numeric(david10.1.ci.p.ko$normDS))
ko.lm.10.s.ci.p.ko<-summary(lm.ko.10.ci.p.ko)$coefficients
ko.10.slope.ci.p.ko<-ko.lm.10.s.ci.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.ko,tri2.ci.p.ko,tri3.ci.p.ko,tri4.ci.p.ko,tri5.ci.p.ko,tri6.ci.p.ko,tri7.ci.p.ko,tri8.ci.p.ko,tri9.ci.p.ko,tri10.ci.p.ko),escalation=c(ep1.ci.p.ko,ep2.ci.p.ko,ep3.ci.p.ko,ep4.ci.p.ko,ep5.ci.p.ko,ep6.ci.p.ko,ep7.ci.p.ko,ep8.ci.p.ko,ep9.ci.p.ko,ep10.ci.p.ko),dci=c(dci1.ci.p.ko,dci2.ci.p.ko,dci3.ci.p.ko,dci4.ci.p.ko,dci5.ci.p.ko,dci6.ci.p.ko,dci7.ci.p.ko,dci8.ci.p.ko,dci9.ci.p.ko,dci10.ci.p.ko),steepness=c(s1.ci.p.ko,s2.ci.p.ko,s3.ci.p.ko,s4.ci.p.ko,s5.ci.p.ko,s6.ci.p.ko,s7.ci.p.ko,s8.ci.p.ko,s9.ci.p.ko,s10.ci.p.ko),slope=c(ko.1.slope.ci.p.ko,ko.2.slope.ci.p.ko,ko.3.slope.ci.p.ko,ko.4.slope.ci.p.ko,ko.5.slope.ci.p.ko,ko.6.slope.ci.p.ko,ko.7.slope.ci.p.ko,ko.8.slope.ci.p.ko,ko.9.slope.ci.p.ko,ko.10.slope.ci.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.hm<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[1]],X2=avoid.ci.p.hm[[2]],Avoids=avoid.ci.p.hm[[3]])
a2.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[4]],X2=avoid.ci.p.hm[[5]],Avoids=avoid.ci.p.hm[[6]])
a3.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[7]],X2=avoid.ci.p.hm[[8]],Avoids=avoid.ci.p.hm[[9]])
a4.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[10]],X2=avoid.ci.p.hm[[11]],Avoids=avoid.ci.p.hm[[12]])
a5.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[13]],X2=avoid.ci.p.hm[[14]],Avoids=avoid.ci.p.hm[[15]])
a6.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[16]],X2=avoid.ci.p.hm[[17]],Avoids=avoid.ci.p.hm[[18]])
a7.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[19]],X2=avoid.ci.p.hm[[20]],Avoids=avoid.ci.p.hm[[21]])
a8.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[22]],X2=avoid.ci.p.hm[[23]],Avoids=avoid.ci.p.hm[[24]])
a9.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[25]],X2=avoid.ci.p.hm[[26]],Avoids=avoid.ci.p.hm[[27]])
a10.ci.p.hm<-data.frame(X1=avoid.ci.p.hm[[28]],X2=avoid.ci.p.hm[[29]],Avoids=avoid.ci.p.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[1]],X2=conflict.hm.ci.p[[2]],Victories=conflict.hm.ci.p[[3]])
mat1.ci.p.hm<-inter.mat(mut1.ci.p.hm)
tri1.ci.p.hm<-tr.tri(mat1.ci.p.hm)
dci1.ci.p.hm<-DCindex(mat1.ci.p.hm)
mat1.ci.p.hm[is.na(mat1.ci.p.hm)] = 0
h1.ci.p.hm<-h.index(mat1.ci.p.hm)

ep1.ci.p.hm<-ep(mut1.ci.p.hm,a1.ci.p.hm)
david1.ci.p.hm<-DS(mat1.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.hm<-cbind(ordrank.1.ci.p.hm,ds=david1.ci.p.hm$normDS)
lm1.ci.p.hm<-summary(lm(ordrank.1.ci.p.hm$ds~ordrank.1.ci.p.hm$ord.rank))
s1.ci.p.hm<-lm1.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[4]],X2=conflict.hm.ci.p[[5]],Victories=conflict.hm.ci.p[[6]])
mat2.ci.p.hm<-inter.mat(mut2.ci.p.hm)
tri2.ci.p.hm<-tr.tri(mat2.ci.p.hm)
dci2.ci.p.hm<-DCindex(mat2.ci.p.hm)
mat2.ci.p.hm[is.na(mat2.ci.p.hm)] = 0
h2.ci.p.hm<-h.index(mat2.ci.p.hm)

ep2.ci.p.hm<-ep(mut2.ci.p.hm,a2.ci.p.hm)
david2.ci.p.hm<-DS(mat2.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.hm<-cbind(ordrank.2.ci.p.hm,ds=david2.ci.p.hm$normDS)
lm2.ci.p.hm<-summary(lm(ordrank.2.ci.p.hm$ds~ordrank.2.ci.p.hm$ord.rank))
s2.ci.p.hm<-lm2.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[7]],X2=conflict.hm.ci.p[[8]],Victories=conflict.hm.ci.p[[9]])
mat3.ci.p.hm<-inter.mat(mut3.ci.p.hm)
tri3.ci.p.hm<-tr.tri(mat3.ci.p.hm)
dci3.ci.p.hm<-DCindex(mat3.ci.p.hm)
mat3.ci.p.hm[is.na(mat3.ci.p.hm)] = 0
h3.ci.p.hm<-h.index(mat3.ci.p.hm)

ep3.ci.p.hm<-ep(mut3.ci.p.hm,a3.ci.p.hm)
david3.ci.p.hm<-DS(mat3.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.hm<-cbind(ordrank.3.ci.p.hm,ds=david3.ci.p.hm$normDS)
lm3.ci.p.hm<-summary(lm(ordrank.3.ci.p.hm$ds~ordrank.3.ci.p.hm$ord.rank))
s3.ci.p.hm<-lm3.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[10]],X2=conflict.hm.ci.p[[11]],Victories=conflict.hm.ci.p[[12]])
mat4.ci.p.hm<-inter.mat(mut4.ci.p.hm)
tri4.ci.p.hm<-tr.tri(mat4.ci.p.hm)
dci4.ci.p.hm<-DCindex(mat4.ci.p.hm)
mat4.ci.p.hm[is.na(mat4.ci.p.hm)] = 0
h4.ci.p.hm<-h.index(mat4.ci.p.hm)

ep4.ci.p.hm<-ep(mut4.ci.p.hm,a4.ci.p.hm)
david4.ci.p.hm<-DS(mat4.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.hm<-cbind(ordrank.4.ci.p.hm,ds=david4.ci.p.hm$normDS)
lm4.ci.p.hm<-summary(lm(ordrank.4.ci.p.hm$ds~ordrank.4.ci.p.hm$ord.rank))
s4.ci.p.hm<-lm4.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[13]],X2=conflict.hm.ci.p[[14]],Victories=conflict.hm.ci.p[[15]])
mat5.ci.p.hm<-inter.mat(mut5.ci.p.hm)
tri5.ci.p.hm<-tr.tri(mat5.ci.p.hm)
dci5.ci.p.hm<-DCindex(mat5.ci.p.hm)
mat5.ci.p.hm[is.na(mat5.ci.p.hm)] = 0
h5.ci.p.hm<-h.index(mat5.ci.p.hm)

ep5.ci.p.hm<-ep(mut5.ci.p.hm,a5.ci.p.hm)
david5.ci.p.hm<-DS(mat5.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.hm<-cbind(ordrank.5.ci.p.hm,ds=david5.ci.p.hm$normDS)
lm5.ci.p.hm<-summary(lm(ordrank.5.ci.p.hm$ds~ordrank.5.ci.p.hm$ord.rank))
s5.ci.p.hm<-lm5.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[16]],X2=conflict.hm.ci.p[[17]],Victories=conflict.hm.ci.p[[18]])
mat6.ci.p.hm<-inter.mat(mut6.ci.p.hm)
tri6.ci.p.hm<-tr.tri(mat6.ci.p.hm)
dci6.ci.p.hm<-DCindex(mat6.ci.p.hm)
mat6.ci.p.hm[is.na(mat6.ci.p.hm)] = 0
h6.ci.p.hm<-h.index(mat6.ci.p.hm)

ep6.ci.p.hm<-ep(mut6.ci.p.hm,a6.ci.p.hm)
david6.ci.p.hm<-DS(mat6.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.hm<-cbind(ordrank.6.ci.p.hm,ds=david6.ci.p.hm$normDS)
lm6.ci.p.hm<-summary(lm(ordrank.6.ci.p.hm$ds~ordrank.6.ci.p.hm$ord.rank))
s6.ci.p.hm<-lm6.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[19]],X2=conflict.hm.ci.p[[20]],Victories=conflict.hm.ci.p[[21]])
mat7.ci.p.hm<-inter.mat(mut7.ci.p.hm)
tri7.ci.p.hm<-tr.tri(mat7.ci.p.hm)
dci7.ci.p.hm<-DCindex(mat7.ci.p.hm)
mat7.ci.p.hm[is.na(mat7.ci.p.hm)] = 0
h7.ci.p.hm<-h.index(mat7.ci.p.hm)

ep7.ci.p.hm<-ep(mut7.ci.p.hm,a7.ci.p.hm)
david7.ci.p.hm<-DS(mat7.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.hm<-cbind(ordrank.7.ci.p.hm,ds=david7.ci.p.hm$normDS)
lm7.ci.p.hm<-summary(lm(ordrank.7.ci.p.hm$ds~ordrank.7.ci.p.hm$ord.rank))
s7.ci.p.hm<-lm7.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[22]],X2=conflict.hm.ci.p[[23]],Victories=conflict.hm.ci.p[[24]])
mat8.ci.p.hm<-inter.mat(mut8.ci.p.hm)
tri8.ci.p.hm<-tr.tri(mat8.ci.p.hm)
dci8.ci.p.hm<-DCindex(mat8.ci.p.hm)
mat8.ci.p.hm[is.na(mat8.ci.p.hm)] = 0
h8.ci.p.hm<-h.index(mat8.ci.p.hm)

ep8.ci.p.hm<-ep(mut8.ci.p.hm,a8.ci.p.hm)
david8.ci.p.hm<-DS(mat8.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.hm<-cbind(ordrank.8.ci.p.hm,ds=david8.ci.p.hm$normDS)
lm8.ci.p.hm<-summary(lm(ordrank.8.ci.p.hm$ds~ordrank.8.ci.p.hm$ord.rank))
s8.ci.p.hm<-lm8.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[25]],X2=conflict.hm.ci.p[[26]],Victories=conflict.hm.ci.p[[27]])
mat9.ci.p.hm<-inter.mat(mut9.ci.p.hm)
tri9.ci.p.hm<-tr.tri(mat9.ci.p.hm)
dci9.ci.p.hm<-DCindex(mat9.ci.p.hm)
mat9.ci.p.hm[is.na(mat9.ci.p.hm)] = 0
h9.ci.p.hm<-h.index(mat9.ci.p.hm)

ep9.ci.p.hm<-ep(mut9.ci.p.hm,a9.ci.p.hm)
david9.ci.p.hm<-DS(mat9.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.hm<-cbind(ordrank.9.ci.p.hm,ds=david9.ci.p.hm$normDS)
lm9.ci.p.hm<-summary(lm(ordrank.9.ci.p.hm$ds~ordrank.9.ci.p.hm$ord.rank))
s9.ci.p.hm<-lm9.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.hm<-data.frame(X1=conflict.hm.ci.p[[28]],X2=conflict.hm.ci.p[[29]],Victories=conflict.hm.ci.p[[30]])
mat10.ci.p.hm<-inter.mat(mut10.ci.p.hm)
tri10.ci.p.hm<-tr.tri(mat10.ci.p.hm)
dci10.ci.p.hm<-DCindex(mat10.ci.p.hm)
mat10.ci.p.hm[is.na(mat10.ci.p.hm)] = 0
h10.ci.p.hm<-h.index(mat10.ci.p.hm)

ep10.ci.p.hm<-ep(mut10.ci.p.hm,a10.ci.p.hm)
david10.ci.p.hm<-DS(mat10.ci.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.hm<-cbind(ordrank.10.ci.p.hm,ds=david10.ci.p.hm$normDS)
lm10.ci.p.hm<-summary(lm(ordrank.10.ci.p.hm$ds~ordrank.10.ci.p.hm$ord.rank))
s10.ci.p.hm<-lm10.ci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.hm<-sum(mut1.ci.p.hm$Victories)
int2.ci.p.hm<-sum(mut2.ci.p.hm$Victories)
int3.ci.p.hm<-sum(mut3.ci.p.hm$Victories)
int4.ci.p.hm<-sum(mut4.ci.p.hm$Victories)
int5.ci.p.hm<-sum(mut5.ci.p.hm$Victories)
int6.ci.p.hm<-sum(mut6.ci.p.hm$Victories)
int7.ci.p.hm<-sum(mut7.ci.p.hm$Victories)
int8.ci.p.hm<-sum(mut8.ci.p.hm$Victories)
int9.ci.p.hm<-sum(mut9.ci.p.hm$Victories)
int10.ci.p.hm<-sum(mut10.ci.p.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.hm<-sum(a1.ci.p.hm$Victories)
av2.ci.p.hm<-sum(a2.ci.p.hm$Victories)
av3.ci.p.hm<-sum(a3.ci.p.hm$Victories)
av4.ci.p.hm<-sum(a4.ci.p.hm$Victories)
av5.ci.p.hm<-sum(a5.ci.p.hm$Victories)
av6.ci.p.hm<-sum(a6.ci.p.hm$Victories)
av7.ci.p.hm<-sum(a7.ci.p.hm$Victories)
av8.ci.p.hm<-sum(a8.ci.p.hm$Victories)
av9.ci.p.hm<-sum(a9.ci.p.hm$Victories)
av10.ci.p.hm<-sum(a10.ci.p.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.ic.p<-(sum(av1.ci.p.hm, av2.ci.p.hm, av3.ci.p.hm, av4.ci.p.hm, av5.ci.p.hm, av6.ci.p.hm, av7.ci.p.hm, av8.ci.p.hm, av9.ci.p.hm, av10.ci.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.ic.p<-(sum(int1.ci.p.hm, int2.ci.p.hm, int3.ci.p.hm, int4.ci.p.hm, int5.ci.p.hm, int6.ci.p.hm, int7.ci.p.hm, int8.ci.p.hm, int9.ci.p.hm, int10.ci.p.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.hm<-e1.ci.p.hm[order(e1.ci.p.hm$ID),]
e1.ci.p.hm<-as.matrix(t(e1.1.ci.p.hm))

e2.ci.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.hm<-e2.ci.p.hm[order(e2.ci.p.hm$ID),]
e2.ci.p.hm<-as.matrix(t(e2.1.ci.p.hm))

e3.ci.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.hm<-e3.ci.p.hm[order(e3.ci.p.hm$ID),]
e3.ci.p.hm<-as.matrix(t(e3.1.ci.p.hm))

e4.ci.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.hm<-e4.ci.p.hm[order(e4.ci.p.hm$ID),]
e4.ci.p.hm<-as.matrix(t(e4.1.ci.p.hm))

e5.ci.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.hm<-e5.ci.p.hm[order(e5.ci.p.hm$ID),]
e5.ci.p.hm<-as.matrix(t(e5.1.ci.p.hm))

e6.ci.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.hm<-e6.ci.p.hm[order(e6.ci.p.hm$ID),]
e6.ci.p.hm<-as.matrix(t(e6.1.ci.p.hm))

e7.ci.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.hm<-e7.ci.p.hm[order(e7.ci.p.hm$ID),]
e7.ci.p.hm<-as.matrix(t(e7.1.ci.p.hm))

e8.ci.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.hm<-e8.ci.p.hm[order(e8.ci.p.hm$ID),]
e8.ci.p.hm<-as.matrix(t(e8.1.ci.p.hm))

e9.ci.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.hm<-e9.ci.p.hm[order(e9.ci.p.hm$ID),]
e9.ci.p.hm<-as.matrix(t(e9.1.ci.p.hm))

e10.ci.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.hm<-e10.ci.p.hm[order(e10.ci.p.hm$ID),]
e10.ci.p.hm<-as.matrix(t(e10.1.ci.p.hm))

energy.hm.ci.p.hm<-as.data.frame(matrix(c(e1.ci.p.hm,e2.ci.p.hm,e3.ci.p.hm,e4.ci.p.hm,e5.ci.p.hm,e6.ci.p.hm,e7.ci.p.hm,e8.ci.p.hm,e9.ci.p.hm,e10.ci.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.ci.p.hm<-data.frame(ID=energy.hm.ci.p.hm$V1,energy_over_distance=energy.hm.ci.p.hm$V2,energy_over_time=energy.hm.ci.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.hm<-david1.ci.p.hm[order(david1.ci.p.hm$ID),]
david1.ci.p.hm<-as.matrix(t(david1.1.ci.p.hm))

david2.1.ci.p.hm<-david2.ci.p.hm[order(david2.ci.p.hm$ID),]
david2.ci.p.hm<-as.matrix(t(david2.1.ci.p.hm))

david3.1.ci.p.hm<-david3.ci.p.hm[order(david3.ci.p.hm$ID),]
david3.ci.p.hm<-as.matrix(t(david3.1.ci.p.hm))

david4.1.ci.p.hm<-david4.ci.p.hm[order(david4.ci.p.hm$ID),]
david4.ci.p.hm<-as.matrix(t(david4.1.ci.p.hm))

david5.1.ci.p.hm<-david5.ci.p.hm[order(david5.ci.p.hm$ID),]
david5.ci.p.hm<-as.matrix(t(david5.1.ci.p.hm))

david6.1.ci.p.hm<-david6.ci.p.hm[order(david6.ci.p.hm$ID),]
david6.ci.p.hm<-as.matrix(t(david6.1.ci.p.hm))

david7.1.ci.p.hm<-david7.ci.p.hm[order(david7.ci.p.hm$ID),]
david7.ci.p.hm<-as.matrix(t(david7.1.ci.p.hm))

david8.1.ci.p.hm<-david8.ci.p.hm[order(david8.ci.p.hm$ID),]
david8.ci.p.hm<-as.matrix(t(david8.1.ci.p.hm))

david9.1.ci.p.hm<-david9.ci.p.hm[order(david9.ci.p.hm$ID),]
david9.ci.p.hm<-as.matrix(t(david9.1.ci.p.hm))

david10.1.ci.p.hm<-david10.ci.p.hm[order(david10.ci.p.hm$ID),]
david10.ci.p.hm<-as.matrix(t(david10.1.ci.p.hm))

david.hm.ci.p.hm<-as.data.frame(matrix(c(david1.ci.p.hm,david2.ci.p.hm,david3.ci.p.hm,david4.ci.p.hm,david5.ci.p.hm,david6.ci.p.hm,david7.ci.p.hm,david8.ci.p.hm,david9.ci.p.hm,david10.ci.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.ci.p.hm<-data.frame(ID=david.hm.ci.p.hm$V1,DS=david.hm.ci.p.hm$V2,normDS=david.hm.ci.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.ci.p.hm<-lm(e1.1.ci.p.hm$energy_over_time~as.numeric(david1.1.ci.p.hm$normDS))
hm.lm.1.s.ci.p.hm<-summary(lm.hm.1.ci.p.hm)$coefficients
hm.1.slope.ci.p.hm<-hm.lm.1.s.ci.p.hm[2,1]
lm.hm.2.ci.p.hm<-lm(e2.1.ci.p.hm$energy_over_time~as.numeric(david2.1.ci.p.hm$normDS))
hm.lm.2.s.ci.p.hm<-summary(lm.hm.2.ci.p.hm)$coefficients
hm.2.slope.ci.p.hm<-hm.lm.2.s.ci.p.hm[2,1]
lm.hm.3.ci.p.hm<-lm(e3.1.ci.p.hm$energy_over_time~as.numeric(david3.1.ci.p.hm$normDS))
hm.lm.3.s.ci.p.hm<-summary(lm.hm.3.ci.p.hm)$coefficients
hm.3.slope.ci.p.hm<-hm.lm.3.s.ci.p.hm[2,1]
lm.hm.4.ci.p.hm<-lm(e4.1.ci.p.hm$energy_over_time~as.numeric(david4.1.ci.p.hm$normDS))
hm.lm.4.s.ci.p.hm<-summary(lm.hm.4.ci.p.hm)$coefficients
hm.4.slope.ci.p.hm<-hm.lm.4.s.ci.p.hm[2,1]
lm.hm.5.ci.p.hm<-lm(e5.1.ci.p.hm$energy_over_time~as.numeric(david5.1.ci.p.hm$normDS))
hm.lm.5.s.ci.p.hm<-summary(lm.hm.5.ci.p.hm)$coefficients
hm.5.slope.ci.p.hm<-hm.lm.5.s.ci.p.hm[2,1]
lm.hm.6.ci.p.hm<-lm(e6.1.ci.p.hm$energy_over_time~as.numeric(david6.1.ci.p.hm$normDS))
hm.lm.6.s.ci.p.hm<-summary(lm.hm.6.ci.p.hm)$coefficients
hm.6.slope.ci.p.hm<-hm.lm.6.s.ci.p.hm[2,1]
lm.hm.7.ci.p.hm<-lm(e7.1.ci.p.hm$energy_over_time~as.numeric(david7.1.ci.p.hm$normDS))
hm.lm.7.s.ci.p.hm<-summary(lm.hm.7.ci.p.hm)$coefficients
hm.7.slope.ci.p.hm<-hm.lm.7.s.ci.p.hm[2,1]
lm.hm.8.ci.p.hm<-lm(e8.1.ci.p.hm$energy_over_time~as.numeric(david8.1.ci.p.hm$normDS))
hm.lm.8.s.ci.p.hm<-summary(lm.hm.8.ci.p.hm)$coefficients
hm.8.slope.ci.p.hm<-hm.lm.8.s.ci.p.hm[2,1]
lm.hm.9.ci.p.hm<-lm(e9.1.ci.p.hm$energy_over_time~as.numeric(david9.1.ci.p.hm$normDS))
hm.lm.9.s.ci.p.hm<-summary(lm.hm.9.ci.p.hm)$coefficients
hm.9.slope.ci.p.hm<-hm.lm.9.s.ci.p.hm[2,1]
lm.hm.10.ci.p.hm<-lm(e10.1.ci.p.hm$energy_over_time~as.numeric(david10.1.ci.p.hm$normDS))
hm.lm.10.s.ci.p.hm<-summary(lm.hm.10.ci.p.hm)$coefficients
hm.10.slope.ci.p.hm<-hm.lm.10.s.ci.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.hm,tri2.ci.p.hm,tri3.ci.p.hm,tri4.ci.p.hm,tri5.ci.p.hm,tri6.ci.p.hm,tri7.ci.p.hm,tri8.ci.p.hm,tri9.ci.p.hm,tri10.ci.p.hm),escalation=c(ep1.ci.p.hm,ep2.ci.p.hm,ep3.ci.p.hm,ep4.ci.p.hm,ep5.ci.p.hm,ep6.ci.p.hm,ep7.ci.p.hm,ep8.ci.p.hm,ep9.ci.p.hm,ep10.ci.p.hm),dci=c(dci1.ci.p.hm,dci2.ci.p.hm,dci3.ci.p.hm,dci4.ci.p.hm,dci5.ci.p.hm,dci6.ci.p.hm,dci7.ci.p.hm,dci8.ci.p.hm,dci9.ci.p.hm,dci10.ci.p.hm),steepness=c(s1.ci.p.hm,s2.ci.p.hm,s3.ci.p.hm,s4.ci.p.hm,s5.ci.p.hm,s6.ci.p.hm,s7.ci.p.hm,s8.ci.p.hm,s9.ci.p.hm,s10.ci.p.hm),slope=c(hm.1.slope.ci.p.hm,hm.2.slope.ci.p.hm,hm.3.slope.ci.p.hm,hm.4.slope.ci.p.hm,hm.5.slope.ci.p.hm,hm.6.slope.ci.p.hm,hm.7.slope.ci.p.hm,hm.8.slope.ci.p.hm,hm.9.slope.ci.p.hm,hm.10.slope.ci.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the History Self Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.hs<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[1]],X2=avoid.ci.p.hs[[2]],Avoids=avoid.ci.p.hs[[3]])
a2.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[4]],X2=avoid.ci.p.hs[[5]],Avoids=avoid.ci.p.hs[[6]])
a3.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[7]],X2=avoid.ci.p.hs[[8]],Avoids=avoid.ci.p.hs[[9]])
a4.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[10]],X2=avoid.ci.p.hs[[11]],Avoids=avoid.ci.p.hs[[12]])
a5.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[13]],X2=avoid.ci.p.hs[[14]],Avoids=avoid.ci.p.hs[[15]])
a6.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[16]],X2=avoid.ci.p.hs[[17]],Avoids=avoid.ci.p.hs[[18]])
a7.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[19]],X2=avoid.ci.p.hs[[20]],Avoids=avoid.ci.p.hs[[21]])
a8.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[22]],X2=avoid.ci.p.hs[[23]],Avoids=avoid.ci.p.hs[[24]])
a9.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[25]],X2=avoid.ci.p.hs[[26]],Avoids=avoid.ci.p.hs[[27]])
a10.ci.p.hs<-data.frame(X1=avoid.ci.p.hs[[28]],X2=avoid.ci.p.hs[[29]],Avoids=avoid.ci.p.hs[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hs.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[1]],X2=conflict.hs.ci.p[[2]],Victories=conflict.hs.ci.p[[3]])
mat1.ci.p.hs<-inter.mat(mut1.ci.p.hs)
tri1.ci.p.hs<-tr.tri(mat1.ci.p.hs)
dci1.ci.p.hs<-DCindex(mat1.ci.p.hs)
mat1.ci.p.hs[is.na(mat1.ci.p.hs)] = 0
h1.ci.p.hs<-h.index(mat1.ci.p.hs)

ep1.ci.p.hs<-ep(mut1.ci.p.hs,a1.ci.p.hs)
david1.ci.p.hs<-DS(mat1.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.hs<-cbind(ordrank.1.ci.p.hs,ds=david1.ci.p.hs$normDS)
lm1.ci.p.hs<-summary(lm(ordrank.1.ci.p.hs$ds~ordrank.1.ci.p.hs$ord.rank))
s1.ci.p.hs<-lm1.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[4]],X2=conflict.hs.ci.p[[5]],Victories=conflict.hs.ci.p[[6]])
mat2.ci.p.hs<-inter.mat(mut2.ci.p.hs)
tri2.ci.p.hs<-tr.tri(mat2.ci.p.hs)
dci2.ci.p.hs<-DCindex(mat2.ci.p.hs)
mat2.ci.p.hs[is.na(mat2.ci.p.hs)] = 0
h2.ci.p.hs<-h.index(mat2.ci.p.hs)

ep2.ci.p.hs<-ep(mut2.ci.p.hs,a2.ci.p.hs)
david2.ci.p.hs<-DS(mat2.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.hs<-cbind(ordrank.2.ci.p.hs,ds=david2.ci.p.hs$normDS)
lm2.ci.p.hs<-summary(lm(ordrank.2.ci.p.hs$ds~ordrank.2.ci.p.hs$ord.rank))
s2.ci.p.hs<-lm2.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[7]],X2=conflict.hs.ci.p[[8]],Victories=conflict.hs.ci.p[[9]])
mat3.ci.p.hs<-inter.mat(mut3.ci.p.hs)
tri3.ci.p.hs<-tr.tri(mat3.ci.p.hs)
dci3.ci.p.hs<-DCindex(mat3.ci.p.hs)
mat3.ci.p.hs[is.na(mat3.ci.p.hs)] = 0
h3.ci.p.hs<-h.index(mat3.ci.p.hs)

ep3.ci.p.hs<-ep(mut3.ci.p.hs,a3.ci.p.hs)
david3.ci.p.hs<-DS(mat3.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.hs<-cbind(ordrank.3.ci.p.hs,ds=david3.ci.p.hs$normDS)
lm3.ci.p.hs<-summary(lm(ordrank.3.ci.p.hs$ds~ordrank.3.ci.p.hs$ord.rank))
s3.ci.p.hs<-lm3.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[10]],X2=conflict.hs.ci.p[[11]],Victories=conflict.hs.ci.p[[12]])
mat4.ci.p.hs<-inter.mat(mut4.ci.p.hs)
tri4.ci.p.hs<-tr.tri(mat4.ci.p.hs)
dci4.ci.p.hs<-DCindex(mat4.ci.p.hs)
mat4.ci.p.hs[is.na(mat4.ci.p.hs)] = 0
h4.ci.p.hs<-h.index(mat4.ci.p.hs)

ep4.ci.p.hs<-ep(mut4.ci.p.hs,a4.ci.p.hs)
david4.ci.p.hs<-DS(mat4.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.hs<-cbind(ordrank.4.ci.p.hs,ds=david4.ci.p.hs$normDS)
lm4.ci.p.hs<-summary(lm(ordrank.4.ci.p.hs$ds~ordrank.4.ci.p.hs$ord.rank))
s4.ci.p.hs<-lm4.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[13]],X2=conflict.hs.ci.p[[14]],Victories=conflict.hs.ci.p[[15]])
mat5.ci.p.hs<-inter.mat(mut5.ci.p.hs)
tri5.ci.p.hs<-tr.tri(mat5.ci.p.hs)
dci5.ci.p.hs<-DCindex(mat5.ci.p.hs)
mat5.ci.p.hs[is.na(mat5.ci.p.hs)] = 0
h5.ci.p.hs<-h.index(mat5.ci.p.hs)

ep5.ci.p.hs<-ep(mut5.ci.p.hs,a5.ci.p.hs)
david5.ci.p.hs<-DS(mat5.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.hs<-cbind(ordrank.5.ci.p.hs,ds=david5.ci.p.hs$normDS)
lm5.ci.p.hs<-summary(lm(ordrank.5.ci.p.hs$ds~ordrank.5.ci.p.hs$ord.rank))
s5.ci.p.hs<-lm5.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[16]],X2=conflict.hs.ci.p[[17]],Victories=conflict.hs.ci.p[[18]])
mat6.ci.p.hs<-inter.mat(mut6.ci.p.hs)
tri6.ci.p.hs<-tr.tri(mat6.ci.p.hs)
dci6.ci.p.hs<-DCindex(mat6.ci.p.hs)
mat6.ci.p.hs[is.na(mat6.ci.p.hs)] = 0
h6.ci.p.hs<-h.index(mat6.ci.p.hs)

ep6.ci.p.hs<-ep(mut6.ci.p.hs,a6.ci.p.hs)
david6.ci.p.hs<-DS(mat6.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.hs<-cbind(ordrank.6.ci.p.hs,ds=david6.ci.p.hs$normDS)
lm6.ci.p.hs<-summary(lm(ordrank.6.ci.p.hs$ds~ordrank.6.ci.p.hs$ord.rank))
s6.ci.p.hs<-lm6.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[19]],X2=conflict.hs.ci.p[[20]],Victories=conflict.hs.ci.p[[21]])
mat7.ci.p.hs<-inter.mat(mut7.ci.p.hs)
tri7.ci.p.hs<-tr.tri(mat7.ci.p.hs)
dci7.ci.p.hs<-DCindex(mat7.ci.p.hs)
mat7.ci.p.hs[is.na(mat7.ci.p.hs)] = 0
h7.ci.p.hs<-h.index(mat7.ci.p.hs)

ep7.ci.p.hs<-ep(mut7.ci.p.hs,a7.ci.p.hs)
david7.ci.p.hs<-DS(mat7.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.hs<-cbind(ordrank.7.ci.p.hs,ds=david7.ci.p.hs$normDS)
lm7.ci.p.hs<-summary(lm(ordrank.7.ci.p.hs$ds~ordrank.7.ci.p.hs$ord.rank))
s7.ci.p.hs<-lm7.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[22]],X2=conflict.hs.ci.p[[23]],Victories=conflict.hs.ci.p[[24]])
mat8.ci.p.hs<-inter.mat(mut8.ci.p.hs)
tri8.ci.p.hs<-tr.tri(mat8.ci.p.hs)
dci8.ci.p.hs<-DCindex(mat8.ci.p.hs)
mat8.ci.p.hs[is.na(mat8.ci.p.hs)] = 0
h8.ci.p.hs<-h.index(mat8.ci.p.hs)

ep8.ci.p.hs<-ep(mut8.ci.p.hs,a8.ci.p.hs)
david8.ci.p.hs<-DS(mat8.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.hs<-cbind(ordrank.8.ci.p.hs,ds=david8.ci.p.hs$normDS)
lm8.ci.p.hs<-summary(lm(ordrank.8.ci.p.hs$ds~ordrank.8.ci.p.hs$ord.rank))
s8.ci.p.hs<-lm8.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[25]],X2=conflict.hs.ci.p[[26]],Victories=conflict.hs.ci.p[[27]])
mat9.ci.p.hs<-inter.mat(mut9.ci.p.hs)
tri9.ci.p.hs<-tr.tri(mat9.ci.p.hs)
dci9.ci.p.hs<-DCindex(mat9.ci.p.hs)
mat9.ci.p.hs[is.na(mat9.ci.p.hs)] = 0
h9.ci.p.hs<-h.index(mat9.ci.p.hs)

ep9.ci.p.hs<-ep(mut9.ci.p.hs,a9.ci.p.hs)
david9.ci.p.hs<-DS(mat9.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.hs<-cbind(ordrank.9.ci.p.hs,ds=david9.ci.p.hs$normDS)
lm9.ci.p.hs<-summary(lm(ordrank.9.ci.p.hs$ds~ordrank.9.ci.p.hs$ord.rank))
s9.ci.p.hs<-lm9.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.hs<-data.frame(X1=conflict.hs.ci.p[[28]],X2=conflict.hs.ci.p[[29]],Victories=conflict.hs.ci.p[[30]])
mat10.ci.p.hs<-inter.mat(mut10.ci.p.hs)
tri10.ci.p.hs<-tr.tri(mat10.ci.p.hs)
dci10.ci.p.hs<-DCindex(mat10.ci.p.hs)
mat10.ci.p.hs[is.na(mat10.ci.p.hs)] = 0
h10.ci.p.hs<-h.index(mat10.ci.p.hs)

ep10.ci.p.hs<-ep(mut10.ci.p.hs,a10.ci.p.hs)
david10.ci.p.hs<-DS(mat10.ci.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.hs<-cbind(ordrank.10.ci.p.hs,ds=david10.ci.p.hs$normDS)
lm10.ci.p.hs<-summary(lm(ordrank.10.ci.p.hs$ds~ordrank.10.ci.p.hs$ord.rank))
s10.ci.p.hs<-lm10.ci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.hs<-sum(mut1.ci.p.hs$Victories)
int2.ci.p.hs<-sum(mut2.ci.p.hs$Victories)
int3.ci.p.hs<-sum(mut3.ci.p.hs$Victories)
int4.ci.p.hs<-sum(mut4.ci.p.hs$Victories)
int5.ci.p.hs<-sum(mut5.ci.p.hs$Victories)
int6.ci.p.hs<-sum(mut6.ci.p.hs$Victories)
int7.ci.p.hs<-sum(mut7.ci.p.hs$Victories)
int8.ci.p.hs<-sum(mut8.ci.p.hs$Victories)
int9.ci.p.hs<-sum(mut9.ci.p.hs$Victories)
int10.ci.p.hs<-sum(mut10.ci.p.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.hs<-sum(a1.ci.p.hs$Victories)
av2.ci.p.hs<-sum(a2.ci.p.hs$Victories)
av3.ci.p.hs<-sum(a3.ci.p.hs$Victories)
av4.ci.p.hs<-sum(a4.ci.p.hs$Victories)
av5.ci.p.hs<-sum(a5.ci.p.hs$Victories)
av6.ci.p.hs<-sum(a6.ci.p.hs$Victories)
av7.ci.p.hs<-sum(a7.ci.p.hs$Victories)
av8.ci.p.hs<-sum(a8.ci.p.hs$Victories)
av9.ci.p.hs<-sum(a9.ci.p.hs$Victories)
av10.ci.p.hs<-sum(a10.ci.p.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.ic.p<-(sum(av1.ci.p.hs, av2.ci.p.hs, av3.ci.p.hs, av4.ci.p.hs, av5.ci.p.hs, av6.ci.p.hs, av7.ci.p.hs, av8.ci.p.hs, av9.ci.p.hs, av10.ci.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.ic.p<-(sum(int1.ci.p.hs, int2.ci.p.hs, int3.ci.p.hs, int4.ci.p.hs, int5.ci.p.hs, int6.ci.p.hs, int7.ci.p.hs, int8.ci.p.hs, int9.ci.p.hs, int10.ci.p.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.hs<-e1.ci.p.hs[order(e1.ci.p.hs$ID),]
e1.ci.p.hs<-as.matrix(t(e1.1.ci.p.hs))

e2.ci.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.hs<-e2.ci.p.hs[order(e2.ci.p.hs$ID),]
e2.ci.p.hs<-as.matrix(t(e2.1.ci.p.hs))

e3.ci.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.hs<-e3.ci.p.hs[order(e3.ci.p.hs$ID),]
e3.ci.p.hs<-as.matrix(t(e3.1.ci.p.hs))

e4.ci.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.hs<-e4.ci.p.hs[order(e4.ci.p.hs$ID),]
e4.ci.p.hs<-as.matrix(t(e4.1.ci.p.hs))

e5.ci.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.hs<-e5.ci.p.hs[order(e5.ci.p.hs$ID),]
e5.ci.p.hs<-as.matrix(t(e5.1.ci.p.hs))

e6.ci.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.hs<-e6.ci.p.hs[order(e6.ci.p.hs$ID),]
e6.ci.p.hs<-as.matrix(t(e6.1.ci.p.hs))

e7.ci.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.hs<-e7.ci.p.hs[order(e7.ci.p.hs$ID),]
e7.ci.p.hs<-as.matrix(t(e7.1.ci.p.hs))

e8.ci.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.hs<-e8.ci.p.hs[order(e8.ci.p.hs$ID),]
e8.ci.p.hs<-as.matrix(t(e8.1.ci.p.hs))

e9.ci.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.hs<-e9.ci.p.hs[order(e9.ci.p.hs$ID),]
e9.ci.p.hs<-as.matrix(t(e9.1.ci.p.hs))

e10.ci.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.hs<-e10.ci.p.hs[order(e10.ci.p.hs$ID),]
e10.ci.p.hs<-as.matrix(t(e10.1.ci.p.hs))

energy.hs.ci.p.hs<-as.data.frame(matrix(c(e1.ci.p.hs,e2.ci.p.hs,e3.ci.p.hs,e4.ci.p.hs,e5.ci.p.hs,e6.ci.p.hs,e7.ci.p.hs,e8.ci.p.hs,e9.ci.p.hs,e10.ci.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.ci.p.hs<-data.frame(ID=energy.hs.ci.p.hs$V1,energy_over_distance=energy.hs.ci.p.hs$V2,energy_over_time=energy.hs.ci.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.hs<-david1.ci.p.hs[order(david1.ci.p.hs$ID),]
david1.ci.p.hs<-as.matrix(t(david1.1.ci.p.hs))

david2.1.ci.p.hs<-david2.ci.p.hs[order(david2.ci.p.hs$ID),]
david2.ci.p.hs<-as.matrix(t(david2.1.ci.p.hs))

david3.1.ci.p.hs<-david3.ci.p.hs[order(david3.ci.p.hs$ID),]
david3.ci.p.hs<-as.matrix(t(david3.1.ci.p.hs))

david4.1.ci.p.hs<-david4.ci.p.hs[order(david4.ci.p.hs$ID),]
david4.ci.p.hs<-as.matrix(t(david4.1.ci.p.hs))

david5.1.ci.p.hs<-david5.ci.p.hs[order(david5.ci.p.hs$ID),]
david5.ci.p.hs<-as.matrix(t(david5.1.ci.p.hs))

david6.1.ci.p.hs<-david6.ci.p.hs[order(david6.ci.p.hs$ID),]
david6.ci.p.hs<-as.matrix(t(david6.1.ci.p.hs))

david7.1.ci.p.hs<-david7.ci.p.hs[order(david7.ci.p.hs$ID),]
david7.ci.p.hs<-as.matrix(t(david7.1.ci.p.hs))

david8.1.ci.p.hs<-david8.ci.p.hs[order(david8.ci.p.hs$ID),]
david8.ci.p.hs<-as.matrix(t(david8.1.ci.p.hs))

david9.1.ci.p.hs<-david9.ci.p.hs[order(david9.ci.p.hs$ID),]
david9.ci.p.hs<-as.matrix(t(david9.1.ci.p.hs))

david10.1.ci.p.hs<-david10.ci.p.hs[order(david10.ci.p.hs$ID),]
david10.ci.p.hs<-as.matrix(t(david10.1.ci.p.hs))

david.hs.ci.p.hs<-as.data.frame(matrix(c(david1.ci.p.hs,david2.ci.p.hs,david3.ci.p.hs,david4.ci.p.hs,david5.ci.p.hs,david6.ci.p.hs,david7.ci.p.hs,david8.ci.p.hs,david9.ci.p.hs,david10.ci.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.ci.p.hs<-data.frame(ID=david.hs.ci.p.hs$V1,DS=david.hs.ci.p.hs$V2,normDS=david.hs.ci.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.ci.p.hs<-lm(e1.1.ci.p.hs$energy_over_time~as.numeric(david1.1.ci.p.hs$normDS))
hs.lm.1.s.ci.p.hs<-summary(lm.hs.1.ci.p.hs)$coefficients
hs.1.slope.ci.p.hs<-hs.lm.1.s.ci.p.hs[2,1]
lm.hs.2.ci.p.hs<-lm(e2.1.ci.p.hs$energy_over_time~as.numeric(david2.1.ci.p.hs$normDS))
hs.lm.2.s.ci.p.hs<-summary(lm.hs.2.ci.p.hs)$coefficients
hs.2.slope.ci.p.hs<-hs.lm.2.s.ci.p.hs[2,1]
lm.hs.3.ci.p.hs<-lm(e3.1.ci.p.hs$energy_over_time~as.numeric(david3.1.ci.p.hs$normDS))
hs.lm.3.s.ci.p.hs<-summary(lm.hs.3.ci.p.hs)$coefficients
hs.3.slope.ci.p.hs<-hs.lm.3.s.ci.p.hs[2,1]
lm.hs.4.ci.p.hs<-lm(e4.1.ci.p.hs$energy_over_time~as.numeric(david4.1.ci.p.hs$normDS))
hs.lm.4.s.ci.p.hs<-summary(lm.hs.4.ci.p.hs)$coefficients
hs.4.slope.ci.p.hs<-hs.lm.4.s.ci.p.hs[2,1]
lm.hs.5.ci.p.hs<-lm(e5.1.ci.p.hs$energy_over_time~as.numeric(david5.1.ci.p.hs$normDS))
hs.lm.5.s.ci.p.hs<-summary(lm.hs.5.ci.p.hs)$coefficients
hs.5.slope.ci.p.hs<-hs.lm.5.s.ci.p.hs[2,1]
lm.hs.6.ci.p.hs<-lm(e6.1.ci.p.hs$energy_over_time~as.numeric(david6.1.ci.p.hs$normDS))
hs.lm.6.s.ci.p.hs<-summary(lm.hs.6.ci.p.hs)$coefficients
hs.6.slope.ci.p.hs<-hs.lm.6.s.ci.p.hs[2,1]
lm.hs.7.ci.p.hs<-lm(e7.1.ci.p.hs$energy_over_time~as.numeric(david7.1.ci.p.hs$normDS))
hs.lm.7.s.ci.p.hs<-summary(lm.hs.7.ci.p.hs)$coefficients
hs.7.slope.ci.p.hs<-hs.lm.7.s.ci.p.hs[2,1]
lm.hs.8.ci.p.hs<-lm(e8.1.ci.p.hs$energy_over_time~as.numeric(david8.1.ci.p.hs$normDS))
hs.lm.8.s.ci.p.hs<-summary(lm.hs.8.ci.p.hs)$coefficients
hs.8.slope.ci.p.hs<-hs.lm.8.s.ci.p.hs[2,1]
lm.hs.9.ci.p.hs<-lm(e9.1.ci.p.hs$energy_over_time~as.numeric(david9.1.ci.p.hs$normDS))
hs.lm.9.s.ci.p.hs<-summary(lm.hs.9.ci.p.hs)$coefficients
hs.9.slope.ci.p.hs<-hs.lm.9.s.ci.p.hs[2,1]
lm.hs.10.ci.p.hs<-lm(e10.1.ci.p.hs$energy_over_time~as.numeric(david10.1.ci.p.hs$normDS))
hs.lm.10.s.ci.p.hs<-summary(lm.hs.10.ci.p.hs)$coefficients
hs.10.slope.ci.p.hs<-hs.lm.10.s.ci.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.hs,tri2.ci.p.hs,tri3.ci.p.hs,tri4.ci.p.hs,tri5.ci.p.hs,tri6.ci.p.hs,tri7.ci.p.hs,tri8.ci.p.hs,tri9.ci.p.hs,tri10.ci.p.hs),escalation=c(ep1.ci.p.hs,ep2.ci.p.hs,ep3.ci.p.hs,ep4.ci.p.hs,ep5.ci.p.hs,ep6.ci.p.hs,ep7.ci.p.hs,ep8.ci.p.hs,ep9.ci.p.hs,ep10.ci.p.hs),dci=c(dci1.ci.p.hs,dci2.ci.p.hs,dci3.ci.p.hs,dci4.ci.p.hs,dci5.ci.p.hs,dci6.ci.p.hs,dci7.ci.p.hs,dci8.ci.p.hs,dci9.ci.p.hs,dci10.ci.p.hs),steepness=c(s1.ci.p.hs,s2.ci.p.hs,s3.ci.p.hs,s4.ci.p.hs,s5.ci.p.hs,s6.ci.p.hs,s7.ci.p.hs,s8.ci.p.hs,s9.ci.p.hs,s10.ci.p.hs),slope=c(hs.1.slope.ci.p.hs,hs.2.slope.ci.p.hs,hs.3.slope.ci.p.hs,hs.4.slope.ci.p.hs,hs.5.slope.ci.p.hs,hs.6.slope.ci.p.hs,hs.7.slope.ci.p.hs,hs.8.slope.ci.p.hs,hs.9.slope.ci.p.hs,hs.10.slope.ci.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the History Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ho<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[1]],X2=avoid.ci.p.ho[[2]],Avoids=avoid.ci.p.ho[[3]])
a2.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[4]],X2=avoid.ci.p.ho[[5]],Avoids=avoid.ci.p.ho[[6]])
a3.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[7]],X2=avoid.ci.p.ho[[8]],Avoids=avoid.ci.p.ho[[9]])
a4.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[10]],X2=avoid.ci.p.ho[[11]],Avoids=avoid.ci.p.ho[[12]])
a5.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[13]],X2=avoid.ci.p.ho[[14]],Avoids=avoid.ci.p.ho[[15]])
a6.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[16]],X2=avoid.ci.p.ho[[17]],Avoids=avoid.ci.p.ho[[18]])
a7.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[19]],X2=avoid.ci.p.ho[[20]],Avoids=avoid.ci.p.ho[[21]])
a8.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[22]],X2=avoid.ci.p.ho[[23]],Avoids=avoid.ci.p.ho[[24]])
a9.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[25]],X2=avoid.ci.p.ho[[26]],Avoids=avoid.ci.p.ho[[27]])
a10.ci.p.ho<-data.frame(X1=avoid.ci.p.ho[[28]],X2=avoid.ci.p.ho[[29]],Avoids=avoid.ci.p.ho[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ho.ci.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[1]],X2=conflict.ho.ci.p[[2]],Victories=conflict.ho.ci.p[[3]])
mat1.ci.p.ho<-inter.mat(mut1.ci.p.ho)
tri1.ci.p.ho<-tr.tri(mat1.ci.p.ho)
dci1.ci.p.ho<-DCindex(mat1.ci.p.ho)
mat1.ci.p.ho[is.na(mat1.ci.p.ho)] = 0
h1.ci.p.ho<-h.index(mat1.ci.p.ho)

ep1.ci.p.ho<-ep(mut1.ci.p.ho,a1.ci.p.ho)
david1.ci.p.ho<-DS(mat1.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ci.p.ho<-cbind(ordrank.1.ci.p.ho,ds=david1.ci.p.ho$normDS)
lm1.ci.p.ho<-summary(lm(ordrank.1.ci.p.ho$ds~ordrank.1.ci.p.ho$ord.rank))
s1.ci.p.ho<-lm1.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[4]],X2=conflict.ho.ci.p[[5]],Victories=conflict.ho.ci.p[[6]])
mat2.ci.p.ho<-inter.mat(mut2.ci.p.ho)
tri2.ci.p.ho<-tr.tri(mat2.ci.p.ho)
dci2.ci.p.ho<-DCindex(mat2.ci.p.ho)
mat2.ci.p.ho[is.na(mat2.ci.p.ho)] = 0
h2.ci.p.ho<-h.index(mat2.ci.p.ho)

ep2.ci.p.ho<-ep(mut2.ci.p.ho,a2.ci.p.ho)
david2.ci.p.ho<-DS(mat2.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ci.p.ho<-cbind(ordrank.2.ci.p.ho,ds=david2.ci.p.ho$normDS)
lm2.ci.p.ho<-summary(lm(ordrank.2.ci.p.ho$ds~ordrank.2.ci.p.ho$ord.rank))
s2.ci.p.ho<-lm2.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[7]],X2=conflict.ho.ci.p[[8]],Victories=conflict.ho.ci.p[[9]])
mat3.ci.p.ho<-inter.mat(mut3.ci.p.ho)
tri3.ci.p.ho<-tr.tri(mat3.ci.p.ho)
dci3.ci.p.ho<-DCindex(mat3.ci.p.ho)
mat3.ci.p.ho[is.na(mat3.ci.p.ho)] = 0
h3.ci.p.ho<-h.index(mat3.ci.p.ho)

ep3.ci.p.ho<-ep(mut3.ci.p.ho,a3.ci.p.ho)
david3.ci.p.ho<-DS(mat3.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ci.p.ho<-cbind(ordrank.3.ci.p.ho,ds=david3.ci.p.ho$normDS)
lm3.ci.p.ho<-summary(lm(ordrank.3.ci.p.ho$ds~ordrank.3.ci.p.ho$ord.rank))
s3.ci.p.ho<-lm3.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[10]],X2=conflict.ho.ci.p[[11]],Victories=conflict.ho.ci.p[[12]])
mat4.ci.p.ho<-inter.mat(mut4.ci.p.ho)
tri4.ci.p.ho<-tr.tri(mat4.ci.p.ho)
dci4.ci.p.ho<-DCindex(mat4.ci.p.ho)
mat4.ci.p.ho[is.na(mat4.ci.p.ho)] = 0
h4.ci.p.ho<-h.index(mat4.ci.p.ho)

ep4.ci.p.ho<-ep(mut4.ci.p.ho,a4.ci.p.ho)
david4.ci.p.ho<-DS(mat4.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ci.p.ho<-cbind(ordrank.4.ci.p.ho,ds=david4.ci.p.ho$normDS)
lm4.ci.p.ho<-summary(lm(ordrank.4.ci.p.ho$ds~ordrank.4.ci.p.ho$ord.rank))
s4.ci.p.ho<-lm4.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[13]],X2=conflict.ho.ci.p[[14]],Victories=conflict.ho.ci.p[[15]])
mat5.ci.p.ho<-inter.mat(mut5.ci.p.ho)
tri5.ci.p.ho<-tr.tri(mat5.ci.p.ho)
dci5.ci.p.ho<-DCindex(mat5.ci.p.ho)
mat5.ci.p.ho[is.na(mat5.ci.p.ho)] = 0
h5.ci.p.ho<-h.index(mat5.ci.p.ho)

ep5.ci.p.ho<-ep(mut5.ci.p.ho,a5.ci.p.ho)
david5.ci.p.ho<-DS(mat5.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ci.p.ho<-cbind(ordrank.5.ci.p.ho,ds=david5.ci.p.ho$normDS)
lm5.ci.p.ho<-summary(lm(ordrank.5.ci.p.ho$ds~ordrank.5.ci.p.ho$ord.rank))
s5.ci.p.ho<-lm5.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[16]],X2=conflict.ho.ci.p[[17]],Victories=conflict.ho.ci.p[[18]])
mat6.ci.p.ho<-inter.mat(mut6.ci.p.ho)
tri6.ci.p.ho<-tr.tri(mat6.ci.p.ho)
dci6.ci.p.ho<-DCindex(mat6.ci.p.ho)
mat6.ci.p.ho[is.na(mat6.ci.p.ho)] = 0
h6.ci.p.ho<-h.index(mat6.ci.p.ho)

ep6.ci.p.ho<-ep(mut6.ci.p.ho,a6.ci.p.ho)
david6.ci.p.ho<-DS(mat6.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ci.p.ho<-cbind(ordrank.6.ci.p.ho,ds=david6.ci.p.ho$normDS)
lm6.ci.p.ho<-summary(lm(ordrank.6.ci.p.ho$ds~ordrank.6.ci.p.ho$ord.rank))
s6.ci.p.ho<-lm6.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[19]],X2=conflict.ho.ci.p[[20]],Victories=conflict.ho.ci.p[[21]])
mat7.ci.p.ho<-inter.mat(mut7.ci.p.ho)
tri7.ci.p.ho<-tr.tri(mat7.ci.p.ho)
dci7.ci.p.ho<-DCindex(mat7.ci.p.ho)
mat7.ci.p.ho[is.na(mat7.ci.p.ho)] = 0
h7.ci.p.ho<-h.index(mat7.ci.p.ho)

ep7.ci.p.ho<-ep(mut7.ci.p.ho,a7.ci.p.ho)
david7.ci.p.ho<-DS(mat7.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ci.p.ho<-cbind(ordrank.7.ci.p.ho,ds=david7.ci.p.ho$normDS)
lm7.ci.p.ho<-summary(lm(ordrank.7.ci.p.ho$ds~ordrank.7.ci.p.ho$ord.rank))
s7.ci.p.ho<-lm7.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[22]],X2=conflict.ho.ci.p[[23]],Victories=conflict.ho.ci.p[[24]])
mat8.ci.p.ho<-inter.mat(mut8.ci.p.ho)
tri8.ci.p.ho<-tr.tri(mat8.ci.p.ho)
dci8.ci.p.ho<-DCindex(mat8.ci.p.ho)
mat8.ci.p.ho[is.na(mat8.ci.p.ho)] = 0
h8.ci.p.ho<-h.index(mat8.ci.p.ho)

ep8.ci.p.ho<-ep(mut8.ci.p.ho,a8.ci.p.ho)
david8.ci.p.ho<-DS(mat8.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ci.p.ho<-cbind(ordrank.8.ci.p.ho,ds=david8.ci.p.ho$normDS)
lm8.ci.p.ho<-summary(lm(ordrank.8.ci.p.ho$ds~ordrank.8.ci.p.ho$ord.rank))
s8.ci.p.ho<-lm8.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[25]],X2=conflict.ho.ci.p[[26]],Victories=conflict.ho.ci.p[[27]])
mat9.ci.p.ho<-inter.mat(mut9.ci.p.ho)
tri9.ci.p.ho<-tr.tri(mat9.ci.p.ho)
dci9.ci.p.ho<-DCindex(mat9.ci.p.ho)
mat9.ci.p.ho[is.na(mat9.ci.p.ho)] = 0
h9.ci.p.ho<-h.index(mat9.ci.p.ho)

ep9.ci.p.ho<-ep(mut9.ci.p.ho,a9.ci.p.ho)
david9.ci.p.ho<-DS(mat9.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ci.p.ho<-cbind(ordrank.9.ci.p.ho,ds=david9.ci.p.ho$normDS)
lm9.ci.p.ho<-summary(lm(ordrank.9.ci.p.ho$ds~ordrank.9.ci.p.ho$ord.rank))
s9.ci.p.ho<-lm9.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ci.p.ho<-data.frame(X1=conflict.ho.ci.p[[28]],X2=conflict.ho.ci.p[[29]],Victories=conflict.ho.ci.p[[30]])
mat10.ci.p.ho<-inter.mat(mut10.ci.p.ho)
tri10.ci.p.ho<-tr.tri(mat10.ci.p.ho)
dci10.ci.p.ho<-DCindex(mat10.ci.p.ho)
mat10.ci.p.ho[is.na(mat10.ci.p.ho)] = 0
h10.ci.p.ho<-h.index(mat10.ci.p.ho)

ep10.ci.p.ho<-ep(mut10.ci.p.ho,a10.ci.p.ho)
david10.ci.p.ho<-DS(mat10.ci.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.ci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ci.p.ho<-cbind(ordrank.10.ci.p.ho,ds=david10.ci.p.ho$normDS)
lm10.ci.p.ho<-summary(lm(ordrank.10.ci.p.ho$ds~ordrank.10.ci.p.ho$ord.rank))
s10.ci.p.ho<-lm10.ci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ci.p.ho<-sum(mut1.ci.p.ho$Victories)
int2.ci.p.ho<-sum(mut2.ci.p.ho$Victories)
int3.ci.p.ho<-sum(mut3.ci.p.ho$Victories)
int4.ci.p.ho<-sum(mut4.ci.p.ho$Victories)
int5.ci.p.ho<-sum(mut5.ci.p.ho$Victories)
int6.ci.p.ho<-sum(mut6.ci.p.ho$Victories)
int7.ci.p.ho<-sum(mut7.ci.p.ho$Victories)
int8.ci.p.ho<-sum(mut8.ci.p.ho$Victories)
int9.ci.p.ho<-sum(mut9.ci.p.ho$Victories)
int10.ci.p.ho<-sum(mut10.ci.p.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ho<-sum(a1.ci.p.ho$Victories)
av2.ci.p.ho<-sum(a2.ci.p.ho$Victories)
av3.ci.p.ho<-sum(a3.ci.p.ho$Victories)
av4.ci.p.ho<-sum(a4.ci.p.ho$Victories)
av5.ci.p.ho<-sum(a5.ci.p.ho$Victories)
av6.ci.p.ho<-sum(a6.ci.p.ho$Victories)
av7.ci.p.ho<-sum(a7.ci.p.ho$Victories)
av8.ci.p.ho<-sum(a8.ci.p.ho$Victories)
av9.ci.p.ho<-sum(a9.ci.p.ho$Victories)
av10.ci.p.ho<-sum(a10.ci.p.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.ic.p<-(sum(av1.ci.p.ho, av2.ci.p.ho, av3.ci.p.ho, av4.ci.p.ho, av5.ci.p.ho, av6.ci.p.ho, av7.ci.p.ho, av8.ci.p.ho, av9.ci.p.ho, av10.ci.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.ic.p<-(sum(int1.ci.p.ho, int2.ci.p.ho, int3.ci.p.ho, int4.ci.p.ho, int5.ci.p.ho, int6.ci.p.ho, int7.ci.p.ho, int8.ci.p.ho, int9.ci.p.ho, int10.ci.p.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ci.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ci.p.ho<-e1.ci.p.ho[order(e1.ci.p.ho$ID),]
e1.ci.p.ho<-as.matrix(t(e1.1.ci.p.ho))

e2.ci.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ci.p.ho<-e2.ci.p.ho[order(e2.ci.p.ho$ID),]
e2.ci.p.ho<-as.matrix(t(e2.1.ci.p.ho))

e3.ci.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ci.p.ho<-e3.ci.p.ho[order(e3.ci.p.ho$ID),]
e3.ci.p.ho<-as.matrix(t(e3.1.ci.p.ho))

e4.ci.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ci.p.ho<-e4.ci.p.ho[order(e4.ci.p.ho$ID),]
e4.ci.p.ho<-as.matrix(t(e4.1.ci.p.ho))

e5.ci.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ci.p.ho<-e5.ci.p.ho[order(e5.ci.p.ho$ID),]
e5.ci.p.ho<-as.matrix(t(e5.1.ci.p.ho))

e6.ci.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ci.p.ho<-e6.ci.p.ho[order(e6.ci.p.ho$ID),]
e6.ci.p.ho<-as.matrix(t(e6.1.ci.p.ho))

e7.ci.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ci.p.ho<-e7.ci.p.ho[order(e7.ci.p.ho$ID),]
e7.ci.p.ho<-as.matrix(t(e7.1.ci.p.ho))

e8.ci.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ci.p.ho<-e8.ci.p.ho[order(e8.ci.p.ho$ID),]
e8.ci.p.ho<-as.matrix(t(e8.1.ci.p.ho))

e9.ci.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ci.p.ho<-e9.ci.p.ho[order(e9.ci.p.ho$ID),]
e9.ci.p.ho<-as.matrix(t(e9.1.ci.p.ho))

e10.ci.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ci.p.ho<-e10.ci.p.ho[order(e10.ci.p.ho$ID),]
e10.ci.p.ho<-as.matrix(t(e10.1.ci.p.ho))

energy.ho.ci.p.ho<-as.data.frame(matrix(c(e1.ci.p.ho,e2.ci.p.ho,e3.ci.p.ho,e4.ci.p.ho,e5.ci.p.ho,e6.ci.p.ho,e7.ci.p.ho,e8.ci.p.ho,e9.ci.p.ho,e10.ci.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.ci.p.ho<-data.frame(ID=energy.ho.ci.p.ho$V1,energy_over_distance=energy.ho.ci.p.ho$V2,energy_over_time=energy.ho.ci.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ci.p.ho<-david1.ci.p.ho[order(david1.ci.p.ho$ID),]
david1.ci.p.ho<-as.matrix(t(david1.1.ci.p.ho))

david2.1.ci.p.ho<-david2.ci.p.ho[order(david2.ci.p.ho$ID),]
david2.ci.p.ho<-as.matrix(t(david2.1.ci.p.ho))

david3.1.ci.p.ho<-david3.ci.p.ho[order(david3.ci.p.ho$ID),]
david3.ci.p.ho<-as.matrix(t(david3.1.ci.p.ho))

david4.1.ci.p.ho<-david4.ci.p.ho[order(david4.ci.p.ho$ID),]
david4.ci.p.ho<-as.matrix(t(david4.1.ci.p.ho))

david5.1.ci.p.ho<-david5.ci.p.ho[order(david5.ci.p.ho$ID),]
david5.ci.p.ho<-as.matrix(t(david5.1.ci.p.ho))

david6.1.ci.p.ho<-david6.ci.p.ho[order(david6.ci.p.ho$ID),]
david6.ci.p.ho<-as.matrix(t(david6.1.ci.p.ho))

david7.1.ci.p.ho<-david7.ci.p.ho[order(david7.ci.p.ho$ID),]
david7.ci.p.ho<-as.matrix(t(david7.1.ci.p.ho))

david8.1.ci.p.ho<-david8.ci.p.ho[order(david8.ci.p.ho$ID),]
david8.ci.p.ho<-as.matrix(t(david8.1.ci.p.ho))

david9.1.ci.p.ho<-david9.ci.p.ho[order(david9.ci.p.ho$ID),]
david9.ci.p.ho<-as.matrix(t(david9.1.ci.p.ho))

david10.1.ci.p.ho<-david10.ci.p.ho[order(david10.ci.p.ho$ID),]
david10.ci.p.ho<-as.matrix(t(david10.1.ci.p.ho))

david.ho.ci.p.ho<-as.data.frame(matrix(c(david1.ci.p.ho,david2.ci.p.ho,david3.ci.p.ho,david4.ci.p.ho,david5.ci.p.ho,david6.ci.p.ho,david7.ci.p.ho,david8.ci.p.ho,david9.ci.p.ho,david10.ci.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.ci.p.ho<-data.frame(ID=david.ho.ci.p.ho$V1,DS=david.ho.ci.p.ho$V2,normDS=david.ho.ci.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.ci.p.ho<-lm(e1.1.ci.p.ho$energy_over_time~as.numeric(david1.1.ci.p.ho$normDS))
ho.lm.1.s.ci.p.ho<-summary(lm.ho.1.ci.p.ho)$coefficients
ho.1.slope.ci.p.ho<-ho.lm.1.s.ci.p.ho[2,1]
lm.ho.2.ci.p.ho<-lm(e2.1.ci.p.ho$energy_over_time~as.numeric(david2.1.ci.p.ho$normDS))
ho.lm.2.s.ci.p.ho<-summary(lm.ho.2.ci.p.ho)$coefficients
ho.2.slope.ci.p.ho<-ho.lm.2.s.ci.p.ho[2,1]
lm.ho.3.ci.p.ho<-lm(e3.1.ci.p.ho$energy_over_time~as.numeric(david3.1.ci.p.ho$normDS))
ho.lm.3.s.ci.p.ho<-summary(lm.ho.3.ci.p.ho)$coefficients
ho.3.slope.ci.p.ho<-ho.lm.3.s.ci.p.ho[2,1]
lm.ho.4.ci.p.ho<-lm(e4.1.ci.p.ho$energy_over_time~as.numeric(david4.1.ci.p.ho$normDS))
ho.lm.4.s.ci.p.ho<-summary(lm.ho.4.ci.p.ho)$coefficients
ho.4.slope.ci.p.ho<-ho.lm.4.s.ci.p.ho[2,1]
lm.ho.5.ci.p.ho<-lm(e5.1.ci.p.ho$energy_over_time~as.numeric(david5.1.ci.p.ho$normDS))
ho.lm.5.s.ci.p.ho<-summary(lm.ho.5.ci.p.ho)$coefficients
ho.5.slope.ci.p.ho<-ho.lm.5.s.ci.p.ho[2,1]
lm.ho.6.ci.p.ho<-lm(e6.1.ci.p.ho$energy_over_time~as.numeric(david6.1.ci.p.ho$normDS))
ho.lm.6.s.ci.p.ho<-summary(lm.ho.6.ci.p.ho)$coefficients
ho.6.slope.ci.p.ho<-ho.lm.6.s.ci.p.ho[2,1]
lm.ho.7.ci.p.ho<-lm(e7.1.ci.p.ho$energy_over_time~as.numeric(david7.1.ci.p.ho$normDS))
ho.lm.7.s.ci.p.ho<-summary(lm.ho.7.ci.p.ho)$coefficients
ho.7.slope.ci.p.ho<-ho.lm.7.s.ci.p.ho[2,1]
lm.ho.8.ci.p.ho<-lm(e8.1.ci.p.ho$energy_over_time~as.numeric(david8.1.ci.p.ho$normDS))
ho.lm.8.s.ci.p.ho<-summary(lm.ho.8.ci.p.ho)$coefficients
ho.8.slope.ci.p.ho<-ho.lm.8.s.ci.p.ho[2,1]
lm.ho.9.ci.p.ho<-lm(e9.1.ci.p.ho$energy_over_time~as.numeric(david9.1.ci.p.ho$normDS))
ho.lm.9.s.ci.p.ho<-summary(lm.ho.9.ci.p.ho)$coefficients
ho.9.slope.ci.p.ho<-ho.lm.9.s.ci.p.ho[2,1]
lm.ho.10.ci.p.ho<-lm(e10.1.ci.p.ho$energy_over_time~as.numeric(david10.1.ci.p.ho$normDS))
ho.lm.10.s.ci.p.ho<-summary(lm.ho.10.ci.p.ho)$coefficients
ho.10.slope.ci.p.ho<-ho.lm.10.s.ci.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.ci.p.ss<-data.frame(triangle.transitivity=c(tri1.ci.p.ho,tri2.ci.p.ho,tri3.ci.p.ho,tri4.ci.p.ho,tri5.ci.p.ho,tri6.ci.p.ho,tri7.ci.p.ho,tri8.ci.p.ho,tri9.ci.p.ho,tri10.ci.p.ho),escalation=c(ep1.ci.p.ho,ep2.ci.p.ho,ep3.ci.p.ho,ep4.ci.p.ho,ep5.ci.p.ho,ep6.ci.p.ho,ep7.ci.p.ho,ep8.ci.p.ho,ep9.ci.p.ho,ep10.ci.p.ho),dci=c(dci1.ci.p.ho,dci2.ci.p.ho,dci3.ci.p.ho,dci4.ci.p.ho,dci5.ci.p.ho,dci6.ci.p.ho,dci7.ci.p.ho,dci8.ci.p.ho,dci9.ci.p.ho,dci10.ci.p.ho),steepness=c(s1.ci.p.ho,s2.ci.p.ho,s3.ci.p.ho,s4.ci.p.ho,s5.ci.p.ho,s6.ci.p.ho,s7.ci.p.ho,s8.ci.p.ho,s9.ci.p.ho,s10.ci.p.ho),slope=c(ho.1.slope.ci.p.ho,ho.2.slope.ci.p.ho,ho.3.slope.ci.p.ho,ho.4.slope.ci.p.ho,ho.5.slope.ci.p.ho,ho.6.slope.ci.p.ho,ho.7.slope.ci.p.ho,ho.8.slope.ci.p.ho,ho.9.slope.ci.p.ho,ho.10.slope.ci.p.ho))

#Overall linear models of each scenario
km.lm.ic.p<-lm((energy.km.df.ci.p.km$energy_over_time)~as.numeric(david.km.df.ci.p.km$normDS)) #knowledge mutual linear model
ks.lm.ic.p<-lm((energy.ks.df.ci.p.ks$energy_over_time)~as.numeric(david.ks.df.ci.p.ks$normDS)) #knowledge self linear model
ko.lm.ic.p<-lm((energy.ko.df.ci.p.ko$energy_over_time)~as.numeric(david.ko.df.ci.p.ko$normDS)) #knowledge opp linear model
hm.lm.ic.p<-lm((energy.hm.df.ci.p.hm$energy_over_time)~as.numeric(david.hm.df.ci.p.hm$normDS)) #history mutual linear model
hs.lm.ic.p<-lm((energy.hs.df.ci.p.hs$energy_over_time)~as.numeric(david.hs.df.ci.p.hs$normDS)) #history self linear model
ho.lm.ic.p<-lm((energy.ho.df.ci.p.ho$energy_over_time)~as.numeric(david.ho.df.ci.p.ho$normDS)) #history opp linear model
```
```{r Clumped Initiator Wins Probabilistic Data Frame}
# Generate energy data frame:
total.energy.ic.p<-data.frame(energy.km.df.ci.p.km)
total.energy.ic.p<-rbind(total.energy.ic.p,energy.ks.df.ci.p.ks,energy.ko.df.ci.p.ko,energy.hm.df.ci.p.hm,energy.hs.df.ci.p.hs,energy.ho.df.ci.p.ho)

total.david.ic.p<-data.frame(david.km.df.ci.p.km)
total.david.ic.p<-rbind(total.david.ic.p,david.ks.df.ci.p.ks,david.ko.df.ci.p.ko,david.hm.df.ci.p.hm,david.hs.df.ci.p.hs,david.ho.df.ci.p.ho)

total.energy.ic.p<-cbind(total.energy.ic.p,normDS=total.david.ic.p$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.ic.p<-mean(km.ci.p.ss$triangle.transitivity)
  km.ic.pi.ic.p<-mean(km.ci.p.ss$dci)
  km.esc.ic.p<-mean(km.ci.p.ss$escalation)
  km.steep.ic.p<-mean(km.ci.p.ss$steepness)
  km.slope.ic.p<-mean(km.ci.p.ss$slope)
  km.mean.ic.p<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.ic.p,dci=km.ic.pi.ic.p,esc=km.esc.ic.p,steepness=km.steep.ic.p,slope=km.slope.ic.p,dist="clumped",calc="Probabilistic")

  # knowledge self
  ks.tt.ic.p<-mean(ks.ci.p.ss$triangle.transitivity)
  ks.ic.pi.ic.p<-mean(ks.ci.p.ss$dci)
  ks.esc.ic.p<-mean(ks.ci.p.ss$escalation)
  ks.steep.ic.p<-mean(ks.ci.p.ss$steepness)
  ks.slope.ic.p<-mean(ks.ci.p.ss$slope)
  ks.mean.ic.p<-data.frame(scenario="Knowledge self",tt=ks.tt.ic.p,dci=ks.ic.pi.ic.p,esc=ks.esc.ic.p,steepness=ks.steep.ic.p,slope=ks.slope.ic.p,dist="clumped",calc="Probabilistic")

  # knowledge opponent
  ko.tt.ic.p<-mean(ko.ci.p.ss$triangle.transitivity)
  ko.ic.pi.ic.p<-mean(ko.ci.p.ss$dci)
  ko.esc.ic.p<-mean(ko.ci.p.ss$escalation)
  ko.steep.ic.p<-mean(ko.ci.p.ss$steepness)
  ko.slope.ic.p<-mean(ko.ci.p.ss$slope)
  ko.mean.ic.p<-data.frame(scenario="Knowledge opponent",tt=ko.tt.ic.p,dci=ko.ic.pi.ic.p,esc=ko.esc.ic.p,steepness=ko.steep.ic.p,slope=ko.slope.ic.p,dist="clumped",calc="Probabilistic")

  # history mutual
  hm.tt.ic.p<-mean(hm.ci.p.ss$triangle.transitivity)
  hm.ic.pi.ic.p<-mean(hm.ci.p.ss$dci)
  hm.esc.ic.p<-mean(hm.ci.p.ss$escalation)
  hm.steep.ic.p<-mean(hm.ci.p.ss$steepness)
  hm.slope.ic.p<-mean(hm.ci.p.ss$slope)
  hm.mean.ic.p<-data.frame(scenario="History Mutual",tt=hm.tt.ic.p,dci=hm.ic.pi.ic.p,esc=hm.esc.ic.p,steepness=hm.steep.ic.p,slope=hm.slope.ic.p,dist="clumped",calc="Probabilistic")

  # history self
  hs.tt.ic.p<-mean(hs.ci.p.ss$triangle.transitivity)
  hs.ic.pi.ic.p<-mean(hs.ci.p.ss$dci)
  hs.esc.ic.p<-mean(hs.ci.p.ss$escalation)
  hs.steep.ic.p<-mean(hs.ci.p.ss$steepness)
  hs.slope.ic.p<-mean(hs.ci.p.ss$slope)
  hs.mean.ic.p<-data.frame(scenario="History self",tt=hs.tt.ic.p,dci=hs.ic.pi.ic.p,esc=hs.esc.ic.p,steepness=hs.steep.ic.p,slope=hs.slope.ic.p,dist="clumped",calc="Probabilistic")

  # history opponent
  ho.tt.ic.p<-mean(ho.ci.p.ss$triangle.transitivity)
  ho.ic.pi.ic.p<-mean(ho.ci.p.ss$dci)
  ho.esc.ic.p<-mean(ho.ci.p.ss$escalation)
  ho.steep.ic.p<-mean(ho.ci.p.ss$steepness)
  ho.slope.ic.p<-mean(ho.ci.p.ss$slope)
  ho.mean.ic.p<-data.frame(scenario="History opponent",tt=ho.tt.ic.p,dci=ho.ic.pi.ic.p,esc=ho.esc.ic.p,steepness=ho.steep.ic.p,slope=ho.slope.ic.p,dist="clumped",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.ic.p,ks.mean.ic.p,ko.mean.ic.p,hm.mean.ic.p,hs.mean.ic.p,ho.mean.ic.p)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.ic.p<-mean(km.ci.p.ss$triangle.transitivity)
  km.ic.pi.ic.p<-mean(km.ci.p.ss$dci)
  km.esc.ic.p<-mean(km.ci.p.ss$escalation)
  km.steep.ic.p<-mean(km.ci.p.ss$steepness)
  km.slope.ic.p<-mean(km.ci.p.ss$slope)
  km.mean.ic.p<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ic.p,dci=km.ic.pi.ic.p,esc=km.esc.ic.p,steepness=km.steep.ic.p,slope=km.slope.ic.p,dist="clumped",calc="Probabilistic")
  
  #knowledge self
  ks.tt.ic.p<-mean(ks.ci.p.ss$triangle.transitivity)
  ks.ic.pi.ic.p<-mean(ks.ci.p.ss$dci)
  ks.esc.ic.p<-mean(ks.ci.p.ss$escalation)
  ks.steep.ic.p<-mean(ks.ci.p.ss$steepness)
  ks.slope.ic.p<-mean(ks.ci.p.ss$slope)
  ks.mean.ic.p<-data.frame(scenario="Knowledge self",tt=ks.tt.ic.p,dci=ks.ic.pi.ic.p,esc=ks.esc.ic.p,steepness=ks.steep.ic.p,slope=ks.slope.ic.p,dist="clumped",calc="Probabilistic")
  
  #knowledge opponent
  ko.tt.ic.p<-mean(ko.ci.p.ss$triangle.transitivity)
  ko.ic.pi.ic.p<-mean(ko.ci.p.ss$dci)
  ko.esc.ic.p<-mean(ko.ci.p.ss$escalation)
  ko.steep.ic.p<-mean(ko.ci.p.ss$steepness)
  ko.slope.ic.p<-mean(ko.ci.p.ss$slope)
  ko.mean.ic.p<-data.frame(scenario="Knowledge opponent",tt=ko.tt.ic.p,dci=ko.ic.pi.ic.p,esc=ko.esc.ic.p,steepness=ko.steep.ic.p,slope=ko.slope.ic.p,dist="clumped",calc="Probabilistic")
  
  #history mutual
  hm.tt.ic.p<-mean(hm.ci.p.ss$triangle.transitivity)
  hm.ic.pi.ic.p<-mean(hm.ci.p.ss$dci)
  hm.esc.ic.p<-mean(hm.ci.p.ss$escalation)
  hm.steep.ic.p<-mean(hm.ci.p.ss$steepness)
  hm.slope.ic.p<-mean(hm.ci.p.ss$slope)
  hm.mean.ic.p<-data.frame(scenario="History Mutual",tt=hm.tt.ic.p,dci=hm.ic.pi.ic.p,esc=hm.esc.ic.p,steepness=hm.steep.ic.p,slope=hm.slope.ic.p,dist="clumped",calc="Probabilistic")
  
  #history self
  hs.tt.ic.p<-mean(hs.ci.p.ss$triangle.transitivity)
  hs.ic.pi.ic.p<-mean(hs.ci.p.ss$dci)
  hs.esc.ic.p<-mean(hs.ci.p.ss$escalation)
  hs.steep.ic.p<-mean(hs.ci.p.ss$steepness)
  hs.slope.ic.p<-mean(hs.ci.p.ss$slope)
  hs.mean.ic.p<-data.frame(scenario="History self",tt=hs.tt.ic.p,dci=hs.ic.pi.ic.p,esc=hs.esc.ic.p,steepness=hs.steep.ic.p,slope=hs.slope.ic.p,dist="clumped",calc="Probabilistic")
  
  #history opponent
  ho.tt.ic.p<-mean(ho.ci.p.ss$triangle.transitivity)
  ho.ic.pi.ic.p<-mean(ho.ci.p.ss$dci)
  ho.esc.ic.p<-mean(ho.ci.p.ss$escalation)
  ho.steep.ic.p<-mean(ho.ci.p.ss$steepness)
  ho.slope.ic.p<-mean(ho.ci.p.ss$slope)
  ho.mean.ic.p<-data.frame(scenario="History opponent",tt=ho.tt.ic.p,dci=ho.ic.pi.ic.p,esc=ho.esc.ic.p,steepness=ho.steep.ic.p,slope=ho.slope.ic.p,dist="clumped",calc="Probabilistic")

# Generate data frame for all averages:
dc.ave<-rbind(km.mean.ic.p,ks.mean.ic.p,ko.mean.ic.p,hm.mean.ic.p,hs.mean.ic.p,ho.mean.ic.p)

# Create overall dataframe of summary statistics:
overall.clump.initiator<-data.frame(km.ci.p.ss)
overall.clump.initiator<-rbind(overall.clump.initiator,ks.ci.p.ss)
overall.clump.initiator<-rbind(overall.clump.initiator,ko.ci.p.ss)
overall.clump.initiator<-rbind(overall.clump.initiator,hm.ci.p.ss)
overall.clump.initiator<-rbind(overall.clump.initiator,hs.ci.p.ss)
overall.clump.initiator<-rbind(overall.clump.initiator,ho.ci.p.ss)

overall.clump.initiator<-cbind(overall.clump.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.clump.initiator<-cbind(overall.clump.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ci.p.ss<-overall.clump.initiator[overall.clump.initiator$variable=="rhp",]
history.ci.p.ss<-overall.clump.initiator[overall.clump.initiator$variable=="history",]

overall.clump.initiator$combo<-paste(overall.clump.initiator$strategy,overall.clump.initiator$variable,overall.clump.initiator$distribution)
overall.clump.initiator$combo2<-paste(overall.clump.initiator$strategy,overall.clump.initiator$variable) #final dataframe for Probabilistic clumped data
```

## Avoids Clumped Initiator Wins Probabilistic Data
```{r Avoids Clumped Initiator Wins Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.km<-sapply(files, read.csv)

# Generate avoid.ci.p.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aci.p.km<-data.frame(X1=avoid.ci.p.km[[1]],X2=avoid.ci.p.km[[2]],Avoids=avoid.ci.p.km[[3]])
mat1.aci.p.km<-avoid.inter.mat(mut1.aci.p.km)
tri1.aci.p.km<-tr.tri(mat1.aci.p.km)
dci1.aci.p.km<-DCindex(mat1.aci.p.km)
mat1.aci.p.km[is.na(mat1.aci.p.km)] = 0
h1.aci.p.km<-h.index(mat1.aci.p.km)

ep1.aci.p.km<-ep(mut1.aci.p.km,a1.ci.p.km)
david1.aci.p.km<-DS(mat1.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.km<-cbind(ordrank.1.aci.p.km,ds=david1.aci.p.km$normDS)
lm1.aci.p.km<-summary(lm(ordrank.1.aci.p.km$ds~ordrank.1.aci.p.km$ord.rank))
s1.aci.p.km<-lm1.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.km<-data.frame(X1=avoid.ci.p.km[[4]],X2=avoid.ci.p.km[[5]],Avoids=avoid.ci.p.km[[6]])
mat2.aci.p.km<-avoid.inter.mat(mut2.aci.p.km)
tri2.aci.p.km<-tr.tri(mat2.aci.p.km)
dci2.aci.p.km<-DCindex(mat2.aci.p.km)
mat2.aci.p.km[is.na(mat2.aci.p.km)] = 0
h2.aci.p.km<-h.index(mat2.aci.p.km)

ep2.aci.p.km<-ep(mut2.aci.p.km,a2.ci.p.km)
david2.aci.p.km<-DS(mat2.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.km<-cbind(ordrank.2.aci.p.km,ds=david2.aci.p.km$normDS)
lm2.aci.p.km<-summary(lm(ordrank.2.aci.p.km$ds~ordrank.2.aci.p.km$ord.rank))
s2.aci.p.km<-lm2.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.km<-data.frame(X1=avoid.ci.p.km[[7]],X2=avoid.ci.p.km[[8]],Avoids=avoid.ci.p.km[[9]])
mat3.aci.p.km<-avoid.inter.mat(mut3.aci.p.km)
tri3.aci.p.km<-tr.tri(mat3.aci.p.km)
dci3.aci.p.km<-DCindex(mat3.aci.p.km)
mat3.aci.p.km[is.na(mat3.aci.p.km)] = 0
h3.aci.p.km<-h.index(mat3.aci.p.km)

ep3.aci.p.km<-ep(mut3.aci.p.km,a3.ci.p.km)
david3.aci.p.km<-DS(mat3.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.km<-cbind(ordrank.3.aci.p.km,ds=david3.aci.p.km$normDS)
lm3.aci.p.km<-summary(lm(ordrank.3.aci.p.km$ds~ordrank.3.aci.p.km$ord.rank))
s3.aci.p.km<-lm3.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.km<-data.frame(X1=avoid.ci.p.km[[10]],X2=avoid.ci.p.km[[11]],Avoids=avoid.ci.p.km[[12]])
mat4.aci.p.km<-avoid.inter.mat(mut4.aci.p.km)
tri4.aci.p.km<-tr.tri(mat4.aci.p.km)
dci4.aci.p.km<-DCindex(mat4.aci.p.km)
mat4.aci.p.km[is.na(mat4.aci.p.km)] = 0
h4.aci.p.km<-h.index(mat4.aci.p.km)

ep4.aci.p.km<-ep(mut4.aci.p.km,a4.ci.p.km)
david4.aci.p.km<-DS(mat4.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.km<-cbind(ordrank.4.aci.p.km,ds=david4.aci.p.km$normDS)
lm4.aci.p.km<-summary(lm(ordrank.4.aci.p.km$ds~ordrank.4.aci.p.km$ord.rank))
s4.aci.p.km<-lm4.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.km<-data.frame(X1=avoid.ci.p.km[[13]],X2=avoid.ci.p.km[[14]],Avoids=avoid.ci.p.km[[15]])
mat5.aci.p.km<-avoid.inter.mat(mut5.aci.p.km)
tri5.aci.p.km<-tr.tri(mat5.aci.p.km)
dci5.aci.p.km<-DCindex(mat5.aci.p.km)
mat5.aci.p.km[is.na(mat5.aci.p.km)] = 0
h5.aci.p.km<-h.index(mat5.aci.p.km)

ep5.aci.p.km<-ep(mut5.aci.p.km,a5.ci.p.km)
david5.aci.p.km<-DS(mat5.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.km<-cbind(ordrank.5.aci.p.km,ds=david5.aci.p.km$normDS)
lm5.aci.p.km<-summary(lm(ordrank.5.aci.p.km$ds~ordrank.5.aci.p.km$ord.rank))
s5.aci.p.km<-lm5.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.km<-data.frame(X1=avoid.ci.p.km[[16]],X2=avoid.ci.p.km[[17]],Avoids=avoid.ci.p.km[[18]])
mat6.aci.p.km<-avoid.inter.mat(mut6.aci.p.km)
tri6.aci.p.km<-tr.tri(mat6.aci.p.km)
dci6.aci.p.km<-DCindex(mat6.aci.p.km)
mat6.aci.p.km[is.na(mat6.aci.p.km)] = 0
h6.aci.p.km<-h.index(mat6.aci.p.km)

ep6.aci.p.km<-ep(mut6.aci.p.km,a6.ci.p.km)
david6.aci.p.km<-DS(mat6.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.km<-cbind(ordrank.6.aci.p.km,ds=david6.aci.p.km$normDS)
lm6.aci.p.km<-summary(lm(ordrank.6.aci.p.km$ds~ordrank.6.aci.p.km$ord.rank))
s6.aci.p.km<-lm6.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.km<-data.frame(X1=avoid.ci.p.km[[19]],X2=avoid.ci.p.km[[20]],Avoids=avoid.ci.p.km[[21]])
mat7.aci.p.km<-avoid.inter.mat(mut7.aci.p.km)
tri7.aci.p.km<-tr.tri(mat7.aci.p.km)
dci7.aci.p.km<-DCindex(mat7.aci.p.km)
mat7.aci.p.km[is.na(mat7.aci.p.km)] = 0
h7.aci.p.km<-h.index(mat7.aci.p.km)

ep7.aci.p.km<-ep(mut7.aci.p.km,a7.ci.p.km)
david7.aci.p.km<-DS(mat7.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.km<-cbind(ordrank.7.aci.p.km,ds=david7.aci.p.km$normDS)
lm7.aci.p.km<-summary(lm(ordrank.7.aci.p.km$ds~ordrank.7.aci.p.km$ord.rank))
s7.aci.p.km<-lm7.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.km<-data.frame(X1=avoid.ci.p.km[[22]],X2=avoid.ci.p.km[[23]],Avoids=avoid.ci.p.km[[24]])
mat8.aci.p.km<-avoid.inter.mat(mut8.aci.p.km)
tri8.aci.p.km<-tr.tri(mat8.aci.p.km)
dci8.aci.p.km<-DCindex(mat8.aci.p.km)
mat8.aci.p.km[is.na(mat8.aci.p.km)] = 0
h8.aci.p.km<-h.index(mat8.aci.p.km)

ep8.aci.p.km<-ep(mut8.aci.p.km,a8.ci.p.km)
david8.aci.p.km<-DS(mat8.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.km<-cbind(ordrank.8.aci.p.km,ds=david8.aci.p.km$normDS)
lm8.aci.p.km<-summary(lm(ordrank.8.aci.p.km$ds~ordrank.8.aci.p.km$ord.rank))
s8.aci.p.km<-lm8.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.km<-data.frame(X1=avoid.ci.p.km[[25]],X2=avoid.ci.p.km[[26]],Avoids=avoid.ci.p.km[[27]])
mat9.aci.p.km<-avoid.inter.mat(mut9.aci.p.km)
tri9.aci.p.km<-tr.tri(mat9.aci.p.km)
dci9.aci.p.km<-DCindex(mat9.aci.p.km)
mat9.aci.p.km[is.na(mat9.aci.p.km)] = 0
h9.aci.p.km<-h.index(mat9.aci.p.km)

ep9.aci.p.km<-ep(mut9.aci.p.km,a9.ci.p.km)
david9.aci.p.km<-DS(mat9.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.km<-cbind(ordrank.9.aci.p.km,ds=david9.aci.p.km$normDS)
lm9.aci.p.km<-summary(lm(ordrank.9.aci.p.km$ds~ordrank.9.aci.p.km$ord.rank))
s9.aci.p.km<-lm9.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.km<-data.frame(X1=avoid.ci.p.km[[28]],X2=avoid.ci.p.km[[29]],Avoids=avoid.ci.p.km[[30]])
mat10.aci.p.km<-avoid.inter.mat(mut10.aci.p.km)
tri10.aci.p.km<-tr.tri(mat10.aci.p.km)
dci10.aci.p.km<-DCindex(mat10.aci.p.km)
mat10.aci.p.km[is.na(mat10.aci.p.km)] = 0
h10.aci.p.km<-h.index(mat10.aci.p.km)

ep10.aci.p.km<-ep(mut10.aci.p.km,a10.ci.p.km)
david10.aci.p.km<-DS(mat10.aci.p.km) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.km<-cbind(ordrank.10.aci.p.km,ds=david10.aci.p.km$normDS)
lm10.aci.p.km<-summary(lm(ordrank.10.aci.p.km$ds~ordrank.10.aci.p.km$ord.rank))
s10.aci.p.km<-lm10.aci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.km<-sum(mut1.aci.p.km$Victories)
int2.aci.p.km<-sum(mut2.aci.p.km$Victories)
int3.aci.p.km<-sum(mut3.aci.p.km$Victories)
int4.aci.p.km<-sum(mut4.aci.p.km$Victories)
int5.aci.p.km<-sum(mut5.aci.p.km$Victories)
int6.aci.p.km<-sum(mut6.aci.p.km$Victories)
int7.aci.p.km<-sum(mut7.aci.p.km$Victories)
int8.aci.p.km<-sum(mut8.aci.p.km$Victories)
int9.aci.p.km<-sum(mut9.aci.p.km$Victories)
int10.aci.p.km<-sum(mut10.aci.p.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.km<-sum(a1.ci.p.km$Victories)
av2.aci.p.km<-sum(a2.ci.p.km$Victories)
av3.aci.p.km<-sum(a3.ci.p.km$Victories)
av4.aci.p.km<-sum(a4.ci.p.km$Victories)
av5.aci.p.km<-sum(a5.ci.p.km$Victories)
av6.aci.p.km<-sum(a6.ci.p.km$Victories)
av7.aci.p.km<-sum(a7.ci.p.km$Victories)
av8.aci.p.km<-sum(a8.ci.p.km$Victories)
av9.aci.p.km<-sum(a9.ci.p.km$Victories)
av10.aci.p.km<-sum(a10.ci.p.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.aci.p<-(sum(av1.aci.p.km, av2.aci.p.km, av3.aci.p.km, av4.aci.p.km, av5.aci.p.km, av6.aci.p.km, av7.aci.p.km, av8.aci.p.km, av9.aci.p.km, av10.aci.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.aci.p<-(sum(int1.aci.p.km, int2.aci.p.km, int3.aci.p.km, int4.aci.p.km, int5.aci.p.km, int6.aci.p.km, int7.aci.p.km, int8.aci.p.km, int9.aci.p.km, int10.aci.p.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.km<-e1.aci.p.km[order(e1.aci.p.km$ID),]
e1.aci.p.km<-as.matrix(t(e1.1.aci.p.km))

e2.aci.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.km<-e2.aci.p.km[order(e2.aci.p.km$ID),]
e2.aci.p.km<-as.matrix(t(e2.1.aci.p.km))

e3.aci.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.km<-e3.aci.p.km[order(e3.aci.p.km$ID),]
e3.aci.p.km<-as.matrix(t(e3.1.aci.p.km))

e4.aci.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.km<-e4.aci.p.km[order(e4.aci.p.km$ID),]
e4.aci.p.km<-as.matrix(t(e4.1.aci.p.km))

e5.aci.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.km<-e5.aci.p.km[order(e5.aci.p.km$ID),]
e5.aci.p.km<-as.matrix(t(e5.1.aci.p.km))

e6.aci.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.km<-e6.aci.p.km[order(e6.aci.p.km$ID),]
e6.aci.p.km<-as.matrix(t(e6.1.aci.p.km))

e7.aci.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.km<-e7.aci.p.km[order(e7.aci.p.km$ID),]
e7.aci.p.km<-as.matrix(t(e7.1.aci.p.km))

e8.aci.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.km<-e8.aci.p.km[order(e8.aci.p.km$ID),]
e8.aci.p.km<-as.matrix(t(e8.1.aci.p.km))

e9.aci.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.km<-e9.aci.p.km[order(e9.aci.p.km$ID),]
e9.aci.p.km<-as.matrix(t(e9.1.aci.p.km))

e10.aci.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.km<-e10.aci.p.km[order(e10.aci.p.km$ID),]
e10.aci.p.km<-as.matrix(t(e10.1.aci.p.km))

energy.km.aci.p.km<-as.data.frame(matrix(c(e1.aci.p.km,e2.aci.p.km,e3.aci.p.km,e4.aci.p.km,e5.aci.p.km,e6.aci.p.km,e7.aci.p.km,e8.aci.p.km,e9.aci.p.km,e10.aci.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aci.p.km<-data.frame(ID=energy.km.aci.p.km$V1,energy_over_distance=energy.km.aci.p.km$V2,energy_over_time=energy.km.aci.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.km<-david1.aci.p.km[order(david1.aci.p.km$ID),]
david1.aci.p.km<-as.matrix(t(david1.1.aci.p.km))

david2.1.aci.p.km<-david2.aci.p.km[order(david2.aci.p.km$ID),]
david2.aci.p.km<-as.matrix(t(david2.1.aci.p.km))

david3.1.aci.p.km<-david3.aci.p.km[order(david3.aci.p.km$ID),]
david3.aci.p.km<-as.matrix(t(david3.1.aci.p.km))

david4.1.aci.p.km<-david4.aci.p.km[order(david4.aci.p.km$ID),]
david4.aci.p.km<-as.matrix(t(david4.1.aci.p.km))

david5.1.aci.p.km<-david5.aci.p.km[order(david5.aci.p.km$ID),]
david5.aci.p.km<-as.matrix(t(david5.1.aci.p.km))

david6.1.aci.p.km<-david6.aci.p.km[order(david6.aci.p.km$ID),]
david6.aci.p.km<-as.matrix(t(david6.1.aci.p.km))

david7.1.aci.p.km<-david7.aci.p.km[order(david7.aci.p.km$ID),]
david7.aci.p.km<-as.matrix(t(david7.1.aci.p.km))

david8.1.aci.p.km<-david8.aci.p.km[order(david8.aci.p.km$ID),]
david8.aci.p.km<-as.matrix(t(david8.1.aci.p.km))

david9.1.aci.p.km<-david9.aci.p.km[order(david9.aci.p.km$ID),]
david9.aci.p.km<-as.matrix(t(david9.1.aci.p.km))

david10.1.aci.p.km<-david10.aci.p.km[order(david10.aci.p.km$ID),]
david10.aci.p.km<-as.matrix(t(david10.1.aci.p.km))

david.km.aci.p.km<-as.data.frame(matrix(c(david1.aci.p.km,david2.aci.p.km,david3.aci.p.km,david4.aci.p.km,david5.aci.p.km,david6.aci.p.km,david7.aci.p.km,david8.aci.p.km,david9.aci.p.km,david10.aci.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aci.p.km<-data.frame(ID=david.km.aci.p.km$V1,DS=david.km.aci.p.km$V2,normDS=david.km.aci.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aci.p.km<-lm(e1.1.aci.p.km$energy_over_time~as.numeric(david1.1.aci.p.km$normDS))
km.lm.1.s.aci.p.km<-summary(lm.km.1.aci.p.km)$coefficients
km.1.slope.aci.p.km<-km.lm.1.s.aci.p.km[2,1]
lm.km.2.aci.p.km<-lm(e2.1.aci.p.km$energy_over_time~as.numeric(david2.1.aci.p.km$normDS))
km.lm.2.s.aci.p.km<-summary(lm.km.2.aci.p.km)$coefficients
km.2.slope.aci.p.km<-km.lm.2.s.aci.p.km[2,1]
lm.km.3.aci.p.km<-lm(e3.1.aci.p.km$energy_over_time~as.numeric(david3.1.aci.p.km$normDS))
km.lm.3.s.aci.p.km<-summary(lm.km.3.aci.p.km)$coefficients
km.3.slope.aci.p.km<-km.lm.3.s.aci.p.km[2,1]
lm.km.4.aci.p.km<-lm(e4.1.aci.p.km$energy_over_time~as.numeric(david4.1.aci.p.km$normDS))
km.lm.4.s.aci.p.km<-summary(lm.km.4.aci.p.km)$coefficients
km.4.slope.aci.p.km<-km.lm.4.s.aci.p.km[2,1]
lm.km.5.aci.p.km<-lm(e5.1.aci.p.km$energy_over_time~as.numeric(david5.1.aci.p.km$normDS))
km.lm.5.s.aci.p.km<-summary(lm.km.5.aci.p.km)$coefficients
km.5.slope.aci.p.km<-km.lm.5.s.aci.p.km[2,1]
lm.km.6.aci.p.km<-lm(e6.1.aci.p.km$energy_over_time~as.numeric(david6.1.aci.p.km$normDS))
km.lm.6.s.aci.p.km<-summary(lm.km.6.aci.p.km)$coefficients
km.6.slope.aci.p.km<-km.lm.6.s.aci.p.km[2,1]
lm.km.7.aci.p.km<-lm(e7.1.aci.p.km$energy_over_time~as.numeric(david7.1.aci.p.km$normDS))
km.lm.7.s.aci.p.km<-summary(lm.km.7.aci.p.km)$coefficients
km.7.slope.aci.p.km<-km.lm.7.s.aci.p.km[2,1]
lm.km.8.aci.p.km<-lm(e8.1.aci.p.km$energy_over_time~as.numeric(david8.1.aci.p.km$normDS))
km.lm.8.s.aci.p.km<-summary(lm.km.8.aci.p.km)$coefficients
km.8.slope.aci.p.km<-km.lm.8.s.aci.p.km[2,1]
lm.km.9.aci.p.km<-lm(e9.1.aci.p.km$energy_over_time~as.numeric(david9.1.aci.p.km$normDS))
km.lm.9.s.aci.p.km<-summary(lm.km.9.aci.p.km)$coefficients
km.9.slope.aci.p.km<-km.lm.9.s.aci.p.km[2,1]
lm.km.10.aci.p.km<-lm(e10.1.aci.p.km$energy_over_time~as.numeric(david10.1.aci.p.km$normDS))
km.lm.10.s.aci.p.km<-summary(lm.km.10.aci.p.km)$coefficients
km.10.slope.aci.p.km<-km.lm.10.s.aci.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aci.p.ss.avoid.ci.p.km<-data.frame(triangle.transitivity=c(tri1.aci.p.km,tri2.aci.p.km,tri3.aci.p.km,tri4.aci.p.km,tri5.aci.p.km,tri6.aci.p.km,tri7.aci.p.km,tri8.aci.p.km,tri9.aci.p.km,tri10.aci.p.km),escalation=c(ep1.aci.p.km,ep2.aci.p.km,ep3.aci.p.km,ep4.aci.p.km,ep5.aci.p.km,ep6.aci.p.km,ep7.aci.p.km,ep8.aci.p.km,ep9.aci.p.km,ep10.aci.p.km),dci=c(dci1.aci.p.km,dci2.aci.p.km,dci3.aci.p.km,dci4.aci.p.km,dci5.aci.p.km,dci6.aci.p.km,dci7.aci.p.km,dci8.aci.p.km,dci9.aci.p.km,dci10.aci.p.km),steepness=c(s1.aci.p.km,s2.aci.p.km,s3.aci.p.km,s4.aci.p.km,s5.aci.p.km,s6.aci.p.km,s7.aci.p.km,s8.aci.p.km,s9.aci.p.km,s10.aci.p.km),slope=c(km.1.slope.aci.p.km,km.2.slope.aci.p.km,km.3.slope.aci.p.km,km.4.slope.aci.p.km,km.5.slope.aci.p.km,km.6.slope.aci.p.km,km.7.slope.aci.p.km,km.8.slope.aci.p.km,km.9.slope.aci.p.km,km.10.slope.aci.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ks<-sapply(files, read.csv)

# Generate avoid.ci.p.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[1]],X2=avoid.ci.p.ks[[2]],Avoids=avoid.ci.p.ks[[3]])
mat1.aci.p.ks<-avoid.inter.mat(mut1.aci.p.ks)
tri1.aci.p.ks<-tr.tri(mat1.aci.p.ks)
dci1.aci.p.ks<-DCindex(mat1.aci.p.ks)
mat1.aci.p.ks[is.na(mat1.aci.p.ks)] = 0
h1.aci.p.ks<-h.index(mat1.aci.p.ks)

ep1.aci.p.ks<-ep(mut1.aci.p.ks,a1.ci.p.ks)
david1.aci.p.ks<-DS(mat1.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.ks<-cbind(ordrank.1.aci.p.ks,ds=david1.aci.p.ks$normDS)
lm1.aci.p.ks<-summary(lm(ordrank.1.aci.p.ks$ds~ordrank.1.aci.p.ks$ord.rank))
s1.aci.p.ks<-lm1.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[4]],X2=avoid.ci.p.ks[[5]],Avoids=avoid.ci.p.ks[[6]])
mat2.aci.p.ks<-avoid.inter.mat(mut2.aci.p.ks)
tri2.aci.p.ks<-tr.tri(mat2.aci.p.ks)
dci2.aci.p.ks<-DCindex(mat2.aci.p.ks)
mat2.aci.p.ks[is.na(mat2.aci.p.ks)] = 0
h2.aci.p.ks<-h.index(mat2.aci.p.ks)

ep2.aci.p.ks<-ep(mut2.aci.p.ks,a2.ci.p.ks)
david2.aci.p.ks<-DS(mat2.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.ks<-cbind(ordrank.2.aci.p.ks,ds=david2.aci.p.ks$normDS)
lm2.aci.p.ks<-summary(lm(ordrank.2.aci.p.ks$ds~ordrank.2.aci.p.ks$ord.rank))
s2.aci.p.ks<-lm2.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[7]],X2=avoid.ci.p.ks[[8]],Avoids=avoid.ci.p.ks[[9]])
mat3.aci.p.ks<-avoid.inter.mat(mut3.aci.p.ks)
tri3.aci.p.ks<-tr.tri(mat3.aci.p.ks)
dci3.aci.p.ks<-DCindex(mat3.aci.p.ks)
mat3.aci.p.ks[is.na(mat3.aci.p.ks)] = 0
h3.aci.p.ks<-h.index(mat3.aci.p.ks)

ep3.aci.p.ks<-ep(mut3.aci.p.ks,a3.ci.p.ks)
david3.aci.p.ks<-DS(mat3.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.ks<-cbind(ordrank.3.aci.p.ks,ds=david3.aci.p.ks$normDS)
lm3.aci.p.ks<-summary(lm(ordrank.3.aci.p.ks$ds~ordrank.3.aci.p.ks$ord.rank))
s3.aci.p.ks<-lm3.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[10]],X2=avoid.ci.p.ks[[11]],Avoids=avoid.ci.p.ks[[12]])
mat4.aci.p.ks<-avoid.inter.mat(mut4.aci.p.ks)
tri4.aci.p.ks<-tr.tri(mat4.aci.p.ks)
dci4.aci.p.ks<-DCindex(mat4.aci.p.ks)
mat4.aci.p.ks[is.na(mat4.aci.p.ks)] = 0
h4.aci.p.ks<-h.index(mat4.aci.p.ks)

ep4.aci.p.ks<-ep(mut4.aci.p.ks,a4.ci.p.ks)
david4.aci.p.ks<-DS(mat4.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.ks<-cbind(ordrank.4.aci.p.ks,ds=david4.aci.p.ks$normDS)
lm4.aci.p.ks<-summary(lm(ordrank.4.aci.p.ks$ds~ordrank.4.aci.p.ks$ord.rank))
s4.aci.p.ks<-lm4.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[13]],X2=avoid.ci.p.ks[[14]],Avoids=avoid.ci.p.ks[[15]])
mat5.aci.p.ks<-avoid.inter.mat(mut5.aci.p.ks)
tri5.aci.p.ks<-tr.tri(mat5.aci.p.ks)
dci5.aci.p.ks<-DCindex(mat5.aci.p.ks)
mat5.aci.p.ks[is.na(mat5.aci.p.ks)] = 0
h5.aci.p.ks<-h.index(mat5.aci.p.ks)

ep5.aci.p.ks<-ep(mut5.aci.p.ks,a5.ci.p.ks)
david5.aci.p.ks<-DS(mat5.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.ks<-cbind(ordrank.5.aci.p.ks,ds=david5.aci.p.ks$normDS)
lm5.aci.p.ks<-summary(lm(ordrank.5.aci.p.ks$ds~ordrank.5.aci.p.ks$ord.rank))
s5.aci.p.ks<-lm5.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[16]],X2=avoid.ci.p.ks[[17]],Avoids=avoid.ci.p.ks[[18]])
mat6.aci.p.ks<-avoid.inter.mat(mut6.aci.p.ks)
tri6.aci.p.ks<-tr.tri(mat6.aci.p.ks)
dci6.aci.p.ks<-DCindex(mat6.aci.p.ks)
mat6.aci.p.ks[is.na(mat6.aci.p.ks)] = 0
h6.aci.p.ks<-h.index(mat6.aci.p.ks)

ep6.aci.p.ks<-ep(mut6.aci.p.ks,a6.ci.p.ks)
david6.aci.p.ks<-DS(mat6.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.ks<-cbind(ordrank.6.aci.p.ks,ds=david6.aci.p.ks$normDS)
lm6.aci.p.ks<-summary(lm(ordrank.6.aci.p.ks$ds~ordrank.6.aci.p.ks$ord.rank))
s6.aci.p.ks<-lm6.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[19]],X2=avoid.ci.p.ks[[20]],Avoids=avoid.ci.p.ks[[21]])
mat7.aci.p.ks<-avoid.inter.mat(mut7.aci.p.ks)
tri7.aci.p.ks<-tr.tri(mat7.aci.p.ks)
dci7.aci.p.ks<-DCindex(mat7.aci.p.ks)
mat7.aci.p.ks[is.na(mat7.aci.p.ks)] = 0
h7.aci.p.ks<-h.index(mat7.aci.p.ks)

ep7.aci.p.ks<-ep(mut7.aci.p.ks,a7.ci.p.ks)
david7.aci.p.ks<-DS(mat7.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.ks<-cbind(ordrank.7.aci.p.ks,ds=david7.aci.p.ks$normDS)
lm7.aci.p.ks<-summary(lm(ordrank.7.aci.p.ks$ds~ordrank.7.aci.p.ks$ord.rank))
s7.aci.p.ks<-lm7.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[22]],X2=avoid.ci.p.ks[[23]],Avoids=avoid.ci.p.ks[[24]])
mat8.aci.p.ks<-avoid.inter.mat(mut8.aci.p.ks)
tri8.aci.p.ks<-tr.tri(mat8.aci.p.ks)
dci8.aci.p.ks<-DCindex(mat8.aci.p.ks)
mat8.aci.p.ks[is.na(mat8.aci.p.ks)] = 0
h8.aci.p.ks<-h.index(mat8.aci.p.ks)

ep8.aci.p.ks<-ep(mut8.aci.p.ks,a8.ci.p.ks)
david8.aci.p.ks<-DS(mat8.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.ks<-cbind(ordrank.8.aci.p.ks,ds=david8.aci.p.ks$normDS)
lm8.aci.p.ks<-summary(lm(ordrank.8.aci.p.ks$ds~ordrank.8.aci.p.ks$ord.rank))
s8.aci.p.ks<-lm8.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[25]],X2=avoid.ci.p.ks[[26]],Avoids=avoid.ci.p.ks[[27]])
mat9.aci.p.ks<-avoid.inter.mat(mut9.aci.p.ks)
tri9.aci.p.ks<-tr.tri(mat9.aci.p.ks)
dci9.aci.p.ks<-DCindex(mat9.aci.p.ks)
mat9.aci.p.ks[is.na(mat9.aci.p.ks)] = 0
h9.aci.p.ks<-h.index(mat9.aci.p.ks)

ep9.aci.p.ks<-ep(mut9.aci.p.ks,a9.ci.p.ks)
david9.aci.p.ks<-DS(mat9.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.ks<-cbind(ordrank.9.aci.p.ks,ds=david9.aci.p.ks$normDS)
lm9.aci.p.ks<-summary(lm(ordrank.9.aci.p.ks$ds~ordrank.9.aci.p.ks$ord.rank))
s9.aci.p.ks<-lm9.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.ks<-data.frame(X1=avoid.ci.p.ks[[28]],X2=avoid.ci.p.ks[[29]],Avoids=avoid.ci.p.ks[[30]])
mat10.aci.p.ks<-avoid.inter.mat(mut10.aci.p.ks)
tri10.aci.p.ks<-tr.tri(mat10.aci.p.ks)
dci10.aci.p.ks<-DCindex(mat10.aci.p.ks)
mat10.aci.p.ks[is.na(mat10.aci.p.ks)] = 0
h10.aci.p.ks<-h.index(mat10.aci.p.ks)

ep10.aci.p.ks<-ep(mut10.aci.p.ks,a10.ci.p.ks)
david10.aci.p.ks<-DS(mat10.aci.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.ks<-cbind(ordrank.10.aci.p.ks,ds=david10.aci.p.ks$normDS)
lm10.aci.p.ks<-summary(lm(ordrank.10.aci.p.ks$ds~ordrank.10.aci.p.ks$ord.rank))
s10.aci.p.ks<-lm10.aci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.ks<-sum(mut1.aci.p.ks$Victories)
int2.aci.p.ks<-sum(mut2.aci.p.ks$Victories)
int3.aci.p.ks<-sum(mut3.aci.p.ks$Victories)
int4.aci.p.ks<-sum(mut4.aci.p.ks$Victories)
int5.aci.p.ks<-sum(mut5.aci.p.ks$Victories)
int6.aci.p.ks<-sum(mut6.aci.p.ks$Victories)
int7.aci.p.ks<-sum(mut7.aci.p.ks$Victories)
int8.aci.p.ks<-sum(mut8.aci.p.ks$Victories)
int9.aci.p.ks<-sum(mut9.aci.p.ks$Victories)
int10.aci.p.ks<-sum(mut10.aci.p.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.ks<-sum(a1.ci.p.ks$Victories)
av2.aci.p.ks<-sum(a2.ci.p.ks$Victories)
av3.aci.p.ks<-sum(a3.ci.p.ks$Victories)
av4.aci.p.ks<-sum(a4.ci.p.ks$Victories)
av5.aci.p.ks<-sum(a5.ci.p.ks$Victories)
av6.aci.p.ks<-sum(a6.ci.p.ks$Victories)
av7.aci.p.ks<-sum(a7.ci.p.ks$Victories)
av8.aci.p.ks<-sum(a8.ci.p.ks$Victories)
av9.aci.p.ks<-sum(a9.ci.p.ks$Victories)
av10.aci.p.ks<-sum(a10.ci.p.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.aci.p<-(sum(av1.aci.p.ks, av2.aci.p.ks, av3.aci.p.ks, av4.aci.p.ks, av5.aci.p.ks, av6.aci.p.ks, av7.aci.p.ks, av8.aci.p.ks, av9.aci.p.ks, av10.aci.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.aci.p<-(sum(int1.aci.p.ks, int2.aci.p.ks, int3.aci.p.ks, int4.aci.p.ks, int5.aci.p.ks, int6.aci.p.ks, int7.aci.p.ks, int8.aci.p.ks, int9.aci.p.ks, int10.aci.p.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.ks<-e1.aci.p.ks[order(e1.aci.p.ks$ID),]
e1.aci.p.ks<-as.matrix(t(e1.1.aci.p.ks))

e2.aci.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.ks<-e2.aci.p.ks[order(e2.aci.p.ks$ID),]
e2.aci.p.ks<-as.matrix(t(e2.1.aci.p.ks))

e3.aci.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.ks<-e3.aci.p.ks[order(e3.aci.p.ks$ID),]
e3.aci.p.ks<-as.matrix(t(e3.1.aci.p.ks))

e4.aci.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.ks<-e4.aci.p.ks[order(e4.aci.p.ks$ID),]
e4.aci.p.ks<-as.matrix(t(e4.1.aci.p.ks))

e5.aci.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.ks<-e5.aci.p.ks[order(e5.aci.p.ks$ID),]
e5.aci.p.ks<-as.matrix(t(e5.1.aci.p.ks))

e6.aci.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.ks<-e6.aci.p.ks[order(e6.aci.p.ks$ID),]
e6.aci.p.ks<-as.matrix(t(e6.1.aci.p.ks))

e7.aci.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.ks<-e7.aci.p.ks[order(e7.aci.p.ks$ID),]
e7.aci.p.ks<-as.matrix(t(e7.1.aci.p.ks))

e8.aci.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.ks<-e8.aci.p.ks[order(e8.aci.p.ks$ID),]
e8.aci.p.ks<-as.matrix(t(e8.1.aci.p.ks))

e9.aci.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.ks<-e9.aci.p.ks[order(e9.aci.p.ks$ID),]
e9.aci.p.ks<-as.matrix(t(e9.1.aci.p.ks))

e10.aci.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.ks<-e10.aci.p.ks[order(e10.aci.p.ks$ID),]
e10.aci.p.ks<-as.matrix(t(e10.1.aci.p.ks))

energy.ks.aci.p.ks<-as.data.frame(matrix(c(e1.aci.p.ks,e2.aci.p.ks,e3.aci.p.ks,e4.aci.p.ks,e5.aci.p.ks,e6.aci.p.ks,e7.aci.p.ks,e8.aci.p.ks,e9.aci.p.ks,e10.aci.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.aci.p.ks<-data.frame(ID=energy.ks.aci.p.ks$V1,energy_over_distance=energy.ks.aci.p.ks$V2,energy_over_time=energy.ks.aci.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.ks<-david1.aci.p.ks[order(david1.aci.p.ks$ID),]
david1.aci.p.ks<-as.matrix(t(david1.1.aci.p.ks))

david2.1.aci.p.ks<-david2.aci.p.ks[order(david2.aci.p.ks$ID),]
david2.aci.p.ks<-as.matrix(t(david2.1.aci.p.ks))

david3.1.aci.p.ks<-david3.aci.p.ks[order(david3.aci.p.ks$ID),]
david3.aci.p.ks<-as.matrix(t(david3.1.aci.p.ks))

david4.1.aci.p.ks<-david4.aci.p.ks[order(david4.aci.p.ks$ID),]
david4.aci.p.ks<-as.matrix(t(david4.1.aci.p.ks))

david5.1.aci.p.ks<-david5.aci.p.ks[order(david5.aci.p.ks$ID),]
david5.aci.p.ks<-as.matrix(t(david5.1.aci.p.ks))

david6.1.aci.p.ks<-david6.aci.p.ks[order(david6.aci.p.ks$ID),]
david6.aci.p.ks<-as.matrix(t(david6.1.aci.p.ks))

david7.1.aci.p.ks<-david7.aci.p.ks[order(david7.aci.p.ks$ID),]
david7.aci.p.ks<-as.matrix(t(david7.1.aci.p.ks))

david8.1.aci.p.ks<-david8.aci.p.ks[order(david8.aci.p.ks$ID),]
david8.aci.p.ks<-as.matrix(t(david8.1.aci.p.ks))

david9.1.aci.p.ks<-david9.aci.p.ks[order(david9.aci.p.ks$ID),]
david9.aci.p.ks<-as.matrix(t(david9.1.aci.p.ks))

david10.1.aci.p.ks<-david10.aci.p.ks[order(david10.aci.p.ks$ID),]
david10.aci.p.ks<-as.matrix(t(david10.1.aci.p.ks))

david.ks.aci.p.ks<-as.data.frame(matrix(c(david1.aci.p.ks,david2.aci.p.ks,david3.aci.p.ks,david4.aci.p.ks,david5.aci.p.ks,david6.aci.p.ks,david7.aci.p.ks,david8.aci.p.ks,david9.aci.p.ks,david10.aci.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.aci.p.ks<-data.frame(ID=david.ks.aci.p.ks$V1,DS=david.ks.aci.p.ks$V2,normDS=david.ks.aci.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.aci.p.ks<-lm(e1.1.aci.p.ks$energy_over_time~as.numeric(david1.1.aci.p.ks$normDS))
ks.lm.1.s.aci.p.ks<-summary(lm.ks.1.aci.p.ks)$coefficients
ks.1.slope.aci.p.ks<-ks.lm.1.s.aci.p.ks[2,1]
lm.ks.2.aci.p.ks<-lm(e2.1.aci.p.ks$energy_over_time~as.numeric(david2.1.aci.p.ks$normDS))
ks.lm.2.s.aci.p.ks<-summary(lm.ks.2.aci.p.ks)$coefficients
ks.2.slope.aci.p.ks<-ks.lm.2.s.aci.p.ks[2,1]
lm.ks.3.aci.p.ks<-lm(e3.1.aci.p.ks$energy_over_time~as.numeric(david3.1.aci.p.ks$normDS))
ks.lm.3.s.aci.p.ks<-summary(lm.ks.3.aci.p.ks)$coefficients
ks.3.slope.aci.p.ks<-ks.lm.3.s.aci.p.ks[2,1]
lm.ks.4.aci.p.ks<-lm(e4.1.aci.p.ks$energy_over_time~as.numeric(david4.1.aci.p.ks$normDS))
ks.lm.4.s.aci.p.ks<-summary(lm.ks.4.aci.p.ks)$coefficients
ks.4.slope.aci.p.ks<-ks.lm.4.s.aci.p.ks[2,1]
lm.ks.5.aci.p.ks<-lm(e5.1.aci.p.ks$energy_over_time~as.numeric(david5.1.aci.p.ks$normDS))
ks.lm.5.s.aci.p.ks<-summary(lm.ks.5.aci.p.ks)$coefficients
ks.5.slope.aci.p.ks<-ks.lm.5.s.aci.p.ks[2,1]
lm.ks.6.aci.p.ks<-lm(e6.1.aci.p.ks$energy_over_time~as.numeric(david6.1.aci.p.ks$normDS))
ks.lm.6.s.aci.p.ks<-summary(lm.ks.6.aci.p.ks)$coefficients
ks.6.slope.aci.p.ks<-ks.lm.6.s.aci.p.ks[2,1]
lm.ks.7.aci.p.ks<-lm(e7.1.aci.p.ks$energy_over_time~as.numeric(david7.1.aci.p.ks$normDS))
ks.lm.7.s.aci.p.ks<-summary(lm.ks.7.aci.p.ks)$coefficients
ks.7.slope.aci.p.ks<-ks.lm.7.s.aci.p.ks[2,1]
lm.ks.8.aci.p.ks<-lm(e8.1.aci.p.ks$energy_over_time~as.numeric(david8.1.aci.p.ks$normDS))
ks.lm.8.s.aci.p.ks<-summary(lm.ks.8.aci.p.ks)$coefficients
ks.8.slope.aci.p.ks<-ks.lm.8.s.aci.p.ks[2,1]
lm.ks.9.aci.p.ks<-lm(e9.1.aci.p.ks$energy_over_time~as.numeric(david9.1.aci.p.ks$normDS))
ks.lm.9.s.aci.p.ks<-summary(lm.ks.9.aci.p.ks)$coefficients
ks.9.slope.aci.p.ks<-ks.lm.9.s.aci.p.ks[2,1]
lm.ks.10.aci.p.ks<-lm(e10.1.aci.p.ks$energy_over_time~as.numeric(david10.1.aci.p.ks$normDS))
ks.lm.10.s.aci.p.ks<-summary(lm.ks.10.aci.p.ks)$coefficients
ks.10.slope.aci.p.ks<-ks.lm.10.s.aci.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.aci.p.ss.avoid.ci.p.ks<-data.frame(triangle.transitivity=c(tri1.aci.p.ks,tri2.aci.p.ks,tri3.aci.p.ks,tri4.aci.p.ks,tri5.aci.p.ks,tri6.aci.p.ks,tri7.aci.p.ks,tri8.aci.p.ks,tri9.aci.p.ks,tri10.aci.p.ks),escalation=c(ep1.aci.p.ks,ep2.aci.p.ks,ep3.aci.p.ks,ep4.aci.p.ks,ep5.aci.p.ks,ep6.aci.p.ks,ep7.aci.p.ks,ep8.aci.p.ks,ep9.aci.p.ks,ep10.aci.p.ks),dci=c(dci1.aci.p.ks,dci2.aci.p.ks,dci3.aci.p.ks,dci4.aci.p.ks,dci5.aci.p.ks,dci6.aci.p.ks,dci7.aci.p.ks,dci8.aci.p.ks,dci9.aci.p.ks,dci10.aci.p.ks),steepness=c(s1.aci.p.ks,s2.aci.p.ks,s3.aci.p.ks,s4.aci.p.ks,s5.aci.p.ks,s6.aci.p.ks,s7.aci.p.ks,s8.aci.p.ks,s9.aci.p.ks,s10.aci.p.ks),slope=c(ks.1.slope.aci.p.ks,ks.2.slope.aci.p.ks,ks.3.slope.aci.p.ks,ks.4.slope.aci.p.ks,ks.5.slope.aci.p.ks,ks.6.slope.aci.p.ks,ks.7.slope.aci.p.ks,ks.8.slope.aci.p.ks,ks.9.slope.aci.p.ks,ks.10.slope.aci.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Clump

# Data organization for the Knowledge Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ko<-sapply(files, read.csv)

# Generate avoid.ci.p.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[1]],X2=avoid.ci.p.ko[[2]],Avoids=avoid.ci.p.ko[[3]])
mat1.aci.p.ko<-avoid.inter.mat(mut1.aci.p.ko)
tri1.aci.p.ko<-tr.tri(mat1.aci.p.ko)
dci1.aci.p.ko<-DCindex(mat1.aci.p.ko)
mat1.aci.p.ko[is.na(mat1.aci.p.ko)] = 0
h1.aci.p.ko<-h.index(mat1.aci.p.ko)

ep1.aci.p.ko<-ep(mut1.aci.p.ko,a1.ci.p.ko)
david1.aci.p.ko<-DS(mat1.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.ko<-cbind(ordrank.1.aci.p.ko,ds=david1.aci.p.ko$normDS)
lm1.aci.p.ko<-summary(lm(ordrank.1.aci.p.ko$ds~ordrank.1.aci.p.ko$ord.rank))
s1.aci.p.ko<-lm1.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[4]],X2=avoid.ci.p.ko[[5]],Avoids=avoid.ci.p.ko[[6]])
mat2.aci.p.ko<-avoid.inter.mat(mut2.aci.p.ko)
tri2.aci.p.ko<-tr.tri(mat2.aci.p.ko)
dci2.aci.p.ko<-DCindex(mat2.aci.p.ko)
mat2.aci.p.ko[is.na(mat2.aci.p.ko)] = 0
h2.aci.p.ko<-h.index(mat2.aci.p.ko)

ep2.aci.p.ko<-ep(mut2.aci.p.ko,a2.ci.p.ko)
david2.aci.p.ko<-DS(mat2.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.ko<-cbind(ordrank.2.aci.p.ko,ds=david2.aci.p.ko$normDS)
lm2.aci.p.ko<-summary(lm(ordrank.2.aci.p.ko$ds~ordrank.2.aci.p.ko$ord.rank))
s2.aci.p.ko<-lm2.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[7]],X2=avoid.ci.p.ko[[8]],Avoids=avoid.ci.p.ko[[9]])
mat3.aci.p.ko<-avoid.inter.mat(mut3.aci.p.ko)
tri3.aci.p.ko<-tr.tri(mat3.aci.p.ko)
dci3.aci.p.ko<-DCindex(mat3.aci.p.ko)
mat3.aci.p.ko[is.na(mat3.aci.p.ko)] = 0
h3.aci.p.ko<-h.index(mat3.aci.p.ko)

ep3.aci.p.ko<-ep(mut3.aci.p.ko,a3.ci.p.ko)
david3.aci.p.ko<-DS(mat3.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.ko<-cbind(ordrank.3.aci.p.ko,ds=david3.aci.p.ko$normDS)
lm3.aci.p.ko<-summary(lm(ordrank.3.aci.p.ko$ds~ordrank.3.aci.p.ko$ord.rank))
s3.aci.p.ko<-lm3.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[10]],X2=avoid.ci.p.ko[[11]],Avoids=avoid.ci.p.ko[[12]])
mat4.aci.p.ko<-avoid.inter.mat(mut4.aci.p.ko)
tri4.aci.p.ko<-tr.tri(mat4.aci.p.ko)
dci4.aci.p.ko<-DCindex(mat4.aci.p.ko)
mat4.aci.p.ko[is.na(mat4.aci.p.ko)] = 0
h4.aci.p.ko<-h.index(mat4.aci.p.ko)

ep4.aci.p.ko<-ep(mut4.aci.p.ko,a4.ci.p.ko)
david4.aci.p.ko<-DS(mat4.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.ko<-cbind(ordrank.4.aci.p.ko,ds=david4.aci.p.ko$normDS)
lm4.aci.p.ko<-summary(lm(ordrank.4.aci.p.ko$ds~ordrank.4.aci.p.ko$ord.rank))
s4.aci.p.ko<-lm4.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[13]],X2=avoid.ci.p.ko[[14]],Avoids=avoid.ci.p.ko[[15]])
mat5.aci.p.ko<-avoid.inter.mat(mut5.aci.p.ko)
tri5.aci.p.ko<-tr.tri(mat5.aci.p.ko)
dci5.aci.p.ko<-DCindex(mat5.aci.p.ko)
mat5.aci.p.ko[is.na(mat5.aci.p.ko)] = 0
h5.aci.p.ko<-h.index(mat5.aci.p.ko)

ep5.aci.p.ko<-ep(mut5.aci.p.ko,a5.ci.p.ko)
david5.aci.p.ko<-DS(mat5.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.ko<-cbind(ordrank.5.aci.p.ko,ds=david5.aci.p.ko$normDS)
lm5.aci.p.ko<-summary(lm(ordrank.5.aci.p.ko$ds~ordrank.5.aci.p.ko$ord.rank))
s5.aci.p.ko<-lm5.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[16]],X2=avoid.ci.p.ko[[17]],Avoids=avoid.ci.p.ko[[18]])
mat6.aci.p.ko<-avoid.inter.mat(mut6.aci.p.ko)
tri6.aci.p.ko<-tr.tri(mat6.aci.p.ko)
dci6.aci.p.ko<-DCindex(mat6.aci.p.ko)
mat6.aci.p.ko[is.na(mat6.aci.p.ko)] = 0
h6.aci.p.ko<-h.index(mat6.aci.p.ko)

ep6.aci.p.ko<-ep(mut6.aci.p.ko,a6.ci.p.ko)
david6.aci.p.ko<-DS(mat6.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.ko<-cbind(ordrank.6.aci.p.ko,ds=david6.aci.p.ko$normDS)
lm6.aci.p.ko<-summary(lm(ordrank.6.aci.p.ko$ds~ordrank.6.aci.p.ko$ord.rank))
s6.aci.p.ko<-lm6.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[19]],X2=avoid.ci.p.ko[[20]],Avoids=avoid.ci.p.ko[[21]])
mat7.aci.p.ko<-avoid.inter.mat(mut7.aci.p.ko)
tri7.aci.p.ko<-tr.tri(mat7.aci.p.ko)
dci7.aci.p.ko<-DCindex(mat7.aci.p.ko)
mat7.aci.p.ko[is.na(mat7.aci.p.ko)] = 0
h7.aci.p.ko<-h.index(mat7.aci.p.ko)

ep7.aci.p.ko<-ep(mut7.aci.p.ko,a7.ci.p.ko)
david7.aci.p.ko<-DS(mat7.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.ko<-cbind(ordrank.7.aci.p.ko,ds=david7.aci.p.ko$normDS)
lm7.aci.p.ko<-summary(lm(ordrank.7.aci.p.ko$ds~ordrank.7.aci.p.ko$ord.rank))
s7.aci.p.ko<-lm7.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[22]],X2=avoid.ci.p.ko[[23]],Avoids=avoid.ci.p.ko[[24]])
mat8.aci.p.ko<-avoid.inter.mat(mut8.aci.p.ko)
tri8.aci.p.ko<-tr.tri(mat8.aci.p.ko)
dci8.aci.p.ko<-DCindex(mat8.aci.p.ko)
mat8.aci.p.ko[is.na(mat8.aci.p.ko)] = 0
h8.aci.p.ko<-h.index(mat8.aci.p.ko)

ep8.aci.p.ko<-ep(mut8.aci.p.ko,a8.ci.p.ko)
david8.aci.p.ko<-DS(mat8.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.ko<-cbind(ordrank.8.aci.p.ko,ds=david8.aci.p.ko$normDS)
lm8.aci.p.ko<-summary(lm(ordrank.8.aci.p.ko$ds~ordrank.8.aci.p.ko$ord.rank))
s8.aci.p.ko<-lm8.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[25]],X2=avoid.ci.p.ko[[26]],Avoids=avoid.ci.p.ko[[27]])
mat9.aci.p.ko<-avoid.inter.mat(mut9.aci.p.ko)
tri9.aci.p.ko<-tr.tri(mat9.aci.p.ko)
dci9.aci.p.ko<-DCindex(mat9.aci.p.ko)
mat9.aci.p.ko[is.na(mat9.aci.p.ko)] = 0
h9.aci.p.ko<-h.index(mat9.aci.p.ko)

ep9.aci.p.ko<-ep(mut9.aci.p.ko,a9.ci.p.ko)
david9.aci.p.ko<-DS(mat9.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.ko<-cbind(ordrank.9.aci.p.ko,ds=david9.aci.p.ko$normDS)
lm9.aci.p.ko<-summary(lm(ordrank.9.aci.p.ko$ds~ordrank.9.aci.p.ko$ord.rank))
s9.aci.p.ko<-lm9.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.ko<-data.frame(X1=avoid.ci.p.ko[[28]],X2=avoid.ci.p.ko[[29]],Avoids=avoid.ci.p.ko[[30]])
mat10.aci.p.ko<-avoid.inter.mat(mut10.aci.p.ko)
tri10.aci.p.ko<-tr.tri(mat10.aci.p.ko)
dci10.aci.p.ko<-DCindex(mat10.aci.p.ko)
mat10.aci.p.ko[is.na(mat10.aci.p.ko)] = 0
h10.aci.p.ko<-h.index(mat10.aci.p.ko)

ep10.aci.p.ko<-ep(mut10.aci.p.ko,a10.ci.p.ko)
david10.aci.p.ko<-DS(mat10.aci.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.ko<-cbind(ordrank.10.aci.p.ko,ds=david10.aci.p.ko$normDS)
lm10.aci.p.ko<-summary(lm(ordrank.10.aci.p.ko$ds~ordrank.10.aci.p.ko$ord.rank))
s10.aci.p.ko<-lm10.aci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.ko<-sum(mut1.aci.p.ko$Victories)
int2.aci.p.ko<-sum(mut2.aci.p.ko$Victories)
int3.aci.p.ko<-sum(mut3.aci.p.ko$Victories)
int4.aci.p.ko<-sum(mut4.aci.p.ko$Victories)
int5.aci.p.ko<-sum(mut5.aci.p.ko$Victories)
int6.aci.p.ko<-sum(mut6.aci.p.ko$Victories)
int7.aci.p.ko<-sum(mut7.aci.p.ko$Victories)
int8.aci.p.ko<-sum(mut8.aci.p.ko$Victories)
int9.aci.p.ko<-sum(mut9.aci.p.ko$Victories)
int10.aci.p.ko<-sum(mut10.aci.p.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.ko<-sum(a1.ci.p.ko$Victories)
av2.aci.p.ko<-sum(a2.ci.p.ko$Victories)
av3.aci.p.ko<-sum(a3.ci.p.ko$Victories)
av4.aci.p.ko<-sum(a4.ci.p.ko$Victories)
av5.aci.p.ko<-sum(a5.ci.p.ko$Victories)
av6.aci.p.ko<-sum(a6.ci.p.ko$Victories)
av7.aci.p.ko<-sum(a7.ci.p.ko$Victories)
av8.aci.p.ko<-sum(a8.ci.p.ko$Victories)
av9.aci.p.ko<-sum(a9.ci.p.ko$Victories)
av10.aci.p.ko<-sum(a10.ci.p.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.aci.p<-(sum(av1.aci.p.ko, av2.aci.p.ko, av3.aci.p.ko, av4.aci.p.ko, av5.aci.p.ko, av6.aci.p.ko, av7.aci.p.ko, av8.aci.p.ko, av9.aci.p.ko, av10.aci.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.aci.p<-(sum(int1.aci.p.ko, int2.aci.p.ko, int3.aci.p.ko, int4.aci.p.ko, int5.aci.p.ko, int6.aci.p.ko, int7.aci.p.ko, int8.aci.p.ko, int9.aci.p.ko, int10.aci.p.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.ko<-e1.aci.p.ko[order(e1.aci.p.ko$ID),]
e1.aci.p.ko<-as.matrix(t(e1.1.aci.p.ko))

e2.aci.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.ko<-e2.aci.p.ko[order(e2.aci.p.ko$ID),]
e2.aci.p.ko<-as.matrix(t(e2.1.aci.p.ko))

e3.aci.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.ko<-e3.aci.p.ko[order(e3.aci.p.ko$ID),]
e3.aci.p.ko<-as.matrix(t(e3.1.aci.p.ko))

e4.aci.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.ko<-e4.aci.p.ko[order(e4.aci.p.ko$ID),]
e4.aci.p.ko<-as.matrix(t(e4.1.aci.p.ko))

e5.aci.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.ko<-e5.aci.p.ko[order(e5.aci.p.ko$ID),]
e5.aci.p.ko<-as.matrix(t(e5.1.aci.p.ko))

e6.aci.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.ko<-e6.aci.p.ko[order(e6.aci.p.ko$ID),]
e6.aci.p.ko<-as.matrix(t(e6.1.aci.p.ko))

e7.aci.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.ko<-e7.aci.p.ko[order(e7.aci.p.ko$ID),]
e7.aci.p.ko<-as.matrix(t(e7.1.aci.p.ko))

e8.aci.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.ko<-e8.aci.p.ko[order(e8.aci.p.ko$ID),]
e8.aci.p.ko<-as.matrix(t(e8.1.aci.p.ko))

e9.aci.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.ko<-e9.aci.p.ko[order(e9.aci.p.ko$ID),]
e9.aci.p.ko<-as.matrix(t(e9.1.aci.p.ko))

e10.aci.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.ko<-e10.aci.p.ko[order(e10.aci.p.ko$ID),]
e10.aci.p.ko<-as.matrix(t(e10.1.aci.p.ko))

energy.ko.aci.p.ko<-as.data.frame(matrix(c(e1.aci.p.ko,e2.aci.p.ko,e3.aci.p.ko,e4.aci.p.ko,e5.aci.p.ko,e6.aci.p.ko,e7.aci.p.ko,e8.aci.p.ko,e9.aci.p.ko,e10.aci.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.aci.p.ko<-data.frame(ID=energy.ko.aci.p.ko$V1,energy_over_distance=energy.ko.aci.p.ko$V2,energy_over_time=energy.ko.aci.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.ko<-david1.aci.p.ko[order(david1.aci.p.ko$ID),]
david1.aci.p.ko<-as.matrix(t(david1.1.aci.p.ko))

david2.1.aci.p.ko<-david2.aci.p.ko[order(david2.aci.p.ko$ID),]
david2.aci.p.ko<-as.matrix(t(david2.1.aci.p.ko))

david3.1.aci.p.ko<-david3.aci.p.ko[order(david3.aci.p.ko$ID),]
david3.aci.p.ko<-as.matrix(t(david3.1.aci.p.ko))

david4.1.aci.p.ko<-david4.aci.p.ko[order(david4.aci.p.ko$ID),]
david4.aci.p.ko<-as.matrix(t(david4.1.aci.p.ko))

david5.1.aci.p.ko<-david5.aci.p.ko[order(david5.aci.p.ko$ID),]
david5.aci.p.ko<-as.matrix(t(david5.1.aci.p.ko))

david6.1.aci.p.ko<-david6.aci.p.ko[order(david6.aci.p.ko$ID),]
david6.aci.p.ko<-as.matrix(t(david6.1.aci.p.ko))

david7.1.aci.p.ko<-david7.aci.p.ko[order(david7.aci.p.ko$ID),]
david7.aci.p.ko<-as.matrix(t(david7.1.aci.p.ko))

david8.1.aci.p.ko<-david8.aci.p.ko[order(david8.aci.p.ko$ID),]
david8.aci.p.ko<-as.matrix(t(david8.1.aci.p.ko))

david9.1.aci.p.ko<-david9.aci.p.ko[order(david9.aci.p.ko$ID),]
david9.aci.p.ko<-as.matrix(t(david9.1.aci.p.ko))

david10.1.aci.p.ko<-david10.aci.p.ko[order(david10.aci.p.ko$ID),]
david10.aci.p.ko<-as.matrix(t(david10.1.aci.p.ko))

david.ko.aci.p.ko<-as.data.frame(matrix(c(david1.aci.p.ko,david2.aci.p.ko,david3.aci.p.ko,david4.aci.p.ko,david5.aci.p.ko,david6.aci.p.ko,david7.aci.p.ko,david8.aci.p.ko,david9.aci.p.ko,david10.aci.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.aci.p.ko<-data.frame(ID=david.ko.aci.p.ko$V1,DS=david.ko.aci.p.ko$V2,normDS=david.ko.aci.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.aci.p.ko<-lm(e1.1.aci.p.ko$energy_over_time~as.numeric(david1.1.aci.p.ko$normDS))
ko.lm.1.s.aci.p.ko<-summary(lm.ko.1.aci.p.ko)$coefficients
ko.1.slope.aci.p.ko<-ko.lm.1.s.aci.p.ko[2,1]
lm.ko.2.aci.p.ko<-lm(e2.1.aci.p.ko$energy_over_time~as.numeric(david2.1.aci.p.ko$normDS))
ko.lm.2.s.aci.p.ko<-summary(lm.ko.2.aci.p.ko)$coefficients
ko.2.slope.aci.p.ko<-ko.lm.2.s.aci.p.ko[2,1]
lm.ko.3.aci.p.ko<-lm(e3.1.aci.p.ko$energy_over_time~as.numeric(david3.1.aci.p.ko$normDS))
ko.lm.3.s.aci.p.ko<-summary(lm.ko.3.aci.p.ko)$coefficients
ko.3.slope.aci.p.ko<-ko.lm.3.s.aci.p.ko[2,1]
lm.ko.4.aci.p.ko<-lm(e4.1.aci.p.ko$energy_over_time~as.numeric(david4.1.aci.p.ko$normDS))
ko.lm.4.s.aci.p.ko<-summary(lm.ko.4.aci.p.ko)$coefficients
ko.4.slope.aci.p.ko<-ko.lm.4.s.aci.p.ko[2,1]
lm.ko.5.aci.p.ko<-lm(e5.1.aci.p.ko$energy_over_time~as.numeric(david5.1.aci.p.ko$normDS))
ko.lm.5.s.aci.p.ko<-summary(lm.ko.5.aci.p.ko)$coefficients
ko.5.slope.aci.p.ko<-ko.lm.5.s.aci.p.ko[2,1]
lm.ko.6.aci.p.ko<-lm(e6.1.aci.p.ko$energy_over_time~as.numeric(david6.1.aci.p.ko$normDS))
ko.lm.6.s.aci.p.ko<-summary(lm.ko.6.aci.p.ko)$coefficients
ko.6.slope.aci.p.ko<-ko.lm.6.s.aci.p.ko[2,1]
lm.ko.7.aci.p.ko<-lm(e7.1.aci.p.ko$energy_over_time~as.numeric(david7.1.aci.p.ko$normDS))
ko.lm.7.s.aci.p.ko<-summary(lm.ko.7.aci.p.ko)$coefficients
ko.7.slope.aci.p.ko<-ko.lm.7.s.aci.p.ko[2,1]
lm.ko.8.aci.p.ko<-lm(e8.1.aci.p.ko$energy_over_time~as.numeric(david8.1.aci.p.ko$normDS))
ko.lm.8.s.aci.p.ko<-summary(lm.ko.8.aci.p.ko)$coefficients
ko.8.slope.aci.p.ko<-ko.lm.8.s.aci.p.ko[2,1]
lm.ko.9.aci.p.ko<-lm(e9.1.aci.p.ko$energy_over_time~as.numeric(david9.1.aci.p.ko$normDS))
ko.lm.9.s.aci.p.ko<-summary(lm.ko.9.aci.p.ko)$coefficients
ko.9.slope.aci.p.ko<-ko.lm.9.s.aci.p.ko[2,1]
lm.ko.10.aci.p.ko<-lm(e10.1.aci.p.ko$energy_over_time~as.numeric(david10.1.aci.p.ko$normDS))
ko.lm.10.s.aci.p.ko<-summary(lm.ko.10.aci.p.ko)$coefficients
ko.10.slope.aci.p.ko<-ko.lm.10.s.aci.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.aci.p.ss.avoid.ci.p.ko<-data.frame(triangle.transitivity=c(tri1.aci.p.ko,tri2.aci.p.ko,tri3.aci.p.ko,tri4.aci.p.ko,tri5.aci.p.ko,tri6.aci.p.ko,tri7.aci.p.ko,tri8.aci.p.ko,tri9.aci.p.ko,tri10.aci.p.ko),escalation=c(ep1.aci.p.ko,ep2.aci.p.ko,ep3.aci.p.ko,ep4.aci.p.ko,ep5.aci.p.ko,ep6.aci.p.ko,ep7.aci.p.ko,ep8.aci.p.ko,ep9.aci.p.ko,ep10.aci.p.ko),dci=c(dci1.aci.p.ko,dci2.aci.p.ko,dci3.aci.p.ko,dci4.aci.p.ko,dci5.aci.p.ko,dci6.aci.p.ko,dci7.aci.p.ko,dci8.aci.p.ko,dci9.aci.p.ko,dci10.aci.p.ko),steepness=c(s1.aci.p.ko,s2.aci.p.ko,s3.aci.p.ko,s4.aci.p.ko,s5.aci.p.ko,s6.aci.p.ko,s7.aci.p.ko,s8.aci.p.ko,s9.aci.p.ko,s10.aci.p.ko),slope=c(ko.1.slope.aci.p.ko,ko.2.slope.aci.p.ko,ko.3.slope.aci.p.ko,ko.4.slope.aci.p.ko,ko.5.slope.aci.p.ko,ko.6.slope.aci.p.ko,ko.7.slope.aci.p.ko,ko.8.slope.aci.p.ko,ko.9.slope.aci.p.ko,ko.10.slope.aci.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the History Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.hm<-sapply(files, read.csv)

# Generate avoid.ci.p.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[1]],X2=avoid.ci.p.hm[[2]],Avoids=avoid.ci.p.hm[[3]])
mat1.aci.p.hm<-avoid.inter.mat(mut1.aci.p.hm)
tri1.aci.p.hm<-tr.tri(mat1.aci.p.hm)
dci1.aci.p.hm<-DCindex(mat1.aci.p.hm)
mat1.aci.p.hm[is.na(mat1.aci.p.hm)] = 0
h1.aci.p.hm<-h.index(mat1.aci.p.hm)

ep1.aci.p.hm<-ep(mut1.aci.p.hm,a1.ci.p.hm)
david1.aci.p.hm<-DS(mat1.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.hm<-cbind(ordrank.1.aci.p.hm,ds=david1.aci.p.hm$normDS)
lm1.aci.p.hm<-summary(lm(ordrank.1.aci.p.hm$ds~ordrank.1.aci.p.hm$ord.rank))
s1.aci.p.hm<-lm1.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[4]],X2=avoid.ci.p.hm[[5]],Avoids=avoid.ci.p.hm[[6]])
mat2.aci.p.hm<-avoid.inter.mat(mut2.aci.p.hm)
tri2.aci.p.hm<-tr.tri(mat2.aci.p.hm)
dci2.aci.p.hm<-DCindex(mat2.aci.p.hm)
mat2.aci.p.hm[is.na(mat2.aci.p.hm)] = 0
h2.aci.p.hm<-h.index(mat2.aci.p.hm)

ep2.aci.p.hm<-ep(mut2.aci.p.hm,a2.ci.p.hm)
david2.aci.p.hm<-DS(mat2.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.hm<-cbind(ordrank.2.aci.p.hm,ds=david2.aci.p.hm$normDS)
lm2.aci.p.hm<-summary(lm(ordrank.2.aci.p.hm$ds~ordrank.2.aci.p.hm$ord.rank))
s2.aci.p.hm<-lm2.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[7]],X2=avoid.ci.p.hm[[8]],Avoids=avoid.ci.p.hm[[9]])
mat3.aci.p.hm<-avoid.inter.mat(mut3.aci.p.hm)
tri3.aci.p.hm<-tr.tri(mat3.aci.p.hm)
dci3.aci.p.hm<-DCindex(mat3.aci.p.hm)
mat3.aci.p.hm[is.na(mat3.aci.p.hm)] = 0
h3.aci.p.hm<-h.index(mat3.aci.p.hm)

ep3.aci.p.hm<-ep(mut3.aci.p.hm,a3.ci.p.hm)
david3.aci.p.hm<-DS(mat3.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.hm<-cbind(ordrank.3.aci.p.hm,ds=david3.aci.p.hm$normDS)
lm3.aci.p.hm<-summary(lm(ordrank.3.aci.p.hm$ds~ordrank.3.aci.p.hm$ord.rank))
s3.aci.p.hm<-lm3.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[10]],X2=avoid.ci.p.hm[[11]],Avoids=avoid.ci.p.hm[[12]])
mat4.aci.p.hm<-avoid.inter.mat(mut4.aci.p.hm)
tri4.aci.p.hm<-tr.tri(mat4.aci.p.hm)
dci4.aci.p.hm<-DCindex(mat4.aci.p.hm)
mat4.aci.p.hm[is.na(mat4.aci.p.hm)] = 0
h4.aci.p.hm<-h.index(mat4.aci.p.hm)

ep4.aci.p.hm<-ep(mut4.aci.p.hm,a4.ci.p.hm)
david4.aci.p.hm<-DS(mat4.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.hm<-cbind(ordrank.4.aci.p.hm,ds=david4.aci.p.hm$normDS)
lm4.aci.p.hm<-summary(lm(ordrank.4.aci.p.hm$ds~ordrank.4.aci.p.hm$ord.rank))
s4.aci.p.hm<-lm4.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[13]],X2=avoid.ci.p.hm[[14]],Avoids=avoid.ci.p.hm[[15]])
mat5.aci.p.hm<-avoid.inter.mat(mut5.aci.p.hm)
tri5.aci.p.hm<-tr.tri(mat5.aci.p.hm)
dci5.aci.p.hm<-DCindex(mat5.aci.p.hm)
mat5.aci.p.hm[is.na(mat5.aci.p.hm)] = 0
h5.aci.p.hm<-h.index(mat5.aci.p.hm)

ep5.aci.p.hm<-ep(mut5.aci.p.hm,a5.ci.p.hm)
david5.aci.p.hm<-DS(mat5.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.hm<-cbind(ordrank.5.aci.p.hm,ds=david5.aci.p.hm$normDS)
lm5.aci.p.hm<-summary(lm(ordrank.5.aci.p.hm$ds~ordrank.5.aci.p.hm$ord.rank))
s5.aci.p.hm<-lm5.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[16]],X2=avoid.ci.p.hm[[17]],Avoids=avoid.ci.p.hm[[18]])
mat6.aci.p.hm<-avoid.inter.mat(mut6.aci.p.hm)
tri6.aci.p.hm<-tr.tri(mat6.aci.p.hm)
dci6.aci.p.hm<-DCindex(mat6.aci.p.hm)
mat6.aci.p.hm[is.na(mat6.aci.p.hm)] = 0
h6.aci.p.hm<-h.index(mat6.aci.p.hm)

ep6.aci.p.hm<-ep(mut6.aci.p.hm,a6.ci.p.hm)
david6.aci.p.hm<-DS(mat6.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.hm<-cbind(ordrank.6.aci.p.hm,ds=david6.aci.p.hm$normDS)
lm6.aci.p.hm<-summary(lm(ordrank.6.aci.p.hm$ds~ordrank.6.aci.p.hm$ord.rank))
s6.aci.p.hm<-lm6.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[19]],X2=avoid.ci.p.hm[[20]],Avoids=avoid.ci.p.hm[[21]])
mat7.aci.p.hm<-avoid.inter.mat(mut7.aci.p.hm)
tri7.aci.p.hm<-tr.tri(mat7.aci.p.hm)
dci7.aci.p.hm<-DCindex(mat7.aci.p.hm)
mat7.aci.p.hm[is.na(mat7.aci.p.hm)] = 0
h7.aci.p.hm<-h.index(mat7.aci.p.hm)

ep7.aci.p.hm<-ep(mut7.aci.p.hm,a7.ci.p.hm)
david7.aci.p.hm<-DS(mat7.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.hm<-cbind(ordrank.7.aci.p.hm,ds=david7.aci.p.hm$normDS)
lm7.aci.p.hm<-summary(lm(ordrank.7.aci.p.hm$ds~ordrank.7.aci.p.hm$ord.rank))
s7.aci.p.hm<-lm7.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[22]],X2=avoid.ci.p.hm[[23]],Avoids=avoid.ci.p.hm[[24]])
mat8.aci.p.hm<-avoid.inter.mat(mut8.aci.p.hm)
tri8.aci.p.hm<-tr.tri(mat8.aci.p.hm)
dci8.aci.p.hm<-DCindex(mat8.aci.p.hm)
mat8.aci.p.hm[is.na(mat8.aci.p.hm)] = 0
h8.aci.p.hm<-h.index(mat8.aci.p.hm)

ep8.aci.p.hm<-ep(mut8.aci.p.hm,a8.ci.p.hm)
david8.aci.p.hm<-DS(mat8.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.hm<-cbind(ordrank.8.aci.p.hm,ds=david8.aci.p.hm$normDS)
lm8.aci.p.hm<-summary(lm(ordrank.8.aci.p.hm$ds~ordrank.8.aci.p.hm$ord.rank))
s8.aci.p.hm<-lm8.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[25]],X2=avoid.ci.p.hm[[26]],Avoids=avoid.ci.p.hm[[27]])
mat9.aci.p.hm<-avoid.inter.mat(mut9.aci.p.hm)
tri9.aci.p.hm<-tr.tri(mat9.aci.p.hm)
dci9.aci.p.hm<-DCindex(mat9.aci.p.hm)
mat9.aci.p.hm[is.na(mat9.aci.p.hm)] = 0
h9.aci.p.hm<-h.index(mat9.aci.p.hm)

ep9.aci.p.hm<-ep(mut9.aci.p.hm,a9.ci.p.hm)
david9.aci.p.hm<-DS(mat9.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.hm<-cbind(ordrank.9.aci.p.hm,ds=david9.aci.p.hm$normDS)
lm9.aci.p.hm<-summary(lm(ordrank.9.aci.p.hm$ds~ordrank.9.aci.p.hm$ord.rank))
s9.aci.p.hm<-lm9.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.hm<-data.frame(X1=avoid.ci.p.hm[[28]],X2=avoid.ci.p.hm[[29]],Avoids=avoid.ci.p.hm[[30]])
mat10.aci.p.hm<-avoid.inter.mat(mut10.aci.p.hm)
tri10.aci.p.hm<-tr.tri(mat10.aci.p.hm)
dci10.aci.p.hm<-DCindex(mat10.aci.p.hm)
mat10.aci.p.hm[is.na(mat10.aci.p.hm)] = 0
h10.aci.p.hm<-h.index(mat10.aci.p.hm)

ep10.aci.p.hm<-ep(mut10.aci.p.hm,a10.ci.p.hm)
david10.aci.p.hm<-DS(mat10.aci.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.hm<-cbind(ordrank.10.aci.p.hm,ds=david10.aci.p.hm$normDS)
lm10.aci.p.hm<-summary(lm(ordrank.10.aci.p.hm$ds~ordrank.10.aci.p.hm$ord.rank))
s10.aci.p.hm<-lm10.aci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.hm<-sum(mut1.aci.p.hm$Victories)
int2.aci.p.hm<-sum(mut2.aci.p.hm$Victories)
int3.aci.p.hm<-sum(mut3.aci.p.hm$Victories)
int4.aci.p.hm<-sum(mut4.aci.p.hm$Victories)
int5.aci.p.hm<-sum(mut5.aci.p.hm$Victories)
int6.aci.p.hm<-sum(mut6.aci.p.hm$Victories)
int7.aci.p.hm<-sum(mut7.aci.p.hm$Victories)
int8.aci.p.hm<-sum(mut8.aci.p.hm$Victories)
int9.aci.p.hm<-sum(mut9.aci.p.hm$Victories)
int10.aci.p.hm<-sum(mut10.aci.p.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.hm<-sum(a1.ci.p.hm$Victories)
av2.aci.p.hm<-sum(a2.ci.p.hm$Victories)
av3.aci.p.hm<-sum(a3.ci.p.hm$Victories)
av4.aci.p.hm<-sum(a4.ci.p.hm$Victories)
av5.aci.p.hm<-sum(a5.ci.p.hm$Victories)
av6.aci.p.hm<-sum(a6.ci.p.hm$Victories)
av7.aci.p.hm<-sum(a7.ci.p.hm$Victories)
av8.aci.p.hm<-sum(a8.ci.p.hm$Victories)
av9.aci.p.hm<-sum(a9.ci.p.hm$Victories)
av10.aci.p.hm<-sum(a10.ci.p.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.aci.p<-(sum(av1.aci.p.hm, av2.aci.p.hm, av3.aci.p.hm, av4.aci.p.hm, av5.aci.p.hm, av6.aci.p.hm, av7.aci.p.hm, av8.aci.p.hm, av9.aci.p.hm, av10.aci.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.aci.p<-(sum(int1.aci.p.hm, int2.aci.p.hm, int3.aci.p.hm, int4.aci.p.hm, int5.aci.p.hm, int6.aci.p.hm, int7.aci.p.hm, int8.aci.p.hm, int9.aci.p.hm, int10.aci.p.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.hm<-e1.aci.p.hm[order(e1.aci.p.hm$ID),]
e1.aci.p.hm<-as.matrix(t(e1.1.aci.p.hm))

e2.aci.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.hm<-e2.aci.p.hm[order(e2.aci.p.hm$ID),]
e2.aci.p.hm<-as.matrix(t(e2.1.aci.p.hm))

e3.aci.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.hm<-e3.aci.p.hm[order(e3.aci.p.hm$ID),]
e3.aci.p.hm<-as.matrix(t(e3.1.aci.p.hm))

e4.aci.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.hm<-e4.aci.p.hm[order(e4.aci.p.hm$ID),]
e4.aci.p.hm<-as.matrix(t(e4.1.aci.p.hm))

e5.aci.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.hm<-e5.aci.p.hm[order(e5.aci.p.hm$ID),]
e5.aci.p.hm<-as.matrix(t(e5.1.aci.p.hm))

e6.aci.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.hm<-e6.aci.p.hm[order(e6.aci.p.hm$ID),]
e6.aci.p.hm<-as.matrix(t(e6.1.aci.p.hm))

e7.aci.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.hm<-e7.aci.p.hm[order(e7.aci.p.hm$ID),]
e7.aci.p.hm<-as.matrix(t(e7.1.aci.p.hm))

e8.aci.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.hm<-e8.aci.p.hm[order(e8.aci.p.hm$ID),]
e8.aci.p.hm<-as.matrix(t(e8.1.aci.p.hm))

e9.aci.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.hm<-e9.aci.p.hm[order(e9.aci.p.hm$ID),]
e9.aci.p.hm<-as.matrix(t(e9.1.aci.p.hm))

e10.aci.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.hm<-e10.aci.p.hm[order(e10.aci.p.hm$ID),]
e10.aci.p.hm<-as.matrix(t(e10.1.aci.p.hm))

energy.hm.aci.p.hm<-as.data.frame(matrix(c(e1.aci.p.hm,e2.aci.p.hm,e3.aci.p.hm,e4.aci.p.hm,e5.aci.p.hm,e6.aci.p.hm,e7.aci.p.hm,e8.aci.p.hm,e9.aci.p.hm,e10.aci.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aci.p.hm<-data.frame(ID=energy.hm.aci.p.hm$V1,energy_over_distance=energy.hm.aci.p.hm$V2,energy_over_time=energy.hm.aci.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.hm<-david1.aci.p.hm[order(david1.aci.p.hm$ID),]
david1.aci.p.hm<-as.matrix(t(david1.1.aci.p.hm))

david2.1.aci.p.hm<-david2.aci.p.hm[order(david2.aci.p.hm$ID),]
david2.aci.p.hm<-as.matrix(t(david2.1.aci.p.hm))

david3.1.aci.p.hm<-david3.aci.p.hm[order(david3.aci.p.hm$ID),]
david3.aci.p.hm<-as.matrix(t(david3.1.aci.p.hm))

david4.1.aci.p.hm<-david4.aci.p.hm[order(david4.aci.p.hm$ID),]
david4.aci.p.hm<-as.matrix(t(david4.1.aci.p.hm))

david5.1.aci.p.hm<-david5.aci.p.hm[order(david5.aci.p.hm$ID),]
david5.aci.p.hm<-as.matrix(t(david5.1.aci.p.hm))

david6.1.aci.p.hm<-david6.aci.p.hm[order(david6.aci.p.hm$ID),]
david6.aci.p.hm<-as.matrix(t(david6.1.aci.p.hm))

david7.1.aci.p.hm<-david7.aci.p.hm[order(david7.aci.p.hm$ID),]
david7.aci.p.hm<-as.matrix(t(david7.1.aci.p.hm))

david8.1.aci.p.hm<-david8.aci.p.hm[order(david8.aci.p.hm$ID),]
david8.aci.p.hm<-as.matrix(t(david8.1.aci.p.hm))

david9.1.aci.p.hm<-david9.aci.p.hm[order(david9.aci.p.hm$ID),]
david9.aci.p.hm<-as.matrix(t(david9.1.aci.p.hm))

david10.1.aci.p.hm<-david10.aci.p.hm[order(david10.aci.p.hm$ID),]
david10.aci.p.hm<-as.matrix(t(david10.1.aci.p.hm))

david.hm.aci.p.hm<-as.data.frame(matrix(c(david1.aci.p.hm,david2.aci.p.hm,david3.aci.p.hm,david4.aci.p.hm,david5.aci.p.hm,david6.aci.p.hm,david7.aci.p.hm,david8.aci.p.hm,david9.aci.p.hm,david10.aci.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aci.p.hm<-data.frame(ID=david.hm.aci.p.hm$V1,DS=david.hm.aci.p.hm$V2,normDS=david.hm.aci.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aci.p.hm<-lm(e1.1.aci.p.hm$energy_over_time~as.numeric(david1.1.aci.p.hm$normDS))
hm.lm.1.s.aci.p.hm<-summary(lm.hm.1.aci.p.hm)$coefficients
hm.1.slope.aci.p.hm<-hm.lm.1.s.aci.p.hm[2,1]
lm.hm.2.aci.p.hm<-lm(e2.1.aci.p.hm$energy_over_time~as.numeric(david2.1.aci.p.hm$normDS))
hm.lm.2.s.aci.p.hm<-summary(lm.hm.2.aci.p.hm)$coefficients
hm.2.slope.aci.p.hm<-hm.lm.2.s.aci.p.hm[2,1]
lm.hm.3.aci.p.hm<-lm(e3.1.aci.p.hm$energy_over_time~as.numeric(david3.1.aci.p.hm$normDS))
hm.lm.3.s.aci.p.hm<-summary(lm.hm.3.aci.p.hm)$coefficients
hm.3.slope.aci.p.hm<-hm.lm.3.s.aci.p.hm[2,1]
lm.hm.4.aci.p.hm<-lm(e4.1.aci.p.hm$energy_over_time~as.numeric(david4.1.aci.p.hm$normDS))
hm.lm.4.s.aci.p.hm<-summary(lm.hm.4.aci.p.hm)$coefficients
hm.4.slope.aci.p.hm<-hm.lm.4.s.aci.p.hm[2,1]
lm.hm.5.aci.p.hm<-lm(e5.1.aci.p.hm$energy_over_time~as.numeric(david5.1.aci.p.hm$normDS))
hm.lm.5.s.aci.p.hm<-summary(lm.hm.5.aci.p.hm)$coefficients
hm.5.slope.aci.p.hm<-hm.lm.5.s.aci.p.hm[2,1]
lm.hm.6.aci.p.hm<-lm(e6.1.aci.p.hm$energy_over_time~as.numeric(david6.1.aci.p.hm$normDS))
hm.lm.6.s.aci.p.hm<-summary(lm.hm.6.aci.p.hm)$coefficients
hm.6.slope.aci.p.hm<-hm.lm.6.s.aci.p.hm[2,1]
lm.hm.7.aci.p.hm<-lm(e7.1.aci.p.hm$energy_over_time~as.numeric(david7.1.aci.p.hm$normDS))
hm.lm.7.s.aci.p.hm<-summary(lm.hm.7.aci.p.hm)$coefficients
hm.7.slope.aci.p.hm<-hm.lm.7.s.aci.p.hm[2,1]
lm.hm.8.aci.p.hm<-lm(e8.1.aci.p.hm$energy_over_time~as.numeric(david8.1.aci.p.hm$normDS))
hm.lm.8.s.aci.p.hm<-summary(lm.hm.8.aci.p.hm)$coefficients
hm.8.slope.aci.p.hm<-hm.lm.8.s.aci.p.hm[2,1]
lm.hm.9.aci.p.hm<-lm(e9.1.aci.p.hm$energy_over_time~as.numeric(david9.1.aci.p.hm$normDS))
hm.lm.9.s.aci.p.hm<-summary(lm.hm.9.aci.p.hm)$coefficients
hm.9.slope.aci.p.hm<-hm.lm.9.s.aci.p.hm[2,1]
lm.hm.10.aci.p.hm<-lm(e10.1.aci.p.hm$energy_over_time~as.numeric(david10.1.aci.p.hm$normDS))
hm.lm.10.s.aci.p.hm<-summary(lm.hm.10.aci.p.hm)$coefficients
hm.10.slope.aci.p.hm<-hm.lm.10.s.aci.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aci.p.ss.avoid.ci.p.hm<-data.frame(triangle.transitivity=c(tri1.aci.p.hm,tri2.aci.p.hm,tri3.aci.p.hm,tri4.aci.p.hm,tri5.aci.p.hm,tri6.aci.p.hm,tri7.aci.p.hm,tri8.aci.p.hm,tri9.aci.p.hm,tri10.aci.p.hm),escalation=c(ep1.aci.p.hm,ep2.aci.p.hm,ep3.aci.p.hm,ep4.aci.p.hm,ep5.aci.p.hm,ep6.aci.p.hm,ep7.aci.p.hm,ep8.aci.p.hm,ep9.aci.p.hm,ep10.aci.p.hm),dci=c(dci1.aci.p.hm,dci2.aci.p.hm,dci3.aci.p.hm,dci4.aci.p.hm,dci5.aci.p.hm,dci6.aci.p.hm,dci7.aci.p.hm,dci8.aci.p.hm,dci9.aci.p.hm,dci10.aci.p.hm),steepness=c(s1.aci.p.hm,s2.aci.p.hm,s3.aci.p.hm,s4.aci.p.hm,s5.aci.p.hm,s6.aci.p.hm,s7.aci.p.hm,s8.aci.p.hm,s9.aci.p.hm,s10.aci.p.hm),slope=c(hm.1.slope.aci.p.hm,hm.2.slope.aci.p.hm,hm.3.slope.aci.p.hm,hm.4.slope.aci.p.hm,hm.5.slope.aci.p.hm,hm.6.slope.aci.p.hm,hm.7.slope.aci.p.hm,hm.8.slope.aci.p.hm,hm.9.slope.aci.p.hm,hm.10.slope.aci.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the History Self Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.hs<-sapply(files, read.csv)

# Generate avoid.ci.p.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[1]],X2=avoid.ci.p.hs[[2]],Avoids=avoid.ci.p.hs[[3]])
mat1.aci.p.hs<-avoid.inter.mat(mut1.aci.p.hs)
tri1.aci.p.hs<-tr.tri(mat1.aci.p.hs)
dci1.aci.p.hs<-DCindex(mat1.aci.p.hs)
mat1.aci.p.hs[is.na(mat1.aci.p.hs)] = 0
h1.aci.p.hs<-h.index(mat1.aci.p.hs)

ep1.aci.p.hs<-ep(mut1.aci.p.hs,a1.ci.p.hs)
david1.aci.p.hs<-DS(mat1.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.hs<-cbind(ordrank.1.aci.p.hs,ds=david1.aci.p.hs$normDS)
lm1.aci.p.hs<-summary(lm(ordrank.1.aci.p.hs$ds~ordrank.1.aci.p.hs$ord.rank))
s1.aci.p.hs<-lm1.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[4]],X2=avoid.ci.p.hs[[5]],Avoids=avoid.ci.p.hs[[6]])
mat2.aci.p.hs<-avoid.inter.mat(mut2.aci.p.hs)
tri2.aci.p.hs<-tr.tri(mat2.aci.p.hs)
dci2.aci.p.hs<-DCindex(mat2.aci.p.hs)
mat2.aci.p.hs[is.na(mat2.aci.p.hs)] = 0
h2.aci.p.hs<-h.index(mat2.aci.p.hs)

ep2.aci.p.hs<-ep(mut2.aci.p.hs,a2.ci.p.hs)
david2.aci.p.hs<-DS(mat2.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.hs<-cbind(ordrank.2.aci.p.hs,ds=david2.aci.p.hs$normDS)
lm2.aci.p.hs<-summary(lm(ordrank.2.aci.p.hs$ds~ordrank.2.aci.p.hs$ord.rank))
s2.aci.p.hs<-lm2.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[7]],X2=avoid.ci.p.hs[[8]],Avoids=avoid.ci.p.hs[[9]])
mat3.aci.p.hs<-avoid.inter.mat(mut3.aci.p.hs)
tri3.aci.p.hs<-tr.tri(mat3.aci.p.hs)
dci3.aci.p.hs<-DCindex(mat3.aci.p.hs)
mat3.aci.p.hs[is.na(mat3.aci.p.hs)] = 0
h3.aci.p.hs<-h.index(mat3.aci.p.hs)

ep3.aci.p.hs<-ep(mut3.aci.p.hs,a3.ci.p.hs)
david3.aci.p.hs<-DS(mat3.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.hs<-cbind(ordrank.3.aci.p.hs,ds=david3.aci.p.hs$normDS)
lm3.aci.p.hs<-summary(lm(ordrank.3.aci.p.hs$ds~ordrank.3.aci.p.hs$ord.rank))
s3.aci.p.hs<-lm3.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[10]],X2=avoid.ci.p.hs[[11]],Avoids=avoid.ci.p.hs[[12]])
mat4.aci.p.hs<-avoid.inter.mat(mut4.aci.p.hs)
tri4.aci.p.hs<-tr.tri(mat4.aci.p.hs)
dci4.aci.p.hs<-DCindex(mat4.aci.p.hs)
mat4.aci.p.hs[is.na(mat4.aci.p.hs)] = 0
h4.aci.p.hs<-h.index(mat4.aci.p.hs)

ep4.aci.p.hs<-ep(mut4.aci.p.hs,a4.ci.p.hs)
david4.aci.p.hs<-DS(mat4.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.hs<-cbind(ordrank.4.aci.p.hs,ds=david4.aci.p.hs$normDS)
lm4.aci.p.hs<-summary(lm(ordrank.4.aci.p.hs$ds~ordrank.4.aci.p.hs$ord.rank))
s4.aci.p.hs<-lm4.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[13]],X2=avoid.ci.p.hs[[14]],Avoids=avoid.ci.p.hs[[15]])
mat5.aci.p.hs<-avoid.inter.mat(mut5.aci.p.hs)
tri5.aci.p.hs<-tr.tri(mat5.aci.p.hs)
dci5.aci.p.hs<-DCindex(mat5.aci.p.hs)
mat5.aci.p.hs[is.na(mat5.aci.p.hs)] = 0
h5.aci.p.hs<-h.index(mat5.aci.p.hs)

ep5.aci.p.hs<-ep(mut5.aci.p.hs,a5.ci.p.hs)
david5.aci.p.hs<-DS(mat5.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.hs<-cbind(ordrank.5.aci.p.hs,ds=david5.aci.p.hs$normDS)
lm5.aci.p.hs<-summary(lm(ordrank.5.aci.p.hs$ds~ordrank.5.aci.p.hs$ord.rank))
s5.aci.p.hs<-lm5.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[16]],X2=avoid.ci.p.hs[[17]],Avoids=avoid.ci.p.hs[[18]])
mat6.aci.p.hs<-avoid.inter.mat(mut6.aci.p.hs)
tri6.aci.p.hs<-tr.tri(mat6.aci.p.hs)
dci6.aci.p.hs<-DCindex(mat6.aci.p.hs)
mat6.aci.p.hs[is.na(mat6.aci.p.hs)] = 0
h6.aci.p.hs<-h.index(mat6.aci.p.hs)

ep6.aci.p.hs<-ep(mut6.aci.p.hs,a6.ci.p.hs)
david6.aci.p.hs<-DS(mat6.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.hs<-cbind(ordrank.6.aci.p.hs,ds=david6.aci.p.hs$normDS)
lm6.aci.p.hs<-summary(lm(ordrank.6.aci.p.hs$ds~ordrank.6.aci.p.hs$ord.rank))
s6.aci.p.hs<-lm6.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[19]],X2=avoid.ci.p.hs[[20]],Avoids=avoid.ci.p.hs[[21]])
mat7.aci.p.hs<-avoid.inter.mat(mut7.aci.p.hs)
tri7.aci.p.hs<-tr.tri(mat7.aci.p.hs)
dci7.aci.p.hs<-DCindex(mat7.aci.p.hs)
mat7.aci.p.hs[is.na(mat7.aci.p.hs)] = 0
h7.aci.p.hs<-h.index(mat7.aci.p.hs)

ep7.aci.p.hs<-ep(mut7.aci.p.hs,a7.ci.p.hs)
david7.aci.p.hs<-DS(mat7.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.hs<-cbind(ordrank.7.aci.p.hs,ds=david7.aci.p.hs$normDS)
lm7.aci.p.hs<-summary(lm(ordrank.7.aci.p.hs$ds~ordrank.7.aci.p.hs$ord.rank))
s7.aci.p.hs<-lm7.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[22]],X2=avoid.ci.p.hs[[23]],Avoids=avoid.ci.p.hs[[24]])
mat8.aci.p.hs<-avoid.inter.mat(mut8.aci.p.hs)
tri8.aci.p.hs<-tr.tri(mat8.aci.p.hs)
dci8.aci.p.hs<-DCindex(mat8.aci.p.hs)
mat8.aci.p.hs[is.na(mat8.aci.p.hs)] = 0
h8.aci.p.hs<-h.index(mat8.aci.p.hs)

ep8.aci.p.hs<-ep(mut8.aci.p.hs,a8.ci.p.hs)
david8.aci.p.hs<-DS(mat8.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.hs<-cbind(ordrank.8.aci.p.hs,ds=david8.aci.p.hs$normDS)
lm8.aci.p.hs<-summary(lm(ordrank.8.aci.p.hs$ds~ordrank.8.aci.p.hs$ord.rank))
s8.aci.p.hs<-lm8.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[25]],X2=avoid.ci.p.hs[[26]],Avoids=avoid.ci.p.hs[[27]])
mat9.aci.p.hs<-avoid.inter.mat(mut9.aci.p.hs)
tri9.aci.p.hs<-tr.tri(mat9.aci.p.hs)
dci9.aci.p.hs<-DCindex(mat9.aci.p.hs)
mat9.aci.p.hs[is.na(mat9.aci.p.hs)] = 0
h9.aci.p.hs<-h.index(mat9.aci.p.hs)

ep9.aci.p.hs<-ep(mut9.aci.p.hs,a9.ci.p.hs)
david9.aci.p.hs<-DS(mat9.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.hs<-cbind(ordrank.9.aci.p.hs,ds=david9.aci.p.hs$normDS)
lm9.aci.p.hs<-summary(lm(ordrank.9.aci.p.hs$ds~ordrank.9.aci.p.hs$ord.rank))
s9.aci.p.hs<-lm9.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.hs<-data.frame(X1=avoid.ci.p.hs[[28]],X2=avoid.ci.p.hs[[29]],Avoids=avoid.ci.p.hs[[30]])
mat10.aci.p.hs<-avoid.inter.mat(mut10.aci.p.hs)
tri10.aci.p.hs<-tr.tri(mat10.aci.p.hs)
dci10.aci.p.hs<-DCindex(mat10.aci.p.hs)
mat10.aci.p.hs[is.na(mat10.aci.p.hs)] = 0
h10.aci.p.hs<-h.index(mat10.aci.p.hs)

ep10.aci.p.hs<-ep(mut10.aci.p.hs,a10.ci.p.hs)
david10.aci.p.hs<-DS(mat10.aci.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.hs<-cbind(ordrank.10.aci.p.hs,ds=david10.aci.p.hs$normDS)
lm10.aci.p.hs<-summary(lm(ordrank.10.aci.p.hs$ds~ordrank.10.aci.p.hs$ord.rank))
s10.aci.p.hs<-lm10.aci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.hs<-sum(mut1.aci.p.hs$Victories)
int2.aci.p.hs<-sum(mut2.aci.p.hs$Victories)
int3.aci.p.hs<-sum(mut3.aci.p.hs$Victories)
int4.aci.p.hs<-sum(mut4.aci.p.hs$Victories)
int5.aci.p.hs<-sum(mut5.aci.p.hs$Victories)
int6.aci.p.hs<-sum(mut6.aci.p.hs$Victories)
int7.aci.p.hs<-sum(mut7.aci.p.hs$Victories)
int8.aci.p.hs<-sum(mut8.aci.p.hs$Victories)
int9.aci.p.hs<-sum(mut9.aci.p.hs$Victories)
int10.aci.p.hs<-sum(mut10.aci.p.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.hs<-sum(a1.ci.p.hs$Victories)
av2.aci.p.hs<-sum(a2.ci.p.hs$Victories)
av3.aci.p.hs<-sum(a3.ci.p.hs$Victories)
av4.aci.p.hs<-sum(a4.ci.p.hs$Victories)
av5.aci.p.hs<-sum(a5.ci.p.hs$Victories)
av6.aci.p.hs<-sum(a6.ci.p.hs$Victories)
av7.aci.p.hs<-sum(a7.ci.p.hs$Victories)
av8.aci.p.hs<-sum(a8.ci.p.hs$Victories)
av9.aci.p.hs<-sum(a9.ci.p.hs$Victories)
av10.aci.p.hs<-sum(a10.ci.p.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.aci.p<-(sum(av1.aci.p.hs, av2.aci.p.hs, av3.aci.p.hs, av4.aci.p.hs, av5.aci.p.hs, av6.aci.p.hs, av7.aci.p.hs, av8.aci.p.hs, av9.aci.p.hs, av10.aci.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.aci.p<-(sum(int1.aci.p.hs, int2.aci.p.hs, int3.aci.p.hs, int4.aci.p.hs, int5.aci.p.hs, int6.aci.p.hs, int7.aci.p.hs, int8.aci.p.hs, int9.aci.p.hs, int10.aci.p.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.hs<-e1.aci.p.hs[order(e1.aci.p.hs$ID),]
e1.aci.p.hs<-as.matrix(t(e1.1.aci.p.hs))

e2.aci.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.hs<-e2.aci.p.hs[order(e2.aci.p.hs$ID),]
e2.aci.p.hs<-as.matrix(t(e2.1.aci.p.hs))

e3.aci.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.hs<-e3.aci.p.hs[order(e3.aci.p.hs$ID),]
e3.aci.p.hs<-as.matrix(t(e3.1.aci.p.hs))

e4.aci.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.hs<-e4.aci.p.hs[order(e4.aci.p.hs$ID),]
e4.aci.p.hs<-as.matrix(t(e4.1.aci.p.hs))

e5.aci.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.hs<-e5.aci.p.hs[order(e5.aci.p.hs$ID),]
e5.aci.p.hs<-as.matrix(t(e5.1.aci.p.hs))

e6.aci.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.hs<-e6.aci.p.hs[order(e6.aci.p.hs$ID),]
e6.aci.p.hs<-as.matrix(t(e6.1.aci.p.hs))

e7.aci.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.hs<-e7.aci.p.hs[order(e7.aci.p.hs$ID),]
e7.aci.p.hs<-as.matrix(t(e7.1.aci.p.hs))

e8.aci.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.hs<-e8.aci.p.hs[order(e8.aci.p.hs$ID),]
e8.aci.p.hs<-as.matrix(t(e8.1.aci.p.hs))

e9.aci.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.hs<-e9.aci.p.hs[order(e9.aci.p.hs$ID),]
e9.aci.p.hs<-as.matrix(t(e9.1.aci.p.hs))

e10.aci.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.hs<-e10.aci.p.hs[order(e10.aci.p.hs$ID),]
e10.aci.p.hs<-as.matrix(t(e10.1.aci.p.hs))

energy.hs.aci.p.hs<-as.data.frame(matrix(c(e1.aci.p.hs,e2.aci.p.hs,e3.aci.p.hs,e4.aci.p.hs,e5.aci.p.hs,e6.aci.p.hs,e7.aci.p.hs,e8.aci.p.hs,e9.aci.p.hs,e10.aci.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.aci.p.hs<-data.frame(ID=energy.hs.aci.p.hs$V1,energy_over_distance=energy.hs.aci.p.hs$V2,energy_over_time=energy.hs.aci.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.hs<-david1.aci.p.hs[order(david1.aci.p.hs$ID),]
david1.aci.p.hs<-as.matrix(t(david1.1.aci.p.hs))

david2.1.aci.p.hs<-david2.aci.p.hs[order(david2.aci.p.hs$ID),]
david2.aci.p.hs<-as.matrix(t(david2.1.aci.p.hs))

david3.1.aci.p.hs<-david3.aci.p.hs[order(david3.aci.p.hs$ID),]
david3.aci.p.hs<-as.matrix(t(david3.1.aci.p.hs))

david4.1.aci.p.hs<-david4.aci.p.hs[order(david4.aci.p.hs$ID),]
david4.aci.p.hs<-as.matrix(t(david4.1.aci.p.hs))

david5.1.aci.p.hs<-david5.aci.p.hs[order(david5.aci.p.hs$ID),]
david5.aci.p.hs<-as.matrix(t(david5.1.aci.p.hs))

david6.1.aci.p.hs<-david6.aci.p.hs[order(david6.aci.p.hs$ID),]
david6.aci.p.hs<-as.matrix(t(david6.1.aci.p.hs))

david7.1.aci.p.hs<-david7.aci.p.hs[order(david7.aci.p.hs$ID),]
david7.aci.p.hs<-as.matrix(t(david7.1.aci.p.hs))

david8.1.aci.p.hs<-david8.aci.p.hs[order(david8.aci.p.hs$ID),]
david8.aci.p.hs<-as.matrix(t(david8.1.aci.p.hs))

david9.1.aci.p.hs<-david9.aci.p.hs[order(david9.aci.p.hs$ID),]
david9.aci.p.hs<-as.matrix(t(david9.1.aci.p.hs))

david10.1.aci.p.hs<-david10.aci.p.hs[order(david10.aci.p.hs$ID),]
david10.aci.p.hs<-as.matrix(t(david10.1.aci.p.hs))

david.hs.aci.p.hs<-as.data.frame(matrix(c(david1.aci.p.hs,david2.aci.p.hs,david3.aci.p.hs,david4.aci.p.hs,david5.aci.p.hs,david6.aci.p.hs,david7.aci.p.hs,david8.aci.p.hs,david9.aci.p.hs,david10.aci.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.aci.p.hs<-data.frame(ID=david.hs.aci.p.hs$V1,DS=david.hs.aci.p.hs$V2,normDS=david.hs.aci.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.aci.p.hs<-lm(e1.1.aci.p.hs$energy_over_time~as.numeric(david1.1.aci.p.hs$normDS))
hs.lm.1.s.aci.p.hs<-summary(lm.hs.1.aci.p.hs)$coefficients
hs.1.slope.aci.p.hs<-hs.lm.1.s.aci.p.hs[2,1]
lm.hs.2.aci.p.hs<-lm(e2.1.aci.p.hs$energy_over_time~as.numeric(david2.1.aci.p.hs$normDS))
hs.lm.2.s.aci.p.hs<-summary(lm.hs.2.aci.p.hs)$coefficients
hs.2.slope.aci.p.hs<-hs.lm.2.s.aci.p.hs[2,1]
lm.hs.3.aci.p.hs<-lm(e3.1.aci.p.hs$energy_over_time~as.numeric(david3.1.aci.p.hs$normDS))
hs.lm.3.s.aci.p.hs<-summary(lm.hs.3.aci.p.hs)$coefficients
hs.3.slope.aci.p.hs<-hs.lm.3.s.aci.p.hs[2,1]
lm.hs.4.aci.p.hs<-lm(e4.1.aci.p.hs$energy_over_time~as.numeric(david4.1.aci.p.hs$normDS))
hs.lm.4.s.aci.p.hs<-summary(lm.hs.4.aci.p.hs)$coefficients
hs.4.slope.aci.p.hs<-hs.lm.4.s.aci.p.hs[2,1]
lm.hs.5.aci.p.hs<-lm(e5.1.aci.p.hs$energy_over_time~as.numeric(david5.1.aci.p.hs$normDS))
hs.lm.5.s.aci.p.hs<-summary(lm.hs.5.aci.p.hs)$coefficients
hs.5.slope.aci.p.hs<-hs.lm.5.s.aci.p.hs[2,1]
lm.hs.6.aci.p.hs<-lm(e6.1.aci.p.hs$energy_over_time~as.numeric(david6.1.aci.p.hs$normDS))
hs.lm.6.s.aci.p.hs<-summary(lm.hs.6.aci.p.hs)$coefficients
hs.6.slope.aci.p.hs<-hs.lm.6.s.aci.p.hs[2,1]
lm.hs.7.aci.p.hs<-lm(e7.1.aci.p.hs$energy_over_time~as.numeric(david7.1.aci.p.hs$normDS))
hs.lm.7.s.aci.p.hs<-summary(lm.hs.7.aci.p.hs)$coefficients
hs.7.slope.aci.p.hs<-hs.lm.7.s.aci.p.hs[2,1]
lm.hs.8.aci.p.hs<-lm(e8.1.aci.p.hs$energy_over_time~as.numeric(david8.1.aci.p.hs$normDS))
hs.lm.8.s.aci.p.hs<-summary(lm.hs.8.aci.p.hs)$coefficients
hs.8.slope.aci.p.hs<-hs.lm.8.s.aci.p.hs[2,1]
lm.hs.9.aci.p.hs<-lm(e9.1.aci.p.hs$energy_over_time~as.numeric(david9.1.aci.p.hs$normDS))
hs.lm.9.s.aci.p.hs<-summary(lm.hs.9.aci.p.hs)$coefficients
hs.9.slope.aci.p.hs<-hs.lm.9.s.aci.p.hs[2,1]
lm.hs.10.aci.p.hs<-lm(e10.1.aci.p.hs$energy_over_time~as.numeric(david10.1.aci.p.hs$normDS))
hs.lm.10.s.aci.p.hs<-summary(lm.hs.10.aci.p.hs)$coefficients
hs.10.slope.aci.p.hs<-hs.lm.10.s.aci.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.aci.p.ss.avoid.ci.p.hs<-data.frame(triangle.transitivity=c(tri1.aci.p.hs,tri2.aci.p.hs,tri3.aci.p.hs,tri4.aci.p.hs,tri5.aci.p.hs,tri6.aci.p.hs,tri7.aci.p.hs,tri8.aci.p.hs,tri9.aci.p.hs,tri10.aci.p.hs),escalation=c(ep1.aci.p.hs,ep2.aci.p.hs,ep3.aci.p.hs,ep4.aci.p.hs,ep5.aci.p.hs,ep6.aci.p.hs,ep7.aci.p.hs,ep8.aci.p.hs,ep9.aci.p.hs,ep10.aci.p.hs),dci=c(dci1.aci.p.hs,dci2.aci.p.hs,dci3.aci.p.hs,dci4.aci.p.hs,dci5.aci.p.hs,dci6.aci.p.hs,dci7.aci.p.hs,dci8.aci.p.hs,dci9.aci.p.hs,dci10.aci.p.hs),steepness=c(s1.aci.p.hs,s2.aci.p.hs,s3.aci.p.hs,s4.aci.p.hs,s5.aci.p.hs,s6.aci.p.hs,s7.aci.p.hs,s8.aci.p.hs,s9.aci.p.hs,s10.aci.p.hs),slope=c(hs.1.slope.aci.p.hs,hs.2.slope.aci.p.hs,hs.3.slope.aci.p.hs,hs.4.slope.aci.p.hs,hs.5.slope.aci.p.hs,hs.6.slope.aci.p.hs,hs.7.slope.aci.p.hs,hs.8.slope.aci.p.hs,hs.9.slope.aci.p.hs,hs.10.slope.aci.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the History Opponent Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ci.p.ho<-sapply(files, read.csv)

# Generate avoid.ci.p.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[1]],X2=avoid.ci.p.ho[[2]],Avoids=avoid.ci.p.ho[[3]])
mat1.aci.p.ho<-avoid.inter.mat(mut1.aci.p.ho)
tri1.aci.p.ho<-tr.tri(mat1.aci.p.ho)
dci1.aci.p.ho<-DCindex(mat1.aci.p.ho)
mat1.aci.p.ho[is.na(mat1.aci.p.ho)] = 0
h1.aci.p.ho<-h.index(mat1.aci.p.ho)

ep1.aci.p.ho<-ep(mut1.aci.p.ho,a1.ci.p.ho)
david1.aci.p.ho<-DS(mat1.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aci.p.ho<-cbind(ordrank.1.aci.p.ho,ds=david1.aci.p.ho$normDS)
lm1.aci.p.ho<-summary(lm(ordrank.1.aci.p.ho$ds~ordrank.1.aci.p.ho$ord.rank))
s1.aci.p.ho<-lm1.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[4]],X2=avoid.ci.p.ho[[5]],Avoids=avoid.ci.p.ho[[6]])
mat2.aci.p.ho<-avoid.inter.mat(mut2.aci.p.ho)
tri2.aci.p.ho<-tr.tri(mat2.aci.p.ho)
dci2.aci.p.ho<-DCindex(mat2.aci.p.ho)
mat2.aci.p.ho[is.na(mat2.aci.p.ho)] = 0
h2.aci.p.ho<-h.index(mat2.aci.p.ho)

ep2.aci.p.ho<-ep(mut2.aci.p.ho,a2.ci.p.ho)
david2.aci.p.ho<-DS(mat2.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aci.p.ho<-cbind(ordrank.2.aci.p.ho,ds=david2.aci.p.ho$normDS)
lm2.aci.p.ho<-summary(lm(ordrank.2.aci.p.ho$ds~ordrank.2.aci.p.ho$ord.rank))
s2.aci.p.ho<-lm2.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[7]],X2=avoid.ci.p.ho[[8]],Avoids=avoid.ci.p.ho[[9]])
mat3.aci.p.ho<-avoid.inter.mat(mut3.aci.p.ho)
tri3.aci.p.ho<-tr.tri(mat3.aci.p.ho)
dci3.aci.p.ho<-DCindex(mat3.aci.p.ho)
mat3.aci.p.ho[is.na(mat3.aci.p.ho)] = 0
h3.aci.p.ho<-h.index(mat3.aci.p.ho)

ep3.aci.p.ho<-ep(mut3.aci.p.ho,a3.ci.p.ho)
david3.aci.p.ho<-DS(mat3.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aci.p.ho<-cbind(ordrank.3.aci.p.ho,ds=david3.aci.p.ho$normDS)
lm3.aci.p.ho<-summary(lm(ordrank.3.aci.p.ho$ds~ordrank.3.aci.p.ho$ord.rank))
s3.aci.p.ho<-lm3.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[10]],X2=avoid.ci.p.ho[[11]],Avoids=avoid.ci.p.ho[[12]])
mat4.aci.p.ho<-avoid.inter.mat(mut4.aci.p.ho)
tri4.aci.p.ho<-tr.tri(mat4.aci.p.ho)
dci4.aci.p.ho<-DCindex(mat4.aci.p.ho)
mat4.aci.p.ho[is.na(mat4.aci.p.ho)] = 0
h4.aci.p.ho<-h.index(mat4.aci.p.ho)

ep4.aci.p.ho<-ep(mut4.aci.p.ho,a4.ci.p.ho)
david4.aci.p.ho<-DS(mat4.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aci.p.ho<-cbind(ordrank.4.aci.p.ho,ds=david4.aci.p.ho$normDS)
lm4.aci.p.ho<-summary(lm(ordrank.4.aci.p.ho$ds~ordrank.4.aci.p.ho$ord.rank))
s4.aci.p.ho<-lm4.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[13]],X2=avoid.ci.p.ho[[14]],Avoids=avoid.ci.p.ho[[15]])
mat5.aci.p.ho<-avoid.inter.mat(mut5.aci.p.ho)
tri5.aci.p.ho<-tr.tri(mat5.aci.p.ho)
dci5.aci.p.ho<-DCindex(mat5.aci.p.ho)
mat5.aci.p.ho[is.na(mat5.aci.p.ho)] = 0
h5.aci.p.ho<-h.index(mat5.aci.p.ho)

ep5.aci.p.ho<-ep(mut5.aci.p.ho,a5.ci.p.ho)
david5.aci.p.ho<-DS(mat5.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aci.p.ho<-cbind(ordrank.5.aci.p.ho,ds=david5.aci.p.ho$normDS)
lm5.aci.p.ho<-summary(lm(ordrank.5.aci.p.ho$ds~ordrank.5.aci.p.ho$ord.rank))
s5.aci.p.ho<-lm5.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[16]],X2=avoid.ci.p.ho[[17]],Avoids=avoid.ci.p.ho[[18]])
mat6.aci.p.ho<-avoid.inter.mat(mut6.aci.p.ho)
tri6.aci.p.ho<-tr.tri(mat6.aci.p.ho)
dci6.aci.p.ho<-DCindex(mat6.aci.p.ho)
mat6.aci.p.ho[is.na(mat6.aci.p.ho)] = 0
h6.aci.p.ho<-h.index(mat6.aci.p.ho)

ep6.aci.p.ho<-ep(mut6.aci.p.ho,a6.ci.p.ho)
david6.aci.p.ho<-DS(mat6.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aci.p.ho<-cbind(ordrank.6.aci.p.ho,ds=david6.aci.p.ho$normDS)
lm6.aci.p.ho<-summary(lm(ordrank.6.aci.p.ho$ds~ordrank.6.aci.p.ho$ord.rank))
s6.aci.p.ho<-lm6.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[19]],X2=avoid.ci.p.ho[[20]],Avoids=avoid.ci.p.ho[[21]])
mat7.aci.p.ho<-avoid.inter.mat(mut7.aci.p.ho)
tri7.aci.p.ho<-tr.tri(mat7.aci.p.ho)
dci7.aci.p.ho<-DCindex(mat7.aci.p.ho)
mat7.aci.p.ho[is.na(mat7.aci.p.ho)] = 0
h7.aci.p.ho<-h.index(mat7.aci.p.ho)

ep7.aci.p.ho<-ep(mut7.aci.p.ho,a7.ci.p.ho)
david7.aci.p.ho<-DS(mat7.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aci.p.ho<-cbind(ordrank.7.aci.p.ho,ds=david7.aci.p.ho$normDS)
lm7.aci.p.ho<-summary(lm(ordrank.7.aci.p.ho$ds~ordrank.7.aci.p.ho$ord.rank))
s7.aci.p.ho<-lm7.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[22]],X2=avoid.ci.p.ho[[23]],Avoids=avoid.ci.p.ho[[24]])
mat8.aci.p.ho<-avoid.inter.mat(mut8.aci.p.ho)
tri8.aci.p.ho<-tr.tri(mat8.aci.p.ho)
dci8.aci.p.ho<-DCindex(mat8.aci.p.ho)
mat8.aci.p.ho[is.na(mat8.aci.p.ho)] = 0
h8.aci.p.ho<-h.index(mat8.aci.p.ho)

ep8.aci.p.ho<-ep(mut8.aci.p.ho,a8.ci.p.ho)
david8.aci.p.ho<-DS(mat8.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aci.p.ho<-cbind(ordrank.8.aci.p.ho,ds=david8.aci.p.ho$normDS)
lm8.aci.p.ho<-summary(lm(ordrank.8.aci.p.ho$ds~ordrank.8.aci.p.ho$ord.rank))
s8.aci.p.ho<-lm8.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[25]],X2=avoid.ci.p.ho[[26]],Avoids=avoid.ci.p.ho[[27]])
mat9.aci.p.ho<-avoid.inter.mat(mut9.aci.p.ho)
tri9.aci.p.ho<-tr.tri(mat9.aci.p.ho)
dci9.aci.p.ho<-DCindex(mat9.aci.p.ho)
mat9.aci.p.ho[is.na(mat9.aci.p.ho)] = 0
h9.aci.p.ho<-h.index(mat9.aci.p.ho)

ep9.aci.p.ho<-ep(mut9.aci.p.ho,a9.ci.p.ho)
david9.aci.p.ho<-DS(mat9.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aci.p.ho<-cbind(ordrank.9.aci.p.ho,ds=david9.aci.p.ho$normDS)
lm9.aci.p.ho<-summary(lm(ordrank.9.aci.p.ho$ds~ordrank.9.aci.p.ho$ord.rank))
s9.aci.p.ho<-lm9.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aci.p.ho<-data.frame(X1=avoid.ci.p.ho[[28]],X2=avoid.ci.p.ho[[29]],Avoids=avoid.ci.p.ho[[30]])
mat10.aci.p.ho<-avoid.inter.mat(mut10.aci.p.ho)
tri10.aci.p.ho<-tr.tri(mat10.aci.p.ho)
dci10.aci.p.ho<-DCindex(mat10.aci.p.ho)
mat10.aci.p.ho[is.na(mat10.aci.p.ho)] = 0
h10.aci.p.ho<-h.index(mat10.aci.p.ho)

ep10.aci.p.ho<-ep(mut10.aci.p.ho,a10.ci.p.ho)
david10.aci.p.ho<-DS(mat10.aci.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.aci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aci.p.ho<-cbind(ordrank.10.aci.p.ho,ds=david10.aci.p.ho$normDS)
lm10.aci.p.ho<-summary(lm(ordrank.10.aci.p.ho$ds~ordrank.10.aci.p.ho$ord.rank))
s10.aci.p.ho<-lm10.aci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aci.p.ho<-sum(mut1.aci.p.ho$Victories)
int2.aci.p.ho<-sum(mut2.aci.p.ho$Victories)
int3.aci.p.ho<-sum(mut3.aci.p.ho$Victories)
int4.aci.p.ho<-sum(mut4.aci.p.ho$Victories)
int5.aci.p.ho<-sum(mut5.aci.p.ho$Victories)
int6.aci.p.ho<-sum(mut6.aci.p.ho$Victories)
int7.aci.p.ho<-sum(mut7.aci.p.ho$Victories)
int8.aci.p.ho<-sum(mut8.aci.p.ho$Victories)
int9.aci.p.ho<-sum(mut9.aci.p.ho$Victories)
int10.aci.p.ho<-sum(mut10.aci.p.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aci.p.ho<-sum(a1.ci.p.ho$Victories)
av2.aci.p.ho<-sum(a2.ci.p.ho$Victories)
av3.aci.p.ho<-sum(a3.ci.p.ho$Victories)
av4.aci.p.ho<-sum(a4.ci.p.ho$Victories)
av5.aci.p.ho<-sum(a5.ci.p.ho$Victories)
av6.aci.p.ho<-sum(a6.ci.p.ho$Victories)
av7.aci.p.ho<-sum(a7.ci.p.ho$Victories)
av8.aci.p.ho<-sum(a8.ci.p.ho$Victories)
av9.aci.p.ho<-sum(a9.ci.p.ho$Victories)
av10.aci.p.ho<-sum(a10.ci.p.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.aci.p<-(sum(av1.aci.p.ho, av2.aci.p.ho, av3.aci.p.ho, av4.aci.p.ho, av5.aci.p.ho, av6.aci.p.ho, av7.aci.p.ho, av8.aci.p.ho, av9.aci.p.ho, av10.aci.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.aci.p<-(sum(int1.aci.p.ho, int2.aci.p.ho, int3.aci.p.ho, int4.aci.p.ho, int5.aci.p.ho, int6.aci.p.ho, int7.aci.p.ho, int8.aci.p.ho, int9.aci.p.ho, int10.aci.p.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aci.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aci.p.ho<-e1.aci.p.ho[order(e1.aci.p.ho$ID),]
e1.aci.p.ho<-as.matrix(t(e1.1.aci.p.ho))

e2.aci.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aci.p.ho<-e2.aci.p.ho[order(e2.aci.p.ho$ID),]
e2.aci.p.ho<-as.matrix(t(e2.1.aci.p.ho))

e3.aci.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aci.p.ho<-e3.aci.p.ho[order(e3.aci.p.ho$ID),]
e3.aci.p.ho<-as.matrix(t(e3.1.aci.p.ho))

e4.aci.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aci.p.ho<-e4.aci.p.ho[order(e4.aci.p.ho$ID),]
e4.aci.p.ho<-as.matrix(t(e4.1.aci.p.ho))

e5.aci.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aci.p.ho<-e5.aci.p.ho[order(e5.aci.p.ho$ID),]
e5.aci.p.ho<-as.matrix(t(e5.1.aci.p.ho))

e6.aci.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aci.p.ho<-e6.aci.p.ho[order(e6.aci.p.ho$ID),]
e6.aci.p.ho<-as.matrix(t(e6.1.aci.p.ho))

e7.aci.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aci.p.ho<-e7.aci.p.ho[order(e7.aci.p.ho$ID),]
e7.aci.p.ho<-as.matrix(t(e7.1.aci.p.ho))

e8.aci.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aci.p.ho<-e8.aci.p.ho[order(e8.aci.p.ho$ID),]
e8.aci.p.ho<-as.matrix(t(e8.1.aci.p.ho))

e9.aci.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aci.p.ho<-e9.aci.p.ho[order(e9.aci.p.ho$ID),]
e9.aci.p.ho<-as.matrix(t(e9.1.aci.p.ho))

e10.aci.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aci.p.ho<-e10.aci.p.ho[order(e10.aci.p.ho$ID),]
e10.aci.p.ho<-as.matrix(t(e10.1.aci.p.ho))

energy.ho.aci.p.ho<-as.data.frame(matrix(c(e1.aci.p.ho,e2.aci.p.ho,e3.aci.p.ho,e4.aci.p.ho,e5.aci.p.ho,e6.aci.p.ho,e7.aci.p.ho,e8.aci.p.ho,e9.aci.p.ho,e10.aci.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.aci.p.ho<-data.frame(ID=energy.ho.aci.p.ho$V1,energy_over_distance=energy.ho.aci.p.ho$V2,energy_over_time=energy.ho.aci.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aci.p.ho<-david1.aci.p.ho[order(david1.aci.p.ho$ID),]
david1.aci.p.ho<-as.matrix(t(david1.1.aci.p.ho))

david2.1.aci.p.ho<-david2.aci.p.ho[order(david2.aci.p.ho$ID),]
david2.aci.p.ho<-as.matrix(t(david2.1.aci.p.ho))

david3.1.aci.p.ho<-david3.aci.p.ho[order(david3.aci.p.ho$ID),]
david3.aci.p.ho<-as.matrix(t(david3.1.aci.p.ho))

david4.1.aci.p.ho<-david4.aci.p.ho[order(david4.aci.p.ho$ID),]
david4.aci.p.ho<-as.matrix(t(david4.1.aci.p.ho))

david5.1.aci.p.ho<-david5.aci.p.ho[order(david5.aci.p.ho$ID),]
david5.aci.p.ho<-as.matrix(t(david5.1.aci.p.ho))

david6.1.aci.p.ho<-david6.aci.p.ho[order(david6.aci.p.ho$ID),]
david6.aci.p.ho<-as.matrix(t(david6.1.aci.p.ho))

david7.1.aci.p.ho<-david7.aci.p.ho[order(david7.aci.p.ho$ID),]
david7.aci.p.ho<-as.matrix(t(david7.1.aci.p.ho))

david8.1.aci.p.ho<-david8.aci.p.ho[order(david8.aci.p.ho$ID),]
david8.aci.p.ho<-as.matrix(t(david8.1.aci.p.ho))

david9.1.aci.p.ho<-david9.aci.p.ho[order(david9.aci.p.ho$ID),]
david9.aci.p.ho<-as.matrix(t(david9.1.aci.p.ho))

david10.1.aci.p.ho<-david10.aci.p.ho[order(david10.aci.p.ho$ID),]
david10.aci.p.ho<-as.matrix(t(david10.1.aci.p.ho))

david.ho.aci.p.ho<-as.data.frame(matrix(c(david1.aci.p.ho,david2.aci.p.ho,david3.aci.p.ho,david4.aci.p.ho,david5.aci.p.ho,david6.aci.p.ho,david7.aci.p.ho,david8.aci.p.ho,david9.aci.p.ho,david10.aci.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.aci.p.ho<-data.frame(ID=david.ho.aci.p.ho$V1,DS=david.ho.aci.p.ho$V2,normDS=david.ho.aci.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.aci.p.ho<-lm(e1.1.aci.p.ho$energy_over_time~as.numeric(david1.1.aci.p.ho$normDS))
ho.lm.1.s.aci.p.ho<-summary(lm.ho.1.aci.p.ho)$coefficients
ho.1.slope.aci.p.ho<-ho.lm.1.s.aci.p.ho[2,1]
lm.ho.2.aci.p.ho<-lm(e2.1.aci.p.ho$energy_over_time~as.numeric(david2.1.aci.p.ho$normDS))
ho.lm.2.s.aci.p.ho<-summary(lm.ho.2.aci.p.ho)$coefficients
ho.2.slope.aci.p.ho<-ho.lm.2.s.aci.p.ho[2,1]
lm.ho.3.aci.p.ho<-lm(e3.1.aci.p.ho$energy_over_time~as.numeric(david3.1.aci.p.ho$normDS))
ho.lm.3.s.aci.p.ho<-summary(lm.ho.3.aci.p.ho)$coefficients
ho.3.slope.aci.p.ho<-ho.lm.3.s.aci.p.ho[2,1]
lm.ho.4.aci.p.ho<-lm(e4.1.aci.p.ho$energy_over_time~as.numeric(david4.1.aci.p.ho$normDS))
ho.lm.4.s.aci.p.ho<-summary(lm.ho.4.aci.p.ho)$coefficients
ho.4.slope.aci.p.ho<-ho.lm.4.s.aci.p.ho[2,1]
lm.ho.5.aci.p.ho<-lm(e5.1.aci.p.ho$energy_over_time~as.numeric(david5.1.aci.p.ho$normDS))
ho.lm.5.s.aci.p.ho<-summary(lm.ho.5.aci.p.ho)$coefficients
ho.5.slope.aci.p.ho<-ho.lm.5.s.aci.p.ho[2,1]
lm.ho.6.aci.p.ho<-lm(e6.1.aci.p.ho$energy_over_time~as.numeric(david6.1.aci.p.ho$normDS))
ho.lm.6.s.aci.p.ho<-summary(lm.ho.6.aci.p.ho)$coefficients
ho.6.slope.aci.p.ho<-ho.lm.6.s.aci.p.ho[2,1]
lm.ho.7.aci.p.ho<-lm(e7.1.aci.p.ho$energy_over_time~as.numeric(david7.1.aci.p.ho$normDS))
ho.lm.7.s.aci.p.ho<-summary(lm.ho.7.aci.p.ho)$coefficients
ho.7.slope.aci.p.ho<-ho.lm.7.s.aci.p.ho[2,1]
lm.ho.8.aci.p.ho<-lm(e8.1.aci.p.ho$energy_over_time~as.numeric(david8.1.aci.p.ho$normDS))
ho.lm.8.s.aci.p.ho<-summary(lm.ho.8.aci.p.ho)$coefficients
ho.8.slope.aci.p.ho<-ho.lm.8.s.aci.p.ho[2,1]
lm.ho.9.aci.p.ho<-lm(e9.1.aci.p.ho$energy_over_time~as.numeric(david9.1.aci.p.ho$normDS))
ho.lm.9.s.aci.p.ho<-summary(lm.ho.9.aci.p.ho)$coefficients
ho.9.slope.aci.p.ho<-ho.lm.9.s.aci.p.ho[2,1]
lm.ho.10.aci.p.ho<-lm(e10.1.aci.p.ho$energy_over_time~as.numeric(david10.1.aci.p.ho$normDS))
ho.lm.10.s.aci.p.ho<-summary(lm.ho.10.aci.p.ho)$coefficients
ho.10.slope.aci.p.ho<-ho.lm.10.s.aci.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.aci.p.ss.avoid.ci.p.ho<-data.frame(triangle.transitivity=c(tri1.aci.p.ho,tri2.aci.p.ho,tri3.aci.p.ho,tri4.aci.p.ho,tri5.aci.p.ho,tri6.aci.p.ho,tri7.aci.p.ho,tri8.aci.p.ho,tri9.aci.p.ho,tri10.aci.p.ho),escalation=c(ep1.aci.p.ho,ep2.aci.p.ho,ep3.aci.p.ho,ep4.aci.p.ho,ep5.aci.p.ho,ep6.aci.p.ho,ep7.aci.p.ho,ep8.aci.p.ho,ep9.aci.p.ho,ep10.aci.p.ho),dci=c(dci1.aci.p.ho,dci2.aci.p.ho,dci3.aci.p.ho,dci4.aci.p.ho,dci5.aci.p.ho,dci6.aci.p.ho,dci7.aci.p.ho,dci8.aci.p.ho,dci9.aci.p.ho,dci10.aci.p.ho),steepness=c(s1.aci.p.ho,s2.aci.p.ho,s3.aci.p.ho,s4.aci.p.ho,s5.aci.p.ho,s6.aci.p.ho,s7.aci.p.ho,s8.aci.p.ho,s9.aci.p.ho,s10.aci.p.ho),slope=c(ho.1.slope.aci.p.ho,ho.2.slope.aci.p.ho,ho.3.slope.aci.p.ho,ho.4.slope.aci.p.ho,ho.5.slope.aci.p.ho,ho.6.slope.aci.p.ho,ho.7.slope.aci.p.ho,ho.8.slope.aci.p.ho,ho.9.slope.aci.p.ho,ho.10.slope.aci.p.ho))
```
```{r Avoids Clumped Initiator Wins Probabilistic Data Frame}
#knowledge mutual
km.tt.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$triangle.transitivity)
km.aci.pi.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$dci)
km.esc.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$escalation)
km.steep.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$steepness)
km.slope.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$slope)
km.mean.aci.p.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aci.p.avoid,dci=km.aci.pi.aci.p.avoid,esc=km.esc.aci.p.avoid,steepness=km.steep.aci.p.avoid,slope=km.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$triangle.transitivity)
ks.aci.pi.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$dci)
ks.esc.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$escalation)
ks.steep.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$steepness)
ks.slope.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$slope)
ks.mean.aci.p.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.aci.p.avoid,dci=ks.aci.pi.aci.p.avoid,esc=ks.esc.aci.p.avoid,steepness=ks.steep.aci.p.avoid,slope=ks.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$triangle.transitivity)
ko.aci.pi.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$dci)
ko.esc.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$escalation)
ko.steep.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$steepness)
ko.slope.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$slope)
ko.mean.aci.p.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.aci.p.avoid,dci=ko.aci.pi.aci.p.avoid,esc=ko.esc.aci.p.avoid,steepness=ko.steep.aci.p.avoid,slope=ko.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$triangle.transitivity)
hm.aci.pi.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$dci)
hm.esc.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$escalation)
hm.steep.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$steepness)
hm.slope.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$slope)
hm.mean.aci.p.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aci.p.avoid,dci=hm.aci.pi.aci.p.avoid,esc=hm.esc.aci.p.avoid,steepness=hm.steep.aci.p.avoid,slope=hm.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$triangle.transitivity)
hs.aci.pi.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$dci)
hs.esc.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$escalation)
hs.steep.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$steepness)
hs.slope.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$slope)
hs.mean.aci.p.avoid<-data.frame(scenario="History self",tt=hs.tt.aci.p.avoid,dci=hs.aci.pi.aci.p.avoid,esc=hs.esc.aci.p.avoid,steepness=hs.steep.aci.p.avoid,slope=hs.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$triangle.transitivity)
ho.aci.pi.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$dci)
ho.esc.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$escalation)
ho.steep.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$steepness)
ho.slope.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$slope)
ho.mean.aci.p.avoid<-data.frame(scenario="History opponent",tt=ho.tt.aci.p.avoid,dci=ho.aci.pi.aci.p.avoid,esc=ho.esc.aci.p.avoid,steepness=ho.steep.aci.p.avoid,slope=ho.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.aci.p.avoid,ks.mean.aci.p.avoid,ko.mean.aci.p.avoid,hm.mean.aci.p.avoid,hs.mean.aci.p.avoid,ho.mean.aci.p.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$triangle.transitivity)
km.aci.pi.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$dci)
km.esc.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$escalation)
km.steep.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$steepness)
km.slope.aci.p.avoid<-mean(km.aci.p.ss.avoid.ci.p.km$slope)
km.mean.aci.p.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aci.p.avoid,dci=km.aci.pi.aci.p.avoid,esc=km.esc.aci.p.avoid,steepness=km.steep.aci.p.avoid,slope=km.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$triangle.transitivity)
ks.aci.pi.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$dci)
ks.esc.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$escalation)
ks.steep.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$steepness)
ks.slope.aci.p.avoid<-mean(ks.aci.p.ss.avoid.ci.p.ks$slope)
ks.mean.aci.p.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.aci.p.avoid,dci=ks.aci.pi.aci.p.avoid,esc=ks.esc.aci.p.avoid,steepness=ks.steep.aci.p.avoid,slope=ks.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$triangle.transitivity)
ko.aci.pi.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$dci)
ko.esc.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$escalation)
ko.steep.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$steepness)
ko.slope.aci.p.avoid<-mean(ko.aci.p.ss.avoid.ci.p.ko$slope)
ko.mean.aci.p.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.aci.p.avoid,dci=ko.aci.pi.aci.p.avoid,esc=ko.esc.aci.p.avoid,steepness=ko.steep.aci.p.avoid,slope=ko.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$triangle.transitivity)
hm.aci.pi.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$dci)
hm.esc.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$escalation)
hm.steep.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$steepness)
hm.slope.aci.p.avoid<-mean(hm.aci.p.ss.avoid.ci.p.hm$slope)
hm.mean.aci.p.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aci.p.avoid,dci=hm.aci.pi.aci.p.avoid,esc=hm.esc.aci.p.avoid,steepness=hm.steep.aci.p.avoid,slope=hm.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$triangle.transitivity)
hs.aci.pi.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$dci)
hs.esc.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$escalation)
hs.steep.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$steepness)
hs.slope.aci.p.avoid<-mean(hs.aci.p.ss.avoid.ci.p.hs$slope)
hs.mean.aci.p.avoid<-data.frame(scenario="History self",tt=hs.tt.aci.p.avoid,dci=hs.aci.pi.aci.p.avoid,esc=hs.esc.aci.p.avoid,steepness=hs.steep.aci.p.avoid,slope=hs.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$triangle.transitivity)
ho.aci.pi.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$dci)
ho.esc.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$escalation)
ho.steep.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$steepness)
ho.slope.aci.p.avoid<-mean(ho.aci.p.ss.avoid.ci.p.ho$slope)
ho.mean.aci.p.avoid<-data.frame(scenario="History opponent",tt=ho.tt.aci.p.avoid,dci=ho.aci.pi.aci.p.avoid,esc=ho.esc.aci.p.avoid,steepness=ho.steep.aci.p.avoid,slope=ho.slope.aci.p.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.aci.p.avoid,ks.mean.aci.p.avoid,ko.mean.aci.p.avoid,hm.mean.aci.p.avoid,hs.mean.aci.p.avoid,ho.mean.aci.p.avoid)

#create overall dataframe of summary statistics
overall.clumped.avoid.initiator<-data.frame(km.aci.p.ss.avoid.ci.p.km)
overall.clumped.avoid.initiator<-rbind(overall.clumped.avoid.initiator,ks.aci.p.ss.avoid.ci.p.ks)
overall.clumped.avoid.initiator<-rbind(overall.clumped.avoid.initiator,ko.aci.p.ss.avoid.ci.p.ko)
overall.clumped.avoid.initiator<-rbind(overall.clumped.avoid.initiator,hm.aci.p.ss.avoid.ci.p.hm)
overall.clumped.avoid.initiator<-rbind(overall.clumped.avoid.initiator,hs.aci.p.ss.avoid.ci.p.hs)
overall.clumped.avoid.initiator<-rbind(overall.clumped.avoid.initiator,ho.aci.p.ss.avoid.ci.p.ho)

overall.clumped.avoid.initiator<-cbind(overall.clumped.avoid.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.clumped.avoid.initiator<-cbind(overall.clumped.avoid.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ss.avoid.ci.p<-overall.clumped.avoid.initiator[overall.clumped.avoid.initiator$variable=="rhp",]
history.ss.avoid.ci.p<-overall.clumped.avoid.initiator[overall.clumped.avoid.initiator$variable=="history",]

overall.clumped.avoid.initiator$combo<-paste(overall.clumped.avoid.initiator$strategy,overall.clumped.avoid.initiator$variable,overall.clumped.avoid.initiator$distribution)
overall.clumped.avoid.initiator$combo2<-paste(overall.clumped.avoid.initiator$strategy,overall.clumped.avoid.initiator$variable)
```

## Attacks Clumped Initiator Wins Probabilistic Data
```{r Attacks Clumped Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Clumped or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.km<-sapply(files, read.csv)

# Generate attacks.atci.p.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.km<-data.frame(X1=attacks.atci.p.km[[1]],X2=attacks.atci.p.km[[2]],Victories=attacks.atci.p.km[[3]])
mat1.atci.p.km<-inter.mat(mut1.atci.p.km)
tri1.atci.p.km<-tr.tri(mat1.atci.p.km)
dci1.atci.p.km<-DCindex(mat1.atci.p.km)
mat1.atci.p.km[is.na(mat1.atci.p.km)] = 0
h1.atci.p.km<-h.index(mat1.atci.p.km)

ep1.atci.p.km<-ep(mut1.atci.p.km,a1.ci.p.km)
david1.atci.p.km<-DS(mat1.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.km<-cbind(ordrank.1.atci.p.km,ds=david1.atci.p.km$normDS)
lm1.atci.p.km<-summary(lm(ordrank.1.atci.p.km$ds~ordrank.1.atci.p.km$ord.rank))
s1.atci.p.km<-lm1.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.km<-data.frame(X1=attacks.atci.p.km[[4]],X2=attacks.atci.p.km[[5]],Victories=attacks.atci.p.km[[6]])
mat2.atci.p.km<-inter.mat(mut2.atci.p.km)
tri2.atci.p.km<-tr.tri(mat2.atci.p.km)
dci2.atci.p.km<-DCindex(mat2.atci.p.km)
mat2.atci.p.km[is.na(mat2.atci.p.km)] = 0
h2.atci.p.km<-h.index(mat2.atci.p.km)

ep2.atci.p.km<-ep(mut2.atci.p.km,a2.ci.p.km)
david2.atci.p.km<-DS(mat2.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.km<-cbind(ordrank.2.atci.p.km,ds=david2.atci.p.km$normDS)
lm2.atci.p.km<-summary(lm(ordrank.2.atci.p.km$ds~ordrank.2.atci.p.km$ord.rank))
s2.atci.p.km<-lm2.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.km<-data.frame(X1=attacks.atci.p.km[[7]],X2=attacks.atci.p.km[[8]],Victories=attacks.atci.p.km[[9]])
mat3.atci.p.km<-inter.mat(mut3.atci.p.km)
tri3.atci.p.km<-tr.tri(mat3.atci.p.km)
dci3.atci.p.km<-DCindex(mat3.atci.p.km)
mat3.atci.p.km[is.na(mat3.atci.p.km)] = 0
h3.atci.p.km<-h.index(mat3.atci.p.km)

ep3.atci.p.km<-ep(mut3.atci.p.km,a3.ci.p.km)
david3.atci.p.km<-DS(mat3.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.km<-cbind(ordrank.3.atci.p.km,ds=david3.atci.p.km$normDS)
lm3.atci.p.km<-summary(lm(ordrank.3.atci.p.km$ds~ordrank.3.atci.p.km$ord.rank))
s3.atci.p.km<-lm3.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.km<-data.frame(X1=attacks.atci.p.km[[10]],X2=attacks.atci.p.km[[11]],Victories=attacks.atci.p.km[[12]])
mat4.atci.p.km<-inter.mat(mut4.atci.p.km)
tri4.atci.p.km<-tr.tri(mat4.atci.p.km)
dci4.atci.p.km<-DCindex(mat4.atci.p.km)
mat4.atci.p.km[is.na(mat4.atci.p.km)] = 0
h4.atci.p.km<-h.index(mat4.atci.p.km)

ep4.atci.p.km<-ep(mut4.atci.p.km,a4.ci.p.km)
david4.atci.p.km<-DS(mat4.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.km<-cbind(ordrank.4.atci.p.km,ds=david4.atci.p.km$normDS)
lm4.atci.p.km<-summary(lm(ordrank.4.atci.p.km$ds~ordrank.4.atci.p.km$ord.rank))
s4.atci.p.km<-lm4.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.km<-data.frame(X1=attacks.atci.p.km[[13]],X2=attacks.atci.p.km[[14]],Victories=attacks.atci.p.km[[15]])
mat5.atci.p.km<-inter.mat(mut5.atci.p.km)
tri5.atci.p.km<-tr.tri(mat5.atci.p.km)
dci5.atci.p.km<-DCindex(mat5.atci.p.km)
mat5.atci.p.km[is.na(mat5.atci.p.km)] = 0
h5.atci.p.km<-h.index(mat5.atci.p.km)

ep5.atci.p.km<-ep(mut5.atci.p.km,a5.ci.p.km)
david5.atci.p.km<-DS(mat5.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.km<-cbind(ordrank.5.atci.p.km,ds=david5.atci.p.km$normDS)
lm5.atci.p.km<-summary(lm(ordrank.5.atci.p.km$ds~ordrank.5.atci.p.km$ord.rank))
s5.atci.p.km<-lm5.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.km<-data.frame(X1=attacks.atci.p.km[[16]],X2=attacks.atci.p.km[[17]],Victories=attacks.atci.p.km[[18]])
mat6.atci.p.km<-inter.mat(mut6.atci.p.km)
tri6.atci.p.km<-tr.tri(mat6.atci.p.km)
dci6.atci.p.km<-DCindex(mat6.atci.p.km)
mat6.atci.p.km[is.na(mat6.atci.p.km)] = 0
h6.atci.p.km<-h.index(mat6.atci.p.km)

ep6.atci.p.km<-ep(mut6.atci.p.km,a6.ci.p.km)
david6.atci.p.km<-DS(mat6.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.km<-cbind(ordrank.6.atci.p.km,ds=david6.atci.p.km$normDS)
lm6.atci.p.km<-summary(lm(ordrank.6.atci.p.km$ds~ordrank.6.atci.p.km$ord.rank))
s6.atci.p.km<-lm6.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.km<-data.frame(X1=attacks.atci.p.km[[19]],X2=attacks.atci.p.km[[20]],Victories=attacks.atci.p.km[[21]])
mat7.atci.p.km<-inter.mat(mut7.atci.p.km)
tri7.atci.p.km<-tr.tri(mat7.atci.p.km)
dci7.atci.p.km<-DCindex(mat7.atci.p.km)
mat7.atci.p.km[is.na(mat7.atci.p.km)] = 0
h7.atci.p.km<-h.index(mat7.atci.p.km)

ep7.atci.p.km<-ep(mut7.atci.p.km,a7.ci.p.km)
david7.atci.p.km<-DS(mat7.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.km<-cbind(ordrank.7.atci.p.km,ds=david7.atci.p.km$normDS)
lm7.atci.p.km<-summary(lm(ordrank.7.atci.p.km$ds~ordrank.7.atci.p.km$ord.rank))
s7.atci.p.km<-lm7.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.km<-data.frame(X1=attacks.atci.p.km[[22]],X2=attacks.atci.p.km[[23]],Victories=attacks.atci.p.km[[24]])
mat8.atci.p.km<-inter.mat(mut8.atci.p.km)
tri8.atci.p.km<-tr.tri(mat8.atci.p.km)
dci8.atci.p.km<-DCindex(mat8.atci.p.km)
mat8.atci.p.km[is.na(mat8.atci.p.km)] = 0
h8.atci.p.km<-h.index(mat8.atci.p.km)

ep8.atci.p.km<-ep(mut8.atci.p.km,a8.ci.p.km)
david8.atci.p.km<-DS(mat8.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.km<-cbind(ordrank.8.atci.p.km,ds=david8.atci.p.km$normDS)
lm8.atci.p.km<-summary(lm(ordrank.8.atci.p.km$ds~ordrank.8.atci.p.km$ord.rank))
s8.atci.p.km<-lm8.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.km<-data.frame(X1=attacks.atci.p.km[[25]],X2=attacks.atci.p.km[[26]],Victories=attacks.atci.p.km[[27]])
mat9.atci.p.km<-inter.mat(mut9.atci.p.km)
tri9.atci.p.km<-tr.tri(mat9.atci.p.km)
dci9.atci.p.km<-DCindex(mat9.atci.p.km)
mat9.atci.p.km[is.na(mat9.atci.p.km)] = 0
h9.atci.p.km<-h.index(mat9.atci.p.km)

ep9.atci.p.km<-ep(mut9.atci.p.km,a9.ci.p.km)
david9.atci.p.km<-DS(mat9.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.km<-cbind(ordrank.9.atci.p.km,ds=david9.atci.p.km$normDS)
lm9.atci.p.km<-summary(lm(ordrank.9.atci.p.km$ds~ordrank.9.atci.p.km$ord.rank))
s9.atci.p.km<-lm9.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.km<-data.frame(X1=attacks.atci.p.km[[28]],X2=attacks.atci.p.km[[29]],Victories=attacks.atci.p.km[[30]])
mat10.atci.p.km<-inter.mat(mut10.atci.p.km)
tri10.atci.p.km<-tr.tri(mat10.atci.p.km)
dci10.atci.p.km<-DCindex(mat10.atci.p.km)
mat10.atci.p.km[is.na(mat10.atci.p.km)] = 0
h10.atci.p.km<-h.index(mat10.atci.p.km)

ep10.atci.p.km<-ep(mut10.atci.p.km,a10.ci.p.km)
david10.atci.p.km<-DS(mat10.atci.p.km) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.km<-cbind(ordrank.10.atci.p.km,ds=david10.atci.p.km$normDS)
lm10.atci.p.km<-summary(lm(ordrank.10.atci.p.km$ds~ordrank.10.atci.p.km$ord.rank))
s10.atci.p.km<-lm10.atci.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.km<-sum(mut1.atci.p.km$Victories)
int2.atci.p.km<-sum(mut2.atci.p.km$Victories)
int3.atci.p.km<-sum(mut3.atci.p.km$Victories)
int4.atci.p.km<-sum(mut4.atci.p.km$Victories)
int5.atci.p.km<-sum(mut5.atci.p.km$Victories)
int6.atci.p.km<-sum(mut6.atci.p.km$Victories)
int7.atci.p.km<-sum(mut7.atci.p.km$Victories)
int8.atci.p.km<-sum(mut8.atci.p.km$Victories)
int9.atci.p.km<-sum(mut9.atci.p.km$Victories)
int10.atci.p.km<-sum(mut10.atci.p.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.km<-sum(a1.ci.p.km$Victories)
av2.ci.p.km<-sum(a2.ci.p.km$Victories)
av3.ci.p.km<-sum(a3.ci.p.km$Victories)
av4.ci.p.km<-sum(a4.ci.p.km$Victories)
av5.ci.p.km<-sum(a5.ci.p.km$Victories)
av6.ci.p.km<-sum(a6.ci.p.km$Victories)
av7.ci.p.km<-sum(a7.ci.p.km$Victories)
av8.ci.p.km<-sum(a8.ci.p.km$Victories)
av9.ci.p.km<-sum(a9.ci.p.km$Victories)
av10.ci.p.km<-sum(a10.ci.p.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.ic.p<-(sum(av1.ci.p.km, av2.ci.p.km, av3.ci.p.km, av4.ci.p.km, av5.ci.p.km, av6.ci.p.km, av7.ci.p.km, av8.ci.p.km, av9.ci.p.km, av10.ci.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.ic.p<-(sum(int1.atci.p.km, int2.atci.p.km, int3.atci.p.km, int4.atci.p.km, int5.atci.p.km, int6.atci.p.km, int7.atci.p.km, int8.atci.p.km, int9.atci.p.km, int10.atci.p.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.km<-e1.atci.p.km[order(e1.atci.p.km$ID),]
e1.atci.p.km<-as.matrix(t(e1.1.atci.p.km))

e2.atci.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.km<-e2.atci.p.km[order(e2.atci.p.km$ID),]
e2.atci.p.km<-as.matrix(t(e2.1.atci.p.km))

e3.atci.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.km<-e3.atci.p.km[order(e3.atci.p.km$ID),]
e3.atci.p.km<-as.matrix(t(e3.1.atci.p.km))

e4.atci.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.km<-e4.atci.p.km[order(e4.atci.p.km$ID),]
e4.atci.p.km<-as.matrix(t(e4.1.atci.p.km))

e5.atci.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.km<-e5.atci.p.km[order(e5.atci.p.km$ID),]
e5.atci.p.km<-as.matrix(t(e5.1.atci.p.km))

e6.atci.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.km<-e6.atci.p.km[order(e6.atci.p.km$ID),]
e6.atci.p.km<-as.matrix(t(e6.1.atci.p.km))

e7.atci.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.km<-e7.atci.p.km[order(e7.atci.p.km$ID),]
e7.atci.p.km<-as.matrix(t(e7.1.atci.p.km))

e8.atci.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.km<-e8.atci.p.km[order(e8.atci.p.km$ID),]
e8.atci.p.km<-as.matrix(t(e8.1.atci.p.km))

e9.atci.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.km<-e9.atci.p.km[order(e9.atci.p.km$ID),]
e9.atci.p.km<-as.matrix(t(e9.1.atci.p.km))

e10.atci.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.km<-e10.atci.p.km[order(e10.atci.p.km$ID),]
e10.atci.p.km<-as.matrix(t(e10.1.atci.p.km))

energy.km.atci.p.km<-as.data.frame(matrix(c(e1.atci.p.km,e2.atci.p.km,e3.atci.p.km,e4.atci.p.km,e5.atci.p.km,e6.atci.p.km,e7.atci.p.km,e8.atci.p.km,e9.atci.p.km,e10.atci.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atci.p.km<-data.frame(ID=energy.km.atci.p.km$V1,energy_over_distance=energy.km.atci.p.km$V2,energy_over_time=energy.km.atci.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.km<-david1.atci.p.km[order(david1.atci.p.km$ID),]
david1.atci.p.km<-as.matrix(t(david1.1.atci.p.km))

david2.1.atci.p.km<-david2.atci.p.km[order(david2.atci.p.km$ID),]
david2.atci.p.km<-as.matrix(t(david2.1.atci.p.km))

david3.1.atci.p.km<-david3.atci.p.km[order(david3.atci.p.km$ID),]
david3.atci.p.km<-as.matrix(t(david3.1.atci.p.km))

david4.1.atci.p.km<-david4.atci.p.km[order(david4.atci.p.km$ID),]
david4.atci.p.km<-as.matrix(t(david4.1.atci.p.km))

david5.1.atci.p.km<-david5.atci.p.km[order(david5.atci.p.km$ID),]
david5.atci.p.km<-as.matrix(t(david5.1.atci.p.km))

david6.1.atci.p.km<-david6.atci.p.km[order(david6.atci.p.km$ID),]
david6.atci.p.km<-as.matrix(t(david6.1.atci.p.km))

david7.1.atci.p.km<-david7.atci.p.km[order(david7.atci.p.km$ID),]
david7.atci.p.km<-as.matrix(t(david7.1.atci.p.km))

david8.1.atci.p.km<-david8.atci.p.km[order(david8.atci.p.km$ID),]
david8.atci.p.km<-as.matrix(t(david8.1.atci.p.km))

david9.1.atci.p.km<-david9.atci.p.km[order(david9.atci.p.km$ID),]
david9.atci.p.km<-as.matrix(t(david9.1.atci.p.km))

david10.1.atci.p.km<-david10.atci.p.km[order(david10.atci.p.km$ID),]
david10.atci.p.km<-as.matrix(t(david10.1.atci.p.km))

david.km.atci.p.km<-as.data.frame(matrix(c(david1.atci.p.km,david2.atci.p.km,david3.atci.p.km,david4.atci.p.km,david5.atci.p.km,david6.atci.p.km,david7.atci.p.km,david8.atci.p.km,david9.atci.p.km,david10.atci.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atci.p.km<-data.frame(ID=david.km.atci.p.km$V1,DS=david.km.atci.p.km$V2,normDS=david.km.atci.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atci.p.km<-lm(e1.1.atci.p.km$energy_over_time~as.numeric(david1.1.atci.p.km$normDS))
km.lm.1.s.atci.p.km<-summary(lm.km.1.atci.p.km)$coefficients
km.1.slope.atci.p.km<-km.lm.1.s.atci.p.km[2,1]
lm.km.2.atci.p.km<-lm(e2.1.atci.p.km$energy_over_time~as.numeric(david2.1.atci.p.km$normDS))
km.lm.2.s.atci.p.km<-summary(lm.km.2.atci.p.km)$coefficients
km.2.slope.atci.p.km<-km.lm.2.s.atci.p.km[2,1]
lm.km.3.atci.p.km<-lm(e3.1.atci.p.km$energy_over_time~as.numeric(david3.1.atci.p.km$normDS))
km.lm.3.s.atci.p.km<-summary(lm.km.3.atci.p.km)$coefficients
km.3.slope.atci.p.km<-km.lm.3.s.atci.p.km[2,1]
lm.km.4.atci.p.km<-lm(e4.1.atci.p.km$energy_over_time~as.numeric(david4.1.atci.p.km$normDS))
km.lm.4.s.atci.p.km<-summary(lm.km.4.atci.p.km)$coefficients
km.4.slope.atci.p.km<-km.lm.4.s.atci.p.km[2,1]
lm.km.5.atci.p.km<-lm(e5.1.atci.p.km$energy_over_time~as.numeric(david5.1.atci.p.km$normDS))
km.lm.5.s.atci.p.km<-summary(lm.km.5.atci.p.km)$coefficients
km.5.slope.atci.p.km<-km.lm.5.s.atci.p.km[2,1]
lm.km.6.atci.p.km<-lm(e6.1.atci.p.km$energy_over_time~as.numeric(david6.1.atci.p.km$normDS))
km.lm.6.s.atci.p.km<-summary(lm.km.6.atci.p.km)$coefficients
km.6.slope.atci.p.km<-km.lm.6.s.atci.p.km[2,1]
lm.km.7.atci.p.km<-lm(e7.1.atci.p.km$energy_over_time~as.numeric(david7.1.atci.p.km$normDS))
km.lm.7.s.atci.p.km<-summary(lm.km.7.atci.p.km)$coefficients
km.7.slope.atci.p.km<-km.lm.7.s.atci.p.km[2,1]
lm.km.8.atci.p.km<-lm(e8.1.atci.p.km$energy_over_time~as.numeric(david8.1.atci.p.km$normDS))
km.lm.8.s.atci.p.km<-summary(lm.km.8.atci.p.km)$coefficients
km.8.slope.atci.p.km<-km.lm.8.s.atci.p.km[2,1]
lm.km.9.atci.p.km<-lm(e9.1.atci.p.km$energy_over_time~as.numeric(david9.1.atci.p.km$normDS))
km.lm.9.s.atci.p.km<-summary(lm.km.9.atci.p.km)$coefficients
km.9.slope.atci.p.km<-km.lm.9.s.atci.p.km[2,1]
lm.km.10.atci.p.km<-lm(e10.1.atci.p.km$energy_over_time~as.numeric(david10.1.atci.p.km$normDS))
km.lm.10.s.atci.p.km<-summary(lm.km.10.atci.p.km)$coefficients
km.10.slope.atci.p.km<-km.lm.10.s.atci.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atci.p.ss.attacks.atci.p.km<-data.frame(triangle.transitivity=c(tri1.atci.p.km,tri2.atci.p.km,tri3.atci.p.km,tri4.atci.p.km,tri5.atci.p.km,tri6.atci.p.km,tri7.atci.p.km,tri8.atci.p.km,tri9.atci.p.km,tri10.atci.p.km),escalation=c(ep1.atci.p.km,ep2.atci.p.km,ep3.atci.p.km,ep4.atci.p.km,ep5.atci.p.km,ep6.atci.p.km,ep7.atci.p.km,ep8.atci.p.km,ep9.atci.p.km,ep10.atci.p.km),dci=c(dci1.atci.p.km,dci2.atci.p.km,dci3.atci.p.km,dci4.atci.p.km,dci5.atci.p.km,dci6.atci.p.km,dci7.atci.p.km,dci8.atci.p.km,dci9.atci.p.km,dci10.atci.p.km),steepness=c(s1.atci.p.km,s2.atci.p.km,s3.atci.p.km,s4.atci.p.km,s5.atci.p.km,s6.atci.p.km,s7.atci.p.km,s8.atci.p.km,s9.atci.p.km,s10.atci.p.km),slope=c(km.1.slope.atci.p.km,km.2.slope.atci.p.km,km.3.slope.atci.p.km,km.4.slope.atci.p.km,km.5.slope.atci.p.km,km.6.slope.atci.p.km,km.7.slope.atci.p.km,km.8.slope.atci.p.km,km.9.slope.atci.p.km,km.10.slope.atci.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.ks<-sapply(files, read.csv)

# Generate attacks.atci.p.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[1]],X2=attacks.atci.p.ks[[2]],Victories=attacks.atci.p.ks[[3]])
mat1.atci.p.ks<-inter.mat(mut1.atci.p.ks)
tri1.atci.p.ks<-tr.tri(mat1.atci.p.ks)
dci1.atci.p.ks<-DCindex(mat1.atci.p.ks)
mat1.atci.p.ks[is.na(mat1.atci.p.ks)] = 0
h1.atci.p.ks<-h.index(mat1.atci.p.ks)

ep1.atci.p.ks<-ep(mut1.atci.p.ks,a1.ci.p.ks)
david1.atci.p.ks<-DS(mat1.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.ks<-cbind(ordrank.1.atci.p.ks,ds=david1.atci.p.ks$normDS)
lm1.atci.p.ks<-summary(lm(ordrank.1.atci.p.ks$ds~ordrank.1.atci.p.ks$ord.rank))
s1.atci.p.ks<-lm1.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[4]],X2=attacks.atci.p.ks[[5]],Victories=attacks.atci.p.ks[[6]])
mat2.atci.p.ks<-inter.mat(mut2.atci.p.ks)
tri2.atci.p.ks<-tr.tri(mat2.atci.p.ks)
dci2.atci.p.ks<-DCindex(mat2.atci.p.ks)
mat2.atci.p.ks[is.na(mat2.atci.p.ks)] = 0
h2.atci.p.ks<-h.index(mat2.atci.p.ks)

ep2.atci.p.ks<-ep(mut2.atci.p.ks,a2.ci.p.ks)
david2.atci.p.ks<-DS(mat2.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.ks<-cbind(ordrank.2.atci.p.ks,ds=david2.atci.p.ks$normDS)
lm2.atci.p.ks<-summary(lm(ordrank.2.atci.p.ks$ds~ordrank.2.atci.p.ks$ord.rank))
s2.atci.p.ks<-lm2.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[7]],X2=attacks.atci.p.ks[[8]],Victories=attacks.atci.p.ks[[9]])
mat3.atci.p.ks<-inter.mat(mut3.atci.p.ks)
tri3.atci.p.ks<-tr.tri(mat3.atci.p.ks)
dci3.atci.p.ks<-DCindex(mat3.atci.p.ks)
mat3.atci.p.ks[is.na(mat3.atci.p.ks)] = 0
h3.atci.p.ks<-h.index(mat3.atci.p.ks)

ep3.atci.p.ks<-ep(mut3.atci.p.ks,a3.ci.p.ks)
david3.atci.p.ks<-DS(mat3.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.ks<-cbind(ordrank.3.atci.p.ks,ds=david3.atci.p.ks$normDS)
lm3.atci.p.ks<-summary(lm(ordrank.3.atci.p.ks$ds~ordrank.3.atci.p.ks$ord.rank))
s3.atci.p.ks<-lm3.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[10]],X2=attacks.atci.p.ks[[11]],Victories=attacks.atci.p.ks[[12]])
mat4.atci.p.ks<-inter.mat(mut4.atci.p.ks)
tri4.atci.p.ks<-tr.tri(mat4.atci.p.ks)
dci4.atci.p.ks<-DCindex(mat4.atci.p.ks)
mat4.atci.p.ks[is.na(mat4.atci.p.ks)] = 0
h4.atci.p.ks<-h.index(mat4.atci.p.ks)

ep4.atci.p.ks<-ep(mut4.atci.p.ks,a4.ci.p.ks)
david4.atci.p.ks<-DS(mat4.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.ks<-cbind(ordrank.4.atci.p.ks,ds=david4.atci.p.ks$normDS)
lm4.atci.p.ks<-summary(lm(ordrank.4.atci.p.ks$ds~ordrank.4.atci.p.ks$ord.rank))
s4.atci.p.ks<-lm4.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[13]],X2=attacks.atci.p.ks[[14]],Victories=attacks.atci.p.ks[[15]])
mat5.atci.p.ks<-inter.mat(mut5.atci.p.ks)
tri5.atci.p.ks<-tr.tri(mat5.atci.p.ks)
dci5.atci.p.ks<-DCindex(mat5.atci.p.ks)
mat5.atci.p.ks[is.na(mat5.atci.p.ks)] = 0
h5.atci.p.ks<-h.index(mat5.atci.p.ks)

ep5.atci.p.ks<-ep(mut5.atci.p.ks,a5.ci.p.ks)
david5.atci.p.ks<-DS(mat5.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.ks<-cbind(ordrank.5.atci.p.ks,ds=david5.atci.p.ks$normDS)
lm5.atci.p.ks<-summary(lm(ordrank.5.atci.p.ks$ds~ordrank.5.atci.p.ks$ord.rank))
s5.atci.p.ks<-lm5.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[16]],X2=attacks.atci.p.ks[[17]],Victories=attacks.atci.p.ks[[18]])
mat6.atci.p.ks<-inter.mat(mut6.atci.p.ks)
tri6.atci.p.ks<-tr.tri(mat6.atci.p.ks)
dci6.atci.p.ks<-DCindex(mat6.atci.p.ks)
mat6.atci.p.ks[is.na(mat6.atci.p.ks)] = 0
h6.atci.p.ks<-h.index(mat6.atci.p.ks)

ep6.atci.p.ks<-ep(mut6.atci.p.ks,a6.ci.p.ks)
david6.atci.p.ks<-DS(mat6.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.ks<-cbind(ordrank.6.atci.p.ks,ds=david6.atci.p.ks$normDS)
lm6.atci.p.ks<-summary(lm(ordrank.6.atci.p.ks$ds~ordrank.6.atci.p.ks$ord.rank))
s6.atci.p.ks<-lm6.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[19]],X2=attacks.atci.p.ks[[20]],Victories=attacks.atci.p.ks[[21]])
mat7.atci.p.ks<-inter.mat(mut7.atci.p.ks)
tri7.atci.p.ks<-tr.tri(mat7.atci.p.ks)
dci7.atci.p.ks<-DCindex(mat7.atci.p.ks)
mat7.atci.p.ks[is.na(mat7.atci.p.ks)] = 0
h7.atci.p.ks<-h.index(mat7.atci.p.ks)

ep7.atci.p.ks<-ep(mut7.atci.p.ks,a7.ci.p.ks)
david7.atci.p.ks<-DS(mat7.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.ks<-cbind(ordrank.7.atci.p.ks,ds=david7.atci.p.ks$normDS)
lm7.atci.p.ks<-summary(lm(ordrank.7.atci.p.ks$ds~ordrank.7.atci.p.ks$ord.rank))
s7.atci.p.ks<-lm7.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[22]],X2=attacks.atci.p.ks[[23]],Victories=attacks.atci.p.ks[[24]])
mat8.atci.p.ks<-inter.mat(mut8.atci.p.ks)
tri8.atci.p.ks<-tr.tri(mat8.atci.p.ks)
dci8.atci.p.ks<-DCindex(mat8.atci.p.ks)
mat8.atci.p.ks[is.na(mat8.atci.p.ks)] = 0
h8.atci.p.ks<-h.index(mat8.atci.p.ks)

ep8.atci.p.ks<-ep(mut8.atci.p.ks,a8.ci.p.ks)
david8.atci.p.ks<-DS(mat8.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.ks<-cbind(ordrank.8.atci.p.ks,ds=david8.atci.p.ks$normDS)
lm8.atci.p.ks<-summary(lm(ordrank.8.atci.p.ks$ds~ordrank.8.atci.p.ks$ord.rank))
s8.atci.p.ks<-lm8.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[25]],X2=attacks.atci.p.ks[[26]],Victories=attacks.atci.p.ks[[27]])
mat9.atci.p.ks<-inter.mat(mut9.atci.p.ks)
tri9.atci.p.ks<-tr.tri(mat9.atci.p.ks)
dci9.atci.p.ks<-DCindex(mat9.atci.p.ks)
mat9.atci.p.ks[is.na(mat9.atci.p.ks)] = 0
h9.atci.p.ks<-h.index(mat9.atci.p.ks)

ep9.atci.p.ks<-ep(mut9.atci.p.ks,a9.ci.p.ks)
david9.atci.p.ks<-DS(mat9.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.ks<-cbind(ordrank.9.atci.p.ks,ds=david9.atci.p.ks$normDS)
lm9.atci.p.ks<-summary(lm(ordrank.9.atci.p.ks$ds~ordrank.9.atci.p.ks$ord.rank))
s9.atci.p.ks<-lm9.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.ks<-data.frame(X1=attacks.atci.p.ks[[28]],X2=attacks.atci.p.ks[[29]],Victories=attacks.atci.p.ks[[30]])
mat10.atci.p.ks<-inter.mat(mut10.atci.p.ks)
tri10.atci.p.ks<-tr.tri(mat10.atci.p.ks)
dci10.atci.p.ks<-DCindex(mat10.atci.p.ks)
mat10.atci.p.ks[is.na(mat10.atci.p.ks)] = 0
h10.atci.p.ks<-h.index(mat10.atci.p.ks)

ep10.atci.p.ks<-ep(mut10.atci.p.ks,a10.ci.p.ks)
david10.atci.p.ks<-DS(mat10.atci.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.ks<-cbind(ordrank.10.atci.p.ks,ds=david10.atci.p.ks$normDS)
lm10.atci.p.ks<-summary(lm(ordrank.10.atci.p.ks$ds~ordrank.10.atci.p.ks$ord.rank))
s10.atci.p.ks<-lm10.atci.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.ks<-sum(mut1.atci.p.ks$Victories)
int2.atci.p.ks<-sum(mut2.atci.p.ks$Victories)
int3.atci.p.ks<-sum(mut3.atci.p.ks$Victories)
int4.atci.p.ks<-sum(mut4.atci.p.ks$Victories)
int5.atci.p.ks<-sum(mut5.atci.p.ks$Victories)
int6.atci.p.ks<-sum(mut6.atci.p.ks$Victories)
int7.atci.p.ks<-sum(mut7.atci.p.ks$Victories)
int8.atci.p.ks<-sum(mut8.atci.p.ks$Victories)
int9.atci.p.ks<-sum(mut9.atci.p.ks$Victories)
int10.atci.p.ks<-sum(mut10.atci.p.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ks<-sum(a1.ci.p.ks$Victories)
av2.ci.p.ks<-sum(a2.ci.p.ks$Victories)
av3.ci.p.ks<-sum(a3.ci.p.ks$Victories)
av4.ci.p.ks<-sum(a4.ci.p.ks$Victories)
av5.ci.p.ks<-sum(a5.ci.p.ks$Victories)
av6.ci.p.ks<-sum(a6.ci.p.ks$Victories)
av7.ci.p.ks<-sum(a7.ci.p.ks$Victories)
av8.ci.p.ks<-sum(a8.ci.p.ks$Victories)
av9.ci.p.ks<-sum(a9.ci.p.ks$Victories)
av10.ci.p.ks<-sum(a10.ci.p.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.ic.p<-(sum(av1.ci.p.ks, av2.ci.p.ks, av3.ci.p.ks, av4.ci.p.ks, av5.ci.p.ks, av6.ci.p.ks, av7.ci.p.ks, av8.ci.p.ks, av9.ci.p.ks, av10.ci.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.ic.p<-(sum(int1.atci.p.ks, int2.atci.p.ks, int3.atci.p.ks, int4.atci.p.ks, int5.atci.p.ks, int6.atci.p.ks, int7.atci.p.ks, int8.atci.p.ks, int9.atci.p.ks, int10.atci.p.ks))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.ks<-e1.atci.p.ks[order(e1.atci.p.ks$ID),]
e1.atci.p.ks<-as.matrix(t(e1.1.atci.p.ks))

e2.atci.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.ks<-e2.atci.p.ks[order(e2.atci.p.ks$ID),]
e2.atci.p.ks<-as.matrix(t(e2.1.atci.p.ks))

e3.atci.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.ks<-e3.atci.p.ks[order(e3.atci.p.ks$ID),]
e3.atci.p.ks<-as.matrix(t(e3.1.atci.p.ks))

e4.atci.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.ks<-e4.atci.p.ks[order(e4.atci.p.ks$ID),]
e4.atci.p.ks<-as.matrix(t(e4.1.atci.p.ks))

e5.atci.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.ks<-e5.atci.p.ks[order(e5.atci.p.ks$ID),]
e5.atci.p.ks<-as.matrix(t(e5.1.atci.p.ks))

e6.atci.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.ks<-e6.atci.p.ks[order(e6.atci.p.ks$ID),]
e6.atci.p.ks<-as.matrix(t(e6.1.atci.p.ks))

e7.atci.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.ks<-e7.atci.p.ks[order(e7.atci.p.ks$ID),]
e7.atci.p.ks<-as.matrix(t(e7.1.atci.p.ks))

e8.atci.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.ks<-e8.atci.p.ks[order(e8.atci.p.ks$ID),]
e8.atci.p.ks<-as.matrix(t(e8.1.atci.p.ks))

e9.atci.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.ks<-e9.atci.p.ks[order(e9.atci.p.ks$ID),]
e9.atci.p.ks<-as.matrix(t(e9.1.atci.p.ks))

e10.atci.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.ks<-e10.atci.p.ks[order(e10.atci.p.ks$ID),]
e10.atci.p.ks<-as.matrix(t(e10.1.atci.p.ks))

energy.ks.atci.p.ks<-as.data.frame(matrix(c(e1.atci.p.ks,e2.atci.p.ks,e3.atci.p.ks,e4.atci.p.ks,e5.atci.p.ks,e6.atci.p.ks,e7.atci.p.ks,e8.atci.p.ks,e9.atci.p.ks,e10.atci.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.atci.p.ks<-data.frame(ID=energy.ks.atci.p.ks$V1,energy_over_distance=energy.ks.atci.p.ks$V2,energy_over_time=energy.ks.atci.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.ks<-david1.atci.p.ks[order(david1.atci.p.ks$ID),]
david1.atci.p.ks<-as.matrix(t(david1.1.atci.p.ks))

david2.1.atci.p.ks<-david2.atci.p.ks[order(david2.atci.p.ks$ID),]
david2.atci.p.ks<-as.matrix(t(david2.1.atci.p.ks))

david3.1.atci.p.ks<-david3.atci.p.ks[order(david3.atci.p.ks$ID),]
david3.atci.p.ks<-as.matrix(t(david3.1.atci.p.ks))

david4.1.atci.p.ks<-david4.atci.p.ks[order(david4.atci.p.ks$ID),]
david4.atci.p.ks<-as.matrix(t(david4.1.atci.p.ks))

david5.1.atci.p.ks<-david5.atci.p.ks[order(david5.atci.p.ks$ID),]
david5.atci.p.ks<-as.matrix(t(david5.1.atci.p.ks))

david6.1.atci.p.ks<-david6.atci.p.ks[order(david6.atci.p.ks$ID),]
david6.atci.p.ks<-as.matrix(t(david6.1.atci.p.ks))

david7.1.atci.p.ks<-david7.atci.p.ks[order(david7.atci.p.ks$ID),]
david7.atci.p.ks<-as.matrix(t(david7.1.atci.p.ks))

david8.1.atci.p.ks<-david8.atci.p.ks[order(david8.atci.p.ks$ID),]
david8.atci.p.ks<-as.matrix(t(david8.1.atci.p.ks))

david9.1.atci.p.ks<-david9.atci.p.ks[order(david9.atci.p.ks$ID),]
david9.atci.p.ks<-as.matrix(t(david9.1.atci.p.ks))

david10.1.atci.p.ks<-david10.atci.p.ks[order(david10.atci.p.ks$ID),]
david10.atci.p.ks<-as.matrix(t(david10.1.atci.p.ks))

david.ks.atci.p.ks<-as.data.frame(matrix(c(david1.atci.p.ks,david2.atci.p.ks,david3.atci.p.ks,david4.atci.p.ks,david5.atci.p.ks,david6.atci.p.ks,david7.atci.p.ks,david8.atci.p.ks,david9.atci.p.ks,david10.atci.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.atci.p.ks<-data.frame(ID=david.ks.atci.p.ks$V1,DS=david.ks.atci.p.ks$V2,normDS=david.ks.atci.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.atci.p.ks<-lm(e1.1.atci.p.ks$energy_over_time~as.numeric(david1.1.atci.p.ks$normDS))
ks.lm.1.s.atci.p.ks<-summary(lm.ks.1.atci.p.ks)$coefficients
ks.1.slope.atci.p.ks<-ks.lm.1.s.atci.p.ks[2,1]
lm.ks.2.atci.p.ks<-lm(e2.1.atci.p.ks$energy_over_time~as.numeric(david2.1.atci.p.ks$normDS))
ks.lm.2.s.atci.p.ks<-summary(lm.ks.2.atci.p.ks)$coefficients
ks.2.slope.atci.p.ks<-ks.lm.2.s.atci.p.ks[2,1]
lm.ks.3.atci.p.ks<-lm(e3.1.atci.p.ks$energy_over_time~as.numeric(david3.1.atci.p.ks$normDS))
ks.lm.3.s.atci.p.ks<-summary(lm.ks.3.atci.p.ks)$coefficients
ks.3.slope.atci.p.ks<-ks.lm.3.s.atci.p.ks[2,1]
lm.ks.4.atci.p.ks<-lm(e4.1.atci.p.ks$energy_over_time~as.numeric(david4.1.atci.p.ks$normDS))
ks.lm.4.s.atci.p.ks<-summary(lm.ks.4.atci.p.ks)$coefficients
ks.4.slope.atci.p.ks<-ks.lm.4.s.atci.p.ks[2,1]
lm.ks.5.atci.p.ks<-lm(e5.1.atci.p.ks$energy_over_time~as.numeric(david5.1.atci.p.ks$normDS))
ks.lm.5.s.atci.p.ks<-summary(lm.ks.5.atci.p.ks)$coefficients
ks.5.slope.atci.p.ks<-ks.lm.5.s.atci.p.ks[2,1]
lm.ks.6.atci.p.ks<-lm(e6.1.atci.p.ks$energy_over_time~as.numeric(david6.1.atci.p.ks$normDS))
ks.lm.6.s.atci.p.ks<-summary(lm.ks.6.atci.p.ks)$coefficients
ks.6.slope.atci.p.ks<-ks.lm.6.s.atci.p.ks[2,1]
lm.ks.7.atci.p.ks<-lm(e7.1.atci.p.ks$energy_over_time~as.numeric(david7.1.atci.p.ks$normDS))
ks.lm.7.s.atci.p.ks<-summary(lm.ks.7.atci.p.ks)$coefficients
ks.7.slope.atci.p.ks<-ks.lm.7.s.atci.p.ks[2,1]
lm.ks.8.atci.p.ks<-lm(e8.1.atci.p.ks$energy_over_time~as.numeric(david8.1.atci.p.ks$normDS))
ks.lm.8.s.atci.p.ks<-summary(lm.ks.8.atci.p.ks)$coefficients
ks.8.slope.atci.p.ks<-ks.lm.8.s.atci.p.ks[2,1]
lm.ks.9.atci.p.ks<-lm(e9.1.atci.p.ks$energy_over_time~as.numeric(david9.1.atci.p.ks$normDS))
ks.lm.9.s.atci.p.ks<-summary(lm.ks.9.atci.p.ks)$coefficients
ks.9.slope.atci.p.ks<-ks.lm.9.s.atci.p.ks[2,1]
lm.ks.10.atci.p.ks<-lm(e10.1.atci.p.ks$energy_over_time~as.numeric(david10.1.atci.p.ks$normDS))
ks.lm.10.s.atci.p.ks<-summary(lm.ks.10.atci.p.ks)$coefficients
ks.10.slope.atci.p.ks<-ks.lm.10.s.atci.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.atci.p.ss.attacks.atci.p.ks<-data.frame(triangle.transitivity=c(tri1.atci.p.ks,tri2.atci.p.ks,tri3.atci.p.ks,tri4.atci.p.ks,tri5.atci.p.ks,tri6.atci.p.ks,tri7.atci.p.ks,tri8.atci.p.ks,tri9.atci.p.ks,tri10.atci.p.ks),escalation=c(ep1.atci.p.ks,ep2.atci.p.ks,ep3.atci.p.ks,ep4.atci.p.ks,ep5.atci.p.ks,ep6.atci.p.ks,ep7.atci.p.ks,ep8.atci.p.ks,ep9.atci.p.ks,ep10.atci.p.ks),dci=c(dci1.atci.p.ks,dci2.atci.p.ks,dci3.atci.p.ks,dci4.atci.p.ks,dci5.atci.p.ks,dci6.atci.p.ks,dci7.atci.p.ks,dci8.atci.p.ks,dci9.atci.p.ks,dci10.atci.p.ks),steepness=c(s1.atci.p.ks,s2.atci.p.ks,s3.atci.p.ks,s4.atci.p.ks,s5.atci.p.ks,s6.atci.p.ks,s7.atci.p.ks,s8.atci.p.ks,s9.atci.p.ks,s10.atci.p.ks),slope=c(ks.1.slope.atci.p.ks,ks.2.slope.atci.p.ks,ks.3.slope.atci.p.ks,ks.4.slope.atci.p.ks,ks.5.slope.atci.p.ks,ks.6.slope.atci.p.ks,ks.7.slope.atci.p.ks,ks.8.slope.atci.p.ks,ks.9.slope.atci.p.ks,ks.10.slope.atci.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#Knowledge Opponent Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.ko<-sapply(files, read.csv)

# Generate attacks.atci.p.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[1]],X2=attacks.atci.p.ko[[2]],Victories=attacks.atci.p.ko[[3]])
mat1.atci.p.ko<-inter.mat(mut1.atci.p.ko)
tri1.atci.p.ko<-tr.tri(mat1.atci.p.ko)
dci1.atci.p.ko<-DCindex(mat1.atci.p.ko)
mat1.atci.p.ko[is.na(mat1.atci.p.ko)] = 0
h1.atci.p.ko<-h.index(mat1.atci.p.ko)

ep1.atci.p.ko<-ep(mut1.atci.p.ko,a1.ci.p.ko)
david1.atci.p.ko<-DS(mat1.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.ko<-cbind(ordrank.1.atci.p.ko,ds=david1.atci.p.ko$normDS)
lm1.atci.p.ko<-summary(lm(ordrank.1.atci.p.ko$ds~ordrank.1.atci.p.ko$ord.rank))
s1.atci.p.ko<-lm1.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[4]],X2=attacks.atci.p.ko[[5]],Victories=attacks.atci.p.ko[[6]])
mat2.atci.p.ko<-inter.mat(mut2.atci.p.ko)
tri2.atci.p.ko<-tr.tri(mat2.atci.p.ko)
dci2.atci.p.ko<-DCindex(mat2.atci.p.ko)
mat2.atci.p.ko[is.na(mat2.atci.p.ko)] = 0
h2.atci.p.ko<-h.index(mat2.atci.p.ko)

ep2.atci.p.ko<-ep(mut2.atci.p.ko,a2.ci.p.ko)
david2.atci.p.ko<-DS(mat2.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.ko<-cbind(ordrank.2.atci.p.ko,ds=david2.atci.p.ko$normDS)
lm2.atci.p.ko<-summary(lm(ordrank.2.atci.p.ko$ds~ordrank.2.atci.p.ko$ord.rank))
s2.atci.p.ko<-lm2.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[7]],X2=attacks.atci.p.ko[[8]],Victories=attacks.atci.p.ko[[9]])
mat3.atci.p.ko<-inter.mat(mut3.atci.p.ko)
tri3.atci.p.ko<-tr.tri(mat3.atci.p.ko)
dci3.atci.p.ko<-DCindex(mat3.atci.p.ko)
mat3.atci.p.ko[is.na(mat3.atci.p.ko)] = 0
h3.atci.p.ko<-h.index(mat3.atci.p.ko)

ep3.atci.p.ko<-ep(mut3.atci.p.ko,a3.ci.p.ko)
david3.atci.p.ko<-DS(mat3.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.ko<-cbind(ordrank.3.atci.p.ko,ds=david3.atci.p.ko$normDS)
lm3.atci.p.ko<-summary(lm(ordrank.3.atci.p.ko$ds~ordrank.3.atci.p.ko$ord.rank))
s3.atci.p.ko<-lm3.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[10]],X2=attacks.atci.p.ko[[11]],Victories=attacks.atci.p.ko[[12]])
mat4.atci.p.ko<-inter.mat(mut4.atci.p.ko)
tri4.atci.p.ko<-tr.tri(mat4.atci.p.ko)
dci4.atci.p.ko<-DCindex(mat4.atci.p.ko)
mat4.atci.p.ko[is.na(mat4.atci.p.ko)] = 0
h4.atci.p.ko<-h.index(mat4.atci.p.ko)

ep4.atci.p.ko<-ep(mut4.atci.p.ko,a4.ci.p.ko)
david4.atci.p.ko<-DS(mat4.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.ko<-cbind(ordrank.4.atci.p.ko,ds=david4.atci.p.ko$normDS)
lm4.atci.p.ko<-summary(lm(ordrank.4.atci.p.ko$ds~ordrank.4.atci.p.ko$ord.rank))
s4.atci.p.ko<-lm4.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[13]],X2=attacks.atci.p.ko[[14]],Victories=attacks.atci.p.ko[[15]])
mat5.atci.p.ko<-inter.mat(mut5.atci.p.ko)
tri5.atci.p.ko<-tr.tri(mat5.atci.p.ko)
dci5.atci.p.ko<-DCindex(mat5.atci.p.ko)
mat5.atci.p.ko[is.na(mat5.atci.p.ko)] = 0
h5.atci.p.ko<-h.index(mat5.atci.p.ko)

ep5.atci.p.ko<-ep(mut5.atci.p.ko,a5.ci.p.ko)
david5.atci.p.ko<-DS(mat5.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.ko<-cbind(ordrank.5.atci.p.ko,ds=david5.atci.p.ko$normDS)
lm5.atci.p.ko<-summary(lm(ordrank.5.atci.p.ko$ds~ordrank.5.atci.p.ko$ord.rank))
s5.atci.p.ko<-lm5.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[16]],X2=attacks.atci.p.ko[[17]],Victories=attacks.atci.p.ko[[18]])
mat6.atci.p.ko<-inter.mat(mut6.atci.p.ko)
tri6.atci.p.ko<-tr.tri(mat6.atci.p.ko)
dci6.atci.p.ko<-DCindex(mat6.atci.p.ko)
mat6.atci.p.ko[is.na(mat6.atci.p.ko)] = 0
h6.atci.p.ko<-h.index(mat6.atci.p.ko)

ep6.atci.p.ko<-ep(mut6.atci.p.ko,a6.ci.p.ko)
david6.atci.p.ko<-DS(mat6.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.ko<-cbind(ordrank.6.atci.p.ko,ds=david6.atci.p.ko$normDS)
lm6.atci.p.ko<-summary(lm(ordrank.6.atci.p.ko$ds~ordrank.6.atci.p.ko$ord.rank))
s6.atci.p.ko<-lm6.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[19]],X2=attacks.atci.p.ko[[20]],Victories=attacks.atci.p.ko[[21]])
mat7.atci.p.ko<-inter.mat(mut7.atci.p.ko)
tri7.atci.p.ko<-tr.tri(mat7.atci.p.ko)
dci7.atci.p.ko<-DCindex(mat7.atci.p.ko)
mat7.atci.p.ko[is.na(mat7.atci.p.ko)] = 0
h7.atci.p.ko<-h.index(mat7.atci.p.ko)

ep7.atci.p.ko<-ep(mut7.atci.p.ko,a7.ci.p.ko)
david7.atci.p.ko<-DS(mat7.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.ko<-cbind(ordrank.7.atci.p.ko,ds=david7.atci.p.ko$normDS)
lm7.atci.p.ko<-summary(lm(ordrank.7.atci.p.ko$ds~ordrank.7.atci.p.ko$ord.rank))
s7.atci.p.ko<-lm7.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[22]],X2=attacks.atci.p.ko[[23]],Victories=attacks.atci.p.ko[[24]])
mat8.atci.p.ko<-inter.mat(mut8.atci.p.ko)
tri8.atci.p.ko<-tr.tri(mat8.atci.p.ko)
dci8.atci.p.ko<-DCindex(mat8.atci.p.ko)
mat8.atci.p.ko[is.na(mat8.atci.p.ko)] = 0
h8.atci.p.ko<-h.index(mat8.atci.p.ko)

ep8.atci.p.ko<-ep(mut8.atci.p.ko,a8.ci.p.ko)
david8.atci.p.ko<-DS(mat8.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.ko<-cbind(ordrank.8.atci.p.ko,ds=david8.atci.p.ko$normDS)
lm8.atci.p.ko<-summary(lm(ordrank.8.atci.p.ko$ds~ordrank.8.atci.p.ko$ord.rank))
s8.atci.p.ko<-lm8.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[25]],X2=attacks.atci.p.ko[[26]],Victories=attacks.atci.p.ko[[27]])
mat9.atci.p.ko<-inter.mat(mut9.atci.p.ko)
tri9.atci.p.ko<-tr.tri(mat9.atci.p.ko)
dci9.atci.p.ko<-DCindex(mat9.atci.p.ko)
mat9.atci.p.ko[is.na(mat9.atci.p.ko)] = 0
h9.atci.p.ko<-h.index(mat9.atci.p.ko)

ep9.atci.p.ko<-ep(mut9.atci.p.ko,a9.ci.p.ko)
david9.atci.p.ko<-DS(mat9.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.ko<-cbind(ordrank.9.atci.p.ko,ds=david9.atci.p.ko$normDS)
lm9.atci.p.ko<-summary(lm(ordrank.9.atci.p.ko$ds~ordrank.9.atci.p.ko$ord.rank))
s9.atci.p.ko<-lm9.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.ko<-data.frame(X1=attacks.atci.p.ko[[28]],X2=attacks.atci.p.ko[[29]],Victories=attacks.atci.p.ko[[30]])
mat10.atci.p.ko<-inter.mat(mut10.atci.p.ko)
tri10.atci.p.ko<-tr.tri(mat10.atci.p.ko)
dci10.atci.p.ko<-DCindex(mat10.atci.p.ko)
mat10.atci.p.ko[is.na(mat10.atci.p.ko)] = 0
h10.atci.p.ko<-h.index(mat10.atci.p.ko)

ep10.atci.p.ko<-ep(mut10.atci.p.ko,a10.ci.p.ko)
david10.atci.p.ko<-DS(mat10.atci.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.ko<-cbind(ordrank.10.atci.p.ko,ds=david10.atci.p.ko$normDS)
lm10.atci.p.ko<-summary(lm(ordrank.10.atci.p.ko$ds~ordrank.10.atci.p.ko$ord.rank))
s10.atci.p.ko<-lm10.atci.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.ko<-sum(mut1.atci.p.ko$Victories)
int2.atci.p.ko<-sum(mut2.atci.p.ko$Victories)
int3.atci.p.ko<-sum(mut3.atci.p.ko$Victories)
int4.atci.p.ko<-sum(mut4.atci.p.ko$Victories)
int5.atci.p.ko<-sum(mut5.atci.p.ko$Victories)
int6.atci.p.ko<-sum(mut6.atci.p.ko$Victories)
int7.atci.p.ko<-sum(mut7.atci.p.ko$Victories)
int8.atci.p.ko<-sum(mut8.atci.p.ko$Victories)
int9.atci.p.ko<-sum(mut9.atci.p.ko$Victories)
int10.atci.p.ko<-sum(mut10.atci.p.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ko<-sum(a1.ci.p.ko$Victories)
av2.ci.p.ko<-sum(a2.ci.p.ko$Victories)
av3.ci.p.ko<-sum(a3.ci.p.ko$Victories)
av4.ci.p.ko<-sum(a4.ci.p.ko$Victories)
av5.ci.p.ko<-sum(a5.ci.p.ko$Victories)
av6.ci.p.ko<-sum(a6.ci.p.ko$Victories)
av7.ci.p.ko<-sum(a7.ci.p.ko$Victories)
av8.ci.p.ko<-sum(a8.ci.p.ko$Victories)
av9.ci.p.ko<-sum(a9.ci.p.ko$Victories)
av10.ci.p.ko<-sum(a10.ci.p.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.ic.p<-(sum(av1.ci.p.ko, av2.ci.p.ko, av3.ci.p.ko, av4.ci.p.ko, av5.ci.p.ko, av6.ci.p.ko, av7.ci.p.ko, av8.ci.p.ko, av9.ci.p.ko, av10.ci.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.ic.p<-(sum(int1.atci.p.ko, int2.atci.p.ko, int3.atci.p.ko, int4.atci.p.ko, int5.atci.p.ko, int6.atci.p.ko, int7.atci.p.ko, int8.atci.p.ko, int9.atci.p.ko, int10.atci.p.ko))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.ko<-e1.atci.p.ko[order(e1.atci.p.ko$ID),]
e1.atci.p.ko<-as.matrix(t(e1.1.atci.p.ko))

e2.atci.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.ko<-e2.atci.p.ko[order(e2.atci.p.ko$ID),]
e2.atci.p.ko<-as.matrix(t(e2.1.atci.p.ko))

e3.atci.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.ko<-e3.atci.p.ko[order(e3.atci.p.ko$ID),]
e3.atci.p.ko<-as.matrix(t(e3.1.atci.p.ko))

e4.atci.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.ko<-e4.atci.p.ko[order(e4.atci.p.ko$ID),]
e4.atci.p.ko<-as.matrix(t(e4.1.atci.p.ko))

e5.atci.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.ko<-e5.atci.p.ko[order(e5.atci.p.ko$ID),]
e5.atci.p.ko<-as.matrix(t(e5.1.atci.p.ko))

e6.atci.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.ko<-e6.atci.p.ko[order(e6.atci.p.ko$ID),]
e6.atci.p.ko<-as.matrix(t(e6.1.atci.p.ko))

e7.atci.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.ko<-e7.atci.p.ko[order(e7.atci.p.ko$ID),]
e7.atci.p.ko<-as.matrix(t(e7.1.atci.p.ko))

e8.atci.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.ko<-e8.atci.p.ko[order(e8.atci.p.ko$ID),]
e8.atci.p.ko<-as.matrix(t(e8.1.atci.p.ko))

e9.atci.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.ko<-e9.atci.p.ko[order(e9.atci.p.ko$ID),]
e9.atci.p.ko<-as.matrix(t(e9.1.atci.p.ko))

e10.atci.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.ko<-e10.atci.p.ko[order(e10.atci.p.ko$ID),]
e10.atci.p.ko<-as.matrix(t(e10.1.atci.p.ko))

energy.ko.atci.p.ko<-as.data.frame(matrix(c(e1.atci.p.ko,e2.atci.p.ko,e3.atci.p.ko,e4.atci.p.ko,e5.atci.p.ko,e6.atci.p.ko,e7.atci.p.ko,e8.atci.p.ko,e9.atci.p.ko,e10.atci.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.atci.p.ko<-data.frame(ID=energy.ko.atci.p.ko$V1,energy_over_distance=energy.ko.atci.p.ko$V2,energy_over_time=energy.ko.atci.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.ko<-david1.atci.p.ko[order(david1.atci.p.ko$ID),]
david1.atci.p.ko<-as.matrix(t(david1.1.atci.p.ko))

david2.1.atci.p.ko<-david2.atci.p.ko[order(david2.atci.p.ko$ID),]
david2.atci.p.ko<-as.matrix(t(david2.1.atci.p.ko))

david3.1.atci.p.ko<-david3.atci.p.ko[order(david3.atci.p.ko$ID),]
david3.atci.p.ko<-as.matrix(t(david3.1.atci.p.ko))

david4.1.atci.p.ko<-david4.atci.p.ko[order(david4.atci.p.ko$ID),]
david4.atci.p.ko<-as.matrix(t(david4.1.atci.p.ko))

david5.1.atci.p.ko<-david5.atci.p.ko[order(david5.atci.p.ko$ID),]
david5.atci.p.ko<-as.matrix(t(david5.1.atci.p.ko))

david6.1.atci.p.ko<-david6.atci.p.ko[order(david6.atci.p.ko$ID),]
david6.atci.p.ko<-as.matrix(t(david6.1.atci.p.ko))

david7.1.atci.p.ko<-david7.atci.p.ko[order(david7.atci.p.ko$ID),]
david7.atci.p.ko<-as.matrix(t(david7.1.atci.p.ko))

david8.1.atci.p.ko<-david8.atci.p.ko[order(david8.atci.p.ko$ID),]
david8.atci.p.ko<-as.matrix(t(david8.1.atci.p.ko))

david9.1.atci.p.ko<-david9.atci.p.ko[order(david9.atci.p.ko$ID),]
david9.atci.p.ko<-as.matrix(t(david9.1.atci.p.ko))

david10.1.atci.p.ko<-david10.atci.p.ko[order(david10.atci.p.ko$ID),]
david10.atci.p.ko<-as.matrix(t(david10.1.atci.p.ko))

david.ko.atci.p.ko<-as.data.frame(matrix(c(david1.atci.p.ko,david2.atci.p.ko,david3.atci.p.ko,david4.atci.p.ko,david5.atci.p.ko,david6.atci.p.ko,david7.atci.p.ko,david8.atci.p.ko,david9.atci.p.ko,david10.atci.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.atci.p.ko<-data.frame(ID=david.ko.atci.p.ko$V1,DS=david.ko.atci.p.ko$V2,normDS=david.ko.atci.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.atci.p.ko<-lm(e1.1.atci.p.ko$energy_over_time~as.numeric(david1.1.atci.p.ko$normDS))
ko.lm.1.s.atci.p.ko<-summary(lm.ko.1.atci.p.ko)$coefficients
ko.1.slope.atci.p.ko<-ko.lm.1.s.atci.p.ko[2,1]
lm.ko.2.atci.p.ko<-lm(e2.1.atci.p.ko$energy_over_time~as.numeric(david2.1.atci.p.ko$normDS))
ko.lm.2.s.atci.p.ko<-summary(lm.ko.2.atci.p.ko)$coefficients
ko.2.slope.atci.p.ko<-ko.lm.2.s.atci.p.ko[2,1]
lm.ko.3.atci.p.ko<-lm(e3.1.atci.p.ko$energy_over_time~as.numeric(david3.1.atci.p.ko$normDS))
ko.lm.3.s.atci.p.ko<-summary(lm.ko.3.atci.p.ko)$coefficients
ko.3.slope.atci.p.ko<-ko.lm.3.s.atci.p.ko[2,1]
lm.ko.4.atci.p.ko<-lm(e4.1.atci.p.ko$energy_over_time~as.numeric(david4.1.atci.p.ko$normDS))
ko.lm.4.s.atci.p.ko<-summary(lm.ko.4.atci.p.ko)$coefficients
ko.4.slope.atci.p.ko<-ko.lm.4.s.atci.p.ko[2,1]
lm.ko.5.atci.p.ko<-lm(e5.1.atci.p.ko$energy_over_time~as.numeric(david5.1.atci.p.ko$normDS))
ko.lm.5.s.atci.p.ko<-summary(lm.ko.5.atci.p.ko)$coefficients
ko.5.slope.atci.p.ko<-ko.lm.5.s.atci.p.ko[2,1]
lm.ko.6.atci.p.ko<-lm(e6.1.atci.p.ko$energy_over_time~as.numeric(david6.1.atci.p.ko$normDS))
ko.lm.6.s.atci.p.ko<-summary(lm.ko.6.atci.p.ko)$coefficients
ko.6.slope.atci.p.ko<-ko.lm.6.s.atci.p.ko[2,1]
lm.ko.7.atci.p.ko<-lm(e7.1.atci.p.ko$energy_over_time~as.numeric(david7.1.atci.p.ko$normDS))
ko.lm.7.s.atci.p.ko<-summary(lm.ko.7.atci.p.ko)$coefficients
ko.7.slope.atci.p.ko<-ko.lm.7.s.atci.p.ko[2,1]
lm.ko.8.atci.p.ko<-lm(e8.1.atci.p.ko$energy_over_time~as.numeric(david8.1.atci.p.ko$normDS))
ko.lm.8.s.atci.p.ko<-summary(lm.ko.8.atci.p.ko)$coefficients
ko.8.slope.atci.p.ko<-ko.lm.8.s.atci.p.ko[2,1]
lm.ko.9.atci.p.ko<-lm(e9.1.atci.p.ko$energy_over_time~as.numeric(david9.1.atci.p.ko$normDS))
ko.lm.9.s.atci.p.ko<-summary(lm.ko.9.atci.p.ko)$coefficients
ko.9.slope.atci.p.ko<-ko.lm.9.s.atci.p.ko[2,1]
lm.ko.10.atci.p.ko<-lm(e10.1.atci.p.ko$energy_over_time~as.numeric(david10.1.atci.p.ko$normDS))
ko.lm.10.s.atci.p.ko<-summary(lm.ko.10.atci.p.ko)$coefficients
ko.10.slope.atci.p.ko<-ko.lm.10.s.atci.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.atci.p.ss.attacks.atci.p.ko<-data.frame(triangle.transitivity=c(tri1.atci.p.ko,tri2.atci.p.ko,tri3.atci.p.ko,tri4.atci.p.ko,tri5.atci.p.ko,tri6.atci.p.ko,tri7.atci.p.ko,tri8.atci.p.ko,tri9.atci.p.ko,tri10.atci.p.ko),escalation=c(ep1.atci.p.ko,ep2.atci.p.ko,ep3.atci.p.ko,ep4.atci.p.ko,ep5.atci.p.ko,ep6.atci.p.ko,ep7.atci.p.ko,ep8.atci.p.ko,ep9.atci.p.ko,ep10.atci.p.ko),dci=c(dci1.atci.p.ko,dci2.atci.p.ko,dci3.atci.p.ko,dci4.atci.p.ko,dci5.atci.p.ko,dci6.atci.p.ko,dci7.atci.p.ko,dci8.atci.p.ko,dci9.atci.p.ko,dci10.atci.p.ko),steepness=c(s1.atci.p.ko,s2.atci.p.ko,s3.atci.p.ko,s4.atci.p.ko,s5.atci.p.ko,s6.atci.p.ko,s7.atci.p.ko,s8.atci.p.ko,s9.atci.p.ko,s10.atci.p.ko),slope=c(ko.1.slope.atci.p.ko,ko.2.slope.atci.p.ko,ko.3.slope.atci.p.ko,ko.4.slope.atci.p.ko,ko.5.slope.atci.p.ko,ko.6.slope.atci.p.ko,ko.7.slope.atci.p.ko,ko.8.slope.atci.p.ko,ko.9.slope.atci.p.ko,ko.10.slope.atci.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.hm<-sapply(files, read.csv)

# Generate attacks.atci.p.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[1]],X2=attacks.atci.p.hm[[2]],Victories=attacks.atci.p.hm[[3]])
mat1.atci.p.hm<-inter.mat(mut1.atci.p.hm)
tri1.atci.p.hm<-tr.tri(mat1.atci.p.hm)
dci1.atci.p.hm<-DCindex(mat1.atci.p.hm)
mat1.atci.p.hm[is.na(mat1.atci.p.hm)] = 0
h1.atci.p.hm<-h.index(mat1.atci.p.hm)

ep1.atci.p.hm<-ep(mut1.atci.p.hm,a1.ci.p.hm)
david1.atci.p.hm<-DS(mat1.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.hm<-cbind(ordrank.1.atci.p.hm,ds=david1.atci.p.hm$normDS)
lm1.atci.p.hm<-summary(lm(ordrank.1.atci.p.hm$ds~ordrank.1.atci.p.hm$ord.rank))
s1.atci.p.hm<-lm1.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[4]],X2=attacks.atci.p.hm[[5]],Victories=attacks.atci.p.hm[[6]])
mat2.atci.p.hm<-inter.mat(mut2.atci.p.hm)
tri2.atci.p.hm<-tr.tri(mat2.atci.p.hm)
dci2.atci.p.hm<-DCindex(mat2.atci.p.hm)
mat2.atci.p.hm[is.na(mat2.atci.p.hm)] = 0
h2.atci.p.hm<-h.index(mat2.atci.p.hm)

ep2.atci.p.hm<-ep(mut2.atci.p.hm,a2.ci.p.hm)
david2.atci.p.hm<-DS(mat2.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.hm<-cbind(ordrank.2.atci.p.hm,ds=david2.atci.p.hm$normDS)
lm2.atci.p.hm<-summary(lm(ordrank.2.atci.p.hm$ds~ordrank.2.atci.p.hm$ord.rank))
s2.atci.p.hm<-lm2.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[7]],X2=attacks.atci.p.hm[[8]],Victories=attacks.atci.p.hm[[9]])
mat3.atci.p.hm<-inter.mat(mut3.atci.p.hm)
tri3.atci.p.hm<-tr.tri(mat3.atci.p.hm)
dci3.atci.p.hm<-DCindex(mat3.atci.p.hm)
mat3.atci.p.hm[is.na(mat3.atci.p.hm)] = 0
h3.atci.p.hm<-h.index(mat3.atci.p.hm)

ep3.atci.p.hm<-ep(mut3.atci.p.hm,a3.ci.p.hm)
david3.atci.p.hm<-DS(mat3.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.hm<-cbind(ordrank.3.atci.p.hm,ds=david3.atci.p.hm$normDS)
lm3.atci.p.hm<-summary(lm(ordrank.3.atci.p.hm$ds~ordrank.3.atci.p.hm$ord.rank))
s3.atci.p.hm<-lm3.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[10]],X2=attacks.atci.p.hm[[11]],Victories=attacks.atci.p.hm[[12]])
mat4.atci.p.hm<-inter.mat(mut4.atci.p.hm)
tri4.atci.p.hm<-tr.tri(mat4.atci.p.hm)
dci4.atci.p.hm<-DCindex(mat4.atci.p.hm)
mat4.atci.p.hm[is.na(mat4.atci.p.hm)] = 0
h4.atci.p.hm<-h.index(mat4.atci.p.hm)

ep4.atci.p.hm<-ep(mut4.atci.p.hm,a4.ci.p.hm)
david4.atci.p.hm<-DS(mat4.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.hm<-cbind(ordrank.4.atci.p.hm,ds=david4.atci.p.hm$normDS)
lm4.atci.p.hm<-summary(lm(ordrank.4.atci.p.hm$ds~ordrank.4.atci.p.hm$ord.rank))
s4.atci.p.hm<-lm4.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[13]],X2=attacks.atci.p.hm[[14]],Victories=attacks.atci.p.hm[[15]])
mat5.atci.p.hm<-inter.mat(mut5.atci.p.hm)
tri5.atci.p.hm<-tr.tri(mat5.atci.p.hm)
dci5.atci.p.hm<-DCindex(mat5.atci.p.hm)
mat5.atci.p.hm[is.na(mat5.atci.p.hm)] = 0
h5.atci.p.hm<-h.index(mat5.atci.p.hm)

ep5.atci.p.hm<-ep(mut5.atci.p.hm,a5.ci.p.hm)
david5.atci.p.hm<-DS(mat5.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.hm<-cbind(ordrank.5.atci.p.hm,ds=david5.atci.p.hm$normDS)
lm5.atci.p.hm<-summary(lm(ordrank.5.atci.p.hm$ds~ordrank.5.atci.p.hm$ord.rank))
s5.atci.p.hm<-lm5.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[16]],X2=attacks.atci.p.hm[[17]],Victories=attacks.atci.p.hm[[18]])
mat6.atci.p.hm<-inter.mat(mut6.atci.p.hm)
tri6.atci.p.hm<-tr.tri(mat6.atci.p.hm)
dci6.atci.p.hm<-DCindex(mat6.atci.p.hm)
mat6.atci.p.hm[is.na(mat6.atci.p.hm)] = 0
h6.atci.p.hm<-h.index(mat6.atci.p.hm)

ep6.atci.p.hm<-ep(mut6.atci.p.hm,a6.ci.p.hm)
david6.atci.p.hm<-DS(mat6.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.hm<-cbind(ordrank.6.atci.p.hm,ds=david6.atci.p.hm$normDS)
lm6.atci.p.hm<-summary(lm(ordrank.6.atci.p.hm$ds~ordrank.6.atci.p.hm$ord.rank))
s6.atci.p.hm<-lm6.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[19]],X2=attacks.atci.p.hm[[20]],Victories=attacks.atci.p.hm[[21]])
mat7.atci.p.hm<-inter.mat(mut7.atci.p.hm)
tri7.atci.p.hm<-tr.tri(mat7.atci.p.hm)
dci7.atci.p.hm<-DCindex(mat7.atci.p.hm)
mat7.atci.p.hm[is.na(mat7.atci.p.hm)] = 0
h7.atci.p.hm<-h.index(mat7.atci.p.hm)

ep7.atci.p.hm<-ep(mut7.atci.p.hm,a7.ci.p.hm)
david7.atci.p.hm<-DS(mat7.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.hm<-cbind(ordrank.7.atci.p.hm,ds=david7.atci.p.hm$normDS)
lm7.atci.p.hm<-summary(lm(ordrank.7.atci.p.hm$ds~ordrank.7.atci.p.hm$ord.rank))
s7.atci.p.hm<-lm7.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[22]],X2=attacks.atci.p.hm[[23]],Victories=attacks.atci.p.hm[[24]])
mat8.atci.p.hm<-inter.mat(mut8.atci.p.hm)
tri8.atci.p.hm<-tr.tri(mat8.atci.p.hm)
dci8.atci.p.hm<-DCindex(mat8.atci.p.hm)
mat8.atci.p.hm[is.na(mat8.atci.p.hm)] = 0
h8.atci.p.hm<-h.index(mat8.atci.p.hm)

ep8.atci.p.hm<-ep(mut8.atci.p.hm,a8.ci.p.hm)
david8.atci.p.hm<-DS(mat8.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.hm<-cbind(ordrank.8.atci.p.hm,ds=david8.atci.p.hm$normDS)
lm8.atci.p.hm<-summary(lm(ordrank.8.atci.p.hm$ds~ordrank.8.atci.p.hm$ord.rank))
s8.atci.p.hm<-lm8.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[25]],X2=attacks.atci.p.hm[[26]],Victories=attacks.atci.p.hm[[27]])
mat9.atci.p.hm<-inter.mat(mut9.atci.p.hm)
tri9.atci.p.hm<-tr.tri(mat9.atci.p.hm)
dci9.atci.p.hm<-DCindex(mat9.atci.p.hm)
mat9.atci.p.hm[is.na(mat9.atci.p.hm)] = 0
h9.atci.p.hm<-h.index(mat9.atci.p.hm)

ep9.atci.p.hm<-ep(mut9.atci.p.hm,a9.ci.p.hm)
david9.atci.p.hm<-DS(mat9.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.hm<-cbind(ordrank.9.atci.p.hm,ds=david9.atci.p.hm$normDS)
lm9.atci.p.hm<-summary(lm(ordrank.9.atci.p.hm$ds~ordrank.9.atci.p.hm$ord.rank))
s9.atci.p.hm<-lm9.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.hm<-data.frame(X1=attacks.atci.p.hm[[28]],X2=attacks.atci.p.hm[[29]],Victories=attacks.atci.p.hm[[30]])
mat10.atci.p.hm<-inter.mat(mut10.atci.p.hm)
tri10.atci.p.hm<-tr.tri(mat10.atci.p.hm)
dci10.atci.p.hm<-DCindex(mat10.atci.p.hm)
mat10.atci.p.hm[is.na(mat10.atci.p.hm)] = 0
h10.atci.p.hm<-h.index(mat10.atci.p.hm)

ep10.atci.p.hm<-ep(mut10.atci.p.hm,a10.ci.p.hm)
david10.atci.p.hm<-DS(mat10.atci.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.hm<-cbind(ordrank.10.atci.p.hm,ds=david10.atci.p.hm$normDS)
lm10.atci.p.hm<-summary(lm(ordrank.10.atci.p.hm$ds~ordrank.10.atci.p.hm$ord.rank))
s10.atci.p.hm<-lm10.atci.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.hm<-sum(mut1.atci.p.hm$Victories)
int2.atci.p.hm<-sum(mut2.atci.p.hm$Victories)
int3.atci.p.hm<-sum(mut3.atci.p.hm$Victories)
int4.atci.p.hm<-sum(mut4.atci.p.hm$Victories)
int5.atci.p.hm<-sum(mut5.atci.p.hm$Victories)
int6.atci.p.hm<-sum(mut6.atci.p.hm$Victories)
int7.atci.p.hm<-sum(mut7.atci.p.hm$Victories)
int8.atci.p.hm<-sum(mut8.atci.p.hm$Victories)
int9.atci.p.hm<-sum(mut9.atci.p.hm$Victories)
int10.atci.p.hm<-sum(mut10.atci.p.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.hm<-sum(a1.ci.p.hm$Victories)
av2.ci.p.hm<-sum(a2.ci.p.hm$Victories)
av3.ci.p.hm<-sum(a3.ci.p.hm$Victories)
av4.ci.p.hm<-sum(a4.ci.p.hm$Victories)
av5.ci.p.hm<-sum(a5.ci.p.hm$Victories)
av6.ci.p.hm<-sum(a6.ci.p.hm$Victories)
av7.ci.p.hm<-sum(a7.ci.p.hm$Victories)
av8.ci.p.hm<-sum(a8.ci.p.hm$Victories)
av9.ci.p.hm<-sum(a9.ci.p.hm$Victories)
av10.ci.p.hm<-sum(a10.ci.p.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.ic.p<-(sum(av1.ci.p.hm, av2.ci.p.hm, av3.ci.p.hm, av4.ci.p.hm, av5.ci.p.hm, av6.ci.p.hm, av7.ci.p.hm, av8.ci.p.hm, av9.ci.p.hm, av10.ci.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.ic.p<-(sum(int1.atci.p.hm, int2.atci.p.hm, int3.atci.p.hm, int4.atci.p.hm, int5.atci.p.hm, int6.atci.p.hm, int7.atci.p.hm, int8.atci.p.hm, int9.atci.p.hm, int10.atci.p.hm))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.hm<-e1.atci.p.hm[order(e1.atci.p.hm$ID),]
e1.atci.p.hm<-as.matrix(t(e1.1.atci.p.hm))

e2.atci.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.hm<-e2.atci.p.hm[order(e2.atci.p.hm$ID),]
e2.atci.p.hm<-as.matrix(t(e2.1.atci.p.hm))

e3.atci.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.hm<-e3.atci.p.hm[order(e3.atci.p.hm$ID),]
e3.atci.p.hm<-as.matrix(t(e3.1.atci.p.hm))

e4.atci.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.hm<-e4.atci.p.hm[order(e4.atci.p.hm$ID),]
e4.atci.p.hm<-as.matrix(t(e4.1.atci.p.hm))

e5.atci.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.hm<-e5.atci.p.hm[order(e5.atci.p.hm$ID),]
e5.atci.p.hm<-as.matrix(t(e5.1.atci.p.hm))

e6.atci.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.hm<-e6.atci.p.hm[order(e6.atci.p.hm$ID),]
e6.atci.p.hm<-as.matrix(t(e6.1.atci.p.hm))

e7.atci.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.hm<-e7.atci.p.hm[order(e7.atci.p.hm$ID),]
e7.atci.p.hm<-as.matrix(t(e7.1.atci.p.hm))

e8.atci.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.hm<-e8.atci.p.hm[order(e8.atci.p.hm$ID),]
e8.atci.p.hm<-as.matrix(t(e8.1.atci.p.hm))

e9.atci.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.hm<-e9.atci.p.hm[order(e9.atci.p.hm$ID),]
e9.atci.p.hm<-as.matrix(t(e9.1.atci.p.hm))

e10.atci.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.hm<-e10.atci.p.hm[order(e10.atci.p.hm$ID),]
e10.atci.p.hm<-as.matrix(t(e10.1.atci.p.hm))

energy.hm.atci.p.hm<-as.data.frame(matrix(c(e1.atci.p.hm,e2.atci.p.hm,e3.atci.p.hm,e4.atci.p.hm,e5.atci.p.hm,e6.atci.p.hm,e7.atci.p.hm,e8.atci.p.hm,e9.atci.p.hm,e10.atci.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atci.p.hm<-data.frame(ID=energy.hm.atci.p.hm$V1,energy_over_distance=energy.hm.atci.p.hm$V2,energy_over_time=energy.hm.atci.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.hm<-david1.atci.p.hm[order(david1.atci.p.hm$ID),]
david1.atci.p.hm<-as.matrix(t(david1.1.atci.p.hm))

david2.1.atci.p.hm<-david2.atci.p.hm[order(david2.atci.p.hm$ID),]
david2.atci.p.hm<-as.matrix(t(david2.1.atci.p.hm))

david3.1.atci.p.hm<-david3.atci.p.hm[order(david3.atci.p.hm$ID),]
david3.atci.p.hm<-as.matrix(t(david3.1.atci.p.hm))

david4.1.atci.p.hm<-david4.atci.p.hm[order(david4.atci.p.hm$ID),]
david4.atci.p.hm<-as.matrix(t(david4.1.atci.p.hm))

david5.1.atci.p.hm<-david5.atci.p.hm[order(david5.atci.p.hm$ID),]
david5.atci.p.hm<-as.matrix(t(david5.1.atci.p.hm))

david6.1.atci.p.hm<-david6.atci.p.hm[order(david6.atci.p.hm$ID),]
david6.atci.p.hm<-as.matrix(t(david6.1.atci.p.hm))

david7.1.atci.p.hm<-david7.atci.p.hm[order(david7.atci.p.hm$ID),]
david7.atci.p.hm<-as.matrix(t(david7.1.atci.p.hm))

david8.1.atci.p.hm<-david8.atci.p.hm[order(david8.atci.p.hm$ID),]
david8.atci.p.hm<-as.matrix(t(david8.1.atci.p.hm))

david9.1.atci.p.hm<-david9.atci.p.hm[order(david9.atci.p.hm$ID),]
david9.atci.p.hm<-as.matrix(t(david9.1.atci.p.hm))

david10.1.atci.p.hm<-david10.atci.p.hm[order(david10.atci.p.hm$ID),]
david10.atci.p.hm<-as.matrix(t(david10.1.atci.p.hm))

david.hm.atci.p.hm<-as.data.frame(matrix(c(david1.atci.p.hm,david2.atci.p.hm,david3.atci.p.hm,david4.atci.p.hm,david5.atci.p.hm,david6.atci.p.hm,david7.atci.p.hm,david8.atci.p.hm,david9.atci.p.hm,david10.atci.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atci.p.hm<-data.frame(ID=david.hm.atci.p.hm$V1,DS=david.hm.atci.p.hm$V2,normDS=david.hm.atci.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atci.p.hm<-lm(e1.1.atci.p.hm$energy_over_time~as.numeric(david1.1.atci.p.hm$normDS))
hm.lm.1.s.atci.p.hm<-summary(lm.hm.1.atci.p.hm)$coefficients
hm.1.slope.atci.p.hm<-hm.lm.1.s.atci.p.hm[2,1]
lm.hm.2.atci.p.hm<-lm(e2.1.atci.p.hm$energy_over_time~as.numeric(david2.1.atci.p.hm$normDS))
hm.lm.2.s.atci.p.hm<-summary(lm.hm.2.atci.p.hm)$coefficients
hm.2.slope.atci.p.hm<-hm.lm.2.s.atci.p.hm[2,1]
lm.hm.3.atci.p.hm<-lm(e3.1.atci.p.hm$energy_over_time~as.numeric(david3.1.atci.p.hm$normDS))
hm.lm.3.s.atci.p.hm<-summary(lm.hm.3.atci.p.hm)$coefficients
hm.3.slope.atci.p.hm<-hm.lm.3.s.atci.p.hm[2,1]
lm.hm.4.atci.p.hm<-lm(e4.1.atci.p.hm$energy_over_time~as.numeric(david4.1.atci.p.hm$normDS))
hm.lm.4.s.atci.p.hm<-summary(lm.hm.4.atci.p.hm)$coefficients
hm.4.slope.atci.p.hm<-hm.lm.4.s.atci.p.hm[2,1]
lm.hm.5.atci.p.hm<-lm(e5.1.atci.p.hm$energy_over_time~as.numeric(david5.1.atci.p.hm$normDS))
hm.lm.5.s.atci.p.hm<-summary(lm.hm.5.atci.p.hm)$coefficients
hm.5.slope.atci.p.hm<-hm.lm.5.s.atci.p.hm[2,1]
lm.hm.6.atci.p.hm<-lm(e6.1.atci.p.hm$energy_over_time~as.numeric(david6.1.atci.p.hm$normDS))
hm.lm.6.s.atci.p.hm<-summary(lm.hm.6.atci.p.hm)$coefficients
hm.6.slope.atci.p.hm<-hm.lm.6.s.atci.p.hm[2,1]
lm.hm.7.atci.p.hm<-lm(e7.1.atci.p.hm$energy_over_time~as.numeric(david7.1.atci.p.hm$normDS))
hm.lm.7.s.atci.p.hm<-summary(lm.hm.7.atci.p.hm)$coefficients
hm.7.slope.atci.p.hm<-hm.lm.7.s.atci.p.hm[2,1]
lm.hm.8.atci.p.hm<-lm(e8.1.atci.p.hm$energy_over_time~as.numeric(david8.1.atci.p.hm$normDS))
hm.lm.8.s.atci.p.hm<-summary(lm.hm.8.atci.p.hm)$coefficients
hm.8.slope.atci.p.hm<-hm.lm.8.s.atci.p.hm[2,1]
lm.hm.9.atci.p.hm<-lm(e9.1.atci.p.hm$energy_over_time~as.numeric(david9.1.atci.p.hm$normDS))
hm.lm.9.s.atci.p.hm<-summary(lm.hm.9.atci.p.hm)$coefficients
hm.9.slope.atci.p.hm<-hm.lm.9.s.atci.p.hm[2,1]
lm.hm.10.atci.p.hm<-lm(e10.1.atci.p.hm$energy_over_time~as.numeric(david10.1.atci.p.hm$normDS))
hm.lm.10.s.atci.p.hm<-summary(lm.hm.10.atci.p.hm)$coefficients
hm.10.slope.atci.p.hm<-hm.lm.10.s.atci.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atci.p.ss.attacks.atci.p.hm<-data.frame(triangle.transitivity=c(tri1.atci.p.hm,tri2.atci.p.hm,tri3.atci.p.hm,tri4.atci.p.hm,tri5.atci.p.hm,tri6.atci.p.hm,tri7.atci.p.hm,tri8.atci.p.hm,tri9.atci.p.hm,tri10.atci.p.hm),escalation=c(ep1.atci.p.hm,ep2.atci.p.hm,ep3.atci.p.hm,ep4.atci.p.hm,ep5.atci.p.hm,ep6.atci.p.hm,ep7.atci.p.hm,ep8.atci.p.hm,ep9.atci.p.hm,ep10.atci.p.hm),dci=c(dci1.atci.p.hm,dci2.atci.p.hm,dci3.atci.p.hm,dci4.atci.p.hm,dci5.atci.p.hm,dci6.atci.p.hm,dci7.atci.p.hm,dci8.atci.p.hm,dci9.atci.p.hm,dci10.atci.p.hm),steepness=c(s1.atci.p.hm,s2.atci.p.hm,s3.atci.p.hm,s4.atci.p.hm,s5.atci.p.hm,s6.atci.p.hm,s7.atci.p.hm,s8.atci.p.hm,s9.atci.p.hm,s10.atci.p.hm),slope=c(hm.1.slope.atci.p.hm,hm.2.slope.atci.p.hm,hm.3.slope.atci.p.hm,hm.4.slope.atci.p.hm,hm.5.slope.atci.p.hm,hm.6.slope.atci.p.hm,hm.7.slope.atci.p.hm,hm.8.slope.atci.p.hm,hm.9.slope.atci.p.hm,hm.10.slope.atci.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.hs<-sapply(files, read.csv)

# Generate attacks.atci.p.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[1]],X2=attacks.atci.p.hs[[2]],Victories=attacks.atci.p.hs[[3]])
mat1.atci.p.hs<-inter.mat(mut1.atci.p.hs)
tri1.atci.p.hs<-tr.tri(mat1.atci.p.hs)
dci1.atci.p.hs<-DCindex(mat1.atci.p.hs)
mat1.atci.p.hs[is.na(mat1.atci.p.hs)] = 0
h1.atci.p.hs<-h.index(mat1.atci.p.hs)

ep1.atci.p.hs<-ep(mut1.atci.p.hs,a1.ci.p.hs)
david1.atci.p.hs<-DS(mat1.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.hs<-cbind(ordrank.1.atci.p.hs,ds=david1.atci.p.hs$normDS)
lm1.atci.p.hs<-summary(lm(ordrank.1.atci.p.hs$ds~ordrank.1.atci.p.hs$ord.rank))
s1.atci.p.hs<-lm1.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[4]],X2=attacks.atci.p.hs[[5]],Victories=attacks.atci.p.hs[[6]])
mat2.atci.p.hs<-inter.mat(mut2.atci.p.hs)
tri2.atci.p.hs<-tr.tri(mat2.atci.p.hs)
dci2.atci.p.hs<-DCindex(mat2.atci.p.hs)
mat2.atci.p.hs[is.na(mat2.atci.p.hs)] = 0
h2.atci.p.hs<-h.index(mat2.atci.p.hs)

ep2.atci.p.hs<-ep(mut2.atci.p.hs,a2.ci.p.hs)
david2.atci.p.hs<-DS(mat2.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.hs<-cbind(ordrank.2.atci.p.hs,ds=david2.atci.p.hs$normDS)
lm2.atci.p.hs<-summary(lm(ordrank.2.atci.p.hs$ds~ordrank.2.atci.p.hs$ord.rank))
s2.atci.p.hs<-lm2.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[7]],X2=attacks.atci.p.hs[[8]],Victories=attacks.atci.p.hs[[9]])
mat3.atci.p.hs<-inter.mat(mut3.atci.p.hs)
tri3.atci.p.hs<-tr.tri(mat3.atci.p.hs)
dci3.atci.p.hs<-DCindex(mat3.atci.p.hs)
mat3.atci.p.hs[is.na(mat3.atci.p.hs)] = 0
h3.atci.p.hs<-h.index(mat3.atci.p.hs)

ep3.atci.p.hs<-ep(mut3.atci.p.hs,a3.ci.p.hs)
david3.atci.p.hs<-DS(mat3.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.hs<-cbind(ordrank.3.atci.p.hs,ds=david3.atci.p.hs$normDS)
lm3.atci.p.hs<-summary(lm(ordrank.3.atci.p.hs$ds~ordrank.3.atci.p.hs$ord.rank))
s3.atci.p.hs<-lm3.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[10]],X2=attacks.atci.p.hs[[11]],Victories=attacks.atci.p.hs[[12]])
mat4.atci.p.hs<-inter.mat(mut4.atci.p.hs)
tri4.atci.p.hs<-tr.tri(mat4.atci.p.hs)
dci4.atci.p.hs<-DCindex(mat4.atci.p.hs)
mat4.atci.p.hs[is.na(mat4.atci.p.hs)] = 0
h4.atci.p.hs<-h.index(mat4.atci.p.hs)

ep4.atci.p.hs<-ep(mut4.atci.p.hs,a4.ci.p.hs)
david4.atci.p.hs<-DS(mat4.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.hs<-cbind(ordrank.4.atci.p.hs,ds=david4.atci.p.hs$normDS)
lm4.atci.p.hs<-summary(lm(ordrank.4.atci.p.hs$ds~ordrank.4.atci.p.hs$ord.rank))
s4.atci.p.hs<-lm4.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[13]],X2=attacks.atci.p.hs[[14]],Victories=attacks.atci.p.hs[[15]])
mat5.atci.p.hs<-inter.mat(mut5.atci.p.hs)
tri5.atci.p.hs<-tr.tri(mat5.atci.p.hs)
dci5.atci.p.hs<-DCindex(mat5.atci.p.hs)
mat5.atci.p.hs[is.na(mat5.atci.p.hs)] = 0
h5.atci.p.hs<-h.index(mat5.atci.p.hs)

ep5.atci.p.hs<-ep(mut5.atci.p.hs,a5.ci.p.hs)
david5.atci.p.hs<-DS(mat5.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.hs<-cbind(ordrank.5.atci.p.hs,ds=david5.atci.p.hs$normDS)
lm5.atci.p.hs<-summary(lm(ordrank.5.atci.p.hs$ds~ordrank.5.atci.p.hs$ord.rank))
s5.atci.p.hs<-lm5.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[16]],X2=attacks.atci.p.hs[[17]],Victories=attacks.atci.p.hs[[18]])
mat6.atci.p.hs<-inter.mat(mut6.atci.p.hs)
tri6.atci.p.hs<-tr.tri(mat6.atci.p.hs)
dci6.atci.p.hs<-DCindex(mat6.atci.p.hs)
mat6.atci.p.hs[is.na(mat6.atci.p.hs)] = 0
h6.atci.p.hs<-h.index(mat6.atci.p.hs)

ep6.atci.p.hs<-ep(mut6.atci.p.hs,a6.ci.p.hs)
david6.atci.p.hs<-DS(mat6.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.hs<-cbind(ordrank.6.atci.p.hs,ds=david6.atci.p.hs$normDS)
lm6.atci.p.hs<-summary(lm(ordrank.6.atci.p.hs$ds~ordrank.6.atci.p.hs$ord.rank))
s6.atci.p.hs<-lm6.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[19]],X2=attacks.atci.p.hs[[20]],Victories=attacks.atci.p.hs[[21]])
mat7.atci.p.hs<-inter.mat(mut7.atci.p.hs)
tri7.atci.p.hs<-tr.tri(mat7.atci.p.hs)
dci7.atci.p.hs<-DCindex(mat7.atci.p.hs)
mat7.atci.p.hs[is.na(mat7.atci.p.hs)] = 0
h7.atci.p.hs<-h.index(mat7.atci.p.hs)

ep7.atci.p.hs<-ep(mut7.atci.p.hs,a7.ci.p.hs)
david7.atci.p.hs<-DS(mat7.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.hs<-cbind(ordrank.7.atci.p.hs,ds=david7.atci.p.hs$normDS)
lm7.atci.p.hs<-summary(lm(ordrank.7.atci.p.hs$ds~ordrank.7.atci.p.hs$ord.rank))
s7.atci.p.hs<-lm7.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[22]],X2=attacks.atci.p.hs[[23]],Victories=attacks.atci.p.hs[[24]])
mat8.atci.p.hs<-inter.mat(mut8.atci.p.hs)
tri8.atci.p.hs<-tr.tri(mat8.atci.p.hs)
dci8.atci.p.hs<-DCindex(mat8.atci.p.hs)
mat8.atci.p.hs[is.na(mat8.atci.p.hs)] = 0
h8.atci.p.hs<-h.index(mat8.atci.p.hs)

ep8.atci.p.hs<-ep(mut8.atci.p.hs,a8.ci.p.hs)
david8.atci.p.hs<-DS(mat8.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.hs<-cbind(ordrank.8.atci.p.hs,ds=david8.atci.p.hs$normDS)
lm8.atci.p.hs<-summary(lm(ordrank.8.atci.p.hs$ds~ordrank.8.atci.p.hs$ord.rank))
s8.atci.p.hs<-lm8.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[25]],X2=attacks.atci.p.hs[[26]],Victories=attacks.atci.p.hs[[27]])
mat9.atci.p.hs<-inter.mat(mut9.atci.p.hs)
tri9.atci.p.hs<-tr.tri(mat9.atci.p.hs)
dci9.atci.p.hs<-DCindex(mat9.atci.p.hs)
mat9.atci.p.hs[is.na(mat9.atci.p.hs)] = 0
h9.atci.p.hs<-h.index(mat9.atci.p.hs)

ep9.atci.p.hs<-ep(mut9.atci.p.hs,a9.ci.p.hs)
david9.atci.p.hs<-DS(mat9.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.hs<-cbind(ordrank.9.atci.p.hs,ds=david9.atci.p.hs$normDS)
lm9.atci.p.hs<-summary(lm(ordrank.9.atci.p.hs$ds~ordrank.9.atci.p.hs$ord.rank))
s9.atci.p.hs<-lm9.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.hs<-data.frame(X1=attacks.atci.p.hs[[28]],X2=attacks.atci.p.hs[[29]],Victories=attacks.atci.p.hs[[30]])
mat10.atci.p.hs<-inter.mat(mut10.atci.p.hs)
tri10.atci.p.hs<-tr.tri(mat10.atci.p.hs)
dci10.atci.p.hs<-DCindex(mat10.atci.p.hs)
mat10.atci.p.hs[is.na(mat10.atci.p.hs)] = 0
h10.atci.p.hs<-h.index(mat10.atci.p.hs)

ep10.atci.p.hs<-ep(mut10.atci.p.hs,a10.ci.p.hs)
david10.atci.p.hs<-DS(mat10.atci.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.hs<-cbind(ordrank.10.atci.p.hs,ds=david10.atci.p.hs$normDS)
lm10.atci.p.hs<-summary(lm(ordrank.10.atci.p.hs$ds~ordrank.10.atci.p.hs$ord.rank))
s10.atci.p.hs<-lm10.atci.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.hs<-sum(mut1.atci.p.hs$Victories)
int2.atci.p.hs<-sum(mut2.atci.p.hs$Victories)
int3.atci.p.hs<-sum(mut3.atci.p.hs$Victories)
int4.atci.p.hs<-sum(mut4.atci.p.hs$Victories)
int5.atci.p.hs<-sum(mut5.atci.p.hs$Victories)
int6.atci.p.hs<-sum(mut6.atci.p.hs$Victories)
int7.atci.p.hs<-sum(mut7.atci.p.hs$Victories)
int8.atci.p.hs<-sum(mut8.atci.p.hs$Victories)
int9.atci.p.hs<-sum(mut9.atci.p.hs$Victories)
int10.atci.p.hs<-sum(mut10.atci.p.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.hs<-sum(a1.ci.p.hs$Victories)
av2.ci.p.hs<-sum(a2.ci.p.hs$Victories)
av3.ci.p.hs<-sum(a3.ci.p.hs$Victories)
av4.ci.p.hs<-sum(a4.ci.p.hs$Victories)
av5.ci.p.hs<-sum(a5.ci.p.hs$Victories)
av6.ci.p.hs<-sum(a6.ci.p.hs$Victories)
av7.ci.p.hs<-sum(a7.ci.p.hs$Victories)
av8.ci.p.hs<-sum(a8.ci.p.hs$Victories)
av9.ci.p.hs<-sum(a9.ci.p.hs$Victories)
av10.ci.p.hs<-sum(a10.ci.p.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.ic.p<-(sum(av1.ci.p.hs, av2.ci.p.hs, av3.ci.p.hs, av4.ci.p.hs, av5.ci.p.hs, av6.ci.p.hs, av7.ci.p.hs, av8.ci.p.hs, av9.ci.p.hs, av10.ci.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.ic.p<-(sum(int1.atci.p.hs, int2.atci.p.hs, int3.atci.p.hs, int4.atci.p.hs, int5.atci.p.hs, int6.atci.p.hs, int7.atci.p.hs, int8.atci.p.hs, int9.atci.p.hs, int10.atci.p.hs))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.hs<-e1.atci.p.hs[order(e1.atci.p.hs$ID),]
e1.atci.p.hs<-as.matrix(t(e1.1.atci.p.hs))

e2.atci.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.hs<-e2.atci.p.hs[order(e2.atci.p.hs$ID),]
e2.atci.p.hs<-as.matrix(t(e2.1.atci.p.hs))

e3.atci.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.hs<-e3.atci.p.hs[order(e3.atci.p.hs$ID),]
e3.atci.p.hs<-as.matrix(t(e3.1.atci.p.hs))

e4.atci.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.hs<-e4.atci.p.hs[order(e4.atci.p.hs$ID),]
e4.atci.p.hs<-as.matrix(t(e4.1.atci.p.hs))

e5.atci.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.hs<-e5.atci.p.hs[order(e5.atci.p.hs$ID),]
e5.atci.p.hs<-as.matrix(t(e5.1.atci.p.hs))

e6.atci.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.hs<-e6.atci.p.hs[order(e6.atci.p.hs$ID),]
e6.atci.p.hs<-as.matrix(t(e6.1.atci.p.hs))

e7.atci.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.hs<-e7.atci.p.hs[order(e7.atci.p.hs$ID),]
e7.atci.p.hs<-as.matrix(t(e7.1.atci.p.hs))

e8.atci.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.hs<-e8.atci.p.hs[order(e8.atci.p.hs$ID),]
e8.atci.p.hs<-as.matrix(t(e8.1.atci.p.hs))

e9.atci.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.hs<-e9.atci.p.hs[order(e9.atci.p.hs$ID),]
e9.atci.p.hs<-as.matrix(t(e9.1.atci.p.hs))

e10.atci.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.hs<-e10.atci.p.hs[order(e10.atci.p.hs$ID),]
e10.atci.p.hs<-as.matrix(t(e10.1.atci.p.hs))

energy.hs.atci.p.hs<-as.data.frame(matrix(c(e1.atci.p.hs,e2.atci.p.hs,e3.atci.p.hs,e4.atci.p.hs,e5.atci.p.hs,e6.atci.p.hs,e7.atci.p.hs,e8.atci.p.hs,e9.atci.p.hs,e10.atci.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.atci.p.hs<-data.frame(ID=energy.hs.atci.p.hs$V1,energy_over_distance=energy.hs.atci.p.hs$V2,energy_over_time=energy.hs.atci.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.hs<-david1.atci.p.hs[order(david1.atci.p.hs$ID),]
david1.atci.p.hs<-as.matrix(t(david1.1.atci.p.hs))

david2.1.atci.p.hs<-david2.atci.p.hs[order(david2.atci.p.hs$ID),]
david2.atci.p.hs<-as.matrix(t(david2.1.atci.p.hs))

david3.1.atci.p.hs<-david3.atci.p.hs[order(david3.atci.p.hs$ID),]
david3.atci.p.hs<-as.matrix(t(david3.1.atci.p.hs))

david4.1.atci.p.hs<-david4.atci.p.hs[order(david4.atci.p.hs$ID),]
david4.atci.p.hs<-as.matrix(t(david4.1.atci.p.hs))

david5.1.atci.p.hs<-david5.atci.p.hs[order(david5.atci.p.hs$ID),]
david5.atci.p.hs<-as.matrix(t(david5.1.atci.p.hs))

david6.1.atci.p.hs<-david6.atci.p.hs[order(david6.atci.p.hs$ID),]
david6.atci.p.hs<-as.matrix(t(david6.1.atci.p.hs))

david7.1.atci.p.hs<-david7.atci.p.hs[order(david7.atci.p.hs$ID),]
david7.atci.p.hs<-as.matrix(t(david7.1.atci.p.hs))

david8.1.atci.p.hs<-david8.atci.p.hs[order(david8.atci.p.hs$ID),]
david8.atci.p.hs<-as.matrix(t(david8.1.atci.p.hs))

david9.1.atci.p.hs<-david9.atci.p.hs[order(david9.atci.p.hs$ID),]
david9.atci.p.hs<-as.matrix(t(david9.1.atci.p.hs))

david10.1.atci.p.hs<-david10.atci.p.hs[order(david10.atci.p.hs$ID),]
david10.atci.p.hs<-as.matrix(t(david10.1.atci.p.hs))

david.hs.atci.p.hs<-as.data.frame(matrix(c(david1.atci.p.hs,david2.atci.p.hs,david3.atci.p.hs,david4.atci.p.hs,david5.atci.p.hs,david6.atci.p.hs,david7.atci.p.hs,david8.atci.p.hs,david9.atci.p.hs,david10.atci.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.atci.p.hs<-data.frame(ID=david.hs.atci.p.hs$V1,DS=david.hs.atci.p.hs$V2,normDS=david.hs.atci.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.atci.p.hs<-lm(e1.1.atci.p.hs$energy_over_time~as.numeric(david1.1.atci.p.hs$normDS))
hs.lm.1.s.atci.p.hs<-summary(lm.hs.1.atci.p.hs)$coefficients
hs.1.slope.atci.p.hs<-hs.lm.1.s.atci.p.hs[2,1]
lm.hs.2.atci.p.hs<-lm(e2.1.atci.p.hs$energy_over_time~as.numeric(david2.1.atci.p.hs$normDS))
hs.lm.2.s.atci.p.hs<-summary(lm.hs.2.atci.p.hs)$coefficients
hs.2.slope.atci.p.hs<-hs.lm.2.s.atci.p.hs[2,1]
lm.hs.3.atci.p.hs<-lm(e3.1.atci.p.hs$energy_over_time~as.numeric(david3.1.atci.p.hs$normDS))
hs.lm.3.s.atci.p.hs<-summary(lm.hs.3.atci.p.hs)$coefficients
hs.3.slope.atci.p.hs<-hs.lm.3.s.atci.p.hs[2,1]
lm.hs.4.atci.p.hs<-lm(e4.1.atci.p.hs$energy_over_time~as.numeric(david4.1.atci.p.hs$normDS))
hs.lm.4.s.atci.p.hs<-summary(lm.hs.4.atci.p.hs)$coefficients
hs.4.slope.atci.p.hs<-hs.lm.4.s.atci.p.hs[2,1]
lm.hs.5.atci.p.hs<-lm(e5.1.atci.p.hs$energy_over_time~as.numeric(david5.1.atci.p.hs$normDS))
hs.lm.5.s.atci.p.hs<-summary(lm.hs.5.atci.p.hs)$coefficients
hs.5.slope.atci.p.hs<-hs.lm.5.s.atci.p.hs[2,1]
lm.hs.6.atci.p.hs<-lm(e6.1.atci.p.hs$energy_over_time~as.numeric(david6.1.atci.p.hs$normDS))
hs.lm.6.s.atci.p.hs<-summary(lm.hs.6.atci.p.hs)$coefficients
hs.6.slope.atci.p.hs<-hs.lm.6.s.atci.p.hs[2,1]
lm.hs.7.atci.p.hs<-lm(e7.1.atci.p.hs$energy_over_time~as.numeric(david7.1.atci.p.hs$normDS))
hs.lm.7.s.atci.p.hs<-summary(lm.hs.7.atci.p.hs)$coefficients
hs.7.slope.atci.p.hs<-hs.lm.7.s.atci.p.hs[2,1]
lm.hs.8.atci.p.hs<-lm(e8.1.atci.p.hs$energy_over_time~as.numeric(david8.1.atci.p.hs$normDS))
hs.lm.8.s.atci.p.hs<-summary(lm.hs.8.atci.p.hs)$coefficients
hs.8.slope.atci.p.hs<-hs.lm.8.s.atci.p.hs[2,1]
lm.hs.9.atci.p.hs<-lm(e9.1.atci.p.hs$energy_over_time~as.numeric(david9.1.atci.p.hs$normDS))
hs.lm.9.s.atci.p.hs<-summary(lm.hs.9.atci.p.hs)$coefficients
hs.9.slope.atci.p.hs<-hs.lm.9.s.atci.p.hs[2,1]
lm.hs.10.atci.p.hs<-lm(e10.1.atci.p.hs$energy_over_time~as.numeric(david10.1.atci.p.hs$normDS))
hs.lm.10.s.atci.p.hs<-summary(lm.hs.10.atci.p.hs)$coefficients
hs.10.slope.atci.p.hs<-hs.lm.10.s.atci.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.atci.p.ss.attacks.atci.p.hs<-data.frame(triangle.transitivity=c(tri1.atci.p.hs,tri2.atci.p.hs,tri3.atci.p.hs,tri4.atci.p.hs,tri5.atci.p.hs,tri6.atci.p.hs,tri7.atci.p.hs,tri8.atci.p.hs,tri9.atci.p.hs,tri10.atci.p.hs),escalation=c(ep1.atci.p.hs,ep2.atci.p.hs,ep3.atci.p.hs,ep4.atci.p.hs,ep5.atci.p.hs,ep6.atci.p.hs,ep7.atci.p.hs,ep8.atci.p.hs,ep9.atci.p.hs,ep10.atci.p.hs),dci=c(dci1.atci.p.hs,dci2.atci.p.hs,dci3.atci.p.hs,dci4.atci.p.hs,dci5.atci.p.hs,dci6.atci.p.hs,dci7.atci.p.hs,dci8.atci.p.hs,dci9.atci.p.hs,dci10.atci.p.hs),steepness=c(s1.atci.p.hs,s2.atci.p.hs,s3.atci.p.hs,s4.atci.p.hs,s5.atci.p.hs,s6.atci.p.hs,s7.atci.p.hs,s8.atci.p.hs,s9.atci.p.hs,s10.atci.p.hs),slope=c(hs.1.slope.atci.p.hs,hs.2.slope.atci.p.hs,hs.3.slope.atci.p.hs,hs.4.slope.atci.p.hs,hs.5.slope.atci.p.hs,hs.6.slope.atci.p.hs,hs.7.slope.atci.p.hs,hs.8.slope.atci.p.hs,hs.9.slope.atci.p.hs,hs.10.slope.atci.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Clump

# Data organization for the Knowledge Mutual Clump data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atci.p.ho<-sapply(files, read.csv)

# Generate attacks.atci.p.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[1]],X2=attacks.atci.p.ho[[2]],Victories=attacks.atci.p.ho[[3]])
mat1.atci.p.ho<-inter.mat(mut1.atci.p.ho)
tri1.atci.p.ho<-tr.tri(mat1.atci.p.ho)
dci1.atci.p.ho<-DCindex(mat1.atci.p.ho)
mat1.atci.p.ho[is.na(mat1.atci.p.ho)] = 0
h1.atci.p.ho<-h.index(mat1.atci.p.ho)

ep1.atci.p.ho<-ep(mut1.atci.p.ho,a1.ci.p.ho)
david1.atci.p.ho<-DS(mat1.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atci.p.ho<-cbind(ordrank.1.atci.p.ho,ds=david1.atci.p.ho$normDS)
lm1.atci.p.ho<-summary(lm(ordrank.1.atci.p.ho$ds~ordrank.1.atci.p.ho$ord.rank))
s1.atci.p.ho<-lm1.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[4]],X2=attacks.atci.p.ho[[5]],Victories=attacks.atci.p.ho[[6]])
mat2.atci.p.ho<-inter.mat(mut2.atci.p.ho)
tri2.atci.p.ho<-tr.tri(mat2.atci.p.ho)
dci2.atci.p.ho<-DCindex(mat2.atci.p.ho)
mat2.atci.p.ho[is.na(mat2.atci.p.ho)] = 0
h2.atci.p.ho<-h.index(mat2.atci.p.ho)

ep2.atci.p.ho<-ep(mut2.atci.p.ho,a2.ci.p.ho)
david2.atci.p.ho<-DS(mat2.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atci.p.ho<-cbind(ordrank.2.atci.p.ho,ds=david2.atci.p.ho$normDS)
lm2.atci.p.ho<-summary(lm(ordrank.2.atci.p.ho$ds~ordrank.2.atci.p.ho$ord.rank))
s2.atci.p.ho<-lm2.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[7]],X2=attacks.atci.p.ho[[8]],Victories=attacks.atci.p.ho[[9]])
mat3.atci.p.ho<-inter.mat(mut3.atci.p.ho)
tri3.atci.p.ho<-tr.tri(mat3.atci.p.ho)
dci3.atci.p.ho<-DCindex(mat3.atci.p.ho)
mat3.atci.p.ho[is.na(mat3.atci.p.ho)] = 0
h3.atci.p.ho<-h.index(mat3.atci.p.ho)

ep3.atci.p.ho<-ep(mut3.atci.p.ho,a3.ci.p.ho)
david3.atci.p.ho<-DS(mat3.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atci.p.ho<-cbind(ordrank.3.atci.p.ho,ds=david3.atci.p.ho$normDS)
lm3.atci.p.ho<-summary(lm(ordrank.3.atci.p.ho$ds~ordrank.3.atci.p.ho$ord.rank))
s3.atci.p.ho<-lm3.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[10]],X2=attacks.atci.p.ho[[11]],Victories=attacks.atci.p.ho[[12]])
mat4.atci.p.ho<-inter.mat(mut4.atci.p.ho)
tri4.atci.p.ho<-tr.tri(mat4.atci.p.ho)
dci4.atci.p.ho<-DCindex(mat4.atci.p.ho)
mat4.atci.p.ho[is.na(mat4.atci.p.ho)] = 0
h4.atci.p.ho<-h.index(mat4.atci.p.ho)

ep4.atci.p.ho<-ep(mut4.atci.p.ho,a4.ci.p.ho)
david4.atci.p.ho<-DS(mat4.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atci.p.ho<-cbind(ordrank.4.atci.p.ho,ds=david4.atci.p.ho$normDS)
lm4.atci.p.ho<-summary(lm(ordrank.4.atci.p.ho$ds~ordrank.4.atci.p.ho$ord.rank))
s4.atci.p.ho<-lm4.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[13]],X2=attacks.atci.p.ho[[14]],Victories=attacks.atci.p.ho[[15]])
mat5.atci.p.ho<-inter.mat(mut5.atci.p.ho)
tri5.atci.p.ho<-tr.tri(mat5.atci.p.ho)
dci5.atci.p.ho<-DCindex(mat5.atci.p.ho)
mat5.atci.p.ho[is.na(mat5.atci.p.ho)] = 0
h5.atci.p.ho<-h.index(mat5.atci.p.ho)

ep5.atci.p.ho<-ep(mut5.atci.p.ho,a5.ci.p.ho)
david5.atci.p.ho<-DS(mat5.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atci.p.ho<-cbind(ordrank.5.atci.p.ho,ds=david5.atci.p.ho$normDS)
lm5.atci.p.ho<-summary(lm(ordrank.5.atci.p.ho$ds~ordrank.5.atci.p.ho$ord.rank))
s5.atci.p.ho<-lm5.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[16]],X2=attacks.atci.p.ho[[17]],Victories=attacks.atci.p.ho[[18]])
mat6.atci.p.ho<-inter.mat(mut6.atci.p.ho)
tri6.atci.p.ho<-tr.tri(mat6.atci.p.ho)
dci6.atci.p.ho<-DCindex(mat6.atci.p.ho)
mat6.atci.p.ho[is.na(mat6.atci.p.ho)] = 0
h6.atci.p.ho<-h.index(mat6.atci.p.ho)

ep6.atci.p.ho<-ep(mut6.atci.p.ho,a6.ci.p.ho)
david6.atci.p.ho<-DS(mat6.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atci.p.ho<-cbind(ordrank.6.atci.p.ho,ds=david6.atci.p.ho$normDS)
lm6.atci.p.ho<-summary(lm(ordrank.6.atci.p.ho$ds~ordrank.6.atci.p.ho$ord.rank))
s6.atci.p.ho<-lm6.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[19]],X2=attacks.atci.p.ho[[20]],Victories=attacks.atci.p.ho[[21]])
mat7.atci.p.ho<-inter.mat(mut7.atci.p.ho)
tri7.atci.p.ho<-tr.tri(mat7.atci.p.ho)
dci7.atci.p.ho<-DCindex(mat7.atci.p.ho)
mat7.atci.p.ho[is.na(mat7.atci.p.ho)] = 0
h7.atci.p.ho<-h.index(mat7.atci.p.ho)

ep7.atci.p.ho<-ep(mut7.atci.p.ho,a7.ci.p.ho)
david7.atci.p.ho<-DS(mat7.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atci.p.ho<-cbind(ordrank.7.atci.p.ho,ds=david7.atci.p.ho$normDS)
lm7.atci.p.ho<-summary(lm(ordrank.7.atci.p.ho$ds~ordrank.7.atci.p.ho$ord.rank))
s7.atci.p.ho<-lm7.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[22]],X2=attacks.atci.p.ho[[23]],Victories=attacks.atci.p.ho[[24]])
mat8.atci.p.ho<-inter.mat(mut8.atci.p.ho)
tri8.atci.p.ho<-tr.tri(mat8.atci.p.ho)
dci8.atci.p.ho<-DCindex(mat8.atci.p.ho)
mat8.atci.p.ho[is.na(mat8.atci.p.ho)] = 0
h8.atci.p.ho<-h.index(mat8.atci.p.ho)

ep8.atci.p.ho<-ep(mut8.atci.p.ho,a8.ci.p.ho)
david8.atci.p.ho<-DS(mat8.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atci.p.ho<-cbind(ordrank.8.atci.p.ho,ds=david8.atci.p.ho$normDS)
lm8.atci.p.ho<-summary(lm(ordrank.8.atci.p.ho$ds~ordrank.8.atci.p.ho$ord.rank))
s8.atci.p.ho<-lm8.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[25]],X2=attacks.atci.p.ho[[26]],Victories=attacks.atci.p.ho[[27]])
mat9.atci.p.ho<-inter.mat(mut9.atci.p.ho)
tri9.atci.p.ho<-tr.tri(mat9.atci.p.ho)
dci9.atci.p.ho<-DCindex(mat9.atci.p.ho)
mat9.atci.p.ho[is.na(mat9.atci.p.ho)] = 0
h9.atci.p.ho<-h.index(mat9.atci.p.ho)

ep9.atci.p.ho<-ep(mut9.atci.p.ho,a9.ci.p.ho)
david9.atci.p.ho<-DS(mat9.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atci.p.ho<-cbind(ordrank.9.atci.p.ho,ds=david9.atci.p.ho$normDS)
lm9.atci.p.ho<-summary(lm(ordrank.9.atci.p.ho$ds~ordrank.9.atci.p.ho$ord.rank))
s9.atci.p.ho<-lm9.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atci.p.ho<-data.frame(X1=attacks.atci.p.ho[[28]],X2=attacks.atci.p.ho[[29]],Victories=attacks.atci.p.ho[[30]])
mat10.atci.p.ho<-inter.mat(mut10.atci.p.ho)
tri10.atci.p.ho<-tr.tri(mat10.atci.p.ho)
dci10.atci.p.ho<-DCindex(mat10.atci.p.ho)
mat10.atci.p.ho[is.na(mat10.atci.p.ho)] = 0
h10.atci.p.ho<-h.index(mat10.atci.p.ho)

ep10.atci.p.ho<-ep(mut10.atci.p.ho,a10.ci.p.ho)
david10.atci.p.ho<-DS(mat10.atci.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.atci.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atci.p.ho<-cbind(ordrank.10.atci.p.ho,ds=david10.atci.p.ho$normDS)
lm10.atci.p.ho<-summary(lm(ordrank.10.atci.p.ho$ds~ordrank.10.atci.p.ho$ord.rank))
s10.atci.p.ho<-lm10.atci.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atci.p.ho<-sum(mut1.atci.p.ho$Victories)
int2.atci.p.ho<-sum(mut2.atci.p.ho$Victories)
int3.atci.p.ho<-sum(mut3.atci.p.ho$Victories)
int4.atci.p.ho<-sum(mut4.atci.p.ho$Victories)
int5.atci.p.ho<-sum(mut5.atci.p.ho$Victories)
int6.atci.p.ho<-sum(mut6.atci.p.ho$Victories)
int7.atci.p.ho<-sum(mut7.atci.p.ho$Victories)
int8.atci.p.ho<-sum(mut8.atci.p.ho$Victories)
int9.atci.p.ho<-sum(mut9.atci.p.ho$Victories)
int10.atci.p.ho<-sum(mut10.atci.p.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ci.p.ho<-sum(a1.ci.p.ho$Victories)
av2.ci.p.ho<-sum(a2.ci.p.ho$Victories)
av3.ci.p.ho<-sum(a3.ci.p.ho$Victories)
av4.ci.p.ho<-sum(a4.ci.p.ho$Victories)
av5.ci.p.ho<-sum(a5.ci.p.ho$Victories)
av6.ci.p.ho<-sum(a6.ci.p.ho$Victories)
av7.ci.p.ho<-sum(a7.ci.p.ho$Victories)
av8.ci.p.ho<-sum(a8.ci.p.ho$Victories)
av9.ci.p.ho<-sum(a9.ci.p.ho$Victories)
av10.ci.p.ho<-sum(a10.ci.p.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.ic.p<-(sum(av1.ci.p.ho, av2.ci.p.ho, av3.ci.p.ho, av4.ci.p.ho, av5.ci.p.ho, av6.ci.p.ho, av7.ci.p.ho, av8.ci.p.ho, av9.ci.p.ho, av10.ci.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.ic.p<-(sum(int1.atci.p.ho, int2.atci.p.ho, int3.atci.p.ho, int4.atci.p.ho, int5.atci.p.ho, int6.atci.p.ho, int7.atci.p.ho, int8.atci.p.ho, int9.atci.p.ho, int10.atci.p.ho))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.c.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atci.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atci.p.ho<-e1.atci.p.ho[order(e1.atci.p.ho$ID),]
e1.atci.p.ho<-as.matrix(t(e1.1.atci.p.ho))

e2.atci.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atci.p.ho<-e2.atci.p.ho[order(e2.atci.p.ho$ID),]
e2.atci.p.ho<-as.matrix(t(e2.1.atci.p.ho))

e3.atci.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atci.p.ho<-e3.atci.p.ho[order(e3.atci.p.ho$ID),]
e3.atci.p.ho<-as.matrix(t(e3.1.atci.p.ho))

e4.atci.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atci.p.ho<-e4.atci.p.ho[order(e4.atci.p.ho$ID),]
e4.atci.p.ho<-as.matrix(t(e4.1.atci.p.ho))

e5.atci.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atci.p.ho<-e5.atci.p.ho[order(e5.atci.p.ho$ID),]
e5.atci.p.ho<-as.matrix(t(e5.1.atci.p.ho))

e6.atci.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atci.p.ho<-e6.atci.p.ho[order(e6.atci.p.ho$ID),]
e6.atci.p.ho<-as.matrix(t(e6.1.atci.p.ho))

e7.atci.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atci.p.ho<-e7.atci.p.ho[order(e7.atci.p.ho$ID),]
e7.atci.p.ho<-as.matrix(t(e7.1.atci.p.ho))

e8.atci.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atci.p.ho<-e8.atci.p.ho[order(e8.atci.p.ho$ID),]
e8.atci.p.ho<-as.matrix(t(e8.1.atci.p.ho))

e9.atci.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atci.p.ho<-e9.atci.p.ho[order(e9.atci.p.ho$ID),]
e9.atci.p.ho<-as.matrix(t(e9.1.atci.p.ho))

e10.atci.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atci.p.ho<-e10.atci.p.ho[order(e10.atci.p.ho$ID),]
e10.atci.p.ho<-as.matrix(t(e10.1.atci.p.ho))

energy.ho.atci.p.ho<-as.data.frame(matrix(c(e1.atci.p.ho,e2.atci.p.ho,e3.atci.p.ho,e4.atci.p.ho,e5.atci.p.ho,e6.atci.p.ho,e7.atci.p.ho,e8.atci.p.ho,e9.atci.p.ho,e10.atci.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.atci.p.ho<-data.frame(ID=energy.ho.atci.p.ho$V1,energy_over_distance=energy.ho.atci.p.ho$V2,energy_over_time=energy.ho.atci.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atci.p.ho<-david1.atci.p.ho[order(david1.atci.p.ho$ID),]
david1.atci.p.ho<-as.matrix(t(david1.1.atci.p.ho))

david2.1.atci.p.ho<-david2.atci.p.ho[order(david2.atci.p.ho$ID),]
david2.atci.p.ho<-as.matrix(t(david2.1.atci.p.ho))

david3.1.atci.p.ho<-david3.atci.p.ho[order(david3.atci.p.ho$ID),]
david3.atci.p.ho<-as.matrix(t(david3.1.atci.p.ho))

david4.1.atci.p.ho<-david4.atci.p.ho[order(david4.atci.p.ho$ID),]
david4.atci.p.ho<-as.matrix(t(david4.1.atci.p.ho))

david5.1.atci.p.ho<-david5.atci.p.ho[order(david5.atci.p.ho$ID),]
david5.atci.p.ho<-as.matrix(t(david5.1.atci.p.ho))

david6.1.atci.p.ho<-david6.atci.p.ho[order(david6.atci.p.ho$ID),]
david6.atci.p.ho<-as.matrix(t(david6.1.atci.p.ho))

david7.1.atci.p.ho<-david7.atci.p.ho[order(david7.atci.p.ho$ID),]
david7.atci.p.ho<-as.matrix(t(david7.1.atci.p.ho))

david8.1.atci.p.ho<-david8.atci.p.ho[order(david8.atci.p.ho$ID),]
david8.atci.p.ho<-as.matrix(t(david8.1.atci.p.ho))

david9.1.atci.p.ho<-david9.atci.p.ho[order(david9.atci.p.ho$ID),]
david9.atci.p.ho<-as.matrix(t(david9.1.atci.p.ho))

david10.1.atci.p.ho<-david10.atci.p.ho[order(david10.atci.p.ho$ID),]
david10.atci.p.ho<-as.matrix(t(david10.1.atci.p.ho))

david.ho.atci.p.ho<-as.data.frame(matrix(c(david1.atci.p.ho,david2.atci.p.ho,david3.atci.p.ho,david4.atci.p.ho,david5.atci.p.ho,david6.atci.p.ho,david7.atci.p.ho,david8.atci.p.ho,david9.atci.p.ho,david10.atci.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.atci.p.ho<-data.frame(ID=david.ho.atci.p.ho$V1,DS=david.ho.atci.p.ho$V2,normDS=david.ho.atci.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.atci.p.ho<-lm(e1.1.atci.p.ho$energy_over_time~as.numeric(david1.1.atci.p.ho$normDS))
ho.lm.1.s.atci.p.ho<-summary(lm.ho.1.atci.p.ho)$coefficients
ho.1.slope.atci.p.ho<-ho.lm.1.s.atci.p.ho[2,1]
lm.ho.2.atci.p.ho<-lm(e2.1.atci.p.ho$energy_over_time~as.numeric(david2.1.atci.p.ho$normDS))
ho.lm.2.s.atci.p.ho<-summary(lm.ho.2.atci.p.ho)$coefficients
ho.2.slope.atci.p.ho<-ho.lm.2.s.atci.p.ho[2,1]
lm.ho.3.atci.p.ho<-lm(e3.1.atci.p.ho$energy_over_time~as.numeric(david3.1.atci.p.ho$normDS))
ho.lm.3.s.atci.p.ho<-summary(lm.ho.3.atci.p.ho)$coefficients
ho.3.slope.atci.p.ho<-ho.lm.3.s.atci.p.ho[2,1]
lm.ho.4.atci.p.ho<-lm(e4.1.atci.p.ho$energy_over_time~as.numeric(david4.1.atci.p.ho$normDS))
ho.lm.4.s.atci.p.ho<-summary(lm.ho.4.atci.p.ho)$coefficients
ho.4.slope.atci.p.ho<-ho.lm.4.s.atci.p.ho[2,1]
lm.ho.5.atci.p.ho<-lm(e5.1.atci.p.ho$energy_over_time~as.numeric(david5.1.atci.p.ho$normDS))
ho.lm.5.s.atci.p.ho<-summary(lm.ho.5.atci.p.ho)$coefficients
ho.5.slope.atci.p.ho<-ho.lm.5.s.atci.p.ho[2,1]
lm.ho.6.atci.p.ho<-lm(e6.1.atci.p.ho$energy_over_time~as.numeric(david6.1.atci.p.ho$normDS))
ho.lm.6.s.atci.p.ho<-summary(lm.ho.6.atci.p.ho)$coefficients
ho.6.slope.atci.p.ho<-ho.lm.6.s.atci.p.ho[2,1]
lm.ho.7.atci.p.ho<-lm(e7.1.atci.p.ho$energy_over_time~as.numeric(david7.1.atci.p.ho$normDS))
ho.lm.7.s.atci.p.ho<-summary(lm.ho.7.atci.p.ho)$coefficients
ho.7.slope.atci.p.ho<-ho.lm.7.s.atci.p.ho[2,1]
lm.ho.8.atci.p.ho<-lm(e8.1.atci.p.ho$energy_over_time~as.numeric(david8.1.atci.p.ho$normDS))
ho.lm.8.s.atci.p.ho<-summary(lm.ho.8.atci.p.ho)$coefficients
ho.8.slope.atci.p.ho<-ho.lm.8.s.atci.p.ho[2,1]
lm.ho.9.atci.p.ho<-lm(e9.1.atci.p.ho$energy_over_time~as.numeric(david9.1.atci.p.ho$normDS))
ho.lm.9.s.atci.p.ho<-summary(lm.ho.9.atci.p.ho)$coefficients
ho.9.slope.atci.p.ho<-ho.lm.9.s.atci.p.ho[2,1]
lm.ho.10.atci.p.ho<-lm(e10.1.atci.p.ho$energy_over_time~as.numeric(david10.1.atci.p.ho$normDS))
ho.lm.10.s.atci.p.ho<-summary(lm.ho.10.atci.p.ho)$coefficients
ho.10.slope.atci.p.ho<-ho.lm.10.s.atci.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.atci.p.ss.attacks.atci.p.ho<-data.frame(triangle.transitivity=c(tri1.atci.p.ho,tri2.atci.p.ho,tri3.atci.p.ho,tri4.atci.p.ho,tri5.atci.p.ho,tri6.atci.p.ho,tri7.atci.p.ho,tri8.atci.p.ho,tri9.atci.p.ho,tri10.atci.p.ho),escalation=c(ep1.atci.p.ho,ep2.atci.p.ho,ep3.atci.p.ho,ep4.atci.p.ho,ep5.atci.p.ho,ep6.atci.p.ho,ep7.atci.p.ho,ep8.atci.p.ho,ep9.atci.p.ho,ep10.atci.p.ho),dci=c(dci1.atci.p.ho,dci2.atci.p.ho,dci3.atci.p.ho,dci4.atci.p.ho,dci5.atci.p.ho,dci6.atci.p.ho,dci7.atci.p.ho,dci8.atci.p.ho,dci9.atci.p.ho,dci10.atci.p.ho),steepness=c(s1.atci.p.ho,s2.atci.p.ho,s3.atci.p.ho,s4.atci.p.ho,s5.atci.p.ho,s6.atci.p.ho,s7.atci.p.ho,s8.atci.p.ho,s9.atci.p.ho,s10.atci.p.ho),slope=c(ho.1.slope.atci.p.ho,ho.2.slope.atci.p.ho,ho.3.slope.atci.p.ho,ho.4.slope.atci.p.ho,ho.5.slope.atci.p.ho,ho.6.slope.atci.p.ho,ho.7.slope.atci.p.ho,ho.8.slope.atci.p.ho,ho.9.slope.atci.p.ho,ho.10.slope.atci.p.ho))
```
```{r Attacks Clumped Probabilistic Data Frame}
#knowledge mutual
km.tt.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$triangle.transitivity)
km.ic.pi.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$dci)
km.esc.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$escalation)
km.steep.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$steepness)
km.slope.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$slope)
km.mean.ic.p.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ic.p.attacks,dci=km.ic.pi.ic.p.attacks,esc=km.esc.ic.p.attacks,steepness=km.steep.ic.p.attacks,slope=km.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$triangle.transitivity)
ks.ic.pi.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$dci)
ks.esc.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$escalation)
ks.steep.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$steepness)
ks.slope.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$slope)
ks.mean.ic.p.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.ic.p.attacks,dci=ks.ic.pi.ic.p.attacks,esc=ks.esc.ic.p.attacks,steepness=ks.steep.ic.p.attacks,slope=ks.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$triangle.transitivity)
ko.ic.pi.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$dci)
ko.esc.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$escalation)
ko.steep.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$steepness)
ko.slope.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$slope)
ko.mean.ic.p.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.ic.p.attacks,dci=ko.ic.pi.ic.p.attacks,esc=ko.esc.ic.p.attacks,steepness=ko.steep.ic.p.attacks,slope=ko.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$triangle.transitivity)
hm.ic.pi.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$dci)
hm.esc.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$escalation)
hm.steep.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$steepness)
hm.slope.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$slope)
hm.mean.ic.p.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.ic.p.attacks,dci=hm.ic.pi.ic.p.attacks,esc=hm.esc.ic.p.attacks,steepness=hm.steep.ic.p.attacks,slope=hm.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$triangle.transitivity)
hs.ic.pi.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$dci)
hs.esc.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$escalation)
hs.steep.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$steepness)
hs.slope.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$slope)
hs.mean.ic.p.attacks<-data.frame(scenario="History self",tt=hs.tt.ic.p.attacks,dci=hs.ic.pi.ic.p.attacks,esc=hs.esc.ic.p.attacks,steepness=hs.steep.ic.p.attacks,slope=hs.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$triangle.transitivity)
ho.ic.pi.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$dci)
ho.esc.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$escalation)
ho.steep.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$steepness)
ho.slope.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$slope)
ho.mean.ic.p.attacks<-data.frame(scenario="History opponent",tt=ho.tt.ic.p.attacks,dci=ho.ic.pi.ic.p.attacks,esc=ho.esc.ic.p.attacks,steepness=ho.steep.ic.p.attacks,slope=ho.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.ic.p.attacks,ks.mean.ic.p.attacks,ko.mean.ic.p.attacks,hm.mean.ic.p.attacks,hs.mean.ic.p.attacks,ho.mean.ic.p.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$triangle.transitivity)
km.ic.pi.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$dci)
km.esc.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$escalation)
km.steep.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$steepness)
km.slope.ic.p.attacks<-mean(km.atci.p.ss.attacks.atci.p.km$slope)
km.mean.ic.p.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.ic.p.attacks,dci=km.ic.pi.ic.p.attacks,esc=km.esc.ic.p.attacks,steepness=km.steep.ic.p.attacks,slope=km.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$triangle.transitivity)
ks.ic.pi.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$dci)
ks.esc.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$escalation)
ks.steep.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$steepness)
ks.slope.ic.p.attacks<-mean(ks.atci.p.ss.attacks.atci.p.ks$slope)
ks.mean.ic.p.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.ic.p.attacks,dci=ks.ic.pi.ic.p.attacks,esc=ks.esc.ic.p.attacks,steepness=ks.steep.ic.p.attacks,slope=ks.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$triangle.transitivity)
ko.ic.pi.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$dci)
ko.esc.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$escalation)
ko.steep.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$steepness)
ko.slope.ic.p.attacks<-mean(ko.atci.p.ss.attacks.atci.p.ko$slope)
ko.mean.ic.p.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.ic.p.attacks,dci=ko.ic.pi.ic.p.attacks,esc=ko.esc.ic.p.attacks,steepness=ko.steep.ic.p.attacks,slope=ko.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$triangle.transitivity)
hm.ic.pi.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$dci)
hm.esc.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$escalation)
hm.steep.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$steepness)
hm.slope.ic.p.attacks<-mean(hm.atci.p.ss.attacks.atci.p.hm$slope)
hm.mean.ic.p.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.ic.p.attacks,dci=hm.ic.pi.ic.p.attacks,esc=hm.esc.ic.p.attacks,steepness=hm.steep.ic.p.attacks,slope=hm.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$triangle.transitivity)
hs.ic.pi.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$dci)
hs.esc.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$escalation)
hs.steep.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$steepness)
hs.slope.ic.p.attacks<-mean(hs.atci.p.ss.attacks.atci.p.hs$slope)
hs.mean.ic.p.attacks<-data.frame(scenario="History self",tt=hs.tt.ic.p.attacks,dci=hs.ic.pi.ic.p.attacks,esc=hs.esc.ic.p.attacks,steepness=hs.steep.ic.p.attacks,slope=hs.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$triangle.transitivity)
ho.ic.pi.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$dci)
ho.esc.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$escalation)
ho.steep.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$steepness)
ho.slope.ic.p.attacks<-mean(ho.atci.p.ss.attacks.atci.p.ho$slope)
ho.mean.ic.p.attacks<-data.frame(scenario="History opponent",tt=ho.tt.ic.p.attacks,dci=ho.ic.pi.ic.p.attacks,esc=ho.esc.ic.p.attacks,steepness=ho.steep.ic.p.attacks,slope=ho.slope.ic.p.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.ic.p.attacks,ks.mean.ic.p.attacks,ko.mean.ic.p.attacks,hm.mean.ic.p.attacks,hs.mean.ic.p.attacks,ho.mean.ic.p.attacks)

#create overall dataframe of summary statistics
overall.clumped.attacks.initiator<-data.frame(km.atci.p.ss.attacks.atci.p.km)
overall.clumped.attacks.initiator<-rbind(overall.clumped.attacks.initiator,ks.atci.p.ss.attacks.atci.p.ks)
overall.clumped.attacks.initiator<-rbind(overall.clumped.attacks.initiator,ko.atci.p.ss.attacks.atci.p.ko)
overall.clumped.attacks.initiator<-rbind(overall.clumped.attacks.initiator,hm.atci.p.ss.attacks.atci.p.hm)
overall.clumped.attacks.initiator<-rbind(overall.clumped.attacks.initiator,hs.atci.p.ss.attacks.atci.p.hs)
overall.clumped.attacks.initiator<-rbind(overall.clumped.attacks.initiator,ho.atci.p.ss.attacks.atci.p.ho)

overall.clumped.attacks.initiator<-cbind(overall.clumped.attacks.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.clumped.attacks.initiator<-cbind(overall.clumped.attacks.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("prob",60))


rhp.ss.attacks.ci.p<-overall.clumped.attacks.initiator[overall.clumped.attacks.initiator$variable=="rhp",]
history.ss.attacks.ci.p<-overall.clumped.attacks.initiator[overall.clumped.attacks.initiator$variable=="history",]

overall.clumped.attacks.initiator$combo<-paste(overall.clumped.attacks.initiator$strategy,overall.clumped.attacks.initiator$variable,overall.clumped.attacks.initiator$distribution)
overall.clumped.attacks.initiator$combo2<-paste(overall.clumped.attacks.initiator$strategy,overall.clumped.attacks.initiator$variable)
```

## Uniform Initiator Wins Probabilistic Data
```{r Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.km<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.p.km<-data.frame(X1=avoid.ui.p.km[[1]],X2=avoid.ui.p.km[[2]],Avoids=avoid.ui.p.km[[3]])
a2.ui.p.km<-data.frame(X1=avoid.ui.p.km[[4]],X2=avoid.ui.p.km[[5]],Avoids=avoid.ui.p.km[[6]])
a3.ui.p.km<-data.frame(X1=avoid.ui.p.km[[7]],X2=avoid.ui.p.km[[8]],Avoids=avoid.ui.p.km[[9]])
a4.ui.p.km<-data.frame(X1=avoid.ui.p.km[[10]],X2=avoid.ui.p.km[[11]],Avoids=avoid.ui.p.km[[12]])
a5.ui.p.km<-data.frame(X1=avoid.ui.p.km[[13]],X2=avoid.ui.p.km[[14]],Avoids=avoid.ui.p.km[[15]])
a6.ui.p.km<-data.frame(X1=avoid.ui.p.km[[16]],X2=avoid.ui.p.km[[17]],Avoids=avoid.ui.p.km[[18]])
a7.ui.p.km<-data.frame(X1=avoid.ui.p.km[[19]],X2=avoid.ui.p.km[[20]],Avoids=avoid.ui.p.km[[21]])
a8.ui.p.km<-data.frame(X1=avoid.ui.p.km[[22]],X2=avoid.ui.p.km[[23]],Avoids=avoid.ui.p.km[[24]])
a9.ui.p.km<-data.frame(X1=avoid.ui.p.km[[25]],X2=avoid.ui.p.km[[26]],Avoids=avoid.ui.p.km[[27]])
a10.ui.p.km<-data.frame(X1=avoid.ui.p.km[[28]],X2=avoid.ui.p.km[[29]],Avoids=avoid.ui.p.km[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.km.ui.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.km<-data.frame(X1=conflict.km.ui.p[[1]],X2=conflict.km.ui.p[[2]],Victories=conflict.km.ui.p[[3]])
mat1.ui.p.km<-inter.mat(mut1.ui.p.km)
tri1.ui.p.km<-tr.tri(mat1.ui.p.km)
dci1.ui.p.km<-DCindex(mat1.ui.p.km)
mat1.ui.p.km[is.na(mat1.ui.p.km)] = 0
h1.ui.p.km<-h.index(mat1.ui.p.km)

ep1.ui.p.km<-ep(mut1.ui.p.km,a1.ui.p.km)
david1.ui.p.km<-DS(mat1.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.km<-cbind(ordrank.1.ui.p.km,ds=david1.ui.p.km$normDS)
lm1.ui.p.km<-summary(lm(ordrank.1.ui.p.km$ds~ordrank.1.ui.p.km$ord.rank))
s1.ui.p.km<-lm1.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.km<-data.frame(X1=conflict.km.ui.p[[4]],X2=conflict.km.ui.p[[5]],Victories=conflict.km.ui.p[[6]])
mat2.ui.p.km<-inter.mat(mut2.ui.p.km)
tri2.ui.p.km<-tr.tri(mat2.ui.p.km)
dci2.ui.p.km<-DCindex(mat2.ui.p.km)
mat2.ui.p.km[is.na(mat2.ui.p.km)] = 0
h2.ui.p.km<-h.index(mat2.ui.p.km)

ep2.ui.p.km<-ep(mut2.ui.p.km,a2.ui.p.km)
david2.ui.p.km<-DS(mat2.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.km<-cbind(ordrank.2.ui.p.km,ds=david2.ui.p.km$normDS)
lm2.ui.p.km<-summary(lm(ordrank.2.ui.p.km$ds~ordrank.2.ui.p.km$ord.rank))
s2.ui.p.km<-lm2.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.km<-data.frame(X1=conflict.km.ui.p[[7]],X2=conflict.km.ui.p[[8]],Victories=conflict.km.ui.p[[9]])
mat3.ui.p.km<-inter.mat(mut3.ui.p.km)
tri3.ui.p.km<-tr.tri(mat3.ui.p.km)
dci3.ui.p.km<-DCindex(mat3.ui.p.km)
mat3.ui.p.km[is.na(mat3.ui.p.km)] = 0
h3.ui.p.km<-h.index(mat3.ui.p.km)

ep3.ui.p.km<-ep(mut3.ui.p.km,a3.ui.p.km)
david3.ui.p.km<-DS(mat3.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.km<-cbind(ordrank.3.ui.p.km,ds=david3.ui.p.km$normDS)
lm3.ui.p.km<-summary(lm(ordrank.3.ui.p.km$ds~ordrank.3.ui.p.km$ord.rank))
s3.ui.p.km<-lm3.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.km<-data.frame(X1=conflict.km.ui.p[[10]],X2=conflict.km.ui.p[[11]],Victories=conflict.km.ui.p[[12]])
mat4.ui.p.km<-inter.mat(mut4.ui.p.km)
tri4.ui.p.km<-tr.tri(mat4.ui.p.km)
dci4.ui.p.km<-DCindex(mat4.ui.p.km)
mat4.ui.p.km[is.na(mat4.ui.p.km)] = 0
h4.ui.p.km<-h.index(mat4.ui.p.km)

ep4.ui.p.km<-ep(mut4.ui.p.km,a4.ui.p.km)
david4.ui.p.km<-DS(mat4.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.km<-cbind(ordrank.4.ui.p.km,ds=david4.ui.p.km$normDS)
lm4.ui.p.km<-summary(lm(ordrank.4.ui.p.km$ds~ordrank.4.ui.p.km$ord.rank))
s4.ui.p.km<-lm4.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.km<-data.frame(X1=conflict.km.ui.p[[13]],X2=conflict.km.ui.p[[14]],Victories=conflict.km.ui.p[[15]])
mat5.ui.p.km<-inter.mat(mut5.ui.p.km)
tri5.ui.p.km<-tr.tri(mat5.ui.p.km)
dci5.ui.p.km<-DCindex(mat5.ui.p.km)
mat5.ui.p.km[is.na(mat5.ui.p.km)] = 0
h5.ui.p.km<-h.index(mat5.ui.p.km)

ep5.ui.p.km<-ep(mut5.ui.p.km,a5.ui.p.km)
david5.ui.p.km<-DS(mat5.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.km<-cbind(ordrank.5.ui.p.km,ds=david5.ui.p.km$normDS)
lm5.ui.p.km<-summary(lm(ordrank.5.ui.p.km$ds~ordrank.5.ui.p.km$ord.rank))
s5.ui.p.km<-lm5.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.km<-data.frame(X1=conflict.km.ui.p[[16]],X2=conflict.km.ui.p[[17]],Victories=conflict.km.ui.p[[18]])
mat6.ui.p.km<-inter.mat(mut6.ui.p.km)
tri6.ui.p.km<-tr.tri(mat6.ui.p.km)
dci6.ui.p.km<-DCindex(mat6.ui.p.km)
mat6.ui.p.km[is.na(mat6.ui.p.km)] = 0
h6.ui.p.km<-h.index(mat6.ui.p.km)

ep6.ui.p.km<-ep(mut6.ui.p.km,a6.ui.p.km)
david6.ui.p.km<-DS(mat6.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.km<-cbind(ordrank.6.ui.p.km,ds=david6.ui.p.km$normDS)
lm6.ui.p.km<-summary(lm(ordrank.6.ui.p.km$ds~ordrank.6.ui.p.km$ord.rank))
s6.ui.p.km<-lm6.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.km<-data.frame(X1=conflict.km.ui.p[[19]],X2=conflict.km.ui.p[[20]],Victories=conflict.km.ui.p[[21]])
mat7.ui.p.km<-inter.mat(mut7.ui.p.km)
tri7.ui.p.km<-tr.tri(mat7.ui.p.km)
dci7.ui.p.km<-DCindex(mat7.ui.p.km)
mat7.ui.p.km[is.na(mat7.ui.p.km)] = 0
h7.ui.p.km<-h.index(mat7.ui.p.km)

ep7.ui.p.km<-ep(mut7.ui.p.km,a7.ui.p.km)
david7.ui.p.km<-DS(mat7.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.km<-cbind(ordrank.7.ui.p.km,ds=david7.ui.p.km$normDS)
lm7.ui.p.km<-summary(lm(ordrank.7.ui.p.km$ds~ordrank.7.ui.p.km$ord.rank))
s7.ui.p.km<-lm7.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.km<-data.frame(X1=conflict.km.ui.p[[22]],X2=conflict.km.ui.p[[23]],Victories=conflict.km.ui.p[[24]])
mat8.ui.p.km<-inter.mat(mut8.ui.p.km)
tri8.ui.p.km<-tr.tri(mat8.ui.p.km)
dci8.ui.p.km<-DCindex(mat8.ui.p.km)
mat8.ui.p.km[is.na(mat8.ui.p.km)] = 0
h8.ui.p.km<-h.index(mat8.ui.p.km)

ep8.ui.p.km<-ep(mut8.ui.p.km,a8.ui.p.km)
david8.ui.p.km<-DS(mat8.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.km<-cbind(ordrank.8.ui.p.km,ds=david8.ui.p.km$normDS)
lm8.ui.p.km<-summary(lm(ordrank.8.ui.p.km$ds~ordrank.8.ui.p.km$ord.rank))
s8.ui.p.km<-lm8.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.km<-data.frame(X1=conflict.km.ui.p[[25]],X2=conflict.km.ui.p[[26]],Victories=conflict.km.ui.p[[27]])
mat9.ui.p.km<-inter.mat(mut9.ui.p.km)
tri9.ui.p.km<-tr.tri(mat9.ui.p.km)
dci9.ui.p.km<-DCindex(mat9.ui.p.km)
mat9.ui.p.km[is.na(mat9.ui.p.km)] = 0
h9.ui.p.km<-h.index(mat9.ui.p.km)

ep9.ui.p.km<-ep(mut9.ui.p.km,a9.ui.p.km)
david9.ui.p.km<-DS(mat9.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.km<-cbind(ordrank.9.ui.p.km,ds=david9.ui.p.km$normDS)
lm9.ui.p.km<-summary(lm(ordrank.9.ui.p.km$ds~ordrank.9.ui.p.km$ord.rank))
s9.ui.p.km<-lm9.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.km<-data.frame(X1=conflict.km.ui.p[[28]],X2=conflict.km.ui.p[[29]],Victories=conflict.km.ui.p[[30]])
mat10.ui.p.km<-inter.mat(mut10.ui.p.km)
tri10.ui.p.km<-tr.tri(mat10.ui.p.km)
dci10.ui.p.km<-DCindex(mat10.ui.p.km)
mat10.ui.p.km[is.na(mat10.ui.p.km)] = 0
h10.ui.p.km<-h.index(mat10.ui.p.km)

ep10.ui.p.km<-ep(mut10.ui.p.km,a10.ui.p.km)
david10.ui.p.km<-DS(mat10.ui.p.km) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.km<-cbind(ordrank.10.ui.p.km,ds=david10.ui.p.km$normDS)
lm10.ui.p.km<-summary(lm(ordrank.10.ui.p.km$ds~ordrank.10.ui.p.km$ord.rank))
s10.ui.p.km<-lm10.ui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.km<-sum(mut1.ui.p.km$Victories)
int2.ui.p.km<-sum(mut2.ui.p.km$Victories)
int3.ui.p.km<-sum(mut3.ui.p.km$Victories)
int4.ui.p.km<-sum(mut4.ui.p.km$Victories)
int5.ui.p.km<-sum(mut5.ui.p.km$Victories)
int6.ui.p.km<-sum(mut6.ui.p.km$Victories)
int7.ui.p.km<-sum(mut7.ui.p.km$Victories)
int8.ui.p.km<-sum(mut8.ui.p.km$Victories)
int9.ui.p.km<-sum(mut9.ui.p.km$Victories)
int10.ui.p.km<-sum(mut10.ui.p.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.km<-sum(a1.ui.p.km$Victories)
av2.ui.p.km<-sum(a2.ui.p.km$Victories)
av3.ui.p.km<-sum(a3.ui.p.km$Victories)
av4.ui.p.km<-sum(a4.ui.p.km$Victories)
av5.ui.p.km<-sum(a5.ui.p.km$Victories)
av6.ui.p.km<-sum(a6.ui.p.km$Victories)
av7.ui.p.km<-sum(a7.ui.p.km$Victories)
av8.ui.p.km<-sum(a8.ui.p.km$Victories)
av9.ui.p.km<-sum(a9.ui.p.km$Victories)
av10.ui.p.km<-sum(a10.ui.p.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.iu.p<-(sum(av1.ui.p.km, av2.ui.p.km, av3.ui.p.km, av4.ui.p.km, av5.ui.p.km, av6.ui.p.km, av7.ui.p.km, av8.ui.p.km, av9.ui.p.km, av10.ui.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.iu.p<-(sum(int1.ui.p.km, int2.ui.p.km, int3.ui.p.km, int4.ui.p.km, int5.ui.p.km, int6.ui.p.km, int7.ui.p.km, int8.ui.p.km, int9.ui.p.km, int10.ui.p.km))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.p.km<-e1.ui.p.km[order(e1.ui.p.km$ID),]
e1.ui.p.km<-as.matrix(t(e1.1.ui.p.km))

e2.ui.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.p.km<-e2.ui.p.km[order(e2.ui.p.km$ID),]
e2.ui.p.km<-as.matrix(t(e2.1.ui.p.km))

e3.ui.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.p.km<-e3.ui.p.km[order(e3.ui.p.km$ID),]
e3.ui.p.km<-as.matrix(t(e3.1.ui.p.km))

e4.ui.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.p.km<-e4.ui.p.km[order(e4.ui.p.km$ID),]
e4.ui.p.km<-as.matrix(t(e4.1.ui.p.km))

e5.ui.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.p.km<-e5.ui.p.km[order(e5.ui.p.km$ID),]
e5.ui.p.km<-as.matrix(t(e5.1.ui.p.km))

e6.ui.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.p.km<-e6.ui.p.km[order(e6.ui.p.km$ID),]
e6.ui.p.km<-as.matrix(t(e6.1.ui.p.km))

e7.ui.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.p.km<-e7.ui.p.km[order(e7.ui.p.km$ID),]
e7.ui.p.km<-as.matrix(t(e7.1.ui.p.km))

e8.ui.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.p.km<-e8.ui.p.km[order(e8.ui.p.km$ID),]
e8.ui.p.km<-as.matrix(t(e8.1.ui.p.km))

e9.ui.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.p.km<-e9.ui.p.km[order(e9.ui.p.km$ID),]
e9.ui.p.km<-as.matrix(t(e9.1.ui.p.km))

e10.ui.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.p.km<-e10.ui.p.km[order(e10.ui.p.km$ID),]
e10.ui.p.km<-as.matrix(t(e10.1.ui.p.km))

energy.km.ui.p.km<-as.data.frame(matrix(c(e1.ui.p.km,e2.ui.p.km,e3.ui.p.km,e4.ui.p.km,e5.ui.p.km,e6.ui.p.km,e7.ui.p.km,e8.ui.p.km,e9.ui.p.km,e10.ui.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.ui.p.km<-data.frame(ID=energy.km.ui.p.km$V1,energy_over_distance=energy.km.ui.p.km$V2,energy_over_time=energy.km.ui.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.km<-david1.ui.p.km[order(david1.ui.p.km$ID),]
david1.ui.p.km<-as.matrix(t(david1.1.ui.p.km))

david2.1.ui.p.km<-david2.ui.p.km[order(david2.ui.p.km$ID),]
david2.ui.p.km<-as.matrix(t(david2.1.ui.p.km))

david3.1.ui.p.km<-david3.ui.p.km[order(david3.ui.p.km$ID),]
david3.ui.p.km<-as.matrix(t(david3.1.ui.p.km))

david4.1.ui.p.km<-david4.ui.p.km[order(david4.ui.p.km$ID),]
david4.ui.p.km<-as.matrix(t(david4.1.ui.p.km))

david5.1.ui.p.km<-david5.ui.p.km[order(david5.ui.p.km$ID),]
david5.ui.p.km<-as.matrix(t(david5.1.ui.p.km))

david6.1.ui.p.km<-david6.ui.p.km[order(david6.ui.p.km$ID),]
david6.ui.p.km<-as.matrix(t(david6.1.ui.p.km))

david7.1.ui.p.km<-david7.ui.p.km[order(david7.ui.p.km$ID),]
david7.ui.p.km<-as.matrix(t(david7.1.ui.p.km))

david8.1.ui.p.km<-david8.ui.p.km[order(david8.ui.p.km$ID),]
david8.ui.p.km<-as.matrix(t(david8.1.ui.p.km))

david9.1.ui.p.km<-david9.ui.p.km[order(david9.ui.p.km$ID),]
david9.ui.p.km<-as.matrix(t(david9.1.ui.p.km))

david10.1.ui.p.km<-david10.ui.p.km[order(david10.ui.p.km$ID),]
david10.ui.p.km<-as.matrix(t(david10.1.ui.p.km))

david.km.ui.p.km<-as.data.frame(matrix(c(david1.ui.p.km,david2.ui.p.km,david3.ui.p.km,david4.ui.p.km,david5.ui.p.km,david6.ui.p.km,david7.ui.p.km,david8.ui.p.km,david9.ui.p.km,david10.ui.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.ui.p.km<-data.frame(ID=david.km.ui.p.km$V1,DS=david.km.ui.p.km$V2,normDS=david.km.ui.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.ui.p.km<-lm(e1.1.ui.p.km$energy_over_time~as.numeric(david1.1.ui.p.km$normDS))
km.lm.1.s.ui.p.km<-summary(lm.km.1.ui.p.km)$coefficients
km.1.slope.ui.p.km<-km.lm.1.s.ui.p.km[2,1]
lm.km.2.ui.p.km<-lm(e2.1.ui.p.km$energy_over_time~as.numeric(david2.1.ui.p.km$normDS))
km.lm.2.s.ui.p.km<-summary(lm.km.2.ui.p.km)$coefficients
km.2.slope.ui.p.km<-km.lm.2.s.ui.p.km[2,1]
lm.km.3.ui.p.km<-lm(e3.1.ui.p.km$energy_over_time~as.numeric(david3.1.ui.p.km$normDS))
km.lm.3.s.ui.p.km<-summary(lm.km.3.ui.p.km)$coefficients
km.3.slope.ui.p.km<-km.lm.3.s.ui.p.km[2,1]
lm.km.4.ui.p.km<-lm(e4.1.ui.p.km$energy_over_time~as.numeric(david4.1.ui.p.km$normDS))
km.lm.4.s.ui.p.km<-summary(lm.km.4.ui.p.km)$coefficients
km.4.slope.ui.p.km<-km.lm.4.s.ui.p.km[2,1]
lm.km.5.ui.p.km<-lm(e5.1.ui.p.km$energy_over_time~as.numeric(david5.1.ui.p.km$normDS))
km.lm.5.s.ui.p.km<-summary(lm.km.5.ui.p.km)$coefficients
km.5.slope.ui.p.km<-km.lm.5.s.ui.p.km[2,1]
lm.km.6.ui.p.km<-lm(e6.1.ui.p.km$energy_over_time~as.numeric(david6.1.ui.p.km$normDS))
km.lm.6.s.ui.p.km<-summary(lm.km.6.ui.p.km)$coefficients
km.6.slope.ui.p.km<-km.lm.6.s.ui.p.km[2,1]
lm.km.7.ui.p.km<-lm(e7.1.ui.p.km$energy_over_time~as.numeric(david7.1.ui.p.km$normDS))
km.lm.7.s.ui.p.km<-summary(lm.km.7.ui.p.km)$coefficients
km.7.slope.ui.p.km<-km.lm.7.s.ui.p.km[2,1]
lm.km.8.ui.p.km<-lm(e8.1.ui.p.km$energy_over_time~as.numeric(david8.1.ui.p.km$normDS))
km.lm.8.s.ui.p.km<-summary(lm.km.8.ui.p.km)$coefficients
km.8.slope.ui.p.km<-km.lm.8.s.ui.p.km[2,1]
lm.km.9.ui.p.km<-lm(e9.1.ui.p.km$energy_over_time~as.numeric(david9.1.ui.p.km$normDS))
km.lm.9.s.ui.p.km<-summary(lm.km.9.ui.p.km)$coefficients
km.9.slope.ui.p.km<-km.lm.9.s.ui.p.km[2,1]
lm.km.10.ui.p.km<-lm(e10.1.ui.p.km$energy_over_time~as.numeric(david10.1.ui.p.km$normDS))
km.lm.10.s.ui.p.km<-summary(lm.km.10.ui.p.km)$coefficients
km.10.slope.ui.p.km<-km.lm.10.s.ui.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.km,tri2.ui.p.km,tri3.ui.p.km,tri4.ui.p.km,tri5.ui.p.km,tri6.ui.p.km,tri7.ui.p.km,tri8.ui.p.km,tri9.ui.p.km,tri10.ui.p.km),escalation=c(ep1.ui.p.km,ep2.ui.p.km,ep3.ui.p.km,ep4.ui.p.km,ep5.ui.p.km,ep6.ui.p.km,ep7.ui.p.km,ep8.ui.p.km,ep9.ui.p.km,ep10.ui.p.km),dci=c(dci1.ui.p.km,dci2.ui.p.km,dci3.ui.p.km,dci4.ui.p.km,dci5.ui.p.km,dci6.ui.p.km,dci7.ui.p.km,dci8.ui.p.km,dci9.ui.p.km,dci10.ui.p.km),steepness=c(s1.ui.p.km,s2.ui.p.km,s3.ui.p.km,s4.ui.p.km,s5.ui.p.km,s6.ui.p.km,s7.ui.p.km,s8.ui.p.km,s9.ui.p.km,s10.ui.p.km),slope=c(km.1.slope.ui.p.km,km.2.slope.ui.p.km,km.3.slope.ui.p.km,km.4.slope.ui.p.km,km.5.slope.ui.p.km,km.6.slope.ui.p.km,km.7.slope.ui.p.km,km.8.slope.ui.p.km,km.9.slope.ui.p.km,km.10.slope.ui.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.ks<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[1]],X2=avoid.ui.p.ks[[2]],Avoids=avoid.ui.p.ks[[3]])
a2.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[4]],X2=avoid.ui.p.ks[[5]],Avoids=avoid.ui.p.ks[[6]])
a3.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[7]],X2=avoid.ui.p.ks[[8]],Avoids=avoid.ui.p.ks[[9]])
a4.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[10]],X2=avoid.ui.p.ks[[11]],Avoids=avoid.ui.p.ks[[12]])
a5.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[13]],X2=avoid.ui.p.ks[[14]],Avoids=avoid.ui.p.ks[[15]])
a6.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[16]],X2=avoid.ui.p.ks[[17]],Avoids=avoid.ui.p.ks[[18]])
a7.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[19]],X2=avoid.ui.p.ks[[20]],Avoids=avoid.ui.p.ks[[21]])
a8.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[22]],X2=avoid.ui.p.ks[[23]],Avoids=avoid.ui.p.ks[[24]])
a9.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[25]],X2=avoid.ui.p.ks[[26]],Avoids=avoid.ui.p.ks[[27]])
a10.ui.p.ks<-data.frame(X1=avoid.ui.p.ks[[28]],X2=avoid.ui.p.ks[[29]],Avoids=avoid.ui.p.ks[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ks.ui.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[1]],X2=conflict.ks.ui.p[[2]],Victories=conflict.ks.ui.p[[3]])
mat1.ui.p.ks<-inter.mat(mut1.ui.p.ks)
tri1.ui.p.ks<-tr.tri(mat1.ui.p.ks)
dci1.ui.p.ks<-DCindex(mat1.ui.p.ks)
mat1.ui.p.ks[is.na(mat1.ui.p.ks)] = 0
h1.ui.p.ks<-h.index(mat1.ui.p.ks)

ep1.ui.p.ks<-ep(mut1.ui.p.ks,a1.ui.p.ks)
david1.ui.p.ks<-DS(mat1.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.ks<-cbind(ordrank.1.ui.p.ks,ds=david1.ui.p.ks$normDS)
lm1.ui.p.ks<-summary(lm(ordrank.1.ui.p.ks$ds~ordrank.1.ui.p.ks$ord.rank))
s1.ui.p.ks<-lm1.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[4]],X2=conflict.ks.ui.p[[5]],Victories=conflict.ks.ui.p[[6]])
mat2.ui.p.ks<-inter.mat(mut2.ui.p.ks)
tri2.ui.p.ks<-tr.tri(mat2.ui.p.ks)
dci2.ui.p.ks<-DCindex(mat2.ui.p.ks)
mat2.ui.p.ks[is.na(mat2.ui.p.ks)] = 0
h2.ui.p.ks<-h.index(mat2.ui.p.ks)

ep2.ui.p.ks<-ep(mut2.ui.p.ks,a2.ui.p.ks)
david2.ui.p.ks<-DS(mat2.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.ks<-cbind(ordrank.2.ui.p.ks,ds=david2.ui.p.ks$normDS)
lm2.ui.p.ks<-summary(lm(ordrank.2.ui.p.ks$ds~ordrank.2.ui.p.ks$ord.rank))
s2.ui.p.ks<-lm2.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[7]],X2=conflict.ks.ui.p[[8]],Victories=conflict.ks.ui.p[[9]])
mat3.ui.p.ks<-inter.mat(mut3.ui.p.ks)
tri3.ui.p.ks<-tr.tri(mat3.ui.p.ks)
dci3.ui.p.ks<-DCindex(mat3.ui.p.ks)
mat3.ui.p.ks[is.na(mat3.ui.p.ks)] = 0
h3.ui.p.ks<-h.index(mat3.ui.p.ks)

ep3.ui.p.ks<-ep(mut3.ui.p.ks,a3.ui.p.ks)
david3.ui.p.ks<-DS(mat3.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.ks<-cbind(ordrank.3.ui.p.ks,ds=david3.ui.p.ks$normDS)
lm3.ui.p.ks<-summary(lm(ordrank.3.ui.p.ks$ds~ordrank.3.ui.p.ks$ord.rank))
s3.ui.p.ks<-lm3.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[10]],X2=conflict.ks.ui.p[[11]],Victories=conflict.ks.ui.p[[12]])
mat4.ui.p.ks<-inter.mat(mut4.ui.p.ks)
tri4.ui.p.ks<-tr.tri(mat4.ui.p.ks)
dci4.ui.p.ks<-DCindex(mat4.ui.p.ks)
mat4.ui.p.ks[is.na(mat4.ui.p.ks)] = 0
h4.ui.p.ks<-h.index(mat4.ui.p.ks)

ep4.ui.p.ks<-ep(mut4.ui.p.ks,a4.ui.p.ks)
david4.ui.p.ks<-DS(mat4.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.ks<-cbind(ordrank.4.ui.p.ks,ds=david4.ui.p.ks$normDS)
lm4.ui.p.ks<-summary(lm(ordrank.4.ui.p.ks$ds~ordrank.4.ui.p.ks$ord.rank))
s4.ui.p.ks<-lm4.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[13]],X2=conflict.ks.ui.p[[14]],Victories=conflict.ks.ui.p[[15]])
mat5.ui.p.ks<-inter.mat(mut5.ui.p.ks)
tri5.ui.p.ks<-tr.tri(mat5.ui.p.ks)
dci5.ui.p.ks<-DCindex(mat5.ui.p.ks)
mat5.ui.p.ks[is.na(mat5.ui.p.ks)] = 0
h5.ui.p.ks<-h.index(mat5.ui.p.ks)

ep5.ui.p.ks<-ep(mut5.ui.p.ks,a5.ui.p.ks)
david5.ui.p.ks<-DS(mat5.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.ks<-cbind(ordrank.5.ui.p.ks,ds=david5.ui.p.ks$normDS)
lm5.ui.p.ks<-summary(lm(ordrank.5.ui.p.ks$ds~ordrank.5.ui.p.ks$ord.rank))
s5.ui.p.ks<-lm5.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[16]],X2=conflict.ks.ui.p[[17]],Victories=conflict.ks.ui.p[[18]])
mat6.ui.p.ks<-inter.mat(mut6.ui.p.ks)
tri6.ui.p.ks<-tr.tri(mat6.ui.p.ks)
dci6.ui.p.ks<-DCindex(mat6.ui.p.ks)
mat6.ui.p.ks[is.na(mat6.ui.p.ks)] = 0
h6.ui.p.ks<-h.index(mat6.ui.p.ks)

ep6.ui.p.ks<-ep(mut6.ui.p.ks,a6.ui.p.ks)
david6.ui.p.ks<-DS(mat6.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.ks<-cbind(ordrank.6.ui.p.ks,ds=david6.ui.p.ks$normDS)
lm6.ui.p.ks<-summary(lm(ordrank.6.ui.p.ks$ds~ordrank.6.ui.p.ks$ord.rank))
s6.ui.p.ks<-lm6.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[19]],X2=conflict.ks.ui.p[[20]],Victories=conflict.ks.ui.p[[21]])
mat7.ui.p.ks<-inter.mat(mut7.ui.p.ks)
tri7.ui.p.ks<-tr.tri(mat7.ui.p.ks)
dci7.ui.p.ks<-DCindex(mat7.ui.p.ks)
mat7.ui.p.ks[is.na(mat7.ui.p.ks)] = 0
h7.ui.p.ks<-h.index(mat7.ui.p.ks)

ep7.ui.p.ks<-ep(mut7.ui.p.ks,a7.ui.p.ks)
david7.ui.p.ks<-DS(mat7.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.ks<-cbind(ordrank.7.ui.p.ks,ds=david7.ui.p.ks$normDS)
lm7.ui.p.ks<-summary(lm(ordrank.7.ui.p.ks$ds~ordrank.7.ui.p.ks$ord.rank))
s7.ui.p.ks<-lm7.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[22]],X2=conflict.ks.ui.p[[23]],Victories=conflict.ks.ui.p[[24]])
mat8.ui.p.ks<-inter.mat(mut8.ui.p.ks)
tri8.ui.p.ks<-tr.tri(mat8.ui.p.ks)
dci8.ui.p.ks<-DCindex(mat8.ui.p.ks)
mat8.ui.p.ks[is.na(mat8.ui.p.ks)] = 0
h8.ui.p.ks<-h.index(mat8.ui.p.ks)

ep8.ui.p.ks<-ep(mut8.ui.p.ks,a8.ui.p.ks)
david8.ui.p.ks<-DS(mat8.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.ks<-cbind(ordrank.8.ui.p.ks,ds=david8.ui.p.ks$normDS)
lm8.ui.p.ks<-summary(lm(ordrank.8.ui.p.ks$ds~ordrank.8.ui.p.ks$ord.rank))
s8.ui.p.ks<-lm8.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[25]],X2=conflict.ks.ui.p[[26]],Victories=conflict.ks.ui.p[[27]])
mat9.ui.p.ks<-inter.mat(mut9.ui.p.ks)
tri9.ui.p.ks<-tr.tri(mat9.ui.p.ks)
dci9.ui.p.ks<-DCindex(mat9.ui.p.ks)
mat9.ui.p.ks[is.na(mat9.ui.p.ks)] = 0
h9.ui.p.ks<-h.index(mat9.ui.p.ks)

ep9.ui.p.ks<-ep(mut9.ui.p.ks,a9.ui.p.ks)
david9.ui.p.ks<-DS(mat9.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.ks<-cbind(ordrank.9.ui.p.ks,ds=david9.ui.p.ks$normDS)
lm9.ui.p.ks<-summary(lm(ordrank.9.ui.p.ks$ds~ordrank.9.ui.p.ks$ord.rank))
s9.ui.p.ks<-lm9.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.ks<-data.frame(X1=conflict.ks.ui.p[[28]],X2=conflict.ks.ui.p[[29]],Victories=conflict.ks.ui.p[[30]])
mat10.ui.p.ks<-inter.mat(mut10.ui.p.ks)
tri10.ui.p.ks<-tr.tri(mat10.ui.p.ks)
dci10.ui.p.ks<-DCindex(mat10.ui.p.ks)
mat10.ui.p.ks[is.na(mat10.ui.p.ks)] = 0
h10.ui.p.ks<-h.index(mat10.ui.p.ks)

ep10.ui.p.ks<-ep(mut10.ui.p.ks,a10.ui.p.ks)
david10.ui.p.ks<-DS(mat10.ui.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.ks<-cbind(ordrank.10.ui.p.ks,ds=david10.ui.p.ks$normDS)
lm10.ui.p.ks<-summary(lm(ordrank.10.ui.p.ks$ds~ordrank.10.ui.p.ks$ord.rank))
s10.ui.p.ks<-lm10.ui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.ks<-sum(mut1.ui.p.ks$Victories)
int2.ui.p.ks<-sum(mut2.ui.p.ks$Victories)
int3.ui.p.ks<-sum(mut3.ui.p.ks$Victories)
int4.ui.p.ks<-sum(mut4.ui.p.ks$Victories)
int5.ui.p.ks<-sum(mut5.ui.p.ks$Victories)
int6.ui.p.ks<-sum(mut6.ui.p.ks$Victories)
int7.ui.p.ks<-sum(mut7.ui.p.ks$Victories)
int8.ui.p.ks<-sum(mut8.ui.p.ks$Victories)
int9.ui.p.ks<-sum(mut9.ui.p.ks$Victories)
int10.ui.p.ks<-sum(mut10.ui.p.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.ks<-sum(a1.ui.p.ks$Victories)
av2.ui.p.ks<-sum(a2.ui.p.ks$Victories)
av3.ui.p.ks<-sum(a3.ui.p.ks$Victories)
av4.ui.p.ks<-sum(a4.ui.p.ks$Victories)
av5.ui.p.ks<-sum(a5.ui.p.ks$Victories)
av6.ui.p.ks<-sum(a6.ui.p.ks$Victories)
av7.ui.p.ks<-sum(a7.ui.p.ks$Victories)
av8.ui.p.ks<-sum(a8.ui.p.ks$Victories)
av9.ui.p.ks<-sum(a9.ui.p.ks$Victories)
av10.ui.p.ks<-sum(a10.ui.p.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.iu.p<-(sum(av1.ui.p.ks, av2.ui.p.ks, av3.ui.p.ks, av4.ui.p.ks, av5.ui.p.ks, av6.ui.p.ks, av7.ui.p.ks, av8.ui.p.ks, av9.ui.p.ks, av10.ui.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.iu.p<-(sum(int1.ui.p.ks, int2.ui.p.ks, int3.ui.p.ks, int4.ui.p.ks, int5.ui.p.ks, int6.ui.p.ks, int7.ui.p.ks, int8.ui.p.ks, int9.ui.p.ks, int10.ui.p.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.p.ks<-e1.ui.p.ks[order(e1.ui.p.ks$ID),]
e1.ui.p.ks<-as.matrix(t(e1.1.ui.p.ks))

e2.ui.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.p.ks<-e2.ui.p.ks[order(e2.ui.p.ks$ID),]
e2.ui.p.ks<-as.matrix(t(e2.1.ui.p.ks))

e3.ui.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.p.ks<-e3.ui.p.ks[order(e3.ui.p.ks$ID),]
e3.ui.p.ks<-as.matrix(t(e3.1.ui.p.ks))

e4.ui.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.p.ks<-e4.ui.p.ks[order(e4.ui.p.ks$ID),]
e4.ui.p.ks<-as.matrix(t(e4.1.ui.p.ks))

e5.ui.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.p.ks<-e5.ui.p.ks[order(e5.ui.p.ks$ID),]
e5.ui.p.ks<-as.matrix(t(e5.1.ui.p.ks))

e6.ui.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.p.ks<-e6.ui.p.ks[order(e6.ui.p.ks$ID),]
e6.ui.p.ks<-as.matrix(t(e6.1.ui.p.ks))

e7.ui.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.p.ks<-e7.ui.p.ks[order(e7.ui.p.ks$ID),]
e7.ui.p.ks<-as.matrix(t(e7.1.ui.p.ks))

e8.ui.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.p.ks<-e8.ui.p.ks[order(e8.ui.p.ks$ID),]
e8.ui.p.ks<-as.matrix(t(e8.1.ui.p.ks))

e9.ui.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.p.ks<-e9.ui.p.ks[order(e9.ui.p.ks$ID),]
e9.ui.p.ks<-as.matrix(t(e9.1.ui.p.ks))

e10.ui.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.p.ks<-e10.ui.p.ks[order(e10.ui.p.ks$ID),]
e10.ui.p.ks<-as.matrix(t(e10.1.ui.p.ks))

energy.ks.ui.p.ks<-as.data.frame(matrix(c(e1.ui.p.ks,e2.ui.p.ks,e3.ui.p.ks,e4.ui.p.ks,e5.ui.p.ks,e6.ui.p.ks,e7.ui.p.ks,e8.ui.p.ks,e9.ui.p.ks,e10.ui.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.ui.p.ks<-data.frame(ID=energy.ks.ui.p.ks$V1,energy_over_distance=energy.ks.ui.p.ks$V2,energy_over_time=energy.ks.ui.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.ks<-david1.ui.p.ks[order(david1.ui.p.ks$ID),]
david1.ui.p.ks<-as.matrix(t(david1.1.ui.p.ks))

david2.1.ui.p.ks<-david2.ui.p.ks[order(david2.ui.p.ks$ID),]
david2.ui.p.ks<-as.matrix(t(david2.1.ui.p.ks))

david3.1.ui.p.ks<-david3.ui.p.ks[order(david3.ui.p.ks$ID),]
david3.ui.p.ks<-as.matrix(t(david3.1.ui.p.ks))

david4.1.ui.p.ks<-david4.ui.p.ks[order(david4.ui.p.ks$ID),]
david4.ui.p.ks<-as.matrix(t(david4.1.ui.p.ks))

david5.1.ui.p.ks<-david5.ui.p.ks[order(david5.ui.p.ks$ID),]
david5.ui.p.ks<-as.matrix(t(david5.1.ui.p.ks))

david6.1.ui.p.ks<-david6.ui.p.ks[order(david6.ui.p.ks$ID),]
david6.ui.p.ks<-as.matrix(t(david6.1.ui.p.ks))

david7.1.ui.p.ks<-david7.ui.p.ks[order(david7.ui.p.ks$ID),]
david7.ui.p.ks<-as.matrix(t(david7.1.ui.p.ks))

david8.1.ui.p.ks<-david8.ui.p.ks[order(david8.ui.p.ks$ID),]
david8.ui.p.ks<-as.matrix(t(david8.1.ui.p.ks))

david9.1.ui.p.ks<-david9.ui.p.ks[order(david9.ui.p.ks$ID),]
david9.ui.p.ks<-as.matrix(t(david9.1.ui.p.ks))

david10.1.ui.p.ks<-david10.ui.p.ks[order(david10.ui.p.ks$ID),]
david10.ui.p.ks<-as.matrix(t(david10.1.ui.p.ks))

david.ks.ui.p.ks<-as.data.frame(matrix(c(david1.ui.p.ks,david2.ui.p.ks,david3.ui.p.ks,david4.ui.p.ks,david5.ui.p.ks,david6.ui.p.ks,david7.ui.p.ks,david8.ui.p.ks,david9.ui.p.ks,david10.ui.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.ui.p.ks<-data.frame(ID=david.ks.ui.p.ks$V1,DS=david.ks.ui.p.ks$V2,normDS=david.ks.ui.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.ui.p.ks<-lm(e1.1.ui.p.ks$energy_over_time~as.numeric(david1.1.ui.p.ks$normDS))
ks.lm.1.s.ui.p.ks<-summary(lm.ks.1.ui.p.ks)$coefficients
ks.1.slope.ui.p.ks<-ks.lm.1.s.ui.p.ks[2,1]
lm.ks.2.ui.p.ks<-lm(e2.1.ui.p.ks$energy_over_time~as.numeric(david2.1.ui.p.ks$normDS))
ks.lm.2.s.ui.p.ks<-summary(lm.ks.2.ui.p.ks)$coefficients
ks.2.slope.ui.p.ks<-ks.lm.2.s.ui.p.ks[2,1]
lm.ks.3.ui.p.ks<-lm(e3.1.ui.p.ks$energy_over_time~as.numeric(david3.1.ui.p.ks$normDS))
ks.lm.3.s.ui.p.ks<-summary(lm.ks.3.ui.p.ks)$coefficients
ks.3.slope.ui.p.ks<-ks.lm.3.s.ui.p.ks[2,1]
lm.ks.4.ui.p.ks<-lm(e4.1.ui.p.ks$energy_over_time~as.numeric(david4.1.ui.p.ks$normDS))
ks.lm.4.s.ui.p.ks<-summary(lm.ks.4.ui.p.ks)$coefficients
ks.4.slope.ui.p.ks<-ks.lm.4.s.ui.p.ks[2,1]
lm.ks.5.ui.p.ks<-lm(e5.1.ui.p.ks$energy_over_time~as.numeric(david5.1.ui.p.ks$normDS))
ks.lm.5.s.ui.p.ks<-summary(lm.ks.5.ui.p.ks)$coefficients
ks.5.slope.ui.p.ks<-ks.lm.5.s.ui.p.ks[2,1]
lm.ks.6.ui.p.ks<-lm(e6.1.ui.p.ks$energy_over_time~as.numeric(david6.1.ui.p.ks$normDS))
ks.lm.6.s.ui.p.ks<-summary(lm.ks.6.ui.p.ks)$coefficients
ks.6.slope.ui.p.ks<-ks.lm.6.s.ui.p.ks[2,1]
lm.ks.7.ui.p.ks<-lm(e7.1.ui.p.ks$energy_over_time~as.numeric(david7.1.ui.p.ks$normDS))
ks.lm.7.s.ui.p.ks<-summary(lm.ks.7.ui.p.ks)$coefficients
ks.7.slope.ui.p.ks<-ks.lm.7.s.ui.p.ks[2,1]
lm.ks.8.ui.p.ks<-lm(e8.1.ui.p.ks$energy_over_time~as.numeric(david8.1.ui.p.ks$normDS))
ks.lm.8.s.ui.p.ks<-summary(lm.ks.8.ui.p.ks)$coefficients
ks.8.slope.ui.p.ks<-ks.lm.8.s.ui.p.ks[2,1]
lm.ks.9.ui.p.ks<-lm(e9.1.ui.p.ks$energy_over_time~as.numeric(david9.1.ui.p.ks$normDS))
ks.lm.9.s.ui.p.ks<-summary(lm.ks.9.ui.p.ks)$coefficients
ks.9.slope.ui.p.ks<-ks.lm.9.s.ui.p.ks[2,1]
lm.ks.10.ui.p.ks<-lm(e10.1.ui.p.ks$energy_over_time~as.numeric(david10.1.ui.p.ks$normDS))
ks.lm.10.s.ui.p.ks<-summary(lm.ks.10.ui.p.ks)$coefficients
ks.10.slope.ui.p.ks<-ks.lm.10.s.ui.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.ks,tri2.ui.p.ks,tri3.ui.p.ks,tri4.ui.p.ks,tri5.ui.p.ks,tri6.ui.p.ks,tri7.ui.p.ks,tri8.ui.p.ks,tri9.ui.p.ks,tri10.ui.p.ks),escalation=c(ep1.ui.p.ks,ep2.ui.p.ks,ep3.ui.p.ks,ep4.ui.p.ks,ep5.ui.p.ks,ep6.ui.p.ks,ep7.ui.p.ks,ep8.ui.p.ks,ep9.ui.p.ks,ep10.ui.p.ks),dci=c(dci1.ui.p.ks,dci2.ui.p.ks,dci3.ui.p.ks,dci4.ui.p.ks,dci5.ui.p.ks,dci6.ui.p.ks,dci7.ui.p.ks,dci8.ui.p.ks,dci9.ui.p.ks,dci10.ui.p.ks),steepness=c(s1.ui.p.ks,s2.ui.p.ks,s3.ui.p.ks,s4.ui.p.ks,s5.ui.p.ks,s6.ui.p.ks,s7.ui.p.ks,s8.ui.p.ks,s9.ui.p.ks,s10.ui.p.ks),slope=c(ks.1.slope.ui.p.ks,ks.2.slope.ui.p.ks,ks.3.slope.ui.p.ks,ks.4.slope.ui.p.ks,ks.5.slope.ui.p.ks,ks.6.slope.ui.p.ks,ks.7.slope.ui.p.ks,ks.8.slope.ui.p.ks,ks.9.slope.ui.p.ks,ks.10.slope.ui.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.ko<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[1]],X2=avoid.ui.p.ko[[2]],Avoids=avoid.ui.p.ko[[3]])
a2.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[4]],X2=avoid.ui.p.ko[[5]],Avoids=avoid.ui.p.ko[[6]])
a3.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[7]],X2=avoid.ui.p.ko[[8]],Avoids=avoid.ui.p.ko[[9]])
a4.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[10]],X2=avoid.ui.p.ko[[11]],Avoids=avoid.ui.p.ko[[12]])
a5.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[13]],X2=avoid.ui.p.ko[[14]],Avoids=avoid.ui.p.ko[[15]])
a6.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[16]],X2=avoid.ui.p.ko[[17]],Avoids=avoid.ui.p.ko[[18]])
a7.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[19]],X2=avoid.ui.p.ko[[20]],Avoids=avoid.ui.p.ko[[21]])
a8.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[22]],X2=avoid.ui.p.ko[[23]],Avoids=avoid.ui.p.ko[[24]])
a9.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[25]],X2=avoid.ui.p.ko[[26]],Avoids=avoid.ui.p.ko[[27]])
a10.ui.p.ko<-data.frame(X1=avoid.ui.p.ko[[28]],X2=avoid.ui.p.ko[[29]],Avoids=avoid.ui.p.ko[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ko.ui.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[1]],X2=conflict.ko.ui.p[[2]],Victories=conflict.ko.ui.p[[3]])
mat1.ui.p.ko<-inter.mat(mut1.ui.p.ko)
tri1.ui.p.ko<-tr.tri(mat1.ui.p.ko)
dci1.ui.p.ko<-DCindex(mat1.ui.p.ko)
mat1.ui.p.ko[is.na(mat1.ui.p.ko)] = 0
h1.ui.p.ko<-h.index(mat1.ui.p.ko)

ep1.ui.p.ko<-ep(mut1.ui.p.ko,a1.ui.p.ko)
david1.ui.p.ko<-DS(mat1.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.ko<-cbind(ordrank.1.ui.p.ko,ds=david1.ui.p.ko$normDS)
lm1.ui.p.ko<-summary(lm(ordrank.1.ui.p.ko$ds~ordrank.1.ui.p.ko$ord.rank))
s1.ui.p.ko<-lm1.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[4]],X2=conflict.ko.ui.p[[5]],Victories=conflict.ko.ui.p[[6]])
mat2.ui.p.ko<-inter.mat(mut2.ui.p.ko)
tri2.ui.p.ko<-tr.tri(mat2.ui.p.ko)
dci2.ui.p.ko<-DCindex(mat2.ui.p.ko)
mat2.ui.p.ko[is.na(mat2.ui.p.ko)] = 0
h2.ui.p.ko<-h.index(mat2.ui.p.ko)

ep2.ui.p.ko<-ep(mut2.ui.p.ko,a2.ui.p.ko)
david2.ui.p.ko<-DS(mat2.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.ko<-cbind(ordrank.2.ui.p.ko,ds=david2.ui.p.ko$normDS)
lm2.ui.p.ko<-summary(lm(ordrank.2.ui.p.ko$ds~ordrank.2.ui.p.ko$ord.rank))
s2.ui.p.ko<-lm2.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[7]],X2=conflict.ko.ui.p[[8]],Victories=conflict.ko.ui.p[[9]])
mat3.ui.p.ko<-inter.mat(mut3.ui.p.ko)
tri3.ui.p.ko<-tr.tri(mat3.ui.p.ko)
dci3.ui.p.ko<-DCindex(mat3.ui.p.ko)
mat3.ui.p.ko[is.na(mat3.ui.p.ko)] = 0
h3.ui.p.ko<-h.index(mat3.ui.p.ko)

ep3.ui.p.ko<-ep(mut3.ui.p.ko,a3.ui.p.ko)
david3.ui.p.ko<-DS(mat3.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.ko<-cbind(ordrank.3.ui.p.ko,ds=david3.ui.p.ko$normDS)
lm3.ui.p.ko<-summary(lm(ordrank.3.ui.p.ko$ds~ordrank.3.ui.p.ko$ord.rank))
s3.ui.p.ko<-lm3.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[10]],X2=conflict.ko.ui.p[[11]],Victories=conflict.ko.ui.p[[12]])
mat4.ui.p.ko<-inter.mat(mut4.ui.p.ko)
tri4.ui.p.ko<-tr.tri(mat4.ui.p.ko)
dci4.ui.p.ko<-DCindex(mat4.ui.p.ko)
mat4.ui.p.ko[is.na(mat4.ui.p.ko)] = 0
h4.ui.p.ko<-h.index(mat4.ui.p.ko)

ep4.ui.p.ko<-ep(mut4.ui.p.ko,a4.ui.p.ko)
david4.ui.p.ko<-DS(mat4.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.ko<-cbind(ordrank.4.ui.p.ko,ds=david4.ui.p.ko$normDS)
lm4.ui.p.ko<-summary(lm(ordrank.4.ui.p.ko$ds~ordrank.4.ui.p.ko$ord.rank))
s4.ui.p.ko<-lm4.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[13]],X2=conflict.ko.ui.p[[14]],Victories=conflict.ko.ui.p[[15]])
mat5.ui.p.ko<-inter.mat(mut5.ui.p.ko)
tri5.ui.p.ko<-tr.tri(mat5.ui.p.ko)
dci5.ui.p.ko<-DCindex(mat5.ui.p.ko)
mat5.ui.p.ko[is.na(mat5.ui.p.ko)] = 0
h5.ui.p.ko<-h.index(mat5.ui.p.ko)

ep5.ui.p.ko<-ep(mut5.ui.p.ko,a5.ui.p.ko)
david5.ui.p.ko<-DS(mat5.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.ko<-cbind(ordrank.5.ui.p.ko,ds=david5.ui.p.ko$normDS)
lm5.ui.p.ko<-summary(lm(ordrank.5.ui.p.ko$ds~ordrank.5.ui.p.ko$ord.rank))
s5.ui.p.ko<-lm5.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[16]],X2=conflict.ko.ui.p[[17]],Victories=conflict.ko.ui.p[[18]])
mat6.ui.p.ko<-inter.mat(mut6.ui.p.ko)
tri6.ui.p.ko<-tr.tri(mat6.ui.p.ko)
dci6.ui.p.ko<-DCindex(mat6.ui.p.ko)
mat6.ui.p.ko[is.na(mat6.ui.p.ko)] = 0
h6.ui.p.ko<-h.index(mat6.ui.p.ko)

ep6.ui.p.ko<-ep(mut6.ui.p.ko,a6.ui.p.ko)
david6.ui.p.ko<-DS(mat6.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.ko<-cbind(ordrank.6.ui.p.ko,ds=david6.ui.p.ko$normDS)
lm6.ui.p.ko<-summary(lm(ordrank.6.ui.p.ko$ds~ordrank.6.ui.p.ko$ord.rank))
s6.ui.p.ko<-lm6.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[19]],X2=conflict.ko.ui.p[[20]],Victories=conflict.ko.ui.p[[21]])
mat7.ui.p.ko<-inter.mat(mut7.ui.p.ko)
tri7.ui.p.ko<-tr.tri(mat7.ui.p.ko)
dci7.ui.p.ko<-DCindex(mat7.ui.p.ko)
mat7.ui.p.ko[is.na(mat7.ui.p.ko)] = 0
h7.ui.p.ko<-h.index(mat7.ui.p.ko)

ep7.ui.p.ko<-ep(mut7.ui.p.ko,a7.ui.p.ko)
david7.ui.p.ko<-DS(mat7.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.ko<-cbind(ordrank.7.ui.p.ko,ds=david7.ui.p.ko$normDS)
lm7.ui.p.ko<-summary(lm(ordrank.7.ui.p.ko$ds~ordrank.7.ui.p.ko$ord.rank))
s7.ui.p.ko<-lm7.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[22]],X2=conflict.ko.ui.p[[23]],Victories=conflict.ko.ui.p[[24]])
mat8.ui.p.ko<-inter.mat(mut8.ui.p.ko)
tri8.ui.p.ko<-tr.tri(mat8.ui.p.ko)
dci8.ui.p.ko<-DCindex(mat8.ui.p.ko)
mat8.ui.p.ko[is.na(mat8.ui.p.ko)] = 0
h8.ui.p.ko<-h.index(mat8.ui.p.ko)

ep8.ui.p.ko<-ep(mut8.ui.p.ko,a8.ui.p.ko)
david8.ui.p.ko<-DS(mat8.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.ko<-cbind(ordrank.8.ui.p.ko,ds=david8.ui.p.ko$normDS)
lm8.ui.p.ko<-summary(lm(ordrank.8.ui.p.ko$ds~ordrank.8.ui.p.ko$ord.rank))
s8.ui.p.ko<-lm8.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[25]],X2=conflict.ko.ui.p[[26]],Victories=conflict.ko.ui.p[[27]])
mat9.ui.p.ko<-inter.mat(mut9.ui.p.ko)
tri9.ui.p.ko<-tr.tri(mat9.ui.p.ko)
dci9.ui.p.ko<-DCindex(mat9.ui.p.ko)
mat9.ui.p.ko[is.na(mat9.ui.p.ko)] = 0
h9.ui.p.ko<-h.index(mat9.ui.p.ko)

ep9.ui.p.ko<-ep(mut9.ui.p.ko,a9.ui.p.ko)
david9.ui.p.ko<-DS(mat9.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.ko<-cbind(ordrank.9.ui.p.ko,ds=david9.ui.p.ko$normDS)
lm9.ui.p.ko<-summary(lm(ordrank.9.ui.p.ko$ds~ordrank.9.ui.p.ko$ord.rank))
s9.ui.p.ko<-lm9.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.ko<-data.frame(X1=conflict.ko.ui.p[[28]],X2=conflict.ko.ui.p[[29]],Victories=conflict.ko.ui.p[[30]])
mat10.ui.p.ko<-inter.mat(mut10.ui.p.ko)
tri10.ui.p.ko<-tr.tri(mat10.ui.p.ko)
dci10.ui.p.ko<-DCindex(mat10.ui.p.ko)
mat10.ui.p.ko[is.na(mat10.ui.p.ko)] = 0
h10.ui.p.ko<-h.index(mat10.ui.p.ko)

ep10.ui.p.ko<-ep(mut10.ui.p.ko,a10.ui.p.ko)
david10.ui.p.ko<-DS(mat10.ui.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.ko<-cbind(ordrank.10.ui.p.ko,ds=david10.ui.p.ko$normDS)
lm10.ui.p.ko<-summary(lm(ordrank.10.ui.p.ko$ds~ordrank.10.ui.p.ko$ord.rank))
s10.ui.p.ko<-lm10.ui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.ko<-sum(mut1.ui.p.ko$Victories)
int2.ui.p.ko<-sum(mut2.ui.p.ko$Victories)
int3.ui.p.ko<-sum(mut3.ui.p.ko$Victories)
int4.ui.p.ko<-sum(mut4.ui.p.ko$Victories)
int5.ui.p.ko<-sum(mut5.ui.p.ko$Victories)
int6.ui.p.ko<-sum(mut6.ui.p.ko$Victories)
int7.ui.p.ko<-sum(mut7.ui.p.ko$Victories)
int8.ui.p.ko<-sum(mut8.ui.p.ko$Victories)
int9.ui.p.ko<-sum(mut9.ui.p.ko$Victories)
int10.ui.p.ko<-sum(mut10.ui.p.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.ko<-sum(a1.ui.p.ko$Victories)
av2.ui.p.ko<-sum(a2.ui.p.ko$Victories)
av3.ui.p.ko<-sum(a3.ui.p.ko$Victories)
av4.ui.p.ko<-sum(a4.ui.p.ko$Victories)
av5.ui.p.ko<-sum(a5.ui.p.ko$Victories)
av6.ui.p.ko<-sum(a6.ui.p.ko$Victories)
av7.ui.p.ko<-sum(a7.ui.p.ko$Victories)
av8.ui.p.ko<-sum(a8.ui.p.ko$Victories)
av9.ui.p.ko<-sum(a9.ui.p.ko$Victories)
av10.ui.p.ko<-sum(a10.ui.p.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.iu.p<-(sum(av1.ui.p.ko, av2.ui.p.ko, av3.ui.p.ko, av4.ui.p.ko, av5.ui.p.ko, av6.ui.p.ko, av7.ui.p.ko, av8.ui.p.ko, av9.ui.p.ko, av10.ui.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.iu.p<-(sum(int1.ui.p.ko, int2.ui.p.ko, int3.ui.p.ko, int4.ui.p.ko, int5.ui.p.ko, int6.ui.p.ko, int7.ui.p.ko, int8.ui.p.ko, int9.ui.p.ko, int10.ui.p.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.p.ko<-e1.ui.p.ko[order(e1.ui.p.ko$ID),]
e1.ui.p.ko<-as.matrix(t(e1.1.ui.p.ko))

e2.ui.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.p.ko<-e2.ui.p.ko[order(e2.ui.p.ko$ID),]
e2.ui.p.ko<-as.matrix(t(e2.1.ui.p.ko))

e3.ui.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.p.ko<-e3.ui.p.ko[order(e3.ui.p.ko$ID),]
e3.ui.p.ko<-as.matrix(t(e3.1.ui.p.ko))

e4.ui.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.p.ko<-e4.ui.p.ko[order(e4.ui.p.ko$ID),]
e4.ui.p.ko<-as.matrix(t(e4.1.ui.p.ko))

e5.ui.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.p.ko<-e5.ui.p.ko[order(e5.ui.p.ko$ID),]
e5.ui.p.ko<-as.matrix(t(e5.1.ui.p.ko))

e6.ui.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.p.ko<-e6.ui.p.ko[order(e6.ui.p.ko$ID),]
e6.ui.p.ko<-as.matrix(t(e6.1.ui.p.ko))

e7.ui.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.p.ko<-e7.ui.p.ko[order(e7.ui.p.ko$ID),]
e7.ui.p.ko<-as.matrix(t(e7.1.ui.p.ko))

e8.ui.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.p.ko<-e8.ui.p.ko[order(e8.ui.p.ko$ID),]
e8.ui.p.ko<-as.matrix(t(e8.1.ui.p.ko))

e9.ui.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.p.ko<-e9.ui.p.ko[order(e9.ui.p.ko$ID),]
e9.ui.p.ko<-as.matrix(t(e9.1.ui.p.ko))

e10.ui.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.p.ko<-e10.ui.p.ko[order(e10.ui.p.ko$ID),]
e10.ui.p.ko<-as.matrix(t(e10.1.ui.p.ko))

energy.ko.ui.p.ko<-as.data.frame(matrix(c(e1.ui.p.ko,e2.ui.p.ko,e3.ui.p.ko,e4.ui.p.ko,e5.ui.p.ko,e6.ui.p.ko,e7.ui.p.ko,e8.ui.p.ko,e9.ui.p.ko,e10.ui.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.ui.p.ko<-data.frame(ID=energy.ko.ui.p.ko$V1,energy_over_distance=energy.ko.ui.p.ko$V2,energy_over_time=energy.ko.ui.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.ko<-david1.ui.p.ko[order(david1.ui.p.ko$ID),]
david1.ui.p.ko<-as.matrix(t(david1.1.ui.p.ko))

david2.1.ui.p.ko<-david2.ui.p.ko[order(david2.ui.p.ko$ID),]
david2.ui.p.ko<-as.matrix(t(david2.1.ui.p.ko))

david3.1.ui.p.ko<-david3.ui.p.ko[order(david3.ui.p.ko$ID),]
david3.ui.p.ko<-as.matrix(t(david3.1.ui.p.ko))

david4.1.ui.p.ko<-david4.ui.p.ko[order(david4.ui.p.ko$ID),]
david4.ui.p.ko<-as.matrix(t(david4.1.ui.p.ko))

david5.1.ui.p.ko<-david5.ui.p.ko[order(david5.ui.p.ko$ID),]
david5.ui.p.ko<-as.matrix(t(david5.1.ui.p.ko))

david6.1.ui.p.ko<-david6.ui.p.ko[order(david6.ui.p.ko$ID),]
david6.ui.p.ko<-as.matrix(t(david6.1.ui.p.ko))

david7.1.ui.p.ko<-david7.ui.p.ko[order(david7.ui.p.ko$ID),]
david7.ui.p.ko<-as.matrix(t(david7.1.ui.p.ko))

david8.1.ui.p.ko<-david8.ui.p.ko[order(david8.ui.p.ko$ID),]
david8.ui.p.ko<-as.matrix(t(david8.1.ui.p.ko))

david9.1.ui.p.ko<-david9.ui.p.ko[order(david9.ui.p.ko$ID),]
david9.ui.p.ko<-as.matrix(t(david9.1.ui.p.ko))

david10.1.ui.p.ko<-david10.ui.p.ko[order(david10.ui.p.ko$ID),]
david10.ui.p.ko<-as.matrix(t(david10.1.ui.p.ko))

david.ko.ui.p.ko<-as.data.frame(matrix(c(david1.ui.p.ko,david2.ui.p.ko,david3.ui.p.ko,david4.ui.p.ko,david5.ui.p.ko,david6.ui.p.ko,david7.ui.p.ko,david8.ui.p.ko,david9.ui.p.ko,david10.ui.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.ui.p.ko<-data.frame(ID=david.ko.ui.p.ko$V1,DS=david.ko.ui.p.ko$V2,normDS=david.ko.ui.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.ui.p.ko<-lm(e1.1.ui.p.ko$energy_over_time~as.numeric(david1.1.ui.p.ko$normDS))
ko.lm.1.s.ui.p.ko<-summary(lm.ko.1.ui.p.ko)$coefficients
ko.1.slope.ui.p.ko<-ko.lm.1.s.ui.p.ko[2,1]
lm.ko.2.ui.p.ko<-lm(e2.1.ui.p.ko$energy_over_time~as.numeric(david2.1.ui.p.ko$normDS))
ko.lm.2.s.ui.p.ko<-summary(lm.ko.2.ui.p.ko)$coefficients
ko.2.slope.ui.p.ko<-ko.lm.2.s.ui.p.ko[2,1]
lm.ko.3.ui.p.ko<-lm(e3.1.ui.p.ko$energy_over_time~as.numeric(david3.1.ui.p.ko$normDS))
ko.lm.3.s.ui.p.ko<-summary(lm.ko.3.ui.p.ko)$coefficients
ko.3.slope.ui.p.ko<-ko.lm.3.s.ui.p.ko[2,1]
lm.ko.4.ui.p.ko<-lm(e4.1.ui.p.ko$energy_over_time~as.numeric(david4.1.ui.p.ko$normDS))
ko.lm.4.s.ui.p.ko<-summary(lm.ko.4.ui.p.ko)$coefficients
ko.4.slope.ui.p.ko<-ko.lm.4.s.ui.p.ko[2,1]
lm.ko.5.ui.p.ko<-lm(e5.1.ui.p.ko$energy_over_time~as.numeric(david5.1.ui.p.ko$normDS))
ko.lm.5.s.ui.p.ko<-summary(lm.ko.5.ui.p.ko)$coefficients
ko.5.slope.ui.p.ko<-ko.lm.5.s.ui.p.ko[2,1]
lm.ko.6.ui.p.ko<-lm(e6.1.ui.p.ko$energy_over_time~as.numeric(david6.1.ui.p.ko$normDS))
ko.lm.6.s.ui.p.ko<-summary(lm.ko.6.ui.p.ko)$coefficients
ko.6.slope.ui.p.ko<-ko.lm.6.s.ui.p.ko[2,1]
lm.ko.7.ui.p.ko<-lm(e7.1.ui.p.ko$energy_over_time~as.numeric(david7.1.ui.p.ko$normDS))
ko.lm.7.s.ui.p.ko<-summary(lm.ko.7.ui.p.ko)$coefficients
ko.7.slope.ui.p.ko<-ko.lm.7.s.ui.p.ko[2,1]
lm.ko.8.ui.p.ko<-lm(e8.1.ui.p.ko$energy_over_time~as.numeric(david8.1.ui.p.ko$normDS))
ko.lm.8.s.ui.p.ko<-summary(lm.ko.8.ui.p.ko)$coefficients
ko.8.slope.ui.p.ko<-ko.lm.8.s.ui.p.ko[2,1]
lm.ko.9.ui.p.ko<-lm(e9.1.ui.p.ko$energy_over_time~as.numeric(david9.1.ui.p.ko$normDS))
ko.lm.9.s.ui.p.ko<-summary(lm.ko.9.ui.p.ko)$coefficients
ko.9.slope.ui.p.ko<-ko.lm.9.s.ui.p.ko[2,1]
lm.ko.10.ui.p.ko<-lm(e10.1.ui.p.ko$energy_over_time~as.numeric(david10.1.ui.p.ko$normDS))
ko.lm.10.s.ui.p.ko<-summary(lm.ko.10.ui.p.ko)$coefficients
ko.10.slope.ui.p.ko<-ko.lm.10.s.ui.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.ko,tri2.ui.p.ko,tri3.ui.p.ko,tri4.ui.p.ko,tri5.ui.p.ko,tri6.ui.p.ko,tri7.ui.p.ko,tri8.ui.p.ko,tri9.ui.p.ko,tri10.ui.p.ko),escalation=c(ep1.ui.p.ko,ep2.ui.p.ko,ep3.ui.p.ko,ep4.ui.p.ko,ep5.ui.p.ko,ep6.ui.p.ko,ep7.ui.p.ko,ep8.ui.p.ko,ep9.ui.p.ko,ep10.ui.p.ko),dci=c(dci1.ui.p.ko,dci2.ui.p.ko,dci3.ui.p.ko,dci4.ui.p.ko,dci5.ui.p.ko,dci6.ui.p.ko,dci7.ui.p.ko,dci8.ui.p.ko,dci9.ui.p.ko,dci10.ui.p.ko),steepness=c(s1.ui.p.ko,s2.ui.p.ko,s3.ui.p.ko,s4.ui.p.ko,s5.ui.p.ko,s6.ui.p.ko,s7.ui.p.ko,s8.ui.p.ko,s9.ui.p.ko,s10.ui.p.ko),slope=c(ko.1.slope.ui.p.ko,ko.2.slope.ui.p.ko,ko.3.slope.ui.p.ko,ko.4.slope.ui.p.ko,ko.5.slope.ui.p.ko,ko.6.slope.ui.p.ko,ko.7.slope.ui.p.ko,ko.8.slope.ui.p.ko,ko.9.slope.ui.p.ko,ko.10.slope.ui.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.hm<-sapply(files, read.csv)



# Separate out the avoidance data into the individual trials:
a1.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[1]]),X2=as.numeric(avoid.ui.p.hm[[2]]),Victories=as.numeric(avoid.ui.p.hm[[3]]))
a2.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[4]]),X2=as.numeric(avoid.ui.p.hm[[5]]),Victories=as.numeric(avoid.ui.p.hm[[6]]))
a3.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[7]]),X2=as.numeric(avoid.ui.p.hm[[8]]),Victories=as.numeric(avoid.ui.p.hm[[9]]))
a4.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[10]]),X2=as.numeric(avoid.ui.p.hm[[11]]),Victories=as.numeric(avoid.ui.p.hm[[12]]))
a5.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[13]]),X2=as.numeric(avoid.ui.p.hm[[14]]),Victories=as.numeric(avoid.ui.p.hm[[15]]))
a6.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[16]]),X2=as.numeric(avoid.ui.p.hm[[17]]),Victories=as.numeric(avoid.ui.p.hm[[18]]))
a7.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[19]]),X2=as.numeric(avoid.ui.p.hm[[20]]),Victories=as.numeric(avoid.ui.p.hm[[21]]))
a8.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[22]]),X2=as.numeric(avoid.ui.p.hm[[23]]),Victories=as.numeric(avoid.ui.p.hm[[24]]))
a9.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[25]]),X2=as.numeric(avoid.ui.p.hm[[26]]),Victories=as.numeric(avoid.ui.p.hm[[27]]))
a10.ui.p.hm<-data.frame(X1=as.numeric(avoid.ui.p.hm[[28]]),X2=as.numeric(avoid.ui.p.hm[[29]]),Victories=as.numeric(avoid.ui.p.hm[[30]]))


#a2.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[4]],X2=avoid.ui.p.hm[[5]],Avoids=avoid.ui.p.hm[[6]])
#a3.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[7]],X2=avoid.ui.p.hm[[8]],Avoids=avoid.ui.p.hm[[9]])
#a4.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[10]],X2=avoid.ui.p.hm[[11]],Avoids=avoid.ui.p.hm[[12]])
#a5.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[13]],X2=avoid.ui.p.hm[[14]],Avoids=avoid.ui.p.hm[[15]])
#a6.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[16]],X2=avoid.ui.p.hm[[17]],Avoids=avoid.ui.p.hm[[18]])
#a7.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[19]],X2=avoid.ui.p.hm[[20]],Avoids=avoid.ui.p.hm[[21]])
#a8.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[22]],X2=avoid.ui.p.hm[[23]],Avoids=avoid.ui.p.hm[[24]])
#a9.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[25]],X2=avoid.ui.p.hm[[26]],Avoids=avoid.ui.p.hm[[27]])
#a10.ui.p.hm<-data.frame(X1=avoid.ui.p.hm[[28]],X2=avoid.ui.p.hm[[29]],Avoids=avoid.ui.p.hm[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hm.ui.p<-sapply(files, read.csv)


# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[1]],X2=conflict.hm.ui.p[[2]],Victories=conflict.hm.ui.p[[3]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut1.ui.p.hm<-mut1.ui.p.hm[c(1:90),]
mut1.ui.p.hm<-transform(mut1.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat1.ui.p.hm<-inter.mat(mut1.ui.p.hm)
tri1.ui.p.hm<-tr.tri(mat1.ui.p.hm)
dci1.ui.p.hm<-DCindex(mat1.ui.p.hm)
mat1.ui.p.hm[is.na(mat1.ui.p.hm)] = 0
h1.ui.p.hm<-h.index(mat1.ui.p.hm)

ep1.ui.p.hm<-ep(mut1.ui.p.hm,a1.ui.p.hm)
david1.ui.p.hm<-DS(mat1.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.hm<-cbind(ordrank.1.ui.p.hm,ds=david1.ui.p.hm$normDS)
lm1.ui.p.hm<-summary(lm(ordrank.1.ui.p.hm$ds~ordrank.1.ui.p.hm$ord.rank))
s1.ui.p.hm<-lm1.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[4]],X2=conflict.hm.ui.p[[5]],Victories=conflict.hm.ui.p[[6]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut2.ui.p.hm<-mut2.ui.p.hm[c(1:90),]
mut2.ui.p.hm<-transform(mut2.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat2.ui.p.hm<-inter.mat(mut2.ui.p.hm)
tri2.ui.p.hm<-tr.tri(mat2.ui.p.hm)
dci2.ui.p.hm<-DCindex(mat2.ui.p.hm)
mat2.ui.p.hm[is.na(mat2.ui.p.hm)] = 0
h2.ui.p.hm<-h.index(mat2.ui.p.hm)

ep2.ui.p.hm<-ep(mut2.ui.p.hm,a2.ui.p.hm)
david2.ui.p.hm<-DS(mat2.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.hm<-cbind(ordrank.2.ui.p.hm,ds=david2.ui.p.hm$normDS)
lm2.ui.p.hm<-summary(lm(ordrank.2.ui.p.hm$ds~ordrank.2.ui.p.hm$ord.rank))
s2.ui.p.hm<-lm2.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[7]],X2=conflict.hm.ui.p[[8]],Victories=conflict.hm.ui.p[[9]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut3.ui.p.hm<-mut3.ui.p.hm[c(1:90),]
mut3.ui.p.hm<-transform(mut3.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat3.ui.p.hm<-inter.mat(mut3.ui.p.hm)
tri3.ui.p.hm<-tr.tri(mat3.ui.p.hm)
dci3.ui.p.hm<-DCindex(mat3.ui.p.hm)
mat3.ui.p.hm[is.na(mat3.ui.p.hm)] = 0
h3.ui.p.hm<-h.index(mat3.ui.p.hm)

ep3.ui.p.hm<-ep(mut3.ui.p.hm,a3.ui.p.hm)
david3.ui.p.hm<-DS(mat3.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.hm<-cbind(ordrank.3.ui.p.hm,ds=david3.ui.p.hm$normDS)
lm3.ui.p.hm<-summary(lm(ordrank.3.ui.p.hm$ds~ordrank.3.ui.p.hm$ord.rank))
s3.ui.p.hm<-lm3.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[10]],X2=conflict.hm.ui.p[[11]],Victories=conflict.hm.ui.p[[12]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut4.ui.p.hm<-mut4.ui.p.hm[c(1:90),]
mut4.ui.p.hm<-transform(mut4.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat4.ui.p.hm<-inter.mat(mut4.ui.p.hm)
tri4.ui.p.hm<-tr.tri(mat4.ui.p.hm)
dci4.ui.p.hm<-DCindex(mat4.ui.p.hm)
mat4.ui.p.hm[is.na(mat4.ui.p.hm)] = 0
h4.ui.p.hm<-h.index(mat4.ui.p.hm)

ep4.ui.p.hm<-ep(mut4.ui.p.hm,a4.ui.p.hm)
david4.ui.p.hm<-DS(mat4.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.hm<-cbind(ordrank.4.ui.p.hm,ds=david4.ui.p.hm$normDS)
lm4.ui.p.hm<-summary(lm(ordrank.4.ui.p.hm$ds~ordrank.4.ui.p.hm$ord.rank))
s4.ui.p.hm<-lm4.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[13]],X2=conflict.hm.ui.p[[14]],Victories=conflict.hm.ui.p[[15]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut5.ui.p.hm<-mut5.ui.p.hm[c(1:90),]
mut5.ui.p.hm<-transform(mut5.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat5.ui.p.hm<-inter.mat(mut5.ui.p.hm)
tri5.ui.p.hm<-tr.tri(mat5.ui.p.hm)
dci5.ui.p.hm<-DCindex(mat5.ui.p.hm)
mat5.ui.p.hm[is.na(mat5.ui.p.hm)] = 0
h5.ui.p.hm<-h.index(mat5.ui.p.hm)

ep5.ui.p.hm<-ep(mut5.ui.p.hm,a5.ui.p.hm)
david5.ui.p.hm<-DS(mat5.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.hm<-cbind(ordrank.5.ui.p.hm,ds=david5.ui.p.hm$normDS)
lm5.ui.p.hm<-summary(lm(ordrank.5.ui.p.hm$ds~ordrank.5.ui.p.hm$ord.rank))
s5.ui.p.hm<-lm5.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[16]],X2=conflict.hm.ui.p[[17]],Victories=conflict.hm.ui.p[[18]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut6.ui.p.hm<-mut6.ui.p.hm[c(1:90),]
mut6.ui.p.hm<-transform(mut6.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat6.ui.p.hm<-inter.mat(mut6.ui.p.hm)
tri6.ui.p.hm<-tr.tri(mat6.ui.p.hm)
dci6.ui.p.hm<-DCindex(mat6.ui.p.hm)
mat6.ui.p.hm[is.na(mat6.ui.p.hm)] = 0
h6.ui.p.hm<-h.index(mat6.ui.p.hm)

ep6.ui.p.hm<-ep(mut6.ui.p.hm,a6.ui.p.hm)
david6.ui.p.hm<-DS(mat6.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.hm<-cbind(ordrank.6.ui.p.hm,ds=david6.ui.p.hm$normDS)
lm6.ui.p.hm<-summary(lm(ordrank.6.ui.p.hm$ds~ordrank.6.ui.p.hm$ord.rank))
s6.ui.p.hm<-lm6.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[19]],X2=conflict.hm.ui.p[[20]],Victories=conflict.hm.ui.p[[21]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut7.ui.p.hm<-mut7.ui.p.hm[c(1:90),]
mut7.ui.p.hm<-transform(mut7.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat7.ui.p.hm<-inter.mat(mut7.ui.p.hm)
tri7.ui.p.hm<-tr.tri(mat7.ui.p.hm)
dci7.ui.p.hm<-DCindex(mat7.ui.p.hm)
mat7.ui.p.hm[is.na(mat7.ui.p.hm)] = 0
h7.ui.p.hm<-h.index(mat7.ui.p.hm)

ep7.ui.p.hm<-ep(mut7.ui.p.hm,a7.ui.p.hm)
david7.ui.p.hm<-DS(mat7.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.hm<-cbind(ordrank.7.ui.p.hm,ds=david7.ui.p.hm$normDS)
lm7.ui.p.hm<-summary(lm(ordrank.7.ui.p.hm$ds~ordrank.7.ui.p.hm$ord.rank))
s7.ui.p.hm<-lm7.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[22]],X2=conflict.hm.ui.p[[23]],Victories=conflict.hm.ui.p[[24]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut8.ui.p.hm<-mut8.ui.p.hm[c(1:90),]
mut8.ui.p.hm<-transform(mut8.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat8.ui.p.hm<-inter.mat(mut8.ui.p.hm)
tri8.ui.p.hm<-tr.tri(mat8.ui.p.hm)
dci8.ui.p.hm<-DCindex(mat8.ui.p.hm)
mat8.ui.p.hm[is.na(mat8.ui.p.hm)] = 0
h8.ui.p.hm<-h.index(mat8.ui.p.hm)

ep8.ui.p.hm<-ep(mut8.ui.p.hm,a8.ui.p.hm)
david8.ui.p.hm<-DS(mat8.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.hm<-cbind(ordrank.8.ui.p.hm,ds=david8.ui.p.hm$normDS)
lm8.ui.p.hm<-summary(lm(ordrank.8.ui.p.hm$ds~ordrank.8.ui.p.hm$ord.rank))
s8.ui.p.hm<-lm8.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[25]],X2=conflict.hm.ui.p[[26]],Victories=conflict.hm.ui.p[[27]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut9.ui.p.hm<-mut9.ui.p.hm[c(1:90),]
mut9.ui.p.hm<-transform(mut9.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat9.ui.p.hm<-inter.mat(mut9.ui.p.hm)
tri9.ui.p.hm<-tr.tri(mat9.ui.p.hm)
dci9.ui.p.hm<-DCindex(mat9.ui.p.hm)
mat9.ui.p.hm[is.na(mat9.ui.p.hm)] = 0
h9.ui.p.hm<-h.index(mat9.ui.p.hm)

ep9.ui.p.hm<-ep(mut9.ui.p.hm,a9.ui.p.hm)
david9.ui.p.hm<-DS(mat9.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.hm<-cbind(ordrank.9.ui.p.hm,ds=david9.ui.p.hm$normDS)
lm9.ui.p.hm<-summary(lm(ordrank.9.ui.p.hm$ds~ordrank.9.ui.p.hm$ord.rank))
s9.ui.p.hm<-lm9.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.hm<-data.frame(X1=conflict.hm.ui.p[[28]],X2=conflict.hm.ui.p[[29]],Victories=conflict.hm.ui.p[[30]])

#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
mut10.ui.p.hm<-mut10.ui.p.hm[c(1:90),]
mut10.ui.p.hm<-transform(mut10.ui.p.hm, X1=as.numeric(X1), X2=as.numeric(X2), Victories=as.numeric(Victories))

mat10.ui.p.hm<-inter.mat(mut10.ui.p.hm)
tri10.ui.p.hm<-tr.tri(mat10.ui.p.hm)
dci10.ui.p.hm<-DCindex(mat10.ui.p.hm)
mat10.ui.p.hm[is.na(mat10.ui.p.hm)] = 0
h10.ui.p.hm<-h.index(mat10.ui.p.hm)

ep10.ui.p.hm<-ep(mut10.ui.p.hm,a10.ui.p.hm)
david10.ui.p.hm<-DS(mat10.ui.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.hm<-cbind(ordrank.10.ui.p.hm,ds=david10.ui.p.hm$normDS)
lm10.ui.p.hm<-summary(lm(ordrank.10.ui.p.hm$ds~ordrank.10.ui.p.hm$ord.rank))
s10.ui.p.hm<-lm10.ui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.hm<-sum(mut1.ui.p.hm$Victories)
int2.ui.p.hm<-sum(mut2.ui.p.hm$Victories)
int3.ui.p.hm<-sum(mut3.ui.p.hm$Victories)
int4.ui.p.hm<-sum(mut4.ui.p.hm$Victories)
int5.ui.p.hm<-sum(mut5.ui.p.hm$Victories)
int6.ui.p.hm<-sum(mut6.ui.p.hm$Victories)
int7.ui.p.hm<-sum(mut7.ui.p.hm$Victories)
int8.ui.p.hm<-sum(mut8.ui.p.hm$Victories)
int9.ui.p.hm<-sum(mut9.ui.p.hm$Victories)
int10.ui.p.hm<-sum(mut10.ui.p.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.hm<-sum(a1.ui.p.hm$Victories)
av2.ui.p.hm<-sum(a2.ui.p.hm$Victories)
av3.ui.p.hm<-sum(a3.ui.p.hm$Victories)
av4.ui.p.hm<-sum(a4.ui.p.hm$Victories)
av5.ui.p.hm<-sum(a5.ui.p.hm$Victories)
av6.ui.p.hm<-sum(a6.ui.p.hm$Victories)
av7.ui.p.hm<-sum(a7.ui.p.hm$Victories)
av8.ui.p.hm<-sum(a8.ui.p.hm$Victories)
av9.ui.p.hm<-sum(a9.ui.p.hm$Victories)
av10.ui.p.hm<-sum(a10.ui.p.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.iu.p<-(sum(av1.ui.p.hm, av2.ui.p.hm, av3.ui.p.hm, av4.ui.p.hm, av5.ui.p.hm, av6.ui.p.hm, av7.ui.p.hm, av8.ui.p.hm, av9.ui.p.hm, av10.ui.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.iu.p<-(sum(int1.ui.p.hm, int2.ui.p.hm, int3.ui.p.hm, int4.ui.p.hm, int5.ui.p.hm, int6.ui.p.hm, int7.ui.p.hm, int8.ui.p.hm, int9.ui.p.hm, int10.ui.p.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e1.ui.p.hm<-e1.ui.p.hm[c(1:10),]
e1.1.ui.p.hm<-e1.ui.p.hm[order(e1.ui.p.hm$ID),]
e1.ui.p.hm<-as.matrix(t(e1.1.ui.p.hm))

e2.ui.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e2.ui.p.hm<-e2.ui.p.hm[c(1:10),]
e2.1.ui.p.hm<-e2.ui.p.hm[order(e2.ui.p.hm$ID),]
e2.ui.p.hm<-as.matrix(t(e2.1.ui.p.hm))

e3.ui.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e3.ui.p.hm<-e3.ui.p.hm[c(1:10),]
e3.1.ui.p.hm<-e3.ui.p.hm[order(e3.ui.p.hm$ID),]
e3.ui.p.hm<-as.matrix(t(e3.1.ui.p.hm))

e4.ui.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e4.ui.p.hm<-e4.ui.p.hm[c(1:10),]
e4.1.ui.p.hm<-e4.ui.p.hm[order(e4.ui.p.hm$ID),]
e4.ui.p.hm<-as.matrix(t(e4.1.ui.p.hm))

e5.ui.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e5.ui.p.hm<-e5.ui.p.hm[c(1:10),]
e5.1.ui.p.hm<-e5.ui.p.hm[order(e5.ui.p.hm$ID),]
e5.ui.p.hm<-as.matrix(t(e5.1.ui.p.hm))

e6.ui.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e6.ui.p.hm<-e6.ui.p.hm[c(1:10),]
e6.1.ui.p.hm<-e6.ui.p.hm[order(e6.ui.p.hm$ID),]
e6.ui.p.hm<-as.matrix(t(e6.1.ui.p.hm))

e7.ui.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e7.ui.p.hm<-e7.ui.p.hm[c(1:10),]
e7.1.ui.p.hm<-e7.ui.p.hm[order(e7.ui.p.hm$ID),]
e7.ui.p.hm<-as.matrix(t(e7.1.ui.p.hm))

e8.ui.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e8.ui.p.hm<-e8.ui.p.hm[c(1:10),]
e8.1.ui.p.hm<-e8.ui.p.hm[order(e8.ui.p.hm$ID),]
e8.ui.p.hm<-as.matrix(t(e8.1.ui.p.hm))

e9.ui.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e9.ui.p.hm<-e9.ui.p.hm[c(1:10),]
e9.1.ui.p.hm<-e9.ui.p.hm[order(e9.ui.p.hm$ID),]
e9.ui.p.hm<-as.matrix(t(e9.1.ui.p.hm))

e10.ui.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
#Issue with data that was read in from NetLogo, appears to have run twice in each of the 10 iterations for this scenario (uniform history mutual). Can fix this temporarily by only looking at rows 1-90 of the data file, but will likely need to be rerun.
e10.ui.p.hm<-e10.ui.p.hm[c(1:10),]
e10.1.ui.p.hm<-e10.ui.p.hm[order(e10.ui.p.hm$ID),]
e10.ui.p.hm<-as.matrix(t(e10.1.ui.p.hm))

energy.hm.ui.p.hm<-as.data.frame(matrix(c(e1.ui.p.hm,e2.ui.p.hm,e3.ui.p.hm,e4.ui.p.hm,e5.ui.p.hm,e6.ui.p.hm,e7.ui.p.hm,e8.ui.p.hm,e9.ui.p.hm,e10.ui.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.ui.p.hm<-data.frame(ID=energy.hm.ui.p.hm$V1,energy_over_distance=energy.hm.ui.p.hm$V2,energy_over_time=energy.hm.ui.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.hm<-david1.ui.p.hm[order(david1.ui.p.hm$ID),]
david1.ui.p.hm<-as.matrix(t(david1.1.ui.p.hm))

david2.1.ui.p.hm<-david2.ui.p.hm[order(david2.ui.p.hm$ID),]
david2.ui.p.hm<-as.matrix(t(david2.1.ui.p.hm))

david3.1.ui.p.hm<-david3.ui.p.hm[order(david3.ui.p.hm$ID),]
david3.ui.p.hm<-as.matrix(t(david3.1.ui.p.hm))

david4.1.ui.p.hm<-david4.ui.p.hm[order(david4.ui.p.hm$ID),]
david4.ui.p.hm<-as.matrix(t(david4.1.ui.p.hm))

david5.1.ui.p.hm<-david5.ui.p.hm[order(david5.ui.p.hm$ID),]
david5.ui.p.hm<-as.matrix(t(david5.1.ui.p.hm))

david6.1.ui.p.hm<-david6.ui.p.hm[order(david6.ui.p.hm$ID),]
david6.ui.p.hm<-as.matrix(t(david6.1.ui.p.hm))

david7.1.ui.p.hm<-david7.ui.p.hm[order(david7.ui.p.hm$ID),]
david7.ui.p.hm<-as.matrix(t(david7.1.ui.p.hm))

david8.1.ui.p.hm<-david8.ui.p.hm[order(david8.ui.p.hm$ID),]
david8.ui.p.hm<-as.matrix(t(david8.1.ui.p.hm))

david9.1.ui.p.hm<-david9.ui.p.hm[order(david9.ui.p.hm$ID),]
david9.ui.p.hm<-as.matrix(t(david9.1.ui.p.hm))

david10.1.ui.p.hm<-david10.ui.p.hm[order(david10.ui.p.hm$ID),]
david10.ui.p.hm<-as.matrix(t(david10.1.ui.p.hm))

david.hm.ui.p.hm<-as.data.frame(matrix(c(david1.ui.p.hm,david2.ui.p.hm,david3.ui.p.hm,david4.ui.p.hm,david5.ui.p.hm,david6.ui.p.hm,david7.ui.p.hm,david8.ui.p.hm,david9.ui.p.hm,david10.ui.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.ui.p.hm<-data.frame(ID=david.hm.ui.p.hm$V1,DS=david.hm.ui.p.hm$V2,normDS=david.hm.ui.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.ui.p.hm<-lm(e1.1.ui.p.hm$energy_over_time~as.numeric(david1.1.ui.p.hm$normDS))
hm.lm.1.s.ui.p.hm<-summary(lm.hm.1.ui.p.hm)$coefficients
hm.1.slope.ui.p.hm<-hm.lm.1.s.ui.p.hm[2,1]
lm.hm.2.ui.p.hm<-lm(e2.1.ui.p.hm$energy_over_time~as.numeric(david2.1.ui.p.hm$normDS))
hm.lm.2.s.ui.p.hm<-summary(lm.hm.2.ui.p.hm)$coefficients
hm.2.slope.ui.p.hm<-hm.lm.2.s.ui.p.hm[2,1]
lm.hm.3.ui.p.hm<-lm(e3.1.ui.p.hm$energy_over_time~as.numeric(david3.1.ui.p.hm$normDS))
hm.lm.3.s.ui.p.hm<-summary(lm.hm.3.ui.p.hm)$coefficients
hm.3.slope.ui.p.hm<-hm.lm.3.s.ui.p.hm[2,1]
lm.hm.4.ui.p.hm<-lm(e4.1.ui.p.hm$energy_over_time~as.numeric(david4.1.ui.p.hm$normDS))
hm.lm.4.s.ui.p.hm<-summary(lm.hm.4.ui.p.hm)$coefficients
hm.4.slope.ui.p.hm<-hm.lm.4.s.ui.p.hm[2,1]
lm.hm.5.ui.p.hm<-lm(e5.1.ui.p.hm$energy_over_time~as.numeric(david5.1.ui.p.hm$normDS))
hm.lm.5.s.ui.p.hm<-summary(lm.hm.5.ui.p.hm)$coefficients
hm.5.slope.ui.p.hm<-hm.lm.5.s.ui.p.hm[2,1]
lm.hm.6.ui.p.hm<-lm(e6.1.ui.p.hm$energy_over_time~as.numeric(david6.1.ui.p.hm$normDS))
hm.lm.6.s.ui.p.hm<-summary(lm.hm.6.ui.p.hm)$coefficients
hm.6.slope.ui.p.hm<-hm.lm.6.s.ui.p.hm[2,1]
lm.hm.7.ui.p.hm<-lm(e7.1.ui.p.hm$energy_over_time~as.numeric(david7.1.ui.p.hm$normDS))
hm.lm.7.s.ui.p.hm<-summary(lm.hm.7.ui.p.hm)$coefficients
hm.7.slope.ui.p.hm<-hm.lm.7.s.ui.p.hm[2,1]
lm.hm.8.ui.p.hm<-lm(e8.1.ui.p.hm$energy_over_time~as.numeric(david8.1.ui.p.hm$normDS))
hm.lm.8.s.ui.p.hm<-summary(lm.hm.8.ui.p.hm)$coefficients
hm.8.slope.ui.p.hm<-hm.lm.8.s.ui.p.hm[2,1]
lm.hm.9.ui.p.hm<-lm(e9.1.ui.p.hm$energy_over_time~as.numeric(david9.1.ui.p.hm$normDS))
hm.lm.9.s.ui.p.hm<-summary(lm.hm.9.ui.p.hm)$coefficients
hm.9.slope.ui.p.hm<-hm.lm.9.s.ui.p.hm[2,1]
lm.hm.10.ui.p.hm<-lm(e10.1.ui.p.hm$energy_over_time~as.numeric(david10.1.ui.p.hm$normDS))
hm.lm.10.s.ui.p.hm<-summary(lm.hm.10.ui.p.hm)$coefficients
hm.10.slope.ui.p.hm<-hm.lm.10.s.ui.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.hm,tri2.ui.p.hm,tri3.ui.p.hm,tri4.ui.p.hm,tri5.ui.p.hm,tri6.ui.p.hm,tri7.ui.p.hm,tri8.ui.p.hm,tri9.ui.p.hm,tri10.ui.p.hm),escalation=c(ep1.ui.p.hm,ep2.ui.p.hm,ep3.ui.p.hm,ep4.ui.p.hm,ep5.ui.p.hm,ep6.ui.p.hm,ep7.ui.p.hm,ep8.ui.p.hm,ep9.ui.p.hm,ep10.ui.p.hm),dci=c(dci1.ui.p.hm,dci2.ui.p.hm,dci3.ui.p.hm,dci4.ui.p.hm,dci5.ui.p.hm,dci6.ui.p.hm,dci7.ui.p.hm,dci8.ui.p.hm,dci9.ui.p.hm,dci10.ui.p.hm),steepness=c(s1.ui.p.hm,s2.ui.p.hm,s3.ui.p.hm,s4.ui.p.hm,s5.ui.p.hm,s6.ui.p.hm,s7.ui.p.hm,s8.ui.p.hm,s9.ui.p.hm,s10.ui.p.hm),slope=c(hm.1.slope.ui.p.hm,hm.2.slope.ui.p.hm,hm.3.slope.ui.p.hm,hm.4.slope.ui.p.hm,hm.5.slope.ui.p.hm,hm.6.slope.ui.p.hm,hm.7.slope.ui.p.hm,hm.8.slope.ui.p.hm,hm.9.slope.ui.p.hm,hm.10.slope.ui.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.hs<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[1]],X2=avoid.ui.p.hs[[2]],Avoids=avoid.ui.p.hs[[3]])
a2.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[4]],X2=avoid.ui.p.hs[[5]],Avoids=avoid.ui.p.hs[[6]])
a3.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[7]],X2=avoid.ui.p.hs[[8]],Avoids=avoid.ui.p.hs[[9]])
a4.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[10]],X2=avoid.ui.p.hs[[11]],Avoids=avoid.ui.p.hs[[12]])
a5.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[13]],X2=avoid.ui.p.hs[[14]],Avoids=avoid.ui.p.hs[[15]])
a6.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[16]],X2=avoid.ui.p.hs[[17]],Avoids=avoid.ui.p.hs[[18]])
a7.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[19]],X2=avoid.ui.p.hs[[20]],Avoids=avoid.ui.p.hs[[21]])
a8.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[22]],X2=avoid.ui.p.hs[[23]],Avoids=avoid.ui.p.hs[[24]])
a9.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[25]],X2=avoid.ui.p.hs[[26]],Avoids=avoid.ui.p.hs[[27]])
a10.ui.p.hs<-data.frame(X1=avoid.ui.p.hs[[28]],X2=avoid.ui.p.hs[[29]],Avoids=avoid.ui.p.hs[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.hs.ui.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[1]],X2=conflict.hs.ui.p[[2]],Victories=conflict.hs.ui.p[[3]])
mat1.ui.p.hs<-inter.mat(mut1.ui.p.hs)
tri1.ui.p.hs<-tr.tri(mat1.ui.p.hs)
dci1.ui.p.hs<-DCindex(mat1.ui.p.hs)
mat1.ui.p.hs[is.na(mat1.ui.p.hs)] = 0
h1.ui.p.hs<-h.index(mat1.ui.p.hs)

ep1.ui.p.hs<-ep(mut1.ui.p.hs,a1.ui.p.hs)
david1.ui.p.hs<-DS(mat1.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.hs<-cbind(ordrank.1.ui.p.hs,ds=david1.ui.p.hs$normDS)
lm1.ui.p.hs<-summary(lm(ordrank.1.ui.p.hs$ds~ordrank.1.ui.p.hs$ord.rank))
s1.ui.p.hs<-lm1.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[4]],X2=conflict.hs.ui.p[[5]],Victories=conflict.hs.ui.p[[6]])
mat2.ui.p.hs<-inter.mat(mut2.ui.p.hs)
tri2.ui.p.hs<-tr.tri(mat2.ui.p.hs)
dci2.ui.p.hs<-DCindex(mat2.ui.p.hs)
mat2.ui.p.hs[is.na(mat2.ui.p.hs)] = 0
h2.ui.p.hs<-h.index(mat2.ui.p.hs)

ep2.ui.p.hs<-ep(mut2.ui.p.hs,a2.ui.p.hs)
david2.ui.p.hs<-DS(mat2.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.hs<-cbind(ordrank.2.ui.p.hs,ds=david2.ui.p.hs$normDS)
lm2.ui.p.hs<-summary(lm(ordrank.2.ui.p.hs$ds~ordrank.2.ui.p.hs$ord.rank))
s2.ui.p.hs<-lm2.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[7]],X2=conflict.hs.ui.p[[8]],Victories=conflict.hs.ui.p[[9]])
mat3.ui.p.hs<-inter.mat(mut3.ui.p.hs)
tri3.ui.p.hs<-tr.tri(mat3.ui.p.hs)
dci3.ui.p.hs<-DCindex(mat3.ui.p.hs)
mat3.ui.p.hs[is.na(mat3.ui.p.hs)] = 0
h3.ui.p.hs<-h.index(mat3.ui.p.hs)

ep3.ui.p.hs<-ep(mut3.ui.p.hs,a3.ui.p.hs)
david3.ui.p.hs<-DS(mat3.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.hs<-cbind(ordrank.3.ui.p.hs,ds=david3.ui.p.hs$normDS)
lm3.ui.p.hs<-summary(lm(ordrank.3.ui.p.hs$ds~ordrank.3.ui.p.hs$ord.rank))
s3.ui.p.hs<-lm3.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[10]],X2=conflict.hs.ui.p[[11]],Victories=conflict.hs.ui.p[[12]])
mat4.ui.p.hs<-inter.mat(mut4.ui.p.hs)
tri4.ui.p.hs<-tr.tri(mat4.ui.p.hs)
dci4.ui.p.hs<-DCindex(mat4.ui.p.hs)
mat4.ui.p.hs[is.na(mat4.ui.p.hs)] = 0
h4.ui.p.hs<-h.index(mat4.ui.p.hs)

ep4.ui.p.hs<-ep(mut4.ui.p.hs,a4.ui.p.hs)
david4.ui.p.hs<-DS(mat4.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.hs<-cbind(ordrank.4.ui.p.hs,ds=david4.ui.p.hs$normDS)
lm4.ui.p.hs<-summary(lm(ordrank.4.ui.p.hs$ds~ordrank.4.ui.p.hs$ord.rank))
s4.ui.p.hs<-lm4.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[13]],X2=conflict.hs.ui.p[[14]],Victories=conflict.hs.ui.p[[15]])
mat5.ui.p.hs<-inter.mat(mut5.ui.p.hs)
tri5.ui.p.hs<-tr.tri(mat5.ui.p.hs)
dci5.ui.p.hs<-DCindex(mat5.ui.p.hs)
mat5.ui.p.hs[is.na(mat5.ui.p.hs)] = 0
h5.ui.p.hs<-h.index(mat5.ui.p.hs)

ep5.ui.p.hs<-ep(mut5.ui.p.hs,a5.ui.p.hs)
david5.ui.p.hs<-DS(mat5.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.hs<-cbind(ordrank.5.ui.p.hs,ds=david5.ui.p.hs$normDS)
lm5.ui.p.hs<-summary(lm(ordrank.5.ui.p.hs$ds~ordrank.5.ui.p.hs$ord.rank))
s5.ui.p.hs<-lm5.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[16]],X2=conflict.hs.ui.p[[17]],Victories=conflict.hs.ui.p[[18]])
mat6.ui.p.hs<-inter.mat(mut6.ui.p.hs)
tri6.ui.p.hs<-tr.tri(mat6.ui.p.hs)
dci6.ui.p.hs<-DCindex(mat6.ui.p.hs)
mat6.ui.p.hs[is.na(mat6.ui.p.hs)] = 0
h6.ui.p.hs<-h.index(mat6.ui.p.hs)

ep6.ui.p.hs<-ep(mut6.ui.p.hs,a6.ui.p.hs)
david6.ui.p.hs<-DS(mat6.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.hs<-cbind(ordrank.6.ui.p.hs,ds=david6.ui.p.hs$normDS)
lm6.ui.p.hs<-summary(lm(ordrank.6.ui.p.hs$ds~ordrank.6.ui.p.hs$ord.rank))
s6.ui.p.hs<-lm6.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[19]],X2=conflict.hs.ui.p[[20]],Victories=conflict.hs.ui.p[[21]])
mat7.ui.p.hs<-inter.mat(mut7.ui.p.hs)
tri7.ui.p.hs<-tr.tri(mat7.ui.p.hs)
dci7.ui.p.hs<-DCindex(mat7.ui.p.hs)
mat7.ui.p.hs[is.na(mat7.ui.p.hs)] = 0
h7.ui.p.hs<-h.index(mat7.ui.p.hs)

ep7.ui.p.hs<-ep(mut7.ui.p.hs,a7.ui.p.hs)
david7.ui.p.hs<-DS(mat7.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.hs<-cbind(ordrank.7.ui.p.hs,ds=david7.ui.p.hs$normDS)
lm7.ui.p.hs<-summary(lm(ordrank.7.ui.p.hs$ds~ordrank.7.ui.p.hs$ord.rank))
s7.ui.p.hs<-lm7.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[22]],X2=conflict.hs.ui.p[[23]],Victories=conflict.hs.ui.p[[24]])
mat8.ui.p.hs<-inter.mat(mut8.ui.p.hs)
tri8.ui.p.hs<-tr.tri(mat8.ui.p.hs)
dci8.ui.p.hs<-DCindex(mat8.ui.p.hs)
mat8.ui.p.hs[is.na(mat8.ui.p.hs)] = 0
h8.ui.p.hs<-h.index(mat8.ui.p.hs)

ep8.ui.p.hs<-ep(mut8.ui.p.hs,a8.ui.p.hs)
david8.ui.p.hs<-DS(mat8.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.hs<-cbind(ordrank.8.ui.p.hs,ds=david8.ui.p.hs$normDS)
lm8.ui.p.hs<-summary(lm(ordrank.8.ui.p.hs$ds~ordrank.8.ui.p.hs$ord.rank))
s8.ui.p.hs<-lm8.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[25]],X2=conflict.hs.ui.p[[26]],Victories=conflict.hs.ui.p[[27]])
mat9.ui.p.hs<-inter.mat(mut9.ui.p.hs)
tri9.ui.p.hs<-tr.tri(mat9.ui.p.hs)
dci9.ui.p.hs<-DCindex(mat9.ui.p.hs)
mat9.ui.p.hs[is.na(mat9.ui.p.hs)] = 0
h9.ui.p.hs<-h.index(mat9.ui.p.hs)

ep9.ui.p.hs<-ep(mut9.ui.p.hs,a9.ui.p.hs)
david9.ui.p.hs<-DS(mat9.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.hs<-cbind(ordrank.9.ui.p.hs,ds=david9.ui.p.hs$normDS)
lm9.ui.p.hs<-summary(lm(ordrank.9.ui.p.hs$ds~ordrank.9.ui.p.hs$ord.rank))
s9.ui.p.hs<-lm9.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.hs<-data.frame(X1=conflict.hs.ui.p[[28]],X2=conflict.hs.ui.p[[29]],Victories=conflict.hs.ui.p[[30]])
mat10.ui.p.hs<-inter.mat(mut10.ui.p.hs)
tri10.ui.p.hs<-tr.tri(mat10.ui.p.hs)
dci10.ui.p.hs<-DCindex(mat10.ui.p.hs)
mat10.ui.p.hs[is.na(mat10.ui.p.hs)] = 0
h10.ui.p.hs<-h.index(mat10.ui.p.hs)

ep10.ui.p.hs<-ep(mut10.ui.p.hs,a10.ui.p.hs)
david10.ui.p.hs<-DS(mat10.ui.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.hs<-cbind(ordrank.10.ui.p.hs,ds=david10.ui.p.hs$normDS)
lm10.ui.p.hs<-summary(lm(ordrank.10.ui.p.hs$ds~ordrank.10.ui.p.hs$ord.rank))
s10.ui.p.hs<-lm10.ui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.hs<-sum(mut1.ui.p.hs$Victories)
int2.ui.p.hs<-sum(mut2.ui.p.hs$Victories)
int3.ui.p.hs<-sum(mut3.ui.p.hs$Victories)
int4.ui.p.hs<-sum(mut4.ui.p.hs$Victories)
int5.ui.p.hs<-sum(mut5.ui.p.hs$Victories)
int6.ui.p.hs<-sum(mut6.ui.p.hs$Victories)
int7.ui.p.hs<-sum(mut7.ui.p.hs$Victories)
int8.ui.p.hs<-sum(mut8.ui.p.hs$Victories)
int9.ui.p.hs<-sum(mut9.ui.p.hs$Victories)
int10.ui.p.hs<-sum(mut10.ui.p.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.hs<-sum(a1.ui.p.hs$Victories)
av2.ui.p.hs<-sum(a2.ui.p.hs$Victories)
av3.ui.p.hs<-sum(a3.ui.p.hs$Victories)
av4.ui.p.hs<-sum(a4.ui.p.hs$Victories)
av5.ui.p.hs<-sum(a5.ui.p.hs$Victories)
av6.ui.p.hs<-sum(a6.ui.p.hs$Victories)
av7.ui.p.hs<-sum(a7.ui.p.hs$Victories)
av8.ui.p.hs<-sum(a8.ui.p.hs$Victories)
av9.ui.p.hs<-sum(a9.ui.p.hs$Victories)
av10.ui.p.hs<-sum(a10.ui.p.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.iu.p<-(sum(av1.ui.p.hs, av2.ui.p.hs, av3.ui.p.hs, av4.ui.p.hs, av5.ui.p.hs, av6.ui.p.hs, av7.ui.p.hs, av8.ui.p.hs, av9.ui.p.hs, av10.ui.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.iu.p<-(sum(int1.ui.p.hs, int2.ui.p.hs, int3.ui.p.hs, int4.ui.p.hs, int5.ui.p.hs, int6.ui.p.hs, int7.ui.p.hs, int8.ui.p.hs, int9.ui.p.hs, int10.ui.p.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.p.hs<-e1.ui.p.hs[order(e1.ui.p.hs$ID),]
e1.ui.p.hs<-as.matrix(t(e1.1.ui.p.hs))

e2.ui.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.p.hs<-e2.ui.p.hs[order(e2.ui.p.hs$ID),]
e2.ui.p.hs<-as.matrix(t(e2.1.ui.p.hs))

e3.ui.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.p.hs<-e3.ui.p.hs[order(e3.ui.p.hs$ID),]
e3.ui.p.hs<-as.matrix(t(e3.1.ui.p.hs))

e4.ui.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.p.hs<-e4.ui.p.hs[order(e4.ui.p.hs$ID),]
e4.ui.p.hs<-as.matrix(t(e4.1.ui.p.hs))

e5.ui.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.p.hs<-e5.ui.p.hs[order(e5.ui.p.hs$ID),]
e5.ui.p.hs<-as.matrix(t(e5.1.ui.p.hs))

e6.ui.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.p.hs<-e6.ui.p.hs[order(e6.ui.p.hs$ID),]
e6.ui.p.hs<-as.matrix(t(e6.1.ui.p.hs))

e7.ui.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.p.hs<-e7.ui.p.hs[order(e7.ui.p.hs$ID),]
e7.ui.p.hs<-as.matrix(t(e7.1.ui.p.hs))

e8.ui.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.p.hs<-e8.ui.p.hs[order(e8.ui.p.hs$ID),]
e8.ui.p.hs<-as.matrix(t(e8.1.ui.p.hs))

e9.ui.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.p.hs<-e9.ui.p.hs[order(e9.ui.p.hs$ID),]
e9.ui.p.hs<-as.matrix(t(e9.1.ui.p.hs))

e10.ui.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.p.hs<-e10.ui.p.hs[order(e10.ui.p.hs$ID),]
e10.ui.p.hs<-as.matrix(t(e10.1.ui.p.hs))

energy.hs.ui.p.hs<-as.data.frame(matrix(c(e1.ui.p.hs,e2.ui.p.hs,e3.ui.p.hs,e4.ui.p.hs,e5.ui.p.hs,e6.ui.p.hs,e7.ui.p.hs,e8.ui.p.hs,e9.ui.p.hs,e10.ui.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.ui.p.hs<-data.frame(ID=energy.hs.ui.p.hs$V1,energy_over_distance=energy.hs.ui.p.hs$V2,energy_over_time=energy.hs.ui.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.hs<-david1.ui.p.hs[order(david1.ui.p.hs$ID),]
david1.ui.p.hs<-as.matrix(t(david1.1.ui.p.hs))

david2.1.ui.p.hs<-david2.ui.p.hs[order(david2.ui.p.hs$ID),]
david2.ui.p.hs<-as.matrix(t(david2.1.ui.p.hs))

david3.1.ui.p.hs<-david3.ui.p.hs[order(david3.ui.p.hs$ID),]
david3.ui.p.hs<-as.matrix(t(david3.1.ui.p.hs))

david4.1.ui.p.hs<-david4.ui.p.hs[order(david4.ui.p.hs$ID),]
david4.ui.p.hs<-as.matrix(t(david4.1.ui.p.hs))

david5.1.ui.p.hs<-david5.ui.p.hs[order(david5.ui.p.hs$ID),]
david5.ui.p.hs<-as.matrix(t(david5.1.ui.p.hs))

david6.1.ui.p.hs<-david6.ui.p.hs[order(david6.ui.p.hs$ID),]
david6.ui.p.hs<-as.matrix(t(david6.1.ui.p.hs))

david7.1.ui.p.hs<-david7.ui.p.hs[order(david7.ui.p.hs$ID),]
david7.ui.p.hs<-as.matrix(t(david7.1.ui.p.hs))

david8.1.ui.p.hs<-david8.ui.p.hs[order(david8.ui.p.hs$ID),]
david8.ui.p.hs<-as.matrix(t(david8.1.ui.p.hs))

david9.1.ui.p.hs<-david9.ui.p.hs[order(david9.ui.p.hs$ID),]
david9.ui.p.hs<-as.matrix(t(david9.1.ui.p.hs))

david10.1.ui.p.hs<-david10.ui.p.hs[order(david10.ui.p.hs$ID),]
david10.ui.p.hs<-as.matrix(t(david10.1.ui.p.hs))

david.hs.ui.p.hs<-as.data.frame(matrix(c(david1.ui.p.hs,david2.ui.p.hs,david3.ui.p.hs,david4.ui.p.hs,david5.ui.p.hs,david6.ui.p.hs,david7.ui.p.hs,david8.ui.p.hs,david9.ui.p.hs,david10.ui.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.ui.p.hs<-data.frame(ID=david.hs.ui.p.hs$V1,DS=david.hs.ui.p.hs$V2,normDS=david.hs.ui.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.ui.p.hs<-lm(e1.1.ui.p.hs$energy_over_time~as.numeric(david1.1.ui.p.hs$normDS))
hs.lm.1.s.ui.p.hs<-summary(lm.hs.1.ui.p.hs)$coefficients
hs.1.slope.ui.p.hs<-hs.lm.1.s.ui.p.hs[2,1]
lm.hs.2.ui.p.hs<-lm(e2.1.ui.p.hs$energy_over_time~as.numeric(david2.1.ui.p.hs$normDS))
hs.lm.2.s.ui.p.hs<-summary(lm.hs.2.ui.p.hs)$coefficients
hs.2.slope.ui.p.hs<-hs.lm.2.s.ui.p.hs[2,1]
lm.hs.3.ui.p.hs<-lm(e3.1.ui.p.hs$energy_over_time~as.numeric(david3.1.ui.p.hs$normDS))
hs.lm.3.s.ui.p.hs<-summary(lm.hs.3.ui.p.hs)$coefficients
hs.3.slope.ui.p.hs<-hs.lm.3.s.ui.p.hs[2,1]
lm.hs.4.ui.p.hs<-lm(e4.1.ui.p.hs$energy_over_time~as.numeric(david4.1.ui.p.hs$normDS))
hs.lm.4.s.ui.p.hs<-summary(lm.hs.4.ui.p.hs)$coefficients
hs.4.slope.ui.p.hs<-hs.lm.4.s.ui.p.hs[2,1]
lm.hs.5.ui.p.hs<-lm(e5.1.ui.p.hs$energy_over_time~as.numeric(david5.1.ui.p.hs$normDS))
hs.lm.5.s.ui.p.hs<-summary(lm.hs.5.ui.p.hs)$coefficients
hs.5.slope.ui.p.hs<-hs.lm.5.s.ui.p.hs[2,1]
lm.hs.6.ui.p.hs<-lm(e6.1.ui.p.hs$energy_over_time~as.numeric(david6.1.ui.p.hs$normDS))
hs.lm.6.s.ui.p.hs<-summary(lm.hs.6.ui.p.hs)$coefficients
hs.6.slope.ui.p.hs<-hs.lm.6.s.ui.p.hs[2,1]
lm.hs.7.ui.p.hs<-lm(e7.1.ui.p.hs$energy_over_time~as.numeric(david7.1.ui.p.hs$normDS))
hs.lm.7.s.ui.p.hs<-summary(lm.hs.7.ui.p.hs)$coefficients
hs.7.slope.ui.p.hs<-hs.lm.7.s.ui.p.hs[2,1]
lm.hs.8.ui.p.hs<-lm(e8.1.ui.p.hs$energy_over_time~as.numeric(david8.1.ui.p.hs$normDS))
hs.lm.8.s.ui.p.hs<-summary(lm.hs.8.ui.p.hs)$coefficients
hs.8.slope.ui.p.hs<-hs.lm.8.s.ui.p.hs[2,1]
lm.hs.9.ui.p.hs<-lm(e9.1.ui.p.hs$energy_over_time~as.numeric(david9.1.ui.p.hs$normDS))
hs.lm.9.s.ui.p.hs<-summary(lm.hs.9.ui.p.hs)$coefficients
hs.9.slope.ui.p.hs<-hs.lm.9.s.ui.p.hs[2,1]
lm.hs.10.ui.p.hs<-lm(e10.1.ui.p.hs$energy_over_time~as.numeric(david10.1.ui.p.hs$normDS))
hs.lm.10.s.ui.p.hs<-summary(lm.hs.10.ui.p.hs)$coefficients
hs.10.slope.ui.p.hs<-hs.lm.10.s.ui.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.hs,tri2.ui.p.hs,tri3.ui.p.hs,tri4.ui.p.hs,tri5.ui.p.hs,tri6.ui.p.hs,tri7.ui.p.hs,tri8.ui.p.hs,tri9.ui.p.hs,tri10.ui.p.hs),escalation=c(ep1.ui.p.hs,ep2.ui.p.hs,ep3.ui.p.hs,ep4.ui.p.hs,ep5.ui.p.hs,ep6.ui.p.hs,ep7.ui.p.hs,ep8.ui.p.hs,ep9.ui.p.hs,ep10.ui.p.hs),dci=c(dci1.ui.p.hs,dci2.ui.p.hs,dci3.ui.p.hs,dci4.ui.p.hs,dci5.ui.p.hs,dci6.ui.p.hs,dci7.ui.p.hs,dci8.ui.p.hs,dci9.ui.p.hs,dci10.ui.p.hs),steepness=c(s1.ui.p.hs,s2.ui.p.hs,s3.ui.p.hs,s4.ui.p.hs,s5.ui.p.hs,s6.ui.p.hs,s7.ui.p.hs,s8.ui.p.hs,s9.ui.p.hs,s10.ui.p.hs),slope=c(hs.1.slope.ui.p.hs,hs.2.slope.ui.p.hs,hs.3.slope.ui.p.hs,hs.4.slope.ui.p.hs,hs.5.slope.ui.p.hs,hs.6.slope.ui.p.hs,hs.7.slope.ui.p.hs,hs.8.slope.ui.p.hs,hs.9.slope.ui.p.hs,hs.10.slope.ui.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

# Read in avoidance data associated with these specific trials:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/avoid")

files<-list.files(pattern="*.csv")
avoid.ui.p.ho<-sapply(files, read.csv)

# Separate out the avoidance data into the individual trials:
a1.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[1]],X2=avoid.ui.p.ho[[2]],Avoids=avoid.ui.p.ho[[3]])
a2.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[4]],X2=avoid.ui.p.ho[[5]],Avoids=avoid.ui.p.ho[[6]])
a3.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[7]],X2=avoid.ui.p.ho[[8]],Avoids=avoid.ui.p.ho[[9]])
a4.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[10]],X2=avoid.ui.p.ho[[11]],Avoids=avoid.ui.p.ho[[12]])
a5.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[13]],X2=avoid.ui.p.ho[[14]],Avoids=avoid.ui.p.ho[[15]])
a6.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[16]],X2=avoid.ui.p.ho[[17]],Avoids=avoid.ui.p.ho[[18]])
a7.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[19]],X2=avoid.ui.p.ho[[20]],Avoids=avoid.ui.p.ho[[21]])
a8.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[22]],X2=avoid.ui.p.ho[[23]],Avoids=avoid.ui.p.ho[[24]])
a9.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[25]],X2=avoid.ui.p.ho[[26]],Avoids=avoid.ui.p.ho[[27]])
a10.ui.p.ho<-data.frame(X1=avoid.ui.p.ho[[28]],X2=avoid.ui.p.ho[[29]],Avoids=avoid.ui.p.ho[[30]])


# Set the working directory from which the files will be read from:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/conflict")

files<-list.files(pattern="*.csv")
conflict.ho.ui.p<-sapply(files, read.csv)

# Generate interaction matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[1]],X2=conflict.ho.ui.p[[2]],Victories=conflict.ho.ui.p[[3]])
mat1.ui.p.ho<-inter.mat(mut1.ui.p.ho)
tri1.ui.p.ho<-tr.tri(mat1.ui.p.ho)
dci1.ui.p.ho<-DCindex(mat1.ui.p.ho)
mat1.ui.p.ho[is.na(mat1.ui.p.ho)] = 0
h1.ui.p.ho<-h.index(mat1.ui.p.ho)

ep1.ui.p.ho<-ep(mut1.ui.p.ho,a1.ui.p.ho)
david1.ui.p.ho<-DS(mat1.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.ui.p.ho<-cbind(ordrank.1.ui.p.ho,ds=david1.ui.p.ho$normDS)
lm1.ui.p.ho<-summary(lm(ordrank.1.ui.p.ho$ds~ordrank.1.ui.p.ho$ord.rank))
s1.ui.p.ho<-lm1.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[4]],X2=conflict.ho.ui.p[[5]],Victories=conflict.ho.ui.p[[6]])
mat2.ui.p.ho<-inter.mat(mut2.ui.p.ho)
tri2.ui.p.ho<-tr.tri(mat2.ui.p.ho)
dci2.ui.p.ho<-DCindex(mat2.ui.p.ho)
mat2.ui.p.ho[is.na(mat2.ui.p.ho)] = 0
h2.ui.p.ho<-h.index(mat2.ui.p.ho)

ep2.ui.p.ho<-ep(mut2.ui.p.ho,a2.ui.p.ho)
david2.ui.p.ho<-DS(mat2.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.ui.p.ho<-cbind(ordrank.2.ui.p.ho,ds=david2.ui.p.ho$normDS)
lm2.ui.p.ho<-summary(lm(ordrank.2.ui.p.ho$ds~ordrank.2.ui.p.ho$ord.rank))
s2.ui.p.ho<-lm2.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[7]],X2=conflict.ho.ui.p[[8]],Victories=conflict.ho.ui.p[[9]])
mat3.ui.p.ho<-inter.mat(mut3.ui.p.ho)
tri3.ui.p.ho<-tr.tri(mat3.ui.p.ho)
dci3.ui.p.ho<-DCindex(mat3.ui.p.ho)
mat3.ui.p.ho[is.na(mat3.ui.p.ho)] = 0
h3.ui.p.ho<-h.index(mat3.ui.p.ho)

ep3.ui.p.ho<-ep(mut3.ui.p.ho,a3.ui.p.ho)
david3.ui.p.ho<-DS(mat3.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.ui.p.ho<-cbind(ordrank.3.ui.p.ho,ds=david3.ui.p.ho$normDS)
lm3.ui.p.ho<-summary(lm(ordrank.3.ui.p.ho$ds~ordrank.3.ui.p.ho$ord.rank))
s3.ui.p.ho<-lm3.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[10]],X2=conflict.ho.ui.p[[11]],Victories=conflict.ho.ui.p[[12]])
mat4.ui.p.ho<-inter.mat(mut4.ui.p.ho)
tri4.ui.p.ho<-tr.tri(mat4.ui.p.ho)
dci4.ui.p.ho<-DCindex(mat4.ui.p.ho)
mat4.ui.p.ho[is.na(mat4.ui.p.ho)] = 0
h4.ui.p.ho<-h.index(mat4.ui.p.ho)

ep4.ui.p.ho<-ep(mut4.ui.p.ho,a4.ui.p.ho)
david4.ui.p.ho<-DS(mat4.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.ui.p.ho<-cbind(ordrank.4.ui.p.ho,ds=david4.ui.p.ho$normDS)
lm4.ui.p.ho<-summary(lm(ordrank.4.ui.p.ho$ds~ordrank.4.ui.p.ho$ord.rank))
s4.ui.p.ho<-lm4.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[13]],X2=conflict.ho.ui.p[[14]],Victories=conflict.ho.ui.p[[15]])
mat5.ui.p.ho<-inter.mat(mut5.ui.p.ho)
tri5.ui.p.ho<-tr.tri(mat5.ui.p.ho)
dci5.ui.p.ho<-DCindex(mat5.ui.p.ho)
mat5.ui.p.ho[is.na(mat5.ui.p.ho)] = 0
h5.ui.p.ho<-h.index(mat5.ui.p.ho)

ep5.ui.p.ho<-ep(mut5.ui.p.ho,a5.ui.p.ho)
david5.ui.p.ho<-DS(mat5.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.ui.p.ho<-cbind(ordrank.5.ui.p.ho,ds=david5.ui.p.ho$normDS)
lm5.ui.p.ho<-summary(lm(ordrank.5.ui.p.ho$ds~ordrank.5.ui.p.ho$ord.rank))
s5.ui.p.ho<-lm5.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[16]],X2=conflict.ho.ui.p[[17]],Victories=conflict.ho.ui.p[[18]])
mat6.ui.p.ho<-inter.mat(mut6.ui.p.ho)
tri6.ui.p.ho<-tr.tri(mat6.ui.p.ho)
dci6.ui.p.ho<-DCindex(mat6.ui.p.ho)
mat6.ui.p.ho[is.na(mat6.ui.p.ho)] = 0
h6.ui.p.ho<-h.index(mat6.ui.p.ho)

ep6.ui.p.ho<-ep(mut6.ui.p.ho,a6.ui.p.ho)
david6.ui.p.ho<-DS(mat6.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.ui.p.ho<-cbind(ordrank.6.ui.p.ho,ds=david6.ui.p.ho$normDS)
lm6.ui.p.ho<-summary(lm(ordrank.6.ui.p.ho$ds~ordrank.6.ui.p.ho$ord.rank))
s6.ui.p.ho<-lm6.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[19]],X2=conflict.ho.ui.p[[20]],Victories=conflict.ho.ui.p[[21]])
mat7.ui.p.ho<-inter.mat(mut7.ui.p.ho)
tri7.ui.p.ho<-tr.tri(mat7.ui.p.ho)
dci7.ui.p.ho<-DCindex(mat7.ui.p.ho)
mat7.ui.p.ho[is.na(mat7.ui.p.ho)] = 0
h7.ui.p.ho<-h.index(mat7.ui.p.ho)

ep7.ui.p.ho<-ep(mut7.ui.p.ho,a7.ui.p.ho)
david7.ui.p.ho<-DS(mat7.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.ui.p.ho<-cbind(ordrank.7.ui.p.ho,ds=david7.ui.p.ho$normDS)
lm7.ui.p.ho<-summary(lm(ordrank.7.ui.p.ho$ds~ordrank.7.ui.p.ho$ord.rank))
s7.ui.p.ho<-lm7.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[22]],X2=conflict.ho.ui.p[[23]],Victories=conflict.ho.ui.p[[24]])
mat8.ui.p.ho<-inter.mat(mut8.ui.p.ho)
tri8.ui.p.ho<-tr.tri(mat8.ui.p.ho)
dci8.ui.p.ho<-DCindex(mat8.ui.p.ho)
mat8.ui.p.ho[is.na(mat8.ui.p.ho)] = 0
h8.ui.p.ho<-h.index(mat8.ui.p.ho)

ep8.ui.p.ho<-ep(mut8.ui.p.ho,a8.ui.p.ho)
david8.ui.p.ho<-DS(mat8.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.ui.p.ho<-cbind(ordrank.8.ui.p.ho,ds=david8.ui.p.ho$normDS)
lm8.ui.p.ho<-summary(lm(ordrank.8.ui.p.ho$ds~ordrank.8.ui.p.ho$ord.rank))
s8.ui.p.ho<-lm8.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[25]],X2=conflict.ho.ui.p[[26]],Victories=conflict.ho.ui.p[[27]])
mat9.ui.p.ho<-inter.mat(mut9.ui.p.ho)
tri9.ui.p.ho<-tr.tri(mat9.ui.p.ho)
dci9.ui.p.ho<-DCindex(mat9.ui.p.ho)
mat9.ui.p.ho[is.na(mat9.ui.p.ho)] = 0
h9.ui.p.ho<-h.index(mat9.ui.p.ho)

ep9.ui.p.ho<-ep(mut9.ui.p.ho,a9.ui.p.ho)
david9.ui.p.ho<-DS(mat9.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.ui.p.ho<-cbind(ordrank.9.ui.p.ho,ds=david9.ui.p.ho$normDS)
lm9.ui.p.ho<-summary(lm(ordrank.9.ui.p.ho$ds~ordrank.9.ui.p.ho$ord.rank))
s9.ui.p.ho<-lm9.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.ui.p.ho<-data.frame(X1=conflict.ho.ui.p[[28]],X2=conflict.ho.ui.p[[29]],Victories=conflict.ho.ui.p[[30]])
mat10.ui.p.ho<-inter.mat(mut10.ui.p.ho)
tri10.ui.p.ho<-tr.tri(mat10.ui.p.ho)
dci10.ui.p.ho<-DCindex(mat10.ui.p.ho)
mat10.ui.p.ho[is.na(mat10.ui.p.ho)] = 0
h10.ui.p.ho<-h.index(mat10.ui.p.ho)

ep10.ui.p.ho<-ep(mut10.ui.p.ho,a10.ui.p.ho)
david10.ui.p.ho<-DS(mat10.ui.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.ui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.ui.p.ho<-cbind(ordrank.10.ui.p.ho,ds=david10.ui.p.ho$normDS)
lm10.ui.p.ho<-summary(lm(ordrank.10.ui.p.ho$ds~ordrank.10.ui.p.ho$ord.rank))
s10.ui.p.ho<-lm10.ui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.ui.p.ho<-sum(mut1.ui.p.ho$Victories)
int2.ui.p.ho<-sum(mut2.ui.p.ho$Victories)
int3.ui.p.ho<-sum(mut3.ui.p.ho$Victories)
int4.ui.p.ho<-sum(mut4.ui.p.ho$Victories)
int5.ui.p.ho<-sum(mut5.ui.p.ho$Victories)
int6.ui.p.ho<-sum(mut6.ui.p.ho$Victories)
int7.ui.p.ho<-sum(mut7.ui.p.ho$Victories)
int8.ui.p.ho<-sum(mut8.ui.p.ho$Victories)
int9.ui.p.ho<-sum(mut9.ui.p.ho$Victories)
int10.ui.p.ho<-sum(mut10.ui.p.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.ui.p.ho<-sum(a1.ui.p.ho$Victories)
av2.ui.p.ho<-sum(a2.ui.p.ho$Victories)
av3.ui.p.ho<-sum(a3.ui.p.ho$Victories)
av4.ui.p.ho<-sum(a4.ui.p.ho$Victories)
av5.ui.p.ho<-sum(a5.ui.p.ho$Victories)
av6.ui.p.ho<-sum(a6.ui.p.ho$Victories)
av7.ui.p.ho<-sum(a7.ui.p.ho$Victories)
av8.ui.p.ho<-sum(a8.ui.p.ho$Victories)
av9.ui.p.ho<-sum(a9.ui.p.ho$Victories)
av10.ui.p.ho<-sum(a10.ui.p.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.iu.p<-(sum(av1.ui.p.ho, av2.ui.p.ho, av3.ui.p.ho, av4.ui.p.ho, av5.ui.p.ho, av6.ui.p.ho, av7.ui.p.ho, av8.ui.p.ho, av9.ui.p.ho, av10.ui.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.iu.p<-(sum(int1.ui.p.ho, int2.ui.p.ho, int3.ui.p.ho, int4.ui.p.ho, int5.ui.p.ho, int6.ui.p.ho, int7.ui.p.ho, int8.ui.p.ho, int9.ui.p.ho, int10.ui.p.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.ui.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.ui.p.ho<-e1.ui.p.ho[order(e1.ui.p.ho$ID),]
e1.ui.p.ho<-as.matrix(t(e1.1.ui.p.ho))

e2.ui.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.ui.p.ho<-e2.ui.p.ho[order(e2.ui.p.ho$ID),]
e2.ui.p.ho<-as.matrix(t(e2.1.ui.p.ho))

e3.ui.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.ui.p.ho<-e3.ui.p.ho[order(e3.ui.p.ho$ID),]
e3.ui.p.ho<-as.matrix(t(e3.1.ui.p.ho))

e4.ui.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.ui.p.ho<-e4.ui.p.ho[order(e4.ui.p.ho$ID),]
e4.ui.p.ho<-as.matrix(t(e4.1.ui.p.ho))

e5.ui.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.ui.p.ho<-e5.ui.p.ho[order(e5.ui.p.ho$ID),]
e5.ui.p.ho<-as.matrix(t(e5.1.ui.p.ho))

e6.ui.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.ui.p.ho<-e6.ui.p.ho[order(e6.ui.p.ho$ID),]
e6.ui.p.ho<-as.matrix(t(e6.1.ui.p.ho))

e7.ui.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.ui.p.ho<-e7.ui.p.ho[order(e7.ui.p.ho$ID),]
e7.ui.p.ho<-as.matrix(t(e7.1.ui.p.ho))

e8.ui.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.ui.p.ho<-e8.ui.p.ho[order(e8.ui.p.ho$ID),]
e8.ui.p.ho<-as.matrix(t(e8.1.ui.p.ho))

e9.ui.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.ui.p.ho<-e9.ui.p.ho[order(e9.ui.p.ho$ID),]
e9.ui.p.ho<-as.matrix(t(e9.1.ui.p.ho))

e10.ui.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.ui.p.ho<-e10.ui.p.ho[order(e10.ui.p.ho$ID),]
e10.ui.p.ho<-as.matrix(t(e10.1.ui.p.ho))

energy.ho.ui.p.ho<-as.data.frame(matrix(c(e1.ui.p.ho,e2.ui.p.ho,e3.ui.p.ho,e4.ui.p.ho,e5.ui.p.ho,e6.ui.p.ho,e7.ui.p.ho,e8.ui.p.ho,e9.ui.p.ho,e10.ui.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.ui.p.ho<-data.frame(ID=energy.ho.ui.p.ho$V1,energy_over_distance=energy.ho.ui.p.ho$V2,energy_over_time=energy.ho.ui.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.ui.p.ho<-david1.ui.p.ho[order(david1.ui.p.ho$ID),]
david1.ui.p.ho<-as.matrix(t(david1.1.ui.p.ho))

david2.1.ui.p.ho<-david2.ui.p.ho[order(david2.ui.p.ho$ID),]
david2.ui.p.ho<-as.matrix(t(david2.1.ui.p.ho))

david3.1.ui.p.ho<-david3.ui.p.ho[order(david3.ui.p.ho$ID),]
david3.ui.p.ho<-as.matrix(t(david3.1.ui.p.ho))

david4.1.ui.p.ho<-david4.ui.p.ho[order(david4.ui.p.ho$ID),]
david4.ui.p.ho<-as.matrix(t(david4.1.ui.p.ho))

david5.1.ui.p.ho<-david5.ui.p.ho[order(david5.ui.p.ho$ID),]
david5.ui.p.ho<-as.matrix(t(david5.1.ui.p.ho))

david6.1.ui.p.ho<-david6.ui.p.ho[order(david6.ui.p.ho$ID),]
david6.ui.p.ho<-as.matrix(t(david6.1.ui.p.ho))

david7.1.ui.p.ho<-david7.ui.p.ho[order(david7.ui.p.ho$ID),]
david7.ui.p.ho<-as.matrix(t(david7.1.ui.p.ho))

david8.1.ui.p.ho<-david8.ui.p.ho[order(david8.ui.p.ho$ID),]
david8.ui.p.ho<-as.matrix(t(david8.1.ui.p.ho))

david9.1.ui.p.ho<-david9.ui.p.ho[order(david9.ui.p.ho$ID),]
david9.ui.p.ho<-as.matrix(t(david9.1.ui.p.ho))

david10.1.ui.p.ho<-david10.ui.p.ho[order(david10.ui.p.ho$ID),]
david10.ui.p.ho<-as.matrix(t(david10.1.ui.p.ho))

david.ho.ui.p.ho<-as.data.frame(matrix(c(david1.ui.p.ho,david2.ui.p.ho,david3.ui.p.ho,david4.ui.p.ho,david5.ui.p.ho,david6.ui.p.ho,david7.ui.p.ho,david8.ui.p.ho,david9.ui.p.ho,david10.ui.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.ui.p.ho<-data.frame(ID=david.ho.ui.p.ho$V1,DS=david.ho.ui.p.ho$V2,normDS=david.ho.ui.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.ui.p.ho<-lm(e1.1.ui.p.ho$energy_over_time~as.numeric(david1.1.ui.p.ho$normDS))
ho.lm.1.s.ui.p.ho<-summary(lm.ho.1.ui.p.ho)$coefficients
ho.1.slope.ui.p.ho<-ho.lm.1.s.ui.p.ho[2,1]
lm.ho.2.ui.p.ho<-lm(e2.1.ui.p.ho$energy_over_time~as.numeric(david2.1.ui.p.ho$normDS))
ho.lm.2.s.ui.p.ho<-summary(lm.ho.2.ui.p.ho)$coefficients
ho.2.slope.ui.p.ho<-ho.lm.2.s.ui.p.ho[2,1]
lm.ho.3.ui.p.ho<-lm(e3.1.ui.p.ho$energy_over_time~as.numeric(david3.1.ui.p.ho$normDS))
ho.lm.3.s.ui.p.ho<-summary(lm.ho.3.ui.p.ho)$coefficients
ho.3.slope.ui.p.ho<-ho.lm.3.s.ui.p.ho[2,1]
lm.ho.4.ui.p.ho<-lm(e4.1.ui.p.ho$energy_over_time~as.numeric(david4.1.ui.p.ho$normDS))
ho.lm.4.s.ui.p.ho<-summary(lm.ho.4.ui.p.ho)$coefficients
ho.4.slope.ui.p.ho<-ho.lm.4.s.ui.p.ho[2,1]
lm.ho.5.ui.p.ho<-lm(e5.1.ui.p.ho$energy_over_time~as.numeric(david5.1.ui.p.ho$normDS))
ho.lm.5.s.ui.p.ho<-summary(lm.ho.5.ui.p.ho)$coefficients
ho.5.slope.ui.p.ho<-ho.lm.5.s.ui.p.ho[2,1]
lm.ho.6.ui.p.ho<-lm(e6.1.ui.p.ho$energy_over_time~as.numeric(david6.1.ui.p.ho$normDS))
ho.lm.6.s.ui.p.ho<-summary(lm.ho.6.ui.p.ho)$coefficients
ho.6.slope.ui.p.ho<-ho.lm.6.s.ui.p.ho[2,1]
lm.ho.7.ui.p.ho<-lm(e7.1.ui.p.ho$energy_over_time~as.numeric(david7.1.ui.p.ho$normDS))
ho.lm.7.s.ui.p.ho<-summary(lm.ho.7.ui.p.ho)$coefficients
ho.7.slope.ui.p.ho<-ho.lm.7.s.ui.p.ho[2,1]
lm.ho.8.ui.p.ho<-lm(e8.1.ui.p.ho$energy_over_time~as.numeric(david8.1.ui.p.ho$normDS))
ho.lm.8.s.ui.p.ho<-summary(lm.ho.8.ui.p.ho)$coefficients
ho.8.slope.ui.p.ho<-ho.lm.8.s.ui.p.ho[2,1]
lm.ho.9.ui.p.ho<-lm(e9.1.ui.p.ho$energy_over_time~as.numeric(david9.1.ui.p.ho$normDS))
ho.lm.9.s.ui.p.ho<-summary(lm.ho.9.ui.p.ho)$coefficients
ho.9.slope.ui.p.ho<-ho.lm.9.s.ui.p.ho[2,1]
lm.ho.10.ui.p.ho<-lm(e10.1.ui.p.ho$energy_over_time~as.numeric(david10.1.ui.p.ho$normDS))
ho.lm.10.s.ui.p.ho<-summary(lm.ho.10.ui.p.ho)$coefficients
ho.10.slope.ui.p.ho<-ho.lm.10.s.ui.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.ui.p.ss<-data.frame(triangle.transitivity=c(tri1.ui.p.ho,tri2.ui.p.ho,tri3.ui.p.ho,tri4.ui.p.ho,tri5.ui.p.ho,tri6.ui.p.ho,tri7.ui.p.ho,tri8.ui.p.ho,tri9.ui.p.ho,tri10.ui.p.ho),escalation=c(ep1.ui.p.ho,ep2.ui.p.ho,ep3.ui.p.ho,ep4.ui.p.ho,ep5.ui.p.ho,ep6.ui.p.ho,ep7.ui.p.ho,ep8.ui.p.ho,ep9.ui.p.ho,ep10.ui.p.ho),dci=c(dci1.ui.p.ho,dci2.ui.p.ho,dci3.ui.p.ho,dci4.ui.p.ho,dci5.ui.p.ho,dci6.ui.p.ho,dci7.ui.p.ho,dci8.ui.p.ho,dci9.ui.p.ho,dci10.ui.p.ho),steepness=c(s1.ui.p.ho,s2.ui.p.ho,s3.ui.p.ho,s4.ui.p.ho,s5.ui.p.ho,s6.ui.p.ho,s7.ui.p.ho,s8.ui.p.ho,s9.ui.p.ho,s10.ui.p.ho),slope=c(ho.1.slope.ui.p.ho,ho.2.slope.ui.p.ho,ho.3.slope.ui.p.ho,ho.4.slope.ui.p.ho,ho.5.slope.ui.p.ho,ho.6.slope.ui.p.ho,ho.7.slope.ui.p.ho,ho.8.slope.ui.p.ho,ho.9.slope.ui.p.ho,ho.10.slope.ui.p.ho))

#Overall linear models of each scenario
km.lm.iu.p<-lm((energy.km.df.ui.p.km$energy_over_time)~as.numeric(david.km.df.ui.p.km$normDS)) #knowledge mutual linear model
ks.lm.iu.p<-lm((energy.ks.df.ui.p.ks$energy_over_time)~as.numeric(david.ks.df.ui.p.ks$normDS)) #knowledge self linear model
ko.lm.iu.p<-lm((energy.ko.df.ui.p.ko$energy_over_time)~as.numeric(david.ko.df.ui.p.ko$normDS)) #knowledge opp linear model
hm.lm.iu.p<-lm((energy.hm.df.ui.p.hm$energy_over_time)~as.numeric(david.hm.df.ui.p.hm$normDS)) #history mutual linear model
hs.lm.iu.p<-lm((energy.hs.df.ui.p.hs$energy_over_time)~as.numeric(david.hs.df.ui.p.hs$normDS)) #history self linear model
ho.lm.iu.p<-lm((energy.ho.df.ui.p.ho$energy_over_time)~as.numeric(david.ho.df.ui.p.ho$normDS)) #history opp linear model
```
```{r Uniform Probabilistic Data Frame}
# Generate energy data frame:
total.energy.iu.p<-data.frame(energy.km.df.ui.p.km)
total.energy.iu.p<-rbind(total.energy.iu.p,energy.ks.df.ui.p.ks,energy.ko.df.ui.p.ko,energy.hm.df.ui.p.hm,energy.hs.df.ui.p.hs,energy.ho.df.ui.p.ho)

total.david.iu.p<-data.frame(david.km.df.ui.p.km)
total.david.iu.p<-rbind(total.david.iu.p,david.ks.df.ui.p.ks,david.ko.df.ui.p.ko,david.hm.df.ui.p.hm,david.hs.df.ui.p.hs,david.ho.df.ui.p.ho)

total.energy.iu.p<-cbind(total.energy.iu.p,normDS=total.david.iu.p$normDS)

# Generate data frame of means for each summary statistic:
  # knowledge mutual
  km.tt.iu.p<-mean(km.ui.p.ss$triangle.transitivity)
  km.iu.pi.iu.p<-mean(km.ui.p.ss$dci)
  km.esc.iu.p<-mean(km.ui.p.ss$escalation)
  km.steep.iu.p<-mean(km.ui.p.ss$steepness)
  km.slope.iu.p<-mean(km.ui.p.ss$slope)
  km.mean.iu.p<-data.frame(scenario="Knowledge   Mutual",tt=km.tt.iu.p,dci=km.iu.pi.iu.p,esc=km.esc.iu.p,steepness=km.steep.iu.p,slope=km.slope.iu.p,dist="Uniform",calc="Probabilistic")

  # knowledge self
  ks.tt.iu.p<-mean(ks.ui.p.ss$triangle.transitivity)
  ks.iu.pi.iu.p<-mean(ks.ui.p.ss$dci)
  ks.esc.iu.p<-mean(ks.ui.p.ss$escalation)
  ks.steep.iu.p<-mean(ks.ui.p.ss$steepness)
  ks.slope.iu.p<-mean(ks.ui.p.ss$slope)
  ks.mean.iu.p<-data.frame(scenario="Knowledge self",tt=ks.tt.iu.p,dci=ks.iu.pi.iu.p,esc=ks.esc.iu.p,steepness=ks.steep.iu.p,slope=ks.slope.iu.p,dist="Uniform",calc="Probabilistic")

  # knowledge opponent
  ko.tt.iu.p<-mean(ko.ui.p.ss$triangle.transitivity)
  ko.iu.pi.iu.p<-mean(ko.ui.p.ss$dci)
  ko.esc.iu.p<-mean(ko.ui.p.ss$escalation)
  ko.steep.iu.p<-mean(ko.ui.p.ss$steepness)
  ko.slope.iu.p<-mean(ko.ui.p.ss$slope)
  ko.mean.iu.p<-data.frame(scenario="Knowledge opponent",tt=ko.tt.iu.p,dci=ko.iu.pi.iu.p,esc=ko.esc.iu.p,steepness=ko.steep.iu.p,slope=ko.slope.iu.p,dist="Uniform",calc="Probabilistic")

  # history mutual
  hm.tt.iu.p<-mean(hm.ui.p.ss$triangle.transitivity)
  hm.iu.pi.iu.p<-mean(hm.ui.p.ss$dci)
  hm.esc.iu.p<-mean(hm.ui.p.ss$escalation)
  hm.steep.iu.p<-mean(hm.ui.p.ss$steepness)
  hm.slope.iu.p<-mean(hm.ui.p.ss$slope)
  hm.mean.iu.p<-data.frame(scenario="History Mutual",tt=hm.tt.iu.p,dci=hm.iu.pi.iu.p,esc=hm.esc.iu.p,steepness=hm.steep.iu.p,slope=hm.slope.iu.p,dist="Uniform",calc="Probabilistic")

  # history self
  hs.tt.iu.p<-mean(hs.ui.p.ss$triangle.transitivity)
  hs.iu.pi.iu.p<-mean(hs.ui.p.ss$dci)
  hs.esc.iu.p<-mean(hs.ui.p.ss$escalation)
  hs.steep.iu.p<-mean(hs.ui.p.ss$steepness)
  hs.slope.iu.p<-mean(hs.ui.p.ss$slope)
  hs.mean.iu.p<-data.frame(scenario="History self",tt=hs.tt.iu.p,dci=hs.iu.pi.iu.p,esc=hs.esc.iu.p,steepness=hs.steep.iu.p,slope=hs.slope.iu.p,dist="Uniform",calc="Probabilistic")

  # history opponent
  ho.tt.iu.p<-mean(ho.ui.p.ss$triangle.transitivity)
  ho.iu.pi.iu.p<-mean(ho.ui.p.ss$dci)
  ho.esc.iu.p<-mean(ho.ui.p.ss$escalation)
  ho.steep.iu.p<-mean(ho.ui.p.ss$steepness)
  ho.slope.iu.p<-mean(ho.ui.p.ss$slope)
  ho.mean.iu.p<-data.frame(scenario="History opponent",tt=ho.tt.iu.p,dci=ho.iu.pi.iu.p,esc=ho.esc.iu.p,steepness=ho.steep.iu.p,slope=ho.slope.iu.p,dist="Uniform",calc="Probabilistic")

# Data frame of all averages
dc.ave<-rbind(km.mean.iu.p,ks.mean.iu.p,ko.mean.iu.p,hm.mean.iu.p,hs.mean.iu.p,ho.mean.iu.p)

# Calculate means of each scenario and place intro data frame:
  #knowledge mutual
  km.tt.iu.p<-mean(km.ui.p.ss$triangle.transitivity)
  km.iu.pi.iu.p<-mean(km.ui.p.ss$dci)
  km.esc.iu.p<-mean(km.ui.p.ss$escalation)
  km.steep.iu.p<-mean(km.ui.p.ss$steepness)
  km.slope.iu.p<-mean(km.ui.p.ss$slope)
  km.mean.iu.p<-data.frame(scenario="Knowledge Mutual",tt=km.tt.iu.p,dci=km.iu.pi.iu.p,esc=km.esc.iu.p,steepness=km.steep.iu.p,slope=km.slope.iu.p,dist="Uniform",calc="Probabilistic")
  
  #knowledge self
  ks.tt.iu.p<-mean(ks.ui.p.ss$triangle.transitivity)
  ks.iu.pi.iu.p<-mean(ks.ui.p.ss$dci)
  ks.esc.iu.p<-mean(ks.ui.p.ss$escalation)
  ks.steep.iu.p<-mean(ks.ui.p.ss$steepness)
  ks.slope.iu.p<-mean(ks.ui.p.ss$slope)
  ks.mean.iu.p<-data.frame(scenario="Knowledge self",tt=ks.tt.iu.p,dci=ks.iu.pi.iu.p,esc=ks.esc.iu.p,steepness=ks.steep.iu.p,slope=ks.slope.iu.p,dist="Uniform",calc="Probabilistic")
  
  #knowledge opponent
  ko.tt.iu.p<-mean(ko.ui.p.ss$triangle.transitivity)
  ko.iu.pi.iu.p<-mean(ko.ui.p.ss$dci)
  ko.esc.iu.p<-mean(ko.ui.p.ss$escalation)
  ko.steep.iu.p<-mean(ko.ui.p.ss$steepness)
  ko.slope.iu.p<-mean(ko.ui.p.ss$slope)
  ko.mean.iu.p<-data.frame(scenario="Knowledge opponent",tt=ko.tt.iu.p,dci=ko.iu.pi.iu.p,esc=ko.esc.iu.p,steepness=ko.steep.iu.p,slope=ko.slope.iu.p,dist="Uniform",calc="Probabilistic")
  
  #history mutual
  hm.tt.iu.p<-mean(hm.ui.p.ss$triangle.transitivity)
  hm.iu.pi.iu.p<-mean(hm.ui.p.ss$dci)
  hm.esc.iu.p<-mean(hm.ui.p.ss$escalation)
  hm.steep.iu.p<-mean(hm.ui.p.ss$steepness)
  hm.slope.iu.p<-mean(hm.ui.p.ss$slope)
  hm.mean.iu.p<-data.frame(scenario="History Mutual",tt=hm.tt.iu.p,dci=hm.iu.pi.iu.p,esc=hm.esc.iu.p,steepness=hm.steep.iu.p,slope=hm.slope.iu.p,dist="Uniform",calc="Probabilistic")
  
  #history self
  hs.tt.iu.p<-mean(hs.ui.p.ss$triangle.transitivity)
  hs.iu.pi.iu.p<-mean(hs.ui.p.ss$dci)
  hs.esc.iu.p<-mean(hs.ui.p.ss$escalation)
  hs.steep.iu.p<-mean(hs.ui.p.ss$steepness)
  hs.slope.iu.p<-mean(hs.ui.p.ss$slope)
  hs.mean.iu.p<-data.frame(scenario="History self",tt=hs.tt.iu.p,dci=hs.iu.pi.iu.p,esc=hs.esc.iu.p,steepness=hs.steep.iu.p,slope=hs.slope.iu.p,dist="Uniform",calc="Probabilistic")
  
  #history opponent
  ho.tt.iu.p<-mean(ho.ui.p.ss$triangle.transitivity)
  ho.iu.pi.iu.p<-mean(ho.ui.p.ss$dci)
  ho.esc.iu.p<-mean(ho.ui.p.ss$escalation)
  ho.steep.iu.p<-mean(ho.ui.p.ss$steepness)
  ho.slope.iu.p<-mean(ho.ui.p.ss$slope)
  ho.mean.iu.p<-data.frame(scenario="History opponent",tt=ho.tt.iu.p,dci=ho.iu.pi.iu.p,esc=ho.esc.iu.p,steepness=ho.steep.iu.p,slope=ho.slope.iu.p,dist="Uniform",calc="Probabilistic")

# Generate data frame for all averages:
dc.ave<-rbind(km.mean.iu.p,ks.mean.iu.p,ko.mean.iu.p,hm.mean.iu.p,hs.mean.iu.p,ho.mean.iu.p)

# Create overall dataframe of summary statistics:
overall.unif.initiator<-data.frame(km.ui.p.ss)
overall.unif.initiator<-rbind(overall.unif.initiator,ks.ui.p.ss)
overall.unif.initiator<-rbind(overall.unif.initiator,ko.ui.p.ss)
overall.unif.initiator<-rbind(overall.unif.initiator,hm.ui.p.ss)
overall.unif.initiator<-rbind(overall.unif.initiator,hs.ui.p.ss)
overall.unif.initiator<-rbind(overall.unif.initiator,ho.ui.p.ss)

overall.unif.initiator<-cbind(overall.unif.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.initiator<-cbind(overall.unif.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.ui.p.ss<-overall.unif.initiator[overall.unif.initiator$variable=="rhp",]
history.ui.p.ss<-overall.unif.initiator[overall.unif.initiator$variable=="history",]

overall.unif.initiator$combo<-paste(overall.unif.initiator$strategy,overall.unif.initiator$variable,overall.unif.initiator$distribution)
overall.unif.initiator$combo2<-paste(overall.unif.initiator$strategy,overall.unif.initiator$variable) #final dataframe for Probabilistic Uniform data
```

## Avoids Uniform Initiator Wins Probabilistic Data
```{r Avoids Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.aui.p.km<-data.frame(X1=avoid.ui.p.km[[1]],X2=avoid.ui.p.km[[2]],Avoids=avoid.ui.p.km[[3]])
mat1.aui.p.km<-avoid.inter.mat(mut1.aui.p.km)
tri1.aui.p.km<-tr.tri(mat1.aui.p.km)
dci1.aui.p.km<-DCindex(mat1.aui.p.km)
mat1.aui.p.km[is.na(mat1.aui.p.km)] = 0
h1.aui.p.km<-h.index(mat1.aui.p.km)

ep1.aui.p.km<-ep(mut1.aui.p.km,a1.ui.p.km)
david1.aui.p.km<-DS(mat1.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.km<-cbind(ordrank.1.aui.p.km,ds=david1.aui.p.km$normDS)
lm1.aui.p.km<-summary(lm(ordrank.1.aui.p.km$ds~ordrank.1.aui.p.km$ord.rank))
s1.aui.p.km<-lm1.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.km<-data.frame(X1=avoid.ui.p.km[[4]],X2=avoid.ui.p.km[[5]],Avoids=avoid.ui.p.km[[6]])
mat2.aui.p.km<-avoid.inter.mat(mut2.aui.p.km)
tri2.aui.p.km<-tr.tri(mat2.aui.p.km)
dci2.aui.p.km<-DCindex(mat2.aui.p.km)
mat2.aui.p.km[is.na(mat2.aui.p.km)] = 0
h2.aui.p.km<-h.index(mat2.aui.p.km)

ep2.aui.p.km<-ep(mut2.aui.p.km,a2.ui.p.km)
david2.aui.p.km<-DS(mat2.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.km<-cbind(ordrank.2.aui.p.km,ds=david2.aui.p.km$normDS)
lm2.aui.p.km<-summary(lm(ordrank.2.aui.p.km$ds~ordrank.2.aui.p.km$ord.rank))
s2.aui.p.km<-lm2.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.km<-data.frame(X1=avoid.ui.p.km[[7]],X2=avoid.ui.p.km[[8]],Avoids=avoid.ui.p.km[[9]])
mat3.aui.p.km<-avoid.inter.mat(mut3.aui.p.km)
tri3.aui.p.km<-tr.tri(mat3.aui.p.km)
dci3.aui.p.km<-DCindex(mat3.aui.p.km)
mat3.aui.p.km[is.na(mat3.aui.p.km)] = 0
h3.aui.p.km<-h.index(mat3.aui.p.km)

ep3.aui.p.km<-ep(mut3.aui.p.km,a3.ui.p.km)
david3.aui.p.km<-DS(mat3.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.km<-cbind(ordrank.3.aui.p.km,ds=david3.aui.p.km$normDS)
lm3.aui.p.km<-summary(lm(ordrank.3.aui.p.km$ds~ordrank.3.aui.p.km$ord.rank))
s3.aui.p.km<-lm3.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.km<-data.frame(X1=avoid.ui.p.km[[10]],X2=avoid.ui.p.km[[11]],Avoids=avoid.ui.p.km[[12]])
mat4.aui.p.km<-avoid.inter.mat(mut4.aui.p.km)
tri4.aui.p.km<-tr.tri(mat4.aui.p.km)
dci4.aui.p.km<-DCindex(mat4.aui.p.km)
mat4.aui.p.km[is.na(mat4.aui.p.km)] = 0
h4.aui.p.km<-h.index(mat4.aui.p.km)

ep4.aui.p.km<-ep(mut4.aui.p.km,a4.ui.p.km)
david4.aui.p.km<-DS(mat4.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.km<-cbind(ordrank.4.aui.p.km,ds=david4.aui.p.km$normDS)
lm4.aui.p.km<-summary(lm(ordrank.4.aui.p.km$ds~ordrank.4.aui.p.km$ord.rank))
s4.aui.p.km<-lm4.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.km<-data.frame(X1=avoid.ui.p.km[[13]],X2=avoid.ui.p.km[[14]],Avoids=avoid.ui.p.km[[15]])
mat5.aui.p.km<-avoid.inter.mat(mut5.aui.p.km)
tri5.aui.p.km<-tr.tri(mat5.aui.p.km)
dci5.aui.p.km<-DCindex(mat5.aui.p.km)
mat5.aui.p.km[is.na(mat5.aui.p.km)] = 0
h5.aui.p.km<-h.index(mat5.aui.p.km)

ep5.aui.p.km<-ep(mut5.aui.p.km,a5.ui.p.km)
david5.aui.p.km<-DS(mat5.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.km<-cbind(ordrank.5.aui.p.km,ds=david5.aui.p.km$normDS)
lm5.aui.p.km<-summary(lm(ordrank.5.aui.p.km$ds~ordrank.5.aui.p.km$ord.rank))
s5.aui.p.km<-lm5.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.km<-data.frame(X1=avoid.ui.p.km[[16]],X2=avoid.ui.p.km[[17]],Avoids=avoid.ui.p.km[[18]])
mat6.aui.p.km<-avoid.inter.mat(mut6.aui.p.km)
tri6.aui.p.km<-tr.tri(mat6.aui.p.km)
dci6.aui.p.km<-DCindex(mat6.aui.p.km)
mat6.aui.p.km[is.na(mat6.aui.p.km)] = 0
h6.aui.p.km<-h.index(mat6.aui.p.km)

ep6.aui.p.km<-ep(mut6.aui.p.km,a6.ui.p.km)
david6.aui.p.km<-DS(mat6.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.km<-cbind(ordrank.6.aui.p.km,ds=david6.aui.p.km$normDS)
lm6.aui.p.km<-summary(lm(ordrank.6.aui.p.km$ds~ordrank.6.aui.p.km$ord.rank))
s6.aui.p.km<-lm6.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.km<-data.frame(X1=avoid.ui.p.km[[19]],X2=avoid.ui.p.km[[20]],Avoids=avoid.ui.p.km[[21]])
mat7.aui.p.km<-avoid.inter.mat(mut7.aui.p.km)
tri7.aui.p.km<-tr.tri(mat7.aui.p.km)
dci7.aui.p.km<-DCindex(mat7.aui.p.km)
mat7.aui.p.km[is.na(mat7.aui.p.km)] = 0
h7.aui.p.km<-h.index(mat7.aui.p.km)

ep7.aui.p.km<-ep(mut7.aui.p.km,a7.ui.p.km)
david7.aui.p.km<-DS(mat7.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.km<-cbind(ordrank.7.aui.p.km,ds=david7.aui.p.km$normDS)
lm7.aui.p.km<-summary(lm(ordrank.7.aui.p.km$ds~ordrank.7.aui.p.km$ord.rank))
s7.aui.p.km<-lm7.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.km<-data.frame(X1=avoid.ui.p.km[[22]],X2=avoid.ui.p.km[[23]],Avoids=avoid.ui.p.km[[24]])
mat8.aui.p.km<-avoid.inter.mat(mut8.aui.p.km)
tri8.aui.p.km<-tr.tri(mat8.aui.p.km)
dci8.aui.p.km<-DCindex(mat8.aui.p.km)
mat8.aui.p.km[is.na(mat8.aui.p.km)] = 0
h8.aui.p.km<-h.index(mat8.aui.p.km)

ep8.aui.p.km<-ep(mut8.aui.p.km,a8.ui.p.km)
david8.aui.p.km<-DS(mat8.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.km<-cbind(ordrank.8.aui.p.km,ds=david8.aui.p.km$normDS)
lm8.aui.p.km<-summary(lm(ordrank.8.aui.p.km$ds~ordrank.8.aui.p.km$ord.rank))
s8.aui.p.km<-lm8.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.km<-data.frame(X1=avoid.ui.p.km[[25]],X2=avoid.ui.p.km[[26]],Avoids=avoid.ui.p.km[[27]])
mat9.aui.p.km<-avoid.inter.mat(mut9.aui.p.km)
tri9.aui.p.km<-tr.tri(mat9.aui.p.km)
dci9.aui.p.km<-DCindex(mat9.aui.p.km)
mat9.aui.p.km[is.na(mat9.aui.p.km)] = 0
h9.aui.p.km<-h.index(mat9.aui.p.km)

ep9.aui.p.km<-ep(mut9.aui.p.km,a9.ui.p.km)
david9.aui.p.km<-DS(mat9.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.km<-cbind(ordrank.9.aui.p.km,ds=david9.aui.p.km$normDS)
lm9.aui.p.km<-summary(lm(ordrank.9.aui.p.km$ds~ordrank.9.aui.p.km$ord.rank))
s9.aui.p.km<-lm9.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.km<-data.frame(X1=avoid.ui.p.km[[28]],X2=avoid.ui.p.km[[29]],Avoids=avoid.ui.p.km[[30]])
mat10.aui.p.km<-avoid.inter.mat(mut10.aui.p.km)
tri10.aui.p.km<-tr.tri(mat10.aui.p.km)
dci10.aui.p.km<-DCindex(mat10.aui.p.km)
mat10.aui.p.km[is.na(mat10.aui.p.km)] = 0
h10.aui.p.km<-h.index(mat10.aui.p.km)

ep10.aui.p.km<-ep(mut10.aui.p.km,a10.ui.p.km)
david10.aui.p.km<-DS(mat10.aui.p.km) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.km<-cbind(ordrank.10.aui.p.km,ds=david10.aui.p.km$normDS)
lm10.aui.p.km<-summary(lm(ordrank.10.aui.p.km$ds~ordrank.10.aui.p.km$ord.rank))
s10.aui.p.km<-lm10.aui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.km<-sum(mut1.aui.p.km$Victories)
int2.aui.p.km<-sum(mut2.aui.p.km$Victories)
int3.aui.p.km<-sum(mut3.aui.p.km$Victories)
int4.aui.p.km<-sum(mut4.aui.p.km$Victories)
int5.aui.p.km<-sum(mut5.aui.p.km$Victories)
int6.aui.p.km<-sum(mut6.aui.p.km$Victories)
int7.aui.p.km<-sum(mut7.aui.p.km$Victories)
int8.aui.p.km<-sum(mut8.aui.p.km$Victories)
int9.aui.p.km<-sum(mut9.aui.p.km$Victories)
int10.aui.p.km<-sum(mut10.aui.p.km$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.km<-sum(a1.ui.p.km$Victories)
av2.aui.p.km<-sum(a2.ui.p.km$Victories)
av3.aui.p.km<-sum(a3.ui.p.km$Victories)
av4.aui.p.km<-sum(a4.ui.p.km$Victories)
av5.aui.p.km<-sum(a5.ui.p.km$Victories)
av6.aui.p.km<-sum(a6.ui.p.km$Victories)
av7.aui.p.km<-sum(a7.ui.p.km$Victories)
av8.aui.p.km<-sum(a8.ui.p.km$Victories)
av9.aui.p.km<-sum(a9.ui.p.km$Victories)
av10.aui.p.km<-sum(a10.ui.p.km$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.km.aiu.p<-(sum(av1.aui.p.km, av2.aui.p.km, av3.aui.p.km, av4.aui.p.km, av5.aui.p.km, av6.aui.p.km, av7.aui.p.km, av8.aui.p.km, av9.aui.p.km, av10.aui.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.aiu.p<-(sum(int1.aui.p.km, int2.aui.p.km, int3.aui.p.km, int4.aui.p.km, int5.aui.p.km, int6.aui.p.km, int7.aui.p.km, int8.aui.p.km, int9.aui.p.km, int10.aui.p.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.p.km<-e1.aui.p.km[order(e1.aui.p.km$ID),]
e1.aui.p.km<-as.matrix(t(e1.1.aui.p.km))

e2.aui.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.p.km<-e2.aui.p.km[order(e2.aui.p.km$ID),]
e2.aui.p.km<-as.matrix(t(e2.1.aui.p.km))

e3.aui.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.p.km<-e3.aui.p.km[order(e3.aui.p.km$ID),]
e3.aui.p.km<-as.matrix(t(e3.1.aui.p.km))

e4.aui.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.p.km<-e4.aui.p.km[order(e4.aui.p.km$ID),]
e4.aui.p.km<-as.matrix(t(e4.1.aui.p.km))

e5.aui.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.p.km<-e5.aui.p.km[order(e5.aui.p.km$ID),]
e5.aui.p.km<-as.matrix(t(e5.1.aui.p.km))

e6.aui.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.p.km<-e6.aui.p.km[order(e6.aui.p.km$ID),]
e6.aui.p.km<-as.matrix(t(e6.1.aui.p.km))

e7.aui.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.p.km<-e7.aui.p.km[order(e7.aui.p.km$ID),]
e7.aui.p.km<-as.matrix(t(e7.1.aui.p.km))

e8.aui.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.p.km<-e8.aui.p.km[order(e8.aui.p.km$ID),]
e8.aui.p.km<-as.matrix(t(e8.1.aui.p.km))

e9.aui.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.p.km<-e9.aui.p.km[order(e9.aui.p.km$ID),]
e9.aui.p.km<-as.matrix(t(e9.1.aui.p.km))

e10.aui.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.p.km<-e10.aui.p.km[order(e10.aui.p.km$ID),]
e10.aui.p.km<-as.matrix(t(e10.1.aui.p.km))

energy.km.aui.p.km<-as.data.frame(matrix(c(e1.aui.p.km,e2.aui.p.km,e3.aui.p.km,e4.aui.p.km,e5.aui.p.km,e6.aui.p.km,e7.aui.p.km,e8.aui.p.km,e9.aui.p.km,e10.aui.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.aui.p.km<-data.frame(ID=energy.km.aui.p.km$V1,energy_over_distance=energy.km.aui.p.km$V2,energy_over_time=energy.km.aui.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.km<-david1.aui.p.km[order(david1.aui.p.km$ID),]
david1.aui.p.km<-as.matrix(t(david1.1.aui.p.km))

david2.1.aui.p.km<-david2.aui.p.km[order(david2.aui.p.km$ID),]
david2.aui.p.km<-as.matrix(t(david2.1.aui.p.km))

david3.1.aui.p.km<-david3.aui.p.km[order(david3.aui.p.km$ID),]
david3.aui.p.km<-as.matrix(t(david3.1.aui.p.km))

david4.1.aui.p.km<-david4.aui.p.km[order(david4.aui.p.km$ID),]
david4.aui.p.km<-as.matrix(t(david4.1.aui.p.km))

david5.1.aui.p.km<-david5.aui.p.km[order(david5.aui.p.km$ID),]
david5.aui.p.km<-as.matrix(t(david5.1.aui.p.km))

david6.1.aui.p.km<-david6.aui.p.km[order(david6.aui.p.km$ID),]
david6.aui.p.km<-as.matrix(t(david6.1.aui.p.km))

david7.1.aui.p.km<-david7.aui.p.km[order(david7.aui.p.km$ID),]
david7.aui.p.km<-as.matrix(t(david7.1.aui.p.km))

david8.1.aui.p.km<-david8.aui.p.km[order(david8.aui.p.km$ID),]
david8.aui.p.km<-as.matrix(t(david8.1.aui.p.km))

david9.1.aui.p.km<-david9.aui.p.km[order(david9.aui.p.km$ID),]
david9.aui.p.km<-as.matrix(t(david9.1.aui.p.km))

david10.1.aui.p.km<-david10.aui.p.km[order(david10.aui.p.km$ID),]
david10.aui.p.km<-as.matrix(t(david10.1.aui.p.km))

david.km.aui.p.km<-as.data.frame(matrix(c(david1.aui.p.km,david2.aui.p.km,david3.aui.p.km,david4.aui.p.km,david5.aui.p.km,david6.aui.p.km,david7.aui.p.km,david8.aui.p.km,david9.aui.p.km,david10.aui.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.aui.p.km<-data.frame(ID=david.km.aui.p.km$V1,DS=david.km.aui.p.km$V2,normDS=david.km.aui.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.aui.p.km<-lm(e1.1.aui.p.km$energy_over_time~as.numeric(david1.1.aui.p.km$normDS))
km.lm.1.s.aui.p.km<-summary(lm.km.1.aui.p.km)$coefficients
km.1.slope.aui.p.km<-km.lm.1.s.aui.p.km[2,1]
lm.km.2.aui.p.km<-lm(e2.1.aui.p.km$energy_over_time~as.numeric(david2.1.aui.p.km$normDS))
km.lm.2.s.aui.p.km<-summary(lm.km.2.aui.p.km)$coefficients
km.2.slope.aui.p.km<-km.lm.2.s.aui.p.km[2,1]
lm.km.3.aui.p.km<-lm(e3.1.aui.p.km$energy_over_time~as.numeric(david3.1.aui.p.km$normDS))
km.lm.3.s.aui.p.km<-summary(lm.km.3.aui.p.km)$coefficients
km.3.slope.aui.p.km<-km.lm.3.s.aui.p.km[2,1]
lm.km.4.aui.p.km<-lm(e4.1.aui.p.km$energy_over_time~as.numeric(david4.1.aui.p.km$normDS))
km.lm.4.s.aui.p.km<-summary(lm.km.4.aui.p.km)$coefficients
km.4.slope.aui.p.km<-km.lm.4.s.aui.p.km[2,1]
lm.km.5.aui.p.km<-lm(e5.1.aui.p.km$energy_over_time~as.numeric(david5.1.aui.p.km$normDS))
km.lm.5.s.aui.p.km<-summary(lm.km.5.aui.p.km)$coefficients
km.5.slope.aui.p.km<-km.lm.5.s.aui.p.km[2,1]
lm.km.6.aui.p.km<-lm(e6.1.aui.p.km$energy_over_time~as.numeric(david6.1.aui.p.km$normDS))
km.lm.6.s.aui.p.km<-summary(lm.km.6.aui.p.km)$coefficients
km.6.slope.aui.p.km<-km.lm.6.s.aui.p.km[2,1]
lm.km.7.aui.p.km<-lm(e7.1.aui.p.km$energy_over_time~as.numeric(david7.1.aui.p.km$normDS))
km.lm.7.s.aui.p.km<-summary(lm.km.7.aui.p.km)$coefficients
km.7.slope.aui.p.km<-km.lm.7.s.aui.p.km[2,1]
lm.km.8.aui.p.km<-lm(e8.1.aui.p.km$energy_over_time~as.numeric(david8.1.aui.p.km$normDS))
km.lm.8.s.aui.p.km<-summary(lm.km.8.aui.p.km)$coefficients
km.8.slope.aui.p.km<-km.lm.8.s.aui.p.km[2,1]
lm.km.9.aui.p.km<-lm(e9.1.aui.p.km$energy_over_time~as.numeric(david9.1.aui.p.km$normDS))
km.lm.9.s.aui.p.km<-summary(lm.km.9.aui.p.km)$coefficients
km.9.slope.aui.p.km<-km.lm.9.s.aui.p.km[2,1]
lm.km.10.aui.p.km<-lm(e10.1.aui.p.km$energy_over_time~as.numeric(david10.1.aui.p.km$normDS))
km.lm.10.s.aui.p.km<-summary(lm.km.10.aui.p.km)$coefficients
km.10.slope.aui.p.km<-km.lm.10.s.aui.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.aui.p.ss.avoid.ui.p.km<-data.frame(triangle.transitivity=c(tri1.aui.p.km,tri2.aui.p.km,tri3.aui.p.km,tri4.aui.p.km,tri5.aui.p.km,tri6.aui.p.km,tri7.aui.p.km,tri8.aui.p.km,tri9.aui.p.km,tri10.aui.p.km),escalation=c(ep1.aui.p.km,ep2.aui.p.km,ep3.aui.p.km,ep4.aui.p.km,ep5.aui.p.km,ep6.aui.p.km,ep7.aui.p.km,ep8.aui.p.km,ep9.aui.p.km,ep10.aui.p.km),dci=c(dci1.aui.p.km,dci2.aui.p.km,dci3.aui.p.km,dci4.aui.p.km,dci5.aui.p.km,dci6.aui.p.km,dci7.aui.p.km,dci8.aui.p.km,dci9.aui.p.km,dci10.aui.p.km),steepness=c(s1.aui.p.km,s2.aui.p.km,s3.aui.p.km,s4.aui.p.km,s5.aui.p.km,s6.aui.p.km,s7.aui.p.km,s8.aui.p.km,s9.aui.p.km,s10.aui.p.km),slope=c(km.1.slope.aui.p.km,km.2.slope.aui.p.km,km.3.slope.aui.p.km,km.4.slope.aui.p.km,km.5.slope.aui.p.km,km.6.slope.aui.p.km,km.7.slope.aui.p.km,km.8.slope.aui.p.km,km.9.slope.aui.p.km,km.10.slope.aui.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[1]],X2=avoid.ui.p.ks[[2]],Avoids=avoid.ui.p.ks[[3]])
mat1.aui.p.ks<-avoid.inter.mat(mut1.aui.p.ks)
tri1.aui.p.ks<-tr.tri(mat1.aui.p.ks)
dci1.aui.p.ks<-DCindex(mat1.aui.p.ks)
mat1.aui.p.ks[is.na(mat1.aui.p.ks)] = 0
h1.aui.p.ks<-h.index(mat1.aui.p.ks)

ep1.aui.p.ks<-ep(mut1.aui.p.ks,a1.ui.p.ks)
david1.aui.p.ks<-DS(mat1.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.ks<-cbind(ordrank.1.aui.p.ks,ds=david1.aui.p.ks$normDS)
lm1.aui.p.ks<-summary(lm(ordrank.1.aui.p.ks$ds~ordrank.1.aui.p.ks$ord.rank))
s1.aui.p.ks<-lm1.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[4]],X2=avoid.ui.p.ks[[5]],Avoids=avoid.ui.p.ks[[6]])
mat2.aui.p.ks<-avoid.inter.mat(mut2.aui.p.ks)
tri2.aui.p.ks<-tr.tri(mat2.aui.p.ks)
dci2.aui.p.ks<-DCindex(mat2.aui.p.ks)
mat2.aui.p.ks[is.na(mat2.aui.p.ks)] = 0
h2.aui.p.ks<-h.index(mat2.aui.p.ks)

ep2.aui.p.ks<-ep(mut2.aui.p.ks,a2.ui.p.ks)
david2.aui.p.ks<-DS(mat2.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.ks<-cbind(ordrank.2.aui.p.ks,ds=david2.aui.p.ks$normDS)
lm2.aui.p.ks<-summary(lm(ordrank.2.aui.p.ks$ds~ordrank.2.aui.p.ks$ord.rank))
s2.aui.p.ks<-lm2.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[7]],X2=avoid.ui.p.ks[[8]],Avoids=avoid.ui.p.ks[[9]])
mat3.aui.p.ks<-avoid.inter.mat(mut3.aui.p.ks)
tri3.aui.p.ks<-tr.tri(mat3.aui.p.ks)
dci3.aui.p.ks<-DCindex(mat3.aui.p.ks)
mat3.aui.p.ks[is.na(mat3.aui.p.ks)] = 0
h3.aui.p.ks<-h.index(mat3.aui.p.ks)

ep3.aui.p.ks<-ep(mut3.aui.p.ks,a3.ui.p.ks)
david3.aui.p.ks<-DS(mat3.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.ks<-cbind(ordrank.3.aui.p.ks,ds=david3.aui.p.ks$normDS)
lm3.aui.p.ks<-summary(lm(ordrank.3.aui.p.ks$ds~ordrank.3.aui.p.ks$ord.rank))
s3.aui.p.ks<-lm3.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[10]],X2=avoid.ui.p.ks[[11]],Avoids=avoid.ui.p.ks[[12]])
mat4.aui.p.ks<-avoid.inter.mat(mut4.aui.p.ks)
tri4.aui.p.ks<-tr.tri(mat4.aui.p.ks)
dci4.aui.p.ks<-DCindex(mat4.aui.p.ks)
mat4.aui.p.ks[is.na(mat4.aui.p.ks)] = 0
h4.aui.p.ks<-h.index(mat4.aui.p.ks)

ep4.aui.p.ks<-ep(mut4.aui.p.ks,a4.ui.p.ks)
david4.aui.p.ks<-DS(mat4.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.ks<-cbind(ordrank.4.aui.p.ks,ds=david4.aui.p.ks$normDS)
lm4.aui.p.ks<-summary(lm(ordrank.4.aui.p.ks$ds~ordrank.4.aui.p.ks$ord.rank))
s4.aui.p.ks<-lm4.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[13]],X2=avoid.ui.p.ks[[14]],Avoids=avoid.ui.p.ks[[15]])
mat5.aui.p.ks<-avoid.inter.mat(mut5.aui.p.ks)
tri5.aui.p.ks<-tr.tri(mat5.aui.p.ks)
dci5.aui.p.ks<-DCindex(mat5.aui.p.ks)
mat5.aui.p.ks[is.na(mat5.aui.p.ks)] = 0
h5.aui.p.ks<-h.index(mat5.aui.p.ks)

ep5.aui.p.ks<-ep(mut5.aui.p.ks,a5.ui.p.ks)
david5.aui.p.ks<-DS(mat5.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.ks<-cbind(ordrank.5.aui.p.ks,ds=david5.aui.p.ks$normDS)
lm5.aui.p.ks<-summary(lm(ordrank.5.aui.p.ks$ds~ordrank.5.aui.p.ks$ord.rank))
s5.aui.p.ks<-lm5.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[16]],X2=avoid.ui.p.ks[[17]],Avoids=avoid.ui.p.ks[[18]])
mat6.aui.p.ks<-avoid.inter.mat(mut6.aui.p.ks)
tri6.aui.p.ks<-tr.tri(mat6.aui.p.ks)
dci6.aui.p.ks<-DCindex(mat6.aui.p.ks)
mat6.aui.p.ks[is.na(mat6.aui.p.ks)] = 0
h6.aui.p.ks<-h.index(mat6.aui.p.ks)

ep6.aui.p.ks<-ep(mut6.aui.p.ks,a6.ui.p.ks)
david6.aui.p.ks<-DS(mat6.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.ks<-cbind(ordrank.6.aui.p.ks,ds=david6.aui.p.ks$normDS)
lm6.aui.p.ks<-summary(lm(ordrank.6.aui.p.ks$ds~ordrank.6.aui.p.ks$ord.rank))
s6.aui.p.ks<-lm6.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[19]],X2=avoid.ui.p.ks[[20]],Avoids=avoid.ui.p.ks[[21]])
mat7.aui.p.ks<-avoid.inter.mat(mut7.aui.p.ks)
tri7.aui.p.ks<-tr.tri(mat7.aui.p.ks)
dci7.aui.p.ks<-DCindex(mat7.aui.p.ks)
mat7.aui.p.ks[is.na(mat7.aui.p.ks)] = 0
h7.aui.p.ks<-h.index(mat7.aui.p.ks)

ep7.aui.p.ks<-ep(mut7.aui.p.ks,a7.ui.p.ks)
david7.aui.p.ks<-DS(mat7.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.ks<-cbind(ordrank.7.aui.p.ks,ds=david7.aui.p.ks$normDS)
lm7.aui.p.ks<-summary(lm(ordrank.7.aui.p.ks$ds~ordrank.7.aui.p.ks$ord.rank))
s7.aui.p.ks<-lm7.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[22]],X2=avoid.ui.p.ks[[23]],Avoids=avoid.ui.p.ks[[24]])
mat8.aui.p.ks<-avoid.inter.mat(mut8.aui.p.ks)
tri8.aui.p.ks<-tr.tri(mat8.aui.p.ks)
dci8.aui.p.ks<-DCindex(mat8.aui.p.ks)
mat8.aui.p.ks[is.na(mat8.aui.p.ks)] = 0
h8.aui.p.ks<-h.index(mat8.aui.p.ks)

ep8.aui.p.ks<-ep(mut8.aui.p.ks,a8.ui.p.ks)
david8.aui.p.ks<-DS(mat8.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.ks<-cbind(ordrank.8.aui.p.ks,ds=david8.aui.p.ks$normDS)
lm8.aui.p.ks<-summary(lm(ordrank.8.aui.p.ks$ds~ordrank.8.aui.p.ks$ord.rank))
s8.aui.p.ks<-lm8.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[25]],X2=avoid.ui.p.ks[[26]],Avoids=avoid.ui.p.ks[[27]])
mat9.aui.p.ks<-avoid.inter.mat(mut9.aui.p.ks)
tri9.aui.p.ks<-tr.tri(mat9.aui.p.ks)
dci9.aui.p.ks<-DCindex(mat9.aui.p.ks)
mat9.aui.p.ks[is.na(mat9.aui.p.ks)] = 0
h9.aui.p.ks<-h.index(mat9.aui.p.ks)

ep9.aui.p.ks<-ep(mut9.aui.p.ks,a9.ui.p.ks)
david9.aui.p.ks<-DS(mat9.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.ks<-cbind(ordrank.9.aui.p.ks,ds=david9.aui.p.ks$normDS)
lm9.aui.p.ks<-summary(lm(ordrank.9.aui.p.ks$ds~ordrank.9.aui.p.ks$ord.rank))
s9.aui.p.ks<-lm9.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.ks<-data.frame(X1=avoid.ui.p.ks[[28]],X2=avoid.ui.p.ks[[29]],Avoids=avoid.ui.p.ks[[30]])
mat10.aui.p.ks<-avoid.inter.mat(mut10.aui.p.ks)
tri10.aui.p.ks<-tr.tri(mat10.aui.p.ks)
dci10.aui.p.ks<-DCindex(mat10.aui.p.ks)
mat10.aui.p.ks[is.na(mat10.aui.p.ks)] = 0
h10.aui.p.ks<-h.index(mat10.aui.p.ks)

ep10.aui.p.ks<-ep(mut10.aui.p.ks,a10.ui.p.ks)
david10.aui.p.ks<-DS(mat10.aui.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.ks<-cbind(ordrank.10.aui.p.ks,ds=david10.aui.p.ks$normDS)
lm10.aui.p.ks<-summary(lm(ordrank.10.aui.p.ks$ds~ordrank.10.aui.p.ks$ord.rank))
s10.aui.p.ks<-lm10.aui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.ks<-sum(mut1.aui.p.ks$Victories)
int2.aui.p.ks<-sum(mut2.aui.p.ks$Victories)
int3.aui.p.ks<-sum(mut3.aui.p.ks$Victories)
int4.aui.p.ks<-sum(mut4.aui.p.ks$Victories)
int5.aui.p.ks<-sum(mut5.aui.p.ks$Victories)
int6.aui.p.ks<-sum(mut6.aui.p.ks$Victories)
int7.aui.p.ks<-sum(mut7.aui.p.ks$Victories)
int8.aui.p.ks<-sum(mut8.aui.p.ks$Victories)
int9.aui.p.ks<-sum(mut9.aui.p.ks$Victories)
int10.aui.p.ks<-sum(mut10.aui.p.ks$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.ks<-sum(a1.ui.p.ks$Victories)
av2.aui.p.ks<-sum(a2.ui.p.ks$Victories)
av3.aui.p.ks<-sum(a3.ui.p.ks$Victories)
av4.aui.p.ks<-sum(a4.ui.p.ks$Victories)
av5.aui.p.ks<-sum(a5.ui.p.ks$Victories)
av6.aui.p.ks<-sum(a6.ui.p.ks$Victories)
av7.aui.p.ks<-sum(a7.ui.p.ks$Victories)
av8.aui.p.ks<-sum(a8.ui.p.ks$Victories)
av9.aui.p.ks<-sum(a9.ui.p.ks$Victories)
av10.aui.p.ks<-sum(a10.ui.p.ks$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ks.aiu.p<-(sum(av1.aui.p.ks, av2.aui.p.ks, av3.aui.p.ks, av4.aui.p.ks, av5.aui.p.ks, av6.aui.p.ks, av7.aui.p.ks, av8.aui.p.ks, av9.aui.p.ks, av10.aui.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.aiu.p<-(sum(int1.aui.p.ks, int2.aui.p.ks, int3.aui.p.ks, int4.aui.p.ks, int5.aui.p.ks, int6.aui.p.ks, int7.aui.p.ks, int8.aui.p.ks, int9.aui.p.ks, int10.aui.p.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.p.ks<-e1.aui.p.ks[order(e1.aui.p.ks$ID),]
e1.aui.p.ks<-as.matrix(t(e1.1.aui.p.ks))

e2.aui.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.p.ks<-e2.aui.p.ks[order(e2.aui.p.ks$ID),]
e2.aui.p.ks<-as.matrix(t(e2.1.aui.p.ks))

e3.aui.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.p.ks<-e3.aui.p.ks[order(e3.aui.p.ks$ID),]
e3.aui.p.ks<-as.matrix(t(e3.1.aui.p.ks))

e4.aui.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.p.ks<-e4.aui.p.ks[order(e4.aui.p.ks$ID),]
e4.aui.p.ks<-as.matrix(t(e4.1.aui.p.ks))

e5.aui.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.p.ks<-e5.aui.p.ks[order(e5.aui.p.ks$ID),]
e5.aui.p.ks<-as.matrix(t(e5.1.aui.p.ks))

e6.aui.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.p.ks<-e6.aui.p.ks[order(e6.aui.p.ks$ID),]
e6.aui.p.ks<-as.matrix(t(e6.1.aui.p.ks))

e7.aui.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.p.ks<-e7.aui.p.ks[order(e7.aui.p.ks$ID),]
e7.aui.p.ks<-as.matrix(t(e7.1.aui.p.ks))

e8.aui.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.p.ks<-e8.aui.p.ks[order(e8.aui.p.ks$ID),]
e8.aui.p.ks<-as.matrix(t(e8.1.aui.p.ks))

e9.aui.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.p.ks<-e9.aui.p.ks[order(e9.aui.p.ks$ID),]
e9.aui.p.ks<-as.matrix(t(e9.1.aui.p.ks))

e10.aui.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.p.ks<-e10.aui.p.ks[order(e10.aui.p.ks$ID),]
e10.aui.p.ks<-as.matrix(t(e10.1.aui.p.ks))

energy.ks.aui.p.ks<-as.data.frame(matrix(c(e1.aui.p.ks,e2.aui.p.ks,e3.aui.p.ks,e4.aui.p.ks,e5.aui.p.ks,e6.aui.p.ks,e7.aui.p.ks,e8.aui.p.ks,e9.aui.p.ks,e10.aui.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.aui.p.ks<-data.frame(ID=energy.ks.aui.p.ks$V1,energy_over_distance=energy.ks.aui.p.ks$V2,energy_over_time=energy.ks.aui.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.ks<-david1.aui.p.ks[order(david1.aui.p.ks$ID),]
david1.aui.p.ks<-as.matrix(t(david1.1.aui.p.ks))

david2.1.aui.p.ks<-david2.aui.p.ks[order(david2.aui.p.ks$ID),]
david2.aui.p.ks<-as.matrix(t(david2.1.aui.p.ks))

david3.1.aui.p.ks<-david3.aui.p.ks[order(david3.aui.p.ks$ID),]
david3.aui.p.ks<-as.matrix(t(david3.1.aui.p.ks))

david4.1.aui.p.ks<-david4.aui.p.ks[order(david4.aui.p.ks$ID),]
david4.aui.p.ks<-as.matrix(t(david4.1.aui.p.ks))

david5.1.aui.p.ks<-david5.aui.p.ks[order(david5.aui.p.ks$ID),]
david5.aui.p.ks<-as.matrix(t(david5.1.aui.p.ks))

david6.1.aui.p.ks<-david6.aui.p.ks[order(david6.aui.p.ks$ID),]
david6.aui.p.ks<-as.matrix(t(david6.1.aui.p.ks))

david7.1.aui.p.ks<-david7.aui.p.ks[order(david7.aui.p.ks$ID),]
david7.aui.p.ks<-as.matrix(t(david7.1.aui.p.ks))

david8.1.aui.p.ks<-david8.aui.p.ks[order(david8.aui.p.ks$ID),]
david8.aui.p.ks<-as.matrix(t(david8.1.aui.p.ks))

david9.1.aui.p.ks<-david9.aui.p.ks[order(david9.aui.p.ks$ID),]
david9.aui.p.ks<-as.matrix(t(david9.1.aui.p.ks))

david10.1.aui.p.ks<-david10.aui.p.ks[order(david10.aui.p.ks$ID),]
david10.aui.p.ks<-as.matrix(t(david10.1.aui.p.ks))

david.ks.aui.p.ks<-as.data.frame(matrix(c(david1.aui.p.ks,david2.aui.p.ks,david3.aui.p.ks,david4.aui.p.ks,david5.aui.p.ks,david6.aui.p.ks,david7.aui.p.ks,david8.aui.p.ks,david9.aui.p.ks,david10.aui.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.aui.p.ks<-data.frame(ID=david.ks.aui.p.ks$V1,DS=david.ks.aui.p.ks$V2,normDS=david.ks.aui.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.aui.p.ks<-lm(e1.1.aui.p.ks$energy_over_time~as.numeric(david1.1.aui.p.ks$normDS))
ks.lm.1.s.aui.p.ks<-summary(lm.ks.1.aui.p.ks)$coefficients
ks.1.slope.aui.p.ks<-ks.lm.1.s.aui.p.ks[2,1]
lm.ks.2.aui.p.ks<-lm(e2.1.aui.p.ks$energy_over_time~as.numeric(david2.1.aui.p.ks$normDS))
ks.lm.2.s.aui.p.ks<-summary(lm.ks.2.aui.p.ks)$coefficients
ks.2.slope.aui.p.ks<-ks.lm.2.s.aui.p.ks[2,1]
lm.ks.3.aui.p.ks<-lm(e3.1.aui.p.ks$energy_over_time~as.numeric(david3.1.aui.p.ks$normDS))
ks.lm.3.s.aui.p.ks<-summary(lm.ks.3.aui.p.ks)$coefficients
ks.3.slope.aui.p.ks<-ks.lm.3.s.aui.p.ks[2,1]
lm.ks.4.aui.p.ks<-lm(e4.1.aui.p.ks$energy_over_time~as.numeric(david4.1.aui.p.ks$normDS))
ks.lm.4.s.aui.p.ks<-summary(lm.ks.4.aui.p.ks)$coefficients
ks.4.slope.aui.p.ks<-ks.lm.4.s.aui.p.ks[2,1]
lm.ks.5.aui.p.ks<-lm(e5.1.aui.p.ks$energy_over_time~as.numeric(david5.1.aui.p.ks$normDS))
ks.lm.5.s.aui.p.ks<-summary(lm.ks.5.aui.p.ks)$coefficients
ks.5.slope.aui.p.ks<-ks.lm.5.s.aui.p.ks[2,1]
lm.ks.6.aui.p.ks<-lm(e6.1.aui.p.ks$energy_over_time~as.numeric(david6.1.aui.p.ks$normDS))
ks.lm.6.s.aui.p.ks<-summary(lm.ks.6.aui.p.ks)$coefficients
ks.6.slope.aui.p.ks<-ks.lm.6.s.aui.p.ks[2,1]
lm.ks.7.aui.p.ks<-lm(e7.1.aui.p.ks$energy_over_time~as.numeric(david7.1.aui.p.ks$normDS))
ks.lm.7.s.aui.p.ks<-summary(lm.ks.7.aui.p.ks)$coefficients
ks.7.slope.aui.p.ks<-ks.lm.7.s.aui.p.ks[2,1]
lm.ks.8.aui.p.ks<-lm(e8.1.aui.p.ks$energy_over_time~as.numeric(david8.1.aui.p.ks$normDS))
ks.lm.8.s.aui.p.ks<-summary(lm.ks.8.aui.p.ks)$coefficients
ks.8.slope.aui.p.ks<-ks.lm.8.s.aui.p.ks[2,1]
lm.ks.9.aui.p.ks<-lm(e9.1.aui.p.ks$energy_over_time~as.numeric(david9.1.aui.p.ks$normDS))
ks.lm.9.s.aui.p.ks<-summary(lm.ks.9.aui.p.ks)$coefficients
ks.9.slope.aui.p.ks<-ks.lm.9.s.aui.p.ks[2,1]
lm.ks.10.aui.p.ks<-lm(e10.1.aui.p.ks$energy_over_time~as.numeric(david10.1.aui.p.ks$normDS))
ks.lm.10.s.aui.p.ks<-summary(lm.ks.10.aui.p.ks)$coefficients
ks.10.slope.aui.p.ks<-ks.lm.10.s.aui.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.aui.p.ss.avoid.ui.p.ks<-data.frame(triangle.transitivity=c(tri1.aui.p.ks,tri2.aui.p.ks,tri3.aui.p.ks,tri4.aui.p.ks,tri5.aui.p.ks,tri6.aui.p.ks,tri7.aui.p.ks,tri8.aui.p.ks,tri9.aui.p.ks,tri10.aui.p.ks),escalation=c(ep1.aui.p.ks,ep2.aui.p.ks,ep3.aui.p.ks,ep4.aui.p.ks,ep5.aui.p.ks,ep6.aui.p.ks,ep7.aui.p.ks,ep8.aui.p.ks,ep9.aui.p.ks,ep10.aui.p.ks),dci=c(dci1.aui.p.ks,dci2.aui.p.ks,dci3.aui.p.ks,dci4.aui.p.ks,dci5.aui.p.ks,dci6.aui.p.ks,dci7.aui.p.ks,dci8.aui.p.ks,dci9.aui.p.ks,dci10.aui.p.ks),steepness=c(s1.aui.p.ks,s2.aui.p.ks,s3.aui.p.ks,s4.aui.p.ks,s5.aui.p.ks,s6.aui.p.ks,s7.aui.p.ks,s8.aui.p.ks,s9.aui.p.ks,s10.aui.p.ks),slope=c(ks.1.slope.aui.p.ks,ks.2.slope.aui.p.ks,ks.3.slope.aui.p.ks,ks.4.slope.aui.p.ks,ks.5.slope.aui.p.ks,ks.6.slope.aui.p.ks,ks.7.slope.aui.p.ks,ks.8.slope.aui.p.ks,ks.9.slope.aui.p.ks,ks.10.slope.aui.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[1]],X2=avoid.ui.p.ko[[2]],Avoids=avoid.ui.p.ko[[3]])
mat1.aui.p.ko<-avoid.inter.mat(mut1.aui.p.ko)
tri1.aui.p.ko<-tr.tri(mat1.aui.p.ko)
dci1.aui.p.ko<-DCindex(mat1.aui.p.ko)
mat1.aui.p.ko[is.na(mat1.aui.p.ko)] = 0
h1.aui.p.ko<-h.index(mat1.aui.p.ko)

ep1.aui.p.ko<-ep(mut1.aui.p.ko,a1.ui.p.ko)
david1.aui.p.ko<-DS(mat1.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.ko<-cbind(ordrank.1.aui.p.ko,ds=david1.aui.p.ko$normDS)
lm1.aui.p.ko<-summary(lm(ordrank.1.aui.p.ko$ds~ordrank.1.aui.p.ko$ord.rank))
s1.aui.p.ko<-lm1.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[4]],X2=avoid.ui.p.ko[[5]],Avoids=avoid.ui.p.ko[[6]])
mat2.aui.p.ko<-avoid.inter.mat(mut2.aui.p.ko)
tri2.aui.p.ko<-tr.tri(mat2.aui.p.ko)
dci2.aui.p.ko<-DCindex(mat2.aui.p.ko)
mat2.aui.p.ko[is.na(mat2.aui.p.ko)] = 0
h2.aui.p.ko<-h.index(mat2.aui.p.ko)

ep2.aui.p.ko<-ep(mut2.aui.p.ko,a2.ui.p.ko)
david2.aui.p.ko<-DS(mat2.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.ko<-cbind(ordrank.2.aui.p.ko,ds=david2.aui.p.ko$normDS)
lm2.aui.p.ko<-summary(lm(ordrank.2.aui.p.ko$ds~ordrank.2.aui.p.ko$ord.rank))
s2.aui.p.ko<-lm2.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[7]],X2=avoid.ui.p.ko[[8]],Avoids=avoid.ui.p.ko[[9]])
mat3.aui.p.ko<-avoid.inter.mat(mut3.aui.p.ko)
tri3.aui.p.ko<-tr.tri(mat3.aui.p.ko)
dci3.aui.p.ko<-DCindex(mat3.aui.p.ko)
mat3.aui.p.ko[is.na(mat3.aui.p.ko)] = 0
h3.aui.p.ko<-h.index(mat3.aui.p.ko)

ep3.aui.p.ko<-ep(mut3.aui.p.ko,a3.ui.p.ko)
david3.aui.p.ko<-DS(mat3.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.ko<-cbind(ordrank.3.aui.p.ko,ds=david3.aui.p.ko$normDS)
lm3.aui.p.ko<-summary(lm(ordrank.3.aui.p.ko$ds~ordrank.3.aui.p.ko$ord.rank))
s3.aui.p.ko<-lm3.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[10]],X2=avoid.ui.p.ko[[11]],Avoids=avoid.ui.p.ko[[12]])
mat4.aui.p.ko<-avoid.inter.mat(mut4.aui.p.ko)
tri4.aui.p.ko<-tr.tri(mat4.aui.p.ko)
dci4.aui.p.ko<-DCindex(mat4.aui.p.ko)
mat4.aui.p.ko[is.na(mat4.aui.p.ko)] = 0
h4.aui.p.ko<-h.index(mat4.aui.p.ko)

ep4.aui.p.ko<-ep(mut4.aui.p.ko,a4.ui.p.ko)
david4.aui.p.ko<-DS(mat4.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.ko<-cbind(ordrank.4.aui.p.ko,ds=david4.aui.p.ko$normDS)
lm4.aui.p.ko<-summary(lm(ordrank.4.aui.p.ko$ds~ordrank.4.aui.p.ko$ord.rank))
s4.aui.p.ko<-lm4.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[13]],X2=avoid.ui.p.ko[[14]],Avoids=avoid.ui.p.ko[[15]])
mat5.aui.p.ko<-avoid.inter.mat(mut5.aui.p.ko)
tri5.aui.p.ko<-tr.tri(mat5.aui.p.ko)
dci5.aui.p.ko<-DCindex(mat5.aui.p.ko)
mat5.aui.p.ko[is.na(mat5.aui.p.ko)] = 0
h5.aui.p.ko<-h.index(mat5.aui.p.ko)

ep5.aui.p.ko<-ep(mut5.aui.p.ko,a5.ui.p.ko)
david5.aui.p.ko<-DS(mat5.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.ko<-cbind(ordrank.5.aui.p.ko,ds=david5.aui.p.ko$normDS)
lm5.aui.p.ko<-summary(lm(ordrank.5.aui.p.ko$ds~ordrank.5.aui.p.ko$ord.rank))
s5.aui.p.ko<-lm5.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[16]],X2=avoid.ui.p.ko[[17]],Avoids=avoid.ui.p.ko[[18]])
mat6.aui.p.ko<-avoid.inter.mat(mut6.aui.p.ko)
tri6.aui.p.ko<-tr.tri(mat6.aui.p.ko)
dci6.aui.p.ko<-DCindex(mat6.aui.p.ko)
mat6.aui.p.ko[is.na(mat6.aui.p.ko)] = 0
h6.aui.p.ko<-h.index(mat6.aui.p.ko)

ep6.aui.p.ko<-ep(mut6.aui.p.ko,a6.ui.p.ko)
david6.aui.p.ko<-DS(mat6.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.ko<-cbind(ordrank.6.aui.p.ko,ds=david6.aui.p.ko$normDS)
lm6.aui.p.ko<-summary(lm(ordrank.6.aui.p.ko$ds~ordrank.6.aui.p.ko$ord.rank))
s6.aui.p.ko<-lm6.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[19]],X2=avoid.ui.p.ko[[20]],Avoids=avoid.ui.p.ko[[21]])
mat7.aui.p.ko<-avoid.inter.mat(mut7.aui.p.ko)
tri7.aui.p.ko<-tr.tri(mat7.aui.p.ko)
dci7.aui.p.ko<-DCindex(mat7.aui.p.ko)
mat7.aui.p.ko[is.na(mat7.aui.p.ko)] = 0
h7.aui.p.ko<-h.index(mat7.aui.p.ko)

ep7.aui.p.ko<-ep(mut7.aui.p.ko,a7.ui.p.ko)
david7.aui.p.ko<-DS(mat7.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.ko<-cbind(ordrank.7.aui.p.ko,ds=david7.aui.p.ko$normDS)
lm7.aui.p.ko<-summary(lm(ordrank.7.aui.p.ko$ds~ordrank.7.aui.p.ko$ord.rank))
s7.aui.p.ko<-lm7.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[22]],X2=avoid.ui.p.ko[[23]],Avoids=avoid.ui.p.ko[[24]])
mat8.aui.p.ko<-avoid.inter.mat(mut8.aui.p.ko)
tri8.aui.p.ko<-tr.tri(mat8.aui.p.ko)
dci8.aui.p.ko<-DCindex(mat8.aui.p.ko)
mat8.aui.p.ko[is.na(mat8.aui.p.ko)] = 0
h8.aui.p.ko<-h.index(mat8.aui.p.ko)

ep8.aui.p.ko<-ep(mut8.aui.p.ko,a8.ui.p.ko)
david8.aui.p.ko<-DS(mat8.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.ko<-cbind(ordrank.8.aui.p.ko,ds=david8.aui.p.ko$normDS)
lm8.aui.p.ko<-summary(lm(ordrank.8.aui.p.ko$ds~ordrank.8.aui.p.ko$ord.rank))
s8.aui.p.ko<-lm8.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[25]],X2=avoid.ui.p.ko[[26]],Avoids=avoid.ui.p.ko[[27]])
mat9.aui.p.ko<-avoid.inter.mat(mut9.aui.p.ko)
tri9.aui.p.ko<-tr.tri(mat9.aui.p.ko)
dci9.aui.p.ko<-DCindex(mat9.aui.p.ko)
mat9.aui.p.ko[is.na(mat9.aui.p.ko)] = 0
h9.aui.p.ko<-h.index(mat9.aui.p.ko)

ep9.aui.p.ko<-ep(mut9.aui.p.ko,a9.ui.p.ko)
david9.aui.p.ko<-DS(mat9.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.ko<-cbind(ordrank.9.aui.p.ko,ds=david9.aui.p.ko$normDS)
lm9.aui.p.ko<-summary(lm(ordrank.9.aui.p.ko$ds~ordrank.9.aui.p.ko$ord.rank))
s9.aui.p.ko<-lm9.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.ko<-data.frame(X1=avoid.ui.p.ko[[28]],X2=avoid.ui.p.ko[[29]],Avoids=avoid.ui.p.ko[[30]])
mat10.aui.p.ko<-avoid.inter.mat(mut10.aui.p.ko)
tri10.aui.p.ko<-tr.tri(mat10.aui.p.ko)
dci10.aui.p.ko<-DCindex(mat10.aui.p.ko)
mat10.aui.p.ko[is.na(mat10.aui.p.ko)] = 0
h10.aui.p.ko<-h.index(mat10.aui.p.ko)

ep10.aui.p.ko<-ep(mut10.aui.p.ko,a10.ui.p.ko)
david10.aui.p.ko<-DS(mat10.aui.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.ko<-cbind(ordrank.10.aui.p.ko,ds=david10.aui.p.ko$normDS)
lm10.aui.p.ko<-summary(lm(ordrank.10.aui.p.ko$ds~ordrank.10.aui.p.ko$ord.rank))
s10.aui.p.ko<-lm10.aui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.ko<-sum(mut1.aui.p.ko$Victories)
int2.aui.p.ko<-sum(mut2.aui.p.ko$Victories)
int3.aui.p.ko<-sum(mut3.aui.p.ko$Victories)
int4.aui.p.ko<-sum(mut4.aui.p.ko$Victories)
int5.aui.p.ko<-sum(mut5.aui.p.ko$Victories)
int6.aui.p.ko<-sum(mut6.aui.p.ko$Victories)
int7.aui.p.ko<-sum(mut7.aui.p.ko$Victories)
int8.aui.p.ko<-sum(mut8.aui.p.ko$Victories)
int9.aui.p.ko<-sum(mut9.aui.p.ko$Victories)
int10.aui.p.ko<-sum(mut10.aui.p.ko$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.ko<-sum(a1.ui.p.ko$Victories)
av2.aui.p.ko<-sum(a2.ui.p.ko$Victories)
av3.aui.p.ko<-sum(a3.ui.p.ko$Victories)
av4.aui.p.ko<-sum(a4.ui.p.ko$Victories)
av5.aui.p.ko<-sum(a5.ui.p.ko$Victories)
av6.aui.p.ko<-sum(a6.ui.p.ko$Victories)
av7.aui.p.ko<-sum(a7.ui.p.ko$Victories)
av8.aui.p.ko<-sum(a8.ui.p.ko$Victories)
av9.aui.p.ko<-sum(a9.ui.p.ko$Victories)
av10.aui.p.ko<-sum(a10.ui.p.ko$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ko.aiu.p<-(sum(av1.aui.p.ko, av2.aui.p.ko, av3.aui.p.ko, av4.aui.p.ko, av5.aui.p.ko, av6.aui.p.ko, av7.aui.p.ko, av8.aui.p.ko, av9.aui.p.ko, av10.aui.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.aiu.p<-(sum(int1.aui.p.ko, int2.aui.p.ko, int3.aui.p.ko, int4.aui.p.ko, int5.aui.p.ko, int6.aui.p.ko, int7.aui.p.ko, int8.aui.p.ko, int9.aui.p.ko, int10.aui.p.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.p.ko<-e1.aui.p.ko[order(e1.aui.p.ko$ID),]
e1.aui.p.ko<-as.matrix(t(e1.1.aui.p.ko))

e2.aui.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.p.ko<-e2.aui.p.ko[order(e2.aui.p.ko$ID),]
e2.aui.p.ko<-as.matrix(t(e2.1.aui.p.ko))

e3.aui.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.p.ko<-e3.aui.p.ko[order(e3.aui.p.ko$ID),]
e3.aui.p.ko<-as.matrix(t(e3.1.aui.p.ko))

e4.aui.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.p.ko<-e4.aui.p.ko[order(e4.aui.p.ko$ID),]
e4.aui.p.ko<-as.matrix(t(e4.1.aui.p.ko))

e5.aui.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.p.ko<-e5.aui.p.ko[order(e5.aui.p.ko$ID),]
e5.aui.p.ko<-as.matrix(t(e5.1.aui.p.ko))

e6.aui.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.p.ko<-e6.aui.p.ko[order(e6.aui.p.ko$ID),]
e6.aui.p.ko<-as.matrix(t(e6.1.aui.p.ko))

e7.aui.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.p.ko<-e7.aui.p.ko[order(e7.aui.p.ko$ID),]
e7.aui.p.ko<-as.matrix(t(e7.1.aui.p.ko))

e8.aui.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.p.ko<-e8.aui.p.ko[order(e8.aui.p.ko$ID),]
e8.aui.p.ko<-as.matrix(t(e8.1.aui.p.ko))

e9.aui.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.p.ko<-e9.aui.p.ko[order(e9.aui.p.ko$ID),]
e9.aui.p.ko<-as.matrix(t(e9.1.aui.p.ko))

e10.aui.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.p.ko<-e10.aui.p.ko[order(e10.aui.p.ko$ID),]
e10.aui.p.ko<-as.matrix(t(e10.1.aui.p.ko))

energy.ko.aui.p.ko<-as.data.frame(matrix(c(e1.aui.p.ko,e2.aui.p.ko,e3.aui.p.ko,e4.aui.p.ko,e5.aui.p.ko,e6.aui.p.ko,e7.aui.p.ko,e8.aui.p.ko,e9.aui.p.ko,e10.aui.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.aui.p.ko<-data.frame(ID=energy.ko.aui.p.ko$V1,energy_over_distance=energy.ko.aui.p.ko$V2,energy_over_time=energy.ko.aui.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.ko<-david1.aui.p.ko[order(david1.aui.p.ko$ID),]
david1.aui.p.ko<-as.matrix(t(david1.1.aui.p.ko))

david2.1.aui.p.ko<-david2.aui.p.ko[order(david2.aui.p.ko$ID),]
david2.aui.p.ko<-as.matrix(t(david2.1.aui.p.ko))

david3.1.aui.p.ko<-david3.aui.p.ko[order(david3.aui.p.ko$ID),]
david3.aui.p.ko<-as.matrix(t(david3.1.aui.p.ko))

david4.1.aui.p.ko<-david4.aui.p.ko[order(david4.aui.p.ko$ID),]
david4.aui.p.ko<-as.matrix(t(david4.1.aui.p.ko))

david5.1.aui.p.ko<-david5.aui.p.ko[order(david5.aui.p.ko$ID),]
david5.aui.p.ko<-as.matrix(t(david5.1.aui.p.ko))

david6.1.aui.p.ko<-david6.aui.p.ko[order(david6.aui.p.ko$ID),]
david6.aui.p.ko<-as.matrix(t(david6.1.aui.p.ko))

david7.1.aui.p.ko<-david7.aui.p.ko[order(david7.aui.p.ko$ID),]
david7.aui.p.ko<-as.matrix(t(david7.1.aui.p.ko))

david8.1.aui.p.ko<-david8.aui.p.ko[order(david8.aui.p.ko$ID),]
david8.aui.p.ko<-as.matrix(t(david8.1.aui.p.ko))

david9.1.aui.p.ko<-david9.aui.p.ko[order(david9.aui.p.ko$ID),]
david9.aui.p.ko<-as.matrix(t(david9.1.aui.p.ko))

david10.1.aui.p.ko<-david10.aui.p.ko[order(david10.aui.p.ko$ID),]
david10.aui.p.ko<-as.matrix(t(david10.1.aui.p.ko))

david.ko.aui.p.ko<-as.data.frame(matrix(c(david1.aui.p.ko,david2.aui.p.ko,david3.aui.p.ko,david4.aui.p.ko,david5.aui.p.ko,david6.aui.p.ko,david7.aui.p.ko,david8.aui.p.ko,david9.aui.p.ko,david10.aui.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.aui.p.ko<-data.frame(ID=david.ko.aui.p.ko$V1,DS=david.ko.aui.p.ko$V2,normDS=david.ko.aui.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.aui.p.ko<-lm(e1.1.aui.p.ko$energy_over_time~as.numeric(david1.1.aui.p.ko$normDS))
ko.lm.1.s.aui.p.ko<-summary(lm.ko.1.aui.p.ko)$coefficients
ko.1.slope.aui.p.ko<-ko.lm.1.s.aui.p.ko[2,1]
lm.ko.2.aui.p.ko<-lm(e2.1.aui.p.ko$energy_over_time~as.numeric(david2.1.aui.p.ko$normDS))
ko.lm.2.s.aui.p.ko<-summary(lm.ko.2.aui.p.ko)$coefficients
ko.2.slope.aui.p.ko<-ko.lm.2.s.aui.p.ko[2,1]
lm.ko.3.aui.p.ko<-lm(e3.1.aui.p.ko$energy_over_time~as.numeric(david3.1.aui.p.ko$normDS))
ko.lm.3.s.aui.p.ko<-summary(lm.ko.3.aui.p.ko)$coefficients
ko.3.slope.aui.p.ko<-ko.lm.3.s.aui.p.ko[2,1]
lm.ko.4.aui.p.ko<-lm(e4.1.aui.p.ko$energy_over_time~as.numeric(david4.1.aui.p.ko$normDS))
ko.lm.4.s.aui.p.ko<-summary(lm.ko.4.aui.p.ko)$coefficients
ko.4.slope.aui.p.ko<-ko.lm.4.s.aui.p.ko[2,1]
lm.ko.5.aui.p.ko<-lm(e5.1.aui.p.ko$energy_over_time~as.numeric(david5.1.aui.p.ko$normDS))
ko.lm.5.s.aui.p.ko<-summary(lm.ko.5.aui.p.ko)$coefficients
ko.5.slope.aui.p.ko<-ko.lm.5.s.aui.p.ko[2,1]
lm.ko.6.aui.p.ko<-lm(e6.1.aui.p.ko$energy_over_time~as.numeric(david6.1.aui.p.ko$normDS))
ko.lm.6.s.aui.p.ko<-summary(lm.ko.6.aui.p.ko)$coefficients
ko.6.slope.aui.p.ko<-ko.lm.6.s.aui.p.ko[2,1]
lm.ko.7.aui.p.ko<-lm(e7.1.aui.p.ko$energy_over_time~as.numeric(david7.1.aui.p.ko$normDS))
ko.lm.7.s.aui.p.ko<-summary(lm.ko.7.aui.p.ko)$coefficients
ko.7.slope.aui.p.ko<-ko.lm.7.s.aui.p.ko[2,1]
lm.ko.8.aui.p.ko<-lm(e8.1.aui.p.ko$energy_over_time~as.numeric(david8.1.aui.p.ko$normDS))
ko.lm.8.s.aui.p.ko<-summary(lm.ko.8.aui.p.ko)$coefficients
ko.8.slope.aui.p.ko<-ko.lm.8.s.aui.p.ko[2,1]
lm.ko.9.aui.p.ko<-lm(e9.1.aui.p.ko$energy_over_time~as.numeric(david9.1.aui.p.ko$normDS))
ko.lm.9.s.aui.p.ko<-summary(lm.ko.9.aui.p.ko)$coefficients
ko.9.slope.aui.p.ko<-ko.lm.9.s.aui.p.ko[2,1]
lm.ko.10.aui.p.ko<-lm(e10.1.aui.p.ko$energy_over_time~as.numeric(david10.1.aui.p.ko$normDS))
ko.lm.10.s.aui.p.ko<-summary(lm.ko.10.aui.p.ko)$coefficients
ko.10.slope.aui.p.ko<-ko.lm.10.s.aui.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.aui.p.ss.avoid.ui.p.ko<-data.frame(triangle.transitivity=c(tri1.aui.p.ko,tri2.aui.p.ko,tri3.aui.p.ko,tri4.aui.p.ko,tri5.aui.p.ko,tri6.aui.p.ko,tri7.aui.p.ko,tri8.aui.p.ko,tri9.aui.p.ko,tri10.aui.p.ko),escalation=c(ep1.aui.p.ko,ep2.aui.p.ko,ep3.aui.p.ko,ep4.aui.p.ko,ep5.aui.p.ko,ep6.aui.p.ko,ep7.aui.p.ko,ep8.aui.p.ko,ep9.aui.p.ko,ep10.aui.p.ko),dci=c(dci1.aui.p.ko,dci2.aui.p.ko,dci3.aui.p.ko,dci4.aui.p.ko,dci5.aui.p.ko,dci6.aui.p.ko,dci7.aui.p.ko,dci8.aui.p.ko,dci9.aui.p.ko,dci10.aui.p.ko),steepness=c(s1.aui.p.ko,s2.aui.p.ko,s3.aui.p.ko,s4.aui.p.ko,s5.aui.p.ko,s6.aui.p.ko,s7.aui.p.ko,s8.aui.p.ko,s9.aui.p.ko,s10.aui.p.ko),slope=c(ko.1.slope.aui.p.ko,ko.2.slope.aui.p.ko,ko.3.slope.aui.p.ko,ko.4.slope.aui.p.ko,ko.5.slope.aui.p.ko,ko.6.slope.aui.p.ko,ko.7.slope.aui.p.ko,ko.8.slope.aui.p.ko,ko.9.slope.aui.p.ko,ko.10.slope.aui.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[1]],X2=avoid.ui.p.hm[[2]],Avoids=avoid.ui.p.hm[[3]])

mut1.aui.p.hm<-mut1.aui.p.hm[c(1:90),]
mut1.aui.p.hm<-transform(mut1.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat1.aui.p.hm<-avoid.inter.mat(mut1.aui.p.hm)
tri1.aui.p.hm<-tr.tri(mat1.aui.p.hm)
dci1.aui.p.hm<-DCindex(mat1.aui.p.hm)
mat1.aui.p.hm[is.na(mat1.aui.p.hm)] = 0
h1.aui.p.hm<-h.index(mat1.aui.p.hm)

ep1.aui.p.hm<-ep(mut1.aui.p.hm,a1.ui.p.hm)
david1.aui.p.hm<-DS(mat1.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.hm<-cbind(ordrank.1.aui.p.hm,ds=david1.aui.p.hm$normDS)
lm1.aui.p.hm<-summary(lm(ordrank.1.aui.p.hm$ds~ordrank.1.aui.p.hm$ord.rank))
s1.aui.p.hm<-lm1.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[4]],X2=avoid.ui.p.hm[[5]],Avoids=avoid.ui.p.hm[[6]])

mut2.aui.p.hm<-mut2.aui.p.hm[c(1:90),]
mut2.aui.p.hm<-transform(mut2.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat2.aui.p.hm<-avoid.inter.mat(mut2.aui.p.hm)
tri2.aui.p.hm<-tr.tri(mat2.aui.p.hm)
dci2.aui.p.hm<-DCindex(mat2.aui.p.hm)
mat2.aui.p.hm[is.na(mat2.aui.p.hm)] = 0
h2.aui.p.hm<-h.index(mat2.aui.p.hm)

ep2.aui.p.hm<-ep(mut2.aui.p.hm,a2.ui.p.hm)
david2.aui.p.hm<-DS(mat2.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.hm<-cbind(ordrank.2.aui.p.hm,ds=david2.aui.p.hm$normDS)
lm2.aui.p.hm<-summary(lm(ordrank.2.aui.p.hm$ds~ordrank.2.aui.p.hm$ord.rank))
s2.aui.p.hm<-lm2.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[7]],X2=avoid.ui.p.hm[[8]],Avoids=avoid.ui.p.hm[[9]])

mut3.aui.p.hm<-mut3.aui.p.hm[c(1:90),]
mut3.aui.p.hm<-transform(mut3.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat3.aui.p.hm<-avoid.inter.mat(mut3.aui.p.hm)
tri3.aui.p.hm<-tr.tri(mat3.aui.p.hm)
dci3.aui.p.hm<-DCindex(mat3.aui.p.hm)
mat3.aui.p.hm[is.na(mat3.aui.p.hm)] = 0
h3.aui.p.hm<-h.index(mat3.aui.p.hm)

ep3.aui.p.hm<-ep(mut3.aui.p.hm,a3.ui.p.hm)
david3.aui.p.hm<-DS(mat3.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.hm<-cbind(ordrank.3.aui.p.hm,ds=david3.aui.p.hm$normDS)
lm3.aui.p.hm<-summary(lm(ordrank.3.aui.p.hm$ds~ordrank.3.aui.p.hm$ord.rank))
s3.aui.p.hm<-lm3.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[10]],X2=avoid.ui.p.hm[[11]],Avoids=avoid.ui.p.hm[[12]])

mut4.aui.p.hm<-mut4.aui.p.hm[c(1:90),]
mut4.aui.p.hm<-transform(mut4.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat4.aui.p.hm<-avoid.inter.mat(mut4.aui.p.hm)
tri4.aui.p.hm<-tr.tri(mat4.aui.p.hm)
dci4.aui.p.hm<-DCindex(mat4.aui.p.hm)
mat4.aui.p.hm[is.na(mat4.aui.p.hm)] = 0
h4.aui.p.hm<-h.index(mat4.aui.p.hm)

ep4.aui.p.hm<-ep(mut4.aui.p.hm,a4.ui.p.hm)
david4.aui.p.hm<-DS(mat4.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.hm<-cbind(ordrank.4.aui.p.hm,ds=david4.aui.p.hm$normDS)
lm4.aui.p.hm<-summary(lm(ordrank.4.aui.p.hm$ds~ordrank.4.aui.p.hm$ord.rank))
s4.aui.p.hm<-lm4.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[13]],X2=avoid.ui.p.hm[[14]],Avoids=avoid.ui.p.hm[[15]])

mut5.aui.p.hm<-mut5.aui.p.hm[c(1:90),]
mut5.aui.p.hm<-transform(mut5.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat5.aui.p.hm<-avoid.inter.mat(mut5.aui.p.hm)
tri5.aui.p.hm<-tr.tri(mat5.aui.p.hm)
dci5.aui.p.hm<-DCindex(mat5.aui.p.hm)
mat5.aui.p.hm[is.na(mat5.aui.p.hm)] = 0
h5.aui.p.hm<-h.index(mat5.aui.p.hm)

ep5.aui.p.hm<-ep(mut5.aui.p.hm,a5.ui.p.hm)
david5.aui.p.hm<-DS(mat5.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.hm<-cbind(ordrank.5.aui.p.hm,ds=david5.aui.p.hm$normDS)
lm5.aui.p.hm<-summary(lm(ordrank.5.aui.p.hm$ds~ordrank.5.aui.p.hm$ord.rank))
s5.aui.p.hm<-lm5.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[16]],X2=avoid.ui.p.hm[[17]],Avoids=avoid.ui.p.hm[[18]])

mut6.aui.p.hm<-mut6.aui.p.hm[c(1:90),]
mut6.aui.p.hm<-transform(mut6.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat6.aui.p.hm<-avoid.inter.mat(mut6.aui.p.hm)
tri6.aui.p.hm<-tr.tri(mat6.aui.p.hm)
dci6.aui.p.hm<-DCindex(mat6.aui.p.hm)
mat6.aui.p.hm[is.na(mat6.aui.p.hm)] = 0
h6.aui.p.hm<-h.index(mat6.aui.p.hm)

ep6.aui.p.hm<-ep(mut6.aui.p.hm,a6.ui.p.hm)
david6.aui.p.hm<-DS(mat6.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.hm<-cbind(ordrank.6.aui.p.hm,ds=david6.aui.p.hm$normDS)
lm6.aui.p.hm<-summary(lm(ordrank.6.aui.p.hm$ds~ordrank.6.aui.p.hm$ord.rank))
s6.aui.p.hm<-lm6.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[19]],X2=avoid.ui.p.hm[[20]],Avoids=avoid.ui.p.hm[[21]])

mut7.aui.p.hm<-mut7.aui.p.hm[c(1:90),]
mut7.aui.p.hm<-transform(mut7.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat7.aui.p.hm<-avoid.inter.mat(mut7.aui.p.hm)
tri7.aui.p.hm<-tr.tri(mat7.aui.p.hm)
dci7.aui.p.hm<-DCindex(mat7.aui.p.hm)
mat7.aui.p.hm[is.na(mat7.aui.p.hm)] = 0
h7.aui.p.hm<-h.index(mat7.aui.p.hm)

ep7.aui.p.hm<-ep(mut7.aui.p.hm,a7.ui.p.hm)
david7.aui.p.hm<-DS(mat7.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.hm<-cbind(ordrank.7.aui.p.hm,ds=david7.aui.p.hm$normDS)
lm7.aui.p.hm<-summary(lm(ordrank.7.aui.p.hm$ds~ordrank.7.aui.p.hm$ord.rank))
s7.aui.p.hm<-lm7.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[22]],X2=avoid.ui.p.hm[[23]],Avoids=avoid.ui.p.hm[[24]])

mut8.aui.p.hm<-mut8.aui.p.hm[c(1:90),]
mut8.aui.p.hm<-transform(mut8.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat8.aui.p.hm<-avoid.inter.mat(mut8.aui.p.hm)
tri8.aui.p.hm<-tr.tri(mat8.aui.p.hm)
dci8.aui.p.hm<-DCindex(mat8.aui.p.hm)
mat8.aui.p.hm[is.na(mat8.aui.p.hm)] = 0
h8.aui.p.hm<-h.index(mat8.aui.p.hm)

ep8.aui.p.hm<-ep(mut8.aui.p.hm,a8.ui.p.hm)
david8.aui.p.hm<-DS(mat8.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.hm<-cbind(ordrank.8.aui.p.hm,ds=david8.aui.p.hm$normDS)
lm8.aui.p.hm<-summary(lm(ordrank.8.aui.p.hm$ds~ordrank.8.aui.p.hm$ord.rank))
s8.aui.p.hm<-lm8.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[25]],X2=avoid.ui.p.hm[[26]],Avoids=avoid.ui.p.hm[[27]])

mut9.aui.p.hm<-mut9.aui.p.hm[c(1:90),]
mut9.aui.p.hm<-transform(mut9.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat9.aui.p.hm<-avoid.inter.mat(mut9.aui.p.hm)
tri9.aui.p.hm<-tr.tri(mat9.aui.p.hm)
dci9.aui.p.hm<-DCindex(mat9.aui.p.hm)
mat9.aui.p.hm[is.na(mat9.aui.p.hm)] = 0
h9.aui.p.hm<-h.index(mat9.aui.p.hm)

ep9.aui.p.hm<-ep(mut9.aui.p.hm,a9.ui.p.hm)
david9.aui.p.hm<-DS(mat9.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.hm<-cbind(ordrank.9.aui.p.hm,ds=david9.aui.p.hm$normDS)
lm9.aui.p.hm<-summary(lm(ordrank.9.aui.p.hm$ds~ordrank.9.aui.p.hm$ord.rank))
s9.aui.p.hm<-lm9.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.hm<-data.frame(X1=avoid.ui.p.hm[[28]],X2=avoid.ui.p.hm[[29]],Avoids=avoid.ui.p.hm[[30]])

mut10.aui.p.hm<-mut10.aui.p.hm[c(1:90),]
mut10.aui.p.hm<-transform(mut10.aui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Avoids=as.numeric(Avoids))

mat10.aui.p.hm<-avoid.inter.mat(mut10.aui.p.hm)
tri10.aui.p.hm<-tr.tri(mat10.aui.p.hm)
dci10.aui.p.hm<-DCindex(mat10.aui.p.hm)
mat10.aui.p.hm[is.na(mat10.aui.p.hm)] = 0
h10.aui.p.hm<-h.index(mat10.aui.p.hm)

ep10.aui.p.hm<-ep(mut10.aui.p.hm,a10.ui.p.hm)
david10.aui.p.hm<-DS(mat10.aui.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.hm<-cbind(ordrank.10.aui.p.hm,ds=david10.aui.p.hm$normDS)
lm10.aui.p.hm<-summary(lm(ordrank.10.aui.p.hm$ds~ordrank.10.aui.p.hm$ord.rank))
s10.aui.p.hm<-lm10.aui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.hm<-sum(mut1.aui.p.hm$Avoids)
int2.aui.p.hm<-sum(mut2.aui.p.hm$Avoids)
int3.aui.p.hm<-sum(mut3.aui.p.hm$Avoids)
int4.aui.p.hm<-sum(mut4.aui.p.hm$Avoids)
int5.aui.p.hm<-sum(mut5.aui.p.hm$Avoids)
int6.aui.p.hm<-sum(mut6.aui.p.hm$Avoids)
int7.aui.p.hm<-sum(mut7.aui.p.hm$Avoids)
int8.aui.p.hm<-sum(mut8.aui.p.hm$Avoids)
int9.aui.p.hm<-sum(mut9.aui.p.hm$Avoids)
int10.aui.p.hm<-sum(mut10.aui.p.hm$Avoids)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.hm<-sum(a1.ui.p.hm$Avoids)
av2.aui.p.hm<-sum(a2.ui.p.hm$Avoids)
av3.aui.p.hm<-sum(a3.ui.p.hm$Avoids)
av4.aui.p.hm<-sum(a4.ui.p.hm$Avoids)
av5.aui.p.hm<-sum(a5.ui.p.hm$Avoids)
av6.aui.p.hm<-sum(a6.ui.p.hm$Avoids)
av7.aui.p.hm<-sum(a7.ui.p.hm$Avoids)
av8.aui.p.hm<-sum(a8.ui.p.hm$Avoids)
av9.aui.p.hm<-sum(a9.ui.p.hm$Avoids)
av10.aui.p.hm<-sum(a10.ui.p.hm$Avoids)

  # Calculate the average number of avoidances across trials:
avg.av.hm.aiu.p<-(sum(av1.aui.p.hm, av2.aui.p.hm, av3.aui.p.hm, av4.aui.p.hm, av5.aui.p.hm, av6.aui.p.hm, av7.aui.p.hm, av8.aui.p.hm, av9.aui.p.hm, av10.aui.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.aiu.p<-(sum(int1.aui.p.hm, int2.aui.p.hm, int3.aui.p.hm, int4.aui.p.hm, int5.aui.p.hm, int6.aui.p.hm, int7.aui.p.hm, int8.aui.p.hm, int9.aui.p.hm, int10.aui.p.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.aui.p.hm<-e1.aui.p.hm[c(1:10),]
e1.aui.p.hm<-transform(e1.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e1.1.aui.p.hm<-e1.aui.p.hm[order(e1.aui.p.hm$ID),]
e1.aui.p.hm<-as.matrix(t(e1.1.aui.p.hm))

e2.aui.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.aui.p.hm<-e2.aui.p.hm[c(1:10),]
e2.aui.p.hm<-transform(e2.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e2.1.aui.p.hm<-e2.aui.p.hm[order(e2.aui.p.hm$ID),]
e2.aui.p.hm<-as.matrix(t(e2.1.aui.p.hm))

e3.aui.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.aui.p.hm<-e3.aui.p.hm[c(1:10),]
e3.aui.p.hm<-transform(e3.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e3.1.aui.p.hm<-e3.aui.p.hm[order(e3.aui.p.hm$ID),]
e3.aui.p.hm<-as.matrix(t(e3.1.aui.p.hm))

e4.aui.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.aui.p.hm<-e4.aui.p.hm[c(1:10),]
e4.aui.p.hm<-transform(e4.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e4.1.aui.p.hm<-e4.aui.p.hm[order(e4.aui.p.hm$ID),]
e4.aui.p.hm<-as.matrix(t(e4.1.aui.p.hm))

e5.aui.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.aui.p.hm<-e5.aui.p.hm[c(1:10),]
e5.aui.p.hm<-transform(e5.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e5.1.aui.p.hm<-e5.aui.p.hm[order(e5.aui.p.hm$ID),]
e5.aui.p.hm<-as.matrix(t(e5.1.aui.p.hm))

e6.aui.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.aui.p.hm<-e6.aui.p.hm[c(1:10),]
e6.aui.p.hm<-transform(e6.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e6.1.aui.p.hm<-e6.aui.p.hm[order(e6.aui.p.hm$ID),]
e6.aui.p.hm<-as.matrix(t(e6.1.aui.p.hm))

e7.aui.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.aui.p.hm<-e7.aui.p.hm[c(1:10),]
e7.aui.p.hm<-transform(e7.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e7.1.aui.p.hm<-e7.aui.p.hm[order(e7.aui.p.hm$ID),]
e7.aui.p.hm<-as.matrix(t(e7.1.aui.p.hm))

e8.aui.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.aui.p.hm<-e8.aui.p.hm[c(1:10),]
e8.aui.p.hm<-transform(e8.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e8.1.aui.p.hm<-e8.aui.p.hm[order(e8.aui.p.hm$ID),]
e8.aui.p.hm<-as.matrix(t(e8.1.aui.p.hm))

e9.aui.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.aui.p.hm<-e9.aui.p.hm[c(1:10),]
e9.aui.p.hm<-transform(e9.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e9.1.aui.p.hm<-e9.aui.p.hm[order(e9.aui.p.hm$ID),]
e9.aui.p.hm<-as.matrix(t(e9.1.aui.p.hm))

e10.aui.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.aui.p.hm<-e10.aui.p.hm[c(1:10),]
e10.aui.p.hm<-transform(e10.aui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e10.1.aui.p.hm<-e10.aui.p.hm[order(e10.aui.p.hm$ID),]
e10.aui.p.hm<-as.matrix(t(e10.1.aui.p.hm))

energy.hm.aui.p.hm<-as.data.frame(matrix(c(e1.aui.p.hm,e2.aui.p.hm,e3.aui.p.hm,e4.aui.p.hm,e5.aui.p.hm,e6.aui.p.hm,e7.aui.p.hm,e8.aui.p.hm,e9.aui.p.hm,e10.aui.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.aui.p.hm<-data.frame(ID=energy.hm.aui.p.hm$V1,energy_over_distance=energy.hm.aui.p.hm$V2,energy_over_time=energy.hm.aui.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.hm<-david1.aui.p.hm[order(david1.aui.p.hm$ID),]
david1.aui.p.hm<-as.matrix(t(david1.1.aui.p.hm))

david2.1.aui.p.hm<-david2.aui.p.hm[order(david2.aui.p.hm$ID),]
david2.aui.p.hm<-as.matrix(t(david2.1.aui.p.hm))

david3.1.aui.p.hm<-david3.aui.p.hm[order(david3.aui.p.hm$ID),]
david3.aui.p.hm<-as.matrix(t(david3.1.aui.p.hm))

david4.1.aui.p.hm<-david4.aui.p.hm[order(david4.aui.p.hm$ID),]
david4.aui.p.hm<-as.matrix(t(david4.1.aui.p.hm))

david5.1.aui.p.hm<-david5.aui.p.hm[order(david5.aui.p.hm$ID),]
david5.aui.p.hm<-as.matrix(t(david5.1.aui.p.hm))

david6.1.aui.p.hm<-david6.aui.p.hm[order(david6.aui.p.hm$ID),]
david6.aui.p.hm<-as.matrix(t(david6.1.aui.p.hm))

david7.1.aui.p.hm<-david7.aui.p.hm[order(david7.aui.p.hm$ID),]
david7.aui.p.hm<-as.matrix(t(david7.1.aui.p.hm))

david8.1.aui.p.hm<-david8.aui.p.hm[order(david8.aui.p.hm$ID),]
david8.aui.p.hm<-as.matrix(t(david8.1.aui.p.hm))

david9.1.aui.p.hm<-david9.aui.p.hm[order(david9.aui.p.hm$ID),]
david9.aui.p.hm<-as.matrix(t(david9.1.aui.p.hm))

david10.1.aui.p.hm<-david10.aui.p.hm[order(david10.aui.p.hm$ID),]
david10.aui.p.hm<-as.matrix(t(david10.1.aui.p.hm))

david.hm.aui.p.hm<-as.data.frame(matrix(c(david1.aui.p.hm,david2.aui.p.hm,david3.aui.p.hm,david4.aui.p.hm,david5.aui.p.hm,david6.aui.p.hm,david7.aui.p.hm,david8.aui.p.hm,david9.aui.p.hm,david10.aui.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.aui.p.hm<-data.frame(ID=david.hm.aui.p.hm$V1,DS=david.hm.aui.p.hm$V2,normDS=david.hm.aui.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.aui.p.hm<-lm(e1.1.aui.p.hm$energy_over_time~as.numeric(david1.1.aui.p.hm$normDS))
hm.lm.1.s.aui.p.hm<-summary(lm.hm.1.aui.p.hm)$coefficients
hm.1.slope.aui.p.hm<-hm.lm.1.s.aui.p.hm[2,1]
lm.hm.2.aui.p.hm<-lm(e2.1.aui.p.hm$energy_over_time~as.numeric(david2.1.aui.p.hm$normDS))
hm.lm.2.s.aui.p.hm<-summary(lm.hm.2.aui.p.hm)$coefficients
hm.2.slope.aui.p.hm<-hm.lm.2.s.aui.p.hm[2,1]
lm.hm.3.aui.p.hm<-lm(e3.1.aui.p.hm$energy_over_time~as.numeric(david3.1.aui.p.hm$normDS))
hm.lm.3.s.aui.p.hm<-summary(lm.hm.3.aui.p.hm)$coefficients
hm.3.slope.aui.p.hm<-hm.lm.3.s.aui.p.hm[2,1]
lm.hm.4.aui.p.hm<-lm(e4.1.aui.p.hm$energy_over_time~as.numeric(david4.1.aui.p.hm$normDS))
hm.lm.4.s.aui.p.hm<-summary(lm.hm.4.aui.p.hm)$coefficients
hm.4.slope.aui.p.hm<-hm.lm.4.s.aui.p.hm[2,1]
lm.hm.5.aui.p.hm<-lm(e5.1.aui.p.hm$energy_over_time~as.numeric(david5.1.aui.p.hm$normDS))
hm.lm.5.s.aui.p.hm<-summary(lm.hm.5.aui.p.hm)$coefficients
hm.5.slope.aui.p.hm<-hm.lm.5.s.aui.p.hm[2,1]
lm.hm.6.aui.p.hm<-lm(e6.1.aui.p.hm$energy_over_time~as.numeric(david6.1.aui.p.hm$normDS))
hm.lm.6.s.aui.p.hm<-summary(lm.hm.6.aui.p.hm)$coefficients
hm.6.slope.aui.p.hm<-hm.lm.6.s.aui.p.hm[2,1]
lm.hm.7.aui.p.hm<-lm(e7.1.aui.p.hm$energy_over_time~as.numeric(david7.1.aui.p.hm$normDS))
hm.lm.7.s.aui.p.hm<-summary(lm.hm.7.aui.p.hm)$coefficients
hm.7.slope.aui.p.hm<-hm.lm.7.s.aui.p.hm[2,1]
lm.hm.8.aui.p.hm<-lm(e8.1.aui.p.hm$energy_over_time~as.numeric(david8.1.aui.p.hm$normDS))
hm.lm.8.s.aui.p.hm<-summary(lm.hm.8.aui.p.hm)$coefficients
hm.8.slope.aui.p.hm<-hm.lm.8.s.aui.p.hm[2,1]
lm.hm.9.aui.p.hm<-lm(e9.1.aui.p.hm$energy_over_time~as.numeric(david9.1.aui.p.hm$normDS))
hm.lm.9.s.aui.p.hm<-summary(lm.hm.9.aui.p.hm)$coefficients
hm.9.slope.aui.p.hm<-hm.lm.9.s.aui.p.hm[2,1]
lm.hm.10.aui.p.hm<-lm(e10.1.aui.p.hm$energy_over_time~as.numeric(david10.1.aui.p.hm$normDS))
hm.lm.10.s.aui.p.hm<-summary(lm.hm.10.aui.p.hm)$coefficients
hm.10.slope.aui.p.hm<-hm.lm.10.s.aui.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.aui.p.ss.avoid.ui.p.hm<-data.frame(triangle.transitivity=c(tri1.aui.p.hm,tri2.aui.p.hm,tri3.aui.p.hm,tri4.aui.p.hm,tri5.aui.p.hm,tri6.aui.p.hm,tri7.aui.p.hm,tri8.aui.p.hm,tri9.aui.p.hm,tri10.aui.p.hm),escalation=c(ep1.aui.p.hm,ep2.aui.p.hm,ep3.aui.p.hm,ep4.aui.p.hm,ep5.aui.p.hm,ep6.aui.p.hm,ep7.aui.p.hm,ep8.aui.p.hm,ep9.aui.p.hm,ep10.aui.p.hm),dci=c(dci1.aui.p.hm,dci2.aui.p.hm,dci3.aui.p.hm,dci4.aui.p.hm,dci5.aui.p.hm,dci6.aui.p.hm,dci7.aui.p.hm,dci8.aui.p.hm,dci9.aui.p.hm,dci10.aui.p.hm),steepness=c(s1.aui.p.hm,s2.aui.p.hm,s3.aui.p.hm,s4.aui.p.hm,s5.aui.p.hm,s6.aui.p.hm,s7.aui.p.hm,s8.aui.p.hm,s9.aui.p.hm,s10.aui.p.hm),slope=c(hm.1.slope.aui.p.hm,hm.2.slope.aui.p.hm,hm.3.slope.aui.p.hm,hm.4.slope.aui.p.hm,hm.5.slope.aui.p.hm,hm.6.slope.aui.p.hm,hm.7.slope.aui.p.hm,hm.8.slope.aui.p.hm,hm.9.slope.aui.p.hm,hm.10.slope.aui.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[1]],X2=avoid.ui.p.hs[[2]],Avoids=avoid.ui.p.hs[[3]])
mat1.aui.p.hs<-avoid.inter.mat(mut1.aui.p.hs)
tri1.aui.p.hs<-tr.tri(mat1.aui.p.hs)
dci1.aui.p.hs<-DCindex(mat1.aui.p.hs)
mat1.aui.p.hs[is.na(mat1.aui.p.hs)] = 0
h1.aui.p.hs<-h.index(mat1.aui.p.hs)

ep1.aui.p.hs<-ep(mut1.aui.p.hs,a1.ui.p.hs)
david1.aui.p.hs<-DS(mat1.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.hs<-cbind(ordrank.1.aui.p.hs,ds=david1.aui.p.hs$normDS)
lm1.aui.p.hs<-summary(lm(ordrank.1.aui.p.hs$ds~ordrank.1.aui.p.hs$ord.rank))
s1.aui.p.hs<-lm1.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[4]],X2=avoid.ui.p.hs[[5]],Avoids=avoid.ui.p.hs[[6]])
mat2.aui.p.hs<-avoid.inter.mat(mut2.aui.p.hs)
tri2.aui.p.hs<-tr.tri(mat2.aui.p.hs)
dci2.aui.p.hs<-DCindex(mat2.aui.p.hs)
mat2.aui.p.hs[is.na(mat2.aui.p.hs)] = 0
h2.aui.p.hs<-h.index(mat2.aui.p.hs)

ep2.aui.p.hs<-ep(mut2.aui.p.hs,a2.ui.p.hs)
david2.aui.p.hs<-DS(mat2.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.hs<-cbind(ordrank.2.aui.p.hs,ds=david2.aui.p.hs$normDS)
lm2.aui.p.hs<-summary(lm(ordrank.2.aui.p.hs$ds~ordrank.2.aui.p.hs$ord.rank))
s2.aui.p.hs<-lm2.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[7]],X2=avoid.ui.p.hs[[8]],Avoids=avoid.ui.p.hs[[9]])
mat3.aui.p.hs<-avoid.inter.mat(mut3.aui.p.hs)
tri3.aui.p.hs<-tr.tri(mat3.aui.p.hs)
dci3.aui.p.hs<-DCindex(mat3.aui.p.hs)
mat3.aui.p.hs[is.na(mat3.aui.p.hs)] = 0
h3.aui.p.hs<-h.index(mat3.aui.p.hs)

ep3.aui.p.hs<-ep(mut3.aui.p.hs,a3.ui.p.hs)
david3.aui.p.hs<-DS(mat3.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.hs<-cbind(ordrank.3.aui.p.hs,ds=david3.aui.p.hs$normDS)
lm3.aui.p.hs<-summary(lm(ordrank.3.aui.p.hs$ds~ordrank.3.aui.p.hs$ord.rank))
s3.aui.p.hs<-lm3.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[10]],X2=avoid.ui.p.hs[[11]],Avoids=avoid.ui.p.hs[[12]])
mat4.aui.p.hs<-avoid.inter.mat(mut4.aui.p.hs)
tri4.aui.p.hs<-tr.tri(mat4.aui.p.hs)
dci4.aui.p.hs<-DCindex(mat4.aui.p.hs)
mat4.aui.p.hs[is.na(mat4.aui.p.hs)] = 0
h4.aui.p.hs<-h.index(mat4.aui.p.hs)

ep4.aui.p.hs<-ep(mut4.aui.p.hs,a4.ui.p.hs)
david4.aui.p.hs<-DS(mat4.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.hs<-cbind(ordrank.4.aui.p.hs,ds=david4.aui.p.hs$normDS)
lm4.aui.p.hs<-summary(lm(ordrank.4.aui.p.hs$ds~ordrank.4.aui.p.hs$ord.rank))
s4.aui.p.hs<-lm4.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[13]],X2=avoid.ui.p.hs[[14]],Avoids=avoid.ui.p.hs[[15]])
mat5.aui.p.hs<-avoid.inter.mat(mut5.aui.p.hs)
tri5.aui.p.hs<-tr.tri(mat5.aui.p.hs)
dci5.aui.p.hs<-DCindex(mat5.aui.p.hs)
mat5.aui.p.hs[is.na(mat5.aui.p.hs)] = 0
h5.aui.p.hs<-h.index(mat5.aui.p.hs)

ep5.aui.p.hs<-ep(mut5.aui.p.hs,a5.ui.p.hs)
david5.aui.p.hs<-DS(mat5.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.hs<-cbind(ordrank.5.aui.p.hs,ds=david5.aui.p.hs$normDS)
lm5.aui.p.hs<-summary(lm(ordrank.5.aui.p.hs$ds~ordrank.5.aui.p.hs$ord.rank))
s5.aui.p.hs<-lm5.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[16]],X2=avoid.ui.p.hs[[17]],Avoids=avoid.ui.p.hs[[18]])
mat6.aui.p.hs<-avoid.inter.mat(mut6.aui.p.hs)
tri6.aui.p.hs<-tr.tri(mat6.aui.p.hs)
dci6.aui.p.hs<-DCindex(mat6.aui.p.hs)
mat6.aui.p.hs[is.na(mat6.aui.p.hs)] = 0
h6.aui.p.hs<-h.index(mat6.aui.p.hs)

ep6.aui.p.hs<-ep(mut6.aui.p.hs,a6.ui.p.hs)
david6.aui.p.hs<-DS(mat6.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.hs<-cbind(ordrank.6.aui.p.hs,ds=david6.aui.p.hs$normDS)
lm6.aui.p.hs<-summary(lm(ordrank.6.aui.p.hs$ds~ordrank.6.aui.p.hs$ord.rank))
s6.aui.p.hs<-lm6.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[19]],X2=avoid.ui.p.hs[[20]],Avoids=avoid.ui.p.hs[[21]])
mat7.aui.p.hs<-avoid.inter.mat(mut7.aui.p.hs)
tri7.aui.p.hs<-tr.tri(mat7.aui.p.hs)
dci7.aui.p.hs<-DCindex(mat7.aui.p.hs)
mat7.aui.p.hs[is.na(mat7.aui.p.hs)] = 0
h7.aui.p.hs<-h.index(mat7.aui.p.hs)

ep7.aui.p.hs<-ep(mut7.aui.p.hs,a7.ui.p.hs)
david7.aui.p.hs<-DS(mat7.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.hs<-cbind(ordrank.7.aui.p.hs,ds=david7.aui.p.hs$normDS)
lm7.aui.p.hs<-summary(lm(ordrank.7.aui.p.hs$ds~ordrank.7.aui.p.hs$ord.rank))
s7.aui.p.hs<-lm7.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[22]],X2=avoid.ui.p.hs[[23]],Avoids=avoid.ui.p.hs[[24]])
mat8.aui.p.hs<-avoid.inter.mat(mut8.aui.p.hs)
tri8.aui.p.hs<-tr.tri(mat8.aui.p.hs)
dci8.aui.p.hs<-DCindex(mat8.aui.p.hs)
mat8.aui.p.hs[is.na(mat8.aui.p.hs)] = 0
h8.aui.p.hs<-h.index(mat8.aui.p.hs)

ep8.aui.p.hs<-ep(mut8.aui.p.hs,a8.ui.p.hs)
david8.aui.p.hs<-DS(mat8.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.hs<-cbind(ordrank.8.aui.p.hs,ds=david8.aui.p.hs$normDS)
lm8.aui.p.hs<-summary(lm(ordrank.8.aui.p.hs$ds~ordrank.8.aui.p.hs$ord.rank))
s8.aui.p.hs<-lm8.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[25]],X2=avoid.ui.p.hs[[26]],Avoids=avoid.ui.p.hs[[27]])
mat9.aui.p.hs<-avoid.inter.mat(mut9.aui.p.hs)
tri9.aui.p.hs<-tr.tri(mat9.aui.p.hs)
dci9.aui.p.hs<-DCindex(mat9.aui.p.hs)
mat9.aui.p.hs[is.na(mat9.aui.p.hs)] = 0
h9.aui.p.hs<-h.index(mat9.aui.p.hs)

ep9.aui.p.hs<-ep(mut9.aui.p.hs,a9.ui.p.hs)
david9.aui.p.hs<-DS(mat9.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.hs<-cbind(ordrank.9.aui.p.hs,ds=david9.aui.p.hs$normDS)
lm9.aui.p.hs<-summary(lm(ordrank.9.aui.p.hs$ds~ordrank.9.aui.p.hs$ord.rank))
s9.aui.p.hs<-lm9.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.hs<-data.frame(X1=avoid.ui.p.hs[[28]],X2=avoid.ui.p.hs[[29]],Avoids=avoid.ui.p.hs[[30]])
mat10.aui.p.hs<-avoid.inter.mat(mut10.aui.p.hs)
tri10.aui.p.hs<-tr.tri(mat10.aui.p.hs)
dci10.aui.p.hs<-DCindex(mat10.aui.p.hs)
mat10.aui.p.hs[is.na(mat10.aui.p.hs)] = 0
h10.aui.p.hs<-h.index(mat10.aui.p.hs)

ep10.aui.p.hs<-ep(mut10.aui.p.hs,a10.ui.p.hs)
david10.aui.p.hs<-DS(mat10.aui.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.hs<-cbind(ordrank.10.aui.p.hs,ds=david10.aui.p.hs$normDS)
lm10.aui.p.hs<-summary(lm(ordrank.10.aui.p.hs$ds~ordrank.10.aui.p.hs$ord.rank))
s10.aui.p.hs<-lm10.aui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.hs<-sum(mut1.aui.p.hs$Victories)
int2.aui.p.hs<-sum(mut2.aui.p.hs$Victories)
int3.aui.p.hs<-sum(mut3.aui.p.hs$Victories)
int4.aui.p.hs<-sum(mut4.aui.p.hs$Victories)
int5.aui.p.hs<-sum(mut5.aui.p.hs$Victories)
int6.aui.p.hs<-sum(mut6.aui.p.hs$Victories)
int7.aui.p.hs<-sum(mut7.aui.p.hs$Victories)
int8.aui.p.hs<-sum(mut8.aui.p.hs$Victories)
int9.aui.p.hs<-sum(mut9.aui.p.hs$Victories)
int10.aui.p.hs<-sum(mut10.aui.p.hs$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.hs<-sum(a1.ui.p.hs$Victories)
av2.aui.p.hs<-sum(a2.ui.p.hs$Victories)
av3.aui.p.hs<-sum(a3.ui.p.hs$Victories)
av4.aui.p.hs<-sum(a4.ui.p.hs$Victories)
av5.aui.p.hs<-sum(a5.ui.p.hs$Victories)
av6.aui.p.hs<-sum(a6.ui.p.hs$Victories)
av7.aui.p.hs<-sum(a7.ui.p.hs$Victories)
av8.aui.p.hs<-sum(a8.ui.p.hs$Victories)
av9.aui.p.hs<-sum(a9.ui.p.hs$Victories)
av10.aui.p.hs<-sum(a10.ui.p.hs$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hs.aiu.p<-(sum(av1.aui.p.hs, av2.aui.p.hs, av3.aui.p.hs, av4.aui.p.hs, av5.aui.p.hs, av6.aui.p.hs, av7.aui.p.hs, av8.aui.p.hs, av9.aui.p.hs, av10.aui.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.aiu.p<-(sum(int1.aui.p.hs, int2.aui.p.hs, int3.aui.p.hs, int4.aui.p.hs, int5.aui.p.hs, int6.aui.p.hs, int7.aui.p.hs, int8.aui.p.hs, int9.aui.p.hs, int10.aui.p.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.p.hs<-e1.aui.p.hs[order(e1.aui.p.hs$ID),]
e1.aui.p.hs<-as.matrix(t(e1.1.aui.p.hs))

e2.aui.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.p.hs<-e2.aui.p.hs[order(e2.aui.p.hs$ID),]
e2.aui.p.hs<-as.matrix(t(e2.1.aui.p.hs))

e3.aui.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.p.hs<-e3.aui.p.hs[order(e3.aui.p.hs$ID),]
e3.aui.p.hs<-as.matrix(t(e3.1.aui.p.hs))

e4.aui.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.p.hs<-e4.aui.p.hs[order(e4.aui.p.hs$ID),]
e4.aui.p.hs<-as.matrix(t(e4.1.aui.p.hs))

e5.aui.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.p.hs<-e5.aui.p.hs[order(e5.aui.p.hs$ID),]
e5.aui.p.hs<-as.matrix(t(e5.1.aui.p.hs))

e6.aui.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.p.hs<-e6.aui.p.hs[order(e6.aui.p.hs$ID),]
e6.aui.p.hs<-as.matrix(t(e6.1.aui.p.hs))

e7.aui.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.p.hs<-e7.aui.p.hs[order(e7.aui.p.hs$ID),]
e7.aui.p.hs<-as.matrix(t(e7.1.aui.p.hs))

e8.aui.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.p.hs<-e8.aui.p.hs[order(e8.aui.p.hs$ID),]
e8.aui.p.hs<-as.matrix(t(e8.1.aui.p.hs))

e9.aui.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.p.hs<-e9.aui.p.hs[order(e9.aui.p.hs$ID),]
e9.aui.p.hs<-as.matrix(t(e9.1.aui.p.hs))

e10.aui.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.p.hs<-e10.aui.p.hs[order(e10.aui.p.hs$ID),]
e10.aui.p.hs<-as.matrix(t(e10.1.aui.p.hs))

energy.hs.aui.p.hs<-as.data.frame(matrix(c(e1.aui.p.hs,e2.aui.p.hs,e3.aui.p.hs,e4.aui.p.hs,e5.aui.p.hs,e6.aui.p.hs,e7.aui.p.hs,e8.aui.p.hs,e9.aui.p.hs,e10.aui.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.aui.p.hs<-data.frame(ID=energy.hs.aui.p.hs$V1,energy_over_distance=energy.hs.aui.p.hs$V2,energy_over_time=energy.hs.aui.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.hs<-david1.aui.p.hs[order(david1.aui.p.hs$ID),]
david1.aui.p.hs<-as.matrix(t(david1.1.aui.p.hs))

david2.1.aui.p.hs<-david2.aui.p.hs[order(david2.aui.p.hs$ID),]
david2.aui.p.hs<-as.matrix(t(david2.1.aui.p.hs))

david3.1.aui.p.hs<-david3.aui.p.hs[order(david3.aui.p.hs$ID),]
david3.aui.p.hs<-as.matrix(t(david3.1.aui.p.hs))

david4.1.aui.p.hs<-david4.aui.p.hs[order(david4.aui.p.hs$ID),]
david4.aui.p.hs<-as.matrix(t(david4.1.aui.p.hs))

david5.1.aui.p.hs<-david5.aui.p.hs[order(david5.aui.p.hs$ID),]
david5.aui.p.hs<-as.matrix(t(david5.1.aui.p.hs))

david6.1.aui.p.hs<-david6.aui.p.hs[order(david6.aui.p.hs$ID),]
david6.aui.p.hs<-as.matrix(t(david6.1.aui.p.hs))

david7.1.aui.p.hs<-david7.aui.p.hs[order(david7.aui.p.hs$ID),]
david7.aui.p.hs<-as.matrix(t(david7.1.aui.p.hs))

david8.1.aui.p.hs<-david8.aui.p.hs[order(david8.aui.p.hs$ID),]
david8.aui.p.hs<-as.matrix(t(david8.1.aui.p.hs))

david9.1.aui.p.hs<-david9.aui.p.hs[order(david9.aui.p.hs$ID),]
david9.aui.p.hs<-as.matrix(t(david9.1.aui.p.hs))

david10.1.aui.p.hs<-david10.aui.p.hs[order(david10.aui.p.hs$ID),]
david10.aui.p.hs<-as.matrix(t(david10.1.aui.p.hs))

david.hs.aui.p.hs<-as.data.frame(matrix(c(david1.aui.p.hs,david2.aui.p.hs,david3.aui.p.hs,david4.aui.p.hs,david5.aui.p.hs,david6.aui.p.hs,david7.aui.p.hs,david8.aui.p.hs,david9.aui.p.hs,david10.aui.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.aui.p.hs<-data.frame(ID=david.hs.aui.p.hs$V1,DS=david.hs.aui.p.hs$V2,normDS=david.hs.aui.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.aui.p.hs<-lm(e1.1.aui.p.hs$energy_over_time~as.numeric(david1.1.aui.p.hs$normDS))
hs.lm.1.s.aui.p.hs<-summary(lm.hs.1.aui.p.hs)$coefficients
hs.1.slope.aui.p.hs<-hs.lm.1.s.aui.p.hs[2,1]
lm.hs.2.aui.p.hs<-lm(e2.1.aui.p.hs$energy_over_time~as.numeric(david2.1.aui.p.hs$normDS))
hs.lm.2.s.aui.p.hs<-summary(lm.hs.2.aui.p.hs)$coefficients
hs.2.slope.aui.p.hs<-hs.lm.2.s.aui.p.hs[2,1]
lm.hs.3.aui.p.hs<-lm(e3.1.aui.p.hs$energy_over_time~as.numeric(david3.1.aui.p.hs$normDS))
hs.lm.3.s.aui.p.hs<-summary(lm.hs.3.aui.p.hs)$coefficients
hs.3.slope.aui.p.hs<-hs.lm.3.s.aui.p.hs[2,1]
lm.hs.4.aui.p.hs<-lm(e4.1.aui.p.hs$energy_over_time~as.numeric(david4.1.aui.p.hs$normDS))
hs.lm.4.s.aui.p.hs<-summary(lm.hs.4.aui.p.hs)$coefficients
hs.4.slope.aui.p.hs<-hs.lm.4.s.aui.p.hs[2,1]
lm.hs.5.aui.p.hs<-lm(e5.1.aui.p.hs$energy_over_time~as.numeric(david5.1.aui.p.hs$normDS))
hs.lm.5.s.aui.p.hs<-summary(lm.hs.5.aui.p.hs)$coefficients
hs.5.slope.aui.p.hs<-hs.lm.5.s.aui.p.hs[2,1]
lm.hs.6.aui.p.hs<-lm(e6.1.aui.p.hs$energy_over_time~as.numeric(david6.1.aui.p.hs$normDS))
hs.lm.6.s.aui.p.hs<-summary(lm.hs.6.aui.p.hs)$coefficients
hs.6.slope.aui.p.hs<-hs.lm.6.s.aui.p.hs[2,1]
lm.hs.7.aui.p.hs<-lm(e7.1.aui.p.hs$energy_over_time~as.numeric(david7.1.aui.p.hs$normDS))
hs.lm.7.s.aui.p.hs<-summary(lm.hs.7.aui.p.hs)$coefficients
hs.7.slope.aui.p.hs<-hs.lm.7.s.aui.p.hs[2,1]
lm.hs.8.aui.p.hs<-lm(e8.1.aui.p.hs$energy_over_time~as.numeric(david8.1.aui.p.hs$normDS))
hs.lm.8.s.aui.p.hs<-summary(lm.hs.8.aui.p.hs)$coefficients
hs.8.slope.aui.p.hs<-hs.lm.8.s.aui.p.hs[2,1]
lm.hs.9.aui.p.hs<-lm(e9.1.aui.p.hs$energy_over_time~as.numeric(david9.1.aui.p.hs$normDS))
hs.lm.9.s.aui.p.hs<-summary(lm.hs.9.aui.p.hs)$coefficients
hs.9.slope.aui.p.hs<-hs.lm.9.s.aui.p.hs[2,1]
lm.hs.10.aui.p.hs<-lm(e10.1.aui.p.hs$energy_over_time~as.numeric(david10.1.aui.p.hs$normDS))
hs.lm.10.s.aui.p.hs<-summary(lm.hs.10.aui.p.hs)$coefficients
hs.10.slope.aui.p.hs<-hs.lm.10.s.aui.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.aui.p.ss.avoid.ui.p.hs<-data.frame(triangle.transitivity=c(tri1.aui.p.hs,tri2.aui.p.hs,tri3.aui.p.hs,tri4.aui.p.hs,tri5.aui.p.hs,tri6.aui.p.hs,tri7.aui.p.hs,tri8.aui.p.hs,tri9.aui.p.hs,tri10.aui.p.hs),escalation=c(ep1.aui.p.hs,ep2.aui.p.hs,ep3.aui.p.hs,ep4.aui.p.hs,ep5.aui.p.hs,ep6.aui.p.hs,ep7.aui.p.hs,ep8.aui.p.hs,ep9.aui.p.hs,ep10.aui.p.hs),dci=c(dci1.aui.p.hs,dci2.aui.p.hs,dci3.aui.p.hs,dci4.aui.p.hs,dci5.aui.p.hs,dci6.aui.p.hs,dci7.aui.p.hs,dci8.aui.p.hs,dci9.aui.p.hs,dci10.aui.p.hs),steepness=c(s1.aui.p.hs,s2.aui.p.hs,s3.aui.p.hs,s4.aui.p.hs,s5.aui.p.hs,s6.aui.p.hs,s7.aui.p.hs,s8.aui.p.hs,s9.aui.p.hs,s10.aui.p.hs),slope=c(hs.1.slope.aui.p.hs,hs.2.slope.aui.p.hs,hs.3.slope.aui.p.hs,hs.4.slope.aui.p.hs,hs.5.slope.aui.p.hs,hs.6.slope.aui.p.hs,hs.7.slope.aui.p.hs,hs.8.slope.aui.p.hs,hs.9.slope.aui.p.hs,hs.10.slope.aui.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)


# Generate avoid.ui.p.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[1]],X2=avoid.ui.p.ho[[2]],Avoids=avoid.ui.p.ho[[3]])
mat1.aui.p.ho<-avoid.inter.mat(mut1.aui.p.ho)
tri1.aui.p.ho<-tr.tri(mat1.aui.p.ho)
dci1.aui.p.ho<-DCindex(mat1.aui.p.ho)
mat1.aui.p.ho[is.na(mat1.aui.p.ho)] = 0
h1.aui.p.ho<-h.index(mat1.aui.p.ho)

ep1.aui.p.ho<-ep(mut1.aui.p.ho,a1.ui.p.ho)
david1.aui.p.ho<-DS(mat1.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.aui.p.ho<-cbind(ordrank.1.aui.p.ho,ds=david1.aui.p.ho$normDS)
lm1.aui.p.ho<-summary(lm(ordrank.1.aui.p.ho$ds~ordrank.1.aui.p.ho$ord.rank))
s1.aui.p.ho<-lm1.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[4]],X2=avoid.ui.p.ho[[5]],Avoids=avoid.ui.p.ho[[6]])
mat2.aui.p.ho<-avoid.inter.mat(mut2.aui.p.ho)
tri2.aui.p.ho<-tr.tri(mat2.aui.p.ho)
dci2.aui.p.ho<-DCindex(mat2.aui.p.ho)
mat2.aui.p.ho[is.na(mat2.aui.p.ho)] = 0
h2.aui.p.ho<-h.index(mat2.aui.p.ho)

ep2.aui.p.ho<-ep(mut2.aui.p.ho,a2.ui.p.ho)
david2.aui.p.ho<-DS(mat2.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.aui.p.ho<-cbind(ordrank.2.aui.p.ho,ds=david2.aui.p.ho$normDS)
lm2.aui.p.ho<-summary(lm(ordrank.2.aui.p.ho$ds~ordrank.2.aui.p.ho$ord.rank))
s2.aui.p.ho<-lm2.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[7]],X2=avoid.ui.p.ho[[8]],Avoids=avoid.ui.p.ho[[9]])
mat3.aui.p.ho<-avoid.inter.mat(mut3.aui.p.ho)
tri3.aui.p.ho<-tr.tri(mat3.aui.p.ho)
dci3.aui.p.ho<-DCindex(mat3.aui.p.ho)
mat3.aui.p.ho[is.na(mat3.aui.p.ho)] = 0
h3.aui.p.ho<-h.index(mat3.aui.p.ho)

ep3.aui.p.ho<-ep(mut3.aui.p.ho,a3.ui.p.ho)
david3.aui.p.ho<-DS(mat3.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.aui.p.ho<-cbind(ordrank.3.aui.p.ho,ds=david3.aui.p.ho$normDS)
lm3.aui.p.ho<-summary(lm(ordrank.3.aui.p.ho$ds~ordrank.3.aui.p.ho$ord.rank))
s3.aui.p.ho<-lm3.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[10]],X2=avoid.ui.p.ho[[11]],Avoids=avoid.ui.p.ho[[12]])
mat4.aui.p.ho<-avoid.inter.mat(mut4.aui.p.ho)
tri4.aui.p.ho<-tr.tri(mat4.aui.p.ho)
dci4.aui.p.ho<-DCindex(mat4.aui.p.ho)
mat4.aui.p.ho[is.na(mat4.aui.p.ho)] = 0
h4.aui.p.ho<-h.index(mat4.aui.p.ho)

ep4.aui.p.ho<-ep(mut4.aui.p.ho,a4.ui.p.ho)
david4.aui.p.ho<-DS(mat4.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.aui.p.ho<-cbind(ordrank.4.aui.p.ho,ds=david4.aui.p.ho$normDS)
lm4.aui.p.ho<-summary(lm(ordrank.4.aui.p.ho$ds~ordrank.4.aui.p.ho$ord.rank))
s4.aui.p.ho<-lm4.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[13]],X2=avoid.ui.p.ho[[14]],Avoids=avoid.ui.p.ho[[15]])
mat5.aui.p.ho<-avoid.inter.mat(mut5.aui.p.ho)
tri5.aui.p.ho<-tr.tri(mat5.aui.p.ho)
dci5.aui.p.ho<-DCindex(mat5.aui.p.ho)
mat5.aui.p.ho[is.na(mat5.aui.p.ho)] = 0
h5.aui.p.ho<-h.index(mat5.aui.p.ho)

ep5.aui.p.ho<-ep(mut5.aui.p.ho,a5.ui.p.ho)
david5.aui.p.ho<-DS(mat5.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.aui.p.ho<-cbind(ordrank.5.aui.p.ho,ds=david5.aui.p.ho$normDS)
lm5.aui.p.ho<-summary(lm(ordrank.5.aui.p.ho$ds~ordrank.5.aui.p.ho$ord.rank))
s5.aui.p.ho<-lm5.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[16]],X2=avoid.ui.p.ho[[17]],Avoids=avoid.ui.p.ho[[18]])
mat6.aui.p.ho<-avoid.inter.mat(mut6.aui.p.ho)
tri6.aui.p.ho<-tr.tri(mat6.aui.p.ho)
dci6.aui.p.ho<-DCindex(mat6.aui.p.ho)
mat6.aui.p.ho[is.na(mat6.aui.p.ho)] = 0
h6.aui.p.ho<-h.index(mat6.aui.p.ho)

ep6.aui.p.ho<-ep(mut6.aui.p.ho,a6.ui.p.ho)
david6.aui.p.ho<-DS(mat6.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.aui.p.ho<-cbind(ordrank.6.aui.p.ho,ds=david6.aui.p.ho$normDS)
lm6.aui.p.ho<-summary(lm(ordrank.6.aui.p.ho$ds~ordrank.6.aui.p.ho$ord.rank))
s6.aui.p.ho<-lm6.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[19]],X2=avoid.ui.p.ho[[20]],Avoids=avoid.ui.p.ho[[21]])
mat7.aui.p.ho<-avoid.inter.mat(mut7.aui.p.ho)
tri7.aui.p.ho<-tr.tri(mat7.aui.p.ho)
dci7.aui.p.ho<-DCindex(mat7.aui.p.ho)
mat7.aui.p.ho[is.na(mat7.aui.p.ho)] = 0
h7.aui.p.ho<-h.index(mat7.aui.p.ho)

ep7.aui.p.ho<-ep(mut7.aui.p.ho,a7.ui.p.ho)
david7.aui.p.ho<-DS(mat7.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.aui.p.ho<-cbind(ordrank.7.aui.p.ho,ds=david7.aui.p.ho$normDS)
lm7.aui.p.ho<-summary(lm(ordrank.7.aui.p.ho$ds~ordrank.7.aui.p.ho$ord.rank))
s7.aui.p.ho<-lm7.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[22]],X2=avoid.ui.p.ho[[23]],Avoids=avoid.ui.p.ho[[24]])
mat8.aui.p.ho<-avoid.inter.mat(mut8.aui.p.ho)
tri8.aui.p.ho<-tr.tri(mat8.aui.p.ho)
dci8.aui.p.ho<-DCindex(mat8.aui.p.ho)
mat8.aui.p.ho[is.na(mat8.aui.p.ho)] = 0
h8.aui.p.ho<-h.index(mat8.aui.p.ho)

ep8.aui.p.ho<-ep(mut8.aui.p.ho,a8.ui.p.ho)
david8.aui.p.ho<-DS(mat8.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.aui.p.ho<-cbind(ordrank.8.aui.p.ho,ds=david8.aui.p.ho$normDS)
lm8.aui.p.ho<-summary(lm(ordrank.8.aui.p.ho$ds~ordrank.8.aui.p.ho$ord.rank))
s8.aui.p.ho<-lm8.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[25]],X2=avoid.ui.p.ho[[26]],Avoids=avoid.ui.p.ho[[27]])
mat9.aui.p.ho<-avoid.inter.mat(mut9.aui.p.ho)
tri9.aui.p.ho<-tr.tri(mat9.aui.p.ho)
dci9.aui.p.ho<-DCindex(mat9.aui.p.ho)
mat9.aui.p.ho[is.na(mat9.aui.p.ho)] = 0
h9.aui.p.ho<-h.index(mat9.aui.p.ho)

ep9.aui.p.ho<-ep(mut9.aui.p.ho,a9.ui.p.ho)
david9.aui.p.ho<-DS(mat9.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.aui.p.ho<-cbind(ordrank.9.aui.p.ho,ds=david9.aui.p.ho$normDS)
lm9.aui.p.ho<-summary(lm(ordrank.9.aui.p.ho$ds~ordrank.9.aui.p.ho$ord.rank))
s9.aui.p.ho<-lm9.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.aui.p.ho<-data.frame(X1=avoid.ui.p.ho[[28]],X2=avoid.ui.p.ho[[29]],Avoids=avoid.ui.p.ho[[30]])
mat10.aui.p.ho<-avoid.inter.mat(mut10.aui.p.ho)
tri10.aui.p.ho<-tr.tri(mat10.aui.p.ho)
dci10.aui.p.ho<-DCindex(mat10.aui.p.ho)
mat10.aui.p.ho[is.na(mat10.aui.p.ho)] = 0
h10.aui.p.ho<-h.index(mat10.aui.p.ho)

ep10.aui.p.ho<-ep(mut10.aui.p.ho,a10.ui.p.ho)
david10.aui.p.ho<-DS(mat10.aui.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.aui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.aui.p.ho<-cbind(ordrank.10.aui.p.ho,ds=david10.aui.p.ho$normDS)
lm10.aui.p.ho<-summary(lm(ordrank.10.aui.p.ho$ds~ordrank.10.aui.p.ho$ord.rank))
s10.aui.p.ho<-lm10.aui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.aui.p.ho<-sum(mut1.aui.p.ho$Victories)
int2.aui.p.ho<-sum(mut2.aui.p.ho$Victories)
int3.aui.p.ho<-sum(mut3.aui.p.ho$Victories)
int4.aui.p.ho<-sum(mut4.aui.p.ho$Victories)
int5.aui.p.ho<-sum(mut5.aui.p.ho$Victories)
int6.aui.p.ho<-sum(mut6.aui.p.ho$Victories)
int7.aui.p.ho<-sum(mut7.aui.p.ho$Victories)
int8.aui.p.ho<-sum(mut8.aui.p.ho$Victories)
int9.aui.p.ho<-sum(mut9.aui.p.ho$Victories)
int10.aui.p.ho<-sum(mut10.aui.p.ho$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.aui.p.ho<-sum(a1.ui.p.ho$Victories)
av2.aui.p.ho<-sum(a2.ui.p.ho$Victories)
av3.aui.p.ho<-sum(a3.ui.p.ho$Victories)
av4.aui.p.ho<-sum(a4.ui.p.ho$Victories)
av5.aui.p.ho<-sum(a5.ui.p.ho$Victories)
av6.aui.p.ho<-sum(a6.ui.p.ho$Victories)
av7.aui.p.ho<-sum(a7.ui.p.ho$Victories)
av8.aui.p.ho<-sum(a8.ui.p.ho$Victories)
av9.aui.p.ho<-sum(a9.ui.p.ho$Victories)
av10.aui.p.ho<-sum(a10.ui.p.ho$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.ho.aiu.p<-(sum(av1.aui.p.ho, av2.aui.p.ho, av3.aui.p.ho, av4.aui.p.ho, av5.aui.p.ho, av6.aui.p.ho, av7.aui.p.ho, av8.aui.p.ho, av9.aui.p.ho, av10.aui.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.aiu.p<-(sum(int1.aui.p.ho, int2.aui.p.ho, int3.aui.p.ho, int4.aui.p.ho, int5.aui.p.ho, int6.aui.p.ho, int7.aui.p.ho, int8.aui.p.ho, int9.aui.p.ho, int10.aui.p.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.aui.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.aui.p.ho<-e1.aui.p.ho[order(e1.aui.p.ho$ID),]
e1.aui.p.ho<-as.matrix(t(e1.1.aui.p.ho))

e2.aui.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.aui.p.ho<-e2.aui.p.ho[order(e2.aui.p.ho$ID),]
e2.aui.p.ho<-as.matrix(t(e2.1.aui.p.ho))

e3.aui.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.aui.p.ho<-e3.aui.p.ho[order(e3.aui.p.ho$ID),]
e3.aui.p.ho<-as.matrix(t(e3.1.aui.p.ho))

e4.aui.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.aui.p.ho<-e4.aui.p.ho[order(e4.aui.p.ho$ID),]
e4.aui.p.ho<-as.matrix(t(e4.1.aui.p.ho))

e5.aui.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.aui.p.ho<-e5.aui.p.ho[order(e5.aui.p.ho$ID),]
e5.aui.p.ho<-as.matrix(t(e5.1.aui.p.ho))

e6.aui.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.aui.p.ho<-e6.aui.p.ho[order(e6.aui.p.ho$ID),]
e6.aui.p.ho<-as.matrix(t(e6.1.aui.p.ho))

e7.aui.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.aui.p.ho<-e7.aui.p.ho[order(e7.aui.p.ho$ID),]
e7.aui.p.ho<-as.matrix(t(e7.1.aui.p.ho))

e8.aui.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.aui.p.ho<-e8.aui.p.ho[order(e8.aui.p.ho$ID),]
e8.aui.p.ho<-as.matrix(t(e8.1.aui.p.ho))

e9.aui.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.aui.p.ho<-e9.aui.p.ho[order(e9.aui.p.ho$ID),]
e9.aui.p.ho<-as.matrix(t(e9.1.aui.p.ho))

e10.aui.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.aui.p.ho<-e10.aui.p.ho[order(e10.aui.p.ho$ID),]
e10.aui.p.ho<-as.matrix(t(e10.1.aui.p.ho))

energy.ho.aui.p.ho<-as.data.frame(matrix(c(e1.aui.p.ho,e2.aui.p.ho,e3.aui.p.ho,e4.aui.p.ho,e5.aui.p.ho,e6.aui.p.ho,e7.aui.p.ho,e8.aui.p.ho,e9.aui.p.ho,e10.aui.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.aui.p.ho<-data.frame(ID=energy.ho.aui.p.ho$V1,energy_over_distance=energy.ho.aui.p.ho$V2,energy_over_time=energy.ho.aui.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.aui.p.ho<-david1.aui.p.ho[order(david1.aui.p.ho$ID),]
david1.aui.p.ho<-as.matrix(t(david1.1.aui.p.ho))

david2.1.aui.p.ho<-david2.aui.p.ho[order(david2.aui.p.ho$ID),]
david2.aui.p.ho<-as.matrix(t(david2.1.aui.p.ho))

david3.1.aui.p.ho<-david3.aui.p.ho[order(david3.aui.p.ho$ID),]
david3.aui.p.ho<-as.matrix(t(david3.1.aui.p.ho))

david4.1.aui.p.ho<-david4.aui.p.ho[order(david4.aui.p.ho$ID),]
david4.aui.p.ho<-as.matrix(t(david4.1.aui.p.ho))

david5.1.aui.p.ho<-david5.aui.p.ho[order(david5.aui.p.ho$ID),]
david5.aui.p.ho<-as.matrix(t(david5.1.aui.p.ho))

david6.1.aui.p.ho<-david6.aui.p.ho[order(david6.aui.p.ho$ID),]
david6.aui.p.ho<-as.matrix(t(david6.1.aui.p.ho))

david7.1.aui.p.ho<-david7.aui.p.ho[order(david7.aui.p.ho$ID),]
david7.aui.p.ho<-as.matrix(t(david7.1.aui.p.ho))

david8.1.aui.p.ho<-david8.aui.p.ho[order(david8.aui.p.ho$ID),]
david8.aui.p.ho<-as.matrix(t(david8.1.aui.p.ho))

david9.1.aui.p.ho<-david9.aui.p.ho[order(david9.aui.p.ho$ID),]
david9.aui.p.ho<-as.matrix(t(david9.1.aui.p.ho))

david10.1.aui.p.ho<-david10.aui.p.ho[order(david10.aui.p.ho$ID),]
david10.aui.p.ho<-as.matrix(t(david10.1.aui.p.ho))

david.ho.aui.p.ho<-as.data.frame(matrix(c(david1.aui.p.ho,david2.aui.p.ho,david3.aui.p.ho,david4.aui.p.ho,david5.aui.p.ho,david6.aui.p.ho,david7.aui.p.ho,david8.aui.p.ho,david9.aui.p.ho,david10.aui.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.aui.p.ho<-data.frame(ID=david.ho.aui.p.ho$V1,DS=david.ho.aui.p.ho$V2,normDS=david.ho.aui.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.aui.p.ho<-lm(e1.1.aui.p.ho$energy_over_time~as.numeric(david1.1.aui.p.ho$normDS))
ho.lm.1.s.aui.p.ho<-summary(lm.ho.1.aui.p.ho)$coefficients
ho.1.slope.aui.p.ho<-ho.lm.1.s.aui.p.ho[2,1]
lm.ho.2.aui.p.ho<-lm(e2.1.aui.p.ho$energy_over_time~as.numeric(david2.1.aui.p.ho$normDS))
ho.lm.2.s.aui.p.ho<-summary(lm.ho.2.aui.p.ho)$coefficients
ho.2.slope.aui.p.ho<-ho.lm.2.s.aui.p.ho[2,1]
lm.ho.3.aui.p.ho<-lm(e3.1.aui.p.ho$energy_over_time~as.numeric(david3.1.aui.p.ho$normDS))
ho.lm.3.s.aui.p.ho<-summary(lm.ho.3.aui.p.ho)$coefficients
ho.3.slope.aui.p.ho<-ho.lm.3.s.aui.p.ho[2,1]
lm.ho.4.aui.p.ho<-lm(e4.1.aui.p.ho$energy_over_time~as.numeric(david4.1.aui.p.ho$normDS))
ho.lm.4.s.aui.p.ho<-summary(lm.ho.4.aui.p.ho)$coefficients
ho.4.slope.aui.p.ho<-ho.lm.4.s.aui.p.ho[2,1]
lm.ho.5.aui.p.ho<-lm(e5.1.aui.p.ho$energy_over_time~as.numeric(david5.1.aui.p.ho$normDS))
ho.lm.5.s.aui.p.ho<-summary(lm.ho.5.aui.p.ho)$coefficients
ho.5.slope.aui.p.ho<-ho.lm.5.s.aui.p.ho[2,1]
lm.ho.6.aui.p.ho<-lm(e6.1.aui.p.ho$energy_over_time~as.numeric(david6.1.aui.p.ho$normDS))
ho.lm.6.s.aui.p.ho<-summary(lm.ho.6.aui.p.ho)$coefficients
ho.6.slope.aui.p.ho<-ho.lm.6.s.aui.p.ho[2,1]
lm.ho.7.aui.p.ho<-lm(e7.1.aui.p.ho$energy_over_time~as.numeric(david7.1.aui.p.ho$normDS))
ho.lm.7.s.aui.p.ho<-summary(lm.ho.7.aui.p.ho)$coefficients
ho.7.slope.aui.p.ho<-ho.lm.7.s.aui.p.ho[2,1]
lm.ho.8.aui.p.ho<-lm(e8.1.aui.p.ho$energy_over_time~as.numeric(david8.1.aui.p.ho$normDS))
ho.lm.8.s.aui.p.ho<-summary(lm.ho.8.aui.p.ho)$coefficients
ho.8.slope.aui.p.ho<-ho.lm.8.s.aui.p.ho[2,1]
lm.ho.9.aui.p.ho<-lm(e9.1.aui.p.ho$energy_over_time~as.numeric(david9.1.aui.p.ho$normDS))
ho.lm.9.s.aui.p.ho<-summary(lm.ho.9.aui.p.ho)$coefficients
ho.9.slope.aui.p.ho<-ho.lm.9.s.aui.p.ho[2,1]
lm.ho.10.aui.p.ho<-lm(e10.1.aui.p.ho$energy_over_time~as.numeric(david10.1.aui.p.ho$normDS))
ho.lm.10.s.aui.p.ho<-summary(lm.ho.10.aui.p.ho)$coefficients
ho.10.slope.aui.p.ho<-ho.lm.10.s.aui.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.aui.p.ss.avoid.ui.p.ho<-data.frame(triangle.transitivity=c(tri1.aui.p.ho,tri2.aui.p.ho,tri3.aui.p.ho,tri4.aui.p.ho,tri5.aui.p.ho,tri6.aui.p.ho,tri7.aui.p.ho,tri8.aui.p.ho,tri9.aui.p.ho,tri10.aui.p.ho),escalation=c(ep1.aui.p.ho,ep2.aui.p.ho,ep3.aui.p.ho,ep4.aui.p.ho,ep5.aui.p.ho,ep6.aui.p.ho,ep7.aui.p.ho,ep8.aui.p.ho,ep9.aui.p.ho,ep10.aui.p.ho),dci=c(dci1.aui.p.ho,dci2.aui.p.ho,dci3.aui.p.ho,dci4.aui.p.ho,dci5.aui.p.ho,dci6.aui.p.ho,dci7.aui.p.ho,dci8.aui.p.ho,dci9.aui.p.ho,dci10.aui.p.ho),steepness=c(s1.aui.p.ho,s2.aui.p.ho,s3.aui.p.ho,s4.aui.p.ho,s5.aui.p.ho,s6.aui.p.ho,s7.aui.p.ho,s8.aui.p.ho,s9.aui.p.ho,s10.aui.p.ho),slope=c(ho.1.slope.aui.p.ho,ho.2.slope.aui.p.ho,ho.3.slope.aui.p.ho,ho.4.slope.aui.p.ho,ho.5.slope.aui.p.ho,ho.6.slope.aui.p.ho,ho.7.slope.aui.p.ho,ho.8.slope.aui.p.ho,ho.9.slope.aui.p.ho,ho.10.slope.aui.p.ho))
```
```{r Avoids Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$triangle.transitivity)
km.aiu.pi.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$dci)
km.esc.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$escalation)
km.steep.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$steepness)
km.slope.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$slope)
km.mean.aiu.p.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aiu.p.avoid,dci=km.aiu.pi.aiu.p.avoid,esc=km.esc.aiu.p.avoid,steepness=km.steep.aiu.p.avoid,slope=km.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$triangle.transitivity)
ks.aiu.pi.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$dci)
ks.esc.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$escalation)
ks.steep.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$steepness)
ks.slope.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$slope)
ks.mean.aiu.p.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.aiu.p.avoid,dci=ks.aiu.pi.aiu.p.avoid,esc=ks.esc.aiu.p.avoid,steepness=ks.steep.aiu.p.avoid,slope=ks.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$triangle.transitivity)
ko.aiu.pi.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$dci)
ko.esc.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$escalation)
ko.steep.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$steepness)
ko.slope.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$slope)
ko.mean.aiu.p.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.aiu.p.avoid,dci=ko.aiu.pi.aiu.p.avoid,esc=ko.esc.aiu.p.avoid,steepness=ko.steep.aiu.p.avoid,slope=ko.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$triangle.transitivity)
hm.aiu.pi.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$dci)
hm.esc.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$escalation)
hm.steep.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$steepness)
hm.slope.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$slope)
hm.mean.aiu.p.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aiu.p.avoid,dci=hm.aiu.pi.aiu.p.avoid,esc=hm.esc.aiu.p.avoid,steepness=hm.steep.aiu.p.avoid,slope=hm.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$triangle.transitivity)
hs.aiu.pi.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$dci)
hs.esc.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$escalation)
hs.steep.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$steepness)
hs.slope.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$slope)
hs.mean.aiu.p.avoid<-data.frame(scenario="History self",tt=hs.tt.aiu.p.avoid,dci=hs.aiu.pi.aiu.p.avoid,esc=hs.esc.aiu.p.avoid,steepness=hs.steep.aiu.p.avoid,slope=hs.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$triangle.transitivity)
ho.aiu.pi.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$dci)
ho.esc.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$escalation)
ho.steep.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$steepness)
ho.slope.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$slope)
ho.mean.aiu.p.avoid<-data.frame(scenario="History opponent",tt=ho.tt.aiu.p.avoid,dci=ho.aiu.pi.aiu.p.avoid,esc=ho.esc.aiu.p.avoid,steepness=ho.steep.aiu.p.avoid,slope=ho.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.aiu.p.avoid,ks.mean.aiu.p.avoid,ko.mean.aiu.p.avoid,hm.mean.aiu.p.avoid,hs.mean.aiu.p.avoid,ho.mean.aiu.p.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$triangle.transitivity)
km.aiu.pi.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$dci)
km.esc.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$escalation)
km.steep.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$steepness)
km.slope.aiu.p.avoid<-mean(km.aui.p.ss.avoid.ui.p.km$slope)
km.mean.aiu.p.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.aiu.p.avoid,dci=km.aiu.pi.aiu.p.avoid,esc=km.esc.aiu.p.avoid,steepness=km.steep.aiu.p.avoid,slope=km.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$triangle.transitivity)
ks.aiu.pi.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$dci)
ks.esc.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$escalation)
ks.steep.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$steepness)
ks.slope.aiu.p.avoid<-mean(ks.aui.p.ss.avoid.ui.p.ks$slope)
ks.mean.aiu.p.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.aiu.p.avoid,dci=ks.aiu.pi.aiu.p.avoid,esc=ks.esc.aiu.p.avoid,steepness=ks.steep.aiu.p.avoid,slope=ks.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$triangle.transitivity)
ko.aiu.pi.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$dci)
ko.esc.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$escalation)
ko.steep.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$steepness)
ko.slope.aiu.p.avoid<-mean(ko.aui.p.ss.avoid.ui.p.ko$slope)
ko.mean.aiu.p.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.aiu.p.avoid,dci=ko.aiu.pi.aiu.p.avoid,esc=ko.esc.aiu.p.avoid,steepness=ko.steep.aiu.p.avoid,slope=ko.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$triangle.transitivity)
hm.aiu.pi.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$dci)
hm.esc.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$escalation)
hm.steep.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$steepness)
hm.slope.aiu.p.avoid<-mean(hm.aui.p.ss.avoid.ui.p.hm$slope)
hm.mean.aiu.p.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.aiu.p.avoid,dci=hm.aiu.pi.aiu.p.avoid,esc=hm.esc.aiu.p.avoid,steepness=hm.steep.aiu.p.avoid,slope=hm.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$triangle.transitivity)
hs.aiu.pi.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$dci)
hs.esc.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$escalation)
hs.steep.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$steepness)
hs.slope.aiu.p.avoid<-mean(hs.aui.p.ss.avoid.ui.p.hs$slope)
hs.mean.aiu.p.avoid<-data.frame(scenario="History self",tt=hs.tt.aiu.p.avoid,dci=hs.aiu.pi.aiu.p.avoid,esc=hs.esc.aiu.p.avoid,steepness=hs.steep.aiu.p.avoid,slope=hs.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$triangle.transitivity)
ho.aiu.pi.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$dci)
ho.esc.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$escalation)
ho.steep.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$steepness)
ho.slope.aiu.p.avoid<-mean(ho.aui.p.ss.avoid.ui.p.ho$slope)
ho.mean.aiu.p.avoid<-data.frame(scenario="History opponent",tt=ho.tt.aiu.p.avoid,dci=ho.aiu.pi.aiu.p.avoid,esc=ho.esc.aiu.p.avoid,steepness=ho.steep.aiu.p.avoid,slope=ho.slope.aiu.p.avoid,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.aiu.p.avoid,ks.mean.aiu.p.avoid,ko.mean.aiu.p.avoid,hm.mean.aiu.p.avoid,hs.mean.aiu.p.avoid,ho.mean.aiu.p.avoid)

#create overall dataframe of summary statistics
overall.unif.avoid.initiator<-data.frame(km.aui.p.ss.avoid.ui.p.km)
overall.unif.avoid.initiator<-rbind(overall.unif.avoid.initiator,ks.aui.p.ss.avoid.ui.p.ks)
overall.unif.avoid.initiator<-rbind(overall.unif.avoid.initiator,ko.aui.p.ss.avoid.ui.p.ko)
overall.unif.avoid.initiator<-rbind(overall.unif.avoid.initiator,hm.aui.p.ss.avoid.ui.p.hm)
overall.unif.avoid.initiator<-rbind(overall.unif.avoid.initiator,hs.aui.p.ss.avoid.ui.p.hs)
overall.unif.avoid.initiator<-rbind(overall.unif.avoid.initiator,ho.aui.p.ss.avoid.ui.p.ho)

overall.unif.avoid.initiator<-cbind(overall.unif.avoid.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.avoid.initiator<-cbind(overall.unif.avoid.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.ss.avoid.ui.p<-overall.unif.avoid.initiator[overall.unif.avoid.initiator$variable=="rhp",]
history.ss.avoid.ui.p<-overall.unif.avoid.initiator[overall.unif.avoid.initiator$variable=="history",]

overall.unif.avoid.initiator$combo<-paste(overall.unif.avoid.initiator$strategy,overall.unif.avoid.initiator$variable,overall.unif.avoid.initiator$distribution)
overall.unif.avoid.initiator$combo2<-paste(overall.unif.avoid.initiator$strategy,overall.unif.avoid.initiator$variable)
```

## Attacks Uniform Initiator Wins Probabilistic Data
```{r Attacks Uniform Probabilistic}
# Each of the following data organization sections are organized by the What variable (Knowledge or History), the Who variable (Mutual, Self, Opponent), and the distribution variable (Uniform or Uniform)

#-------------------------------------------------------------------------------------------------------------------------

#knowledge Mutual Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.p.km<-sapply(files, read.csv)

# Generate attacks.atui.p.km Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
mut1.atui.p.km<-data.frame(X1=attacks.atui.p.km[[1]],X2=attacks.atui.p.km[[2]],Victories=attacks.atui.p.km[[3]])
mat1.atui.p.km<-inter.mat(mut1.atui.p.km)
tri1.atui.p.km<-tr.tri(mat1.atui.p.km)
dci1.atui.p.km<-DCindex(mat1.atui.p.km)
mat1.atui.p.km[is.na(mat1.atui.p.km)] = 0
h1.atui.p.km<-h.index(mat1.atui.p.km)

ep1.atui.p.km<-ep(mut1.atui.p.km,a1.ui.p.km)
david1.atui.p.km<-DS(mat1.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.km<-cbind(ordrank.1.atui.p.km,ds=david1.atui.p.km$normDS)
lm1.atui.p.km<-summary(lm(ordrank.1.atui.p.km$ds~ordrank.1.atui.p.km$ord.rank))
s1.atui.p.km<-lm1.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.km<-data.frame(X1=attacks.atui.p.km[[4]],X2=attacks.atui.p.km[[5]],Victories=attacks.atui.p.km[[6]])
mat2.atui.p.km<-inter.mat(mut2.atui.p.km)
tri2.atui.p.km<-tr.tri(mat2.atui.p.km)
dci2.atui.p.km<-DCindex(mat2.atui.p.km)
mat2.atui.p.km[is.na(mat2.atui.p.km)] = 0
h2.atui.p.km<-h.index(mat2.atui.p.km)

ep2.atui.p.km<-ep(mut2.atui.p.km,a2.ui.p.km)
david2.atui.p.km<-DS(mat2.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.km<-cbind(ordrank.2.atui.p.km,ds=david2.atui.p.km$normDS)
lm2.atui.p.km<-summary(lm(ordrank.2.atui.p.km$ds~ordrank.2.atui.p.km$ord.rank))
s2.atui.p.km<-lm2.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.km<-data.frame(X1=attacks.atui.p.km[[7]],X2=attacks.atui.p.km[[8]],Victories=attacks.atui.p.km[[9]])
mat3.atui.p.km<-inter.mat(mut3.atui.p.km)
tri3.atui.p.km<-tr.tri(mat3.atui.p.km)
dci3.atui.p.km<-DCindex(mat3.atui.p.km)
mat3.atui.p.km[is.na(mat3.atui.p.km)] = 0
h3.atui.p.km<-h.index(mat3.atui.p.km)

ep3.atui.p.km<-ep(mut3.atui.p.km,a3.ui.p.km)
david3.atui.p.km<-DS(mat3.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.km<-cbind(ordrank.3.atui.p.km,ds=david3.atui.p.km$normDS)
lm3.atui.p.km<-summary(lm(ordrank.3.atui.p.km$ds~ordrank.3.atui.p.km$ord.rank))
s3.atui.p.km<-lm3.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.km<-data.frame(X1=attacks.atui.p.km[[10]],X2=attacks.atui.p.km[[11]],Victories=attacks.atui.p.km[[12]])
mat4.atui.p.km<-inter.mat(mut4.atui.p.km)
tri4.atui.p.km<-tr.tri(mat4.atui.p.km)
dci4.atui.p.km<-DCindex(mat4.atui.p.km)
mat4.atui.p.km[is.na(mat4.atui.p.km)] = 0
h4.atui.p.km<-h.index(mat4.atui.p.km)

ep4.atui.p.km<-ep(mut4.atui.p.km,a4.ui.p.km)
david4.atui.p.km<-DS(mat4.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.km<-cbind(ordrank.4.atui.p.km,ds=david4.atui.p.km$normDS)
lm4.atui.p.km<-summary(lm(ordrank.4.atui.p.km$ds~ordrank.4.atui.p.km$ord.rank))
s4.atui.p.km<-lm4.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.km<-data.frame(X1=attacks.atui.p.km[[13]],X2=attacks.atui.p.km[[14]],Victories=attacks.atui.p.km[[15]])
mat5.atui.p.km<-inter.mat(mut5.atui.p.km)
tri5.atui.p.km<-tr.tri(mat5.atui.p.km)
dci5.atui.p.km<-DCindex(mat5.atui.p.km)
mat5.atui.p.km[is.na(mat5.atui.p.km)] = 0
h5.atui.p.km<-h.index(mat5.atui.p.km)

ep5.atui.p.km<-ep(mut5.atui.p.km,a5.ui.p.km)
david5.atui.p.km<-DS(mat5.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.km<-cbind(ordrank.5.atui.p.km,ds=david5.atui.p.km$normDS)
lm5.atui.p.km<-summary(lm(ordrank.5.atui.p.km$ds~ordrank.5.atui.p.km$ord.rank))
s5.atui.p.km<-lm5.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.km<-data.frame(X1=attacks.atui.p.km[[16]],X2=attacks.atui.p.km[[17]],Victories=attacks.atui.p.km[[18]])
mat6.atui.p.km<-inter.mat(mut6.atui.p.km)
tri6.atui.p.km<-tr.tri(mat6.atui.p.km)
dci6.atui.p.km<-DCindex(mat6.atui.p.km)
mat6.atui.p.km[is.na(mat6.atui.p.km)] = 0
h6.atui.p.km<-h.index(mat6.atui.p.km)

ep6.atui.p.km<-ep(mut6.atui.p.km,a6.ui.p.km)
david6.atui.p.km<-DS(mat6.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.km<-cbind(ordrank.6.atui.p.km,ds=david6.atui.p.km$normDS)
lm6.atui.p.km<-summary(lm(ordrank.6.atui.p.km$ds~ordrank.6.atui.p.km$ord.rank))
s6.atui.p.km<-lm6.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.km<-data.frame(X1=attacks.atui.p.km[[19]],X2=attacks.atui.p.km[[20]],Victories=attacks.atui.p.km[[21]])
mat7.atui.p.km<-inter.mat(mut7.atui.p.km)
tri7.atui.p.km<-tr.tri(mat7.atui.p.km)
dci7.atui.p.km<-DCindex(mat7.atui.p.km)
mat7.atui.p.km[is.na(mat7.atui.p.km)] = 0
h7.atui.p.km<-h.index(mat7.atui.p.km)

ep7.atui.p.km<-ep(mut7.atui.p.km,a7.ui.p.km)
david7.atui.p.km<-DS(mat7.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.km<-cbind(ordrank.7.atui.p.km,ds=david7.atui.p.km$normDS)
lm7.atui.p.km<-summary(lm(ordrank.7.atui.p.km$ds~ordrank.7.atui.p.km$ord.rank))
s7.atui.p.km<-lm7.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.km<-data.frame(X1=attacks.atui.p.km[[22]],X2=attacks.atui.p.km[[23]],Victories=attacks.atui.p.km[[24]])
mat8.atui.p.km<-inter.mat(mut8.atui.p.km)
tri8.atui.p.km<-tr.tri(mat8.atui.p.km)
dci8.atui.p.km<-DCindex(mat8.atui.p.km)
mat8.atui.p.km[is.na(mat8.atui.p.km)] = 0
h8.atui.p.km<-h.index(mat8.atui.p.km)

ep8.atui.p.km<-ep(mut8.atui.p.km,a8.ui.p.km)
david8.atui.p.km<-DS(mat8.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.km<-cbind(ordrank.8.atui.p.km,ds=david8.atui.p.km$normDS)
lm8.atui.p.km<-summary(lm(ordrank.8.atui.p.km$ds~ordrank.8.atui.p.km$ord.rank))
s8.atui.p.km<-lm8.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.km<-data.frame(X1=attacks.atui.p.km[[25]],X2=attacks.atui.p.km[[26]],Victories=attacks.atui.p.km[[27]])
mat9.atui.p.km<-inter.mat(mut9.atui.p.km)
tri9.atui.p.km<-tr.tri(mat9.atui.p.km)
dci9.atui.p.km<-DCindex(mat9.atui.p.km)
mat9.atui.p.km[is.na(mat9.atui.p.km)] = 0
h9.atui.p.km<-h.index(mat9.atui.p.km)

ep9.atui.p.km<-ep(mut9.atui.p.km,a9.ui.p.km)
david9.atui.p.km<-DS(mat9.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.km<-cbind(ordrank.9.atui.p.km,ds=david9.atui.p.km$normDS)
lm9.atui.p.km<-summary(lm(ordrank.9.atui.p.km$ds~ordrank.9.atui.p.km$ord.rank))
s9.atui.p.km<-lm9.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.km<-data.frame(X1=attacks.atui.p.km[[28]],X2=attacks.atui.p.km[[29]],Victories=attacks.atui.p.km[[30]])
mat10.atui.p.km<-inter.mat(mut10.atui.p.km)
tri10.atui.p.km<-tr.tri(mat10.atui.p.km)
dci10.atui.p.km<-DCindex(mat10.atui.p.km)
mat10.atui.p.km[is.na(mat10.atui.p.km)] = 0
h10.atui.p.km<-h.index(mat10.atui.p.km)

ep10.atui.p.km<-ep(mut10.atui.p.km,a10.ui.p.km)
david10.atui.p.km<-DS(mat10.atui.p.km) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.km<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.km<-cbind(ordrank.10.atui.p.km,ds=david10.atui.p.km$normDS)
lm10.atui.p.km<-summary(lm(ordrank.10.atui.p.km$ds~ordrank.10.atui.p.km$ord.rank))
s10.atui.p.km<-lm10.atui.p.km$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.km<-sum(mut1.atui.p.km$Victories)
int2.atui.p.km<-sum(mut2.atui.p.km$Victories)
int3.atui.p.km<-sum(mut3.atui.p.km$Victories)
int4.atui.p.km<-sum(mut4.atui.p.km$Victories)
int5.atui.p.km<-sum(mut5.atui.p.km$Victories)
int6.atui.p.km<-sum(mut6.atui.p.km$Victories)
int7.atui.p.km<-sum(mut7.atui.p.km$Victories)
int8.atui.p.km<-sum(mut8.atui.p.km$Victories)
int9.atui.p.km<-sum(mut9.atui.p.km$Victories)
int10.atui.p.km<-sum(mut10.atui.p.km$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.km<-sum(a1.ui.p.km$Victories)
av2.atui.p.km<-sum(a2.ui.p.km$Victories)
av3.atui.p.km<-sum(a3.ui.p.km$Victories)
av4.atui.p.km<-sum(a4.ui.p.km$Victories)
av5.atui.p.km<-sum(a5.ui.p.km$Victories)
av6.atui.p.km<-sum(a6.ui.p.km$Victories)
av7.atui.p.km<-sum(a7.ui.p.km$Victories)
av8.atui.p.km<-sum(a8.ui.p.km$Victories)
av9.atui.p.km<-sum(a9.ui.p.km$Victories)
av10.atui.p.km<-sum(a10.ui.p.km$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.km.atiu.p<-(sum(av1.atui.p.km, av2.atui.p.km, av3.atui.p.km, av4.atui.p.km, av5.atui.p.km, av6.atui.p.km, av7.atui.p.km, av8.atui.p.km, av9.atui.p.km, av10.atui.p.km))/10

  # Calculate the average number of victories across trials:
avg.int.km.atiu.p<-(sum(int1.atui.p.km, int2.atui.p.km, int3.atui.p.km, int4.atui.p.km, int5.atui.p.km, int6.atui.p.km, int7.atui.p.km, int8.atui.p.km, int9.atui.p.km, int10.atui.p.km))/10

# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/km.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.km<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.p.km<-e1.atui.p.km[order(e1.atui.p.km$ID),]
e1.atui.p.km<-as.matrix(t(e1.1.atui.p.km))

e2.atui.p.km<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.p.km<-e2.atui.p.km[order(e2.atui.p.km$ID),]
e2.atui.p.km<-as.matrix(t(e2.1.atui.p.km))

e3.atui.p.km<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.p.km<-e3.atui.p.km[order(e3.atui.p.km$ID),]
e3.atui.p.km<-as.matrix(t(e3.1.atui.p.km))

e4.atui.p.km<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.p.km<-e4.atui.p.km[order(e4.atui.p.km$ID),]
e4.atui.p.km<-as.matrix(t(e4.1.atui.p.km))

e5.atui.p.km<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.p.km<-e5.atui.p.km[order(e5.atui.p.km$ID),]
e5.atui.p.km<-as.matrix(t(e5.1.atui.p.km))

e6.atui.p.km<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.p.km<-e6.atui.p.km[order(e6.atui.p.km$ID),]
e6.atui.p.km<-as.matrix(t(e6.1.atui.p.km))

e7.atui.p.km<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.p.km<-e7.atui.p.km[order(e7.atui.p.km$ID),]
e7.atui.p.km<-as.matrix(t(e7.1.atui.p.km))

e8.atui.p.km<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.p.km<-e8.atui.p.km[order(e8.atui.p.km$ID),]
e8.atui.p.km<-as.matrix(t(e8.1.atui.p.km))

e9.atui.p.km<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.p.km<-e9.atui.p.km[order(e9.atui.p.km$ID),]
e9.atui.p.km<-as.matrix(t(e9.1.atui.p.km))

e10.atui.p.km<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.p.km<-e10.atui.p.km[order(e10.atui.p.km$ID),]
e10.atui.p.km<-as.matrix(t(e10.1.atui.p.km))

energy.km.atui.p.km<-as.data.frame(matrix(c(e1.atui.p.km,e2.atui.p.km,e3.atui.p.km,e4.atui.p.km,e5.atui.p.km,e6.atui.p.km,e7.atui.p.km,e8.atui.p.km,e9.atui.p.km,e10.atui.p.km), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df.atui.p.km<-data.frame(ID=energy.km.atui.p.km$V1,energy_over_distance=energy.km.atui.p.km$V2,energy_over_time=energy.km.atui.p.km$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.km<-david1.atui.p.km[order(david1.atui.p.km$ID),]
david1.atui.p.km<-as.matrix(t(david1.1.atui.p.km))

david2.1.atui.p.km<-david2.atui.p.km[order(david2.atui.p.km$ID),]
david2.atui.p.km<-as.matrix(t(david2.1.atui.p.km))

david3.1.atui.p.km<-david3.atui.p.km[order(david3.atui.p.km$ID),]
david3.atui.p.km<-as.matrix(t(david3.1.atui.p.km))

david4.1.atui.p.km<-david4.atui.p.km[order(david4.atui.p.km$ID),]
david4.atui.p.km<-as.matrix(t(david4.1.atui.p.km))

david5.1.atui.p.km<-david5.atui.p.km[order(david5.atui.p.km$ID),]
david5.atui.p.km<-as.matrix(t(david5.1.atui.p.km))

david6.1.atui.p.km<-david6.atui.p.km[order(david6.atui.p.km$ID),]
david6.atui.p.km<-as.matrix(t(david6.1.atui.p.km))

david7.1.atui.p.km<-david7.atui.p.km[order(david7.atui.p.km$ID),]
david7.atui.p.km<-as.matrix(t(david7.1.atui.p.km))

david8.1.atui.p.km<-david8.atui.p.km[order(david8.atui.p.km$ID),]
david8.atui.p.km<-as.matrix(t(david8.1.atui.p.km))

david9.1.atui.p.km<-david9.atui.p.km[order(david9.atui.p.km$ID),]
david9.atui.p.km<-as.matrix(t(david9.1.atui.p.km))

david10.1.atui.p.km<-david10.atui.p.km[order(david10.atui.p.km$ID),]
david10.atui.p.km<-as.matrix(t(david10.1.atui.p.km))

david.km.atui.p.km<-as.data.frame(matrix(c(david1.atui.p.km,david2.atui.p.km,david3.atui.p.km,david4.atui.p.km,david5.atui.p.km,david6.atui.p.km,david7.atui.p.km,david8.atui.p.km,david9.atui.p.km,david10.atui.p.km), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df.atui.p.km<-data.frame(ID=david.km.atui.p.km$V1,DS=david.km.atui.p.km$V2,normDS=david.km.atui.p.km$V3)


# Calculate linear models and slopes for each individual run:
lm.km.1.atui.p.km<-lm(e1.1.atui.p.km$energy_over_time~as.numeric(david1.1.atui.p.km$normDS))
km.lm.1.s.atui.p.km<-summary(lm.km.1.atui.p.km)$coefficients
km.1.slope.atui.p.km<-km.lm.1.s.atui.p.km[2,1]
lm.km.2.atui.p.km<-lm(e2.1.atui.p.km$energy_over_time~as.numeric(david2.1.atui.p.km$normDS))
km.lm.2.s.atui.p.km<-summary(lm.km.2.atui.p.km)$coefficients
km.2.slope.atui.p.km<-km.lm.2.s.atui.p.km[2,1]
lm.km.3.atui.p.km<-lm(e3.1.atui.p.km$energy_over_time~as.numeric(david3.1.atui.p.km$normDS))
km.lm.3.s.atui.p.km<-summary(lm.km.3.atui.p.km)$coefficients
km.3.slope.atui.p.km<-km.lm.3.s.atui.p.km[2,1]
lm.km.4.atui.p.km<-lm(e4.1.atui.p.km$energy_over_time~as.numeric(david4.1.atui.p.km$normDS))
km.lm.4.s.atui.p.km<-summary(lm.km.4.atui.p.km)$coefficients
km.4.slope.atui.p.km<-km.lm.4.s.atui.p.km[2,1]
lm.km.5.atui.p.km<-lm(e5.1.atui.p.km$energy_over_time~as.numeric(david5.1.atui.p.km$normDS))
km.lm.5.s.atui.p.km<-summary(lm.km.5.atui.p.km)$coefficients
km.5.slope.atui.p.km<-km.lm.5.s.atui.p.km[2,1]
lm.km.6.atui.p.km<-lm(e6.1.atui.p.km$energy_over_time~as.numeric(david6.1.atui.p.km$normDS))
km.lm.6.s.atui.p.km<-summary(lm.km.6.atui.p.km)$coefficients
km.6.slope.atui.p.km<-km.lm.6.s.atui.p.km[2,1]
lm.km.7.atui.p.km<-lm(e7.1.atui.p.km$energy_over_time~as.numeric(david7.1.atui.p.km$normDS))
km.lm.7.s.atui.p.km<-summary(lm.km.7.atui.p.km)$coefficients
km.7.slope.atui.p.km<-km.lm.7.s.atui.p.km[2,1]
lm.km.8.atui.p.km<-lm(e8.1.atui.p.km$energy_over_time~as.numeric(david8.1.atui.p.km$normDS))
km.lm.8.s.atui.p.km<-summary(lm.km.8.atui.p.km)$coefficients
km.8.slope.atui.p.km<-km.lm.8.s.atui.p.km[2,1]
lm.km.9.atui.p.km<-lm(e9.1.atui.p.km$energy_over_time~as.numeric(david9.1.atui.p.km$normDS))
km.lm.9.s.atui.p.km<-summary(lm.km.9.atui.p.km)$coefficients
km.9.slope.atui.p.km<-km.lm.9.s.atui.p.km[2,1]
lm.km.10.atui.p.km<-lm(e10.1.atui.p.km$energy_over_time~as.numeric(david10.1.atui.p.km$normDS))
km.lm.10.s.atui.p.km<-summary(lm.km.10.atui.p.km)$coefficients
km.10.slope.atui.p.km<-km.lm.10.s.atui.p.km[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
km.atui.p.ss.attacks.atui.p.km<-data.frame(triangle.transitivity=c(tri1.atui.p.km,tri2.atui.p.km,tri3.atui.p.km,tri4.atui.p.km,tri5.atui.p.km,tri6.atui.p.km,tri7.atui.p.km,tri8.atui.p.km,tri9.atui.p.km,tri10.atui.p.km),escalation=c(ep1.atui.p.km,ep2.atui.p.km,ep3.atui.p.km,ep4.atui.p.km,ep5.atui.p.km,ep6.atui.p.km,ep7.atui.p.km,ep8.atui.p.km,ep9.atui.p.km,ep10.atui.p.km),dci=c(dci1.atui.p.km,dci2.atui.p.km,dci3.atui.p.km,dci4.atui.p.km,dci5.atui.p.km,dci6.atui.p.km,dci7.atui.p.km,dci8.atui.p.km,dci9.atui.p.km,dci10.atui.p.km),steepness=c(s1.atui.p.km,s2.atui.p.km,s3.atui.p.km,s4.atui.p.km,s5.atui.p.km,s6.atui.p.km,s7.atui.p.km,s8.atui.p.km,s9.atui.p.km,s10.atui.p.km),slope=c(km.1.slope.atui.p.km,km.2.slope.atui.p.km,km.3.slope.atui.p.km,km.4.slope.atui.p.km,km.5.slope.atui.p.km,km.6.slope.atui.p.km,km.7.slope.atui.p.km,km.8.slope.atui.p.km,km.9.slope.atui.p.km,km.10.slope.atui.p.km))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Self Uniform

# Data organization for the Knowledge Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.p.ks<-sapply(files, read.csv)

# Generate attacks.atui.p.ks Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[1]],X2=attacks.atui.p.ks[[2]],Victories=attacks.atui.p.ks[[3]])
mat1.atui.p.ks<-inter.mat(mut1.atui.p.ks)
tri1.atui.p.ks<-tr.tri(mat1.atui.p.ks)
dci1.atui.p.ks<-DCindex(mat1.atui.p.ks)
mat1.atui.p.ks[is.na(mat1.atui.p.ks)] = 0
h1.atui.p.ks<-h.index(mat1.atui.p.ks)

ep1.atui.p.ks<-ep(mut1.atui.p.ks,a1.ui.p.ks)
david1.atui.p.ks<-DS(mat1.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.ks<-cbind(ordrank.1.atui.p.ks,ds=david1.atui.p.ks$normDS)
lm1.atui.p.ks<-summary(lm(ordrank.1.atui.p.ks$ds~ordrank.1.atui.p.ks$ord.rank))
s1.atui.p.ks<-lm1.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[4]],X2=attacks.atui.p.ks[[5]],Victories=attacks.atui.p.ks[[6]])
mat2.atui.p.ks<-inter.mat(mut2.atui.p.ks)
tri2.atui.p.ks<-tr.tri(mat2.atui.p.ks)
dci2.atui.p.ks<-DCindex(mat2.atui.p.ks)
mat2.atui.p.ks[is.na(mat2.atui.p.ks)] = 0
h2.atui.p.ks<-h.index(mat2.atui.p.ks)

ep2.atui.p.ks<-ep(mut2.atui.p.ks,a2.ui.p.ks)
david2.atui.p.ks<-DS(mat2.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.ks<-cbind(ordrank.2.atui.p.ks,ds=david2.atui.p.ks$normDS)
lm2.atui.p.ks<-summary(lm(ordrank.2.atui.p.ks$ds~ordrank.2.atui.p.ks$ord.rank))
s2.atui.p.ks<-lm2.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[7]],X2=attacks.atui.p.ks[[8]],Victories=attacks.atui.p.ks[[9]])
mat3.atui.p.ks<-inter.mat(mut3.atui.p.ks)
tri3.atui.p.ks<-tr.tri(mat3.atui.p.ks)
dci3.atui.p.ks<-DCindex(mat3.atui.p.ks)
mat3.atui.p.ks[is.na(mat3.atui.p.ks)] = 0
h3.atui.p.ks<-h.index(mat3.atui.p.ks)

ep3.atui.p.ks<-ep(mut3.atui.p.ks,a3.ui.p.ks)
david3.atui.p.ks<-DS(mat3.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.ks<-cbind(ordrank.3.atui.p.ks,ds=david3.atui.p.ks$normDS)
lm3.atui.p.ks<-summary(lm(ordrank.3.atui.p.ks$ds~ordrank.3.atui.p.ks$ord.rank))
s3.atui.p.ks<-lm3.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[10]],X2=attacks.atui.p.ks[[11]],Victories=attacks.atui.p.ks[[12]])
mat4.atui.p.ks<-inter.mat(mut4.atui.p.ks)
tri4.atui.p.ks<-tr.tri(mat4.atui.p.ks)
dci4.atui.p.ks<-DCindex(mat4.atui.p.ks)
mat4.atui.p.ks[is.na(mat4.atui.p.ks)] = 0
h4.atui.p.ks<-h.index(mat4.atui.p.ks)

ep4.atui.p.ks<-ep(mut4.atui.p.ks,a4.ui.p.ks)
david4.atui.p.ks<-DS(mat4.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.ks<-cbind(ordrank.4.atui.p.ks,ds=david4.atui.p.ks$normDS)
lm4.atui.p.ks<-summary(lm(ordrank.4.atui.p.ks$ds~ordrank.4.atui.p.ks$ord.rank))
s4.atui.p.ks<-lm4.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[13]],X2=attacks.atui.p.ks[[14]],Victories=attacks.atui.p.ks[[15]])
mat5.atui.p.ks<-inter.mat(mut5.atui.p.ks)
tri5.atui.p.ks<-tr.tri(mat5.atui.p.ks)
dci5.atui.p.ks<-DCindex(mat5.atui.p.ks)
mat5.atui.p.ks[is.na(mat5.atui.p.ks)] = 0
h5.atui.p.ks<-h.index(mat5.atui.p.ks)

ep5.atui.p.ks<-ep(mut5.atui.p.ks,a5.ui.p.ks)
david5.atui.p.ks<-DS(mat5.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.ks<-cbind(ordrank.5.atui.p.ks,ds=david5.atui.p.ks$normDS)
lm5.atui.p.ks<-summary(lm(ordrank.5.atui.p.ks$ds~ordrank.5.atui.p.ks$ord.rank))
s5.atui.p.ks<-lm5.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[16]],X2=attacks.atui.p.ks[[17]],Victories=attacks.atui.p.ks[[18]])
mat6.atui.p.ks<-inter.mat(mut6.atui.p.ks)
tri6.atui.p.ks<-tr.tri(mat6.atui.p.ks)
dci6.atui.p.ks<-DCindex(mat6.atui.p.ks)
mat6.atui.p.ks[is.na(mat6.atui.p.ks)] = 0
h6.atui.p.ks<-h.index(mat6.atui.p.ks)

ep6.atui.p.ks<-ep(mut6.atui.p.ks,a6.ui.p.ks)
david6.atui.p.ks<-DS(mat6.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.ks<-cbind(ordrank.6.atui.p.ks,ds=david6.atui.p.ks$normDS)
lm6.atui.p.ks<-summary(lm(ordrank.6.atui.p.ks$ds~ordrank.6.atui.p.ks$ord.rank))
s6.atui.p.ks<-lm6.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[19]],X2=attacks.atui.p.ks[[20]],Victories=attacks.atui.p.ks[[21]])
mat7.atui.p.ks<-inter.mat(mut7.atui.p.ks)
tri7.atui.p.ks<-tr.tri(mat7.atui.p.ks)
dci7.atui.p.ks<-DCindex(mat7.atui.p.ks)
mat7.atui.p.ks[is.na(mat7.atui.p.ks)] = 0
h7.atui.p.ks<-h.index(mat7.atui.p.ks)

ep7.atui.p.ks<-ep(mut7.atui.p.ks,a7.ui.p.ks)
david7.atui.p.ks<-DS(mat7.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.ks<-cbind(ordrank.7.atui.p.ks,ds=david7.atui.p.ks$normDS)
lm7.atui.p.ks<-summary(lm(ordrank.7.atui.p.ks$ds~ordrank.7.atui.p.ks$ord.rank))
s7.atui.p.ks<-lm7.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[22]],X2=attacks.atui.p.ks[[23]],Victories=attacks.atui.p.ks[[24]])
mat8.atui.p.ks<-inter.mat(mut8.atui.p.ks)
tri8.atui.p.ks<-tr.tri(mat8.atui.p.ks)
dci8.atui.p.ks<-DCindex(mat8.atui.p.ks)
mat8.atui.p.ks[is.na(mat8.atui.p.ks)] = 0
h8.atui.p.ks<-h.index(mat8.atui.p.ks)

ep8.atui.p.ks<-ep(mut8.atui.p.ks,a8.ui.p.ks)
david8.atui.p.ks<-DS(mat8.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.ks<-cbind(ordrank.8.atui.p.ks,ds=david8.atui.p.ks$normDS)
lm8.atui.p.ks<-summary(lm(ordrank.8.atui.p.ks$ds~ordrank.8.atui.p.ks$ord.rank))
s8.atui.p.ks<-lm8.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[25]],X2=attacks.atui.p.ks[[26]],Victories=attacks.atui.p.ks[[27]])
mat9.atui.p.ks<-inter.mat(mut9.atui.p.ks)
tri9.atui.p.ks<-tr.tri(mat9.atui.p.ks)
dci9.atui.p.ks<-DCindex(mat9.atui.p.ks)
mat9.atui.p.ks[is.na(mat9.atui.p.ks)] = 0
h9.atui.p.ks<-h.index(mat9.atui.p.ks)

ep9.atui.p.ks<-ep(mut9.atui.p.ks,a9.ui.p.ks)
david9.atui.p.ks<-DS(mat9.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.ks<-cbind(ordrank.9.atui.p.ks,ds=david9.atui.p.ks$normDS)
lm9.atui.p.ks<-summary(lm(ordrank.9.atui.p.ks$ds~ordrank.9.atui.p.ks$ord.rank))
s9.atui.p.ks<-lm9.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.ks<-data.frame(X1=attacks.atui.p.ks[[28]],X2=attacks.atui.p.ks[[29]],Victories=attacks.atui.p.ks[[30]])
mat10.atui.p.ks<-inter.mat(mut10.atui.p.ks)
tri10.atui.p.ks<-tr.tri(mat10.atui.p.ks)
dci10.atui.p.ks<-DCindex(mat10.atui.p.ks)
mat10.atui.p.ks[is.na(mat10.atui.p.ks)] = 0
h10.atui.p.ks<-h.index(mat10.atui.p.ks)

ep10.atui.p.ks<-ep(mut10.atui.p.ks,a10.ui.p.ks)
david10.atui.p.ks<-DS(mat10.atui.p.ks) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.ks<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.ks<-cbind(ordrank.10.atui.p.ks,ds=david10.atui.p.ks$normDS)
lm10.atui.p.ks<-summary(lm(ordrank.10.atui.p.ks$ds~ordrank.10.atui.p.ks$ord.rank))
s10.atui.p.ks<-lm10.atui.p.ks$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.ks<-sum(mut1.atui.p.ks$Victories)
int2.atui.p.ks<-sum(mut2.atui.p.ks$Victories)
int3.atui.p.ks<-sum(mut3.atui.p.ks$Victories)
int4.atui.p.ks<-sum(mut4.atui.p.ks$Victories)
int5.atui.p.ks<-sum(mut5.atui.p.ks$Victories)
int6.atui.p.ks<-sum(mut6.atui.p.ks$Victories)
int7.atui.p.ks<-sum(mut7.atui.p.ks$Victories)
int8.atui.p.ks<-sum(mut8.atui.p.ks$Victories)
int9.atui.p.ks<-sum(mut9.atui.p.ks$Victories)
int10.atui.p.ks<-sum(mut10.atui.p.ks$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.ks<-sum(a1.ui.p.ks$Victories)
av2.atui.p.ks<-sum(a2.ui.p.ks$Victories)
av3.atui.p.ks<-sum(a3.ui.p.ks$Victories)
av4.atui.p.ks<-sum(a4.ui.p.ks$Victories)
av5.atui.p.ks<-sum(a5.ui.p.ks$Victories)
av6.atui.p.ks<-sum(a6.ui.p.ks$Victories)
av7.atui.p.ks<-sum(a7.ui.p.ks$Victories)
av8.atui.p.ks<-sum(a8.ui.p.ks$Victories)
av9.atui.p.ks<-sum(a9.ui.p.ks$Victories)
av10.atui.p.ks<-sum(a10.ui.p.ks$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ks.atiu.p<-(sum(av1.atui.p.ks, av2.atui.p.ks, av3.atui.p.ks, av4.atui.p.ks, av5.atui.p.ks, av6.atui.p.ks, av7.atui.p.ks, av8.atui.p.ks, av9.atui.p.ks, av10.atui.p.ks))/10

  # Calculate the average number of victories across trials:
avg.int.ks.atiu.p<-(sum(int1.atui.p.ks, int2.atui.p.ks, int3.atui.p.ks, int4.atui.p.ks, int5.atui.p.ks, int6.atui.p.ks, int7.atui.p.ks, int8.atui.p.ks, int9.atui.p.ks, int10.atui.p.ks))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ks.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.ks<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.p.ks<-e1.atui.p.ks[order(e1.atui.p.ks$ID),]
e1.atui.p.ks<-as.matrix(t(e1.1.atui.p.ks))

e2.atui.p.ks<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.p.ks<-e2.atui.p.ks[order(e2.atui.p.ks$ID),]
e2.atui.p.ks<-as.matrix(t(e2.1.atui.p.ks))

e3.atui.p.ks<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.p.ks<-e3.atui.p.ks[order(e3.atui.p.ks$ID),]
e3.atui.p.ks<-as.matrix(t(e3.1.atui.p.ks))

e4.atui.p.ks<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.p.ks<-e4.atui.p.ks[order(e4.atui.p.ks$ID),]
e4.atui.p.ks<-as.matrix(t(e4.1.atui.p.ks))

e5.atui.p.ks<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.p.ks<-e5.atui.p.ks[order(e5.atui.p.ks$ID),]
e5.atui.p.ks<-as.matrix(t(e5.1.atui.p.ks))

e6.atui.p.ks<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.p.ks<-e6.atui.p.ks[order(e6.atui.p.ks$ID),]
e6.atui.p.ks<-as.matrix(t(e6.1.atui.p.ks))

e7.atui.p.ks<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.p.ks<-e7.atui.p.ks[order(e7.atui.p.ks$ID),]
e7.atui.p.ks<-as.matrix(t(e7.1.atui.p.ks))

e8.atui.p.ks<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.p.ks<-e8.atui.p.ks[order(e8.atui.p.ks$ID),]
e8.atui.p.ks<-as.matrix(t(e8.1.atui.p.ks))

e9.atui.p.ks<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.p.ks<-e9.atui.p.ks[order(e9.atui.p.ks$ID),]
e9.atui.p.ks<-as.matrix(t(e9.1.atui.p.ks))

e10.atui.p.ks<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.p.ks<-e10.atui.p.ks[order(e10.atui.p.ks$ID),]
e10.atui.p.ks<-as.matrix(t(e10.1.atui.p.ks))

energy.ks.atui.p.ks<-as.data.frame(matrix(c(e1.atui.p.ks,e2.atui.p.ks,e3.atui.p.ks,e4.atui.p.ks,e5.atui.p.ks,e6.atui.p.ks,e7.atui.p.ks,e8.atui.p.ks,e9.atui.p.ks,e10.atui.p.ks), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df.atui.p.ks<-data.frame(ID=energy.ks.atui.p.ks$V1,energy_over_distance=energy.ks.atui.p.ks$V2,energy_over_time=energy.ks.atui.p.ks$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.ks<-david1.atui.p.ks[order(david1.atui.p.ks$ID),]
david1.atui.p.ks<-as.matrix(t(david1.1.atui.p.ks))

david2.1.atui.p.ks<-david2.atui.p.ks[order(david2.atui.p.ks$ID),]
david2.atui.p.ks<-as.matrix(t(david2.1.atui.p.ks))

david3.1.atui.p.ks<-david3.atui.p.ks[order(david3.atui.p.ks$ID),]
david3.atui.p.ks<-as.matrix(t(david3.1.atui.p.ks))

david4.1.atui.p.ks<-david4.atui.p.ks[order(david4.atui.p.ks$ID),]
david4.atui.p.ks<-as.matrix(t(david4.1.atui.p.ks))

david5.1.atui.p.ks<-david5.atui.p.ks[order(david5.atui.p.ks$ID),]
david5.atui.p.ks<-as.matrix(t(david5.1.atui.p.ks))

david6.1.atui.p.ks<-david6.atui.p.ks[order(david6.atui.p.ks$ID),]
david6.atui.p.ks<-as.matrix(t(david6.1.atui.p.ks))

david7.1.atui.p.ks<-david7.atui.p.ks[order(david7.atui.p.ks$ID),]
david7.atui.p.ks<-as.matrix(t(david7.1.atui.p.ks))

david8.1.atui.p.ks<-david8.atui.p.ks[order(david8.atui.p.ks$ID),]
david8.atui.p.ks<-as.matrix(t(david8.1.atui.p.ks))

david9.1.atui.p.ks<-david9.atui.p.ks[order(david9.atui.p.ks$ID),]
david9.atui.p.ks<-as.matrix(t(david9.1.atui.p.ks))

david10.1.atui.p.ks<-david10.atui.p.ks[order(david10.atui.p.ks$ID),]
david10.atui.p.ks<-as.matrix(t(david10.1.atui.p.ks))

david.ks.atui.p.ks<-as.data.frame(matrix(c(david1.atui.p.ks,david2.atui.p.ks,david3.atui.p.ks,david4.atui.p.ks,david5.atui.p.ks,david6.atui.p.ks,david7.atui.p.ks,david8.atui.p.ks,david9.atui.p.ks,david10.atui.p.ks), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df.atui.p.ks<-data.frame(ID=david.ks.atui.p.ks$V1,DS=david.ks.atui.p.ks$V2,normDS=david.ks.atui.p.ks$V3)


# Calculate linear models and slopes for each individual run:
lm.ks.1.atui.p.ks<-lm(e1.1.atui.p.ks$energy_over_time~as.numeric(david1.1.atui.p.ks$normDS))
ks.lm.1.s.atui.p.ks<-summary(lm.ks.1.atui.p.ks)$coefficients
ks.1.slope.atui.p.ks<-ks.lm.1.s.atui.p.ks[2,1]
lm.ks.2.atui.p.ks<-lm(e2.1.atui.p.ks$energy_over_time~as.numeric(david2.1.atui.p.ks$normDS))
ks.lm.2.s.atui.p.ks<-summary(lm.ks.2.atui.p.ks)$coefficients
ks.2.slope.atui.p.ks<-ks.lm.2.s.atui.p.ks[2,1]
lm.ks.3.atui.p.ks<-lm(e3.1.atui.p.ks$energy_over_time~as.numeric(david3.1.atui.p.ks$normDS))
ks.lm.3.s.atui.p.ks<-summary(lm.ks.3.atui.p.ks)$coefficients
ks.3.slope.atui.p.ks<-ks.lm.3.s.atui.p.ks[2,1]
lm.ks.4.atui.p.ks<-lm(e4.1.atui.p.ks$energy_over_time~as.numeric(david4.1.atui.p.ks$normDS))
ks.lm.4.s.atui.p.ks<-summary(lm.ks.4.atui.p.ks)$coefficients
ks.4.slope.atui.p.ks<-ks.lm.4.s.atui.p.ks[2,1]
lm.ks.5.atui.p.ks<-lm(e5.1.atui.p.ks$energy_over_time~as.numeric(david5.1.atui.p.ks$normDS))
ks.lm.5.s.atui.p.ks<-summary(lm.ks.5.atui.p.ks)$coefficients
ks.5.slope.atui.p.ks<-ks.lm.5.s.atui.p.ks[2,1]
lm.ks.6.atui.p.ks<-lm(e6.1.atui.p.ks$energy_over_time~as.numeric(david6.1.atui.p.ks$normDS))
ks.lm.6.s.atui.p.ks<-summary(lm.ks.6.atui.p.ks)$coefficients
ks.6.slope.atui.p.ks<-ks.lm.6.s.atui.p.ks[2,1]
lm.ks.7.atui.p.ks<-lm(e7.1.atui.p.ks$energy_over_time~as.numeric(david7.1.atui.p.ks$normDS))
ks.lm.7.s.atui.p.ks<-summary(lm.ks.7.atui.p.ks)$coefficients
ks.7.slope.atui.p.ks<-ks.lm.7.s.atui.p.ks[2,1]
lm.ks.8.atui.p.ks<-lm(e8.1.atui.p.ks$energy_over_time~as.numeric(david8.1.atui.p.ks$normDS))
ks.lm.8.s.atui.p.ks<-summary(lm.ks.8.atui.p.ks)$coefficients
ks.8.slope.atui.p.ks<-ks.lm.8.s.atui.p.ks[2,1]
lm.ks.9.atui.p.ks<-lm(e9.1.atui.p.ks$energy_over_time~as.numeric(david9.1.atui.p.ks$normDS))
ks.lm.9.s.atui.p.ks<-summary(lm.ks.9.atui.p.ks)$coefficients
ks.9.slope.atui.p.ks<-ks.lm.9.s.atui.p.ks[2,1]
lm.ks.10.atui.p.ks<-lm(e10.1.atui.p.ks$energy_over_time~as.numeric(david10.1.atui.p.ks$normDS))
ks.lm.10.s.atui.p.ks<-summary(lm.ks.10.atui.p.ks)$coefficients
ks.10.slope.atui.p.ks<-ks.lm.10.s.atui.p.ks[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ks.atui.p.ss.attacks.atui.p.ks<-data.frame(triangle.transitivity=c(tri1.atui.p.ks,tri2.atui.p.ks,tri3.atui.p.ks,tri4.atui.p.ks,tri5.atui.p.ks,tri6.atui.p.ks,tri7.atui.p.ks,tri8.atui.p.ks,tri9.atui.p.ks,tri10.atui.p.ks),escalation=c(ep1.atui.p.ks,ep2.atui.p.ks,ep3.atui.p.ks,ep4.atui.p.ks,ep5.atui.p.ks,ep6.atui.p.ks,ep7.atui.p.ks,ep8.atui.p.ks,ep9.atui.p.ks,ep10.atui.p.ks),dci=c(dci1.atui.p.ks,dci2.atui.p.ks,dci3.atui.p.ks,dci4.atui.p.ks,dci5.atui.p.ks,dci6.atui.p.ks,dci7.atui.p.ks,dci8.atui.p.ks,dci9.atui.p.ks,dci10.atui.p.ks),steepness=c(s1.atui.p.ks,s2.atui.p.ks,s3.atui.p.ks,s4.atui.p.ks,s5.atui.p.ks,s6.atui.p.ks,s7.atui.p.ks,s8.atui.p.ks,s9.atui.p.ks,s10.atui.p.ks),slope=c(ks.1.slope.atui.p.ks,ks.2.slope.atui.p.ks,ks.3.slope.atui.p.ks,ks.4.slope.atui.p.ks,ks.5.slope.atui.p.ks,ks.6.slope.atui.p.ks,ks.7.slope.atui.p.ks,ks.8.slope.atui.p.ks,ks.9.slope.atui.p.ks,ks.10.slope.atui.p.ks))


#-------------------------------------------------------------------------------------------------------------------------

#knowledge Opponent Uniform

# Data organization for the Knowledge Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.p.ko<-sapply(files, read.csv)

# Generate attacks.atui.p.ko Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[1]],X2=attacks.atui.p.ko[[2]],Victories=attacks.atui.p.ko[[3]])
mat1.atui.p.ko<-inter.mat(mut1.atui.p.ko)
tri1.atui.p.ko<-tr.tri(mat1.atui.p.ko)
dci1.atui.p.ko<-DCindex(mat1.atui.p.ko)
mat1.atui.p.ko[is.na(mat1.atui.p.ko)] = 0
h1.atui.p.ko<-h.index(mat1.atui.p.ko)

ep1.atui.p.ko<-ep(mut1.atui.p.ko,a1.ui.p.ko)
david1.atui.p.ko<-DS(mat1.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.ko<-cbind(ordrank.1.atui.p.ko,ds=david1.atui.p.ko$normDS)
lm1.atui.p.ko<-summary(lm(ordrank.1.atui.p.ko$ds~ordrank.1.atui.p.ko$ord.rank))
s1.atui.p.ko<-lm1.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[4]],X2=attacks.atui.p.ko[[5]],Victories=attacks.atui.p.ko[[6]])
mat2.atui.p.ko<-inter.mat(mut2.atui.p.ko)
tri2.atui.p.ko<-tr.tri(mat2.atui.p.ko)
dci2.atui.p.ko<-DCindex(mat2.atui.p.ko)
mat2.atui.p.ko[is.na(mat2.atui.p.ko)] = 0
h2.atui.p.ko<-h.index(mat2.atui.p.ko)

ep2.atui.p.ko<-ep(mut2.atui.p.ko,a2.ui.p.ko)
david2.atui.p.ko<-DS(mat2.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.ko<-cbind(ordrank.2.atui.p.ko,ds=david2.atui.p.ko$normDS)
lm2.atui.p.ko<-summary(lm(ordrank.2.atui.p.ko$ds~ordrank.2.atui.p.ko$ord.rank))
s2.atui.p.ko<-lm2.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[7]],X2=attacks.atui.p.ko[[8]],Victories=attacks.atui.p.ko[[9]])
mat3.atui.p.ko<-inter.mat(mut3.atui.p.ko)
tri3.atui.p.ko<-tr.tri(mat3.atui.p.ko)
dci3.atui.p.ko<-DCindex(mat3.atui.p.ko)
mat3.atui.p.ko[is.na(mat3.atui.p.ko)] = 0
h3.atui.p.ko<-h.index(mat3.atui.p.ko)

ep3.atui.p.ko<-ep(mut3.atui.p.ko,a3.ui.p.ko)
david3.atui.p.ko<-DS(mat3.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.ko<-cbind(ordrank.3.atui.p.ko,ds=david3.atui.p.ko$normDS)
lm3.atui.p.ko<-summary(lm(ordrank.3.atui.p.ko$ds~ordrank.3.atui.p.ko$ord.rank))
s3.atui.p.ko<-lm3.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[10]],X2=attacks.atui.p.ko[[11]],Victories=attacks.atui.p.ko[[12]])
mat4.atui.p.ko<-inter.mat(mut4.atui.p.ko)
tri4.atui.p.ko<-tr.tri(mat4.atui.p.ko)
dci4.atui.p.ko<-DCindex(mat4.atui.p.ko)
mat4.atui.p.ko[is.na(mat4.atui.p.ko)] = 0
h4.atui.p.ko<-h.index(mat4.atui.p.ko)

ep4.atui.p.ko<-ep(mut4.atui.p.ko,a4.ui.p.ko)
david4.atui.p.ko<-DS(mat4.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.ko<-cbind(ordrank.4.atui.p.ko,ds=david4.atui.p.ko$normDS)
lm4.atui.p.ko<-summary(lm(ordrank.4.atui.p.ko$ds~ordrank.4.atui.p.ko$ord.rank))
s4.atui.p.ko<-lm4.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[13]],X2=attacks.atui.p.ko[[14]],Victories=attacks.atui.p.ko[[15]])
mat5.atui.p.ko<-inter.mat(mut5.atui.p.ko)
tri5.atui.p.ko<-tr.tri(mat5.atui.p.ko)
dci5.atui.p.ko<-DCindex(mat5.atui.p.ko)
mat5.atui.p.ko[is.na(mat5.atui.p.ko)] = 0
h5.atui.p.ko<-h.index(mat5.atui.p.ko)

ep5.atui.p.ko<-ep(mut5.atui.p.ko,a5.ui.p.ko)
david5.atui.p.ko<-DS(mat5.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.ko<-cbind(ordrank.5.atui.p.ko,ds=david5.atui.p.ko$normDS)
lm5.atui.p.ko<-summary(lm(ordrank.5.atui.p.ko$ds~ordrank.5.atui.p.ko$ord.rank))
s5.atui.p.ko<-lm5.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[16]],X2=attacks.atui.p.ko[[17]],Victories=attacks.atui.p.ko[[18]])
mat6.atui.p.ko<-inter.mat(mut6.atui.p.ko)
tri6.atui.p.ko<-tr.tri(mat6.atui.p.ko)
dci6.atui.p.ko<-DCindex(mat6.atui.p.ko)
mat6.atui.p.ko[is.na(mat6.atui.p.ko)] = 0
h6.atui.p.ko<-h.index(mat6.atui.p.ko)

ep6.atui.p.ko<-ep(mut6.atui.p.ko,a6.ui.p.ko)
david6.atui.p.ko<-DS(mat6.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.ko<-cbind(ordrank.6.atui.p.ko,ds=david6.atui.p.ko$normDS)
lm6.atui.p.ko<-summary(lm(ordrank.6.atui.p.ko$ds~ordrank.6.atui.p.ko$ord.rank))
s6.atui.p.ko<-lm6.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[19]],X2=attacks.atui.p.ko[[20]],Victories=attacks.atui.p.ko[[21]])
mat7.atui.p.ko<-inter.mat(mut7.atui.p.ko)
tri7.atui.p.ko<-tr.tri(mat7.atui.p.ko)
dci7.atui.p.ko<-DCindex(mat7.atui.p.ko)
mat7.atui.p.ko[is.na(mat7.atui.p.ko)] = 0
h7.atui.p.ko<-h.index(mat7.atui.p.ko)

ep7.atui.p.ko<-ep(mut7.atui.p.ko,a7.ui.p.ko)
david7.atui.p.ko<-DS(mat7.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.ko<-cbind(ordrank.7.atui.p.ko,ds=david7.atui.p.ko$normDS)
lm7.atui.p.ko<-summary(lm(ordrank.7.atui.p.ko$ds~ordrank.7.atui.p.ko$ord.rank))
s7.atui.p.ko<-lm7.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[22]],X2=attacks.atui.p.ko[[23]],Victories=attacks.atui.p.ko[[24]])
mat8.atui.p.ko<-inter.mat(mut8.atui.p.ko)
tri8.atui.p.ko<-tr.tri(mat8.atui.p.ko)
dci8.atui.p.ko<-DCindex(mat8.atui.p.ko)
mat8.atui.p.ko[is.na(mat8.atui.p.ko)] = 0
h8.atui.p.ko<-h.index(mat8.atui.p.ko)

ep8.atui.p.ko<-ep(mut8.atui.p.ko,a8.ui.p.ko)
david8.atui.p.ko<-DS(mat8.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.ko<-cbind(ordrank.8.atui.p.ko,ds=david8.atui.p.ko$normDS)
lm8.atui.p.ko<-summary(lm(ordrank.8.atui.p.ko$ds~ordrank.8.atui.p.ko$ord.rank))
s8.atui.p.ko<-lm8.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[25]],X2=attacks.atui.p.ko[[26]],Victories=attacks.atui.p.ko[[27]])
mat9.atui.p.ko<-inter.mat(mut9.atui.p.ko)
tri9.atui.p.ko<-tr.tri(mat9.atui.p.ko)
dci9.atui.p.ko<-DCindex(mat9.atui.p.ko)
mat9.atui.p.ko[is.na(mat9.atui.p.ko)] = 0
h9.atui.p.ko<-h.index(mat9.atui.p.ko)

ep9.atui.p.ko<-ep(mut9.atui.p.ko,a9.ui.p.ko)
david9.atui.p.ko<-DS(mat9.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.ko<-cbind(ordrank.9.atui.p.ko,ds=david9.atui.p.ko$normDS)
lm9.atui.p.ko<-summary(lm(ordrank.9.atui.p.ko$ds~ordrank.9.atui.p.ko$ord.rank))
s9.atui.p.ko<-lm9.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.ko<-data.frame(X1=attacks.atui.p.ko[[28]],X2=attacks.atui.p.ko[[29]],Victories=attacks.atui.p.ko[[30]])
mat10.atui.p.ko<-inter.mat(mut10.atui.p.ko)
tri10.atui.p.ko<-tr.tri(mat10.atui.p.ko)
dci10.atui.p.ko<-DCindex(mat10.atui.p.ko)
mat10.atui.p.ko[is.na(mat10.atui.p.ko)] = 0
h10.atui.p.ko<-h.index(mat10.atui.p.ko)

ep10.atui.p.ko<-ep(mut10.atui.p.ko,a10.ui.p.ko)
david10.atui.p.ko<-DS(mat10.atui.p.ko) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.ko<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.ko<-cbind(ordrank.10.atui.p.ko,ds=david10.atui.p.ko$normDS)
lm10.atui.p.ko<-summary(lm(ordrank.10.atui.p.ko$ds~ordrank.10.atui.p.ko$ord.rank))
s10.atui.p.ko<-lm10.atui.p.ko$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.ko<-sum(mut1.atui.p.ko$Victories)
int2.atui.p.ko<-sum(mut2.atui.p.ko$Victories)
int3.atui.p.ko<-sum(mut3.atui.p.ko$Victories)
int4.atui.p.ko<-sum(mut4.atui.p.ko$Victories)
int5.atui.p.ko<-sum(mut5.atui.p.ko$Victories)
int6.atui.p.ko<-sum(mut6.atui.p.ko$Victories)
int7.atui.p.ko<-sum(mut7.atui.p.ko$Victories)
int8.atui.p.ko<-sum(mut8.atui.p.ko$Victories)
int9.atui.p.ko<-sum(mut9.atui.p.ko$Victories)
int10.atui.p.ko<-sum(mut10.atui.p.ko$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.ko<-sum(a1.ui.p.ko$Victories)
av2.atui.p.ko<-sum(a2.ui.p.ko$Victories)
av3.atui.p.ko<-sum(a3.ui.p.ko$Victories)
av4.atui.p.ko<-sum(a4.ui.p.ko$Victories)
av5.atui.p.ko<-sum(a5.ui.p.ko$Victories)
av6.atui.p.ko<-sum(a6.ui.p.ko$Victories)
av7.atui.p.ko<-sum(a7.ui.p.ko$Victories)
av8.atui.p.ko<-sum(a8.ui.p.ko$Victories)
av9.atui.p.ko<-sum(a9.ui.p.ko$Victories)
av10.atui.p.ko<-sum(a10.ui.p.ko$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ko.atiu.p<-(sum(av1.atui.p.ko, av2.atui.p.ko, av3.atui.p.ko, av4.atui.p.ko, av5.atui.p.ko, av6.atui.p.ko, av7.atui.p.ko, av8.atui.p.ko, av9.atui.p.ko, av10.atui.p.ko))/10

  # Calculate the average number of victories across trials:
avg.int.ko.atiu.p<-(sum(int1.atui.p.ko, int2.atui.p.ko, int3.atui.p.ko, int4.atui.p.ko, int5.atui.p.ko, int6.atui.p.ko, int7.atui.p.ko, int8.atui.p.ko, int9.atui.p.ko, int10.atui.p.ko))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ko.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.ko<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.p.ko<-e1.atui.p.ko[order(e1.atui.p.ko$ID),]
e1.atui.p.ko<-as.matrix(t(e1.1.atui.p.ko))

e2.atui.p.ko<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.p.ko<-e2.atui.p.ko[order(e2.atui.p.ko$ID),]
e2.atui.p.ko<-as.matrix(t(e2.1.atui.p.ko))

e3.atui.p.ko<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.p.ko<-e3.atui.p.ko[order(e3.atui.p.ko$ID),]
e3.atui.p.ko<-as.matrix(t(e3.1.atui.p.ko))

e4.atui.p.ko<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.p.ko<-e4.atui.p.ko[order(e4.atui.p.ko$ID),]
e4.atui.p.ko<-as.matrix(t(e4.1.atui.p.ko))

e5.atui.p.ko<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.p.ko<-e5.atui.p.ko[order(e5.atui.p.ko$ID),]
e5.atui.p.ko<-as.matrix(t(e5.1.atui.p.ko))

e6.atui.p.ko<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.p.ko<-e6.atui.p.ko[order(e6.atui.p.ko$ID),]
e6.atui.p.ko<-as.matrix(t(e6.1.atui.p.ko))

e7.atui.p.ko<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.p.ko<-e7.atui.p.ko[order(e7.atui.p.ko$ID),]
e7.atui.p.ko<-as.matrix(t(e7.1.atui.p.ko))

e8.atui.p.ko<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.p.ko<-e8.atui.p.ko[order(e8.atui.p.ko$ID),]
e8.atui.p.ko<-as.matrix(t(e8.1.atui.p.ko))

e9.atui.p.ko<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.p.ko<-e9.atui.p.ko[order(e9.atui.p.ko$ID),]
e9.atui.p.ko<-as.matrix(t(e9.1.atui.p.ko))

e10.atui.p.ko<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.p.ko<-e10.atui.p.ko[order(e10.atui.p.ko$ID),]
e10.atui.p.ko<-as.matrix(t(e10.1.atui.p.ko))

energy.ko.atui.p.ko<-as.data.frame(matrix(c(e1.atui.p.ko,e2.atui.p.ko,e3.atui.p.ko,e4.atui.p.ko,e5.atui.p.ko,e6.atui.p.ko,e7.atui.p.ko,e8.atui.p.ko,e9.atui.p.ko,e10.atui.p.ko), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df.atui.p.ko<-data.frame(ID=energy.ko.atui.p.ko$V1,energy_over_distance=energy.ko.atui.p.ko$V2,energy_over_time=energy.ko.atui.p.ko$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.ko<-david1.atui.p.ko[order(david1.atui.p.ko$ID),]
david1.atui.p.ko<-as.matrix(t(david1.1.atui.p.ko))

david2.1.atui.p.ko<-david2.atui.p.ko[order(david2.atui.p.ko$ID),]
david2.atui.p.ko<-as.matrix(t(david2.1.atui.p.ko))

david3.1.atui.p.ko<-david3.atui.p.ko[order(david3.atui.p.ko$ID),]
david3.atui.p.ko<-as.matrix(t(david3.1.atui.p.ko))

david4.1.atui.p.ko<-david4.atui.p.ko[order(david4.atui.p.ko$ID),]
david4.atui.p.ko<-as.matrix(t(david4.1.atui.p.ko))

david5.1.atui.p.ko<-david5.atui.p.ko[order(david5.atui.p.ko$ID),]
david5.atui.p.ko<-as.matrix(t(david5.1.atui.p.ko))

david6.1.atui.p.ko<-david6.atui.p.ko[order(david6.atui.p.ko$ID),]
david6.atui.p.ko<-as.matrix(t(david6.1.atui.p.ko))

david7.1.atui.p.ko<-david7.atui.p.ko[order(david7.atui.p.ko$ID),]
david7.atui.p.ko<-as.matrix(t(david7.1.atui.p.ko))

david8.1.atui.p.ko<-david8.atui.p.ko[order(david8.atui.p.ko$ID),]
david8.atui.p.ko<-as.matrix(t(david8.1.atui.p.ko))

david9.1.atui.p.ko<-david9.atui.p.ko[order(david9.atui.p.ko$ID),]
david9.atui.p.ko<-as.matrix(t(david9.1.atui.p.ko))

david10.1.atui.p.ko<-david10.atui.p.ko[order(david10.atui.p.ko$ID),]
david10.atui.p.ko<-as.matrix(t(david10.1.atui.p.ko))

david.ko.atui.p.ko<-as.data.frame(matrix(c(david1.atui.p.ko,david2.atui.p.ko,david3.atui.p.ko,david4.atui.p.ko,david5.atui.p.ko,david6.atui.p.ko,david7.atui.p.ko,david8.atui.p.ko,david9.atui.p.ko,david10.atui.p.ko), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df.atui.p.ko<-data.frame(ID=david.ko.atui.p.ko$V1,DS=david.ko.atui.p.ko$V2,normDS=david.ko.atui.p.ko$V3)


# Calculate linear models and slopes for each individual run:
lm.ko.1.atui.p.ko<-lm(e1.1.atui.p.ko$energy_over_time~as.numeric(david1.1.atui.p.ko$normDS))
ko.lm.1.s.atui.p.ko<-summary(lm.ko.1.atui.p.ko)$coefficients
ko.1.slope.atui.p.ko<-ko.lm.1.s.atui.p.ko[2,1]
lm.ko.2.atui.p.ko<-lm(e2.1.atui.p.ko$energy_over_time~as.numeric(david2.1.atui.p.ko$normDS))
ko.lm.2.s.atui.p.ko<-summary(lm.ko.2.atui.p.ko)$coefficients
ko.2.slope.atui.p.ko<-ko.lm.2.s.atui.p.ko[2,1]
lm.ko.3.atui.p.ko<-lm(e3.1.atui.p.ko$energy_over_time~as.numeric(david3.1.atui.p.ko$normDS))
ko.lm.3.s.atui.p.ko<-summary(lm.ko.3.atui.p.ko)$coefficients
ko.3.slope.atui.p.ko<-ko.lm.3.s.atui.p.ko[2,1]
lm.ko.4.atui.p.ko<-lm(e4.1.atui.p.ko$energy_over_time~as.numeric(david4.1.atui.p.ko$normDS))
ko.lm.4.s.atui.p.ko<-summary(lm.ko.4.atui.p.ko)$coefficients
ko.4.slope.atui.p.ko<-ko.lm.4.s.atui.p.ko[2,1]
lm.ko.5.atui.p.ko<-lm(e5.1.atui.p.ko$energy_over_time~as.numeric(david5.1.atui.p.ko$normDS))
ko.lm.5.s.atui.p.ko<-summary(lm.ko.5.atui.p.ko)$coefficients
ko.5.slope.atui.p.ko<-ko.lm.5.s.atui.p.ko[2,1]
lm.ko.6.atui.p.ko<-lm(e6.1.atui.p.ko$energy_over_time~as.numeric(david6.1.atui.p.ko$normDS))
ko.lm.6.s.atui.p.ko<-summary(lm.ko.6.atui.p.ko)$coefficients
ko.6.slope.atui.p.ko<-ko.lm.6.s.atui.p.ko[2,1]
lm.ko.7.atui.p.ko<-lm(e7.1.atui.p.ko$energy_over_time~as.numeric(david7.1.atui.p.ko$normDS))
ko.lm.7.s.atui.p.ko<-summary(lm.ko.7.atui.p.ko)$coefficients
ko.7.slope.atui.p.ko<-ko.lm.7.s.atui.p.ko[2,1]
lm.ko.8.atui.p.ko<-lm(e8.1.atui.p.ko$energy_over_time~as.numeric(david8.1.atui.p.ko$normDS))
ko.lm.8.s.atui.p.ko<-summary(lm.ko.8.atui.p.ko)$coefficients
ko.8.slope.atui.p.ko<-ko.lm.8.s.atui.p.ko[2,1]
lm.ko.9.atui.p.ko<-lm(e9.1.atui.p.ko$energy_over_time~as.numeric(david9.1.atui.p.ko$normDS))
ko.lm.9.s.atui.p.ko<-summary(lm.ko.9.atui.p.ko)$coefficients
ko.9.slope.atui.p.ko<-ko.lm.9.s.atui.p.ko[2,1]
lm.ko.10.atui.p.ko<-lm(e10.1.atui.p.ko$energy_over_time~as.numeric(david10.1.atui.p.ko$normDS))
ko.lm.10.s.atui.p.ko<-summary(lm.ko.10.atui.p.ko)$coefficients
ko.10.slope.atui.p.ko<-ko.lm.10.s.atui.p.ko[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ko.atui.p.ss.attacks.atui.p.ko<-data.frame(triangle.transitivity=c(tri1.atui.p.ko,tri2.atui.p.ko,tri3.atui.p.ko,tri4.atui.p.ko,tri5.atui.p.ko,tri6.atui.p.ko,tri7.atui.p.ko,tri8.atui.p.ko,tri9.atui.p.ko,tri10.atui.p.ko),escalation=c(ep1.atui.p.ko,ep2.atui.p.ko,ep3.atui.p.ko,ep4.atui.p.ko,ep5.atui.p.ko,ep6.atui.p.ko,ep7.atui.p.ko,ep8.atui.p.ko,ep9.atui.p.ko,ep10.atui.p.ko),dci=c(dci1.atui.p.ko,dci2.atui.p.ko,dci3.atui.p.ko,dci4.atui.p.ko,dci5.atui.p.ko,dci6.atui.p.ko,dci7.atui.p.ko,dci8.atui.p.ko,dci9.atui.p.ko,dci10.atui.p.ko),steepness=c(s1.atui.p.ko,s2.atui.p.ko,s3.atui.p.ko,s4.atui.p.ko,s5.atui.p.ko,s6.atui.p.ko,s7.atui.p.ko,s8.atui.p.ko,s9.atui.p.ko,s10.atui.p.ko),slope=c(ko.1.slope.atui.p.ko,ko.2.slope.atui.p.ko,ko.3.slope.atui.p.ko,ko.4.slope.atui.p.ko,ko.5.slope.atui.p.ko,ko.6.slope.atui.p.ko,ko.7.slope.atui.p.ko,ko.8.slope.atui.p.ko,ko.9.slope.atui.p.ko,ko.10.slope.atui.p.ko))


#-------------------------------------------------------------------------------------------------------------------------

#History Mutual Uniform

# Data organization for the History Mutual Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.ui.p.hm<-sapply(files, read.csv)

# Generate attacks.ui.p.hm Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[1]],X2=attacks.ui.p.hm[[2]],Victories=attacks.ui.p.hm[[3]])

mut1.atui.p.hm<-mut1.atui.p.hm[c(1:90),]
mut1.atui.p.hm<-transform(mut1.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat1.atui.p.hm<-inter.mat(mut1.atui.p.hm)
tri1.atui.p.hm<-tr.tri(mat1.atui.p.hm)
dci1.atui.p.hm<-DCindex(mat1.atui.p.hm)
mat1.atui.p.hm[is.na(mat1.atui.p.hm)] = 0
h1.atui.p.hm<-h.index(mat1.atui.p.hm)

ep1.atui.p.hm<-ep(mut1.atui.p.hm,a1.ui.p.hm)
david1.atui.p.hm<-DS(mat1.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.hm<-cbind(ordrank.1.atui.p.hm,ds=david1.atui.p.hm$normDS)
lm1.atui.p.hm<-summary(lm(ordrank.1.atui.p.hm$ds~ordrank.1.atui.p.hm$ord.rank))
s1.atui.p.hm<-lm1.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[4]],X2=attacks.ui.p.hm[[5]],Victories=attacks.ui.p.hm[[6]])

mut2.atui.p.hm<-mut2.atui.p.hm[c(1:90),]
mut2.atui.p.hm<-transform(mut2.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat2.atui.p.hm<-inter.mat(mut2.atui.p.hm)
tri2.atui.p.hm<-tr.tri(mat2.atui.p.hm)
dci2.atui.p.hm<-DCindex(mat2.atui.p.hm)
mat2.atui.p.hm[is.na(mat2.atui.p.hm)] = 0
h2.atui.p.hm<-h.index(mat2.atui.p.hm)

ep2.atui.p.hm<-ep(mut2.atui.p.hm,a2.ui.p.hm)
david2.atui.p.hm<-DS(mat2.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.hm<-cbind(ordrank.2.atui.p.hm,ds=david2.atui.p.hm$normDS)
lm2.atui.p.hm<-summary(lm(ordrank.2.atui.p.hm$ds~ordrank.2.atui.p.hm$ord.rank))
s2.atui.p.hm<-lm2.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[7]],X2=attacks.ui.p.hm[[8]],Victories=attacks.ui.p.hm[[9]])

mut3.atui.p.hm<-mut3.atui.p.hm[c(1:90),]
mut3.atui.p.hm<-transform(mut3.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat3.atui.p.hm<-inter.mat(mut3.atui.p.hm)
tri3.atui.p.hm<-tr.tri(mat3.atui.p.hm)
dci3.atui.p.hm<-DCindex(mat3.atui.p.hm)
mat3.atui.p.hm[is.na(mat3.atui.p.hm)] = 0
h3.atui.p.hm<-h.index(mat3.atui.p.hm)

ep3.atui.p.hm<-ep(mut3.atui.p.hm,a3.ui.p.hm)
david3.atui.p.hm<-DS(mat3.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.hm<-cbind(ordrank.3.atui.p.hm,ds=david3.atui.p.hm$normDS)
lm3.atui.p.hm<-summary(lm(ordrank.3.atui.p.hm$ds~ordrank.3.atui.p.hm$ord.rank))
s3.atui.p.hm<-lm3.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[10]],X2=attacks.ui.p.hm[[11]],Victories=attacks.ui.p.hm[[12]])

mut4.atui.p.hm<-mut4.atui.p.hm[c(1:90),]
mut4.atui.p.hm<-transform(mut4.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat4.atui.p.hm<-inter.mat(mut4.atui.p.hm)
tri4.atui.p.hm<-tr.tri(mat4.atui.p.hm)
dci4.atui.p.hm<-DCindex(mat4.atui.p.hm)
mat4.atui.p.hm[is.na(mat4.atui.p.hm)] = 0
h4.atui.p.hm<-h.index(mat4.atui.p.hm)

ep4.atui.p.hm<-ep(mut4.atui.p.hm,a4.ui.p.hm)
david4.atui.p.hm<-DS(mat4.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.hm<-cbind(ordrank.4.atui.p.hm,ds=david4.atui.p.hm$normDS)
lm4.atui.p.hm<-summary(lm(ordrank.4.atui.p.hm$ds~ordrank.4.atui.p.hm$ord.rank))
s4.atui.p.hm<-lm4.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[13]],X2=attacks.ui.p.hm[[14]],Victories=attacks.ui.p.hm[[15]])

mut5.atui.p.hm<-mut5.atui.p.hm[c(1:90),]
mut5.atui.p.hm<-transform(mut5.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat5.atui.p.hm<-inter.mat(mut5.atui.p.hm)
tri5.atui.p.hm<-tr.tri(mat5.atui.p.hm)
dci5.atui.p.hm<-DCindex(mat5.atui.p.hm)
mat5.atui.p.hm[is.na(mat5.atui.p.hm)] = 0
h5.atui.p.hm<-h.index(mat5.atui.p.hm)

ep5.atui.p.hm<-ep(mut5.atui.p.hm,a5.ui.p.hm)
david5.atui.p.hm<-DS(mat5.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.hm<-cbind(ordrank.5.atui.p.hm,ds=david5.atui.p.hm$normDS)
lm5.atui.p.hm<-summary(lm(ordrank.5.atui.p.hm$ds~ordrank.5.atui.p.hm$ord.rank))
s5.atui.p.hm<-lm5.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[16]],X2=attacks.ui.p.hm[[17]],Victories=attacks.ui.p.hm[[18]])

mut6.atui.p.hm<-mut6.atui.p.hm[c(1:90),]
mut6.atui.p.hm<-transform(mut6.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat6.atui.p.hm<-inter.mat(mut6.atui.p.hm)
tri6.atui.p.hm<-tr.tri(mat6.atui.p.hm)
dci6.atui.p.hm<-DCindex(mat6.atui.p.hm)
mat6.atui.p.hm[is.na(mat6.atui.p.hm)] = 0
h6.atui.p.hm<-h.index(mat6.atui.p.hm)

ep6.atui.p.hm<-ep(mut6.atui.p.hm,a6.ui.p.hm)
david6.atui.p.hm<-DS(mat6.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.hm<-cbind(ordrank.6.atui.p.hm,ds=david6.atui.p.hm$normDS)
lm6.atui.p.hm<-summary(lm(ordrank.6.atui.p.hm$ds~ordrank.6.atui.p.hm$ord.rank))
s6.atui.p.hm<-lm6.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[19]],X2=attacks.ui.p.hm[[20]],Victories=attacks.ui.p.hm[[21]])

mut7.atui.p.hm<-mut7.atui.p.hm[c(1:90),]
mut7.atui.p.hm<-transform(mut7.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat7.atui.p.hm<-inter.mat(mut7.atui.p.hm)
tri7.atui.p.hm<-tr.tri(mat7.atui.p.hm)
dci7.atui.p.hm<-DCindex(mat7.atui.p.hm)
mat7.atui.p.hm[is.na(mat7.atui.p.hm)] = 0
h7.atui.p.hm<-h.index(mat7.atui.p.hm)

ep7.atui.p.hm<-ep(mut7.atui.p.hm,a7.ui.p.hm)
david7.atui.p.hm<-DS(mat7.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.hm<-cbind(ordrank.7.atui.p.hm,ds=david7.atui.p.hm$normDS)
lm7.atui.p.hm<-summary(lm(ordrank.7.atui.p.hm$ds~ordrank.7.atui.p.hm$ord.rank))
s7.atui.p.hm<-lm7.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[22]],X2=attacks.ui.p.hm[[23]],Victories=attacks.ui.p.hm[[24]])

mut8.atui.p.hm<-mut8.atui.p.hm[c(1:90),]
mut8.atui.p.hm<-transform(mut8.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat8.atui.p.hm<-inter.mat(mut8.atui.p.hm)
tri8.atui.p.hm<-tr.tri(mat8.atui.p.hm)
dci8.atui.p.hm<-DCindex(mat8.atui.p.hm)
mat8.atui.p.hm[is.na(mat8.atui.p.hm)] = 0
h8.atui.p.hm<-h.index(mat8.atui.p.hm)

ep8.atui.p.hm<-ep(mut8.atui.p.hm,a8.ui.p.hm)
david8.atui.p.hm<-DS(mat8.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.hm<-cbind(ordrank.8.atui.p.hm,ds=david8.atui.p.hm$normDS)
lm8.atui.p.hm<-summary(lm(ordrank.8.atui.p.hm$ds~ordrank.8.atui.p.hm$ord.rank))
s8.atui.p.hm<-lm8.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[25]],X2=attacks.ui.p.hm[[26]],Victories=attacks.ui.p.hm[[27]])

mut9.atui.p.hm<-mut9.atui.p.hm[c(1:90),]
mut9.atui.p.hm<-transform(mut9.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat9.atui.p.hm<-inter.mat(mut9.atui.p.hm)
tri9.atui.p.hm<-tr.tri(mat9.atui.p.hm)
dci9.atui.p.hm<-DCindex(mat9.atui.p.hm)
mat9.atui.p.hm[is.na(mat9.atui.p.hm)] = 0
h9.atui.p.hm<-h.index(mat9.atui.p.hm)

ep9.atui.p.hm<-ep(mut9.atui.p.hm,a9.ui.p.hm)
david9.atui.p.hm<-DS(mat9.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.hm<-cbind(ordrank.9.atui.p.hm,ds=david9.atui.p.hm$normDS)
lm9.atui.p.hm<-summary(lm(ordrank.9.atui.p.hm$ds~ordrank.9.atui.p.hm$ord.rank))
s9.atui.p.hm<-lm9.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.hm<-data.frame(X1=attacks.ui.p.hm[[28]],X2=attacks.ui.p.hm[[29]],Victories=attacks.ui.p.hm[[30]])

mut10.atui.p.hm<-mut10.atui.p.hm[c(1:90),]
mut10.atui.p.hm<-transform(mut10.atui.p.hm,X1=as.numeric(X1),X2=as.numeric(X2),Victories=as.numeric(Victories))

mat10.atui.p.hm<-inter.mat(mut10.atui.p.hm)
tri10.atui.p.hm<-tr.tri(mat10.atui.p.hm)
dci10.atui.p.hm<-DCindex(mat10.atui.p.hm)
mat10.atui.p.hm[is.na(mat10.atui.p.hm)] = 0
h10.atui.p.hm<-h.index(mat10.atui.p.hm)

ep10.atui.p.hm<-ep(mut10.atui.p.hm,a10.ui.p.hm)
david10.atui.p.hm<-DS(mat10.atui.p.hm) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.hm<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.hm<-cbind(ordrank.10.atui.p.hm,ds=david10.atui.p.hm$normDS)
lm10.atui.p.hm<-summary(lm(ordrank.10.atui.p.hm$ds~ordrank.10.atui.p.hm$ord.rank))
s10.atui.p.hm<-lm10.atui.p.hm$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.hm<-sum(mut1.atui.p.hm$Victories)
int2.atui.p.hm<-sum(mut2.atui.p.hm$Victories)
int3.atui.p.hm<-sum(mut3.atui.p.hm$Victories)
int4.atui.p.hm<-sum(mut4.atui.p.hm$Victories)
int5.atui.p.hm<-sum(mut5.atui.p.hm$Victories)
int6.atui.p.hm<-sum(mut6.atui.p.hm$Victories)
int7.atui.p.hm<-sum(mut7.atui.p.hm$Victories)
int8.atui.p.hm<-sum(mut8.atui.p.hm$Victories)
int9.atui.p.hm<-sum(mut9.atui.p.hm$Victories)
int10.atui.p.hm<-sum(mut10.atui.p.hm$Victories)

  # Summarize the avoidances in each trial (each file has the same naming convention, so avoidances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.hm<-sum(a1.ui.p.hm$Victories)
av2.atui.p.hm<-sum(a2.ui.p.hm$Victories)
av3.atui.p.hm<-sum(a3.ui.p.hm$Victories)
av4.atui.p.hm<-sum(a4.ui.p.hm$Victories)
av5.atui.p.hm<-sum(a5.ui.p.hm$Victories)
av6.atui.p.hm<-sum(a6.ui.p.hm$Victories)
av7.atui.p.hm<-sum(a7.ui.p.hm$Victories)
av8.atui.p.hm<-sum(a8.ui.p.hm$Victories)
av9.atui.p.hm<-sum(a9.ui.p.hm$Victories)
av10.atui.p.hm<-sum(a10.ui.p.hm$Victories)

  # Calculate the average number of avoidances across trials:
avg.av.hm.atiu.p<-(sum(av1.atui.p.hm, av2.atui.p.hm, av3.atui.p.hm, av4.atui.p.hm, av5.atui.p.hm, av6.atui.p.hm, av7.atui.p.hm, av8.atui.p.hm, av9.atui.p.hm, av10.atui.p.hm))/10

  # Calculate the average number of victories across trials:
avg.int.hm.atiu.p<-(sum(int1.atui.p.hm, int2.atui.p.hm, int3.atui.p.hm, int4.atui.p.hm, int5.atui.p.hm, int6.atui.p.hm, int7.atui.p.hm, int8.atui.p.hm, int9.atui.p.hm, int10.atui.p.hm))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hm.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.hm<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.atui.p.hm<-e1.atui.p.hm[c(1:10),]
e1.atui.p.hm<-transform(e1.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e1.1.atui.p.hm<-e1.atui.p.hm[order(e1.atui.p.hm$ID),]
e1.atui.p.hm<-as.matrix(t(e1.1.atui.p.hm))

e2.atui.p.hm<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.atui.p.hm<-e2.atui.p.hm[c(1:10),]
e2.atui.p.hm<-transform(e2.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e2.1.atui.p.hm<-e2.atui.p.hm[order(e2.atui.p.hm$ID),]
e2.atui.p.hm<-as.matrix(t(e2.1.atui.p.hm))

e3.atui.p.hm<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.atui.p.hm<-e3.atui.p.hm[c(1:10),]
e3.atui.p.hm<-transform(e3.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e3.1.atui.p.hm<-e3.atui.p.hm[order(e3.atui.p.hm$ID),]
e3.atui.p.hm<-as.matrix(t(e3.1.atui.p.hm))

e4.atui.p.hm<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.atui.p.hm<-e4.atui.p.hm[c(1:10),]
e4.atui.p.hm<-transform(e4.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e4.1.atui.p.hm<-e4.atui.p.hm[order(e4.atui.p.hm$ID),]
e4.atui.p.hm<-as.matrix(t(e4.1.atui.p.hm))

e5.atui.p.hm<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.atui.p.hm<-e5.atui.p.hm[c(1:10),]
e5.atui.p.hm<-transform(e5.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e5.1.atui.p.hm<-e5.atui.p.hm[order(e5.atui.p.hm$ID),]
e5.atui.p.hm<-as.matrix(t(e5.1.atui.p.hm))

e6.atui.p.hm<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.atui.p.hm<-e6.atui.p.hm[c(1:10),]
e6.atui.p.hm<-transform(e6.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e6.1.atui.p.hm<-e6.atui.p.hm[order(e6.atui.p.hm$ID),]
e6.atui.p.hm<-as.matrix(t(e6.1.atui.p.hm))

e7.atui.p.hm<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.atui.p.hm<-e7.atui.p.hm[c(1:10),]
e7.atui.p.hm<-transform(e7.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e7.1.atui.p.hm<-e7.atui.p.hm[order(e7.atui.p.hm$ID),]
e7.atui.p.hm<-as.matrix(t(e7.1.atui.p.hm))

e8.atui.p.hm<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.atui.p.hm<-e8.atui.p.hm[c(1:10),]
e8.atui.p.hm<-transform(e8.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e8.1.atui.p.hm<-e8.atui.p.hm[order(e8.atui.p.hm$ID),]
e8.atui.p.hm<-as.matrix(t(e8.1.atui.p.hm))

e9.atui.p.hm<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.atui.p.hm<-e9.atui.p.hm[c(1:10),]
e9.atui.p.hm<-transform(e9.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e9.1.atui.p.hm<-e9.atui.p.hm[order(e9.atui.p.hm$ID),]
e9.atui.p.hm<-as.matrix(t(e9.1.atui.p.hm))

e10.atui.p.hm<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.atui.p.hm<-e10.atui.p.hm[c(1:10),]
e10.atui.p.hm<-transform(e10.atui.p.hm,ID=as.numeric(ID),energy_over_distance=as.numeric(energy_over_distance),energy_over_time=as.numeric(energy_over_time))
e10.1.atui.p.hm<-e10.atui.p.hm[order(e10.atui.p.hm$ID),]
e10.atui.p.hm<-as.matrix(t(e10.1.atui.p.hm))

energy.hm.atui.p.hm<-as.data.frame(matrix(c(e1.atui.p.hm,e2.atui.p.hm,e3.atui.p.hm,e4.atui.p.hm,e5.atui.p.hm,e6.atui.p.hm,e7.atui.p.hm,e8.atui.p.hm,e9.atui.p.hm,e10.atui.p.hm), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df.atui.p.hm<-data.frame(ID=energy.hm.atui.p.hm$V1,energy_over_distance=energy.hm.atui.p.hm$V2,energy_over_time=energy.hm.atui.p.hm$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.hm<-david1.atui.p.hm[order(david1.atui.p.hm$ID),]
david1.atui.p.hm<-as.matrix(t(david1.1.atui.p.hm))

david2.1.atui.p.hm<-david2.atui.p.hm[order(david2.atui.p.hm$ID),]
david2.atui.p.hm<-as.matrix(t(david2.1.atui.p.hm))

david3.1.atui.p.hm<-david3.atui.p.hm[order(david3.atui.p.hm$ID),]
david3.atui.p.hm<-as.matrix(t(david3.1.atui.p.hm))

david4.1.atui.p.hm<-david4.atui.p.hm[order(david4.atui.p.hm$ID),]
david4.atui.p.hm<-as.matrix(t(david4.1.atui.p.hm))

david5.1.atui.p.hm<-david5.atui.p.hm[order(david5.atui.p.hm$ID),]
david5.atui.p.hm<-as.matrix(t(david5.1.atui.p.hm))

david6.1.atui.p.hm<-david6.atui.p.hm[order(david6.atui.p.hm$ID),]
david6.atui.p.hm<-as.matrix(t(david6.1.atui.p.hm))

david7.1.atui.p.hm<-david7.atui.p.hm[order(david7.atui.p.hm$ID),]
david7.atui.p.hm<-as.matrix(t(david7.1.atui.p.hm))

david8.1.atui.p.hm<-david8.atui.p.hm[order(david8.atui.p.hm$ID),]
david8.atui.p.hm<-as.matrix(t(david8.1.atui.p.hm))

david9.1.atui.p.hm<-david9.atui.p.hm[order(david9.atui.p.hm$ID),]
david9.atui.p.hm<-as.matrix(t(david9.1.atui.p.hm))

david10.1.atui.p.hm<-david10.atui.p.hm[order(david10.atui.p.hm$ID),]
david10.atui.p.hm<-as.matrix(t(david10.1.atui.p.hm))

david.hm.atui.p.hm<-as.data.frame(matrix(c(david1.atui.p.hm,david2.atui.p.hm,david3.atui.p.hm,david4.atui.p.hm,david5.atui.p.hm,david6.atui.p.hm,david7.atui.p.hm,david8.atui.p.hm,david9.atui.p.hm,david10.atui.p.hm), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df.atui.p.hm<-data.frame(ID=david.hm.atui.p.hm$V1,DS=david.hm.atui.p.hm$V2,normDS=david.hm.atui.p.hm$V3)


# Calculate linear models and slopes for each individual run:
lm.hm.1.atui.p.hm<-lm(e1.1.atui.p.hm$energy_over_time~as.numeric(david1.1.atui.p.hm$normDS))
hm.lm.1.s.atui.p.hm<-summary(lm.hm.1.atui.p.hm)$coefficients
hm.1.slope.atui.p.hm<-hm.lm.1.s.atui.p.hm[2,1]
lm.hm.2.atui.p.hm<-lm(e2.1.atui.p.hm$energy_over_time~as.numeric(david2.1.atui.p.hm$normDS))
hm.lm.2.s.atui.p.hm<-summary(lm.hm.2.atui.p.hm)$coefficients
hm.2.slope.atui.p.hm<-hm.lm.2.s.atui.p.hm[2,1]
lm.hm.3.atui.p.hm<-lm(e3.1.atui.p.hm$energy_over_time~as.numeric(david3.1.atui.p.hm$normDS))
hm.lm.3.s.atui.p.hm<-summary(lm.hm.3.atui.p.hm)$coefficients
hm.3.slope.atui.p.hm<-hm.lm.3.s.atui.p.hm[2,1]
lm.hm.4.atui.p.hm<-lm(e4.1.atui.p.hm$energy_over_time~as.numeric(david4.1.atui.p.hm$normDS))
hm.lm.4.s.atui.p.hm<-summary(lm.hm.4.atui.p.hm)$coefficients
hm.4.slope.atui.p.hm<-hm.lm.4.s.atui.p.hm[2,1]
lm.hm.5.atui.p.hm<-lm(e5.1.atui.p.hm$energy_over_time~as.numeric(david5.1.atui.p.hm$normDS))
hm.lm.5.s.atui.p.hm<-summary(lm.hm.5.atui.p.hm)$coefficients
hm.5.slope.atui.p.hm<-hm.lm.5.s.atui.p.hm[2,1]
lm.hm.6.atui.p.hm<-lm(e6.1.atui.p.hm$energy_over_time~as.numeric(david6.1.atui.p.hm$normDS))
hm.lm.6.s.atui.p.hm<-summary(lm.hm.6.atui.p.hm)$coefficients
hm.6.slope.atui.p.hm<-hm.lm.6.s.atui.p.hm[2,1]
lm.hm.7.atui.p.hm<-lm(e7.1.atui.p.hm$energy_over_time~as.numeric(david7.1.atui.p.hm$normDS))
hm.lm.7.s.atui.p.hm<-summary(lm.hm.7.atui.p.hm)$coefficients
hm.7.slope.atui.p.hm<-hm.lm.7.s.atui.p.hm[2,1]
lm.hm.8.atui.p.hm<-lm(e8.1.atui.p.hm$energy_over_time~as.numeric(david8.1.atui.p.hm$normDS))
hm.lm.8.s.atui.p.hm<-summary(lm.hm.8.atui.p.hm)$coefficients
hm.8.slope.atui.p.hm<-hm.lm.8.s.atui.p.hm[2,1]
lm.hm.9.atui.p.hm<-lm(e9.1.atui.p.hm$energy_over_time~as.numeric(david9.1.atui.p.hm$normDS))
hm.lm.9.s.atui.p.hm<-summary(lm.hm.9.atui.p.hm)$coefficients
hm.9.slope.atui.p.hm<-hm.lm.9.s.atui.p.hm[2,1]
lm.hm.10.atui.p.hm<-lm(e10.1.atui.p.hm$energy_over_time~as.numeric(david10.1.atui.p.hm$normDS))
hm.lm.10.s.atui.p.hm<-summary(lm.hm.10.atui.p.hm)$coefficients
hm.10.slope.atui.p.hm<-hm.lm.10.s.atui.p.hm[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hm.atui.p.ss.attacks.atui.p.hm<-data.frame(triangle.transitivity=c(tri1.atui.p.hm,tri2.atui.p.hm,tri3.atui.p.hm,tri4.atui.p.hm,tri5.atui.p.hm,tri6.atui.p.hm,tri7.atui.p.hm,tri8.atui.p.hm,tri9.atui.p.hm,tri10.atui.p.hm),escalation=c(ep1.atui.p.hm,ep2.atui.p.hm,ep3.atui.p.hm,ep4.atui.p.hm,ep5.atui.p.hm,ep6.atui.p.hm,ep7.atui.p.hm,ep8.atui.p.hm,ep9.atui.p.hm,ep10.atui.p.hm),dci=c(dci1.atui.p.hm,dci2.atui.p.hm,dci3.atui.p.hm,dci4.atui.p.hm,dci5.atui.p.hm,dci6.atui.p.hm,dci7.atui.p.hm,dci8.atui.p.hm,dci9.atui.p.hm,dci10.atui.p.hm),steepness=c(s1.atui.p.hm,s2.atui.p.hm,s3.atui.p.hm,s4.atui.p.hm,s5.atui.p.hm,s6.atui.p.hm,s7.atui.p.hm,s8.atui.p.hm,s9.atui.p.hm,s10.atui.p.hm),slope=c(hm.1.slope.atui.p.hm,hm.2.slope.atui.p.hm,hm.3.slope.atui.p.hm,hm.4.slope.atui.p.hm,hm.5.slope.atui.p.hm,hm.6.slope.atui.p.hm,hm.7.slope.atui.p.hm,hm.8.slope.atui.p.hm,hm.9.slope.atui.p.hm,hm.10.slope.atui.p.hm))


#-------------------------------------------------------------------------------------------------------------------------

#History Self Uniform

# Data organization for the History Self Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.p.hs<-sapply(files, read.csv)

# Generate attacks.atui.p.hs Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[1]],X2=attacks.atui.p.hs[[2]],Victories=attacks.atui.p.hs[[3]])
mat1.atui.p.hs<-inter.mat(mut1.atui.p.hs)
tri1.atui.p.hs<-tr.tri(mat1.atui.p.hs)
dci1.atui.p.hs<-DCindex(mat1.atui.p.hs)
mat1.atui.p.hs[is.na(mat1.atui.p.hs)] = 0
h1.atui.p.hs<-h.index(mat1.atui.p.hs)

ep1.atui.p.hs<-ep(mut1.atui.p.hs,a1.ui.p.hs)
david1.atui.p.hs<-DS(mat1.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.hs<-cbind(ordrank.1.atui.p.hs,ds=david1.atui.p.hs$normDS)
lm1.atui.p.hs<-summary(lm(ordrank.1.atui.p.hs$ds~ordrank.1.atui.p.hs$ord.rank))
s1.atui.p.hs<-lm1.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[4]],X2=attacks.atui.p.hs[[5]],Victories=attacks.atui.p.hs[[6]])
mat2.atui.p.hs<-inter.mat(mut2.atui.p.hs)
tri2.atui.p.hs<-tr.tri(mat2.atui.p.hs)
dci2.atui.p.hs<-DCindex(mat2.atui.p.hs)
mat2.atui.p.hs[is.na(mat2.atui.p.hs)] = 0
h2.atui.p.hs<-h.index(mat2.atui.p.hs)

ep2.atui.p.hs<-ep(mut2.atui.p.hs,a2.ui.p.hs)
david2.atui.p.hs<-DS(mat2.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.hs<-cbind(ordrank.2.atui.p.hs,ds=david2.atui.p.hs$normDS)
lm2.atui.p.hs<-summary(lm(ordrank.2.atui.p.hs$ds~ordrank.2.atui.p.hs$ord.rank))
s2.atui.p.hs<-lm2.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[7]],X2=attacks.atui.p.hs[[8]],Victories=attacks.atui.p.hs[[9]])
mat3.atui.p.hs<-inter.mat(mut3.atui.p.hs)
tri3.atui.p.hs<-tr.tri(mat3.atui.p.hs)
dci3.atui.p.hs<-DCindex(mat3.atui.p.hs)
mat3.atui.p.hs[is.na(mat3.atui.p.hs)] = 0
h3.atui.p.hs<-h.index(mat3.atui.p.hs)

ep3.atui.p.hs<-ep(mut3.atui.p.hs,a3.ui.p.hs)
david3.atui.p.hs<-DS(mat3.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.hs<-cbind(ordrank.3.atui.p.hs,ds=david3.atui.p.hs$normDS)
lm3.atui.p.hs<-summary(lm(ordrank.3.atui.p.hs$ds~ordrank.3.atui.p.hs$ord.rank))
s3.atui.p.hs<-lm3.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[10]],X2=attacks.atui.p.hs[[11]],Victories=attacks.atui.p.hs[[12]])
mat4.atui.p.hs<-inter.mat(mut4.atui.p.hs)
tri4.atui.p.hs<-tr.tri(mat4.atui.p.hs)
dci4.atui.p.hs<-DCindex(mat4.atui.p.hs)
mat4.atui.p.hs[is.na(mat4.atui.p.hs)] = 0
h4.atui.p.hs<-h.index(mat4.atui.p.hs)

ep4.atui.p.hs<-ep(mut4.atui.p.hs,a4.ui.p.hs)
david4.atui.p.hs<-DS(mat4.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.hs<-cbind(ordrank.4.atui.p.hs,ds=david4.atui.p.hs$normDS)
lm4.atui.p.hs<-summary(lm(ordrank.4.atui.p.hs$ds~ordrank.4.atui.p.hs$ord.rank))
s4.atui.p.hs<-lm4.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[13]],X2=attacks.atui.p.hs[[14]],Victories=attacks.atui.p.hs[[15]])
mat5.atui.p.hs<-inter.mat(mut5.atui.p.hs)
tri5.atui.p.hs<-tr.tri(mat5.atui.p.hs)
dci5.atui.p.hs<-DCindex(mat5.atui.p.hs)
mat5.atui.p.hs[is.na(mat5.atui.p.hs)] = 0
h5.atui.p.hs<-h.index(mat5.atui.p.hs)

ep5.atui.p.hs<-ep(mut5.atui.p.hs,a5.ui.p.hs)
david5.atui.p.hs<-DS(mat5.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.hs<-cbind(ordrank.5.atui.p.hs,ds=david5.atui.p.hs$normDS)
lm5.atui.p.hs<-summary(lm(ordrank.5.atui.p.hs$ds~ordrank.5.atui.p.hs$ord.rank))
s5.atui.p.hs<-lm5.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[16]],X2=attacks.atui.p.hs[[17]],Victories=attacks.atui.p.hs[[18]])
mat6.atui.p.hs<-inter.mat(mut6.atui.p.hs)
tri6.atui.p.hs<-tr.tri(mat6.atui.p.hs)
dci6.atui.p.hs<-DCindex(mat6.atui.p.hs)
mat6.atui.p.hs[is.na(mat6.atui.p.hs)] = 0
h6.atui.p.hs<-h.index(mat6.atui.p.hs)

ep6.atui.p.hs<-ep(mut6.atui.p.hs,a6.ui.p.hs)
david6.atui.p.hs<-DS(mat6.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.hs<-cbind(ordrank.6.atui.p.hs,ds=david6.atui.p.hs$normDS)
lm6.atui.p.hs<-summary(lm(ordrank.6.atui.p.hs$ds~ordrank.6.atui.p.hs$ord.rank))
s6.atui.p.hs<-lm6.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[19]],X2=attacks.atui.p.hs[[20]],Victories=attacks.atui.p.hs[[21]])
mat7.atui.p.hs<-inter.mat(mut7.atui.p.hs)
tri7.atui.p.hs<-tr.tri(mat7.atui.p.hs)
dci7.atui.p.hs<-DCindex(mat7.atui.p.hs)
mat7.atui.p.hs[is.na(mat7.atui.p.hs)] = 0
h7.atui.p.hs<-h.index(mat7.atui.p.hs)

ep7.atui.p.hs<-ep(mut7.atui.p.hs,a7.ui.p.hs)
david7.atui.p.hs<-DS(mat7.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.hs<-cbind(ordrank.7.atui.p.hs,ds=david7.atui.p.hs$normDS)
lm7.atui.p.hs<-summary(lm(ordrank.7.atui.p.hs$ds~ordrank.7.atui.p.hs$ord.rank))
s7.atui.p.hs<-lm7.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[22]],X2=attacks.atui.p.hs[[23]],Victories=attacks.atui.p.hs[[24]])
mat8.atui.p.hs<-inter.mat(mut8.atui.p.hs)
tri8.atui.p.hs<-tr.tri(mat8.atui.p.hs)
dci8.atui.p.hs<-DCindex(mat8.atui.p.hs)
mat8.atui.p.hs[is.na(mat8.atui.p.hs)] = 0
h8.atui.p.hs<-h.index(mat8.atui.p.hs)

ep8.atui.p.hs<-ep(mut8.atui.p.hs,a8.ui.p.hs)
david8.atui.p.hs<-DS(mat8.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.hs<-cbind(ordrank.8.atui.p.hs,ds=david8.atui.p.hs$normDS)
lm8.atui.p.hs<-summary(lm(ordrank.8.atui.p.hs$ds~ordrank.8.atui.p.hs$ord.rank))
s8.atui.p.hs<-lm8.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[25]],X2=attacks.atui.p.hs[[26]],Victories=attacks.atui.p.hs[[27]])
mat9.atui.p.hs<-inter.mat(mut9.atui.p.hs)
tri9.atui.p.hs<-tr.tri(mat9.atui.p.hs)
dci9.atui.p.hs<-DCindex(mat9.atui.p.hs)
mat9.atui.p.hs[is.na(mat9.atui.p.hs)] = 0
h9.atui.p.hs<-h.index(mat9.atui.p.hs)

ep9.atui.p.hs<-ep(mut9.atui.p.hs,a9.ui.p.hs)
david9.atui.p.hs<-DS(mat9.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.hs<-cbind(ordrank.9.atui.p.hs,ds=david9.atui.p.hs$normDS)
lm9.atui.p.hs<-summary(lm(ordrank.9.atui.p.hs$ds~ordrank.9.atui.p.hs$ord.rank))
s9.atui.p.hs<-lm9.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.hs<-data.frame(X1=attacks.atui.p.hs[[28]],X2=attacks.atui.p.hs[[29]],Victories=attacks.atui.p.hs[[30]])
mat10.atui.p.hs<-inter.mat(mut10.atui.p.hs)
tri10.atui.p.hs<-tr.tri(mat10.atui.p.hs)
dci10.atui.p.hs<-DCindex(mat10.atui.p.hs)
mat10.atui.p.hs[is.na(mat10.atui.p.hs)] = 0
h10.atui.p.hs<-h.index(mat10.atui.p.hs)

ep10.atui.p.hs<-ep(mut10.atui.p.hs,a10.ui.p.hs)
david10.atui.p.hs<-DS(mat10.atui.p.hs) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.hs<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.hs<-cbind(ordrank.10.atui.p.hs,ds=david10.atui.p.hs$normDS)
lm10.atui.p.hs<-summary(lm(ordrank.10.atui.p.hs$ds~ordrank.10.atui.p.hs$ord.rank))
s10.atui.p.hs<-lm10.atui.p.hs$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.hs<-sum(mut1.atui.p.hs$Victories)
int2.atui.p.hs<-sum(mut2.atui.p.hs$Victories)
int3.atui.p.hs<-sum(mut3.atui.p.hs$Victories)
int4.atui.p.hs<-sum(mut4.atui.p.hs$Victories)
int5.atui.p.hs<-sum(mut5.atui.p.hs$Victories)
int6.atui.p.hs<-sum(mut6.atui.p.hs$Victories)
int7.atui.p.hs<-sum(mut7.atui.p.hs$Victories)
int8.atui.p.hs<-sum(mut8.atui.p.hs$Victories)
int9.atui.p.hs<-sum(mut9.atui.p.hs$Victories)
int10.atui.p.hs<-sum(mut10.atui.p.hs$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.hs<-sum(a1.ui.p.hs$Victories)
av2.atui.p.hs<-sum(a2.ui.p.hs$Victories)
av3.atui.p.hs<-sum(a3.ui.p.hs$Victories)
av4.atui.p.hs<-sum(a4.ui.p.hs$Victories)
av5.atui.p.hs<-sum(a5.ui.p.hs$Victories)
av6.atui.p.hs<-sum(a6.ui.p.hs$Victories)
av7.atui.p.hs<-sum(a7.ui.p.hs$Victories)
av8.atui.p.hs<-sum(a8.ui.p.hs$Victories)
av9.atui.p.hs<-sum(a9.ui.p.hs$Victories)
av10.atui.p.hs<-sum(a10.ui.p.hs$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.hs.atiu.p<-(sum(av1.atui.p.hs, av2.atui.p.hs, av3.atui.p.hs, av4.atui.p.hs, av5.atui.p.hs, av6.atui.p.hs, av7.atui.p.hs, av8.atui.p.hs, av9.atui.p.hs, av10.atui.p.hs))/10

  # Calculate the average number of victories across trials:
avg.int.hs.atiu.p<-(sum(int1.atui.p.hs, int2.atui.p.hs, int3.atui.p.hs, int4.atui.p.hs, int5.atui.p.hs, int6.atui.p.hs, int7.atui.p.hs, int8.atui.p.hs, int9.atui.p.hs, int10.atui.p.hs))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/hs.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.hs<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.p.hs<-e1.atui.p.hs[order(e1.atui.p.hs$ID),]
e1.atui.p.hs<-as.matrix(t(e1.1.atui.p.hs))

e2.atui.p.hs<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.p.hs<-e2.atui.p.hs[order(e2.atui.p.hs$ID),]
e2.atui.p.hs<-as.matrix(t(e2.1.atui.p.hs))

e3.atui.p.hs<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.p.hs<-e3.atui.p.hs[order(e3.atui.p.hs$ID),]
e3.atui.p.hs<-as.matrix(t(e3.1.atui.p.hs))

e4.atui.p.hs<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.p.hs<-e4.atui.p.hs[order(e4.atui.p.hs$ID),]
e4.atui.p.hs<-as.matrix(t(e4.1.atui.p.hs))

e5.atui.p.hs<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.p.hs<-e5.atui.p.hs[order(e5.atui.p.hs$ID),]
e5.atui.p.hs<-as.matrix(t(e5.1.atui.p.hs))

e6.atui.p.hs<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.p.hs<-e6.atui.p.hs[order(e6.atui.p.hs$ID),]
e6.atui.p.hs<-as.matrix(t(e6.1.atui.p.hs))

e7.atui.p.hs<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.p.hs<-e7.atui.p.hs[order(e7.atui.p.hs$ID),]
e7.atui.p.hs<-as.matrix(t(e7.1.atui.p.hs))

e8.atui.p.hs<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.p.hs<-e8.atui.p.hs[order(e8.atui.p.hs$ID),]
e8.atui.p.hs<-as.matrix(t(e8.1.atui.p.hs))

e9.atui.p.hs<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.p.hs<-e9.atui.p.hs[order(e9.atui.p.hs$ID),]
e9.atui.p.hs<-as.matrix(t(e9.1.atui.p.hs))

e10.atui.p.hs<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.p.hs<-e10.atui.p.hs[order(e10.atui.p.hs$ID),]
e10.atui.p.hs<-as.matrix(t(e10.1.atui.p.hs))

energy.hs.atui.p.hs<-as.data.frame(matrix(c(e1.atui.p.hs,e2.atui.p.hs,e3.atui.p.hs,e4.atui.p.hs,e5.atui.p.hs,e6.atui.p.hs,e7.atui.p.hs,e8.atui.p.hs,e9.atui.p.hs,e10.atui.p.hs), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df.atui.p.hs<-data.frame(ID=energy.hs.atui.p.hs$V1,energy_over_distance=energy.hs.atui.p.hs$V2,energy_over_time=energy.hs.atui.p.hs$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.hs<-david1.atui.p.hs[order(david1.atui.p.hs$ID),]
david1.atui.p.hs<-as.matrix(t(david1.1.atui.p.hs))

david2.1.atui.p.hs<-david2.atui.p.hs[order(david2.atui.p.hs$ID),]
david2.atui.p.hs<-as.matrix(t(david2.1.atui.p.hs))

david3.1.atui.p.hs<-david3.atui.p.hs[order(david3.atui.p.hs$ID),]
david3.atui.p.hs<-as.matrix(t(david3.1.atui.p.hs))

david4.1.atui.p.hs<-david4.atui.p.hs[order(david4.atui.p.hs$ID),]
david4.atui.p.hs<-as.matrix(t(david4.1.atui.p.hs))

david5.1.atui.p.hs<-david5.atui.p.hs[order(david5.atui.p.hs$ID),]
david5.atui.p.hs<-as.matrix(t(david5.1.atui.p.hs))

david6.1.atui.p.hs<-david6.atui.p.hs[order(david6.atui.p.hs$ID),]
david6.atui.p.hs<-as.matrix(t(david6.1.atui.p.hs))

david7.1.atui.p.hs<-david7.atui.p.hs[order(david7.atui.p.hs$ID),]
david7.atui.p.hs<-as.matrix(t(david7.1.atui.p.hs))

david8.1.atui.p.hs<-david8.atui.p.hs[order(david8.atui.p.hs$ID),]
david8.atui.p.hs<-as.matrix(t(david8.1.atui.p.hs))

david9.1.atui.p.hs<-david9.atui.p.hs[order(david9.atui.p.hs$ID),]
david9.atui.p.hs<-as.matrix(t(david9.1.atui.p.hs))

david10.1.atui.p.hs<-david10.atui.p.hs[order(david10.atui.p.hs$ID),]
david10.atui.p.hs<-as.matrix(t(david10.1.atui.p.hs))

david.hs.atui.p.hs<-as.data.frame(matrix(c(david1.atui.p.hs,david2.atui.p.hs,david3.atui.p.hs,david4.atui.p.hs,david5.atui.p.hs,david6.atui.p.hs,david7.atui.p.hs,david8.atui.p.hs,david9.atui.p.hs,david10.atui.p.hs), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df.atui.p.hs<-data.frame(ID=david.hs.atui.p.hs$V1,DS=david.hs.atui.p.hs$V2,normDS=david.hs.atui.p.hs$V3)


# Calculate linear models and slopes for each individual run:
lm.hs.1.atui.p.hs<-lm(e1.1.atui.p.hs$energy_over_time~as.numeric(david1.1.atui.p.hs$normDS))
hs.lm.1.s.atui.p.hs<-summary(lm.hs.1.atui.p.hs)$coefficients
hs.1.slope.atui.p.hs<-hs.lm.1.s.atui.p.hs[2,1]
lm.hs.2.atui.p.hs<-lm(e2.1.atui.p.hs$energy_over_time~as.numeric(david2.1.atui.p.hs$normDS))
hs.lm.2.s.atui.p.hs<-summary(lm.hs.2.atui.p.hs)$coefficients
hs.2.slope.atui.p.hs<-hs.lm.2.s.atui.p.hs[2,1]
lm.hs.3.atui.p.hs<-lm(e3.1.atui.p.hs$energy_over_time~as.numeric(david3.1.atui.p.hs$normDS))
hs.lm.3.s.atui.p.hs<-summary(lm.hs.3.atui.p.hs)$coefficients
hs.3.slope.atui.p.hs<-hs.lm.3.s.atui.p.hs[2,1]
lm.hs.4.atui.p.hs<-lm(e4.1.atui.p.hs$energy_over_time~as.numeric(david4.1.atui.p.hs$normDS))
hs.lm.4.s.atui.p.hs<-summary(lm.hs.4.atui.p.hs)$coefficients
hs.4.slope.atui.p.hs<-hs.lm.4.s.atui.p.hs[2,1]
lm.hs.5.atui.p.hs<-lm(e5.1.atui.p.hs$energy_over_time~as.numeric(david5.1.atui.p.hs$normDS))
hs.lm.5.s.atui.p.hs<-summary(lm.hs.5.atui.p.hs)$coefficients
hs.5.slope.atui.p.hs<-hs.lm.5.s.atui.p.hs[2,1]
lm.hs.6.atui.p.hs<-lm(e6.1.atui.p.hs$energy_over_time~as.numeric(david6.1.atui.p.hs$normDS))
hs.lm.6.s.atui.p.hs<-summary(lm.hs.6.atui.p.hs)$coefficients
hs.6.slope.atui.p.hs<-hs.lm.6.s.atui.p.hs[2,1]
lm.hs.7.atui.p.hs<-lm(e7.1.atui.p.hs$energy_over_time~as.numeric(david7.1.atui.p.hs$normDS))
hs.lm.7.s.atui.p.hs<-summary(lm.hs.7.atui.p.hs)$coefficients
hs.7.slope.atui.p.hs<-hs.lm.7.s.atui.p.hs[2,1]
lm.hs.8.atui.p.hs<-lm(e8.1.atui.p.hs$energy_over_time~as.numeric(david8.1.atui.p.hs$normDS))
hs.lm.8.s.atui.p.hs<-summary(lm.hs.8.atui.p.hs)$coefficients
hs.8.slope.atui.p.hs<-hs.lm.8.s.atui.p.hs[2,1]
lm.hs.9.atui.p.hs<-lm(e9.1.atui.p.hs$energy_over_time~as.numeric(david9.1.atui.p.hs$normDS))
hs.lm.9.s.atui.p.hs<-summary(lm.hs.9.atui.p.hs)$coefficients
hs.9.slope.atui.p.hs<-hs.lm.9.s.atui.p.hs[2,1]
lm.hs.10.atui.p.hs<-lm(e10.1.atui.p.hs$energy_over_time~as.numeric(david10.1.atui.p.hs$normDS))
hs.lm.10.s.atui.p.hs<-summary(lm.hs.10.atui.p.hs)$coefficients
hs.10.slope.atui.p.hs<-hs.lm.10.s.atui.p.hs[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
hs.atui.p.ss.attacks.atui.p.hs<-data.frame(triangle.transitivity=c(tri1.atui.p.hs,tri2.atui.p.hs,tri3.atui.p.hs,tri4.atui.p.hs,tri5.atui.p.hs,tri6.atui.p.hs,tri7.atui.p.hs,tri8.atui.p.hs,tri9.atui.p.hs,tri10.atui.p.hs),escalation=c(ep1.atui.p.hs,ep2.atui.p.hs,ep3.atui.p.hs,ep4.atui.p.hs,ep5.atui.p.hs,ep6.atui.p.hs,ep7.atui.p.hs,ep8.atui.p.hs,ep9.atui.p.hs,ep10.atui.p.hs),dci=c(dci1.atui.p.hs,dci2.atui.p.hs,dci3.atui.p.hs,dci4.atui.p.hs,dci5.atui.p.hs,dci6.atui.p.hs,dci7.atui.p.hs,dci8.atui.p.hs,dci9.atui.p.hs,dci10.atui.p.hs),steepness=c(s1.atui.p.hs,s2.atui.p.hs,s3.atui.p.hs,s4.atui.p.hs,s5.atui.p.hs,s6.atui.p.hs,s7.atui.p.hs,s8.atui.p.hs,s9.atui.p.hs,s10.atui.p.hs),slope=c(hs.1.slope.atui.p.hs,hs.2.slope.atui.p.hs,hs.3.slope.atui.p.hs,hs.4.slope.atui.p.hs,hs.5.slope.atui.p.hs,hs.6.slope.atui.p.hs,hs.7.slope.atui.p.hs,hs.8.slope.atui.p.hs,hs.9.slope.atui.p.hs,hs.10.slope.atui.p.hs))


#-------------------------------------------------------------------------------------------------------------------------

#History Opponent Uniform

# Data organization for the History Opponent Uniform data:
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#Read in attacks data
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/attacks")

files<-list.files(pattern="*.csv")
attacks.atui.p.ho<-sapply(files, read.csv)

# Generate attacks.atui.p.ho Interaction Matrices, DCI, TTri, H-index, David Score, and Steepness for each trial (1-10):
  #H-index was not used in the final analysis despite being calculated originally
  # Trial 1:  
mut1.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[1]],X2=attacks.atui.p.ho[[2]],Victories=attacks.atui.p.ho[[3]])
mat1.atui.p.ho<-inter.mat(mut1.atui.p.ho)
tri1.atui.p.ho<-tr.tri(mat1.atui.p.ho)
dci1.atui.p.ho<-DCindex(mat1.atui.p.ho)
mat1.atui.p.ho[is.na(mat1.atui.p.ho)] = 0
h1.atui.p.ho<-h.index(mat1.atui.p.ho)

ep1.atui.p.ho<-ep(mut1.atui.p.ho,a1.ui.p.ho)
david1.atui.p.ho<-DS(mat1.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.1.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.1.atui.p.ho<-cbind(ordrank.1.atui.p.ho,ds=david1.atui.p.ho$normDS)
lm1.atui.p.ho<-summary(lm(ordrank.1.atui.p.ho$ds~ordrank.1.atui.p.ho$ord.rank))
s1.atui.p.ho<-lm1.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 2:
mut2.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[4]],X2=attacks.atui.p.ho[[5]],Victories=attacks.atui.p.ho[[6]])
mat2.atui.p.ho<-inter.mat(mut2.atui.p.ho)
tri2.atui.p.ho<-tr.tri(mat2.atui.p.ho)
dci2.atui.p.ho<-DCindex(mat2.atui.p.ho)
mat2.atui.p.ho[is.na(mat2.atui.p.ho)] = 0
h2.atui.p.ho<-h.index(mat2.atui.p.ho)

ep2.atui.p.ho<-ep(mut2.atui.p.ho,a2.ui.p.ho)
david2.atui.p.ho<-DS(mat2.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.2.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.2.atui.p.ho<-cbind(ordrank.2.atui.p.ho,ds=david2.atui.p.ho$normDS)
lm2.atui.p.ho<-summary(lm(ordrank.2.atui.p.ho$ds~ordrank.2.atui.p.ho$ord.rank))
s2.atui.p.ho<-lm2.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 3:
mut3.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[7]],X2=attacks.atui.p.ho[[8]],Victories=attacks.atui.p.ho[[9]])
mat3.atui.p.ho<-inter.mat(mut3.atui.p.ho)
tri3.atui.p.ho<-tr.tri(mat3.atui.p.ho)
dci3.atui.p.ho<-DCindex(mat3.atui.p.ho)
mat3.atui.p.ho[is.na(mat3.atui.p.ho)] = 0
h3.atui.p.ho<-h.index(mat3.atui.p.ho)

ep3.atui.p.ho<-ep(mut3.atui.p.ho,a3.ui.p.ho)
david3.atui.p.ho<-DS(mat3.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.3.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.3.atui.p.ho<-cbind(ordrank.3.atui.p.ho,ds=david3.atui.p.ho$normDS)
lm3.atui.p.ho<-summary(lm(ordrank.3.atui.p.ho$ds~ordrank.3.atui.p.ho$ord.rank))
s3.atui.p.ho<-lm3.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 4:
mut4.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[10]],X2=attacks.atui.p.ho[[11]],Victories=attacks.atui.p.ho[[12]])
mat4.atui.p.ho<-inter.mat(mut4.atui.p.ho)
tri4.atui.p.ho<-tr.tri(mat4.atui.p.ho)
dci4.atui.p.ho<-DCindex(mat4.atui.p.ho)
mat4.atui.p.ho[is.na(mat4.atui.p.ho)] = 0
h4.atui.p.ho<-h.index(mat4.atui.p.ho)

ep4.atui.p.ho<-ep(mut4.atui.p.ho,a4.ui.p.ho)
david4.atui.p.ho<-DS(mat4.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.4.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.4.atui.p.ho<-cbind(ordrank.4.atui.p.ho,ds=david4.atui.p.ho$normDS)
lm4.atui.p.ho<-summary(lm(ordrank.4.atui.p.ho$ds~ordrank.4.atui.p.ho$ord.rank))
s4.atui.p.ho<-lm4.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 5:
mut5.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[13]],X2=attacks.atui.p.ho[[14]],Victories=attacks.atui.p.ho[[15]])
mat5.atui.p.ho<-inter.mat(mut5.atui.p.ho)
tri5.atui.p.ho<-tr.tri(mat5.atui.p.ho)
dci5.atui.p.ho<-DCindex(mat5.atui.p.ho)
mat5.atui.p.ho[is.na(mat5.atui.p.ho)] = 0
h5.atui.p.ho<-h.index(mat5.atui.p.ho)

ep5.atui.p.ho<-ep(mut5.atui.p.ho,a5.ui.p.ho)
david5.atui.p.ho<-DS(mat5.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.5.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.5.atui.p.ho<-cbind(ordrank.5.atui.p.ho,ds=david5.atui.p.ho$normDS)
lm5.atui.p.ho<-summary(lm(ordrank.5.atui.p.ho$ds~ordrank.5.atui.p.ho$ord.rank))
s5.atui.p.ho<-lm5.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 6:
mut6.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[16]],X2=attacks.atui.p.ho[[17]],Victories=attacks.atui.p.ho[[18]])
mat6.atui.p.ho<-inter.mat(mut6.atui.p.ho)
tri6.atui.p.ho<-tr.tri(mat6.atui.p.ho)
dci6.atui.p.ho<-DCindex(mat6.atui.p.ho)
mat6.atui.p.ho[is.na(mat6.atui.p.ho)] = 0
h6.atui.p.ho<-h.index(mat6.atui.p.ho)

ep6.atui.p.ho<-ep(mut6.atui.p.ho,a6.ui.p.ho)
david6.atui.p.ho<-DS(mat6.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.6.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.6.atui.p.ho<-cbind(ordrank.6.atui.p.ho,ds=david6.atui.p.ho$normDS)
lm6.atui.p.ho<-summary(lm(ordrank.6.atui.p.ho$ds~ordrank.6.atui.p.ho$ord.rank))
s6.atui.p.ho<-lm6.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 7:
mut7.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[19]],X2=attacks.atui.p.ho[[20]],Victories=attacks.atui.p.ho[[21]])
mat7.atui.p.ho<-inter.mat(mut7.atui.p.ho)
tri7.atui.p.ho<-tr.tri(mat7.atui.p.ho)
dci7.atui.p.ho<-DCindex(mat7.atui.p.ho)
mat7.atui.p.ho[is.na(mat7.atui.p.ho)] = 0
h7.atui.p.ho<-h.index(mat7.atui.p.ho)

ep7.atui.p.ho<-ep(mut7.atui.p.ho,a7.ui.p.ho)
david7.atui.p.ho<-DS(mat7.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.7.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.7.atui.p.ho<-cbind(ordrank.7.atui.p.ho,ds=david7.atui.p.ho$normDS)
lm7.atui.p.ho<-summary(lm(ordrank.7.atui.p.ho$ds~ordrank.7.atui.p.ho$ord.rank))
s7.atui.p.ho<-lm7.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 8:
mut8.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[22]],X2=attacks.atui.p.ho[[23]],Victories=attacks.atui.p.ho[[24]])
mat8.atui.p.ho<-inter.mat(mut8.atui.p.ho)
tri8.atui.p.ho<-tr.tri(mat8.atui.p.ho)
dci8.atui.p.ho<-DCindex(mat8.atui.p.ho)
mat8.atui.p.ho[is.na(mat8.atui.p.ho)] = 0
h8.atui.p.ho<-h.index(mat8.atui.p.ho)

ep8.atui.p.ho<-ep(mut8.atui.p.ho,a8.ui.p.ho)
david8.atui.p.ho<-DS(mat8.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.8.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.8.atui.p.ho<-cbind(ordrank.8.atui.p.ho,ds=david8.atui.p.ho$normDS)
lm8.atui.p.ho<-summary(lm(ordrank.8.atui.p.ho$ds~ordrank.8.atui.p.ho$ord.rank))
s8.atui.p.ho<-lm8.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 9:
mut9.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[25]],X2=attacks.atui.p.ho[[26]],Victories=attacks.atui.p.ho[[27]])
mat9.atui.p.ho<-inter.mat(mut9.atui.p.ho)
tri9.atui.p.ho<-tr.tri(mat9.atui.p.ho)
dci9.atui.p.ho<-DCindex(mat9.atui.p.ho)
mat9.atui.p.ho[is.na(mat9.atui.p.ho)] = 0
h9.atui.p.ho<-h.index(mat9.atui.p.ho)

ep9.atui.p.ho<-ep(mut9.atui.p.ho,a9.ui.p.ho)
david9.atui.p.ho<-DS(mat9.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.9.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.9.atui.p.ho<-cbind(ordrank.9.atui.p.ho,ds=david9.atui.p.ho$normDS)
lm9.atui.p.ho<-summary(lm(ordrank.9.atui.p.ho$ds~ordrank.9.atui.p.ho$ord.rank))
s9.atui.p.ho<-lm9.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Trial 10:
mut10.atui.p.ho<-data.frame(X1=attacks.atui.p.ho[[28]],X2=attacks.atui.p.ho[[29]],Victories=attacks.atui.p.ho[[30]])
mat10.atui.p.ho<-inter.mat(mut10.atui.p.ho)
tri10.atui.p.ho<-tr.tri(mat10.atui.p.ho)
dci10.atui.p.ho<-DCindex(mat10.atui.p.ho)
mat10.atui.p.ho[is.na(mat10.atui.p.ho)] = 0
h10.atui.p.ho<-h.index(mat10.atui.p.ho)

ep10.atui.p.ho<-ep(mut10.atui.p.ho,a10.ui.p.ho)
david10.atui.p.ho<-DS(mat10.atui.p.ho) #David's Scores - for steepness use normDS output
ordrank.10.atui.p.ho<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
ordrank.10.atui.p.ho<-cbind(ordrank.10.atui.p.ho,ds=david10.atui.p.ho$normDS)
lm10.atui.p.ho<-summary(lm(ordrank.10.atui.p.ho$ds~ordrank.10.atui.p.ho$ord.rank))
s10.atui.p.ho<-lm10.atui.p.ho$coefficients[2,1] #call for the estimate of slope from lm summary

  # Summarize the victories in each trial:
int1.atui.p.ho<-sum(mut1.atui.p.ho$Victories)
int2.atui.p.ho<-sum(mut2.atui.p.ho$Victories)
int3.atui.p.ho<-sum(mut3.atui.p.ho$Victories)
int4.atui.p.ho<-sum(mut4.atui.p.ho$Victories)
int5.atui.p.ho<-sum(mut5.atui.p.ho$Victories)
int6.atui.p.ho<-sum(mut6.atui.p.ho$Victories)
int7.atui.p.ho<-sum(mut7.atui.p.ho$Victories)
int8.atui.p.ho<-sum(mut8.atui.p.ho$Victories)
int9.atui.p.ho<-sum(mut9.atui.p.ho$Victories)
int10.atui.p.ho<-sum(mut10.atui.p.ho$Victories)

  # Summarize the attacksances in each trial (each file has the same naming convention, so attacksances in the following files are labeled Victories despite not being a count of wins from each interaction):
av1.atui.p.ho<-sum(a1.ui.p.ho$Victories)
av2.atui.p.ho<-sum(a2.ui.p.ho$Victories)
av3.atui.p.ho<-sum(a3.ui.p.ho$Victories)
av4.atui.p.ho<-sum(a4.ui.p.ho$Victories)
av5.atui.p.ho<-sum(a5.ui.p.ho$Victories)
av6.atui.p.ho<-sum(a6.ui.p.ho$Victories)
av7.atui.p.ho<-sum(a7.ui.p.ho$Victories)
av8.atui.p.ho<-sum(a8.ui.p.ho$Victories)
av9.atui.p.ho<-sum(a9.ui.p.ho$Victories)
av10.atui.p.ho<-sum(a10.ui.p.ho$Victories)

  # Calculate the average number of attacksances across trials:
avg.av.ho.atiu.p<-(sum(av1.atui.p.ho, av2.atui.p.ho, av3.atui.p.ho, av4.atui.p.ho, av5.atui.p.ho, av6.atui.p.ho, av7.atui.p.ho, av8.atui.p.ho, av9.atui.p.ho, av10.atui.p.ho))/10

  # Calculate the average number of victories across trials:
avg.int.ho.atiu.p<-(sum(int1.atui.p.ho, int2.atui.p.ho, int3.atui.p.ho, int4.atui.p.ho, int5.atui.p.ho, int6.atui.p.ho, int7.atui.p.ho, int8.atui.p.ho, int9.atui.p.ho, int10.atui.p.ho))/10


# Read in and organize foraging-efficiency files:
setwd("~/Documents/GitHub/primate-social-groups-model/despotism full results 12.23.22/ho.u.i/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)

  # Generate matrices for the foraging-efficiency data for each trial (1-10):
e1.atui.p.ho<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1.atui.p.ho<-e1.atui.p.ho[order(e1.atui.p.ho$ID),]
e1.atui.p.ho<-as.matrix(t(e1.1.atui.p.ho))

e2.atui.p.ho<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1.atui.p.ho<-e2.atui.p.ho[order(e2.atui.p.ho$ID),]
e2.atui.p.ho<-as.matrix(t(e2.1.atui.p.ho))

e3.atui.p.ho<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1.atui.p.ho<-e3.atui.p.ho[order(e3.atui.p.ho$ID),]
e3.atui.p.ho<-as.matrix(t(e3.1.atui.p.ho))

e4.atui.p.ho<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1.atui.p.ho<-e4.atui.p.ho[order(e4.atui.p.ho$ID),]
e4.atui.p.ho<-as.matrix(t(e4.1.atui.p.ho))

e5.atui.p.ho<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1.atui.p.ho<-e5.atui.p.ho[order(e5.atui.p.ho$ID),]
e5.atui.p.ho<-as.matrix(t(e5.1.atui.p.ho))

e6.atui.p.ho<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1.atui.p.ho<-e6.atui.p.ho[order(e6.atui.p.ho$ID),]
e6.atui.p.ho<-as.matrix(t(e6.1.atui.p.ho))

e7.atui.p.ho<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1.atui.p.ho<-e7.atui.p.ho[order(e7.atui.p.ho$ID),]
e7.atui.p.ho<-as.matrix(t(e7.1.atui.p.ho))

e8.atui.p.ho<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1.atui.p.ho<-e8.atui.p.ho[order(e8.atui.p.ho$ID),]
e8.atui.p.ho<-as.matrix(t(e8.1.atui.p.ho))

e9.atui.p.ho<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1.atui.p.ho<-e9.atui.p.ho[order(e9.atui.p.ho$ID),]
e9.atui.p.ho<-as.matrix(t(e9.1.atui.p.ho))

e10.atui.p.ho<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1.atui.p.ho<-e10.atui.p.ho[order(e10.atui.p.ho$ID),]
e10.atui.p.ho<-as.matrix(t(e10.1.atui.p.ho))

energy.ho.atui.p.ho<-as.data.frame(matrix(c(e1.atui.p.ho,e2.atui.p.ho,e3.atui.p.ho,e4.atui.p.ho,e5.atui.p.ho,e6.atui.p.ho,e7.atui.p.ho,e8.atui.p.ho,e9.atui.p.ho,e10.atui.p.ho), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df.atui.p.ho<-data.frame(ID=energy.ho.atui.p.ho$V1,energy_over_distance=energy.ho.atui.p.ho$V2,energy_over_time=energy.ho.atui.p.ho$V3)

# Organize David's Scores data to compile into a single dataframe:
david1.1.atui.p.ho<-david1.atui.p.ho[order(david1.atui.p.ho$ID),]
david1.atui.p.ho<-as.matrix(t(david1.1.atui.p.ho))

david2.1.atui.p.ho<-david2.atui.p.ho[order(david2.atui.p.ho$ID),]
david2.atui.p.ho<-as.matrix(t(david2.1.atui.p.ho))

david3.1.atui.p.ho<-david3.atui.p.ho[order(david3.atui.p.ho$ID),]
david3.atui.p.ho<-as.matrix(t(david3.1.atui.p.ho))

david4.1.atui.p.ho<-david4.atui.p.ho[order(david4.atui.p.ho$ID),]
david4.atui.p.ho<-as.matrix(t(david4.1.atui.p.ho))

david5.1.atui.p.ho<-david5.atui.p.ho[order(david5.atui.p.ho$ID),]
david5.atui.p.ho<-as.matrix(t(david5.1.atui.p.ho))

david6.1.atui.p.ho<-david6.atui.p.ho[order(david6.atui.p.ho$ID),]
david6.atui.p.ho<-as.matrix(t(david6.1.atui.p.ho))

david7.1.atui.p.ho<-david7.atui.p.ho[order(david7.atui.p.ho$ID),]
david7.atui.p.ho<-as.matrix(t(david7.1.atui.p.ho))

david8.1.atui.p.ho<-david8.atui.p.ho[order(david8.atui.p.ho$ID),]
david8.atui.p.ho<-as.matrix(t(david8.1.atui.p.ho))

david9.1.atui.p.ho<-david9.atui.p.ho[order(david9.atui.p.ho$ID),]
david9.atui.p.ho<-as.matrix(t(david9.1.atui.p.ho))

david10.1.atui.p.ho<-david10.atui.p.ho[order(david10.atui.p.ho$ID),]
david10.atui.p.ho<-as.matrix(t(david10.1.atui.p.ho))

david.ho.atui.p.ho<-as.data.frame(matrix(c(david1.atui.p.ho,david2.atui.p.ho,david3.atui.p.ho,david4.atui.p.ho,david5.atui.p.ho,david6.atui.p.ho,david7.atui.p.ho,david8.atui.p.ho,david9.atui.p.ho,david10.atui.p.ho), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df.atui.p.ho<-data.frame(ID=david.ho.atui.p.ho$V1,DS=david.ho.atui.p.ho$V2,normDS=david.ho.atui.p.ho$V3)


# Calculate linear models and slopes for each individual run:
lm.ho.1.atui.p.ho<-lm(e1.1.atui.p.ho$energy_over_time~as.numeric(david1.1.atui.p.ho$normDS))
ho.lm.1.s.atui.p.ho<-summary(lm.ho.1.atui.p.ho)$coefficients
ho.1.slope.atui.p.ho<-ho.lm.1.s.atui.p.ho[2,1]
lm.ho.2.atui.p.ho<-lm(e2.1.atui.p.ho$energy_over_time~as.numeric(david2.1.atui.p.ho$normDS))
ho.lm.2.s.atui.p.ho<-summary(lm.ho.2.atui.p.ho)$coefficients
ho.2.slope.atui.p.ho<-ho.lm.2.s.atui.p.ho[2,1]
lm.ho.3.atui.p.ho<-lm(e3.1.atui.p.ho$energy_over_time~as.numeric(david3.1.atui.p.ho$normDS))
ho.lm.3.s.atui.p.ho<-summary(lm.ho.3.atui.p.ho)$coefficients
ho.3.slope.atui.p.ho<-ho.lm.3.s.atui.p.ho[2,1]
lm.ho.4.atui.p.ho<-lm(e4.1.atui.p.ho$energy_over_time~as.numeric(david4.1.atui.p.ho$normDS))
ho.lm.4.s.atui.p.ho<-summary(lm.ho.4.atui.p.ho)$coefficients
ho.4.slope.atui.p.ho<-ho.lm.4.s.atui.p.ho[2,1]
lm.ho.5.atui.p.ho<-lm(e5.1.atui.p.ho$energy_over_time~as.numeric(david5.1.atui.p.ho$normDS))
ho.lm.5.s.atui.p.ho<-summary(lm.ho.5.atui.p.ho)$coefficients
ho.5.slope.atui.p.ho<-ho.lm.5.s.atui.p.ho[2,1]
lm.ho.6.atui.p.ho<-lm(e6.1.atui.p.ho$energy_over_time~as.numeric(david6.1.atui.p.ho$normDS))
ho.lm.6.s.atui.p.ho<-summary(lm.ho.6.atui.p.ho)$coefficients
ho.6.slope.atui.p.ho<-ho.lm.6.s.atui.p.ho[2,1]
lm.ho.7.atui.p.ho<-lm(e7.1.atui.p.ho$energy_over_time~as.numeric(david7.1.atui.p.ho$normDS))
ho.lm.7.s.atui.p.ho<-summary(lm.ho.7.atui.p.ho)$coefficients
ho.7.slope.atui.p.ho<-ho.lm.7.s.atui.p.ho[2,1]
lm.ho.8.atui.p.ho<-lm(e8.1.atui.p.ho$energy_over_time~as.numeric(david8.1.atui.p.ho$normDS))
ho.lm.8.s.atui.p.ho<-summary(lm.ho.8.atui.p.ho)$coefficients
ho.8.slope.atui.p.ho<-ho.lm.8.s.atui.p.ho[2,1]
lm.ho.9.atui.p.ho<-lm(e9.1.atui.p.ho$energy_over_time~as.numeric(david9.1.atui.p.ho$normDS))
ho.lm.9.s.atui.p.ho<-summary(lm.ho.9.atui.p.ho)$coefficients
ho.9.slope.atui.p.ho<-ho.lm.9.s.atui.p.ho[2,1]
lm.ho.10.atui.p.ho<-lm(e10.1.atui.p.ho$energy_over_time~as.numeric(david10.1.atui.p.ho$normDS))
ho.lm.10.s.atui.p.ho<-summary(lm.ho.10.atui.p.ho)$coefficients
ho.10.slope.atui.p.ho<-ho.lm.10.s.atui.p.ho[2,1]

# Generate data frame of the summary statistics (TTri, Escalation, DCI, Slope) calculated for each trial:
ho.atui.p.ss.attacks.atui.p.ho<-data.frame(triangle.transitivity=c(tri1.atui.p.ho,tri2.atui.p.ho,tri3.atui.p.ho,tri4.atui.p.ho,tri5.atui.p.ho,tri6.atui.p.ho,tri7.atui.p.ho,tri8.atui.p.ho,tri9.atui.p.ho,tri10.atui.p.ho),escalation=c(ep1.atui.p.ho,ep2.atui.p.ho,ep3.atui.p.ho,ep4.atui.p.ho,ep5.atui.p.ho,ep6.atui.p.ho,ep7.atui.p.ho,ep8.atui.p.ho,ep9.atui.p.ho,ep10.atui.p.ho),dci=c(dci1.atui.p.ho,dci2.atui.p.ho,dci3.atui.p.ho,dci4.atui.p.ho,dci5.atui.p.ho,dci6.atui.p.ho,dci7.atui.p.ho,dci8.atui.p.ho,dci9.atui.p.ho,dci10.atui.p.ho),steepness=c(s1.atui.p.ho,s2.atui.p.ho,s3.atui.p.ho,s4.atui.p.ho,s5.atui.p.ho,s6.atui.p.ho,s7.atui.p.ho,s8.atui.p.ho,s9.atui.p.ho,s10.atui.p.ho),slope=c(ho.1.slope.atui.p.ho,ho.2.slope.atui.p.ho,ho.3.slope.atui.p.ho,ho.4.slope.atui.p.ho,ho.5.slope.atui.p.ho,ho.6.slope.atui.p.ho,ho.7.slope.atui.p.ho,ho.8.slope.atui.p.ho,ho.9.slope.atui.p.ho,ho.10.slope.atui.p.ho))
```
```{r attacks Uniform Probabilistic Data Frame}
#knowledge mutual
km.tt.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$triangle.transitivity)
km.atiu.pi.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$dci)
km.esc.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$escalation)
km.steep.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$steepness)
km.slope.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$slope)
km.mean.atiu.p.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atiu.p.attacks,dci=km.atiu.pi.atiu.p.attacks,esc=km.esc.atiu.p.attacks,steepness=km.steep.atiu.p.attacks,slope=km.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$triangle.transitivity)
ks.atiu.pi.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$dci)
ks.esc.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$escalation)
ks.steep.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$steepness)
ks.slope.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$slope)
ks.mean.atiu.p.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.atiu.p.attacks,dci=ks.atiu.pi.atiu.p.attacks,esc=ks.esc.atiu.p.attacks,steepness=ks.steep.atiu.p.attacks,slope=ks.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$triangle.transitivity)
ko.atiu.pi.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$dci)
ko.esc.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$escalation)
ko.steep.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$steepness)
ko.slope.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$slope)
ko.mean.atiu.p.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.atiu.p.attacks,dci=ko.atiu.pi.atiu.p.attacks,esc=ko.esc.atiu.p.attacks,steepness=ko.steep.atiu.p.attacks,slope=ko.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$triangle.transitivity)
hm.atiu.pi.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$dci)
hm.esc.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$escalation)
hm.steep.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$steepness)
hm.slope.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$slope)
hm.mean.atiu.p.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atiu.p.attacks,dci=hm.atiu.pi.atiu.p.attacks,esc=hm.esc.atiu.p.attacks,steepness=hm.steep.atiu.p.attacks,slope=hm.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$triangle.transitivity)
hs.atiu.pi.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$dci)
hs.esc.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$escalation)
hs.steep.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$steepness)
hs.slope.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$slope)
hs.mean.atiu.p.attacks<-data.frame(scenario="History self",tt=hs.tt.atiu.p.attacks,dci=hs.atiu.pi.atiu.p.attacks,esc=hs.esc.atiu.p.attacks,steepness=hs.steep.atiu.p.attacks,slope=hs.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$triangle.transitivity)
ho.atiu.pi.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$dci)
ho.esc.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$escalation)
ho.steep.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$steepness)
ho.slope.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$slope)
ho.mean.atiu.p.attacks<-data.frame(scenario="History opponent",tt=ho.tt.atiu.p.attacks,dci=ho.atiu.pi.atiu.p.attacks,esc=ho.esc.atiu.p.attacks,steepness=ho.steep.atiu.p.attacks,slope=ho.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atiu.p.attacks,ks.mean.atiu.p.attacks,ko.mean.atiu.p.attacks,hm.mean.atiu.p.attacks,hs.mean.atiu.p.attacks,ho.mean.atiu.p.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$triangle.transitivity)
km.atiu.pi.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$dci)
km.esc.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$escalation)
km.steep.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$steepness)
km.slope.atiu.p.attacks<-mean(km.atui.p.ss.attacks.atui.p.km$slope)
km.mean.atiu.p.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.atiu.p.attacks,dci=km.atiu.pi.atiu.p.attacks,esc=km.esc.atiu.p.attacks,steepness=km.steep.atiu.p.attacks,slope=km.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#knowledge self
ks.tt.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$triangle.transitivity)
ks.atiu.pi.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$dci)
ks.esc.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$escalation)
ks.steep.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$steepness)
ks.slope.atiu.p.attacks<-mean(ks.atui.p.ss.attacks.atui.p.ks$slope)
ks.mean.atiu.p.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.atiu.p.attacks,dci=ks.atiu.pi.atiu.p.attacks,esc=ks.esc.atiu.p.attacks,steepness=ks.steep.atiu.p.attacks,slope=ks.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$triangle.transitivity)
ko.atiu.pi.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$dci)
ko.esc.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$escalation)
ko.steep.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$steepness)
ko.slope.atiu.p.attacks<-mean(ko.atui.p.ss.attacks.atui.p.ko$slope)
ko.mean.atiu.p.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.atiu.p.attacks,dci=ko.atiu.pi.atiu.p.attacks,esc=ko.esc.atiu.p.attacks,steepness=ko.steep.atiu.p.attacks,slope=ko.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history mutual
hm.tt.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$triangle.transitivity)
hm.atiu.pi.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$dci)
hm.esc.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$escalation)
hm.steep.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$steepness)
hm.slope.atiu.p.attacks<-mean(hm.atui.p.ss.attacks.atui.p.hm$slope)
hm.mean.atiu.p.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.atiu.p.attacks,dci=hm.atiu.pi.atiu.p.attacks,esc=hm.esc.atiu.p.attacks,steepness=hm.steep.atiu.p.attacks,slope=hm.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history self
hs.tt.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$triangle.transitivity)
hs.atiu.pi.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$dci)
hs.esc.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$escalation)
hs.steep.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$steepness)
hs.slope.atiu.p.attacks<-mean(hs.atui.p.ss.attacks.atui.p.hs$slope)
hs.mean.atiu.p.attacks<-data.frame(scenario="History self",tt=hs.tt.atiu.p.attacks,dci=hs.atiu.pi.atiu.p.attacks,esc=hs.esc.atiu.p.attacks,steepness=hs.steep.atiu.p.attacks,slope=hs.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#history opponent
ho.tt.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$triangle.transitivity)
ho.atiu.pi.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$dci)
ho.esc.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$escalation)
ho.steep.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$steepness)
ho.slope.atiu.p.attacks<-mean(ho.atui.p.ss.attacks.atui.p.ho$slope)
ho.mean.atiu.p.attacks<-data.frame(scenario="History opponent",tt=ho.tt.atiu.p.attacks,dci=ho.atiu.pi.atiu.p.attacks,esc=ho.esc.atiu.p.attacks,steepness=ho.steep.atiu.p.attacks,slope=ho.slope.atiu.p.attacks,dist="Uniform",calc="Probabilistic")

#total average dataframe
dc.ave<-rbind(km.mean.atiu.p.attacks,ks.mean.atiu.p.attacks,ko.mean.atiu.p.attacks,hm.mean.atiu.p.attacks,hs.mean.atiu.p.attacks,ho.mean.atiu.p.attacks)

#create overall dataframe of summary statistics
overall.unif.attacks.initiator<-data.frame(km.atui.p.ss.attacks.atui.p.km)
overall.unif.attacks.initiator<-rbind(overall.unif.attacks.initiator,ks.atui.p.ss.attacks.atui.p.ks)
overall.unif.attacks.initiator<-rbind(overall.unif.attacks.initiator,ko.atui.p.ss.attacks.atui.p.ko)
overall.unif.attacks.initiator<-rbind(overall.unif.attacks.initiator,hm.atui.p.ss.attacks.atui.p.hm)
overall.unif.attacks.initiator<-rbind(overall.unif.attacks.initiator,hs.atui.p.ss.attacks.atui.p.hs)
overall.unif.attacks.initiator<-rbind(overall.unif.attacks.initiator,ho.atui.p.ss.attacks.atui.p.ho)

overall.unif.attacks.initiator<-cbind(overall.unif.attacks.initiator,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.attacks.initiator<-cbind(overall.unif.attacks.initiator,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("Uniform",60),calc=rep("prob",60))


rhp.ss.attacks.ui.p<-overall.unif.attacks.initiator[overall.unif.attacks.initiator$variable=="rhp",]
history.ss.attacks.ui.p<-overall.unif.attacks.initiator[overall.unif.attacks.initiator$variable=="history",]

overall.unif.attacks.initiator$combo<-paste(overall.unif.attacks.initiator$strategy,overall.unif.attacks.initiator$variable,overall.unif.attacks.initiator$distribution)
overall.unif.attacks.initiator$combo2<-paste(overall.unif.attacks.initiator$strategy,overall.unif.attacks.initiator$variable)
```

## Overall Initiator Wins Data Frames
```{r Full Initiator Wins Probabilistic Data Frame}
# Generate single data frame for all of the Probabilistic data calculated in the previous chunks:
overall.clump.initiator$combo<-paste(overall.clump.initiator$strategy,overall.clump.initiator$variable,overall.clump.initiator$distribution)
overall.clump.initiator$combo2<-paste(overall.clump.initiator$strategy,overall.clump.initiator$variable) #final dataframe for Probabilistic clumped data
overall.unif.initiator$combo<-paste(overall.unif.initiator$strategy,overall.unif.initiator$variable,overall.unif.initiator$distribution)
overall.unif.initiator$combo2<-paste(overall.unif.initiator$strategy,overall.unif.initiator$variable) #final dataframe for Probabilistic clumped data

overall.ss.prob.initiator=rbind(overall.clump.initiator,overall.unif.initiator) #final overall data frame for all Probabilistic data


total.energy.ic.p<-cbind(total.energy.ic.p, distribution=(rep("clumped",600)))
total.energy.iu.p<-cbind(total.energy.iu.p, distribution=(rep("uniform",600)))
overall.energy.i<-rbind(total.energy.ic.p, total.energy.iu.p)


#overall.ss.prob.initiator<-overall.ss.prob.initiator[,1:8]
write.csv(overall.ss.prob.initiator,"~/Desktop/initiator_wins_Probabilistic_data_frame.csv",row.names=F) #.csv document of overall Probabilistic data frame for publication
```
```{r Full Probabilistic Initiator Wins Avoid Data Frame}
# Generate single data frame for the clumped avoid data calculated in the previous chunks:
overall.clumped.avoid.initiator$combo<-paste(overall.clumped.avoid.initiator$strategy,overall.clumped.avoid.initiator$variable,overall.clumped.avoid.initiator$distribution)
overall.clumped.avoid.initiator$combo2<-paste(overall.clumped.avoid.initiator$strategy,overall.clumped.avoid.initiator$variable) #final dataframe for Probabilistic clumped data
overall.unif.avoid.initiator$combo<-paste(overall.unif.avoid.initiator$strategy,overall.unif.avoid.initiator$variable,overall.unif.avoid.initiator$distribution)
overall.unif.avoid.initiator$combo2<-paste(overall.unif.avoid.initiator$strategy,overall.unif.avoid.initiator$variable) #final dataframe for Probabilistic clumped data

overall.ss.initiator.avoid.prob=rbind(overall.clumped.avoid.initiator,overall.unif.avoid.initiator)


#overall.ss.initiator.avoid.prob<-overall.ss.initiator.avoid.prob[,1:8]
write.csv(overall.ss.initiator.avoid.prob,"~/Desktop/avoid_initiator_wins_Probabilistic_data_frame.csv",row.names=F) #.csv document of avoids Probabilistic data frame for publication
```
```{r Full Probabilistic Initiator Wins Attacks Data Frame}
# Generate single data frame for the clumped attacks data calculated in the previous chunks:
overall.clumped.attacks.initiator$combo<-paste(overall.clumped.attacks.initiator$strategy,overall.clumped.attacks.initiator$variable,overall.clumped.attacks.initiator$distribution)
overall.clumped.attacks.initiator$combo2<-paste(overall.clumped.attacks.initiator$strategy,overall.clumped.attacks.initiator$variable) #final dataframe for Probabilistic clumped data
overall.unif.attacks.initiator$combo<-paste(overall.unif.attacks.initiator$strategy,overall.unif.attacks.initiator$variable,overall.unif.attacks.initiator$distribution)
overall.unif.attacks.initiator$combo2<-paste(overall.unif.attacks.initiator$strategy,overall.unif.attacks.initiator$variable) #final dataframe for Probabilistic clumped data

overall.ss.initiator.attacks.prob=rbind(overall.clumped.attacks.initiator,overall.unif.attacks.initiator)


#overall.ss.initiator.attacks.prob<-overall.ss.initiator.attacks.prob[,1:8]
write.csv(overall.ss.initiator.attacks.prob,"~/Desktop/attacks_initiator_wins_Probabilistic_data_frame.csv",row.names=F) #.csv document of attacks Probabilistic data frame for publication
```

## Initiator Wins Proportion of Attack Data
```{r Initiator Wins Proportion of Attack}
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

# Read in the attack proportion data:
setwd("~/Documents/GitHub/primate-social-groups-model")
initiator.wins.prop.prob<-read.csv("dominance_despotism_energy new results dec 22-table.csv")
initiator.wins.prop.prob<-initiator.wins.prop.prob[5:366,]

#-----------------------------------------------------------------------------------------------------------------------------------------------

initiator.wins.prop.prob.all<-initiator.wins.prop.prob[initiator.wins.prop.prob$X=="initiator",] #Data frame for both RHP and History Initiator Wins Data
#Order the data based on run number
initiator.wins.prop.prob.all<-cbind(initiator.wins.prop.prob.all,Run.Number=as.numeric(initiator.wins.prop.prob.all$BehaviorSpace.results..NetLogo.6.2.2.))

initiator.wins.prop.prob.all<-initiator.wins.prop.prob.all[order(initiator.wins.prop.prob.all$Run.Number,decreasing=F),]

initiator.wins.prop.prob.all<-data.frame(run.number=initiator.wins.prop.prob.all$Run.Number,calculation=initiator.wins.prop.prob.all$X,dist=initiator.wins.prop.prob.all$X.1,interaction=initiator.wins.prop.prob.all$X.2,assessment=initiator.wins.prop.prob.all$X.3,step=initiator.wins.prop.prob.all$X.4,ticks=initiator.wins.prop.prob.all$X.5,victory.count=initiator.wins.prop.prob.all$X.6,sum.avoids=initiator.wins.prop.prob.all$X.7,efficiency=initiator.wins.prop.prob.all$X.8,attack.proportion=as.numeric(initiator.wins.prop.prob.all$X.10))

initiator.wins.prop.prob.all<-cbind(initiator.wins.prop.prob.all,combo2=c(rep("mutual history",10), rep("self history",10), rep("opponent history",10), rep("mutual knowledge",10), rep("self knowledge",10), rep("opponent knowledge",10), rep("mutual history",10), rep("self history",10), rep("opponent history",10), rep("mutual knowledge",10), rep("self knowledge",10), rep("opponent knowledge",10)))

#Create RHP Only Table
initiator.wins.prop.prob.rhp<-initiator.wins.prop.prob.all[initiator.wins.prop.prob.all$interaction=="knowledge",]
initiator.wins.prop.prob.rhp<-cbind(initiator.wins.prop.prob.rhp, rate.attacks=(as.numeric(initiator.wins.prop.prob.rhp$victory.count)/as.numeric(initiator.wins.prop.prob.rhp$ticks)), rate.avoids=(as.numeric(initiator.wins.prop.prob.rhp$sum.avoids)/as.numeric(initiator.wins.prop.prob.rhp$ticks)))

#-----------------------------------------------------------------------------------------------------------------------------------------------

initiator.wins.prop.prob<-initiator.wins.prop.prob[initiator.wins.prop.prob$X.2=="history",]
initiator.wins.prop.prob<-initiator.wins.prop.prob[initiator.wins.prop.prob$X=="probabilistic",]
initiator.wins.prop.prob<-cbind(initiator.wins.prop.prob,Run.Number=as.numeric(initiator.wins.prop.prob$BehaviorSpace.results..NetLogo.6.2.2.))

#Order the data based on run number
initiator.wins.prop.prob<-initiator.wins.prop.prob[order(initiator.wins.prop.prob$Run.Number,decreasing=F),]
initiator.wins.prop.prob<-data.frame(run.number=initiator.wins.prop.prob$Run.Number,calculation=initiator.wins.prop.prob$X,dist=initiator.wins.prop.prob$X.1,interaction=initiator.wins.prop.prob$X.2,assessment=initiator.wins.prop.prob$X.3,step=initiator.wins.prop.prob$X.4,ticks=initiator.wins.prop.prob$X.5,victory.count=initiator.wins.prop.prob$X.6,sum.avoids=initiator.wins.prop.prob$X.7,efficiency=initiator.wins.prop.prob$X.8,attack.proportion=as.numeric(initiator.wins.prop.prob$X.10))

initiator.wins.prop.prob<-cbind(initiator.wins.prop.prob,combo2=c(rep("mutual history",10),rep("self history",10),rep("opponent history",10),rep("mutual history",10),rep("self history",10),rep("opponent history",10)))

initiator.wins.prop.prob<-cbind(initiator.wins.prop.prob, rate.attacks=(as.numeric(initiator.wins.prop.prob$victory.count)/as.numeric(initiator.wins.prop.prob$ticks)), rate.avoids=(as.numeric(initiator.wins.prop.prob$sum.avoids)/as.numeric(initiator.wins.prop.prob$ticks)))

```

## Initiator Wins Summary Tables For Publication
```{r}
#Subset attack proportions data into individual data frames based on the distribution type and assessment information.

dist.split.i <- split(initiator.wins.prop.prob, initiator.wins.prop.prob$dist) #Splits attack proportions into separate data frames for "clumped" and "uniform" distributions (line 17)
new.pist.i <- c("clumped.attack.prop.i", "uniform.attack.prop.i")
for (i in 1:length(dist.split.i)) { #Variable "i" represents data by distribution
  assign(new.pist.i[i], dist.split.i[[i]]) #Assigns data to the named dataframes above (line 17)
}


clump.attack.prop.split.i <- split(clumped.attack.prop.i, clumped.attack.prop.i$combo2) #Splits attack proportions into separate data frames that occurred the "clumped" distribution based on assessment information (lines 21:26)
new.names.c.i <- c("hm.attack.prop.c.i","ho.attack.prop.c.i","hs.attack.prop.c.i")
for (j in 1:length(clump.attack.prop.split.i)) { #Variable "j" represents data in the clumped distribution by assessment information
  assign(new.names.c.i[j], clump.attack.prop.split.i[[j]]) #Assigns data to the named dataframes above (lines 21:26)
}


uni.attack.prop.split.i <- split(uniform.attack.prop.i, uniform.attack.prop.i$combo2) #Splits attack proportions into separate data frames that occurred the "uniform" distribution based on assessment information (lines 28:33)
new.names.u.i <- c("hm.attack.prop.u.i","ho.attack.prop.u.i","hs.attack.prop.u.i")
for (k in 1:length(uni.attack.prop.split.i)) { #Variable "k" represents data in the uniform distribution by assessment information
  assign(new.names.u.i[k], uni.attack.prop.split.i[[k]]) #Assigns data to the named dataframes above (lines 28:33)
}
```

```{r Probabilistic Clumped Summary Table}
# Generate summary tables of the Probabilistic clumped data for publication:

# history mutual
hm.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="mutual history clumped",]
  hm.tt.i<-mean(hm.st.i$triangle.transitivity)
  hm.dci.i<-mean(hm.st.i$dci)
  hm.poa.i<-mean(as.numeric(hm.attack.prop.c.i$attack.proportion))
  hm.steep.i<-abs(mean(hm.st.i$steepness))
  hm.ov.i<-data.frame(History.Mutual = c(hm.poa.i,hm.dci.i,hm.tt.i,hm.steep.i,avg.int.hm.ic.p,avg.av.hm.ic.p))

# history self
hs.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="self history clumped",]
  hs.tt.i<-mean(hs.st.i$triangle.transitivity)
  hs.dci.i<-mean(hs.st.i$dci)
  hs.poa.i<-mean(as.numeric(hs.attack.prop.c.i$attack.proportion))
  hs.steep.i<-abs(mean(hs.st.i$steepness))
  hs.ov.i<-data.frame(History.Self = c(hs.poa.i,hs.dci.i,hs.tt.i,hs.steep.i,avg.int.hs.ic.p,avg.av.hs.ic.p))

# history opponent
ho.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="opponent history clumped",]
  ho.tt.i<-mean(ho.st.i$triangle.transitivity)
  ho.dci.i<-mean(ho.st.i$dci)
  ho.poa.i<-mean(as.numeric(ho.attack.prop.c.i$attack.proportion))
  ho.steep.i<-abs(mean(ho.st.i$steepness))
  ho.ov.i<-data.frame(History.Opponent = c(ho.poa.i,ho.dci.i,ho.tt.i,ho.steep.i,avg.int.ho.ic.p,avg.av.ho.ic.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i<-data.frame(hist.mut=hm.ov.i,hist.self=hs.ov.i,hist.opp=ho.ov.i)
row.names(overall.c.st.i)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i,"~/Desktop/overall_summary_table_ic_prob.csv")
```

```{r Probabilistic Uniform Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# History mutual
hm.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="mutual history Uniform",]
  hm.tt.i.u<-mean(hm.st.i.u$triangle.transitivity)
  hm.dci.i.u<-mean(hm.st.i.u$dci)
  hm.poa.i.u<-mean(as.numeric(hm.attack.prop.u.i$attack.proportion))
  hm.steep.i.u<-abs(mean(hm.st.i.u$steepness))
  hm.ov.i.u<-data.frame(History.Mutual = c(hm.poa.i.u,hm.dci.i.u,hm.tt.i.u,hm.steep.i.u,avg.int.hm.iu.p,avg.av.hm.iu.p))

# History self
hs.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="self history Uniform",]
  hs.tt.i.u<-mean(hs.st.i.u$triangle.transitivity)
  hs.dci.i.u<-mean(hs.st.i.u$dci)
  hs.poa.i.u<-mean(as.numeric(hs.attack.prop.u.i$attack.proportion))
  hs.steep.i.u<-abs(mean(hs.st.i.u$steepness))
  hs.ov.i.u<-data.frame(History.Self = c(hs.poa.i.u,hs.dci.i.u,hs.tt.i.u,hs.steep.i.u,avg.int.hs.iu.p,avg.av.hs.iu.p))

# History opponent
ho.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="opponent history Uniform",]
  ho.tt.i.u<-mean(ho.st.i.u$triangle.transitivity)
  ho.dci.i.u<-mean(ho.st.i.u$dci)
  ho.poa.i.u<-mean(as.numeric(ho.attack.prop.u.i$attack.proportion))
  ho.steep.i.u<-abs(mean(ho.st.i.u$steepness))
  ho.ov.i.u<-data.frame(History.Opponent = c(ho.poa.i.u,ho.dci.i.u,ho.tt.i.u,ho.steep.i.u,avg.int.ho.iu.p,avg.av.ho.iu.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.u<-data.frame(hist.mut=hm.ov.i.u,hist.self=hs.ov.i.u,hist.opp=ho.ov.i.u)
row.names(overall.c.st.i.u)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.u,"~/Desktop/overall_summary_table_iu_prob.csv")
```

```{r Probabilistic Clumped Avoid Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# History mutual
hm.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="mutual history clumped",]
  hm.tt.i.c.avoid<-mean(hm.st.i.c.avoid$triangle.transitivity)
  hm.dci.i.c.avoid<-mean(hm.st.i.c.avoid$dci)
  hm.poa.i.c.avoid<-mean(as.numeric(hm.attack.prop.c.i$rate.avoids))
  hm..steep.i.c.avoid<-abs(mean(hm.st.i.c.avoid$steepness))
  hm.ov.i.c.avoid<-data.frame(History.Mutual = c(hm.poa.i.c.avoid,hm.dci.i.c.avoid,hm.tt.i.c.avoid,hm..steep.i.c.avoid,avg.int.hm.aci.p,avg.av.km.aci.p))

# History self
hs.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="self history clumped",]
  hs.tt.i.c.avoid<-mean(hs.st.i.c.avoid$triangle.transitivity)
  hs.dci.i.c.avoid<-mean(hs.st.i.c.avoid$dci)
  hs.poa.i.c.avoid<-mean(as.numeric(hs.attack.prop.c.i$rate.avoids))
  hs..steep.i.c.avoid<-abs(mean(hs.st.i.c.avoid$steepness))
  hs.ov.i.c.avoid<-data.frame(History.Self = c(hs.poa.i.c.avoid,hs.dci.i.c.avoid,hs.tt.i.c.avoid,hs..steep.i.c.avoid,avg.int.hs.aci.p,avg.av.hs.aci.p))

# History opponent
ho.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="opponent history clumped",]
  ho.tt.i.c.avoid<-mean(ho.st.i.c.avoid$triangle.transitivity)
  ho.dci.i.c.avoid<-mean(ho.st.i.c.avoid$dci)
  ho.poa.i.c.avoid<-mean(as.numeric(ho.attack.prop.c.i$rate.avoids))
  ho..steep.i.c.avoid<-abs(mean(ho.st.i.c.avoid$steepness))
  ho.ov.i.c.avoid<-data.frame(History.Opponent = c(ho.poa.i.c.avoid,ho.dci.i.c.avoid,ho.tt.i.c.avoid,ho..steep.i.c.avoid,avg.int.ho.aci.p,avg.av.ho.aci.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.c.avoid<-data.frame(hist.mut=hm.ov.i.c.avoid,hist.self=hs.ov.i.c.avoid,hist.opp=ho.ov.i.c.avoid)
row.names(overall.c.st.i.c.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.c.avoid,"~/Desktop/overall_clump_avoid_summary_table_ic_prob.csv")
```

```{r Probabilistic Clumped Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# History mutual
hm.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="mutual history clumped",]
  hm.tt.i.c.attacks<-mean(hm.st.i.c.attacks$triangle.transitivity)
  hm.dci.i.c.attacks<-mean(hm.st.i.c.attacks$dci)
  hm.poa.i.c.attacks<-mean(as.numeric(hm.attack.prop.c.i$rate.attacks))
  hm..steep.i.c.attacks<-abs(mean(hm.st.i.c.attacks$steepness))
  hm.ov.i.c.attacks<-data.frame(History.Mutual = c(hm.poa.i.c.attacks,hm.dci.i.c.attacks,hm.tt.i.c.attacks,hm..steep.i.c.attacks,avg.int.hm.aci.p,avg.av.hm.aci.p))

# History self
hs.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="self history clumped",]
  hs.tt.i.c.attacks<-mean(hs.st.i.c.attacks$triangle.transitivity)
  hs.dci.i.c.attacks<-mean(hs.st.i.c.attacks$dci)
  hs.poa.i.c.attacks<-mean(as.numeric(hs.attack.prop.c.i$rate.attacks))
  hs..steep.i.c.attacks<-abs(mean(hs.st.i.c.attacks$steepness))
  hs.ov.i.c.attacks<-data.frame(History.Self = c(hs.poa.i.c.attacks,hs.dci.i.c.attacks,hs.tt.i.c.attacks,hs..steep.i.c.attacks,avg.int.hs.aci.p,avg.av.hs.aci.p))

# History opponent
ho.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="opponent history clumped",]
  ho.tt.i.c.attacks<-mean(ho.st.i.c.attacks$triangle.transitivity)
  ho.dci.i.c.attacks<-mean(ho.st.i.c.attacks$dci)
  ho.poa.i.c.attacks<-mean(as.numeric(ho.attack.prop.c.i$rate.attacks))
  ho..steep.i.c.attacks<-abs(mean(ho.st.i.c.attacks$steepness))
  ho.ov.i.c.attacks<-data.frame(History.Opponent = c(ho.poa.i.c.attacks,ho.dci.i.c.attacks,ho.tt.i.c.attacks,ho..steep.i.c.attacks,avg.int.ho.aci.p,avg.av.ho.aci.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.c.attacks<-data.frame(hist.mut=hm.ov.i.c.attacks,hist.self=hs.ov.i.c.attacks,hist.opp=ho.ov.i.c.attacks)
row.names(overall.c.st.i.c.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks","Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.c.attacks,"~/Desktop/overall_clump_attacks_summary_table_ic_prob.csv")
```

```{r Probabilistic Uniform Avoid Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# History mutual
hm.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="mutual history Uniform",]
  hm.tt.i.u.avoid<-mean(hm.st.i.u.avoid$triangle.transitivity)
  hm.dci.i.u.avoid<-mean(hm.st.i.u.avoid$dci)
  hm.poa.i.u.avoid<-mean(as.numeric(hm.attack.prop.c.i$rate.avoids))
  hm..steep.i.u.avoid<-abs(mean(hm.st.i.u.avoid$steepness))
  hm.ov.i.u.avoid<-data.frame(History.Mutual = c(hm.poa.i.u.avoid,hm.dci.i.u.avoid,hm.tt.i.u.avoid,hm..steep.i.u.avoid,avg.int.hm.aiu.p,avg.av.hm.aiu.p))

# History self
hs.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="self history Uniform",]
  hs.tt.i.u.avoid<-mean(hs.st.i.u.avoid$triangle.transitivity)
  hs.dci.i.u.avoid<-mean(hs.st.i.u.avoid$dci)
  hs.poa.i.u.avoid<-mean(as.numeric(hs.attack.prop.c.i$rate.avoids))
  hs..steep.i.u.avoid<-abs(mean(hs.st.i.u.avoid$steepness))
  hs.ov.i.u.avoid<-data.frame(History.Self = c(hs.poa.i.u.avoid,hs.dci.i.u.avoid,hs.tt.i.u.avoid,hs..steep.i.u.avoid,avg.int.hs.aiu.p,avg.av.hs.aiu.p))

# History opponent
ho.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="opponent history Uniform",]
  ho.tt.i.u.avoid<-mean(ho.st.i.u.avoid$triangle.transitivity)
  ho.dci.i.u.avoid<-mean(ho.st.i.u.avoid$dci)
  ho.poa.i.u.avoid<-mean(as.numeric(ho.attack.prop.c.i$rate.avoids))
  ho..steep.i.u.avoid<-abs(mean(ho.st.i.u.avoid$steepness))
  ho.ov.i.u.avoid<-data.frame(History.Opponent = c(ho.poa.i.u.avoid,ho.dci.i.u.avoid,ho.tt.i.u.avoid,ho..steep.i.u.avoid,avg.int.ho.aiu.p,avg.av.ho.aiu.p))

# Generate overall data frame of the summary tables above:
overall.u.st.i.u.avoid<-data.frame(hist.mut=hm.ov.i.u.avoid,hist.self=hs.ov.i.u.avoid,hist.opp=ho.ov.i.u.avoid)
row.names(overall.u.st.i.u.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.i.u.avoid,"~/Desktop/overall_uniform_avoid_summary_table_iu_prob.csv")
```

```{r Probabilistic Uniform Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# History mutual
hm.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="mutual history Uniform",]
  hm.tt.i.u.attacks<-mean(hm.st.i.u.attacks$triangle.transitivity)
  hm.dci.i.u.attacks<-mean(hm.st.i.u.attacks$dci)
  hm.poa.i.u.attacks<-mean(as.numeric(hm.attack.prop.c.i$rate.attacks))
  hm..steep.i.u.attacks<-abs(mean(hm.st.i.u.attacks$steepness))
  hm.ov.i.u.attacks<-data.frame(History.Mutual = c(hm.poa.i.u.attacks,hm.dci.i.u.attacks,hm.tt.i.u.attacks,hm..steep.i.u.attacks,avg.int.hm.atiu.p,avg.av.hm.atiu.p))

# History self
hs.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="self history Uniform",]
  hs.tt.i.u.attacks<-mean(hs.st.i.u.attacks$triangle.transitivity)
  hs.dci.i.u.attacks<-mean(hs.st.i.u.attacks$dci)
  hs.poa.i.u.attacks<-mean(as.numeric(hs.attack.prop.c.i$rate.attacks))
  hs..steep.i.u.attacks<-abs(mean(hs.st.i.u.attacks$steepness))
  hs.ov.i.u.attacks<-data.frame(History.Self = c(hs.poa.i.u.attacks,hs.dci.i.u.attacks,hs.tt.i.u.attacks,hs..steep.i.u.attacks,avg.int.hs.atiu.p,avg.av.hs.atiu.p))

# History opponent
ho.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="opponent history Uniform",]
  ho.tt.i.u.attacks<-mean(ho.st.i.u.attacks$triangle.transitivity)
  ho.dci.i.u.attacks<-mean(ho.st.i.u.attacks$dci)
  ho.poa.i.u.attacks<-mean(as.numeric(ho.attack.prop.c.i$rate.attacks))
  ho..steep.i.u.attacks<-abs(mean(ho.st.i.u.attacks$steepness))
  ho.ov.i.u.attacks<-data.frame(History.Opponent = c(ho.poa.i.u.attacks,ho.dci.i.u.attacks,ho.tt.i.u.attacks,ho..steep.i.u.attacks,avg.int.ho.atiu.p,avg.av.ho.atiu.p))

# Generate overall data frame of the summary tables above:
overall.u.st.i.u.attacks<-data.frame(hist.mut=hm.ov.i.u.attacks,hist.self=hs.ov.i.u.attacks,hist.opp=ho.ov.i.u.attacks)
row.names(overall.u.st.i.u.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.i.u.attacks,"~/Desktop/overall_uniform_attacks_summary_table_iu_prob.csv")
```

## Initiator Wins Summary Tables - RHP
```{r}
#Subset attack proportions data into individual data frames based on the distribution type and assessment information.

dist.split.i <- split(initiator.wins.prop.prob, initiator.wins.prop.prob$dist) #Splits attack proportions into separate data frames for "clumped" and "uniform" distributions (line 17)
new.pist.i <- c("clumped.attack.prop.i", "uniform.attack.prop.i")
for (i in 1:length(dist.split.i)) { #Variable "i" represents data by distribution
  assign(new.pist.i[i], dist.split.i[[i]]) #Assigns data to the named dataframes above (line 17)
}


clump.attack.prop.split.i <- split(clumped.attack.prop.i, clumped.attack.prop.i$combo2) #Splits attack proportions into separate data frames that occurred the "clumped" distribution based on assessment information (lines 21:26)
new.names.c.i <- c("km.attack.prop.c.i","ko.attack.prop.c.i","ks.attack.prop.c.i")
for (j in 1:length(clump.attack.prop.split.i)) { #Variable "j" represents data in the clumped distribution by assessment information
  assign(new.names.c.i[j], clump.attack.prop.split.i[[j]]) #Assigns data to the named dataframes above (lines 21:26)
}


uni.attack.prop.split.i <- split(uniform.attack.prop.i, uniform.attack.prop.i$combo2) #Splits attack proportions into separate data frames that occurred the "uniform" distribution based on assessment information (lines 28:33)
new.names.u.i <- c("km.attack.prop.u.i","ko.attack.prop.u.i","ks.attack.prop.u.i")
for (k in 1:length(uni.attack.prop.split.i)) { #Variable "k" represents data in the uniform distribution by assessment information
  assign(new.names.u.i[k], uni.attack.prop.split.i[[k]]) #Assigns data to the named dataframes above (lines 28:33)
}
```

```{r Probabilistic Clumped Summary Table}
# Generate summary tables of the Probabilistic clumped data for publication:

# rhp mutual
km.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="mutual rhp clumped",]
  km.tt.i<-mean(km.st.i$triangle.transitivity)
  km.dci.i<-mean(km.st.i$dci)
  km.poa.i<-mean(as.numeric(km.attack.prop.c.i$attack.proportion))
  km.steep.i<-abs(mean(km.st.i$steepness))
  km.ov.i<-data.frame(rhp.Mutual = c(km.poa.i,km.dci.i,km.tt.i,km.steep.i,avg.int.km.ic.p,avg.av.km.ic.p))

# rhp self
ks.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="self rhp clumped",]
  ks.tt.i<-mean(ks.st.i$triangle.transitivity)
  ks.dci.i<-mean(ks.st.i$dci)
  ks.poa.i<-mean(as.numeric(ks.attack.prop.c.i$attack.proportion))
  ks.steep.i<-abs(mean(ks.st.i$steepness))
  ks.ov.i<-data.frame(rhp.Self = c(ks.poa.i,ks.dci.i,ks.tt.i,ks.steep.i,avg.int.ks.ic.p,avg.av.ks.ic.p))

# rhp opponent
ko.st.i<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="opponent rhp clumped",]
  ko.tt.i<-mean(ko.st.i$triangle.transitivity)
  ko.dci.i<-mean(ko.st.i$dci)
  ko.poa.i<-mean(as.numeric(ko.attack.prop.c.i$attack.proportion))
  ko.steep.i<-abs(mean(ko.st.i$steepness))
  ko.ov.i<-data.frame(rhp.Opponent = c(ko.poa.i,ko.dci.i,ko.tt.i,ko.steep.i,avg.int.ko.ic.p,avg.av.ko.ic.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i<-data.frame(hist.mut=km.ov.i,hist.self=ks.ov.i,hist.opp=ko.ov.i)
row.names(overall.c.st.i)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i,"~/Desktop/overall_summary_table_kic_prob.csv")
```

```{r Probabilistic Uniform Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# rhp mutual
km.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="mutual rhp Uniform",]
  km.tt.i.u<-mean(km.st.i.u$triangle.transitivity)
  km.dci.i.u<-mean(km.st.i.u$dci)
  km.poa.i.u<-mean(as.numeric(km.attack.prop.u.i$attack.proportion))
  km.steep.i.u<-abs(mean(km.st.i.u$steepness))
  km.ov.i.u<-data.frame(rhp.Mutual = c(km.poa.i.u,km.dci.i.u,km.tt.i.u,km.steep.i.u,avg.int.km.iu.p,avg.av.km.iu.p))

# rhp self
ks.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="self rhp Uniform",]
  ks.tt.i.u<-mean(ks.st.i.u$triangle.transitivity)
  ks.dci.i.u<-mean(ks.st.i.u$dci)
  ks.poa.i.u<-mean(as.numeric(ks.attack.prop.u.i$attack.proportion))
  ks.steep.i.u<-abs(mean(ks.st.i.u$steepness))
  ks.ov.i.u<-data.frame(rhp.Self = c(ks.poa.i.u,ks.dci.i.u,ks.tt.i.u,ks.steep.i.u,avg.int.ks.iu.p,avg.av.ks.iu.p))

# rhp opponent
ko.st.i.u<-overall.ss.prob.initiator[overall.ss.prob.initiator$combo=="opponent rhp Uniform",]
  ko.tt.i.u<-mean(ko.st.i.u$triangle.transitivity)
  ko.dci.i.u<-mean(ko.st.i.u$dci)
  ko.poa.i.u<-mean(as.numeric(ko.attack.prop.u.i$attack.proportion))
  ko.steep.i.u<-abs(mean(ko.st.i.u$steepness))
  ko.ov.i.u<-data.frame(rhp.Opponent = c(ko.poa.i.u,ko.dci.i.u,ko.tt.i.u,ko.steep.i.u,avg.int.ko.iu.p,avg.av.ko.iu.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.u<-data.frame(hist.mut=km.ov.i.u,hist.self=ks.ov.i.u,hist.opp=ko.ov.i.u)
row.names(overall.c.st.i.u)<-c("Proportion of Attack","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.u,"~/Desktop/overall_summary_table_kiu_prob.csv")
```

```{r Probabilistic Clumped Avoid Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# rhp mutual
km.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="mutual rhp clumped",]
  km.tt.i.c.avoid<-mean(km.st.i.c.avoid$triangle.transitivity)
  km.dci.i.c.avoid<-mean(km.st.i.c.avoid$dci)
  km.poa.i.c.avoid<-mean(as.numeric(km.attack.prop.c.i$rate.avoids))
  km..steep.i.c.avoid<-abs(mean(km.st.i.c.avoid$steepness))
  km.ov.i.c.avoid<-data.frame(rhp.Mutual = c(km.poa.i.c.avoid,km.dci.i.c.avoid,km.tt.i.c.avoid,km..steep.i.c.avoid,avg.int.km.aci.p,avg.av.km.aci.p))

# rhp self
ks.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="self rhp clumped",]
  ks.tt.i.c.avoid<-mean(ks.st.i.c.avoid$triangle.transitivity)
  ks.dci.i.c.avoid<-mean(ks.st.i.c.avoid$dci)
  ks.poa.i.c.avoid<-mean(as.numeric(ks.attack.prop.c.i$rate.avoids))
  ks..steep.i.c.avoid<-abs(mean(ks.st.i.c.avoid$steepness))
  ks.ov.i.c.avoid<-data.frame(rhp.Self = c(ks.poa.i.c.avoid,ks.dci.i.c.avoid,ks.tt.i.c.avoid,ks..steep.i.c.avoid,avg.int.ks.aci.p,avg.av.ks.aci.p))

# rhp opponent
ko.st.i.c.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="opponent rhp clumped",]
  ko.tt.i.c.avoid<-mean(ko.st.i.c.avoid$triangle.transitivity)
  ko.dci.i.c.avoid<-mean(ko.st.i.c.avoid$dci)
  ko.poa.i.c.avoid<-mean(as.numeric(ko.attack.prop.c.i$rate.avoids))
  ko..steep.i.c.avoid<-abs(mean(ko.st.i.c.avoid$steepness))
  ko.ov.i.c.avoid<-data.frame(rhp.Opponent = c(ko.poa.i.c.avoid,ko.dci.i.c.avoid,ko.tt.i.c.avoid,ko..steep.i.c.avoid,avg.int.ko.aci.p,avg.av.ko.aci.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.c.avoid<-data.frame(hist.mut=km.ov.i.c.avoid,hist.self=ks.ov.i.c.avoid,hist.opp=ko.ov.i.c.avoid)
row.names(overall.c.st.i.c.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.c.avoid,"~/Desktop/overall_clump_avoid_summary_table_kic_prob.csv")
```

```{r Probabilistic Clumped Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# rhp mutual
km.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="mutual rhp clumped",]
  km.tt.i.c.attacks<-mean(km.st.i.c.attacks$triangle.transitivity)
  km.dci.i.c.attacks<-mean(km.st.i.c.attacks$dci)
  km.poa.i.c.attacks<-mean(as.numeric(km.attack.prop.c.i$rate.attacks))
  km..steep.i.c.attacks<-abs(mean(km.st.i.c.attacks$steepness))
  km.ov.i.c.attacks<-data.frame(rhp.Mutual = c(km.poa.i.c.attacks,km.dci.i.c.attacks,km.tt.i.c.attacks,km..steep.i.c.attacks,avg.int.km.aci.p,avg.av.km.aci.p))

# rhp self
ks.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="self rhp clumped",]
  ks.tt.i.c.attacks<-mean(ks.st.i.c.attacks$triangle.transitivity)
  ks.dci.i.c.attacks<-mean(ks.st.i.c.attacks$dci)
  ks.poa.i.c.attacks<-mean(as.numeric(ks.attack.prop.c.i$rate.attacks))
  ks..steep.i.c.attacks<-abs(mean(ks.st.i.c.attacks$steepness))
  ks.ov.i.c.attacks<-data.frame(rhp.Self = c(ks.poa.i.c.attacks,ks.dci.i.c.attacks,ks.tt.i.c.attacks,ks..steep.i.c.attacks,avg.int.ks.aci.p,avg.av.ks.aci.p))

# rhp opponent
ko.st.i.c.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="opponent rhp clumped",]
  ko.tt.i.c.attacks<-mean(ko.st.i.c.attacks$triangle.transitivity)
  ko.dci.i.c.attacks<-mean(ko.st.i.c.attacks$dci)
  ko.poa.i.c.attacks<-mean(as.numeric(ko.attack.prop.c.i$rate.attacks))
  ko..steep.i.c.attacks<-abs(mean(ko.st.i.c.attacks$steepness))
  ko.ov.i.c.attacks<-data.frame(rhp.Opponent = c(ko.poa.i.c.attacks,ko.dci.i.c.attacks,ko.tt.i.c.attacks,ko..steep.i.c.attacks,avg.int.ko.aci.p,avg.av.ko.aci.p))

# Generate overall data frame of the summary tables above:
overall.c.st.i.c.attacks<-data.frame(hist.mut=km.ov.i.c.attacks,hist.self=ks.ov.i.c.attacks,hist.opp=ko.ov.i.c.attacks)
row.names(overall.c.st.i.c.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks","Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.c.st.i.c.attacks,"~/Desktop/overall_clump_attacks_summary_table_kic_prob.csv")
```

```{r Probabilistic Uniform Avoid Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# rhp mutual
km.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="mutual rhp Uniform",]
  km.tt.i.u.avoid<-mean(km.st.i.u.avoid$triangle.transitivity)
  km.dci.i.u.avoid<-mean(km.st.i.u.avoid$dci)
  km.poa.i.u.avoid<-mean(as.numeric(km.attack.prop.c.i$rate.avoids))
  km..steep.i.u.avoid<-abs(mean(km.st.i.u.avoid$steepness))
  km.ov.i.u.avoid<-data.frame(rhp.Mutual = c(km.poa.i.u.avoid,km.dci.i.u.avoid,km.tt.i.u.avoid,km..steep.i.u.avoid,avg.int.km.aiu.p,avg.av.km.aiu.p))

# rhp self
ks.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="self rhp Uniform",]
  ks.tt.i.u.avoid<-mean(ks.st.i.u.avoid$triangle.transitivity)
  ks.dci.i.u.avoid<-mean(ks.st.i.u.avoid$dci)
  ks.poa.i.u.avoid<-mean(as.numeric(ks.attack.prop.c.i$rate.avoids))
  ks..steep.i.u.avoid<-abs(mean(ks.st.i.u.avoid$steepness))
  ks.ov.i.u.avoid<-data.frame(rhp.Self = c(ks.poa.i.u.avoid,ks.dci.i.u.avoid,ks.tt.i.u.avoid,ks..steep.i.u.avoid,avg.int.ks.aiu.p,avg.av.ks.aiu.p))

# rhp opponent
ko.st.i.u.avoid<-overall.ss.initiator.avoid.prob[overall.ss.initiator.avoid.prob$combo=="opponent rhp Uniform",]
  ko.tt.i.u.avoid<-mean(ko.st.i.u.avoid$triangle.transitivity)
  ko.dci.i.u.avoid<-mean(ko.st.i.u.avoid$dci)
  ko.poa.i.u.avoid<-mean(as.numeric(ko.attack.prop.c.i$rate.avoids))
  ko..steep.i.u.avoid<-abs(mean(ko.st.i.u.avoid$steepness))
  ko.ov.i.u.avoid<-data.frame(rhp.Opponent = c(ko.poa.i.u.avoid,ko.dci.i.u.avoid,ko.tt.i.u.avoid,ko..steep.i.u.avoid,avg.int.ko.aiu.p,avg.av.ko.aiu.p))

# Generate overall data frame of the summary tables above:
overall.u.st.i.u.avoid<-data.frame(hist.mut=km.ov.i.u.avoid,hist.self=ks.ov.i.u.avoid,hist.opp=ko.ov.i.u.avoid)
row.names(overall.u.st.i.u.avoid)<-c("Rate of Avoids","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.i.u.avoid,"~/Desktop/overall_uniform_avoid_summary_table_kiu_prob.csv")
```

```{r Probabilistic Uniform Attacks Summary Table}
# Generate summary tables of the Probabilistic uniform data for publication:

# rhp mutual
km.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="mutual rhp Uniform",]
  km.tt.i.u.attacks<-mean(km.st.i.u.attacks$triangle.transitivity)
  km.dci.i.u.attacks<-mean(km.st.i.u.attacks$dci)
  km.poa.i.u.attacks<-mean(as.numeric(km.attack.prop.c.i$rate.attacks))
  km..steep.i.u.attacks<-abs(mean(km.st.i.u.attacks$steepness))
  km.ov.i.u.attacks<-data.frame(rhp.Mutual = c(km.poa.i.u.attacks,km.dci.i.u.attacks,km.tt.i.u.attacks,km..steep.i.u.attacks,avg.int.km.atiu.p,avg.av.km.atiu.p))

# rhp self
ks.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="self rhp Uniform",]
  ks.tt.i.u.attacks<-mean(ks.st.i.u.attacks$triangle.transitivity)
  ks.dci.i.u.attacks<-mean(ks.st.i.u.attacks$dci)
  ks.poa.i.u.attacks<-mean(as.numeric(ks.attack.prop.c.i$rate.attacks))
  ks..steep.i.u.attacks<-abs(mean(ks.st.i.u.attacks$steepness))
  ks.ov.i.u.attacks<-data.frame(rhp.Self = c(ks.poa.i.u.attacks,ks.dci.i.u.attacks,ks.tt.i.u.attacks,ks..steep.i.u.attacks,avg.int.ks.atiu.p,avg.av.ks.atiu.p))

# rhp opponent
ko.st.i.u.attacks<-overall.ss.initiator.attacks.prob[overall.ss.initiator.attacks.prob$combo=="opponent rhp Uniform",]
  ko.tt.i.u.attacks<-mean(ko.st.i.u.attacks$triangle.transitivity)
  ko.dci.i.u.attacks<-mean(ko.st.i.u.attacks$dci)
  ko.poa.i.u.attacks<-mean(as.numeric(ko.attack.prop.c.i$rate.attacks))
  ko..steep.i.u.attacks<-abs(mean(ko.st.i.u.attacks$steepness))
  ko.ov.i.u.attacks<-data.frame(rhp.Opponent = c(ko.poa.i.u.attacks,ko.dci.i.u.attacks,ko.tt.i.u.attacks,ko..steep.i.u.attacks,avg.int.ko.atiu.p,avg.av.ko.atiu.p))

# Generate overall data frame of the summary tables above:
overall.u.st.i.u.attacks<-data.frame(hist.mut=km.ov.i.u.attacks,hist.self=ks.ov.i.u.attacks,hist.opp=ko.ov.i.u.attacks)
row.names(overall.u.st.i.u.attacks)<-c("Rate of Attacks","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

# Write .csv file of the overall data frame to create summary table:
write.csv(overall.u.st.i.u.attacks,"~/Desktop/overall_uniform_attacks_summary_table_kiu_prob.csv")
```