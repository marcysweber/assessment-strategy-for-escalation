---
title: "Contest_dist _matrix_probabilistic"
author: "C.J. Coates"
date: "5/10/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r functions}
ep<-function(x,y){
  sum(x[,3])/(sum(x[,3])+sum(y[,3]))
}

inter.mat<-function(x){
  vdf<-data.frame(x)
  
  na.rows<-matrix(rep(c(0,1,2,3,4,5,6,7,8,9),2),ncol=2)
  na.rows<-data.frame(na.rows)
  na.rows<-cbind(na.rows, Victories=as.numeric(rep(NA,10)))
  vdf<-rbind(vdf,na.rows[1,])
  vdf<-rbind(vdf,na.rows[2,])
  vdf<-rbind(vdf,na.rows[3,])
  vdf<-rbind(vdf,na.rows[4,])
  vdf<-rbind(vdf,na.rows[5,])
  vdf<-rbind(vdf,na.rows[6,])
  vdf<-rbind(vdf,na.rows[7,])
  vdf<-rbind(vdf,na.rows[8,])
  vdf<-rbind(vdf,na.rows[9,])
  vdf<-rbind(vdf,na.rows[10,])
  
  vdf<-vdf[order(vdf[,2],decreasing=F),]
  
  vdf<-vdf[order(vdf[,1],decreasing=F),]
  
  victory.interaction.matrix<-(matrix(vdf$Victories,nrow=10,ncol=10,byrow=F))
  victory.interaction.matrix<-data.frame(victory.interaction.matrix)
  
  victory.interaction.matrix<-t(victory.interaction.matrix)
  victory.interaction.matrix<-matrix(victory.interaction.matrix,nrow=10,ncol=10)
  colnames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  rownames(victory.interaction.matrix)<-c("0","1","2","3","4","5","6","7","8","9")
  
  victory.interaction.matrix
}

int.to.dom=function(x){ 
  ((x>t(x)) & (x+t(x)>0))+0
}

# From Shizuka and McDonald, 2012
tr.tri<-function(x){

  m=int.to.dom(as.matrix(x))
  
  g=network(m,directed=TRUE)
  
  # We calculate P.t and t.tri for this empirical network.
  
  tri=triad.census(g) #The full triad census as an 16-element vector 
  
  w=as.vector(c(0,0,0,0,0,0,0,0,1,0,0,1,1,0.5,0.75,0.75)) # The weighting vector for transitivity 
  
  N.triangle=sum(tri*as.vector(c(0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1))) #Count and sum the number of triangles
  
  Pt=sum(tri*w)/N.triangle 
  
  t.tri=4*(Pt-0.75) 
  
  Pt 
  
  t.tri
  
  ## We now conduct 1,000 simulations of random networks with the same number of mutual, asymmetric and null dyads as the empirical dominance matrix. We calculate Pt from each of these simulated networks (r.P.t). I use a while() loop because randomizations of some sparse matrices will produce networks with no triangles. For simplicity, we just throw these out. 
  
  dyads=dyad.census(g) 
  
  r.p.t=vector(length=1000)
  
  j=1
  
  while(j<1001){
  
  r=rguman(1,nv=nrow(m),mut=dyads[1],asym=dyads[2],null=dyads[3])
  
  r.triad=triad.census(r)
  
  r.p.t[j]=r.triad[9]/(r.triad[10]+r.triad[9])
  
  if (is.na(r.p.t[j])) next else j=j+1
  
  }
  
  p=length(r.p.t[r.p.t>=Pt])/1000
  
  p
  
  t.tri
}

#adds new line to axis tick labels in ggplot
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}

ggplotRegression <- function (fit) {

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 5),
                     "Intercept =",signif(fit$coef[[1]],5 ),
                     " Slope =",signif(fit$coef[[2]], 5),
                     " P =",signif(summary(fit)$coef[2,4], 5)))
}
```


```{r clumped probabilistic message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.km.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10
#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/km_pc_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ks_pc_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ko.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ko_pc_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hm_pc_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/hs_pc_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pc<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ho.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_clumped/ho_pc_mat10.csv")

km.lm.pc<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.pc<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.pc<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.pc<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.pc<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.pc<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r clumped probabilistic data frame}
#energy data frame
total.energy.pc<-data.frame(energy.km.df)
total.energy.pc<-rbind(total.energy.pc,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.pc<-data.frame(david.km.df)
total.david.pc<-rbind(total.david.pc,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.pc<-cbind(total.energy.pc,normDS=total.david.pc$normDS)

#knowledge mutual
km.tt.pc<-mean(km.ss$triangle.transitivity)
km.pci.pc<-mean(km.ss$dci)
km.esc.pc<-mean(km.ss$escalation)
km.steep.pc<-mean(km.ss$steepness)
km.slope.pc<-mean(km.ss$slope)
km.mean.pc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc,dci=km.pci.pc,esc=km.esc.pc,steepness=km.steep.pc,slope=km.slope.pc,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc<-mean(ks.ss$triangle.transitivity)
ks.pci.pc<-mean(ks.ss$dci)
ks.esc.pc<-mean(ks.ss$escalation)
ks.steep.pc<-mean(ks.ss$steepness)
ks.slope.pc<-mean(ks.ss$slope)
ks.mean.pc<-data.frame(scenario="Knowledge self",tt=ks.tt.pc,dci=ks.pci.pc,esc=ks.esc.pc,steepness=ks.steep.pc,slope=ks.slope.pc,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc<-mean(ko.ss$triangle.transitivity)
ko.pci.pc<-mean(ko.ss$dci)
ko.esc.pc<-mean(ko.ss$escalation)
ko.steep.pc<-mean(ko.ss$steepness)
ko.slope.pc<-mean(ko.ss$slope)
ko.mean.pc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc,dci=ko.pci.pc,esc=ko.esc.pc,steepness=ko.steep.pc,slope=ko.slope.pc,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc<-mean(hm.ss$triangle.transitivity)
hm.pci.pc<-mean(hm.ss$dci)
hm.esc.pc<-mean(hm.ss$escalation)
hm.steep.pc<-mean(hm.ss$steepness)
hm.slope.pc<-mean(hm.ss$slope)
hm.mean.pc<-data.frame(scenario="History Mutual",tt=hm.tt.pc,dci=hm.pci.pc,esc=hm.esc.pc,steepness=hm.steep.pc,slope=hm.slope.pc,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc<-mean(hs.ss$triangle.transitivity)
hs.pci.pc<-mean(hs.ss$dci)
hs.esc.pc<-mean(hs.ss$escalation)
hs.steep.pc<-mean(hs.ss$steepness)
hs.slope.pc<-mean(hs.ss$slope)
hs.mean.pc<-data.frame(scenario="History self",tt=hs.tt.pc,dci=hs.pci.pc,esc=hs.esc.pc,steepness=hs.steep.pc,slope=hs.slope.pc,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc<-mean(ho.ss$triangle.transitivity)
ho.pci.pc<-mean(ho.ss$dci)
ho.esc.pc<-mean(ho.ss$escalation)
ho.steep.pc<-mean(ho.ss$steepness)
ho.slope.pc<-mean(ho.ss$slope)
ho.mean.pc<-data.frame(scenario="History opponent",tt=ho.tt.pc,dci=ho.pci.pc,esc=ho.esc.pc,steepness=ho.steep.pc,slope=ho.slope.pc,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc,ks.mean.pc,ko.mean.pc,hm.mean.pc,hs.mean.pc,ho.mean.pc)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.pc<-mean(km.ss$triangle.transitivity)
km.pci.pc<-mean(km.ss$dci)
km.esc.pc<-mean(km.ss$escalation)
km.steep.pc<-mean(km.ss$steepness)
km.slope.pc<-mean(km.ss$slope)
km.mean.pc<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc,dci=km.pci.pc,esc=km.esc.pc,steepness=km.steep.pc,slope=km.slope.pc,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc<-mean(ks.ss$triangle.transitivity)
ks.pci.pc<-mean(ks.ss$dci)
ks.esc.pc<-mean(ks.ss$escalation)
ks.steep.pc<-mean(ks.ss$steepness)
ks.slope.pc<-mean(ks.ss$slope)
ks.mean.pc<-data.frame(scenario="Knowledge self",tt=ks.tt.pc,dci=ks.pci.pc,esc=ks.esc.pc,steepness=ks.steep.pc,slope=ks.slope.pc,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc<-mean(ko.ss$triangle.transitivity)
ko.pci.pc<-mean(ko.ss$dci)
ko.esc.pc<-mean(ko.ss$escalation)
ko.steep.pc<-mean(ko.ss$steepness)
ko.slope.pc<-mean(ko.ss$slope)
ko.mean.pc<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc,dci=ko.pci.pc,esc=ko.esc.pc,steepness=ko.steep.pc,slope=ko.slope.pc,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc<-mean(hm.ss$triangle.transitivity)
hm.pci.pc<-mean(hm.ss$dci)
hm.esc.pc<-mean(hm.ss$escalation)
hm.steep.pc<-mean(hm.ss$steepness)
hm.slope.pc<-mean(hm.ss$slope)
hm.mean.pc<-data.frame(scenario="History Mutual",tt=hm.tt.pc,dci=hm.pci.pc,esc=hm.esc.pc,steepness=hm.steep.pc,slope=hm.slope.pc,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc<-mean(hs.ss$triangle.transitivity)
hs.pci.pc<-mean(hs.ss$dci)
hs.esc.pc<-mean(hs.ss$escalation)
hs.steep.pc<-mean(hs.ss$steepness)
hs.slope.pc<-mean(hs.ss$slope)
hs.mean.pc<-data.frame(scenario="History self",tt=hs.tt.pc,dci=hs.pci.pc,esc=hs.esc.pc,steepness=hs.steep.pc,slope=hs.slope.pc,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc<-mean(ho.ss$triangle.transitivity)
ho.pci.pc<-mean(ho.ss$dci)
ho.esc.pc<-mean(ho.ss$escalation)
ho.steep.pc<-mean(ho.ss$steepness)
ho.slope.pc<-mean(ho.ss$slope)
ho.mean.pc<-data.frame(scenario="History opponent",tt=ho.tt.pc,dci=ho.pci.pc,esc=ho.esc.pc,steepness=ho.steep.pc,slope=ho.slope.pc,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc,ks.mean.pc,ko.mean.pc,hm.mean.pc,hs.mean.pc,ho.mean.pc)

#create overall dataframe of summary statistics
overall.clump.probabilistic<-data.frame(km.ss)
overall.clump.probabilistic<-rbind(overall.clump.probabilistic,ks.ss)
overall.clump.probabilistic<-rbind(overall.clump.probabilistic,ko.ss)
overall.clump.probabilistic<-rbind(overall.clump.probabilistic,hm.ss)
overall.clump.probabilistic<-rbind(overall.clump.probabilistic,hs.ss)
overall.clump.probabilistic<-rbind(overall.clump.probabilistic,ho.ss)

overall.clump.probabilistic<-cbind(overall.clump.probabilistic,variable=c(rep("rhp",30),rep("history",30)))
overall.clump.probabilistic<-cbind(overall.clump.probabilistic,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("probabilistic",60))


rhp.ss<-overall.clump.probabilistic[overall.clump.probabilistic$variable=="rhp",]
history.ss<-overall.clump.probabilistic[overall.clump.probabilistic$variable=="history",]

overall.clump.probabilistic$combo<-paste(overall.clump.probabilistic$strategy,overall.clump.probabilistic$variable,overall.clump.probabilistic$distribution)
overall.clump.probabilistic$combo2<-paste(overall.clump.probabilistic$strategy,overall.clump.probabilistic$variable)
```

```{r avoid clumped probabilistic message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.km.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/km_pc_avoid_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ks_pc_avoid_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ko.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ko_pc_avoid_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hm_pc_avoid_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)


mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/hs_pc_avoid_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pc.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ho.pc.avoid<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_clumped/ho_pc_avoid_mat10.csv")
```
```{r avoid clumped probabilistic data frame}
#knowledge mutual
km.tt.pc.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.pc.avoidi.pc.avoid<-mean(km.ss.avoid$dci)
km.esc.pc.avoid<-mean(km.ss.avoid$escalation)
km.steep.pc.avoid<-mean(km.ss.avoid$steepness)
km.slope.pc.avoid<-mean(km.ss.avoid$slope)
km.mean.pc.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.avoid,dci=km.pc.avoidi.pc.avoid,esc=km.esc.pc.avoid,steepness=km.steep.pc.avoid,slope=km.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.pc.avoidi.pc.avoid<-mean(ks.ss.avoid$dci)
ks.esc.pc.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.pc.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.pc.avoid<-mean(ks.ss.avoid$slope)
ks.mean.pc.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.avoid,dci=ks.pc.avoidi.pc.avoid,esc=ks.esc.pc.avoid,steepness=ks.steep.pc.avoid,slope=ks.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.pc.avoidi.pc.avoid<-mean(ko.ss.avoid$dci)
ko.esc.pc.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.pc.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.pc.avoid<-mean(ko.ss.avoid$slope)
ko.mean.pc.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.avoid,dci=ko.pc.avoidi.pc.avoid,esc=ko.esc.pc.avoid,steepness=ko.steep.pc.avoid,slope=ko.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.pc.avoidi.pc.avoid<-mean(hm.ss.avoid$dci)
hm.esc.pc.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.pc.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.pc.avoid<-mean(hm.ss.avoid$slope)
hm.mean.pc.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.pc.avoid,dci=hm.pc.avoidi.pc.avoid,esc=hm.esc.pc.avoid,steepness=hm.steep.pc.avoid,slope=hm.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.pc.avoidi.pc.avoid<-mean(hs.ss.avoid$dci)
hs.esc.pc.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.pc.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.pc.avoid<-mean(hs.ss.avoid$slope)
hs.mean.pc.avoid<-data.frame(scenario="History self",tt=hs.tt.pc.avoid,dci=hs.pc.avoidi.pc.avoid,esc=hs.esc.pc.avoid,steepness=hs.steep.pc.avoid,slope=hs.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.pc.avoidi.pc.avoid<-mean(ho.ss.avoid$dci)
ho.esc.pc.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.pc.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.pc.avoid<-mean(ho.ss.avoid$slope)
ho.mean.pc.avoid<-data.frame(scenario="History opponent",tt=ho.tt.pc.avoid,dci=ho.pc.avoidi.pc.avoid,esc=ho.esc.pc.avoid,steepness=ho.steep.pc.avoid,slope=ho.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc.avoid,ks.mean.pc.avoid,ko.mean.pc.avoid,hm.mean.pc.avoid,hs.mean.pc.avoid,ho.mean.pc.avoid)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.pc.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.pc.avoidi.pc.avoid<-mean(km.ss.avoid$dci)
km.esc.pc.avoid<-mean(km.ss.avoid$escalation)
km.steep.pc.avoid<-mean(km.ss.avoid$steepness)
km.slope.pc.avoid<-mean(km.ss.avoid$slope)
km.mean.pc.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.avoid,dci=km.pc.avoidi.pc.avoid,esc=km.esc.pc.avoid,steepness=km.steep.pc.avoid,slope=km.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.pc.avoidi.pc.avoid<-mean(ks.ss.avoid$dci)
ks.esc.pc.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.pc.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.pc.avoid<-mean(ks.ss.avoid$slope)
ks.mean.pc.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.avoid,dci=ks.pc.avoidi.pc.avoid,esc=ks.esc.pc.avoid,steepness=ks.steep.pc.avoid,slope=ks.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.pc.avoidi.pc.avoid<-mean(ko.ss.avoid$dci)
ko.esc.pc.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.pc.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.pc.avoid<-mean(ko.ss.avoid$slope)
ko.mean.pc.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.avoid,dci=ko.pc.avoidi.pc.avoid,esc=ko.esc.pc.avoid,steepness=ko.steep.pc.avoid,slope=ko.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.pc.avoidi.pc.avoid<-mean(hm.ss.avoid$dci)
hm.esc.pc.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.pc.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.pc.avoid<-mean(hm.ss.avoid$slope)
hm.mean.pc.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.pc.avoid,dci=hm.pc.avoidi.pc.avoid,esc=hm.esc.pc.avoid,steepness=hm.steep.pc.avoid,slope=hm.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.pc.avoidi.pc.avoid<-mean(hs.ss.avoid$dci)
hs.esc.pc.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.pc.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.pc.avoid<-mean(hs.ss.avoid$slope)
hs.mean.pc.avoid<-data.frame(scenario="History self",tt=hs.tt.pc.avoid,dci=hs.pc.avoidi.pc.avoid,esc=hs.esc.pc.avoid,steepness=hs.steep.pc.avoid,slope=hs.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.pc.avoidi.pc.avoid<-mean(ho.ss.avoid$dci)
ho.esc.pc.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.pc.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.pc.avoid<-mean(ho.ss.avoid$slope)
ho.mean.pc.avoid<-data.frame(scenario="History opponent",tt=ho.tt.pc.avoid,dci=ho.pc.avoidi.pc.avoid,esc=ho.esc.pc.avoid,steepness=ho.steep.pc.avoid,slope=ho.slope.pc.avoid,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc.avoid,ks.mean.pc.avoid,ko.mean.pc.avoid,hm.mean.pc.avoid,hs.mean.pc.avoid,ho.mean.pc.avoid)

#create overall dataframe of summary statistics
overall.probabilistic.clumped.avoid<-data.frame(km.ss.avoid)
overall.probabilistic.clumped.avoid<-rbind(overall.probabilistic.clumped.avoid,ks.ss.avoid)
overall.probabilistic.clumped.avoid<-rbind(overall.probabilistic.clumped.avoid,ko.ss.avoid)
overall.probabilistic.clumped.avoid<-rbind(overall.probabilistic.clumped.avoid,hm.ss.avoid)
overall.probabilistic.clumped.avoid<-rbind(overall.probabilistic.clumped.avoid,hs.ss.avoid)
overall.probabilistic.clumped.avoid<-rbind(overall.probabilistic.clumped.avoid,ho.ss.avoid)

overall.probabilistic.clumped.avoid<-cbind(overall.probabilistic.clumped.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.probabilistic.clumped.avoid<-cbind(overall.probabilistic.clumped.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("probabilistic",60))


rhp.ss.avoid<-overall.probabilistic.clumped.avoid[overall.probabilistic.clumped.avoid$variable=="rhp",]
history.ss.avoid<-overall.probabilistic.clumped.avoid[overall.probabilistic.clumped.avoid$variable=="history",]

overall.probabilistic.clumped.avoid$combo<-paste(overall.probabilistic.clumped.avoid$strategy,overall.probabilistic.clumped.avoid$variable,overall.probabilistic.clumped.avoid$distribution)
overall.probabilistic.clumped.avoid$combo2<-paste(overall.probabilistic.clumped.avoid$strategy,overall.probabilistic.clumped.avoid$variable)
```

```{r attacks clumped probabilistic message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.km.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/km_pc_attacks_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ks.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ks_pc_attacks_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.ko.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ko_pc_attacks_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.hm.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hm_pc_attacks_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)


mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.hs.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/hs_pc_attacks_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.c.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pc.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.attacks.ho.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_clumped/ho_pc_attacks_mat10.csv")
```
```{r attacks clumped probabilistic data frame}
#knowledge mutual
km.tt.pc.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.pc.attacksi.pc.attacks<-mean(km.ss.attacks$dci)
km.esc.pc.attacks<-mean(km.ss.attacks$escalation)
km.steep.pc.attacks<-mean(km.ss.attacks$steepness)
km.slope.pc.attacks<-mean(km.ss.attacks$slope)
km.mean.pc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.attacks,dci=km.pc.attacksi.pc.attacks,esc=km.esc.pc.attacks,steepness=km.steep.pc.attacks,slope=km.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.pc.attacksi.pc.attacks<-mean(ks.ss.attacks$dci)
ks.esc.pc.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.pc.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.pc.attacks<-mean(ks.ss.attacks$slope)
ks.mean.pc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.attacks,dci=ks.pc.attacksi.pc.attacks,esc=ks.esc.pc.attacks,steepness=ks.steep.pc.attacks,slope=ks.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.pc.attacksi.pc.attacks<-mean(ko.ss.attacks$dci)
ko.esc.pc.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.pc.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.pc.attacks<-mean(ko.ss.attacks$slope)
ko.mean.pc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.attacks,dci=ko.pc.attacksi.pc.attacks,esc=ko.esc.pc.attacks,steepness=ko.steep.pc.attacks,slope=ko.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.pc.attacksi.pc.attacks<-mean(hm.ss.attacks$dci)
hm.esc.pc.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.pc.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.pc.attacks<-mean(hm.ss.attacks$slope)
hm.mean.pc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.pc.attacks,dci=hm.pc.attacksi.pc.attacks,esc=hm.esc.pc.attacks,steepness=hm.steep.pc.attacks,slope=hm.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.pc.attacksi.pc.attacks<-mean(hs.ss.attacks$dci)
hs.esc.pc.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.pc.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.pc.attacks<-mean(hs.ss.attacks$slope)
hs.mean.pc.attacks<-data.frame(scenario="History self",tt=hs.tt.pc.attacks,dci=hs.pc.attacksi.pc.attacks,esc=hs.esc.pc.attacks,steepness=hs.steep.pc.attacks,slope=hs.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.pc.attacksi.pc.attacks<-mean(ho.ss.attacks$dci)
ho.esc.pc.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.pc.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.pc.attacks<-mean(ho.ss.attacks$slope)
ho.mean.pc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.pc.attacks,dci=ho.pc.attacksi.pc.attacks,esc=ho.esc.pc.attacks,steepness=ho.steep.pc.attacks,slope=ho.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc.attacks,ks.mean.pc.attacks,ko.mean.pc.attacks,hm.mean.pc.attacks,hs.mean.pc.attacks,ho.mean.pc.attacks)

#calculate means of each scenario data frame
#knowledge mutual
km.tt.pc.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.pc.attacksi.pc.attacks<-mean(km.ss.attacks$dci)
km.esc.pc.attacks<-mean(km.ss.attacks$escalation)
km.steep.pc.attacks<-mean(km.ss.attacks$steepness)
km.slope.pc.attacks<-mean(km.ss.attacks$slope)
km.mean.pc.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pc.attacks,dci=km.pc.attacksi.pc.attacks,esc=km.esc.pc.attacks,steepness=km.steep.pc.attacks,slope=km.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge self
ks.tt.pc.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.pc.attacksi.pc.attacks<-mean(ks.ss.attacks$dci)
ks.esc.pc.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.pc.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.pc.attacks<-mean(ks.ss.attacks$slope)
ks.mean.pc.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.pc.attacks,dci=ks.pc.attacksi.pc.attacks,esc=ks.esc.pc.attacks,steepness=ks.steep.pc.attacks,slope=ks.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#knowledge opponent
ko.tt.pc.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.pc.attacksi.pc.attacks<-mean(ko.ss.attacks$dci)
ko.esc.pc.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.pc.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.pc.attacks<-mean(ko.ss.attacks$slope)
ko.mean.pc.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pc.attacks,dci=ko.pc.attacksi.pc.attacks,esc=ko.esc.pc.attacks,steepness=ko.steep.pc.attacks,slope=ko.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history mutual
hm.tt.pc.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.pc.attacksi.pc.attacks<-mean(hm.ss.attacks$dci)
hm.esc.pc.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.pc.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.pc.attacks<-mean(hm.ss.attacks$slope)
hm.mean.pc.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.pc.attacks,dci=hm.pc.attacksi.pc.attacks,esc=hm.esc.pc.attacks,steepness=hm.steep.pc.attacks,slope=hm.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history self
hs.tt.pc.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.pc.attacksi.pc.attacks<-mean(hs.ss.attacks$dci)
hs.esc.pc.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.pc.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.pc.attacks<-mean(hs.ss.attacks$slope)
hs.mean.pc.attacks<-data.frame(scenario="History self",tt=hs.tt.pc.attacks,dci=hs.pc.attacksi.pc.attacks,esc=hs.esc.pc.attacks,steepness=hs.steep.pc.attacks,slope=hs.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#history opponent
ho.tt.pc.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.pc.attacksi.pc.attacks<-mean(ho.ss.attacks$dci)
ho.esc.pc.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.pc.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.pc.attacks<-mean(ho.ss.attacks$slope)
ho.mean.pc.attacks<-data.frame(scenario="History opponent",tt=ho.tt.pc.attacks,dci=ho.pc.attacksi.pc.attacks,esc=ho.esc.pc.attacks,steepness=ho.steep.pc.attacks,slope=ho.slope.pc.attacks,dist="clumped",calc="Probabilistic")

#total average dataframe
pc.ave<-rbind(km.mean.pc.attacks,ks.mean.pc.attacks,ko.mean.pc.attacks,hm.mean.pc.attacks,hs.mean.pc.attacks,ho.mean.pc.attacks)

#create overall dataframe of summary statistics
overall.probabilistic.clumped.attacks<-data.frame(km.ss.attacks)
overall.probabilistic.clumped.attacks<-rbind(overall.probabilistic.clumped.attacks,ks.ss.attacks)
overall.probabilistic.clumped.attacks<-rbind(overall.probabilistic.clumped.attacks,ko.ss.attacks)
overall.probabilistic.clumped.attacks<-rbind(overall.probabilistic.clumped.attacks,hm.ss.attacks)
overall.probabilistic.clumped.attacks<-rbind(overall.probabilistic.clumped.attacks,hs.ss.attacks)
overall.probabilistic.clumped.attacks<-rbind(overall.probabilistic.clumped.attacks,ho.ss.attacks)

overall.probabilistic.clumped.attacks<-cbind(overall.probabilistic.clumped.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.probabilistic.clumped.attacks<-cbind(overall.probabilistic.clumped.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("clumped",60),calc=rep("probabilistic",60))


rhp.ss.attacks<-overall.probabilistic.clumped.attacks[overall.probabilistic.clumped.attacks$variable=="rhp",]
history.ss.attacks<-overall.probabilistic.clumped.attacks[overall.probabilistic.clumped.attacks$variable=="history",]

overall.probabilistic.clumped.attacks$combo<-paste(overall.probabilistic.clumped.attacks$strategy,overall.probabilistic.clumped.attacks$variable,overall.probabilistic.clumped.attacks$distribution)
overall.probabilistic.clumped.attacks$combo2<-paste(overall.probabilistic.clumped.attacks$strategy,overall.probabilistic.clumped.attacks$variable)
```

```{r uniform probabilistic message=FALSE, warning=FALSE}
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/km_pu_mat1.csv")
#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])


#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.km.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/km_pu_mat10.csv")
#knowledge self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.ks.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ks_pu_mat10.csv")
#knowledge opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.ko.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ko_pu_mat10.csv")
#history mutual uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hm.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hm_pu_mat10.csv")
#history self uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.hs.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/hs_pu_mat10.csv")
#history opponent uniform

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

a1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
a2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
a3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
a4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
a5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
a6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
a7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
a8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
a9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
a10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])



#set the working directory from which the files will be read from
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/conflict")

files<-list.files(pattern="*.csv")
test<-sapply(files, read.csv)

mut1<-data.frame(X1=test[[1]],X2=test[[2]],Victories=test[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=test[[4]],X2=test[[5]],Victories=test[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=test[[7]],X2=test[[8]],Victories=test[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=test[[10]],X2=test[[11]],Victories=test[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=test[[13]],X2=test[[14]],Victories=test[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=test[[16]],X2=test[[17]],Victories=test[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=test[[19]],X2=test[[20]],Victories=test[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=test[[22]],X2=test[[23]],Victories=test[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=test[[25]],X2=test[[26]],Victories=test[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=test[[28]],X2=test[[29]],Victories=test[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pu<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.ho.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Interaction Matrices/Probabilistic_uniform/ho_pu_mat10.csv")


km.lm.pu<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS)) #knowledge mutual linear model
ks.lm.pu<-lm((energy.ks.df$energy_over_time)~as.numeric(david.ks.df$normDS)) #knowledge self linear model
ko.lm.pu<-lm((energy.ko.df$energy_over_time)~as.numeric(david.ko.df$normDS)) #knowledge opp linear model
hm.lm.pu<-lm((energy.hm.df$energy_over_time)~as.numeric(david.hm.df$normDS)) #history mutual linear model
hs.lm.pu<-lm((energy.hs.df$energy_over_time)~as.numeric(david.hs.df$normDS)) #history self linear model
ho.lm.pu<-lm((energy.ho.df$energy_over_time)~as.numeric(david.ho.df$normDS)) #history opp linear model
```
```{r uniform probabilistic data frame}
#energy data frame
total.energy.pu<-data.frame(energy.km.df)
total.energy.pu<-rbind(total.energy.pu,energy.ks.df,energy.ko.df,energy.hm.df,energy.hs.df,energy.ho.df)

total.david.pu<-data.frame(david.km.df)
total.david.pu<-rbind(total.david.pu,david.ks.df,david.ko.df,david.hm.df,david.hs.df,david.ho.df)

total.energy.pu<-cbind(total.energy.pu,normDS=total.david.pu$normDS)

#knowledge mutual
km.tt.pu<-mean(km.ss$triangle.transitivity)
km.pci.pu<-mean(km.ss$dci)
km.esc.pu<-mean(km.ss$escalation)
km.steep.pu<-mean(km.ss$steepness)
km.slope.pu<-mean(km.ss$slope)
km.mean.pu<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu,dci=km.pci.pu,esc=km.esc.pu,steepness=km.steep.pu,slope=km.slope.pu,dist="uniform",calc="Probabilistic")

#knowledge self
ks.tt.pu<-mean(ks.ss$triangle.transitivity)
ks.pci.pu<-mean(ks.ss$dci)
ks.esc.pu<-mean(ks.ss$escalation)
ks.steep.pu<-mean(ks.ss$steepness)
ks.slope.pu<-mean(ks.ss$slope)
ks.mean.pu<-data.frame(scenario="Knowledge self",tt=ks.tt.pu,dci=ks.pci.pu,esc=ks.esc.pu,steepness=ks.steep.pu,slope=ks.slope.pu,dist="uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.pu<-mean(ko.ss$triangle.transitivity)
ko.pci.pu<-mean(ko.ss$dci)
ko.esc.pu<-mean(ko.ss$escalation)
ko.steep.pu<-mean(ko.ss$steepness)
ko.slope.pu<-mean(ko.ss$slope)
ko.mean.pu<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu,dci=ko.pci.pu,esc=ko.esc.pu,steepness=ko.steep.pu,slope=ko.slope.pu,dist="uniform",calc="Probabilistic")

#history mutual
hm.tt.pu<-mean(hm.ss$triangle.transitivity)
hm.pci.pu<-mean(hm.ss$dci)
hm.esc.pu<-mean(hm.ss$escalation)
hm.steep.pu<-mean(hm.ss$steepness)
hm.slope.pu<-mean(hm.ss$slope)
hm.mean.pu<-data.frame(scenario="History Mutual",tt=hm.tt.pu,dci=hm.pci.pu,esc=hm.esc.pu,steepness=hm.steep.pu,slope=hm.slope.pu,dist="uniform",calc="Probabilistic")

#history self
hs.tt.pu<-mean(hs.ss$triangle.transitivity)
hs.pci.pu<-mean(hs.ss$dci)
hs.esc.pu<-mean(hs.ss$escalation)
hs.steep.pu<-mean(hs.ss$steepness)
hs.slope.pu<-mean(hs.ss$slope)
hs.mean.pu<-data.frame(scenario="History self",tt=hs.tt.pu,dci=hs.pci.pu,esc=hs.esc.pu,steepness=hs.steep.pu,slope=hs.slope.pu,dist="uniform",calc="Probabilistic")

#history opponent
ho.tt.pu<-mean(ho.ss$triangle.transitivity)
ho.pci.pu<-mean(ho.ss$dci)
ho.esc.pu<-mean(ho.ss$escalation)
ho.steep.pu<-mean(ho.ss$steepness)
ho.slope.pu<-mean(ho.ss$slope)
ho.mean.pu<-data.frame(scenario="History opponent",tt=ho.tt.pu,dci=ho.pci.pu,esc=ho.esc.pu,steepness=ho.steep.pu,slope=ho.slope.pu,dist="uniform",calc="Probabilistic")

#total average dataframe
pu.ave<-rbind(km.mean.pu,ks.mean.pu,ko.mean.pu,hm.mean.pu,hs.mean.pu,ho.mean.pu)


#create overall dataframe of summary statistics
overall.unif.probabilistic<-data.frame(km.ss)
overall.unif.probabilistic<-rbind(overall.unif.probabilistic,ks.ss)
overall.unif.probabilistic<-rbind(overall.unif.probabilistic,ko.ss)
overall.unif.probabilistic<-rbind(overall.unif.probabilistic,hm.ss)
overall.unif.probabilistic<-rbind(overall.unif.probabilistic,hs.ss)
overall.unif.probabilistic<-rbind(overall.unif.probabilistic,ho.ss)

overall.unif.probabilistic<-cbind(overall.unif.probabilistic,variable=c(rep("rhp",30),rep("history",30)))
overall.unif.probabilistic<-cbind(overall.unif.probabilistic,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("probabilistic",60))


rhp.ss<-overall.unif.probabilistic[overall.unif.probabilistic$variable=="rhp",]
history.ss<-overall.unif.probabilistic[overall.unif.probabilistic$variable=="history",]


overall.unif.probabilistic$combo<-paste(overall.unif.probabilistic$strategy,overall.unif.probabilistic$variable,overall.unif.probabilistic$distribution)
overall.unif.probabilistic$combo2<-paste(overall.clump.probabilistic$strategy,overall.clump.probabilistic$variable)
```

```{r avoid uniform probabilistic message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)

mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.km.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/km_pu_avoid_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ks.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ks_pu_avoid_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ko.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ko_pu_avoid_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.hm.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hm_pu_avoid_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)


mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.hs.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/hs_pu_avoid_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in avoidance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/avoid")

files<-list.files(pattern="*.csv")
avoid<-sapply(files, read.csv)



mut1<-data.frame(X1=avoid[[1]],X2=avoid[[2]],Victories=avoid[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=avoid[[4]],X2=avoid[[5]],Victories=avoid[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=avoid[[7]],X2=avoid[[8]],Victories=avoid[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=avoid[[10]],X2=avoid[[11]],Victories=avoid[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=avoid[[13]],X2=avoid[[14]],Victories=avoid[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=avoid[[16]],X2=avoid[[17]],Victories=avoid[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=avoid[[19]],X2=avoid[[20]],Victories=avoid[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=avoid[[22]],X2=avoid[[23]],Victories=avoid[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=avoid[[25]],X2=avoid[[26]],Victories=avoid[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=avoid[[28]],X2=avoid[[29]],Victories=avoid[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pu.avoid<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10

avg.int.avoid.ho.pc<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.avoid<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/Avoid Interaction Matrices/Probabilistic_uniform/ho_pu_avoid_mat10.csv")
```
```{r avoid uniform probabilistic data frame}
#knowledge mutual
km.tt.pu.avoid<-mean(km.ss.avoid$triangle.transitivity)
km.pci.pu.avoid<-mean(km.ss.avoid$dci)
km.esc.pu.avoid<-mean(km.ss.avoid$escalation)
km.steep.pu.avoid<-mean(km.ss.avoid$steepness)
km.slope.pu.avoid<-mean(km.ss.avoid$slope)
km.mean.pu.avoid<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu.avoid,dci=km.pci.pu.avoid,esc=km.esc.pu.avoid,steepness=km.steep.pu.avoid,slope=km.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#knowledge self
ks.tt.pu.avoid<-mean(ks.ss.avoid$triangle.transitivity)
ks.pci.pu.avoid<-mean(ks.ss.avoid$dci)
ks.esc.pu.avoid<-mean(ks.ss.avoid$escalation)
ks.steep.pu.avoid<-mean(ks.ss.avoid$steepness)
ks.slope.pu.avoid<-mean(ks.ss.avoid$slope)
ks.mean.pu.avoid<-data.frame(scenario="Knowledge self",tt=ks.tt.pu.avoid,dci=ks.pci.pu.avoid,esc=ks.esc.pu.avoid,steepness=ks.steep.pu.avoid,slope=ks.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.pu.avoid<-mean(ko.ss.avoid$triangle.transitivity)
ko.pci.pu.avoid<-mean(ko.ss.avoid$dci)
ko.esc.pu.avoid<-mean(ko.ss.avoid$escalation)
ko.steep.pu.avoid<-mean(ko.ss.avoid$steepness)
ko.slope.pu.avoid<-mean(ko.ss.avoid$slope)
ko.mean.pu.avoid<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu.avoid,dci=ko.pci.pu.avoid,esc=ko.esc.pu.avoid,steepness=ko.steep.pu.avoid,slope=ko.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#history mutual
hm.tt.pu.avoid<-mean(hm.ss.avoid$triangle.transitivity)
hm.pci.pu.avoid<-mean(hm.ss.avoid$dci)
hm.esc.pu.avoid<-mean(hm.ss.avoid$escalation)
hm.steep.pu.avoid<-mean(hm.ss.avoid$steepness)
hm.slope.pu.avoid<-mean(hm.ss.avoid$slope)
hm.mean.pu.avoid<-data.frame(scenario="History Mutual",tt=hm.tt.pu.avoid,dci=hm.pci.pu.avoid,esc=hm.esc.pu.avoid,steepness=hm.steep.pu.avoid,slope=hm.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#history self
hs.tt.pu.avoid<-mean(hs.ss.avoid$triangle.transitivity)
hs.pci.pu.avoid<-mean(hs.ss.avoid$dci)
hs.esc.pu.avoid<-mean(hs.ss.avoid$escalation)
hs.steep.pu.avoid<-mean(hs.ss.avoid$steepness)
hs.slope.pu.avoid<-mean(hs.ss.avoid$slope)
hs.mean.pu.avoid<-data.frame(scenario="History self",tt=hs.tt.pu.avoid,dci=hs.pci.pu.avoid,esc=hs.esc.pu.avoid,steepness=hs.steep.pu.avoid,slope=hs.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#history opponent
ho.tt.pu.avoid<-mean(ho.ss.avoid$triangle.transitivity)
ho.pci.pu.avoid<-mean(ho.ss.avoid$dci)
ho.esc.pu.avoid<-mean(ho.ss.avoid$escalation)
ho.steep.pu.avoid<-mean(ho.ss.avoid$steepness)
ho.slope.pu.avoid<-mean(ho.ss.avoid$slope)
ho.mean.pu.avoid<-data.frame(scenario="History opponent",tt=ho.tt.pu.avoid,dci=ho.pci.pu.avoid,esc=ho.esc.pu.avoid,steepness=ho.steep.pu.avoid,slope=ho.slope.pu.avoid,dist="uniform",calc="Probabilistic")

#total average dataframe
pu.ave<-rbind(km.mean.pu.avoid,ks.mean.pu.avoid,ko.mean.pu.avoid,hm.mean.pu.avoid,hs.mean.pu.avoid,ho.mean.pu.avoid)


#create overall dataframe of summary statistics
overall.probabilistic.uniform.avoid<-data.frame(km.ss.avoid)
overall.probabilistic.uniform.avoid<-rbind(overall.probabilistic.uniform.avoid,ks.ss.avoid)
overall.probabilistic.uniform.avoid<-rbind(overall.probabilistic.uniform.avoid,ko.ss.avoid)
overall.probabilistic.uniform.avoid<-rbind(overall.probabilistic.uniform.avoid,hm.ss.avoid)
overall.probabilistic.uniform.avoid<-rbind(overall.probabilistic.uniform.avoid,hs.ss.avoid)
overall.probabilistic.uniform.avoid<-rbind(overall.probabilistic.uniform.avoid,ho.ss.avoid)

overall.probabilistic.uniform.avoid<-cbind(overall.probabilistic.uniform.avoid,variable=c(rep("rhp",30),rep("history",30)))
overall.probabilistic.uniform.avoid<-cbind(overall.probabilistic.uniform.avoid,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("probabilistic",60))


rhp.ss.avoid<-overall.probabilistic.uniform.avoid[overall.probabilistic.uniform.avoid$variable=="rhp",]
history.ss.avoid<-overall.probabilistic.uniform.avoid[overall.probabilistic.uniform.avoid$variable=="history",]


overall.probabilistic.uniform.avoid$combo<-paste(overall.probabilistic.uniform.avoid$strategy,overall.probabilistic.uniform.avoid$variable,overall.probabilistic.uniform.avoid$distribution)
overall.probabilistic.uniform.avoid$combo2<-paste(overall.probabilistic.uniform.avoid$strategy,overall.probabilistic.uniform.avoid$variable)
```

```{r attacks uniform probabilistic message=FALSE, warning=FALSE}
#knowledge mutual clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)

mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.km.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.km.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/km.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.km<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.km.df<-data.frame(ID=energy.km$V1,energy_over_distance=energy.km$V2,energy_over_time=energy.km$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.km<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.km.df<-data.frame(ID=david.km$V1,DS=david.km$V2,normDS=david.km$V3)


#km.lm<-lm((energy.km.df$energy_over_time)~as.numeric(david.km.df$normDS))
#km.lm.s<-summary(km.lm)$coefficients
#km.slope<-km.lm.s[2,1]

#linear models and slopes for each individual run
lm.km.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
km.lm.1.s<-summary(lm.km.1)$coefficients
km.1.slope<-km.lm.1.s[2,1]
lm.km.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
km.lm.2.s<-summary(lm.km.2)$coefficients
km.2.slope<-km.lm.2.s[2,1]
lm.km.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
km.lm.3.s<-summary(lm.km.3)$coefficients
km.3.slope<-km.lm.3.s[2,1]
lm.km.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
km.lm.4.s<-summary(lm.km.4)$coefficients
km.4.slope<-km.lm.4.s[2,1]
lm.km.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
km.lm.5.s<-summary(lm.km.5)$coefficients
km.5.slope<-km.lm.5.s[2,1]
lm.km.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
km.lm.6.s<-summary(lm.km.6)$coefficients
km.6.slope<-km.lm.6.s[2,1]
lm.km.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
km.lm.7.s<-summary(lm.km.7)$coefficients
km.7.slope<-km.lm.7.s[2,1]
lm.km.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
km.lm.8.s<-summary(lm.km.8)$coefficients
km.8.slope<-km.lm.8.s[2,1]
lm.km.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
km.lm.9.s<-summary(lm.km.9)$coefficients
km.9.slope<-km.lm.9.s[2,1]
lm.km.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
km.lm.10.s<-summary(lm.km.10)$coefficients
km.10.slope<-km.lm.10.s[2,1]

km.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(km.1.slope,km.2.slope,km.3.slope,km.4.slope,km.5.slope,km.6.slope,km.7.slope,km.8.slope,km.9.slope,km.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/km_pu_attacks_mat10.csv")
#knowledge self clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ks.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ks<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ks.df<-data.frame(ID=energy.ks$V1,energy_over_distance=energy.ks$V2,energy_over_time=energy.ks$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ks<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ks.df<-data.frame(ID=david.ks$V1,DS=david.ks$V2,normDS=david.ks$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ks.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ks.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ks.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ks.lm.1.s<-summary(lm.ks.1)$coefficients
ks.1.slope<-ks.lm.1.s[2,1]
lm.ks.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ks.lm.2.s<-summary(lm.ks.2)$coefficients
ks.2.slope<-ks.lm.2.s[2,1]
lm.ks.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ks.lm.3.s<-summary(lm.ks.3)$coefficients
ks.3.slope<-ks.lm.3.s[2,1]
lm.ks.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ks.lm.4.s<-summary(lm.ks.4)$coefficients
ks.4.slope<-ks.lm.4.s[2,1]
lm.ks.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ks.lm.5.s<-summary(lm.ks.5)$coefficients
ks.5.slope<-ks.lm.5.s[2,1]
lm.ks.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ks.lm.6.s<-summary(lm.ks.6)$coefficients
ks.6.slope<-ks.lm.6.s[2,1]
lm.ks.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ks.lm.7.s<-summary(lm.ks.7)$coefficients
ks.7.slope<-ks.lm.7.s[2,1]
lm.ks.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ks.lm.8.s<-summary(lm.ks.8)$coefficients
ks.8.slope<-ks.lm.8.s[2,1]
lm.ks.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ks.lm.9.s<-summary(lm.ks.9)$coefficients
ks.9.slope<-ks.lm.9.s[2,1]
lm.ks.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ks.lm.10.s<-summary(lm.ks.10)$coefficients
ks.10.slope<-ks.lm.10.s[2,1]

ks.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ks.1.slope,ks.2.slope,ks.3.slope,ks.4.slope,ks.5.slope,ks.6.slope,ks.7.slope,ks.8.slope,ks.9.slope,ks.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ks_pu_attacks_mat10.csv")
#knowledge opponent clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ko.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ko<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ko.df<-data.frame(ID=energy.ko$V1,energy_over_distance=energy.ko$V2,energy_over_time=energy.ko$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ko<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ko.df<-data.frame(ID=david.ko$V1,DS=david.ko$V2,normDS=david.ko$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ko.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ko.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ko.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ko.lm.1.s<-summary(lm.ko.1)$coefficients
ko.1.slope<-ko.lm.1.s[2,1]
lm.ko.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ko.lm.2.s<-summary(lm.ko.2)$coefficients
ko.2.slope<-ko.lm.2.s[2,1]
lm.ko.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ko.lm.3.s<-summary(lm.ko.3)$coefficients
ko.3.slope<-ko.lm.3.s[2,1]
lm.ko.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ko.lm.4.s<-summary(lm.ko.4)$coefficients
ko.4.slope<-ko.lm.4.s[2,1]
lm.ko.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ko.lm.5.s<-summary(lm.ko.5)$coefficients
ko.5.slope<-ko.lm.5.s[2,1]
lm.ko.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ko.lm.6.s<-summary(lm.ko.6)$coefficients
ko.6.slope<-ko.lm.6.s[2,1]
lm.ko.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ko.lm.7.s<-summary(lm.ko.7)$coefficients
ko.7.slope<-ko.lm.7.s[2,1]
lm.ko.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ko.lm.8.s<-summary(lm.ko.8)$coefficients
ko.8.slope<-ko.lm.8.s[2,1]
lm.ko.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ko.lm.9.s<-summary(lm.ko.9)$coefficients
ko.9.slope<-ko.lm.9.s[2,1]
lm.ko.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ko.lm.10.s<-summary(lm.ko.10)$coefficients
ko.10.slope<-ko.lm.10.s[2,1]

ko.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(ko.1.slope,ko.2.slope,ko.3.slope,ko.4.slope,ko.5.slope,ko.6.slope,ko.7.slope,ko.8.slope,ko.9.slope,ko.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ko_pu_attacks_mat10.csv")
#history mutual clump

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hm.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hm<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hm.df<-data.frame(ID=energy.hm$V1,energy_over_distance=energy.hm$V2,energy_over_time=energy.hm$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hm<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hm.df<-data.frame(ID=david.hm$V1,DS=david.hm$V2,normDS=david.hm$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hm.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.hm.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hm.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hm.lm.1.s<-summary(lm.hm.1)$coefficients
hm.1.slope<-hm.lm.1.s[2,1]
lm.hm.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hm.lm.2.s<-summary(lm.hm.2)$coefficients
hm.2.slope<-hm.lm.2.s[2,1]
lm.hm.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hm.lm.3.s<-summary(lm.hm.3)$coefficients
hm.3.slope<-hm.lm.3.s[2,1]
lm.hm.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hm.lm.4.s<-summary(lm.hm.4)$coefficients
hm.4.slope<-hm.lm.4.s[2,1]
lm.hm.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hm.lm.5.s<-summary(lm.hm.5)$coefficients
hm.5.slope<-hm.lm.5.s[2,1]
lm.hm.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hm.lm.6.s<-summary(lm.hm.6)$coefficients
hm.6.slope<-hm.lm.6.s[2,1]
lm.hm.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hm.lm.7.s<-summary(lm.hm.7)$coefficients
hm.7.slope<-hm.lm.7.s[2,1]
lm.hm.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hm.lm.8.s<-summary(lm.hm.8)$coefficients
hm.8.slope<-hm.lm.8.s[2,1]
lm.hm.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hm.lm.9.s<-summary(lm.hm.9)$coefficients
hm.9.slope<-hm.lm.9.s[2,1]
lm.hm.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hm.lm.10.s<-summary(lm.hm.10)$coefficients
hm.10.slope<-hm.lm.10.s[2,1]

hm.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hm.1.slope,hm.2.slope,hm.3.slope,hm.4.slope,hm.5.slope,hm.6.slope,hm.7.slope,hm.8.slope,hm.9.slope,hm.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hm_pu_attacks_mat10.csv")
#history self clump
library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)


mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary

mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary



#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/hs.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.hs<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.hs.df<-data.frame(ID=energy.hs$V1,energy_over_distance=energy.hs$V2,energy_over_time=energy.hs$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.hs<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.hs.df<-data.frame(ID=david.hs$V1,DS=david.hs$V2,normDS=david.hs$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.hs.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.hs.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.hs.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
hs.lm.1.s<-summary(lm.hs.1)$coefficients
hs.1.slope<-hs.lm.1.s[2,1]
lm.hs.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
hs.lm.2.s<-summary(lm.hs.2)$coefficients
hs.2.slope<-hs.lm.2.s[2,1]
lm.hs.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
hs.lm.3.s<-summary(lm.hs.3)$coefficients
hs.3.slope<-hs.lm.3.s[2,1]
lm.hs.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
hs.lm.4.s<-summary(lm.hs.4)$coefficients
hs.4.slope<-hs.lm.4.s[2,1]
lm.hs.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
hs.lm.5.s<-summary(lm.hs.5)$coefficients
hs.5.slope<-hs.lm.5.s[2,1]
lm.hs.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
hs.lm.6.s<-summary(lm.hs.6)$coefficients
hs.6.slope<-hs.lm.6.s[2,1]
lm.hs.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
hs.lm.7.s<-summary(lm.hs.7)$coefficients
hs.7.slope<-hs.lm.7.s[2,1]
lm.hs.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
hs.lm.8.s<-summary(lm.hs.8)$coefficients
hs.8.slope<-hs.lm.8.s[2,1]
lm.hs.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
hs.lm.9.s<-summary(lm.hs.9)$coefficients
hs.9.slope<-hs.lm.9.s[2,1]
lm.hs.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
hs.lm.10.s<-summary(lm.hs.10)$coefficients
hs.10.slope<-hs.lm.10.s[2,1]

hs.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10),slope=c(hs.1.slope,hs.2.slope,hs.3.slope,hs.4.slope,hs.5.slope,hs.6.slope,hs.7.slope,hs.8.slope,hs.9.slope,hs.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/hs_pu_attacks_mat10.csv")
#r history opponent clump,

library(ncpen)
library(EloRating)
library(readxl)
library(tidyverse)
library(statnet)

#read in attacksance data
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/attacks")

files<-list.files(pattern="*.csv")
attacks<-sapply(files, read.csv)



mut1<-data.frame(X1=attacks[[1]],X2=attacks[[2]],Victories=attacks[[3]])
mat1<-inter.mat(mut1)
tri1<-tr.tri(mat1)
dci1<-DCindex(mat1)
mat1[is.na(mat1)] = 0
h1<-h.index(mat1)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep1<-ep(mut1,a1)
david1<-DS(mat1) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david1$normDS)
lm1<-summary(lm(new$ds~new$ord.rank))
s1<-lm1$coefficients[2,1] #call for the estimate of slope from lm summary

mut2<-data.frame(X1=attacks[[4]],X2=attacks[[5]],Victories=attacks[[6]])
mat2<-inter.mat(mut2)
tri2<-tr.tri(mat2)
dci2<-DCindex(mat2)
mat2[is.na(mat2)] = 0
h2<-h.index(mat2)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep2<-ep(mut2,a2)
david2<-DS(mat2) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david2$normDS)
lm2<-summary(lm(new$ds~new$ord.rank))
s2<-lm2$coefficients[2,1] #call for the estimate of slope from lm summary

mut3<-data.frame(X1=attacks[[7]],X2=attacks[[8]],Victories=attacks[[9]])
mat3<-inter.mat(mut3)
tri3<-tr.tri(mat3)
dci3<-DCindex(mat3)
mat3[is.na(mat3)] = 0
h3<-h.index(mat3)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep3<-ep(mut3,a3)
david3<-DS(mat3) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david3$normDS)
lm3<-summary(lm(new$ds~new$ord.rank))
s3<-lm3$coefficients[2,1] #call for the estimate of slope from lm summary

mut4<-data.frame(X1=attacks[[10]],X2=attacks[[11]],Victories=attacks[[12]])
mat4<-inter.mat(mut4)
tri4<-tr.tri(mat4)
dci4<-DCindex(mat4)
mat4[is.na(mat4)] = 0
h4<-h.index(mat4)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep4<-ep(mut4,a4)
david4<-DS(mat4) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david4$normDS)
lm4<-summary(lm(new$ds~new$ord.rank))
s4<-lm4$coefficients[2,1] #call for the estimate of slope from lm summary

mut5<-data.frame(X1=attacks[[13]],X2=attacks[[14]],Victories=attacks[[15]])
mat5<-inter.mat(mut5)
tri5<-tr.tri(mat5)
dci5<-DCindex(mat5)
mat5[is.na(mat5)] = 0
h5<-h.index(mat5)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep5<-ep(mut5,a5)
david5<-DS(mat5) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david5$normDS)
lm5<-summary(lm(new$ds~new$ord.rank))
s5<-lm5$coefficients[2,1] #call for the estimate of slope from lm summary


mut6<-data.frame(X1=attacks[[16]],X2=attacks[[17]],Victories=attacks[[18]])
mat6<-inter.mat(mut6)
tri6<-tr.tri(mat6)
dci6<-DCindex(mat6)
mat6[is.na(mat6)] = 0
h6<-h.index(mat6)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep6<-ep(mut6,a6)
david6<-DS(mat6) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david6$normDS)
lm6<-summary(lm(new$ds~new$ord.rank))
s6<-lm6$coefficients[2,1] #call for the estimate of slope from lm summary

mut7<-data.frame(X1=attacks[[19]],X2=attacks[[20]],Victories=attacks[[21]])
mat7<-inter.mat(mut7)
tri7<-tr.tri(mat7)
dci7<-DCindex(mat7)
mat7[is.na(mat7)] = 0
h7<-h.index(mat7)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep7<-ep(mut7,a7)
david7<-DS(mat7) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david7$normDS)
lm7<-summary(lm(new$ds~new$ord.rank))
s7<-lm7$coefficients[2,1] #call for the estimate of slope from lm summary


mut8<-data.frame(X1=attacks[[22]],X2=attacks[[23]],Victories=attacks[[24]])
mat8<-inter.mat(mut8)
tri8<-tr.tri(mat8)
dci8<-DCindex(mat8)
mat8[is.na(mat8)] = 0
h8<-h.index(mat8)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep8<-ep(mut8,a8)
david8<-DS(mat8) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david8$normDS)
lm8<-summary(lm(new$ds~new$ord.rank))
s8<-lm8$coefficients[2,1] #call for the estimate of slope from lm summary

mut9<-data.frame(X1=attacks[[25]],X2=attacks[[26]],Victories=attacks[[27]])
mat9<-inter.mat(mut9)
tri9<-tr.tri(mat9)
dci9<-DCindex(mat9)
mat9[is.na(mat9)] = 0
h9<-h.index(mat9)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep9<-ep(mut9,a9)
david9<-DS(mat9) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david9$normDS)
lm9<-summary(lm(new$ds~new$ord.rank))
s9<-lm9$coefficients[2,1] #call for the estimate of slope from lm summary

mut10<-data.frame(X1=attacks[[28]],X2=attacks[[29]],Victories=attacks[[30]])
mat10<-inter.mat(mut10)
tri10<-tr.tri(mat10)
dci10<-DCindex(mat10)
mat10[is.na(mat10)] = 0
h10<-h.index(mat10)
#h[3,2] #call for h' which estimates h index which estimates linearity --> check for transitivity? - issue is that h' bootstraps interaction matrix, which may be strange is conducting infinite replicates for the matrix data
ep10<-ep(mut10,a10)
david10<-DS(mat10) #David's Scores - for steepness use normDS output
new<-data.frame(ord.rank=c(1,2,3,4,5,6,7,8,9,10))
new<-cbind(new,ds=david10$normDS)
lm10<-summary(lm(new$ds~new$ord.rank))
s10<-lm10$coefficients[2,1] #call for the estimate of slope from lm summary


#read in foraging efficiency files
setwd("~/Documents/GitHub/primate-social-groups-model/dec 27/ho.u.p/energy_efficiency")

files<-list.files(pattern="*.csv")
energy.e<-sapply(files, read.csv)


e1<-data.frame(ID=energy.e[[1]], energy_over_distance=energy.e[[2]], energy_over_time=energy.e[[3]])
e1.1<-e1[order(e1$ID),]
e1<-as.matrix(t(e1.1))

e2<-data.frame(ID=energy.e[[4]],energy_over_distance=energy.e[[5]],energy_over_time=energy.e[[6]])
e2.1<-e2[order(e2$ID),]
e2<-as.matrix(t(e2.1))

e3<-data.frame(ID=energy.e[[7]],energy_over_distance=energy.e[[8]],energy_over_time=energy.e[[9]])
e3.1<-e3[order(e3$ID),]
e3<-as.matrix(t(e3.1))

e4<-data.frame(ID=energy.e[[10]],energy_over_distance=energy.e[[11]],energy_over_time=energy.e[[12]])
e4.1<-e4[order(e4$ID),]
e4<-as.matrix(t(e4.1))

e5<-data.frame(ID=energy.e[[13]],energy_over_distance=energy.e[[14]],energy_over_time=energy.e[[15]])
e5.1<-e5[order(e5$ID),]
e5<-as.matrix(t(e5.1))

e6<-data.frame(ID=energy.e[[16]],energy_over_distance=energy.e[[17]],energy_over_time=energy.e[[18]])
e6.1<-e6[order(e6$ID),]
e6<-as.matrix(t(e6.1))

e7<-data.frame(ID=energy.e[[19]],energy_over_distance=energy.e[[20]],energy_over_time=energy.e[[21]])
e7.1<-e7[order(e7$ID),]
e7<-as.matrix(t(e7.1))

e8<-data.frame(ID=energy.e[[22]],energy_over_distance=energy.e[[23]],energy_over_time=energy.e[[24]])
e8.1<-e8[order(e8$ID),]
e8<-as.matrix(t(e8.1))

e9<-data.frame(ID=energy.e[[25]],energy_over_distance=energy.e[[26]],energy_over_time=energy.e[[27]])
e9.1<-e9[order(e9$ID),]
e9<-as.matrix(t(e9.1))

e10<-data.frame(ID=energy.e[[28]],energy_over_distance=energy.e[[29]],energy_over_time=energy.e[[30]])
e10.1<-e10[order(e10$ID),]
e10<-as.matrix(t(e10.1))

energy.ho<-as.data.frame(matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10), ncol=3, byrow=T)) #master energy-efficiency dataframe organized by ID number and run through (0-9, 0-9, etc.)
energy.ho.df<-data.frame(ID=energy.ho$V1,energy_over_distance=energy.ho$V2,energy_over_time=energy.ho$V3)

#organize David's Scores data to compile into a single dataframe
david1.1<-david1[order(david1$ID),]
david1<-as.matrix(t(david1.1))

david2.1<-david2[order(david2$ID),]
david2<-as.matrix(t(david2.1))

david3.1<-david3[order(david3$ID),]
david3<-as.matrix(t(david3.1))

david4.1<-david4[order(david4$ID),]
david4<-as.matrix(t(david4.1))

david5.1<-david5[order(david5$ID),]
david5<-as.matrix(t(david5.1))

david6.1<-david6[order(david6$ID),]
david6<-as.matrix(t(david6.1))

david7.1<-david7[order(david7$ID),]
david7<-as.matrix(t(david7.1))

david8.1<-david8[order(david8$ID),]
david8<-as.matrix(t(david8.1))

david9.1<-david9[order(david9$ID),]
david9<-as.matrix(t(david9.1))

david10.1<-david10[order(david10$ID),]
david10<-as.matrix(t(david10.1))

david.ho<-as.data.frame(matrix(c(david1,david2,david3,david4,david5,david6,david7,david8,david9,david10), ncol=3, byrow=T)) #David's scores data frame organized by ID number and run-through (0-9, 0-9, etc.)
david.ho.df<-data.frame(ID=david.ho$V1,DS=david.ho$V2,normDS=david.ho$V3)

int1<-sum(mut1$Victories)
int2<-sum(mut2$Victories)
int3<-sum(mut3$Victories)
int4<-sum(mut4$Victories)
int5<-sum(mut5$Victories)
int6<-sum(mut6$Victories)
int7<-sum(mut7$Victories)
int8<-sum(mut8$Victories)
int9<-sum(mut9$Victories)
int10<-sum(mut10$Victories)

av1<-sum(a1$Victories)
av2<-sum(a2$Victories)
av3<-sum(a3$Victories)
av4<-sum(a4$Victories)
av5<-sum(a5$Victories)
av6<-sum(a6$Victories)
av7<-sum(a7$Victories)
av8<-sum(a8$Victories)
av9<-sum(a9$Victories)
av10<-sum(a10$Victories)

avg.av.ho.pu.attacks<-(sum(av1, av2, av3, av4, av5, av6, av7, av8, av9, av10))/10
avg.int.attacks.ho.pu<-(sum(int1, int2, int3, int4, int5, int6, int7, int8, int9, int10))/10

#linear models and slopes for each individual run
lm.ho.1<-lm(e1.1$energy_over_time~as.numeric(david1.1$normDS))
ho.lm.1.s<-summary(lm.ho.1)$coefficients
ho.1.slope<-ho.lm.1.s[2,1]
lm.ho.2<-lm(e2.1$energy_over_time~as.numeric(david2.1$normDS))
ho.lm.2.s<-summary(lm.ho.2)$coefficients
ho.2.slope<-ho.lm.2.s[2,1]
lm.ho.3<-lm(e3.1$energy_over_time~as.numeric(david3.1$normDS))
ho.lm.3.s<-summary(lm.ho.3)$coefficients
ho.3.slope<-ho.lm.3.s[2,1]
lm.ho.4<-lm(e4.1$energy_over_time~as.numeric(david4.1$normDS))
ho.lm.4.s<-summary(lm.ho.4)$coefficients
ho.4.slope<-ho.lm.4.s[2,1]
lm.ho.5<-lm(e5.1$energy_over_time~as.numeric(david5.1$normDS))
ho.lm.5.s<-summary(lm.ho.5)$coefficients
ho.5.slope<-ho.lm.5.s[2,1]
lm.ho.6<-lm(e6.1$energy_over_time~as.numeric(david6.1$normDS))
ho.lm.6.s<-summary(lm.ho.6)$coefficients
ho.6.slope<-ho.lm.6.s[2,1]
lm.ho.7<-lm(e7.1$energy_over_time~as.numeric(david7.1$normDS))
ho.lm.7.s<-summary(lm.ho.7)$coefficients
ho.7.slope<-ho.lm.7.s[2,1]
lm.ho.8<-lm(e8.1$energy_over_time~as.numeric(david8.1$normDS))
ho.lm.8.s<-summary(lm.ho.8)$coefficients
ho.8.slope<-ho.lm.8.s[2,1]
lm.ho.9<-lm(e9.1$energy_over_time~as.numeric(david9.1$normDS))
ho.lm.9.s<-summary(lm.ho.9)$coefficients
ho.9.slope<-ho.lm.9.s[2,1]
lm.ho.10<-lm(e10.1$energy_over_time~as.numeric(david10.1$normDS))
ho.lm.10.s<-summary(lm.ho.10)$coefficients
ho.10.slope<-ho.lm.10.s[2,1]

ho.ss.attacks<-data.frame(triangle.transitivity=c(tri1,tri2,tri3,tri4,tri5,tri6,tri7,tri8,tri9,tri10),escalation=c(ep1,ep2,ep3,ep4,ep5,ep6,ep7,ep8,ep9,ep10),dci=c(dci1,dci2,dci3,dci4,dci5,dci6,dci7,dci8,dci9,dci10),steepness=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10), slope=c(ho.1.slope,ho.2.slope,ho.3.slope,ho.4.slope,ho.5.slope,ho.6.slope,ho.7.slope,ho.8.slope,ho.9.slope,ho.10.slope))

write.csv(mat1,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat1.csv")
write.csv(mat2,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat2.csv")
write.csv(mat3,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat3.csv")
write.csv(mat4,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat4.csv")
write.csv(mat5,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat5.csv")
write.csv(mat6,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat6.csv")
write.csv(mat7,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat7.csv")
write.csv(mat8,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat8.csv")
write.csv(mat9,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat9.csv")
write.csv(mat10,"~/Documents/GitHub/primate-social-groups-model/attacks Interaction Matrices/Probabilistic_uniform/ho_pu_attacks_mat10.csv")
```
```{r attacks uniform probabilistic data frame}
#knowledge mutual
km.tt.pu.attacks<-mean(km.ss.attacks$triangle.transitivity)
km.pci.pu.attacks<-mean(km.ss.attacks$dci)
km.esc.pu.attacks<-mean(km.ss.attacks$escalation)
km.steep.pu.attacks<-mean(km.ss.attacks$steepness)
km.slope.pu.attacks<-mean(km.ss.attacks$slope)
km.mean.pu.attacks<-data.frame(scenario="Knowledge Mutual",tt=km.tt.pu.attacks,dci=km.pci.pu.attacks,esc=km.esc.pu.attacks,steepness=km.steep.pu.attacks,slope=km.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#knowledge self
ks.tt.pu.attacks<-mean(ks.ss.attacks$triangle.transitivity)
ks.pci.pu.attacks<-mean(ks.ss.attacks$dci)
ks.esc.pu.attacks<-mean(ks.ss.attacks$escalation)
ks.steep.pu.attacks<-mean(ks.ss.attacks$steepness)
ks.slope.pu.attacks<-mean(ks.ss.attacks$slope)
ks.mean.pu.attacks<-data.frame(scenario="Knowledge self",tt=ks.tt.pu.attacks,dci=ks.pci.pu.attacks,esc=ks.esc.pu.attacks,steepness=ks.steep.pu.attacks,slope=ks.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#knowledge opponent
ko.tt.pu.attacks<-mean(ko.ss.attacks$triangle.transitivity)
ko.pci.pu.attacks<-mean(ko.ss.attacks$dci)
ko.esc.pu.attacks<-mean(ko.ss.attacks$escalation)
ko.steep.pu.attacks<-mean(ko.ss.attacks$steepness)
ko.slope.pu.attacks<-mean(ko.ss.attacks$slope)
ko.mean.pu.attacks<-data.frame(scenario="Knowledge opponent",tt=ko.tt.pu.attacks,dci=ko.pci.pu.attacks,esc=ko.esc.pu.attacks,steepness=ko.steep.pu.attacks,slope=ko.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#history mutual
hm.tt.pu.attacks<-mean(hm.ss.attacks$triangle.transitivity)
hm.pci.pu.attacks<-mean(hm.ss.attacks$dci)
hm.esc.pu.attacks<-mean(hm.ss.attacks$escalation)
hm.steep.pu.attacks<-mean(hm.ss.attacks$steepness)
hm.slope.pu.attacks<-mean(hm.ss.attacks$slope)
hm.mean.pu.attacks<-data.frame(scenario="History Mutual",tt=hm.tt.pu.attacks,dci=hm.pci.pu.attacks,esc=hm.esc.pu.attacks,steepness=hm.steep.pu.attacks,slope=hm.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#history self
hs.tt.pu.attacks<-mean(hs.ss.attacks$triangle.transitivity)
hs.pci.pu.attacks<-mean(hs.ss.attacks$dci)
hs.esc.pu.attacks<-mean(hs.ss.attacks$escalation)
hs.steep.pu.attacks<-mean(hs.ss.attacks$steepness)
hs.slope.pu.attacks<-mean(hs.ss.attacks$slope)
hs.mean.pu.attacks<-data.frame(scenario="History self",tt=hs.tt.pu.attacks,dci=hs.pci.pu.attacks,esc=hs.esc.pu.attacks,steepness=hs.steep.pu.attacks,slope=hs.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#history opponent
ho.tt.pu.attacks<-mean(ho.ss.attacks$triangle.transitivity)
ho.pci.pu.attacks<-mean(ho.ss.attacks$dci)
ho.esc.pu.attacks<-mean(ho.ss.attacks$escalation)
ho.steep.pu.attacks<-mean(ho.ss.attacks$steepness)
ho.slope.pu.attacks<-mean(ho.ss.attacks$slope)
ho.mean.pu.attacks<-data.frame(scenario="History opponent",tt=ho.tt.pu.attacks,dci=ho.pci.pu.attacks,esc=ho.esc.pu.attacks,steepness=ho.steep.pu.attacks,slope=ho.slope.pu.attacks,dist="uniform",calc="Probabilistic")

#total average dataframe
pu.ave<-rbind(km.mean.pu.attacks,ks.mean.pu.attacks,ko.mean.pu.attacks,hm.mean.pu.attacks,hs.mean.pu.attacks,ho.mean.pu.attacks)


#create overall dataframe of summary statistics
overall.probabilistic.uniform.attacks<-data.frame(km.ss.attacks)
overall.probabilistic.uniform.attacks<-rbind(overall.probabilistic.uniform.attacks,ks.ss.attacks)
overall.probabilistic.uniform.attacks<-rbind(overall.probabilistic.uniform.attacks,ko.ss.attacks)
overall.probabilistic.uniform.attacks<-rbind(overall.probabilistic.uniform.attacks,hm.ss.attacks)
overall.probabilistic.uniform.attacks<-rbind(overall.probabilistic.uniform.attacks,hs.ss.attacks)
overall.probabilistic.uniform.attacks<-rbind(overall.probabilistic.uniform.attacks,ho.ss.attacks)

overall.probabilistic.uniform.attacks<-cbind(overall.probabilistic.uniform.attacks,variable=c(rep("rhp",30),rep("history",30)))
overall.probabilistic.uniform.attacks<-cbind(overall.probabilistic.uniform.attacks,strategy=rep(c("mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","mutual","self","self","self","self","self","self","self","self","self","self","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent","opponent"),2),distribution=rep("uniform",60),calc=rep("probabilistic",60))


rhp.ss.attacks<-overall.probabilistic.uniform.attacks[overall.probabilistic.uniform.attacks$variable=="rhp",]
history.ss.attacks<-overall.probabilistic.uniform.attacks[overall.probabilistic.uniform.attacks$variable=="history",]


overall.probabilistic.uniform.attacks$combo<-paste(overall.probabilistic.uniform.attacks$strategy,overall.probabilistic.uniform.attacks$variable,overall.probabilistic.uniform.attacks$distribution)
overall.probabilistic.uniform.attacks$combo2<-paste(overall.probabilistic.uniform.attacks$strategy,overall.probabilistic.uniform.attacks$variable)
```

```{r full overall probabilistic data frame}
overall.ss.probabilistic=rbind(overall.clump.probabilistic,overall.unif.probabilistic)

overall.probabilistic.data<-overall.ss.probabilistic[,1:8]

total.energy.pc<-cbind(total.energy.pc, distribution=(rep("clumped",600)))
total.energy.pu<-cbind(total.energy.pu, distribution=(rep("uniform",600)))
overall.energy<-rbind(total.energy.pc, total.energy.pu)

write.csv(overall.probabilistic.data,"~/Desktop/Probabilistic_data_frame.csv",row.names=F)
```
```{r full overall probabilistic avoid data frame}
overall.ss.probabilistic.avoid=rbind(overall.probabilistic.clumped.avoid,overall.probabilistic.uniform.avoid)

overall.probabilistic.avoid.data<-overall.ss.probabilistic.avoid[,1:8]

write.csv(overall.probabilistic.avoid.data,"~/Desktop/avoid_Probabilistic_data_frame.csv",row.names=F)
```
```{r full overall probabilistic attacks data frame}
overall.ss.probabilistic.attacks=rbind(overall.probabilistic.clumped.attacks,overall.probabilistic.uniform.attacks)

overall.probabilistic.attacks.data<-overall.ss.probabilistic.attacks[,1:8]

write.csv(overall.probabilistic.attacks.data,"~/Desktop/attacks_Probabilistic_data_frame.csv",row.names=F)
```


```{r Probabilistic clumped summary table}
km.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="mutual rhp clumped",]
  km.tt<-mean(km.st$triangle.transitivity)
  km.pci<-mean(km.st$dci)
  km.poa<-mean(km.st$escalation)
  km.steep<-abs(mean(km.st$steepness))
  km.ov<-data.frame(Knowledge.Mutual = c(km.poa,km.pci,km.tt,km.steep,avg.int.km.pc,avg.av.km.pc))
  
ks.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="self rhp clumped",]
  ks.tt<-mean(ks.st$triangle.transitivity)
  ks.pci<-mean(ks.st$dci)
  ks.poa<-mean(ks.st$escalation)
  ks.steep<-abs(mean(ks.st$steepness))
  ks.ov<-data.frame(Knowledge.Self = c(ks.poa,ks.pci,ks.tt,ks.steep,avg.int.ks.pc,avg.av.ks.pc))

  
ko.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="opponent rhp clumped",]
  ko.tt<-mean(ko.st$triangle.transitivity)
  ko.pci<-mean(ko.st$dci)
  ko.poa<-mean(ko.st$escalation)
  ko.steep<-abs(mean(ko.st$steepness))
  ko.ov<-data.frame(Knowledge.Opponent = c(ko.poa,ko.pci,ko.tt,ko.steep,avg.int.ko.pc,avg.av.ko.pc))


hm.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="mutual history clumped",]
  hm.tt<-mean(hm.st$triangle.transitivity)
  hm.pci<-mean(hm.st$dci)
  hm.poa<-mean(hm.st$escalation)
  hm.steep<-abs(mean(hm.st$steepness))
  hm.ov<-data.frame(History.Mutual = c(hm.poa,hm.pci,hm.tt,hm.steep,avg.int.hm.pc,avg.av.hm.pc))


hs.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="self history clumped",]
  hs.tt<-mean(hs.st$triangle.transitivity)
  hs.pci<-mean(hs.st$dci)
  hs.poa<-mean(hs.st$escalation)
  hs.steep<-abs(mean(hs.st$steepness))
  hs.ov<-data.frame(History.Self = c(hs.poa,hs.pci,hs.tt,hs.steep,avg.int.hs.pc,avg.av.hs.pc))


ho.st<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="opponent history clumped",]
  ho.tt<-mean(ho.st$triangle.transitivity)
  ho.pci<-mean(ho.st$dci)
  ho.poa<-mean(ho.st$escalation)
  ho.steep<-abs(mean(ho.st$steepness))
  ho.ov<-data.frame(History.Opponent = c(ho.poa,ho.pci,ho.tt,ho.steep,avg.int.ho.pc,avg.av.ho.pc))

overall.c.st<-data.frame(kno.mut=km.ov,hist.mut=hm.ov,kno.self=ks.ov,hist.self=hs.ov,kno.opp=ko.ov,hist.opp=ho.ov)
row.names(overall.c.st)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st

write.csv(overall.c.st,"~/Desktop/overall_summary_table_pc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r Probabilistic uniform summary table}
km.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="mutual rhp uniform",]
  km.tt.u<-mean(km.st.u$triangle.transitivity)
  km.pci.u<-mean(km.st.u$dci)
  km.poa.u<-mean(km.st.u$escalation)
  km.steep.u<-abs(mean(km.st.u$steepness))
  km.ov.u<-data.frame(Knowledge.Mutual = c(km.poa.u,km.pci.u,km.tt.u,km.steep.u,avg.int.km.pu,avg.av.km.pu))
  
ks.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="self rhp uniform",]
  ks.tt.u<-mean(ks.st.u$triangle.transitivity)
  ks.pci.u<-mean(ks.st.u$dci)
  ks.poa.u<-mean(ks.st.u$escalation)
  ks.steep.u<-abs(mean(ks.st.u$steepness))
  ks.ov.u<-data.frame(Knowledge.Self = c(ks.poa.u,ks.pci.u,ks.tt.u,ks.steep.u,avg.int.ks.pu,avg.av.ks.pu))

  
ko.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="opponent rhp uniform",]
  ko.tt.u<-mean(ko.st.u$triangle.transitivity)
  ko.pci.u<-mean(ko.st.u$dci)
  ko.poa.u<-mean(ko.st.u$escalation)
  ko.steep.u<-abs(mean(ko.st.u$steepness))
  ko.ov.u<-data.frame(Knowledge.Opponent = c(ko.poa.u,ko.pci.u,ko.tt.u,ko.steep.u,avg.int.ko.pu,avg.av.ko.pu))


hm.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="mutual history uniform",]
  hm.tt.u<-mean(hm.st.u$triangle.transitivity)
  hm.pci.u<-mean(hm.st.u$dci)
  hm.poa.u<-mean(hm.st.u$escalation)
  hm.steep.u<-abs(mean(hm.st.u$steepness))
  hm.ov.u<-data.frame(History.Mutual = c(hm.poa.u,hm.pci.u,hm.tt.u,hm.steep.u,avg.int.hm.pu,avg.av.hm.pu))


hs.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="self history uniform",]
  hs.tt.u<-mean(hs.st.u$triangle.transitivity)
  hs.pci.u<-mean(hs.st.u$dci)
  hs.poa.u<-mean(hs.st.u$escalation)
  hs.steep.u<-abs(mean(hs.st.u$steepness))
  hs.ov.u<-data.frame(History.Self = c(hs.poa.u,hs.pci.u,hs.tt.u,hs.steep.u,avg.int.hs.pu,avg.av.hs.pu))


ho.st.u<-overall.ss.probabilistic[overall.ss.probabilistic$combo=="opponent history uniform",]
  ho.tt.u<-mean(ho.st.u$triangle.transitivity)
  ho.pci.u<-mean(ho.st.u$dci)
  ho.poa.u<-mean(ho.st.u$escalation)
  ho.steep.u<-abs(mean(ho.st.u$steepness))
  ho.ov.u<-data.frame(History.Opponent = c(ho.poa.u,ho.pci.u,ho.tt.u,ho.steep.u,avg.int.ho.pu,avg.av.ho.pu))

overall.c.st.u<-data.frame(kno.mut=km.ov.u,hist.mut=hm.ov.u,kno.self=ks.ov.u,hist.self=hs.ov.u,kno.opp=ko.ov.u,hist.opp=ho.ov.u)
row.names(overall.c.st.u)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st.u

write.csv(overall.c.st.u,"~/Desktop/overall_summary_table_pu.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r Probabilistic clumped avoid summary table}
km.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="mutual rhp clumped",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.pci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.st.avoid$escalation)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.pci.avoid,km.tt.avoid,km..steep.avoid,avg.int.km.pc.avoid,avg.av.km.pc.avoid))
  
ks.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="self rhp clumped",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.pci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.st.avoid$escalation)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.pci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.ks.pc.avoid,avg.av.ks.pc.avoid))

  
ko.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="opponent rhp clumped",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.pci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.st.avoid$escalation)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.pci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.ko.pc.avoid,avg.av.ko.pc.avoid))


hm.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="mutual history clumped",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.pci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.st.avoid$escalation)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.pci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.hm.pc.avoid,avg.av.km.pc.avoid))


hs.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="self history clumped",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.pci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.st.avoid$escalation)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.pci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.hs.pc.avoid,avg.av.hs.pc.avoid))


ho.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="opponent history clumped",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.pci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.st.avoid$escalation)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.pci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.ho.pc.avoid,avg.av.ho.pc.avoid))

overall.c.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.c.st.avoid)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.c.st.avoid

write.csv(overall.c.st.avoid,"~/Desktop/overall_clump_avoid_summary_table_pc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic.avoid,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r Probabilistic clumped attacks summary table}
km.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="mutual rhp clumped",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.pci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.st.attacks$escalation)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.pci.attacks,km.tt.attacks,km..steep.attacks,avg.int.attacks.km.pc,avg.av.km.pc.attacks))
  
ks.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="self rhp clumped",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.pci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.st.attacks$escalation)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.pci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.attacks.ks.pc,avg.av.ks.pc.attacks))

  
ko.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="opponent rhp clumped",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.pci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.st.attacks$escalation)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.pci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.attacks.ko.pc,avg.av.ko.pc.attacks))


hm.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="mutual history clumped",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.pci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.st.attacks$escalation)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.pci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.attacks.hm.pc,avg.av.hm.pc.attacks))


hs.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="self history clumped",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.pci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.st.attacks$escalation)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.pci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.attacks.hs.pc,avg.av.hs.pc.attacks))


ho.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="opponent history clumped",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.pci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.st.attacks$escalation)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.pci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.attacks.ho.pc,avg.av.ho.pc.attacks))

overall.c.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.c.st.attacks)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks","Average Avoids")

overall.c.st.attacks

write.csv(overall.c.st.attacks,"~/Desktop/overall_clump_attacks_summary_table_pc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic.attacks,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r Probabilistic uniform avoid summary table}
km.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="mutual rhp uniform",]
  km.tt.avoid<-mean(km.st.avoid$triangle.transitivity)
  km.pci.avoid<-mean(km.st.avoid$dci)
  km.poa.avoid<-mean(km.st.avoid$escalation)
  km..steep.avoid<-abs(mean(km.st.avoid$steepness))
  km.ov.avoid<-data.frame(Knowledge.Mutual = c(km.poa.avoid,km.pci.avoid,km.tt.avoid,km..steep.avoid,avg.int.avoid.km.pc,avg.av.km.pu.avoid))
  
ks.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="self rhp uniform",]
  ks.tt.avoid<-mean(ks.st.avoid$triangle.transitivity)
  ks.pci.avoid<-mean(ks.st.avoid$dci)
  ks.poa.avoid<-mean(ks.st.avoid$escalation)
  ks..steep.avoid<-abs(mean(ks.st.avoid$steepness))
  ks.ov.avoid<-data.frame(Knowledge.Self = c(ks.poa.avoid,ks.pci.avoid,ks.tt.avoid,ks..steep.avoid,avg.int.avoid.ks.pc,avg.av.ks.pu.avoid))

  
ko.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="opponent rhp uniform",]
  ko.tt.avoid<-mean(ko.st.avoid$triangle.transitivity)
  ko.pci.avoid<-mean(ko.st.avoid$dci)
  ko.poa.avoid<-mean(ko.st.avoid$escalation)
  ko..steep.avoid<-abs(mean(ko.st.avoid$steepness))
  ko.ov.avoid<-data.frame(Knowledge.Opponent = c(ko.poa.avoid,ko.pci.avoid,ko.tt.avoid,ko..steep.avoid,avg.int.avoid.ko.pc,avg.av.ko.pu.avoid))


hm.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="mutual history uniform",]
  hm.tt.avoid<-mean(hm.st.avoid$triangle.transitivity)
  hm.pci.avoid<-mean(hm.st.avoid$dci)
  hm.poa.avoid<-mean(hm.st.avoid$escalation)
  hm..steep.avoid<-abs(mean(hm.st.avoid$steepness))
  hm.ov.avoid<-data.frame(History.Mutual = c(hm.poa.avoid,hm.pci.avoid,hm.tt.avoid,hm..steep.avoid,avg.int.avoid.hm.pc,avg.av.hm.pu.avoid))


hs.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="self history uniform",]
  hs.tt.avoid<-mean(hs.st.avoid$triangle.transitivity)
  hs.pci.avoid<-mean(hs.st.avoid$dci)
  hs.poa.avoid<-mean(hs.st.avoid$escalation)
  hs..steep.avoid<-abs(mean(hs.st.avoid$steepness))
  hs.ov.avoid<-data.frame(History.Self = c(hs.poa.avoid,hs.pci.avoid,hs.tt.avoid,hs..steep.avoid,avg.int.avoid.hs.pc,avg.av.hs.pu.avoid))


ho.st.avoid<-overall.ss.probabilistic.avoid[overall.ss.probabilistic.avoid$combo=="opponent history uniform",]
  ho.tt.avoid<-mean(ho.st.avoid$triangle.transitivity)
  ho.pci.avoid<-mean(ho.st.avoid$dci)
  ho.poa.avoid<-mean(ho.st.avoid$escalation)
  ho..steep.avoid<-abs(mean(ho.st.avoid$steepness))
  ho.ov.avoid<-data.frame(History.Opponent = c(ho.poa.avoid,ho.pci.avoid,ho.tt.avoid,ho..steep.avoid,avg.int.avoid.ho.pc,avg.av.ho.pu.avoid))

overall.u.st.avoid<-data.frame(kno.mut=km.ov.avoid,hist.mut=hm.ov.avoid,kno.self=ks.ov.avoid,hist.self=hs.ov.avoid,kno.opp=ko.ov.avoid,hist.opp=ho.ov.avoid)
row.names(overall.u.st.avoid)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.u.st.avoid

write.csv(overall.u.st.avoid,"~/Desktop/overall_uniform_avoid_summary_table_pc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic.avoid,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
```{r Probabilistic uniform attacks summary table}
km.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="mutual rhp uniform",]
  km.tt.attacks<-mean(km.st.attacks$triangle.transitivity)
  km.pci.attacks<-mean(km.st.attacks$dci)
  km.poa.attacks<-mean(km.st.attacks$escalation)
  km..steep.attacks<-abs(mean(km.st.attacks$steepness))
  km.ov.attacks<-data.frame(Knowledge.Mutual = c(km.poa.attacks,km.pci.attacks,km.tt.attacks,km..steep.attacks,avg.int.attacks.km.pc,avg.av.km.pu.attacks))
  
ks.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="self rhp uniform",]
  ks.tt.attacks<-mean(ks.st.attacks$triangle.transitivity)
  ks.pci.attacks<-mean(ks.st.attacks$dci)
  ks.poa.attacks<-mean(ks.st.attacks$escalation)
  ks..steep.attacks<-abs(mean(ks.st.attacks$steepness))
  ks.ov.attacks<-data.frame(Knowledge.Self = c(ks.poa.attacks,ks.pci.attacks,ks.tt.attacks,ks..steep.attacks,avg.int.attacks.ks.pc,avg.av.ks.pu.attacks))

  
ko.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="opponent rhp uniform",]
  ko.tt.attacks<-mean(ko.st.attacks$triangle.transitivity)
  ko.pci.attacks<-mean(ko.st.attacks$dci)
  ko.poa.attacks<-mean(ko.st.attacks$escalation)
  ko..steep.attacks<-abs(mean(ko.st.attacks$steepness))
  ko.ov.attacks<-data.frame(Knowledge.Opponent = c(ko.poa.attacks,ko.pci.attacks,ko.tt.attacks,ko..steep.attacks,avg.int.attacks.ko.pc,avg.av.ko.pu.attacks))


hm.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="mutual history uniform",]
  hm.tt.attacks<-mean(hm.st.attacks$triangle.transitivity)
  hm.pci.attacks<-mean(hm.st.attacks$dci)
  hm.poa.attacks<-mean(hm.st.attacks$escalation)
  hm..steep.attacks<-abs(mean(hm.st.attacks$steepness))
  hm.ov.attacks<-data.frame(History.Mutual = c(hm.poa.attacks,hm.pci.attacks,hm.tt.attacks,hm..steep.attacks,avg.int.attacks.hm.pc,avg.av.hm.pu.attacks))


hs.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="self history uniform",]
  hs.tt.attacks<-mean(hs.st.attacks$triangle.transitivity)
  hs.pci.attacks<-mean(hs.st.attacks$dci)
  hs.poa.attacks<-mean(hs.st.attacks$escalation)
  hs..steep.attacks<-abs(mean(hs.st.attacks$steepness))
  hs.ov.attacks<-data.frame(History.Self = c(hs.poa.attacks,hs.pci.attacks,hs.tt.attacks,hs..steep.attacks,avg.int.attacks.hs.pc,avg.av.hs.pu.attacks))


ho.st.attacks<-overall.ss.probabilistic.attacks[overall.ss.probabilistic.attacks$combo=="opponent history uniform",]
  ho.tt.attacks<-mean(ho.st.attacks$triangle.transitivity)
  ho.pci.attacks<-mean(ho.st.attacks$dci)
  ho.poa.attacks<-mean(ho.st.attacks$escalation)
  ho..steep.attacks<-abs(mean(ho.st.attacks$steepness))
  ho.ov.attacks<-data.frame(History.Opponent = c(ho.poa.attacks,ho.pci.attacks,ho.tt.attacks,ho..steep.attacks,avg.int.attacks.ho.pc,avg.av.ho.pu.attacks))

overall.u.st.attacks<-data.frame(kno.mut=km.ov.attacks,hist.mut=hm.ov.attacks,kno.self=ks.ov.attacks,hist.self=hs.ov.attacks,kno.opp=ko.ov.attacks,hist.opp=ho.ov.attacks)
row.names(overall.u.st.attacks)<-c("Attack Proportion","Directional Consitancy Index","Triangle Transitivity","Steepness", "Average Attacks", "Average Avoids")

overall.u.st.attacks

write.csv(overall.u.st.attacks,"~/Desktop/overall_uniform_attacks_summary_table_pc.csv")
#write.csv(total.ave,"~/Desktop/averages_table.csv")
#write.csv(overall.ss.probabilistic.attacks,"~/Desktop/overall_Probabilistic_table.csv")
#write.csv(overall.ss.prob,"~/Desktop/overall_probabilistic_table.csv")

#in summary have separate column of the average number of interactions in the matrices
```
````{r energy averages dataframe}
#total.energy.pc
library(zoo)
library(dplyr)
n <- 100

sums.energy.pc<-rollapply(total.energy.pc$energy_over_time, n, mean, by = n)

#total.energy.pu
sums.energy.pu<-rollapply(total.energy.pu$energy_over_time, n, mean, by = n)

energy.averages.prob<-data.frame(Heterogenous=sums.energy.pc,Homogenous=sums.energy.pu)
energy.averages.prob<-cbind(energy.averages.prob,Scenario=c("Mutual Knowledge","Self Knowledge","Opponent Knowledge","Mutual History","Self History","Opponent History"))

order<-c("Self Knowledge","Self History","Opponent Knowledge","Opponent History","Mutual Knowledge","Mutual History")
energy.averages.prob.final<-energy.averages.prob %>%
                          slice(match(order, Scenario))

write.csv(energy.averages.prob.final,"~/Desktop/energy.averages.prob.csv")
```


#p21
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p21<-overall.ss.probabilistic %>%
  ggplot(aes(x=combo2, y=escalation,color=distribution)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Proportion of Attack") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=0.05, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(0.1,0.65))
jpeg("contest.comp_probabilistic_fig_1.jpeg", 336, 336)
p21
dev.off()

p21
    

#p22-24
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p22 <- overall.ss.probabilistic %>%
  ggplot(aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05, 1.05))
jpeg("contest.comp_probabilistic_fig_2.jpeg", 336, 336)
p22
dev.off()

p23 <- overall.ss.probabilistic %>%
  ggplot(aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_probabilistic_fig_3.jpeg", 336, 336)
p23
dev.off()
    
p24 <- overall.ss.probabilistic %>%
  ggplot(aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.15, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_probabilistic_fig_4.jpeg", 336, 336)
p24
dev.off()

p23
p22
p24

 
#p25

setwd("~/Desktop")
jpeg("contest.comp_probabilistic_fig_5.jpeg", 672, 336)
par(cex.axis=1, cex.lab=1.3, mar=c(2.65,2.75,0.4,0.4),family="sans")
p25<-plot(total.energy.pc$energy_over_time~total.energy.pc$normDS,pch=1,cex=1.4,xaxt="n",yaxt="n",col="blue",xlab="",ylab="",main="",ylim=c(0.4,0.8),xlim=c(0.85,8.25),las=1); points(total.energy.pu$energy_over_time~total.energy.pu$normDS,pch=2,cex=1.4,col="#CC5500"); abline(km.lm.pc, lwd=3);abline(ks.lm.pc, lwd=3);abline(ko.lm.pc, lwd=3);abline(hm.lm.pc, lwd=3);abline(hs.lm.pc, lwd=3);abline(ho.lm.pc, lwd=3);abline(km.lm.pu, col="black", lty=4, lwd=3);abline(ks.lm.pu, col="black", lty=4, lwd=3);abline(ko.lm.pu, col="black", lty=4, lwd=3);abline(hm.lm.pu, col="black", lty=4, lwd=3);abline(hs.lm.pu, col="black", lty=4, lwd=3);abline(ho.lm.pu, col="black", lty=4, lwd=3);title(xlab="Normalized David's Scores",line=1.25);title(ylab="Energy per unit Time", line=1.5); axis(1, at = c(0, 1, 2, 3, 4, 5, 6, 7, 8), label=rep("",9), tck=-0.015, line=0);axis(2, at = c(0.4,0.5,0.6,0.7,0.8), label=rep("",5),tck=-0.015);axis(1, at = 1:10, line = -0.8, lwd = 0, cex.axis = 1);axis(2, at = c(0.4,0.5,0.6,0.7,0.8), line = -0.7, lwd = 0, cex.axis = 1, las=1);box(col="black",lwd=3)
dev.off()

p25

#p26 (avoid)
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p26<-overall.ss.probabilistic.avoid %>%
  ggplot( aes(x=combo2, y=escalation,color=distribution)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Rate of Avoids") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.16, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.1,0.65))
jpeg("contest.comp_p26.jpeg", 336, 336)
p26
dev.off()

p26
    

#p27-29 (avoid)
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p27 <- overall.ss.probabilistic.avoid %>%
  ggplot( aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.63, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.5, 1.05))
jpeg("contest.comp_p27.jpeg", 369.6, 336)
p27
dev.off()

p28 <- overall.ss.probabilistic.avoid %>%
  ggplot( aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_p28.jpeg", 369.6, 336)
p28
dev.off()
    
p29 <- overall.ss.probabilistic.avoid %>%
  ggplot( aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_p29.jpeg", 369.6, 336)
p29
dev.off()

p27
p28
p29

#p30 (attacks)
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(viridis)
library(Rmisc)

setwd("~/Desktop")
p30<-overall.ss.probabilistic.attacks %>%
  ggplot( aes(x=combo2, y=escalation,color=distribution)) +
    geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Rate of Attacks") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    
    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.16, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.1,0.65))
jpeg("contest.comp_p30.jpeg", 336, 336)
p30
dev.off()

p30
    

#p31-33 (attacks)
setwd("~/Desktop")
addline_format <- function(x,...){
    gsub('\\s','\n',x)
}
x.lab<-c("Mutual History","Mutual History","Mutual RHP","Mutual RHP","Opponent History","Opponent History","Opponent RHP","Opponent RHP","Self History","Self History","Self RHP","Self RHP")

p31 <- overall.ss.probabilistic.attacks %>%
  ggplot( aes(x=combo2, y=triangle.transitivity,color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Triangle Transitivity") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.63, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.5, 1.05))
jpeg("contest.comp_p31.jpeg", 369.6, 336)
p31
dev.off()

p32 <- overall.ss.probabilistic.attacks %>%
  ggplot( aes(x=combo2, y=dci,color=distribution)) +
geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Directional Consistency Index") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_p32.jpeg", 369.6, 336)
p32
dev.off()
    
p33 <- overall.ss.probabilistic.attacks %>%
  ggplot( aes(x=combo2, y=abs(steepness),color=distribution)) +
  geom_boxplot(outlier.shape=NA) +
    geom_point(aes(shape=distribution),size=2.5,position=position_dodge(width=0.75))+
    scale_shape_manual(values=c(1, 2))+
    xlab("")+
    ylab("Steepness") +
    theme_bw() +
    theme(panel.grid.major.x = element_line(color = "grey",size = 0.3,linetype = 2),legend.position="none",panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x=element_text(size=13, colour="black"),axis.text.y=element_text(size=12, colour="black"), panel.border=element_rect(colour="black", size=1, fill=NA), axis.title.y=element_text(size=14))+    scale_color_manual(values = c("blue","#CC5500")) +
    scale_x_discrete(limit=c("self rhp", "self history", "opponent rhp", "opponent history", "mutual rhp", "mutual history"), labels=c("RHP", "History", "RHP", "History", "RHP", "History"))  + 
    annotate(geom="text", x=c(1.5, 3.5, 5.5), y=-0.14, label=c("Self", "Opponent", "Mutual"), size=5)+
    coord_cartesian(expand=F, clip="off", xlim=c(0.25, 6.75), ylim=c(-0.05,1.05))
jpeg("contest.comp_p33.jpeg", 369.6, 336)
p33
dev.off()

p31
p32
p33


